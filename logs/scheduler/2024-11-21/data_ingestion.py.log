[2024-11-21T06:00:02.642+0000] {processor.py:161} INFO - Started process (PID=101) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:00:02.644+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T06:00:02.651+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:00:02.650+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:00:02.747+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:00:02.747+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T06:00:08.948+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:00:08.948+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 6.167940556000019
[2024-11-21T06:00:08.951+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:00:08.950+0000] {graph.py:487} INFO - Cosmos performance [4d3972a47987|101]: The cache size for cosmos_cache__nyc_green_taxi__transform is 2621
[2024-11-21T06:00:08.952+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:00:08.952+0000] {graph.py:495} INFO - Cosmos performance: Cache hit for cosmos_cache__nyc_green_taxi__transform - 0535576c8d7b9c0b5de17cec0f5a6dce,16a7af22baa01082ccbc983a81f25573
[2024-11-21T06:00:08.954+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:00:08.953+0000] {graph.py:412} INFO - Total nodes: 3
[2024-11-21T06:00:08.956+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:00:08.955+0000] {graph.py:413} INFO - Total filtered nodes: 3
[2024-11-21T06:00:08.957+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:00:08.957+0000] {converter.py:264} INFO - Cosmos performance (nyc_green_taxi__transform) -  [4d3972a47987|101]: It took 6.21s to parse the dbt project for DAG using LoadMode.DBT_LS_CACHE
[2024-11-21T06:00:08.969+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:00:08.968+0000] {converter.py:308} INFO - Cosmos performance (nyc_green_taxi__transform) - [4d3972a47987|101]: It took 0.0119s to build the Airflow DAG.
[2024-11-21T06:00:08.971+0000] {processor.py:840} INFO - DAG(s) 'nyc_green_taxi' retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:00:09.103+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:00:09.103+0000] {dag.py:3089} INFO - Sync 1 DAGs
[2024-11-21T06:00:09.147+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:00:09.146+0000] {dag.py:3947} INFO - Setting next_dagrun for nyc_green_taxi to 2024-11-20 00:00:00+00:00, run_after=2024-11-20 00:00:00+00:00
[2024-11-21T06:00:09.200+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 6.579 seconds
[2024-11-21T06:00:39.590+0000] {processor.py:161} INFO - Started process (PID=110) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:00:39.594+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T06:00:39.598+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:00:39.597+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:00:39.703+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:00:39.703+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T06:00:42.884+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:00:42.883+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 4.286714532000019
[2024-11-21T06:00:42.885+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:00:42.885+0000] {graph.py:487} INFO - Cosmos performance [4d3972a47987|110]: The cache size for cosmos_cache__nyc_green_taxi__transform is 2621
[2024-11-21T06:00:42.887+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:00:42.887+0000] {graph.py:495} INFO - Cosmos performance: Cache hit for cosmos_cache__nyc_green_taxi__transform - 0535576c8d7b9c0b5de17cec0f5a6dce,16a7af22baa01082ccbc983a81f25573
[2024-11-21T06:00:42.889+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:00:42.888+0000] {graph.py:412} INFO - Total nodes: 3
[2024-11-21T06:00:42.891+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:00:42.891+0000] {graph.py:413} INFO - Total filtered nodes: 3
[2024-11-21T06:00:42.892+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:00:42.892+0000] {converter.py:264} INFO - Cosmos performance (nyc_green_taxi__transform) -  [4d3972a47987|110]: It took 4.33s to parse the dbt project for DAG using LoadMode.DBT_LS_CACHE
[2024-11-21T06:00:42.904+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:00:42.903+0000] {converter.py:308} INFO - Cosmos performance (nyc_green_taxi__transform) - [4d3972a47987|110]: It took 0.0114s to build the Airflow DAG.
[2024-11-21T06:00:42.907+0000] {processor.py:840} INFO - DAG(s) 'nyc_green_taxi' retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:00:42.956+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:00:42.955+0000] {dag.py:3089} INFO - Sync 1 DAGs
[2024-11-21T06:00:43.004+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:00:43.003+0000] {dag.py:3947} INFO - Setting next_dagrun for nyc_green_taxi to 2024-11-20 00:00:00+00:00, run_after=2024-11-20 00:00:00+00:00
[2024-11-21T06:00:43.057+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 4.619 seconds
[2024-11-21T06:01:13.496+0000] {processor.py:161} INFO - Started process (PID=118) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:01:13.499+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T06:01:13.504+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:01:13.503+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:01:13.606+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:01:13.605+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T06:01:17.741+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:01:17.741+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 4.1004474749999815
[2024-11-21T06:01:17.742+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:01:17.742+0000] {graph.py:487} INFO - Cosmos performance [4d3972a47987|118]: The cache size for cosmos_cache__nyc_green_taxi__transform is 2621
[2024-11-21T06:01:17.744+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:01:17.744+0000] {graph.py:495} INFO - Cosmos performance: Cache hit for cosmos_cache__nyc_green_taxi__transform - 0535576c8d7b9c0b5de17cec0f5a6dce,16a7af22baa01082ccbc983a81f25573
[2024-11-21T06:01:17.746+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:01:17.745+0000] {graph.py:412} INFO - Total nodes: 3
[2024-11-21T06:01:17.748+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:01:17.747+0000] {graph.py:413} INFO - Total filtered nodes: 3
[2024-11-21T06:01:17.750+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:01:17.749+0000] {converter.py:264} INFO - Cosmos performance (nyc_green_taxi__transform) -  [4d3972a47987|118]: It took 4.14s to parse the dbt project for DAG using LoadMode.DBT_LS_CACHE
[2024-11-21T06:01:17.760+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:01:17.760+0000] {converter.py:308} INFO - Cosmos performance (nyc_green_taxi__transform) - [4d3972a47987|118]: It took 0.0105s to build the Airflow DAG.
[2024-11-21T06:01:17.763+0000] {processor.py:840} INFO - DAG(s) 'nyc_green_taxi' retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:01:17.808+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:01:17.808+0000] {dag.py:3089} INFO - Sync 1 DAGs
[2024-11-21T06:01:17.850+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:01:17.849+0000] {dag.py:3947} INFO - Setting next_dagrun for nyc_green_taxi to 2024-11-20 00:00:00+00:00, run_after=2024-11-20 00:00:00+00:00
[2024-11-21T06:01:17.895+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 4.418 seconds
[2024-11-21T06:01:48.211+0000] {processor.py:161} INFO - Started process (PID=132) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:01:48.213+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T06:01:48.218+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:01:48.217+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:01:48.328+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:01:48.327+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T06:01:52.063+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:01:52.062+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 3.701837051000041
[2024-11-21T06:01:52.064+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:01:52.064+0000] {graph.py:487} INFO - Cosmos performance [4d3972a47987|132]: The cache size for cosmos_cache__nyc_green_taxi__transform is 2621
[2024-11-21T06:01:52.067+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:01:52.066+0000] {graph.py:495} INFO - Cosmos performance: Cache hit for cosmos_cache__nyc_green_taxi__transform - 0535576c8d7b9c0b5de17cec0f5a6dce,16a7af22baa01082ccbc983a81f25573
[2024-11-21T06:01:52.069+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:01:52.068+0000] {graph.py:412} INFO - Total nodes: 3
[2024-11-21T06:01:52.070+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:01:52.070+0000] {graph.py:413} INFO - Total filtered nodes: 3
[2024-11-21T06:01:52.072+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:01:52.071+0000] {converter.py:264} INFO - Cosmos performance (nyc_green_taxi__transform) -  [4d3972a47987|132]: It took 3.74s to parse the dbt project for DAG using LoadMode.DBT_LS_CACHE
[2024-11-21T06:01:52.082+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:01:52.082+0000] {converter.py:308} INFO - Cosmos performance (nyc_green_taxi__transform) - [4d3972a47987|132]: It took 0.0108s to build the Airflow DAG.
[2024-11-21T06:01:52.086+0000] {processor.py:840} INFO - DAG(s) 'nyc_green_taxi' retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:01:52.135+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:01:52.134+0000] {dag.py:3089} INFO - Sync 1 DAGs
[2024-11-21T06:01:52.182+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:01:52.182+0000] {dag.py:3947} INFO - Setting next_dagrun for nyc_green_taxi to 2024-11-20 00:00:00+00:00, run_after=2024-11-20 00:00:00+00:00
[2024-11-21T06:01:52.225+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 4.031 seconds
[2024-11-21T06:02:22.771+0000] {processor.py:161} INFO - Started process (PID=140) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:02:22.774+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T06:02:22.778+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:02:22.778+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:02:22.874+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:02:22.873+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T06:02:26.674+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:02:26.674+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 3.767055835000008
[2024-11-21T06:02:26.675+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:02:26.675+0000] {graph.py:487} INFO - Cosmos performance [4d3972a47987|140]: The cache size for cosmos_cache__nyc_green_taxi__transform is 2621
[2024-11-21T06:02:26.677+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:02:26.677+0000] {graph.py:495} INFO - Cosmos performance: Cache hit for cosmos_cache__nyc_green_taxi__transform - 0535576c8d7b9c0b5de17cec0f5a6dce,16a7af22baa01082ccbc983a81f25573
[2024-11-21T06:02:26.679+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:02:26.678+0000] {graph.py:412} INFO - Total nodes: 3
[2024-11-21T06:02:26.680+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:02:26.680+0000] {graph.py:413} INFO - Total filtered nodes: 3
[2024-11-21T06:02:26.682+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:02:26.681+0000] {converter.py:264} INFO - Cosmos performance (nyc_green_taxi__transform) -  [4d3972a47987|140]: It took 3.81s to parse the dbt project for DAG using LoadMode.DBT_LS_CACHE
[2024-11-21T06:02:26.691+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:02:26.691+0000] {converter.py:308} INFO - Cosmos performance (nyc_green_taxi__transform) - [4d3972a47987|140]: It took 0.00996s to build the Airflow DAG.
[2024-11-21T06:02:26.695+0000] {processor.py:840} INFO - DAG(s) 'nyc_green_taxi' retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:02:26.757+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:02:26.756+0000] {dag.py:3089} INFO - Sync 1 DAGs
[2024-11-21T06:02:26.804+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:02:26.803+0000] {dag.py:3947} INFO - Setting next_dagrun for nyc_green_taxi to 2024-11-20 00:00:00+00:00, run_after=2024-11-20 00:00:00+00:00
[2024-11-21T06:02:26.847+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 4.096 seconds
[2024-11-21T06:02:57.281+0000] {processor.py:161} INFO - Started process (PID=148) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:02:57.283+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T06:02:57.287+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:02:57.287+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:02:57.381+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:02:57.380+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T06:03:01.487+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:03:01.487+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 4.0742806730000325
[2024-11-21T06:03:01.489+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:03:01.488+0000] {graph.py:487} INFO - Cosmos performance [4d3972a47987|148]: The cache size for cosmos_cache__nyc_green_taxi__transform is 2621
[2024-11-21T06:03:01.491+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:03:01.490+0000] {graph.py:495} INFO - Cosmos performance: Cache hit for cosmos_cache__nyc_green_taxi__transform - 0535576c8d7b9c0b5de17cec0f5a6dce,16a7af22baa01082ccbc983a81f25573
[2024-11-21T06:03:01.493+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:03:01.492+0000] {graph.py:412} INFO - Total nodes: 3
[2024-11-21T06:03:01.494+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:03:01.494+0000] {graph.py:413} INFO - Total filtered nodes: 3
[2024-11-21T06:03:01.495+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:03:01.495+0000] {converter.py:264} INFO - Cosmos performance (nyc_green_taxi__transform) -  [4d3972a47987|148]: It took 4.11s to parse the dbt project for DAG using LoadMode.DBT_LS_CACHE
[2024-11-21T06:03:01.505+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:03:01.505+0000] {converter.py:308} INFO - Cosmos performance (nyc_green_taxi__transform) - [4d3972a47987|148]: It took 0.00962s to build the Airflow DAG.
[2024-11-21T06:03:01.508+0000] {processor.py:840} INFO - DAG(s) 'nyc_green_taxi' retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:03:01.556+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:03:01.555+0000] {dag.py:3089} INFO - Sync 1 DAGs
[2024-11-21T06:03:01.603+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:03:01.602+0000] {dag.py:3947} INFO - Setting next_dagrun for nyc_green_taxi to 2024-11-20 00:00:00+00:00, run_after=2024-11-20 00:00:00+00:00
[2024-11-21T06:03:01.654+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 4.392 seconds
[2024-11-21T06:03:32.279+0000] {processor.py:161} INFO - Started process (PID=156) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:03:32.282+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T06:03:32.287+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:03:32.286+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:03:32.395+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:03:32.394+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T06:03:35.205+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:03:35.204+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 3.927179652999996
[2024-11-21T06:03:35.206+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:03:35.206+0000] {graph.py:487} INFO - Cosmos performance [4d3972a47987|156]: The cache size for cosmos_cache__nyc_green_taxi__transform is 2621
[2024-11-21T06:03:35.208+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:03:35.208+0000] {graph.py:495} INFO - Cosmos performance: Cache hit for cosmos_cache__nyc_green_taxi__transform - 0535576c8d7b9c0b5de17cec0f5a6dce,16a7af22baa01082ccbc983a81f25573
[2024-11-21T06:03:35.211+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:03:35.209+0000] {graph.py:412} INFO - Total nodes: 3
[2024-11-21T06:03:35.212+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:03:35.212+0000] {graph.py:413} INFO - Total filtered nodes: 3
[2024-11-21T06:03:35.213+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:03:35.213+0000] {converter.py:264} INFO - Cosmos performance (nyc_green_taxi__transform) -  [4d3972a47987|156]: It took 3.97s to parse the dbt project for DAG using LoadMode.DBT_LS_CACHE
[2024-11-21T06:03:35.224+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:03:35.224+0000] {converter.py:308} INFO - Cosmos performance (nyc_green_taxi__transform) - [4d3972a47987|156]: It took 0.0107s to build the Airflow DAG.
[2024-11-21T06:03:35.227+0000] {processor.py:840} INFO - DAG(s) 'nyc_green_taxi' retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:03:35.276+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:03:35.275+0000] {dag.py:3089} INFO - Sync 1 DAGs
[2024-11-21T06:03:35.330+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:03:35.330+0000] {dag.py:3947} INFO - Setting next_dagrun for nyc_green_taxi to 2024-11-20 00:00:00+00:00, run_after=2024-11-20 00:00:00+00:00
[2024-11-21T06:03:35.377+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 4.263 seconds
[2024-11-21T06:04:05.920+0000] {processor.py:161} INFO - Started process (PID=165) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:04:05.922+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T06:04:05.927+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:04:05.926+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:04:06.036+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:04:06.035+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T06:04:10.073+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:04:10.072+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 4.005565985999965
[2024-11-21T06:04:10.075+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:04:10.074+0000] {graph.py:487} INFO - Cosmos performance [4d3972a47987|165]: The cache size for cosmos_cache__nyc_green_taxi__transform is 2621
[2024-11-21T06:04:10.077+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:04:10.076+0000] {graph.py:495} INFO - Cosmos performance: Cache hit for cosmos_cache__nyc_green_taxi__transform - 0535576c8d7b9c0b5de17cec0f5a6dce,16a7af22baa01082ccbc983a81f25573
[2024-11-21T06:04:10.078+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:04:10.078+0000] {graph.py:412} INFO - Total nodes: 3
[2024-11-21T06:04:10.080+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:04:10.079+0000] {graph.py:413} INFO - Total filtered nodes: 3
[2024-11-21T06:04:10.081+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:04:10.081+0000] {converter.py:264} INFO - Cosmos performance (nyc_green_taxi__transform) -  [4d3972a47987|165]: It took 4.05s to parse the dbt project for DAG using LoadMode.DBT_LS_CACHE
[2024-11-21T06:04:10.092+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:04:10.091+0000] {converter.py:308} INFO - Cosmos performance (nyc_green_taxi__transform) - [4d3972a47987|165]: It took 0.0105s to build the Airflow DAG.
[2024-11-21T06:04:10.095+0000] {processor.py:840} INFO - DAG(s) 'nyc_green_taxi' retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:04:10.142+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:04:10.141+0000] {dag.py:3089} INFO - Sync 1 DAGs
[2024-11-21T06:04:10.188+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:04:10.188+0000] {dag.py:3947} INFO - Setting next_dagrun for nyc_green_taxi to 2024-11-20 00:00:00+00:00, run_after=2024-11-20 00:00:00+00:00
[2024-11-21T06:04:10.237+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 4.333 seconds
[2024-11-21T06:04:40.708+0000] {processor.py:161} INFO - Started process (PID=174) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:04:40.711+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T06:04:40.716+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:04:40.715+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:04:40.829+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:04:40.829+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T06:04:45.189+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:04:45.188+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 4.324551493000001
[2024-11-21T06:04:45.190+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:04:45.190+0000] {graph.py:487} INFO - Cosmos performance [4d3972a47987|174]: The cache size for cosmos_cache__nyc_green_taxi__transform is 2621
[2024-11-21T06:04:45.193+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:04:45.192+0000] {graph.py:495} INFO - Cosmos performance: Cache hit for cosmos_cache__nyc_green_taxi__transform - 0535576c8d7b9c0b5de17cec0f5a6dce,16a7af22baa01082ccbc983a81f25573
[2024-11-21T06:04:45.195+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:04:45.194+0000] {graph.py:412} INFO - Total nodes: 3
[2024-11-21T06:04:45.196+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:04:45.196+0000] {graph.py:413} INFO - Total filtered nodes: 3
[2024-11-21T06:04:45.198+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:04:45.197+0000] {converter.py:264} INFO - Cosmos performance (nyc_green_taxi__transform) -  [4d3972a47987|174]: It took 4.37s to parse the dbt project for DAG using LoadMode.DBT_LS_CACHE
[2024-11-21T06:04:45.208+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:04:45.208+0000] {converter.py:308} INFO - Cosmos performance (nyc_green_taxi__transform) - [4d3972a47987|174]: It took 0.0103s to build the Airflow DAG.
[2024-11-21T06:04:45.212+0000] {processor.py:840} INFO - DAG(s) 'nyc_green_taxi' retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:04:45.266+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:04:45.265+0000] {dag.py:3089} INFO - Sync 1 DAGs
[2024-11-21T06:04:45.312+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:04:45.311+0000] {dag.py:3947} INFO - Setting next_dagrun for nyc_green_taxi to 2024-11-20 00:00:00+00:00, run_after=2024-11-20 00:00:00+00:00
[2024-11-21T06:04:45.357+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 4.667 seconds
[2024-11-21T06:05:15.731+0000] {processor.py:161} INFO - Started process (PID=188) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:05:15.734+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T06:05:15.739+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:05:15.738+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:05:15.859+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:05:15.858+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T06:05:20.221+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:05:20.221+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 4.329888196000013
[2024-11-21T06:05:20.223+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:05:20.222+0000] {graph.py:487} INFO - Cosmos performance [4d3972a47987|188]: The cache size for cosmos_cache__nyc_green_taxi__transform is 2621
[2024-11-21T06:05:20.225+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:05:20.224+0000] {graph.py:495} INFO - Cosmos performance: Cache hit for cosmos_cache__nyc_green_taxi__transform - 0535576c8d7b9c0b5de17cec0f5a6dce,16a7af22baa01082ccbc983a81f25573
[2024-11-21T06:05:20.227+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:05:20.226+0000] {graph.py:412} INFO - Total nodes: 3
[2024-11-21T06:05:20.228+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:05:20.228+0000] {graph.py:413} INFO - Total filtered nodes: 3
[2024-11-21T06:05:20.229+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:05:20.229+0000] {converter.py:264} INFO - Cosmos performance (nyc_green_taxi__transform) -  [4d3972a47987|188]: It took 4.37s to parse the dbt project for DAG using LoadMode.DBT_LS_CACHE
[2024-11-21T06:05:20.240+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:05:20.239+0000] {converter.py:308} INFO - Cosmos performance (nyc_green_taxi__transform) - [4d3972a47987|188]: It took 0.0106s to build the Airflow DAG.
[2024-11-21T06:05:20.243+0000] {processor.py:840} INFO - DAG(s) 'nyc_green_taxi' retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:05:20.290+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:05:20.289+0000] {dag.py:3089} INFO - Sync 1 DAGs
[2024-11-21T06:05:20.334+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:05:20.334+0000] {dag.py:3947} INFO - Setting next_dagrun for nyc_green_taxi to 2024-11-20 00:00:00+00:00, run_after=2024-11-20 00:00:00+00:00
[2024-11-21T06:05:20.383+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 4.669 seconds
[2024-11-21T06:05:50.562+0000] {processor.py:161} INFO - Started process (PID=196) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:05:50.566+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T06:05:50.573+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:05:50.571+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:05:50.671+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:05:50.671+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T06:05:54.876+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:05:54.875+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 4.1662075909999885
[2024-11-21T06:05:54.878+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:05:54.877+0000] {graph.py:487} INFO - Cosmos performance [4d3972a47987|196]: The cache size for cosmos_cache__nyc_green_taxi__transform is 2621
[2024-11-21T06:05:54.880+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:05:54.879+0000] {graph.py:495} INFO - Cosmos performance: Cache hit for cosmos_cache__nyc_green_taxi__transform - 0535576c8d7b9c0b5de17cec0f5a6dce,16a7af22baa01082ccbc983a81f25573
[2024-11-21T06:05:54.881+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:05:54.881+0000] {graph.py:412} INFO - Total nodes: 3
[2024-11-21T06:05:54.883+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:05:54.882+0000] {graph.py:413} INFO - Total filtered nodes: 3
[2024-11-21T06:05:54.884+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:05:54.883+0000] {converter.py:264} INFO - Cosmos performance (nyc_green_taxi__transform) -  [4d3972a47987|196]: It took 4.21s to parse the dbt project for DAG using LoadMode.DBT_LS_CACHE
[2024-11-21T06:05:54.894+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:05:54.894+0000] {converter.py:308} INFO - Cosmos performance (nyc_green_taxi__transform) - [4d3972a47987|196]: It took 0.0103s to build the Airflow DAG.
[2024-11-21T06:05:54.897+0000] {processor.py:840} INFO - DAG(s) 'nyc_green_taxi' retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:05:54.941+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:05:54.940+0000] {dag.py:3089} INFO - Sync 1 DAGs
[2024-11-21T06:05:54.990+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:05:54.990+0000] {dag.py:3947} INFO - Setting next_dagrun for nyc_green_taxi to 2024-11-20 00:00:00+00:00, run_after=2024-11-20 00:00:00+00:00
[2024-11-21T06:05:55.042+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 4.503 seconds
[2024-11-21T06:06:25.206+0000] {processor.py:161} INFO - Started process (PID=204) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:06:25.208+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T06:06:25.212+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:06:25.212+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:06:25.319+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:06:25.319+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T06:06:28.621+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:06:28.620+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 4.257761889999983
[2024-11-21T06:06:28.622+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:06:28.622+0000] {graph.py:487} INFO - Cosmos performance [4d3972a47987|204]: The cache size for cosmos_cache__nyc_green_taxi__transform is 2621
[2024-11-21T06:06:28.624+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:06:28.624+0000] {graph.py:495} INFO - Cosmos performance: Cache hit for cosmos_cache__nyc_green_taxi__transform - 0535576c8d7b9c0b5de17cec0f5a6dce,16a7af22baa01082ccbc983a81f25573
[2024-11-21T06:06:28.626+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:06:28.625+0000] {graph.py:412} INFO - Total nodes: 3
[2024-11-21T06:06:28.627+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:06:28.627+0000] {graph.py:413} INFO - Total filtered nodes: 3
[2024-11-21T06:06:28.629+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:06:28.629+0000] {converter.py:264} INFO - Cosmos performance (nyc_green_taxi__transform) -  [4d3972a47987|204]: It took 4.3s to parse the dbt project for DAG using LoadMode.DBT_LS_CACHE
[2024-11-21T06:06:28.641+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:06:28.640+0000] {converter.py:308} INFO - Cosmos performance (nyc_green_taxi__transform) - [4d3972a47987|204]: It took 0.0118s to build the Airflow DAG.
[2024-11-21T06:06:28.644+0000] {processor.py:840} INFO - DAG(s) 'nyc_green_taxi' retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:06:28.690+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:06:28.690+0000] {dag.py:3089} INFO - Sync 1 DAGs
[2024-11-21T06:06:28.733+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:06:28.733+0000] {dag.py:3947} INFO - Setting next_dagrun for nyc_green_taxi to 2024-11-20 00:00:00+00:00, run_after=2024-11-20 00:00:00+00:00
[2024-11-21T06:06:28.774+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 4.570 seconds
[2024-11-21T06:06:59.350+0000] {processor.py:161} INFO - Started process (PID=212) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:06:59.353+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T06:06:59.357+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:06:59.356+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:06:59.461+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:06:59.460+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T06:07:03.418+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:07:03.417+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 3.9254698540000845
[2024-11-21T06:07:03.419+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:07:03.419+0000] {graph.py:487} INFO - Cosmos performance [4d3972a47987|212]: The cache size for cosmos_cache__nyc_green_taxi__transform is 2621
[2024-11-21T06:07:03.421+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:07:03.421+0000] {graph.py:495} INFO - Cosmos performance: Cache hit for cosmos_cache__nyc_green_taxi__transform - 0535576c8d7b9c0b5de17cec0f5a6dce,16a7af22baa01082ccbc983a81f25573
[2024-11-21T06:07:03.423+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:07:03.422+0000] {graph.py:412} INFO - Total nodes: 3
[2024-11-21T06:07:03.424+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:07:03.424+0000] {graph.py:413} INFO - Total filtered nodes: 3
[2024-11-21T06:07:03.426+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:07:03.425+0000] {converter.py:264} INFO - Cosmos performance (nyc_green_taxi__transform) -  [4d3972a47987|212]: It took 3.96s to parse the dbt project for DAG using LoadMode.DBT_LS_CACHE
[2024-11-21T06:07:03.436+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:07:03.435+0000] {converter.py:308} INFO - Cosmos performance (nyc_green_taxi__transform) - [4d3972a47987|212]: It took 0.00996s to build the Airflow DAG.
[2024-11-21T06:07:03.439+0000] {processor.py:840} INFO - DAG(s) 'nyc_green_taxi' retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:07:03.489+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:07:03.489+0000] {dag.py:3089} INFO - Sync 1 DAGs
[2024-11-21T06:07:03.535+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:07:03.534+0000] {dag.py:3947} INFO - Setting next_dagrun for nyc_green_taxi to 2024-11-20 00:00:00+00:00, run_after=2024-11-20 00:00:00+00:00
[2024-11-21T06:07:03.585+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 4.254 seconds
[2024-11-21T06:07:34.214+0000] {processor.py:161} INFO - Started process (PID=220) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:07:34.216+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T06:07:34.220+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:07:34.220+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:07:34.328+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:07:34.327+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T06:07:38.774+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:07:38.773+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 4.414649340999972
[2024-11-21T06:07:38.775+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:07:38.775+0000] {graph.py:487} INFO - Cosmos performance [4d3972a47987|220]: The cache size for cosmos_cache__nyc_green_taxi__transform is 2621
[2024-11-21T06:07:38.777+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:07:38.777+0000] {graph.py:495} INFO - Cosmos performance: Cache hit for cosmos_cache__nyc_green_taxi__transform - 0535576c8d7b9c0b5de17cec0f5a6dce,16a7af22baa01082ccbc983a81f25573
[2024-11-21T06:07:38.780+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:07:38.778+0000] {graph.py:412} INFO - Total nodes: 3
[2024-11-21T06:07:38.781+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:07:38.781+0000] {graph.py:413} INFO - Total filtered nodes: 3
[2024-11-21T06:07:38.783+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:07:38.782+0000] {converter.py:264} INFO - Cosmos performance (nyc_green_taxi__transform) -  [4d3972a47987|220]: It took 4.46s to parse the dbt project for DAG using LoadMode.DBT_LS_CACHE
[2024-11-21T06:07:38.794+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:07:38.793+0000] {converter.py:308} INFO - Cosmos performance (nyc_green_taxi__transform) - [4d3972a47987|220]: It took 0.0111s to build the Airflow DAG.
[2024-11-21T06:07:38.796+0000] {processor.py:840} INFO - DAG(s) 'nyc_green_taxi' retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:07:38.842+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:07:38.842+0000] {dag.py:3089} INFO - Sync 1 DAGs
[2024-11-21T06:07:38.886+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:07:38.886+0000] {dag.py:3947} INFO - Setting next_dagrun for nyc_green_taxi to 2024-11-20 00:00:00+00:00, run_after=2024-11-20 00:00:00+00:00
[2024-11-21T06:07:38.935+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 4.735 seconds
[2024-11-21T06:08:09.609+0000] {processor.py:161} INFO - Started process (PID=234) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:08:09.611+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T06:08:09.616+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:08:09.616+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:08:09.718+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:08:09.717+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T06:08:13.695+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:08:13.694+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 3.948474813999951
[2024-11-21T06:08:13.696+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:08:13.696+0000] {graph.py:487} INFO - Cosmos performance [4d3972a47987|234]: The cache size for cosmos_cache__nyc_green_taxi__transform is 2621
[2024-11-21T06:08:13.698+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:08:13.698+0000] {graph.py:495} INFO - Cosmos performance: Cache hit for cosmos_cache__nyc_green_taxi__transform - 0535576c8d7b9c0b5de17cec0f5a6dce,16a7af22baa01082ccbc983a81f25573
[2024-11-21T06:08:13.700+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:08:13.699+0000] {graph.py:412} INFO - Total nodes: 3
[2024-11-21T06:08:13.701+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:08:13.701+0000] {graph.py:413} INFO - Total filtered nodes: 3
[2024-11-21T06:08:13.703+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:08:13.702+0000] {converter.py:264} INFO - Cosmos performance (nyc_green_taxi__transform) -  [4d3972a47987|234]: It took 3.99s to parse the dbt project for DAG using LoadMode.DBT_LS_CACHE
[2024-11-21T06:08:13.712+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:08:13.712+0000] {converter.py:308} INFO - Cosmos performance (nyc_green_taxi__transform) - [4d3972a47987|234]: It took 0.00966s to build the Airflow DAG.
[2024-11-21T06:08:13.715+0000] {processor.py:840} INFO - DAG(s) 'nyc_green_taxi' retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:08:13.763+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:08:13.762+0000] {dag.py:3089} INFO - Sync 1 DAGs
[2024-11-21T06:08:13.807+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:08:13.806+0000] {dag.py:3947} INFO - Setting next_dagrun for nyc_green_taxi to 2024-11-20 00:00:00+00:00, run_after=2024-11-20 00:00:00+00:00
[2024-11-21T06:08:13.855+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 4.263 seconds
[2024-11-21T06:08:44.191+0000] {processor.py:161} INFO - Started process (PID=243) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:08:44.194+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T06:08:44.198+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:08:44.197+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:08:44.295+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:08:44.295+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T06:08:48.260+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:08:48.260+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 3.9312667319999264
[2024-11-21T06:08:48.262+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:08:48.261+0000] {graph.py:487} INFO - Cosmos performance [4d3972a47987|243]: The cache size for cosmos_cache__nyc_green_taxi__transform is 2621
[2024-11-21T06:08:48.264+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:08:48.263+0000] {graph.py:495} INFO - Cosmos performance: Cache hit for cosmos_cache__nyc_green_taxi__transform - 0535576c8d7b9c0b5de17cec0f5a6dce,16a7af22baa01082ccbc983a81f25573
[2024-11-21T06:08:48.265+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:08:48.265+0000] {graph.py:412} INFO - Total nodes: 3
[2024-11-21T06:08:48.267+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:08:48.267+0000] {graph.py:413} INFO - Total filtered nodes: 3
[2024-11-21T06:08:48.268+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:08:48.268+0000] {converter.py:264} INFO - Cosmos performance (nyc_green_taxi__transform) -  [4d3972a47987|243]: It took 3.97s to parse the dbt project for DAG using LoadMode.DBT_LS_CACHE
[2024-11-21T06:08:48.278+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:08:48.278+0000] {converter.py:308} INFO - Cosmos performance (nyc_green_taxi__transform) - [4d3972a47987|243]: It took 0.0101s to build the Airflow DAG.
[2024-11-21T06:08:48.281+0000] {processor.py:840} INFO - DAG(s) 'nyc_green_taxi' retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:08:48.329+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:08:48.329+0000] {dag.py:3089} INFO - Sync 1 DAGs
[2024-11-21T06:08:48.374+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:08:48.374+0000] {dag.py:3947} INFO - Setting next_dagrun for nyc_green_taxi to 2024-11-20 00:00:00+00:00, run_after=2024-11-20 00:00:00+00:00
[2024-11-21T06:08:48.426+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 4.252 seconds
[2024-11-21T06:09:18.759+0000] {processor.py:161} INFO - Started process (PID=251) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:09:18.762+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T06:09:18.767+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:09:18.766+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:09:18.875+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:09:18.874+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T06:09:21.656+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:09:21.655+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 3.8700052340000184
[2024-11-21T06:09:21.658+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:09:21.657+0000] {graph.py:487} INFO - Cosmos performance [4d3972a47987|251]: The cache size for cosmos_cache__nyc_green_taxi__transform is 2621
[2024-11-21T06:09:21.660+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:09:21.660+0000] {graph.py:495} INFO - Cosmos performance: Cache hit for cosmos_cache__nyc_green_taxi__transform - 0535576c8d7b9c0b5de17cec0f5a6dce,16a7af22baa01082ccbc983a81f25573
[2024-11-21T06:09:21.662+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:09:21.661+0000] {graph.py:412} INFO - Total nodes: 3
[2024-11-21T06:09:21.664+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:09:21.663+0000] {graph.py:413} INFO - Total filtered nodes: 3
[2024-11-21T06:09:21.665+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:09:21.665+0000] {converter.py:264} INFO - Cosmos performance (nyc_green_taxi__transform) -  [4d3972a47987|251]: It took 3.91s to parse the dbt project for DAG using LoadMode.DBT_LS_CACHE
[2024-11-21T06:09:21.677+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:09:21.677+0000] {converter.py:308} INFO - Cosmos performance (nyc_green_taxi__transform) - [4d3972a47987|251]: It took 0.0122s to build the Airflow DAG.
[2024-11-21T06:09:21.680+0000] {processor.py:840} INFO - DAG(s) 'nyc_green_taxi' retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:09:21.744+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:09:21.744+0000] {dag.py:3089} INFO - Sync 1 DAGs
[2024-11-21T06:09:21.804+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:09:21.803+0000] {dag.py:3947} INFO - Setting next_dagrun for nyc_green_taxi to 2024-11-20 00:00:00+00:00, run_after=2024-11-20 00:00:00+00:00
[2024-11-21T06:09:21.850+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 4.230 seconds
[2024-11-21T06:09:52.192+0000] {processor.py:161} INFO - Started process (PID=259) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:09:52.194+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T06:09:52.199+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:09:52.198+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:09:52.301+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:09:52.300+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T06:09:56.562+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:09:56.561+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 4.227457328000014
[2024-11-21T06:09:56.563+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:09:56.563+0000] {graph.py:487} INFO - Cosmos performance [4d3972a47987|259]: The cache size for cosmos_cache__nyc_green_taxi__transform is 2621
[2024-11-21T06:09:56.566+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:09:56.565+0000] {graph.py:495} INFO - Cosmos performance: Cache hit for cosmos_cache__nyc_green_taxi__transform - 0535576c8d7b9c0b5de17cec0f5a6dce,16a7af22baa01082ccbc983a81f25573
[2024-11-21T06:09:56.567+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:09:56.567+0000] {graph.py:412} INFO - Total nodes: 3
[2024-11-21T06:09:56.569+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:09:56.568+0000] {graph.py:413} INFO - Total filtered nodes: 3
[2024-11-21T06:09:56.570+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:09:56.570+0000] {converter.py:264} INFO - Cosmos performance (nyc_green_taxi__transform) -  [4d3972a47987|259]: It took 4.27s to parse the dbt project for DAG using LoadMode.DBT_LS_CACHE
[2024-11-21T06:09:56.580+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:09:56.580+0000] {converter.py:308} INFO - Cosmos performance (nyc_green_taxi__transform) - [4d3972a47987|259]: It took 0.0104s to build the Airflow DAG.
[2024-11-21T06:09:56.583+0000] {processor.py:840} INFO - DAG(s) 'nyc_green_taxi' retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:09:56.635+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:09:56.634+0000] {dag.py:3089} INFO - Sync 1 DAGs
[2024-11-21T06:09:56.685+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:09:56.684+0000] {dag.py:3947} INFO - Setting next_dagrun for nyc_green_taxi to 2024-11-20 00:00:00+00:00, run_after=2024-11-20 00:00:00+00:00
[2024-11-21T06:09:56.742+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 4.565 seconds
[2024-11-21T06:10:27.235+0000] {processor.py:161} INFO - Started process (PID=267) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:10:27.239+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T06:10:27.244+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:10:27.243+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:10:27.369+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:10:27.368+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T06:10:31.700+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:10:31.699+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 4.292197106000003
[2024-11-21T06:10:31.701+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:10:31.701+0000] {graph.py:487} INFO - Cosmos performance [4d3972a47987|267]: The cache size for cosmos_cache__nyc_green_taxi__transform is 2621
[2024-11-21T06:10:31.704+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:10:31.704+0000] {graph.py:495} INFO - Cosmos performance: Cache hit for cosmos_cache__nyc_green_taxi__transform - 0535576c8d7b9c0b5de17cec0f5a6dce,16a7af22baa01082ccbc983a81f25573
[2024-11-21T06:10:31.706+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:10:31.705+0000] {graph.py:412} INFO - Total nodes: 3
[2024-11-21T06:10:31.707+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:10:31.707+0000] {graph.py:413} INFO - Total filtered nodes: 3
[2024-11-21T06:10:31.709+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:10:31.709+0000] {converter.py:264} INFO - Cosmos performance (nyc_green_taxi__transform) -  [4d3972a47987|267]: It took 4.34s to parse the dbt project for DAG using LoadMode.DBT_LS_CACHE
[2024-11-21T06:10:31.721+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:10:31.720+0000] {converter.py:308} INFO - Cosmos performance (nyc_green_taxi__transform) - [4d3972a47987|267]: It took 0.0118s to build the Airflow DAG.
[2024-11-21T06:10:31.724+0000] {processor.py:840} INFO - DAG(s) 'nyc_green_taxi' retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:10:31.781+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:10:31.780+0000] {dag.py:3089} INFO - Sync 1 DAGs
[2024-11-21T06:10:31.833+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:10:31.832+0000] {dag.py:3947} INFO - Setting next_dagrun for nyc_green_taxi to 2024-11-20 00:00:00+00:00, run_after=2024-11-20 00:00:00+00:00
[2024-11-21T06:10:31.886+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 4.670 seconds
[2024-11-21T06:11:02.533+0000] {processor.py:161} INFO - Started process (PID=281) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:11:02.535+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T06:11:02.540+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:11:02.539+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:11:02.647+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:11:02.647+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T06:11:07.017+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:11:07.017+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 4.333539377999955
[2024-11-21T06:11:07.019+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:11:07.018+0000] {graph.py:487} INFO - Cosmos performance [4d3972a47987|281]: The cache size for cosmos_cache__nyc_green_taxi__transform is 2621
[2024-11-21T06:11:07.021+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:11:07.021+0000] {graph.py:495} INFO - Cosmos performance: Cache hit for cosmos_cache__nyc_green_taxi__transform - 0535576c8d7b9c0b5de17cec0f5a6dce,16a7af22baa01082ccbc983a81f25573
[2024-11-21T06:11:07.023+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:11:07.022+0000] {graph.py:412} INFO - Total nodes: 3
[2024-11-21T06:11:07.024+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:11:07.024+0000] {graph.py:413} INFO - Total filtered nodes: 3
[2024-11-21T06:11:07.026+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:11:07.025+0000] {converter.py:264} INFO - Cosmos performance (nyc_green_taxi__transform) -  [4d3972a47987|281]: It took 4.38s to parse the dbt project for DAG using LoadMode.DBT_LS_CACHE
[2024-11-21T06:11:07.036+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:11:07.035+0000] {converter.py:308} INFO - Cosmos performance (nyc_green_taxi__transform) - [4d3972a47987|281]: It took 0.0103s to build the Airflow DAG.
[2024-11-21T06:11:07.039+0000] {processor.py:840} INFO - DAG(s) 'nyc_green_taxi' retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:11:07.090+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:11:07.089+0000] {dag.py:3089} INFO - Sync 1 DAGs
[2024-11-21T06:11:07.139+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:11:07.139+0000] {dag.py:3947} INFO - Setting next_dagrun for nyc_green_taxi to 2024-11-20 00:00:00+00:00, run_after=2024-11-20 00:00:00+00:00
[2024-11-21T06:11:07.181+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 4.666 seconds
[2024-11-21T06:11:37.600+0000] {processor.py:161} INFO - Started process (PID=289) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:11:37.603+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T06:11:37.608+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:11:37.607+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:11:37.720+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:11:37.719+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T06:11:42.085+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:11:42.084+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 4.3327573450000045
[2024-11-21T06:11:42.086+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:11:42.086+0000] {graph.py:487} INFO - Cosmos performance [4d3972a47987|289]: The cache size for cosmos_cache__nyc_green_taxi__transform is 2621
[2024-11-21T06:11:42.088+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:11:42.088+0000] {graph.py:495} INFO - Cosmos performance: Cache hit for cosmos_cache__nyc_green_taxi__transform - 0535576c8d7b9c0b5de17cec0f5a6dce,16a7af22baa01082ccbc983a81f25573
[2024-11-21T06:11:42.090+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:11:42.089+0000] {graph.py:412} INFO - Total nodes: 3
[2024-11-21T06:11:42.092+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:11:42.091+0000] {graph.py:413} INFO - Total filtered nodes: 3
[2024-11-21T06:11:42.093+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:11:42.093+0000] {converter.py:264} INFO - Cosmos performance (nyc_green_taxi__transform) -  [4d3972a47987|289]: It took 4.37s to parse the dbt project for DAG using LoadMode.DBT_LS_CACHE
[2024-11-21T06:11:42.103+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:11:42.103+0000] {converter.py:308} INFO - Cosmos performance (nyc_green_taxi__transform) - [4d3972a47987|289]: It took 0.0103s to build the Airflow DAG.
[2024-11-21T06:11:42.106+0000] {processor.py:840} INFO - DAG(s) 'nyc_green_taxi' retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:11:42.153+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:11:42.153+0000] {dag.py:3089} INFO - Sync 1 DAGs
[2024-11-21T06:11:42.196+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:11:42.196+0000] {dag.py:3947} INFO - Setting next_dagrun for nyc_green_taxi to 2024-11-20 00:00:00+00:00, run_after=2024-11-20 00:00:00+00:00
[2024-11-21T06:11:42.244+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 4.663 seconds
[2024-11-21T06:12:12.536+0000] {processor.py:161} INFO - Started process (PID=297) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:12:12.539+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T06:12:12.543+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:12:12.543+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:12:12.658+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:12:12.658+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T06:12:16.096+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:12:16.096+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 4.294854162999968
[2024-11-21T06:12:16.098+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:12:16.097+0000] {graph.py:487} INFO - Cosmos performance [4d3972a47987|297]: The cache size for cosmos_cache__nyc_green_taxi__transform is 2621
[2024-11-21T06:12:16.100+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:12:16.099+0000] {graph.py:495} INFO - Cosmos performance: Cache hit for cosmos_cache__nyc_green_taxi__transform - 0535576c8d7b9c0b5de17cec0f5a6dce,16a7af22baa01082ccbc983a81f25573
[2024-11-21T06:12:16.102+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:12:16.101+0000] {graph.py:412} INFO - Total nodes: 3
[2024-11-21T06:12:16.103+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:12:16.103+0000] {graph.py:413} INFO - Total filtered nodes: 3
[2024-11-21T06:12:16.104+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:12:16.104+0000] {converter.py:264} INFO - Cosmos performance (nyc_green_taxi__transform) -  [4d3972a47987|297]: It took 4.34s to parse the dbt project for DAG using LoadMode.DBT_LS_CACHE
[2024-11-21T06:12:16.114+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:12:16.114+0000] {converter.py:308} INFO - Cosmos performance (nyc_green_taxi__transform) - [4d3972a47987|297]: It took 0.01s to build the Airflow DAG.
[2024-11-21T06:12:16.118+0000] {processor.py:840} INFO - DAG(s) 'nyc_green_taxi' retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:12:16.162+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:12:16.162+0000] {dag.py:3089} INFO - Sync 1 DAGs
[2024-11-21T06:12:16.203+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:12:16.202+0000] {dag.py:3947} INFO - Setting next_dagrun for nyc_green_taxi to 2024-11-20 00:00:00+00:00, run_after=2024-11-20 00:00:00+00:00
[2024-11-21T06:12:16.246+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 4.619 seconds
[2024-11-21T06:12:46.390+0000] {processor.py:161} INFO - Started process (PID=305) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:12:46.392+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T06:12:46.397+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:12:46.396+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:12:46.506+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:12:46.505+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T06:12:50.692+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:12:50.691+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 4.152999887000078
[2024-11-21T06:12:50.693+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:12:50.693+0000] {graph.py:487} INFO - Cosmos performance [4d3972a47987|305]: The cache size for cosmos_cache__nyc_green_taxi__transform is 2621
[2024-11-21T06:12:50.695+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:12:50.695+0000] {graph.py:495} INFO - Cosmos performance: Cache hit for cosmos_cache__nyc_green_taxi__transform - 0535576c8d7b9c0b5de17cec0f5a6dce,16a7af22baa01082ccbc983a81f25573
[2024-11-21T06:12:50.697+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:12:50.696+0000] {graph.py:412} INFO - Total nodes: 3
[2024-11-21T06:12:50.698+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:12:50.698+0000] {graph.py:413} INFO - Total filtered nodes: 3
[2024-11-21T06:12:50.700+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:12:50.699+0000] {converter.py:264} INFO - Cosmos performance (nyc_green_taxi__transform) -  [4d3972a47987|305]: It took 4.19s to parse the dbt project for DAG using LoadMode.DBT_LS_CACHE
[2024-11-21T06:12:50.709+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:12:50.709+0000] {converter.py:308} INFO - Cosmos performance (nyc_green_taxi__transform) - [4d3972a47987|305]: It took 0.00924s to build the Airflow DAG.
[2024-11-21T06:12:50.712+0000] {processor.py:840} INFO - DAG(s) 'nyc_green_taxi' retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:12:50.756+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:12:50.756+0000] {dag.py:3089} INFO - Sync 1 DAGs
[2024-11-21T06:12:50.798+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:12:50.798+0000] {dag.py:3947} INFO - Setting next_dagrun for nyc_green_taxi to 2024-11-20 00:00:00+00:00, run_after=2024-11-20 00:00:00+00:00
[2024-11-21T06:12:50.844+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 4.473 seconds
[2024-11-21T06:13:21.030+0000] {processor.py:161} INFO - Started process (PID=320) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:13:21.032+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T06:13:21.037+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:13:21.036+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:13:21.140+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:13:21.140+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T06:13:25.443+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:13:25.442+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 4.270231036999917
[2024-11-21T06:13:25.444+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:13:25.444+0000] {graph.py:487} INFO - Cosmos performance [4d3972a47987|320]: The cache size for cosmos_cache__nyc_green_taxi__transform is 2621
[2024-11-21T06:13:25.446+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:13:25.446+0000] {graph.py:495} INFO - Cosmos performance: Cache hit for cosmos_cache__nyc_green_taxi__transform - 0535576c8d7b9c0b5de17cec0f5a6dce,16a7af22baa01082ccbc983a81f25573
[2024-11-21T06:13:25.448+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:13:25.447+0000] {graph.py:412} INFO - Total nodes: 3
[2024-11-21T06:13:25.449+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:13:25.449+0000] {graph.py:413} INFO - Total filtered nodes: 3
[2024-11-21T06:13:25.451+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:13:25.450+0000] {converter.py:264} INFO - Cosmos performance (nyc_green_taxi__transform) -  [4d3972a47987|320]: It took 4.31s to parse the dbt project for DAG using LoadMode.DBT_LS_CACHE
[2024-11-21T06:13:25.461+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:13:25.460+0000] {converter.py:308} INFO - Cosmos performance (nyc_green_taxi__transform) - [4d3972a47987|320]: It took 0.0102s to build the Airflow DAG.
[2024-11-21T06:13:25.464+0000] {processor.py:840} INFO - DAG(s) 'nyc_green_taxi' retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:13:25.525+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:13:25.524+0000] {dag.py:3089} INFO - Sync 1 DAGs
[2024-11-21T06:13:25.586+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:13:25.585+0000] {dag.py:3947} INFO - Setting next_dagrun for nyc_green_taxi to 2024-11-20 00:00:00+00:00, run_after=2024-11-20 00:00:00+00:00
[2024-11-21T06:13:25.629+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 4.615 seconds
[2024-11-21T06:13:55.822+0000] {processor.py:161} INFO - Started process (PID=328) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:13:55.824+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T06:13:55.828+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:13:55.827+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:13:55.924+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:13:55.924+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T06:14:00.021+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:14:00.020+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 4.065861685000073
[2024-11-21T06:14:00.022+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:14:00.022+0000] {graph.py:487} INFO - Cosmos performance [4d3972a47987|328]: The cache size for cosmos_cache__nyc_green_taxi__transform is 2621
[2024-11-21T06:14:00.025+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:14:00.024+0000] {graph.py:495} INFO - Cosmos performance: Cache hit for cosmos_cache__nyc_green_taxi__transform - 0535576c8d7b9c0b5de17cec0f5a6dce,16a7af22baa01082ccbc983a81f25573
[2024-11-21T06:14:00.026+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:14:00.025+0000] {graph.py:412} INFO - Total nodes: 3
[2024-11-21T06:14:00.027+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:14:00.027+0000] {graph.py:413} INFO - Total filtered nodes: 3
[2024-11-21T06:14:00.029+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:14:00.028+0000] {converter.py:264} INFO - Cosmos performance (nyc_green_taxi__transform) -  [4d3972a47987|328]: It took 4.1s to parse the dbt project for DAG using LoadMode.DBT_LS_CACHE
[2024-11-21T06:14:00.039+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:14:00.039+0000] {converter.py:308} INFO - Cosmos performance (nyc_green_taxi__transform) - [4d3972a47987|328]: It took 0.0107s to build the Airflow DAG.
[2024-11-21T06:14:00.042+0000] {processor.py:840} INFO - DAG(s) 'nyc_green_taxi' retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:14:00.090+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:14:00.090+0000] {dag.py:3089} INFO - Sync 1 DAGs
[2024-11-21T06:14:00.143+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:14:00.142+0000] {dag.py:3947} INFO - Setting next_dagrun for nyc_green_taxi to 2024-11-20 00:00:00+00:00, run_after=2024-11-20 00:00:00+00:00
[2024-11-21T06:14:00.189+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 4.382 seconds
[2024-11-21T06:14:30.564+0000] {processor.py:161} INFO - Started process (PID=336) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:14:30.566+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T06:14:30.570+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:14:30.570+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:14:30.651+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:14:30.651+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T06:14:33.883+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:14:33.883+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 3.204239443000006
[2024-11-21T06:14:33.885+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:14:33.884+0000] {graph.py:487} INFO - Cosmos performance [4d3972a47987|336]: The cache size for cosmos_cache__nyc_green_taxi__transform is 2621
[2024-11-21T06:14:33.887+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:14:33.886+0000] {graph.py:495} INFO - Cosmos performance: Cache hit for cosmos_cache__nyc_green_taxi__transform - 0535576c8d7b9c0b5de17cec0f5a6dce,16a7af22baa01082ccbc983a81f25573
[2024-11-21T06:14:33.888+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:14:33.887+0000] {graph.py:412} INFO - Total nodes: 3
[2024-11-21T06:14:33.890+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:14:33.889+0000] {graph.py:413} INFO - Total filtered nodes: 3
[2024-11-21T06:14:33.891+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:14:33.891+0000] {converter.py:264} INFO - Cosmos performance (nyc_green_taxi__transform) -  [4d3972a47987|336]: It took 3.24s to parse the dbt project for DAG using LoadMode.DBT_LS_CACHE
[2024-11-21T06:14:33.902+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:14:33.902+0000] {converter.py:308} INFO - Cosmos performance (nyc_green_taxi__transform) - [4d3972a47987|336]: It took 0.0108s to build the Airflow DAG.
[2024-11-21T06:14:33.906+0000] {processor.py:840} INFO - DAG(s) 'nyc_green_taxi' retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:14:33.961+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:14:33.960+0000] {dag.py:3089} INFO - Sync 1 DAGs
[2024-11-21T06:14:34.029+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:14:34.028+0000] {dag.py:3947} INFO - Setting next_dagrun for nyc_green_taxi to 2024-11-20 00:00:00+00:00, run_after=2024-11-20 00:00:00+00:00
[2024-11-21T06:14:34.080+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 3.534 seconds
[2024-11-21T06:15:04.217+0000] {processor.py:161} INFO - Started process (PID=344) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:15:04.219+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T06:15:04.223+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:15:04.223+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:15:04.335+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:15:04.334+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T06:15:06.950+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:15:06.949+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 3.8643981420000273
[2024-11-21T06:15:06.951+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:15:06.951+0000] {graph.py:487} INFO - Cosmos performance [4d3972a47987|344]: The cache size for cosmos_cache__nyc_green_taxi__transform is 2621
[2024-11-21T06:15:06.953+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:15:06.953+0000] {graph.py:495} INFO - Cosmos performance: Cache hit for cosmos_cache__nyc_green_taxi__transform - 0535576c8d7b9c0b5de17cec0f5a6dce,16a7af22baa01082ccbc983a81f25573
[2024-11-21T06:15:06.955+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:15:06.954+0000] {graph.py:412} INFO - Total nodes: 3
[2024-11-21T06:15:06.956+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:15:06.956+0000] {graph.py:413} INFO - Total filtered nodes: 3
[2024-11-21T06:15:06.958+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:15:06.957+0000] {converter.py:264} INFO - Cosmos performance (nyc_green_taxi__transform) -  [4d3972a47987|344]: It took 3.9s to parse the dbt project for DAG using LoadMode.DBT_LS_CACHE
[2024-11-21T06:15:06.968+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:15:06.967+0000] {converter.py:308} INFO - Cosmos performance (nyc_green_taxi__transform) - [4d3972a47987|344]: It took 0.0102s to build the Airflow DAG.
[2024-11-21T06:15:06.971+0000] {processor.py:840} INFO - DAG(s) 'nyc_green_taxi' retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:15:07.019+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:15:07.019+0000] {dag.py:3089} INFO - Sync 1 DAGs
[2024-11-21T06:15:07.065+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:15:07.064+0000] {dag.py:3947} INFO - Setting next_dagrun for nyc_green_taxi to 2024-11-20 00:00:00+00:00, run_after=2024-11-20 00:00:00+00:00
[2024-11-21T06:15:07.117+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 4.196 seconds
[2024-11-21T06:15:37.709+0000] {processor.py:161} INFO - Started process (PID=352) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:15:37.711+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T06:15:37.716+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:15:37.715+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:15:37.830+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:15:37.830+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T06:15:42.262+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:15:42.261+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 4.397495486000025
[2024-11-21T06:15:42.263+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:15:42.263+0000] {graph.py:487} INFO - Cosmos performance [4d3972a47987|352]: The cache size for cosmos_cache__nyc_green_taxi__transform is 2621
[2024-11-21T06:15:42.266+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:15:42.265+0000] {graph.py:495} INFO - Cosmos performance: Cache hit for cosmos_cache__nyc_green_taxi__transform - 0535576c8d7b9c0b5de17cec0f5a6dce,16a7af22baa01082ccbc983a81f25573
[2024-11-21T06:15:42.267+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:15:42.267+0000] {graph.py:412} INFO - Total nodes: 3
[2024-11-21T06:15:42.269+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:15:42.268+0000] {graph.py:413} INFO - Total filtered nodes: 3
[2024-11-21T06:15:42.270+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:15:42.270+0000] {converter.py:264} INFO - Cosmos performance (nyc_green_taxi__transform) -  [4d3972a47987|352]: It took 4.44s to parse the dbt project for DAG using LoadMode.DBT_LS_CACHE
[2024-11-21T06:15:42.280+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:15:42.280+0000] {converter.py:308} INFO - Cosmos performance (nyc_green_taxi__transform) - [4d3972a47987|352]: It took 0.0103s to build the Airflow DAG.
[2024-11-21T06:15:42.284+0000] {processor.py:840} INFO - DAG(s) 'nyc_green_taxi' retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:15:42.332+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:15:42.332+0000] {dag.py:3089} INFO - Sync 1 DAGs
[2024-11-21T06:15:42.381+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:15:42.380+0000] {dag.py:3947} INFO - Setting next_dagrun for nyc_green_taxi to 2024-11-20 00:00:00+00:00, run_after=2024-11-20 00:00:00+00:00
[2024-11-21T06:15:42.421+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 4.728 seconds
[2024-11-21T06:16:12.854+0000] {processor.py:161} INFO - Started process (PID=360) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:16:12.856+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T06:16:12.861+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:16:12.860+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:16:12.967+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:16:12.966+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T06:16:17.319+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:16:17.319+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 4.319949468999994
[2024-11-21T06:16:17.321+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:16:17.321+0000] {graph.py:487} INFO - Cosmos performance [4d3972a47987|360]: The cache size for cosmos_cache__nyc_green_taxi__transform is 2621
[2024-11-21T06:16:17.323+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:16:17.323+0000] {graph.py:495} INFO - Cosmos performance: Cache hit for cosmos_cache__nyc_green_taxi__transform - 0535576c8d7b9c0b5de17cec0f5a6dce,16a7af22baa01082ccbc983a81f25573
[2024-11-21T06:16:17.325+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:16:17.324+0000] {graph.py:412} INFO - Total nodes: 3
[2024-11-21T06:16:17.327+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:16:17.326+0000] {graph.py:413} INFO - Total filtered nodes: 3
[2024-11-21T06:16:17.328+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:16:17.328+0000] {converter.py:264} INFO - Cosmos performance (nyc_green_taxi__transform) -  [4d3972a47987|360]: It took 4.36s to parse the dbt project for DAG using LoadMode.DBT_LS_CACHE
[2024-11-21T06:16:17.340+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:16:17.340+0000] {converter.py:308} INFO - Cosmos performance (nyc_green_taxi__transform) - [4d3972a47987|360]: It took 0.012s to build the Airflow DAG.
[2024-11-21T06:16:17.344+0000] {processor.py:840} INFO - DAG(s) 'nyc_green_taxi' retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:16:17.407+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:16:17.406+0000] {dag.py:3089} INFO - Sync 1 DAGs
[2024-11-21T06:16:17.461+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:16:17.461+0000] {dag.py:3947} INFO - Setting next_dagrun for nyc_green_taxi to 2024-11-20 00:00:00+00:00, run_after=2024-11-20 00:00:00+00:00
[2024-11-21T06:16:17.514+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 4.677 seconds
[2024-11-21T06:16:48.330+0000] {processor.py:161} INFO - Started process (PID=374) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:16:48.332+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T06:16:48.337+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:16:48.336+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:16:48.444+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:16:48.443+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T06:16:52.671+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:16:52.670+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 4.197633684999801
[2024-11-21T06:16:52.672+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:16:52.672+0000] {graph.py:487} INFO - Cosmos performance [4d3972a47987|374]: The cache size for cosmos_cache__nyc_green_taxi__transform is 2621
[2024-11-21T06:16:52.674+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:16:52.674+0000] {graph.py:495} INFO - Cosmos performance: Cache hit for cosmos_cache__nyc_green_taxi__transform - 0535576c8d7b9c0b5de17cec0f5a6dce,16a7af22baa01082ccbc983a81f25573
[2024-11-21T06:16:52.676+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:16:52.675+0000] {graph.py:412} INFO - Total nodes: 3
[2024-11-21T06:16:52.677+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:16:52.677+0000] {graph.py:413} INFO - Total filtered nodes: 3
[2024-11-21T06:16:52.678+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:16:52.678+0000] {converter.py:264} INFO - Cosmos performance (nyc_green_taxi__transform) -  [4d3972a47987|374]: It took 4.24s to parse the dbt project for DAG using LoadMode.DBT_LS_CACHE
[2024-11-21T06:16:52.689+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:16:52.689+0000] {converter.py:308} INFO - Cosmos performance (nyc_green_taxi__transform) - [4d3972a47987|374]: It took 0.0106s to build the Airflow DAG.
[2024-11-21T06:16:52.693+0000] {processor.py:840} INFO - DAG(s) 'nyc_green_taxi' retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:16:52.739+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:16:52.738+0000] {dag.py:3089} INFO - Sync 1 DAGs
[2024-11-21T06:16:52.781+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:16:52.780+0000] {dag.py:3947} INFO - Setting next_dagrun for nyc_green_taxi to 2024-11-20 00:00:00+00:00, run_after=2024-11-20 00:00:00+00:00
[2024-11-21T06:16:52.826+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 4.511 seconds
[2024-11-21T06:17:23.429+0000] {processor.py:161} INFO - Started process (PID=383) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:17:23.431+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T06:17:23.436+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:17:23.436+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:17:23.541+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:17:23.541+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T06:17:27.867+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:17:27.867+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 4.295479959999966
[2024-11-21T06:17:27.869+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:17:27.869+0000] {graph.py:487} INFO - Cosmos performance [4d3972a47987|383]: The cache size for cosmos_cache__nyc_green_taxi__transform is 2621
[2024-11-21T06:17:27.871+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:17:27.871+0000] {graph.py:495} INFO - Cosmos performance: Cache hit for cosmos_cache__nyc_green_taxi__transform - 0535576c8d7b9c0b5de17cec0f5a6dce,16a7af22baa01082ccbc983a81f25573
[2024-11-21T06:17:27.873+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:17:27.872+0000] {graph.py:412} INFO - Total nodes: 3
[2024-11-21T06:17:27.875+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:17:27.875+0000] {graph.py:413} INFO - Total filtered nodes: 3
[2024-11-21T06:17:27.879+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:17:27.878+0000] {converter.py:264} INFO - Cosmos performance (nyc_green_taxi__transform) -  [4d3972a47987|383]: It took 4.34s to parse the dbt project for DAG using LoadMode.DBT_LS_CACHE
[2024-11-21T06:17:27.891+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:17:27.891+0000] {converter.py:308} INFO - Cosmos performance (nyc_green_taxi__transform) - [4d3972a47987|383]: It took 0.0121s to build the Airflow DAG.
[2024-11-21T06:17:27.894+0000] {processor.py:840} INFO - DAG(s) 'nyc_green_taxi' retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:17:27.939+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:17:27.939+0000] {dag.py:3089} INFO - Sync 1 DAGs
[2024-11-21T06:17:27.987+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:17:27.986+0000] {dag.py:3947} INFO - Setting next_dagrun for nyc_green_taxi to 2024-11-20 00:00:00+00:00, run_after=2024-11-20 00:00:00+00:00
[2024-11-21T06:17:28.033+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 4.623 seconds
[2024-11-21T06:17:58.742+0000] {processor.py:161} INFO - Started process (PID=391) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:17:58.744+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T06:17:58.748+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:17:58.748+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:17:58.859+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:17:58.858+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T06:18:03.056+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:18:03.055+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 4.164712970999972
[2024-11-21T06:18:03.057+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:18:03.057+0000] {graph.py:487} INFO - Cosmos performance [4d3972a47987|391]: The cache size for cosmos_cache__nyc_green_taxi__transform is 2621
[2024-11-21T06:18:03.059+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:18:03.058+0000] {graph.py:495} INFO - Cosmos performance: Cache hit for cosmos_cache__nyc_green_taxi__transform - 0535576c8d7b9c0b5de17cec0f5a6dce,16a7af22baa01082ccbc983a81f25573
[2024-11-21T06:18:03.060+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:18:03.059+0000] {graph.py:412} INFO - Total nodes: 3
[2024-11-21T06:18:03.062+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:18:03.061+0000] {graph.py:413} INFO - Total filtered nodes: 3
[2024-11-21T06:18:03.063+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:18:03.063+0000] {converter.py:264} INFO - Cosmos performance (nyc_green_taxi__transform) -  [4d3972a47987|391]: It took 4.2s to parse the dbt project for DAG using LoadMode.DBT_LS_CACHE
[2024-11-21T06:18:03.073+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:18:03.073+0000] {converter.py:308} INFO - Cosmos performance (nyc_green_taxi__transform) - [4d3972a47987|391]: It took 0.0101s to build the Airflow DAG.
[2024-11-21T06:18:03.076+0000] {processor.py:840} INFO - DAG(s) 'nyc_green_taxi' retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:18:03.125+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:18:03.124+0000] {dag.py:3089} INFO - Sync 1 DAGs
[2024-11-21T06:18:03.165+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:18:03.164+0000] {dag.py:3947} INFO - Setting next_dagrun for nyc_green_taxi to 2024-11-20 00:00:00+00:00, run_after=2024-11-20 00:00:00+00:00
[2024-11-21T06:18:03.218+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 4.492 seconds
[2024-11-21T06:18:33.353+0000] {processor.py:161} INFO - Started process (PID=399) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:18:33.355+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T06:18:33.358+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:18:33.358+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:18:33.477+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:18:33.476+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T06:18:37.620+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:18:37.619+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 4.112674104999996
[2024-11-21T06:18:37.621+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:18:37.621+0000] {graph.py:487} INFO - Cosmos performance [4d3972a47987|399]: The cache size for cosmos_cache__nyc_green_taxi__transform is 2621
[2024-11-21T06:18:37.624+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:18:37.623+0000] {graph.py:495} INFO - Cosmos performance: Cache hit for cosmos_cache__nyc_green_taxi__transform - 0535576c8d7b9c0b5de17cec0f5a6dce,16a7af22baa01082ccbc983a81f25573
[2024-11-21T06:18:37.626+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:18:37.625+0000] {graph.py:412} INFO - Total nodes: 3
[2024-11-21T06:18:37.627+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:18:37.627+0000] {graph.py:413} INFO - Total filtered nodes: 3
[2024-11-21T06:18:37.629+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:18:37.628+0000] {converter.py:264} INFO - Cosmos performance (nyc_green_taxi__transform) -  [4d3972a47987|399]: It took 4.15s to parse the dbt project for DAG using LoadMode.DBT_LS_CACHE
[2024-11-21T06:18:37.638+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:18:37.637+0000] {converter.py:308} INFO - Cosmos performance (nyc_green_taxi__transform) - [4d3972a47987|399]: It took 0.00906s to build the Airflow DAG.
[2024-11-21T06:18:37.641+0000] {processor.py:840} INFO - DAG(s) 'nyc_green_taxi' retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:18:37.687+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:18:37.687+0000] {dag.py:3089} INFO - Sync 1 DAGs
[2024-11-21T06:18:37.727+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:18:37.726+0000] {dag.py:3947} INFO - Setting next_dagrun for nyc_green_taxi to 2024-11-20 00:00:00+00:00, run_after=2024-11-20 00:00:00+00:00
[2024-11-21T06:18:37.765+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 4.427 seconds
[2024-11-21T06:19:08.062+0000] {processor.py:161} INFO - Started process (PID=413) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:19:08.064+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T06:19:08.069+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:19:08.069+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:19:08.181+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:19:08.180+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T06:19:12.383+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:19:12.382+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 4.162755445999892
[2024-11-21T06:19:12.384+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:19:12.384+0000] {graph.py:487} INFO - Cosmos performance [4d3972a47987|413]: The cache size for cosmos_cache__nyc_green_taxi__transform is 2621
[2024-11-21T06:19:12.386+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:19:12.385+0000] {graph.py:495} INFO - Cosmos performance: Cache hit for cosmos_cache__nyc_green_taxi__transform - 0535576c8d7b9c0b5de17cec0f5a6dce,16a7af22baa01082ccbc983a81f25573
[2024-11-21T06:19:12.388+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:19:12.387+0000] {graph.py:412} INFO - Total nodes: 3
[2024-11-21T06:19:12.389+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:19:12.388+0000] {graph.py:413} INFO - Total filtered nodes: 3
[2024-11-21T06:19:12.390+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:19:12.390+0000] {converter.py:264} INFO - Cosmos performance (nyc_green_taxi__transform) -  [4d3972a47987|413]: It took 4.21s to parse the dbt project for DAG using LoadMode.DBT_LS_CACHE
[2024-11-21T06:19:12.400+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:19:12.400+0000] {converter.py:308} INFO - Cosmos performance (nyc_green_taxi__transform) - [4d3972a47987|413]: It took 0.0098s to build the Airflow DAG.
[2024-11-21T06:19:12.403+0000] {processor.py:840} INFO - DAG(s) 'nyc_green_taxi' retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:19:12.446+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:19:12.446+0000] {dag.py:3089} INFO - Sync 1 DAGs
[2024-11-21T06:19:12.487+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:19:12.487+0000] {dag.py:3947} INFO - Setting next_dagrun for nyc_green_taxi to 2024-11-20 00:00:00+00:00, run_after=2024-11-20 00:00:00+00:00
[2024-11-21T06:19:12.540+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 4.497 seconds
[2024-11-21T06:19:42.810+0000] {processor.py:161} INFO - Started process (PID=421) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:19:42.816+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T06:19:42.826+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:19:42.825+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:19:42.947+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:19:42.947+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T06:19:46.610+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:19:46.610+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 3.6187956500000382
[2024-11-21T06:19:46.611+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:19:46.611+0000] {graph.py:487} INFO - Cosmos performance [4d3972a47987|421]: The cache size for cosmos_cache__nyc_green_taxi__transform is 2621
[2024-11-21T06:19:46.613+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:19:46.613+0000] {graph.py:495} INFO - Cosmos performance: Cache hit for cosmos_cache__nyc_green_taxi__transform - 0535576c8d7b9c0b5de17cec0f5a6dce,16a7af22baa01082ccbc983a81f25573
[2024-11-21T06:19:46.615+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:19:46.614+0000] {graph.py:412} INFO - Total nodes: 3
[2024-11-21T06:19:46.617+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:19:46.616+0000] {graph.py:413} INFO - Total filtered nodes: 3
[2024-11-21T06:19:46.618+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:19:46.618+0000] {converter.py:264} INFO - Cosmos performance (nyc_green_taxi__transform) -  [4d3972a47987|421]: It took 3.67s to parse the dbt project for DAG using LoadMode.DBT_LS_CACHE
[2024-11-21T06:19:46.627+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:19:46.627+0000] {converter.py:308} INFO - Cosmos performance (nyc_green_taxi__transform) - [4d3972a47987|421]: It took 0.0095s to build the Airflow DAG.
[2024-11-21T06:19:46.631+0000] {processor.py:840} INFO - DAG(s) 'nyc_green_taxi' retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:19:46.676+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:19:46.675+0000] {dag.py:3089} INFO - Sync 1 DAGs
[2024-11-21T06:19:46.727+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:19:46.727+0000] {dag.py:3947} INFO - Setting next_dagrun for nyc_green_taxi to 2024-11-20 00:00:00+00:00, run_after=2024-11-20 00:00:00+00:00
[2024-11-21T06:19:46.778+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 4.012 seconds
[2024-11-21T06:20:17.059+0000] {processor.py:161} INFO - Started process (PID=430) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:20:17.061+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T06:20:17.065+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:20:17.065+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:20:17.162+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:20:17.162+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T06:20:20.263+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:20:20.263+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 3.5998803300001327
[2024-11-21T06:20:20.265+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:20:20.264+0000] {graph.py:487} INFO - Cosmos performance [4d3972a47987|430]: The cache size for cosmos_cache__nyc_green_taxi__transform is 2621
[2024-11-21T06:20:20.267+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:20:20.267+0000] {graph.py:495} INFO - Cosmos performance: Cache hit for cosmos_cache__nyc_green_taxi__transform - 0535576c8d7b9c0b5de17cec0f5a6dce,16a7af22baa01082ccbc983a81f25573
[2024-11-21T06:20:20.269+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:20:20.268+0000] {graph.py:412} INFO - Total nodes: 3
[2024-11-21T06:20:20.271+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:20:20.270+0000] {graph.py:413} INFO - Total filtered nodes: 3
[2024-11-21T06:20:20.272+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:20:20.272+0000] {converter.py:264} INFO - Cosmos performance (nyc_green_taxi__transform) -  [4d3972a47987|430]: It took 3.64s to parse the dbt project for DAG using LoadMode.DBT_LS_CACHE
[2024-11-21T06:20:20.282+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:20:20.282+0000] {converter.py:308} INFO - Cosmos performance (nyc_green_taxi__transform) - [4d3972a47987|430]: It took 0.0103s to build the Airflow DAG.
[2024-11-21T06:20:20.285+0000] {processor.py:840} INFO - DAG(s) 'nyc_green_taxi' retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:20:20.355+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:20:20.354+0000] {dag.py:3089} INFO - Sync 1 DAGs
[2024-11-21T06:20:20.418+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:20:20.417+0000] {dag.py:3947} INFO - Setting next_dagrun for nyc_green_taxi to 2024-11-20 00:00:00+00:00, run_after=2024-11-20 00:00:00+00:00
[2024-11-21T06:20:20.461+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 3.945 seconds
[2024-11-21T06:20:51.313+0000] {processor.py:161} INFO - Started process (PID=438) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:20:51.315+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T06:20:51.321+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:20:51.321+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:20:51.420+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:20:51.420+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T06:20:55.052+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:20:55.051+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 3.598860595999895
[2024-11-21T06:20:55.053+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:20:55.053+0000] {graph.py:487} INFO - Cosmos performance [4d3972a47987|438]: The cache size for cosmos_cache__nyc_green_taxi__transform is 2621
[2024-11-21T06:20:55.055+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:20:55.055+0000] {graph.py:495} INFO - Cosmos performance: Cache hit for cosmos_cache__nyc_green_taxi__transform - 0535576c8d7b9c0b5de17cec0f5a6dce,16a7af22baa01082ccbc983a81f25573
[2024-11-21T06:20:55.057+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:20:55.056+0000] {graph.py:412} INFO - Total nodes: 3
[2024-11-21T06:20:55.058+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:20:55.057+0000] {graph.py:413} INFO - Total filtered nodes: 3
[2024-11-21T06:20:55.059+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:20:55.058+0000] {converter.py:264} INFO - Cosmos performance (nyc_green_taxi__transform) -  [4d3972a47987|438]: It took 3.64s to parse the dbt project for DAG using LoadMode.DBT_LS_CACHE
[2024-11-21T06:20:55.067+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:20:55.067+0000] {converter.py:308} INFO - Cosmos performance (nyc_green_taxi__transform) - [4d3972a47987|438]: It took 0.00834s to build the Airflow DAG.
[2024-11-21T06:20:55.070+0000] {processor.py:840} INFO - DAG(s) 'nyc_green_taxi' retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:20:55.115+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:20:55.115+0000] {dag.py:3089} INFO - Sync 1 DAGs
[2024-11-21T06:20:55.158+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:20:55.158+0000] {dag.py:3947} INFO - Setting next_dagrun for nyc_green_taxi to 2024-11-20 00:00:00+00:00, run_after=2024-11-20 00:00:00+00:00
[2024-11-21T06:20:55.203+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 3.904 seconds
[2024-11-21T06:21:25.872+0000] {processor.py:161} INFO - Started process (PID=446) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:21:25.874+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T06:21:25.878+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:21:25.878+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:21:25.985+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:21:25.984+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T06:21:29.906+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:21:29.905+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 3.8924875420000262
[2024-11-21T06:21:29.907+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:21:29.907+0000] {graph.py:487} INFO - Cosmos performance [4d3972a47987|446]: The cache size for cosmos_cache__nyc_green_taxi__transform is 2621
[2024-11-21T06:21:29.909+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:21:29.909+0000] {graph.py:495} INFO - Cosmos performance: Cache hit for cosmos_cache__nyc_green_taxi__transform - 0535576c8d7b9c0b5de17cec0f5a6dce,16a7af22baa01082ccbc983a81f25573
[2024-11-21T06:21:29.911+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:21:29.910+0000] {graph.py:412} INFO - Total nodes: 3
[2024-11-21T06:21:29.912+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:21:29.911+0000] {graph.py:413} INFO - Total filtered nodes: 3
[2024-11-21T06:21:29.920+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:21:29.919+0000] {converter.py:264} INFO - Cosmos performance (nyc_green_taxi__transform) -  [4d3972a47987|446]: It took 3.94s to parse the dbt project for DAG using LoadMode.DBT_LS_CACHE
[2024-11-21T06:21:29.929+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:21:29.928+0000] {converter.py:308} INFO - Cosmos performance (nyc_green_taxi__transform) - [4d3972a47987|446]: It took 0.00921s to build the Airflow DAG.
[2024-11-21T06:21:29.931+0000] {processor.py:840} INFO - DAG(s) 'nyc_green_taxi' retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:21:29.989+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:21:29.988+0000] {dag.py:3089} INFO - Sync 1 DAGs
[2024-11-21T06:21:30.043+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:21:30.042+0000] {dag.py:3947} INFO - Setting next_dagrun for nyc_green_taxi to 2024-11-20 00:00:00+00:00, run_after=2024-11-20 00:00:00+00:00
[2024-11-21T06:21:30.085+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 4.228 seconds
[2024-11-21T06:22:00.627+0000] {processor.py:161} INFO - Started process (PID=461) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:22:00.629+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T06:22:00.634+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:22:00.633+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:22:00.737+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:22:00.736+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T06:22:04.824+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:22:04.823+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 4.056318375000046
[2024-11-21T06:22:04.825+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:22:04.825+0000] {graph.py:487} INFO - Cosmos performance [4d3972a47987|461]: The cache size for cosmos_cache__nyc_green_taxi__transform is 2621
[2024-11-21T06:22:04.827+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:22:04.827+0000] {graph.py:495} INFO - Cosmos performance: Cache hit for cosmos_cache__nyc_green_taxi__transform - 0535576c8d7b9c0b5de17cec0f5a6dce,16a7af22baa01082ccbc983a81f25573
[2024-11-21T06:22:04.829+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:22:04.828+0000] {graph.py:412} INFO - Total nodes: 3
[2024-11-21T06:22:04.830+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:22:04.830+0000] {graph.py:413} INFO - Total filtered nodes: 3
[2024-11-21T06:22:04.831+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:22:04.831+0000] {converter.py:264} INFO - Cosmos performance (nyc_green_taxi__transform) -  [4d3972a47987|461]: It took 4.1s to parse the dbt project for DAG using LoadMode.DBT_LS_CACHE
[2024-11-21T06:22:04.841+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:22:04.841+0000] {converter.py:308} INFO - Cosmos performance (nyc_green_taxi__transform) - [4d3972a47987|461]: It took 0.0103s to build the Airflow DAG.
[2024-11-21T06:22:04.844+0000] {processor.py:840} INFO - DAG(s) 'nyc_green_taxi' retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:22:04.893+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:22:04.892+0000] {dag.py:3089} INFO - Sync 1 DAGs
[2024-11-21T06:22:04.936+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:22:04.936+0000] {dag.py:3947} INFO - Setting next_dagrun for nyc_green_taxi to 2024-11-20 00:00:00+00:00, run_after=2024-11-20 00:00:00+00:00
[2024-11-21T06:22:04.975+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 4.364 seconds
[2024-11-21T06:22:35.312+0000] {processor.py:161} INFO - Started process (PID=469) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:22:35.315+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T06:22:35.321+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:22:35.320+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:22:35.426+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:22:35.426+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T06:22:39.631+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:22:39.630+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 4.172741544000019
[2024-11-21T06:22:39.632+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:22:39.632+0000] {graph.py:487} INFO - Cosmos performance [4d3972a47987|469]: The cache size for cosmos_cache__nyc_green_taxi__transform is 2621
[2024-11-21T06:22:39.634+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:22:39.634+0000] {graph.py:495} INFO - Cosmos performance: Cache hit for cosmos_cache__nyc_green_taxi__transform - 0535576c8d7b9c0b5de17cec0f5a6dce,16a7af22baa01082ccbc983a81f25573
[2024-11-21T06:22:39.635+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:22:39.635+0000] {graph.py:412} INFO - Total nodes: 3
[2024-11-21T06:22:39.637+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:22:39.636+0000] {graph.py:413} INFO - Total filtered nodes: 3
[2024-11-21T06:22:39.638+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:22:39.638+0000] {converter.py:264} INFO - Cosmos performance (nyc_green_taxi__transform) -  [4d3972a47987|469]: It took 4.21s to parse the dbt project for DAG using LoadMode.DBT_LS_CACHE
[2024-11-21T06:22:39.650+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:22:39.650+0000] {converter.py:308} INFO - Cosmos performance (nyc_green_taxi__transform) - [4d3972a47987|469]: It took 0.0121s to build the Airflow DAG.
[2024-11-21T06:22:39.653+0000] {processor.py:840} INFO - DAG(s) 'nyc_green_taxi' retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:22:39.697+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:22:39.697+0000] {dag.py:3089} INFO - Sync 1 DAGs
[2024-11-21T06:22:39.736+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:22:39.735+0000] {dag.py:3947} INFO - Setting next_dagrun for nyc_green_taxi to 2024-11-20 00:00:00+00:00, run_after=2024-11-20 00:00:00+00:00
[2024-11-21T06:22:39.781+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 4.487 seconds
[2024-11-21T06:23:10.604+0000] {processor.py:161} INFO - Started process (PID=477) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:23:10.606+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T06:23:10.611+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:23:10.610+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:23:10.716+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:23:10.715+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T06:23:13.307+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:23:13.306+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 3.8621557610001673
[2024-11-21T06:23:13.308+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:23:13.308+0000] {graph.py:487} INFO - Cosmos performance [4d3972a47987|477]: The cache size for cosmos_cache__nyc_green_taxi__transform is 2621
[2024-11-21T06:23:13.310+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:23:13.310+0000] {graph.py:495} INFO - Cosmos performance: Cache hit for cosmos_cache__nyc_green_taxi__transform - 0535576c8d7b9c0b5de17cec0f5a6dce,16a7af22baa01082ccbc983a81f25573
[2024-11-21T06:23:13.312+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:23:13.311+0000] {graph.py:412} INFO - Total nodes: 3
[2024-11-21T06:23:13.313+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:23:13.313+0000] {graph.py:413} INFO - Total filtered nodes: 3
[2024-11-21T06:23:13.314+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:23:13.314+0000] {converter.py:264} INFO - Cosmos performance (nyc_green_taxi__transform) -  [4d3972a47987|477]: It took 3.9s to parse the dbt project for DAG using LoadMode.DBT_LS_CACHE
[2024-11-21T06:23:13.325+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:23:13.325+0000] {converter.py:308} INFO - Cosmos performance (nyc_green_taxi__transform) - [4d3972a47987|477]: It took 0.0106s to build the Airflow DAG.
[2024-11-21T06:23:13.328+0000] {processor.py:840} INFO - DAG(s) 'nyc_green_taxi' retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:23:13.374+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:23:13.374+0000] {dag.py:3089} INFO - Sync 1 DAGs
[2024-11-21T06:23:13.419+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:23:13.418+0000] {dag.py:3947} INFO - Setting next_dagrun for nyc_green_taxi to 2024-11-20 00:00:00+00:00, run_after=2024-11-20 00:00:00+00:00
[2024-11-21T06:23:13.468+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 4.186 seconds
[2024-11-21T06:23:43.779+0000] {processor.py:161} INFO - Started process (PID=485) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:23:43.781+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T06:23:43.786+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:23:43.785+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:23:43.877+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:23:43.877+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T06:23:47.580+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:23:47.579+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 3.6729949969999325
[2024-11-21T06:23:47.581+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:23:47.581+0000] {graph.py:487} INFO - Cosmos performance [4d3972a47987|485]: The cache size for cosmos_cache__nyc_green_taxi__transform is 2621
[2024-11-21T06:23:47.583+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:23:47.583+0000] {graph.py:495} INFO - Cosmos performance: Cache hit for cosmos_cache__nyc_green_taxi__transform - 0535576c8d7b9c0b5de17cec0f5a6dce,16a7af22baa01082ccbc983a81f25573
[2024-11-21T06:23:47.585+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:23:47.584+0000] {graph.py:412} INFO - Total nodes: 3
[2024-11-21T06:23:47.586+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:23:47.586+0000] {graph.py:413} INFO - Total filtered nodes: 3
[2024-11-21T06:23:47.587+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:23:47.587+0000] {converter.py:264} INFO - Cosmos performance (nyc_green_taxi__transform) -  [4d3972a47987|485]: It took 3.71s to parse the dbt project for DAG using LoadMode.DBT_LS_CACHE
[2024-11-21T06:23:47.596+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:23:47.596+0000] {converter.py:308} INFO - Cosmos performance (nyc_green_taxi__transform) - [4d3972a47987|485]: It took 0.00906s to build the Airflow DAG.
[2024-11-21T06:23:47.599+0000] {processor.py:840} INFO - DAG(s) 'nyc_green_taxi' retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:23:47.644+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:23:47.644+0000] {dag.py:3089} INFO - Sync 1 DAGs
[2024-11-21T06:23:47.684+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:23:47.684+0000] {dag.py:3947} INFO - Setting next_dagrun for nyc_green_taxi to 2024-11-20 00:00:00+00:00, run_after=2024-11-20 00:00:00+00:00
[2024-11-21T06:23:47.730+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 3.965 seconds
[2024-11-21T06:24:17.965+0000] {processor.py:161} INFO - Started process (PID=493) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:24:17.967+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T06:24:17.971+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:24:17.971+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:24:18.074+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:24:18.073+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T06:24:22.412+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:24:22.411+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 4.309997774000067
[2024-11-21T06:24:22.413+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:24:22.413+0000] {graph.py:487} INFO - Cosmos performance [4d3972a47987|493]: The cache size for cosmos_cache__nyc_green_taxi__transform is 2621
[2024-11-21T06:24:22.415+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:24:22.414+0000] {graph.py:495} INFO - Cosmos performance: Cache hit for cosmos_cache__nyc_green_taxi__transform - 0535576c8d7b9c0b5de17cec0f5a6dce,16a7af22baa01082ccbc983a81f25573
[2024-11-21T06:24:22.417+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:24:22.416+0000] {graph.py:412} INFO - Total nodes: 3
[2024-11-21T06:24:22.418+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:24:22.418+0000] {graph.py:413} INFO - Total filtered nodes: 3
[2024-11-21T06:24:22.419+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:24:22.419+0000] {converter.py:264} INFO - Cosmos performance (nyc_green_taxi__transform) -  [4d3972a47987|493]: It took 4.35s to parse the dbt project for DAG using LoadMode.DBT_LS_CACHE
[2024-11-21T06:24:22.429+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:24:22.429+0000] {converter.py:308} INFO - Cosmos performance (nyc_green_taxi__transform) - [4d3972a47987|493]: It took 0.00984s to build the Airflow DAG.
[2024-11-21T06:24:22.431+0000] {processor.py:840} INFO - DAG(s) 'nyc_green_taxi' retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:24:22.473+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:24:22.472+0000] {dag.py:3089} INFO - Sync 1 DAGs
[2024-11-21T06:24:22.512+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:24:22.512+0000] {dag.py:3947} INFO - Setting next_dagrun for nyc_green_taxi to 2024-11-20 00:00:00+00:00, run_after=2024-11-20 00:00:00+00:00
[2024-11-21T06:24:22.550+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 4.601 seconds
[2024-11-21T06:24:53.230+0000] {processor.py:161} INFO - Started process (PID=507) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:24:53.232+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T06:24:53.237+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:24:53.236+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:24:53.340+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:24:53.339+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T06:24:57.587+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:24:57.586+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 4.218355036000048
[2024-11-21T06:24:57.588+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:24:57.588+0000] {graph.py:487} INFO - Cosmos performance [4d3972a47987|507]: The cache size for cosmos_cache__nyc_green_taxi__transform is 2621
[2024-11-21T06:24:57.591+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:24:57.590+0000] {graph.py:495} INFO - Cosmos performance: Cache hit for cosmos_cache__nyc_green_taxi__transform - 0535576c8d7b9c0b5de17cec0f5a6dce,16a7af22baa01082ccbc983a81f25573
[2024-11-21T06:24:57.592+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:24:57.592+0000] {graph.py:412} INFO - Total nodes: 3
[2024-11-21T06:24:57.594+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:24:57.593+0000] {graph.py:413} INFO - Total filtered nodes: 3
[2024-11-21T06:24:57.595+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:24:57.595+0000] {converter.py:264} INFO - Cosmos performance (nyc_green_taxi__transform) -  [4d3972a47987|507]: It took 4.26s to parse the dbt project for DAG using LoadMode.DBT_LS_CACHE
[2024-11-21T06:24:57.604+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:24:57.604+0000] {converter.py:308} INFO - Cosmos performance (nyc_green_taxi__transform) - [4d3972a47987|507]: It took 0.00946s to build the Airflow DAG.
[2024-11-21T06:24:57.608+0000] {processor.py:840} INFO - DAG(s) 'nyc_green_taxi' retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:24:57.650+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:24:57.649+0000] {dag.py:3089} INFO - Sync 1 DAGs
[2024-11-21T06:24:57.698+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:24:57.697+0000] {dag.py:3947} INFO - Setting next_dagrun for nyc_green_taxi to 2024-11-20 00:00:00+00:00, run_after=2024-11-20 00:00:00+00:00
[2024-11-21T06:24:57.748+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 4.532 seconds
[2024-11-21T06:25:28.120+0000] {processor.py:161} INFO - Started process (PID=515) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:25:28.122+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T06:25:28.127+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:25:28.126+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:25:28.228+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:25:28.227+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T06:25:32.396+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:25:32.396+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 4.140107251000018
[2024-11-21T06:25:32.398+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:25:32.397+0000] {graph.py:487} INFO - Cosmos performance [4d3972a47987|515]: The cache size for cosmos_cache__nyc_green_taxi__transform is 2621
[2024-11-21T06:25:32.400+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:25:32.399+0000] {graph.py:495} INFO - Cosmos performance: Cache hit for cosmos_cache__nyc_green_taxi__transform - 0535576c8d7b9c0b5de17cec0f5a6dce,16a7af22baa01082ccbc983a81f25573
[2024-11-21T06:25:32.401+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:25:32.401+0000] {graph.py:412} INFO - Total nodes: 3
[2024-11-21T06:25:32.403+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:25:32.403+0000] {graph.py:413} INFO - Total filtered nodes: 3
[2024-11-21T06:25:32.404+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:25:32.404+0000] {converter.py:264} INFO - Cosmos performance (nyc_green_taxi__transform) -  [4d3972a47987|515]: It took 4.18s to parse the dbt project for DAG using LoadMode.DBT_LS_CACHE
[2024-11-21T06:25:32.414+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:25:32.413+0000] {converter.py:308} INFO - Cosmos performance (nyc_green_taxi__transform) - [4d3972a47987|515]: It took 0.00945s to build the Airflow DAG.
[2024-11-21T06:25:32.417+0000] {processor.py:840} INFO - DAG(s) 'nyc_green_taxi' retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:25:32.465+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:25:32.465+0000] {dag.py:3089} INFO - Sync 1 DAGs
[2024-11-21T06:25:32.513+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:25:32.513+0000] {dag.py:3947} INFO - Setting next_dagrun for nyc_green_taxi to 2024-11-20 00:00:00+00:00, run_after=2024-11-20 00:00:00+00:00
[2024-11-21T06:25:32.567+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 4.461 seconds
[2024-11-21T06:26:02.749+0000] {processor.py:161} INFO - Started process (PID=524) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:26:02.751+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T06:26:02.756+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:26:02.755+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:26:02.860+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:26:02.859+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T06:26:05.335+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:26:05.335+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 3.816227639999852
[2024-11-21T06:26:05.336+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:26:05.336+0000] {graph.py:487} INFO - Cosmos performance [4d3972a47987|524]: The cache size for cosmos_cache__nyc_green_taxi__transform is 2621
[2024-11-21T06:26:05.338+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:26:05.338+0000] {graph.py:495} INFO - Cosmos performance: Cache hit for cosmos_cache__nyc_green_taxi__transform - 0535576c8d7b9c0b5de17cec0f5a6dce,16a7af22baa01082ccbc983a81f25573
[2024-11-21T06:26:05.340+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:26:05.339+0000] {graph.py:412} INFO - Total nodes: 3
[2024-11-21T06:26:05.341+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:26:05.341+0000] {graph.py:413} INFO - Total filtered nodes: 3
[2024-11-21T06:26:05.342+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:26:05.342+0000] {converter.py:264} INFO - Cosmos performance (nyc_green_taxi__transform) -  [4d3972a47987|524]: It took 3.85s to parse the dbt project for DAG using LoadMode.DBT_LS_CACHE
[2024-11-21T06:26:05.351+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:26:05.351+0000] {converter.py:308} INFO - Cosmos performance (nyc_green_taxi__transform) - [4d3972a47987|524]: It took 0.00918s to build the Airflow DAG.
[2024-11-21T06:26:05.354+0000] {processor.py:840} INFO - DAG(s) 'nyc_green_taxi' retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:26:05.404+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:26:05.403+0000] {dag.py:3089} INFO - Sync 1 DAGs
[2024-11-21T06:26:05.448+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:26:05.447+0000] {dag.py:3947} INFO - Setting next_dagrun for nyc_green_taxi to 2024-11-20 00:00:00+00:00, run_after=2024-11-20 00:00:00+00:00
[2024-11-21T06:26:05.495+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 4.134 seconds
[2024-11-21T06:26:35.705+0000] {processor.py:161} INFO - Started process (PID=532) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:26:35.707+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T06:26:35.712+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:26:35.711+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:26:35.793+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:26:35.793+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T06:26:39.633+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:26:39.632+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 3.807950053000013
[2024-11-21T06:26:39.634+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:26:39.634+0000] {graph.py:487} INFO - Cosmos performance [4d3972a47987|532]: The cache size for cosmos_cache__nyc_green_taxi__transform is 2621
[2024-11-21T06:26:39.637+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:26:39.636+0000] {graph.py:495} INFO - Cosmos performance: Cache hit for cosmos_cache__nyc_green_taxi__transform - 0535576c8d7b9c0b5de17cec0f5a6dce,16a7af22baa01082ccbc983a81f25573
[2024-11-21T06:26:39.639+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:26:39.638+0000] {graph.py:412} INFO - Total nodes: 3
[2024-11-21T06:26:39.640+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:26:39.639+0000] {graph.py:413} INFO - Total filtered nodes: 3
[2024-11-21T06:26:39.647+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:26:39.647+0000] {converter.py:264} INFO - Cosmos performance (nyc_green_taxi__transform) -  [4d3972a47987|532]: It took 3.85s to parse the dbt project for DAG using LoadMode.DBT_LS_CACHE
[2024-11-21T06:26:39.660+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:26:39.660+0000] {converter.py:308} INFO - Cosmos performance (nyc_green_taxi__transform) - [4d3972a47987|532]: It took 0.0134s to build the Airflow DAG.
[2024-11-21T06:26:39.665+0000] {processor.py:840} INFO - DAG(s) 'nyc_green_taxi' retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:26:39.719+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:26:39.719+0000] {dag.py:3089} INFO - Sync 1 DAGs
[2024-11-21T06:26:39.804+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:26:39.803+0000] {dag.py:3947} INFO - Setting next_dagrun for nyc_green_taxi to 2024-11-20 00:00:00+00:00, run_after=2024-11-20 00:00:00+00:00
[2024-11-21T06:26:39.848+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 4.164 seconds
[2024-11-21T06:27:10.028+0000] {processor.py:161} INFO - Started process (PID=540) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:27:10.030+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T06:27:10.034+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:27:10.034+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:27:10.140+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:27:10.139+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T06:27:14.060+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:27:14.060+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 3.8898178980000466
[2024-11-21T06:27:14.062+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:27:14.061+0000] {graph.py:487} INFO - Cosmos performance [4d3972a47987|540]: The cache size for cosmos_cache__nyc_green_taxi__transform is 2621
[2024-11-21T06:27:14.064+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:27:14.064+0000] {graph.py:495} INFO - Cosmos performance: Cache hit for cosmos_cache__nyc_green_taxi__transform - 0535576c8d7b9c0b5de17cec0f5a6dce,16a7af22baa01082ccbc983a81f25573
[2024-11-21T06:27:14.066+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:27:14.065+0000] {graph.py:412} INFO - Total nodes: 3
[2024-11-21T06:27:14.067+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:27:14.067+0000] {graph.py:413} INFO - Total filtered nodes: 3
[2024-11-21T06:27:14.068+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:27:14.068+0000] {converter.py:264} INFO - Cosmos performance (nyc_green_taxi__transform) -  [4d3972a47987|540]: It took 3.93s to parse the dbt project for DAG using LoadMode.DBT_LS_CACHE
[2024-11-21T06:27:14.078+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:27:14.078+0000] {converter.py:308} INFO - Cosmos performance (nyc_green_taxi__transform) - [4d3972a47987|540]: It took 0.0101s to build the Airflow DAG.
[2024-11-21T06:27:14.081+0000] {processor.py:840} INFO - DAG(s) 'nyc_green_taxi' retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:27:14.135+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:27:14.135+0000] {dag.py:3089} INFO - Sync 1 DAGs
[2024-11-21T06:27:14.183+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:27:14.182+0000] {dag.py:3947} INFO - Setting next_dagrun for nyc_green_taxi to 2024-11-20 00:00:00+00:00, run_after=2024-11-20 00:00:00+00:00
[2024-11-21T06:27:14.238+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 4.224 seconds
[2024-11-21T06:27:44.586+0000] {processor.py:161} INFO - Started process (PID=554) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:27:44.588+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T06:27:44.593+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:27:44.592+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:27:44.704+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:27:44.703+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T06:27:48.979+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:27:48.978+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 4.243612174999953
[2024-11-21T06:27:48.980+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:27:48.980+0000] {graph.py:487} INFO - Cosmos performance [4d3972a47987|554]: The cache size for cosmos_cache__nyc_green_taxi__transform is 2621
[2024-11-21T06:27:48.982+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:27:48.982+0000] {graph.py:495} INFO - Cosmos performance: Cache hit for cosmos_cache__nyc_green_taxi__transform - 0535576c8d7b9c0b5de17cec0f5a6dce,16a7af22baa01082ccbc983a81f25573
[2024-11-21T06:27:48.984+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:27:48.983+0000] {graph.py:412} INFO - Total nodes: 3
[2024-11-21T06:27:48.985+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:27:48.985+0000] {graph.py:413} INFO - Total filtered nodes: 3
[2024-11-21T06:27:48.986+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:27:48.986+0000] {converter.py:264} INFO - Cosmos performance (nyc_green_taxi__transform) -  [4d3972a47987|554]: It took 4.28s to parse the dbt project for DAG using LoadMode.DBT_LS_CACHE
[2024-11-21T06:27:48.997+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:27:48.996+0000] {converter.py:308} INFO - Cosmos performance (nyc_green_taxi__transform) - [4d3972a47987|554]: It took 0.0104s to build the Airflow DAG.
[2024-11-21T06:27:49.001+0000] {processor.py:840} INFO - DAG(s) 'nyc_green_taxi' retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:27:49.047+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:27:49.047+0000] {dag.py:3089} INFO - Sync 1 DAGs
[2024-11-21T06:27:49.091+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:27:49.090+0000] {dag.py:3947} INFO - Setting next_dagrun for nyc_green_taxi to 2024-11-20 00:00:00+00:00, run_after=2024-11-20 00:00:00+00:00
[2024-11-21T06:27:49.140+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 4.569 seconds
[2024-11-21T06:28:19.978+0000] {processor.py:161} INFO - Started process (PID=562) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:28:19.981+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T06:28:19.985+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:28:19.984+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:28:20.086+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:28:20.085+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T06:28:24.368+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:28:24.367+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 4.252487556999995
[2024-11-21T06:28:24.369+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:28:24.369+0000] {graph.py:487} INFO - Cosmos performance [4d3972a47987|562]: The cache size for cosmos_cache__nyc_green_taxi__transform is 2621
[2024-11-21T06:28:24.371+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:28:24.371+0000] {graph.py:495} INFO - Cosmos performance: Cache hit for cosmos_cache__nyc_green_taxi__transform - 0535576c8d7b9c0b5de17cec0f5a6dce,16a7af22baa01082ccbc983a81f25573
[2024-11-21T06:28:24.373+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:28:24.372+0000] {graph.py:412} INFO - Total nodes: 3
[2024-11-21T06:28:24.374+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:28:24.374+0000] {graph.py:413} INFO - Total filtered nodes: 3
[2024-11-21T06:28:24.375+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:28:24.375+0000] {converter.py:264} INFO - Cosmos performance (nyc_green_taxi__transform) -  [4d3972a47987|562]: It took 4.29s to parse the dbt project for DAG using LoadMode.DBT_LS_CACHE
[2024-11-21T06:28:24.385+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:28:24.385+0000] {converter.py:308} INFO - Cosmos performance (nyc_green_taxi__transform) - [4d3972a47987|562]: It took 0.00945s to build the Airflow DAG.
[2024-11-21T06:28:24.388+0000] {processor.py:840} INFO - DAG(s) 'nyc_green_taxi' retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:28:24.430+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:28:24.429+0000] {dag.py:3089} INFO - Sync 1 DAGs
[2024-11-21T06:28:24.471+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:28:24.470+0000] {dag.py:3947} INFO - Setting next_dagrun for nyc_green_taxi to 2024-11-20 00:00:00+00:00, run_after=2024-11-20 00:00:00+00:00
[2024-11-21T06:28:24.515+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 4.553 seconds
[2024-11-21T06:28:55.291+0000] {processor.py:161} INFO - Started process (PID=570) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:28:55.293+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T06:28:55.298+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:28:55.297+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:28:55.401+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:28:55.400+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T06:28:58.355+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:28:58.355+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 4.254208572999914
[2024-11-21T06:28:58.357+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:28:58.357+0000] {graph.py:487} INFO - Cosmos performance [4d3972a47987|570]: The cache size for cosmos_cache__nyc_green_taxi__transform is 2621
[2024-11-21T06:28:58.360+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:28:58.360+0000] {graph.py:495} INFO - Cosmos performance: Cache hit for cosmos_cache__nyc_green_taxi__transform - 0535576c8d7b9c0b5de17cec0f5a6dce,16a7af22baa01082ccbc983a81f25573
[2024-11-21T06:28:58.362+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:28:58.361+0000] {graph.py:412} INFO - Total nodes: 3
[2024-11-21T06:28:58.363+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:28:58.363+0000] {graph.py:413} INFO - Total filtered nodes: 3
[2024-11-21T06:28:58.365+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:28:58.364+0000] {converter.py:264} INFO - Cosmos performance (nyc_green_taxi__transform) -  [4d3972a47987|570]: It took 4.29s to parse the dbt project for DAG using LoadMode.DBT_LS_CACHE
[2024-11-21T06:28:58.375+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:28:58.375+0000] {converter.py:308} INFO - Cosmos performance (nyc_green_taxi__transform) - [4d3972a47987|570]: It took 0.0108s to build the Airflow DAG.
[2024-11-21T06:28:58.378+0000] {processor.py:840} INFO - DAG(s) 'nyc_green_taxi' retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:28:58.425+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:28:58.425+0000] {dag.py:3089} INFO - Sync 1 DAGs
[2024-11-21T06:28:58.467+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:28:58.467+0000] {dag.py:3947} INFO - Setting next_dagrun for nyc_green_taxi to 2024-11-20 00:00:00+00:00, run_after=2024-11-20 00:00:00+00:00
[2024-11-21T06:28:58.507+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 4.562 seconds
[2024-11-21T06:29:28.678+0000] {processor.py:161} INFO - Started process (PID=578) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:29:28.681+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T06:29:28.685+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:29:28.684+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:29:28.782+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:29:28.782+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T06:29:33.044+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:29:33.043+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 4.231406705999916
[2024-11-21T06:29:33.045+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:29:33.045+0000] {graph.py:487} INFO - Cosmos performance [4d3972a47987|578]: The cache size for cosmos_cache__nyc_green_taxi__transform is 2621
[2024-11-21T06:29:33.047+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:29:33.046+0000] {graph.py:495} INFO - Cosmos performance: Cache hit for cosmos_cache__nyc_green_taxi__transform - 0535576c8d7b9c0b5de17cec0f5a6dce,16a7af22baa01082ccbc983a81f25573
[2024-11-21T06:29:33.048+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:29:33.048+0000] {graph.py:412} INFO - Total nodes: 3
[2024-11-21T06:29:33.050+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:29:33.049+0000] {graph.py:413} INFO - Total filtered nodes: 3
[2024-11-21T06:29:33.051+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:29:33.051+0000] {converter.py:264} INFO - Cosmos performance (nyc_green_taxi__transform) -  [4d3972a47987|578]: It took 4.27s to parse the dbt project for DAG using LoadMode.DBT_LS_CACHE
[2024-11-21T06:29:33.060+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:29:33.060+0000] {converter.py:308} INFO - Cosmos performance (nyc_green_taxi__transform) - [4d3972a47987|578]: It took 0.00952s to build the Airflow DAG.
[2024-11-21T06:29:33.063+0000] {processor.py:840} INFO - DAG(s) 'nyc_green_taxi' retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:29:33.108+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:29:33.108+0000] {dag.py:3089} INFO - Sync 1 DAGs
[2024-11-21T06:29:33.149+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:29:33.149+0000] {dag.py:3947} INFO - Setting next_dagrun for nyc_green_taxi to 2024-11-20 00:00:00+00:00, run_after=2024-11-20 00:00:00+00:00
[2024-11-21T06:29:33.198+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 4.538 seconds
[2024-11-21T06:30:04.193+0000] {processor.py:161} INFO - Started process (PID=586) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:30:04.195+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T06:30:04.199+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:30:04.198+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:30:04.315+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:30:04.314+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T06:30:08.665+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:30:08.664+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 4.317989154000088
[2024-11-21T06:30:08.667+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:30:08.666+0000] {graph.py:487} INFO - Cosmos performance [4d3972a47987|586]: The cache size for cosmos_cache__nyc_green_taxi__transform is 2621
[2024-11-21T06:30:08.669+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:30:08.668+0000] {graph.py:495} INFO - Cosmos performance: Cache hit for cosmos_cache__nyc_green_taxi__transform - 0535576c8d7b9c0b5de17cec0f5a6dce,16a7af22baa01082ccbc983a81f25573
[2024-11-21T06:30:08.671+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:30:08.670+0000] {graph.py:412} INFO - Total nodes: 3
[2024-11-21T06:30:08.672+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:30:08.672+0000] {graph.py:413} INFO - Total filtered nodes: 3
[2024-11-21T06:30:08.673+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:30:08.673+0000] {converter.py:264} INFO - Cosmos performance (nyc_green_taxi__transform) -  [4d3972a47987|586]: It took 4.36s to parse the dbt project for DAG using LoadMode.DBT_LS_CACHE
[2024-11-21T06:30:08.684+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:30:08.684+0000] {converter.py:308} INFO - Cosmos performance (nyc_green_taxi__transform) - [4d3972a47987|586]: It took 0.0109s to build the Airflow DAG.
[2024-11-21T06:30:08.687+0000] {processor.py:840} INFO - DAG(s) 'nyc_green_taxi' retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:30:08.732+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:30:08.731+0000] {dag.py:3089} INFO - Sync 1 DAGs
[2024-11-21T06:30:08.778+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:30:08.778+0000] {dag.py:3947} INFO - Setting next_dagrun for nyc_green_taxi to 2024-11-20 00:00:00+00:00, run_after=2024-11-20 00:00:00+00:00
[2024-11-21T06:30:08.824+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 4.646 seconds
[2024-11-21T06:30:39.008+0000] {processor.py:161} INFO - Started process (PID=601) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:30:39.011+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T06:30:39.015+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:30:39.014+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:30:39.119+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:30:39.119+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T06:30:42.551+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:30:42.550+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 3.399641416999657
[2024-11-21T06:30:42.552+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:30:42.552+0000] {graph.py:487} INFO - Cosmos performance [4d3972a47987|601]: The cache size for cosmos_cache__nyc_green_taxi__transform is 2621
[2024-11-21T06:30:42.553+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:30:42.553+0000] {graph.py:495} INFO - Cosmos performance: Cache hit for cosmos_cache__nyc_green_taxi__transform - 0535576c8d7b9c0b5de17cec0f5a6dce,16a7af22baa01082ccbc983a81f25573
[2024-11-21T06:30:42.555+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:30:42.555+0000] {graph.py:412} INFO - Total nodes: 3
[2024-11-21T06:30:42.557+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:30:42.557+0000] {graph.py:413} INFO - Total filtered nodes: 3
[2024-11-21T06:30:42.558+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:30:42.558+0000] {converter.py:264} INFO - Cosmos performance (nyc_green_taxi__transform) -  [4d3972a47987|601]: It took 3.44s to parse the dbt project for DAG using LoadMode.DBT_LS_CACHE
[2024-11-21T06:30:42.571+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:30:42.571+0000] {converter.py:308} INFO - Cosmos performance (nyc_green_taxi__transform) - [4d3972a47987|601]: It took 0.0129s to build the Airflow DAG.
[2024-11-21T06:30:42.580+0000] {processor.py:840} INFO - DAG(s) 'nyc_green_taxi' retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:30:42.628+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:30:42.627+0000] {dag.py:3089} INFO - Sync 1 DAGs
[2024-11-21T06:30:42.666+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:30:42.665+0000] {dag.py:3947} INFO - Setting next_dagrun for nyc_green_taxi to 2024-11-20 00:00:00+00:00, run_after=2024-11-20 00:00:00+00:00
[2024-11-21T06:30:42.705+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 3.711 seconds
[2024-11-21T06:31:13.409+0000] {processor.py:161} INFO - Started process (PID=609) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:31:13.411+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T06:31:13.415+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:31:13.415+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:31:13.520+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:31:13.520+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T06:31:18.053+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:31:18.052+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 4.501504802999989
[2024-11-21T06:31:18.055+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:31:18.054+0000] {graph.py:487} INFO - Cosmos performance [4d3972a47987|609]: The cache size for cosmos_cache__nyc_green_taxi__transform is 2621
[2024-11-21T06:31:18.056+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:31:18.056+0000] {graph.py:495} INFO - Cosmos performance: Cache hit for cosmos_cache__nyc_green_taxi__transform - 0535576c8d7b9c0b5de17cec0f5a6dce,16a7af22baa01082ccbc983a81f25573
[2024-11-21T06:31:18.059+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:31:18.057+0000] {graph.py:412} INFO - Total nodes: 3
[2024-11-21T06:31:18.060+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:31:18.060+0000] {graph.py:413} INFO - Total filtered nodes: 3
[2024-11-21T06:31:18.061+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:31:18.061+0000] {converter.py:264} INFO - Cosmos performance (nyc_green_taxi__transform) -  [4d3972a47987|609]: It took 4.54s to parse the dbt project for DAG using LoadMode.DBT_LS_CACHE
[2024-11-21T06:31:18.072+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:31:18.071+0000] {converter.py:308} INFO - Cosmos performance (nyc_green_taxi__transform) - [4d3972a47987|609]: It took 0.0103s to build the Airflow DAG.
[2024-11-21T06:31:18.074+0000] {processor.py:840} INFO - DAG(s) 'nyc_green_taxi' retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:31:18.119+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:31:18.118+0000] {dag.py:3089} INFO - Sync 1 DAGs
[2024-11-21T06:31:18.159+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:31:18.159+0000] {dag.py:3947} INFO - Setting next_dagrun for nyc_green_taxi to 2024-11-20 00:00:00+00:00, run_after=2024-11-20 00:00:00+00:00
[2024-11-21T06:31:18.201+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 4.807 seconds
[2024-11-21T06:31:48.596+0000] {processor.py:161} INFO - Started process (PID=617) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:31:48.598+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T06:31:48.603+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:31:48.602+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:31:48.710+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:31:48.709+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T06:31:52.887+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:31:52.887+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 4.1492342460001055
[2024-11-21T06:31:52.889+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:31:52.889+0000] {graph.py:487} INFO - Cosmos performance [4d3972a47987|617]: The cache size for cosmos_cache__nyc_green_taxi__transform is 2621
[2024-11-21T06:31:52.892+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:31:52.891+0000] {graph.py:495} INFO - Cosmos performance: Cache hit for cosmos_cache__nyc_green_taxi__transform - 0535576c8d7b9c0b5de17cec0f5a6dce,16a7af22baa01082ccbc983a81f25573
[2024-11-21T06:31:52.893+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:31:52.893+0000] {graph.py:412} INFO - Total nodes: 3
[2024-11-21T06:31:52.895+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:31:52.894+0000] {graph.py:413} INFO - Total filtered nodes: 3
[2024-11-21T06:31:52.896+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:31:52.896+0000] {converter.py:264} INFO - Cosmos performance (nyc_green_taxi__transform) -  [4d3972a47987|617]: It took 4.19s to parse the dbt project for DAG using LoadMode.DBT_LS_CACHE
[2024-11-21T06:31:52.907+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:31:52.907+0000] {converter.py:308} INFO - Cosmos performance (nyc_green_taxi__transform) - [4d3972a47987|617]: It took 0.011s to build the Airflow DAG.
[2024-11-21T06:31:52.910+0000] {processor.py:840} INFO - DAG(s) 'nyc_green_taxi' retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:31:52.959+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:31:52.958+0000] {dag.py:3089} INFO - Sync 1 DAGs
[2024-11-21T06:31:53.000+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:31:53.000+0000] {dag.py:3947} INFO - Setting next_dagrun for nyc_green_taxi to 2024-11-20 00:00:00+00:00, run_after=2024-11-20 00:00:00+00:00
[2024-11-21T06:31:53.041+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 4.459 seconds
[2024-11-21T06:32:23.421+0000] {processor.py:161} INFO - Started process (PID=625) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:32:23.423+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T06:32:23.427+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:32:23.427+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:32:23.528+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:32:23.528+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T06:32:27.289+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:32:27.288+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 3.731637229000171
[2024-11-21T06:32:27.290+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:32:27.290+0000] {graph.py:487} INFO - Cosmos performance [4d3972a47987|625]: The cache size for cosmos_cache__nyc_green_taxi__transform is 2621
[2024-11-21T06:32:27.292+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:32:27.292+0000] {graph.py:495} INFO - Cosmos performance: Cache hit for cosmos_cache__nyc_green_taxi__transform - 0535576c8d7b9c0b5de17cec0f5a6dce,16a7af22baa01082ccbc983a81f25573
[2024-11-21T06:32:27.294+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:32:27.293+0000] {graph.py:412} INFO - Total nodes: 3
[2024-11-21T06:32:27.295+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:32:27.295+0000] {graph.py:413} INFO - Total filtered nodes: 3
[2024-11-21T06:32:27.296+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:32:27.296+0000] {converter.py:264} INFO - Cosmos performance (nyc_green_taxi__transform) -  [4d3972a47987|625]: It took 3.77s to parse the dbt project for DAG using LoadMode.DBT_LS_CACHE
[2024-11-21T06:32:27.305+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:32:27.305+0000] {converter.py:308} INFO - Cosmos performance (nyc_green_taxi__transform) - [4d3972a47987|625]: It took 0.009s to build the Airflow DAG.
[2024-11-21T06:32:27.308+0000] {processor.py:840} INFO - DAG(s) 'nyc_green_taxi' retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:32:27.359+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:32:27.359+0000] {dag.py:3089} INFO - Sync 1 DAGs
[2024-11-21T06:32:27.402+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:32:27.402+0000] {dag.py:3947} INFO - Setting next_dagrun for nyc_green_taxi to 2024-11-20 00:00:00+00:00, run_after=2024-11-20 00:00:00+00:00
[2024-11-21T06:32:27.448+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 4.045 seconds
[2024-11-21T06:32:57.937+0000] {processor.py:161} INFO - Started process (PID=639) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:32:57.939+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T06:32:57.943+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:32:57.943+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:32:58.029+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:32:58.028+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T06:33:01.885+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:33:01.884+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 3.830150372999924
[2024-11-21T06:33:01.886+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:33:01.886+0000] {graph.py:487} INFO - Cosmos performance [4d3972a47987|639]: The cache size for cosmos_cache__nyc_green_taxi__transform is 2621
[2024-11-21T06:33:01.888+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:33:01.888+0000] {graph.py:495} INFO - Cosmos performance: Cache hit for cosmos_cache__nyc_green_taxi__transform - 0535576c8d7b9c0b5de17cec0f5a6dce,16a7af22baa01082ccbc983a81f25573
[2024-11-21T06:33:01.890+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:33:01.889+0000] {graph.py:412} INFO - Total nodes: 3
[2024-11-21T06:33:01.891+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:33:01.891+0000] {graph.py:413} INFO - Total filtered nodes: 3
[2024-11-21T06:33:01.892+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:33:01.892+0000] {converter.py:264} INFO - Cosmos performance (nyc_green_taxi__transform) -  [4d3972a47987|639]: It took 3.86s to parse the dbt project for DAG using LoadMode.DBT_LS_CACHE
[2024-11-21T06:33:01.904+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:33:01.903+0000] {converter.py:308} INFO - Cosmos performance (nyc_green_taxi__transform) - [4d3972a47987|639]: It took 0.0116s to build the Airflow DAG.
[2024-11-21T06:33:01.908+0000] {processor.py:840} INFO - DAG(s) 'nyc_green_taxi' retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:33:01.961+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:33:01.960+0000] {dag.py:3089} INFO - Sync 1 DAGs
[2024-11-21T06:33:02.014+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:33:02.013+0000] {dag.py:3947} INFO - Setting next_dagrun for nyc_green_taxi to 2024-11-20 00:00:00+00:00, run_after=2024-11-20 00:00:00+00:00
[2024-11-21T06:33:02.060+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 4.141 seconds
[2024-11-21T06:33:32.364+0000] {processor.py:161} INFO - Started process (PID=647) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:33:32.367+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T06:33:32.371+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:33:32.371+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:33:32.485+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:33:32.485+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T06:33:36.628+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:33:36.627+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 4.1135915320001
[2024-11-21T06:33:36.630+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:33:36.629+0000] {graph.py:487} INFO - Cosmos performance [4d3972a47987|647]: The cache size for cosmos_cache__nyc_green_taxi__transform is 2621
[2024-11-21T06:33:36.632+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:33:36.632+0000] {graph.py:495} INFO - Cosmos performance: Cache hit for cosmos_cache__nyc_green_taxi__transform - 0535576c8d7b9c0b5de17cec0f5a6dce,16a7af22baa01082ccbc983a81f25573
[2024-11-21T06:33:36.634+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:33:36.633+0000] {graph.py:412} INFO - Total nodes: 3
[2024-11-21T06:33:36.635+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:33:36.635+0000] {graph.py:413} INFO - Total filtered nodes: 3
[2024-11-21T06:33:36.637+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:33:36.636+0000] {converter.py:264} INFO - Cosmos performance (nyc_green_taxi__transform) -  [4d3972a47987|647]: It took 4.15s to parse the dbt project for DAG using LoadMode.DBT_LS_CACHE
[2024-11-21T06:33:36.649+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:33:36.649+0000] {converter.py:308} INFO - Cosmos performance (nyc_green_taxi__transform) - [4d3972a47987|647]: It took 0.0125s to build the Airflow DAG.
[2024-11-21T06:33:36.653+0000] {processor.py:840} INFO - DAG(s) 'nyc_green_taxi' retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:33:36.698+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:33:36.698+0000] {dag.py:3089} INFO - Sync 1 DAGs
[2024-11-21T06:33:36.748+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:33:36.748+0000] {dag.py:3947} INFO - Setting next_dagrun for nyc_green_taxi to 2024-11-20 00:00:00+00:00, run_after=2024-11-20 00:00:00+00:00
[2024-11-21T06:33:36.790+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 4.439 seconds
[2024-11-21T06:34:07.073+0000] {processor.py:161} INFO - Started process (PID=655) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:34:07.076+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T06:34:07.081+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:34:07.081+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:34:07.192+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:34:07.191+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T06:34:10.010+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:34:10.009+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 4.270717755999613
[2024-11-21T06:34:10.012+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:34:10.011+0000] {graph.py:487} INFO - Cosmos performance [4d3972a47987|655]: The cache size for cosmos_cache__nyc_green_taxi__transform is 2621
[2024-11-21T06:34:10.014+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:34:10.013+0000] {graph.py:495} INFO - Cosmos performance: Cache hit for cosmos_cache__nyc_green_taxi__transform - 0535576c8d7b9c0b5de17cec0f5a6dce,16a7af22baa01082ccbc983a81f25573
[2024-11-21T06:34:10.016+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:34:10.015+0000] {graph.py:412} INFO - Total nodes: 3
[2024-11-21T06:34:10.017+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:34:10.017+0000] {graph.py:413} INFO - Total filtered nodes: 3
[2024-11-21T06:34:10.019+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:34:10.018+0000] {converter.py:264} INFO - Cosmos performance (nyc_green_taxi__transform) -  [4d3972a47987|655]: It took 4.31s to parse the dbt project for DAG using LoadMode.DBT_LS_CACHE
[2024-11-21T06:34:10.031+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:34:10.031+0000] {converter.py:308} INFO - Cosmos performance (nyc_green_taxi__transform) - [4d3972a47987|655]: It took 0.0124s to build the Airflow DAG.
[2024-11-21T06:34:10.034+0000] {processor.py:840} INFO - DAG(s) 'nyc_green_taxi' retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:34:10.082+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:34:10.082+0000] {dag.py:3089} INFO - Sync 1 DAGs
[2024-11-21T06:34:10.123+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:34:10.122+0000] {dag.py:3947} INFO - Setting next_dagrun for nyc_green_taxi to 2024-11-20 00:00:00+00:00, run_after=2024-11-20 00:00:00+00:00
[2024-11-21T06:34:10.167+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 4.613 seconds
[2024-11-21T06:34:40.340+0000] {processor.py:161} INFO - Started process (PID=663) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:34:40.342+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T06:34:40.348+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:34:40.347+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:34:40.444+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:34:40.444+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T06:34:44.713+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:34:44.712+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 4.236189114999888
[2024-11-21T06:34:44.714+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:34:44.714+0000] {graph.py:487} INFO - Cosmos performance [4d3972a47987|663]: The cache size for cosmos_cache__nyc_green_taxi__transform is 2621
[2024-11-21T06:34:44.716+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:34:44.716+0000] {graph.py:495} INFO - Cosmos performance: Cache hit for cosmos_cache__nyc_green_taxi__transform - 0535576c8d7b9c0b5de17cec0f5a6dce,16a7af22baa01082ccbc983a81f25573
[2024-11-21T06:34:44.718+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:34:44.717+0000] {graph.py:412} INFO - Total nodes: 3
[2024-11-21T06:34:44.719+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:34:44.719+0000] {graph.py:413} INFO - Total filtered nodes: 3
[2024-11-21T06:34:44.721+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:34:44.721+0000] {converter.py:264} INFO - Cosmos performance (nyc_green_taxi__transform) -  [4d3972a47987|663]: It took 4.28s to parse the dbt project for DAG using LoadMode.DBT_LS_CACHE
[2024-11-21T06:34:44.731+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:34:44.731+0000] {converter.py:308} INFO - Cosmos performance (nyc_green_taxi__transform) - [4d3972a47987|663]: It took 0.0103s to build the Airflow DAG.
[2024-11-21T06:34:44.734+0000] {processor.py:840} INFO - DAG(s) 'nyc_green_taxi' retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:34:44.778+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:34:44.777+0000] {dag.py:3089} INFO - Sync 1 DAGs
[2024-11-21T06:34:44.819+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:34:44.818+0000] {dag.py:3947} INFO - Setting next_dagrun for nyc_green_taxi to 2024-11-20 00:00:00+00:00, run_after=2024-11-20 00:00:00+00:00
[2024-11-21T06:34:44.858+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 4.536 seconds
[2024-11-21T06:35:15.097+0000] {processor.py:161} INFO - Started process (PID=672) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:35:15.100+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T06:35:15.105+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:35:15.105+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:35:15.205+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:35:15.204+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T06:35:19.509+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:35:19.509+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 4.265304279000247
[2024-11-21T06:35:19.511+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:35:19.510+0000] {graph.py:487} INFO - Cosmos performance [4d3972a47987|672]: The cache size for cosmos_cache__nyc_green_taxi__transform is 2621
[2024-11-21T06:35:19.513+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:35:19.512+0000] {graph.py:495} INFO - Cosmos performance: Cache hit for cosmos_cache__nyc_green_taxi__transform - 0535576c8d7b9c0b5de17cec0f5a6dce,16a7af22baa01082ccbc983a81f25573
[2024-11-21T06:35:19.515+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:35:19.514+0000] {graph.py:412} INFO - Total nodes: 3
[2024-11-21T06:35:19.516+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:35:19.516+0000] {graph.py:413} INFO - Total filtered nodes: 3
[2024-11-21T06:35:19.517+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:35:19.517+0000] {converter.py:264} INFO - Cosmos performance (nyc_green_taxi__transform) -  [4d3972a47987|672]: It took 4.31s to parse the dbt project for DAG using LoadMode.DBT_LS_CACHE
[2024-11-21T06:35:19.528+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:35:19.527+0000] {converter.py:308} INFO - Cosmos performance (nyc_green_taxi__transform) - [4d3972a47987|672]: It took 0.0107s to build the Airflow DAG.
[2024-11-21T06:35:19.531+0000] {processor.py:840} INFO - DAG(s) 'nyc_green_taxi' retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:35:19.575+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:35:19.574+0000] {dag.py:3089} INFO - Sync 1 DAGs
[2024-11-21T06:35:19.619+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:35:19.618+0000] {dag.py:3947} INFO - Setting next_dagrun for nyc_green_taxi to 2024-11-20 00:00:00+00:00, run_after=2024-11-20 00:00:00+00:00
[2024-11-21T06:35:19.658+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 4.580 seconds
[2024-11-21T06:35:49.786+0000] {processor.py:161} INFO - Started process (PID=686) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:35:49.789+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T06:35:49.793+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:35:49.792+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:35:49.903+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:35:49.903+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T06:35:54.264+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:35:54.263+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 4.330509862999861
[2024-11-21T06:35:54.266+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:35:54.265+0000] {graph.py:487} INFO - Cosmos performance [4d3972a47987|686]: The cache size for cosmos_cache__nyc_green_taxi__transform is 2621
[2024-11-21T06:35:54.268+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:35:54.267+0000] {graph.py:495} INFO - Cosmos performance: Cache hit for cosmos_cache__nyc_green_taxi__transform - 0535576c8d7b9c0b5de17cec0f5a6dce,16a7af22baa01082ccbc983a81f25573
[2024-11-21T06:35:54.270+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:35:54.269+0000] {graph.py:412} INFO - Total nodes: 3
[2024-11-21T06:35:54.271+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:35:54.271+0000] {graph.py:413} INFO - Total filtered nodes: 3
[2024-11-21T06:35:54.272+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:35:54.272+0000] {converter.py:264} INFO - Cosmos performance (nyc_green_taxi__transform) -  [4d3972a47987|686]: It took 4.37s to parse the dbt project for DAG using LoadMode.DBT_LS_CACHE
[2024-11-21T06:35:54.282+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:35:54.282+0000] {converter.py:308} INFO - Cosmos performance (nyc_green_taxi__transform) - [4d3972a47987|686]: It took 0.0101s to build the Airflow DAG.
[2024-11-21T06:35:54.285+0000] {processor.py:840} INFO - DAG(s) 'nyc_green_taxi' retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:35:54.333+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:35:54.332+0000] {dag.py:3089} INFO - Sync 1 DAGs
[2024-11-21T06:35:54.379+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:35:54.379+0000] {dag.py:3947} INFO - Setting next_dagrun for nyc_green_taxi to 2024-11-20 00:00:00+00:00, run_after=2024-11-20 00:00:00+00:00
[2024-11-21T06:35:54.421+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 4.650 seconds
[2024-11-21T06:36:24.564+0000] {processor.py:161} INFO - Started process (PID=694) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:36:24.566+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T06:36:24.571+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:36:24.570+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:36:24.671+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:36:24.671+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T06:36:28.982+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:36:28.981+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 4.279391145999853
[2024-11-21T06:36:28.983+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:36:28.983+0000] {graph.py:487} INFO - Cosmos performance [4d3972a47987|694]: The cache size for cosmos_cache__nyc_green_taxi__transform is 2621
[2024-11-21T06:36:28.985+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:36:28.985+0000] {graph.py:495} INFO - Cosmos performance: Cache hit for cosmos_cache__nyc_green_taxi__transform - 0535576c8d7b9c0b5de17cec0f5a6dce,16a7af22baa01082ccbc983a81f25573
[2024-11-21T06:36:28.987+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:36:28.986+0000] {graph.py:412} INFO - Total nodes: 3
[2024-11-21T06:36:28.988+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:36:28.988+0000] {graph.py:413} INFO - Total filtered nodes: 3
[2024-11-21T06:36:28.990+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:36:28.990+0000] {converter.py:264} INFO - Cosmos performance (nyc_green_taxi__transform) -  [4d3972a47987|694]: It took 4.32s to parse the dbt project for DAG using LoadMode.DBT_LS_CACHE
[2024-11-21T06:36:29.000+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:36:29.000+0000] {converter.py:308} INFO - Cosmos performance (nyc_green_taxi__transform) - [4d3972a47987|694]: It took 0.0106s to build the Airflow DAG.
[2024-11-21T06:36:29.003+0000] {processor.py:840} INFO - DAG(s) 'nyc_green_taxi' retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:36:29.045+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:36:29.045+0000] {dag.py:3089} INFO - Sync 1 DAGs
[2024-11-21T06:36:29.087+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:36:29.087+0000] {dag.py:3947} INFO - Setting next_dagrun for nyc_green_taxi to 2024-11-20 00:00:00+00:00, run_after=2024-11-20 00:00:00+00:00
[2024-11-21T06:36:29.129+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 4.580 seconds
[2024-11-21T06:36:59.428+0000] {processor.py:161} INFO - Started process (PID=703) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:36:59.430+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T06:36:59.439+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:36:59.438+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:36:59.552+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:36:59.551+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T06:37:02.353+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:37:02.352+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 4.276473753999653
[2024-11-21T06:37:02.354+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:37:02.354+0000] {graph.py:487} INFO - Cosmos performance [4d3972a47987|703]: The cache size for cosmos_cache__nyc_green_taxi__transform is 2621
[2024-11-21T06:37:02.356+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:37:02.356+0000] {graph.py:495} INFO - Cosmos performance: Cache hit for cosmos_cache__nyc_green_taxi__transform - 0535576c8d7b9c0b5de17cec0f5a6dce,16a7af22baa01082ccbc983a81f25573
[2024-11-21T06:37:02.358+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:37:02.357+0000] {graph.py:412} INFO - Total nodes: 3
[2024-11-21T06:37:02.359+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:37:02.359+0000] {graph.py:413} INFO - Total filtered nodes: 3
[2024-11-21T06:37:02.361+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:37:02.360+0000] {converter.py:264} INFO - Cosmos performance (nyc_green_taxi__transform) -  [4d3972a47987|703]: It took 4.31s to parse the dbt project for DAG using LoadMode.DBT_LS_CACHE
[2024-11-21T06:37:02.370+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:37:02.370+0000] {converter.py:308} INFO - Cosmos performance (nyc_green_taxi__transform) - [4d3972a47987|703]: It took 0.00961s to build the Airflow DAG.
[2024-11-21T06:37:02.373+0000] {processor.py:840} INFO - DAG(s) 'nyc_green_taxi' retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:37:02.414+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:37:02.414+0000] {dag.py:3089} INFO - Sync 1 DAGs
[2024-11-21T06:37:02.456+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:37:02.456+0000] {dag.py:3947} INFO - Setting next_dagrun for nyc_green_taxi to 2024-11-20 00:00:00+00:00, run_after=2024-11-20 00:00:00+00:00
[2024-11-21T06:37:02.500+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 4.589 seconds
[2024-11-21T06:37:33.261+0000] {processor.py:161} INFO - Started process (PID=711) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:37:33.264+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T06:37:33.268+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:37:33.267+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:37:33.379+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:37:33.378+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T06:37:37.740+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:37:37.739+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 4.330754642000102
[2024-11-21T06:37:37.741+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:37:37.741+0000] {graph.py:487} INFO - Cosmos performance [4d3972a47987|711]: The cache size for cosmos_cache__nyc_green_taxi__transform is 2621
[2024-11-21T06:37:37.743+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:37:37.743+0000] {graph.py:495} INFO - Cosmos performance: Cache hit for cosmos_cache__nyc_green_taxi__transform - 0535576c8d7b9c0b5de17cec0f5a6dce,16a7af22baa01082ccbc983a81f25573
[2024-11-21T06:37:37.745+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:37:37.744+0000] {graph.py:412} INFO - Total nodes: 3
[2024-11-21T06:37:37.746+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:37:37.746+0000] {graph.py:413} INFO - Total filtered nodes: 3
[2024-11-21T06:37:37.747+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:37:37.747+0000] {converter.py:264} INFO - Cosmos performance (nyc_green_taxi__transform) -  [4d3972a47987|711]: It took 4.37s to parse the dbt project for DAG using LoadMode.DBT_LS_CACHE
[2024-11-21T06:37:37.760+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:37:37.759+0000] {converter.py:308} INFO - Cosmos performance (nyc_green_taxi__transform) - [4d3972a47987|711]: It took 0.0123s to build the Airflow DAG.
[2024-11-21T06:37:37.763+0000] {processor.py:840} INFO - DAG(s) 'nyc_green_taxi' retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:37:37.810+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:37:37.810+0000] {dag.py:3089} INFO - Sync 1 DAGs
[2024-11-21T06:37:37.873+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:37:37.873+0000] {dag.py:3947} INFO - Setting next_dagrun for nyc_green_taxi to 2024-11-20 00:00:00+00:00, run_after=2024-11-20 00:00:00+00:00
[2024-11-21T06:37:37.914+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 4.669 seconds
[2024-11-21T06:38:08.443+0000] {processor.py:161} INFO - Started process (PID=719) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:38:08.445+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T06:38:08.449+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:38:08.449+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:38:08.551+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:38:08.550+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T06:38:12.673+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:38:12.672+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 4.087804724999842
[2024-11-21T06:38:12.675+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:38:12.674+0000] {graph.py:487} INFO - Cosmos performance [4d3972a47987|719]: The cache size for cosmos_cache__nyc_green_taxi__transform is 2621
[2024-11-21T06:38:12.677+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:38:12.676+0000] {graph.py:495} INFO - Cosmos performance: Cache hit for cosmos_cache__nyc_green_taxi__transform - 0535576c8d7b9c0b5de17cec0f5a6dce,16a7af22baa01082ccbc983a81f25573
[2024-11-21T06:38:12.678+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:38:12.678+0000] {graph.py:412} INFO - Total nodes: 3
[2024-11-21T06:38:12.680+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:38:12.679+0000] {graph.py:413} INFO - Total filtered nodes: 3
[2024-11-21T06:38:12.681+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:38:12.681+0000] {converter.py:264} INFO - Cosmos performance (nyc_green_taxi__transform) -  [4d3972a47987|719]: It took 4.13s to parse the dbt project for DAG using LoadMode.DBT_LS_CACHE
[2024-11-21T06:38:12.691+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:38:12.691+0000] {converter.py:308} INFO - Cosmos performance (nyc_green_taxi__transform) - [4d3972a47987|719]: It took 0.0102s to build the Airflow DAG.
[2024-11-21T06:38:12.694+0000] {processor.py:840} INFO - DAG(s) 'nyc_green_taxi' retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:38:12.741+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:38:12.740+0000] {dag.py:3089} INFO - Sync 1 DAGs
[2024-11-21T06:38:12.789+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:38:12.788+0000] {dag.py:3947} INFO - Setting next_dagrun for nyc_green_taxi to 2024-11-20 00:00:00+00:00, run_after=2024-11-20 00:00:00+00:00
[2024-11-21T06:38:12.843+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 4.417 seconds
[2024-11-21T06:38:43.037+0000] {processor.py:161} INFO - Started process (PID=733) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:38:43.040+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T06:38:43.046+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:38:43.045+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:38:43.135+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:38:43.134+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T06:38:46.958+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:38:46.957+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 3.792488937000144
[2024-11-21T06:38:46.962+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:38:46.961+0000] {graph.py:487} INFO - Cosmos performance [4d3972a47987|733]: The cache size for cosmos_cache__nyc_green_taxi__transform is 2621
[2024-11-21T06:38:46.964+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:38:46.963+0000] {graph.py:495} INFO - Cosmos performance: Cache hit for cosmos_cache__nyc_green_taxi__transform - 0535576c8d7b9c0b5de17cec0f5a6dce,16a7af22baa01082ccbc983a81f25573
[2024-11-21T06:38:46.966+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:38:46.965+0000] {graph.py:412} INFO - Total nodes: 3
[2024-11-21T06:38:46.967+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:38:46.967+0000] {graph.py:413} INFO - Total filtered nodes: 3
[2024-11-21T06:38:46.969+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:38:46.968+0000] {converter.py:264} INFO - Cosmos performance (nyc_green_taxi__transform) -  [4d3972a47987|733]: It took 3.83s to parse the dbt project for DAG using LoadMode.DBT_LS_CACHE
[2024-11-21T06:38:46.980+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:38:46.980+0000] {converter.py:308} INFO - Cosmos performance (nyc_green_taxi__transform) - [4d3972a47987|733]: It took 0.0115s to build the Airflow DAG.
[2024-11-21T06:38:46.983+0000] {processor.py:840} INFO - DAG(s) 'nyc_green_taxi' retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:38:47.034+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:38:47.033+0000] {dag.py:3089} INFO - Sync 1 DAGs
[2024-11-21T06:38:47.089+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:38:47.088+0000] {dag.py:3947} INFO - Setting next_dagrun for nyc_green_taxi to 2024-11-20 00:00:00+00:00, run_after=2024-11-20 00:00:00+00:00
[2024-11-21T06:38:47.144+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 4.124 seconds
[2024-11-21T06:39:17.490+0000] {processor.py:161} INFO - Started process (PID=742) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:39:17.493+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T06:39:17.497+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:39:17.497+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:39:17.596+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:39:17.595+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T06:39:21.251+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:39:21.251+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 3.623245334999865
[2024-11-21T06:39:21.253+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:39:21.252+0000] {graph.py:487} INFO - Cosmos performance [4d3972a47987|742]: The cache size for cosmos_cache__nyc_green_taxi__transform is 2621
[2024-11-21T06:39:21.255+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:39:21.254+0000] {graph.py:495} INFO - Cosmos performance: Cache hit for cosmos_cache__nyc_green_taxi__transform - 0535576c8d7b9c0b5de17cec0f5a6dce,16a7af22baa01082ccbc983a81f25573
[2024-11-21T06:39:21.257+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:39:21.256+0000] {graph.py:412} INFO - Total nodes: 3
[2024-11-21T06:39:21.258+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:39:21.257+0000] {graph.py:413} INFO - Total filtered nodes: 3
[2024-11-21T06:39:21.259+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:39:21.259+0000] {converter.py:264} INFO - Cosmos performance (nyc_green_taxi__transform) -  [4d3972a47987|742]: It took 3.66s to parse the dbt project for DAG using LoadMode.DBT_LS_CACHE
[2024-11-21T06:39:21.269+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:39:21.269+0000] {converter.py:308} INFO - Cosmos performance (nyc_green_taxi__transform) - [4d3972a47987|742]: It took 0.0102s to build the Airflow DAG.
[2024-11-21T06:39:21.272+0000] {processor.py:840} INFO - DAG(s) 'nyc_green_taxi' retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:39:21.317+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:39:21.316+0000] {dag.py:3089} INFO - Sync 1 DAGs
[2024-11-21T06:39:21.359+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:39:21.359+0000] {dag.py:3947} INFO - Setting next_dagrun for nyc_green_taxi to 2024-11-20 00:00:00+00:00, run_after=2024-11-20 00:00:00+00:00
[2024-11-21T06:39:21.402+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 3.930 seconds
[2024-11-21T06:39:51.932+0000] {processor.py:161} INFO - Started process (PID=750) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:39:51.935+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T06:39:51.939+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:39:51.938+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:39:52.038+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:39:52.038+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T06:39:54.771+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:39:54.770+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 4.170026774999769
[2024-11-21T06:39:54.772+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:39:54.772+0000] {graph.py:487} INFO - Cosmos performance [4d3972a47987|750]: The cache size for cosmos_cache__nyc_green_taxi__transform is 2621
[2024-11-21T06:39:54.774+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:39:54.774+0000] {graph.py:495} INFO - Cosmos performance: Cache hit for cosmos_cache__nyc_green_taxi__transform - 0535576c8d7b9c0b5de17cec0f5a6dce,16a7af22baa01082ccbc983a81f25573
[2024-11-21T06:39:54.776+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:39:54.775+0000] {graph.py:412} INFO - Total nodes: 3
[2024-11-21T06:39:54.777+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:39:54.777+0000] {graph.py:413} INFO - Total filtered nodes: 3
[2024-11-21T06:39:54.778+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:39:54.778+0000] {converter.py:264} INFO - Cosmos performance (nyc_green_taxi__transform) -  [4d3972a47987|750]: It took 4.21s to parse the dbt project for DAG using LoadMode.DBT_LS_CACHE
[2024-11-21T06:39:54.788+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:39:54.788+0000] {converter.py:308} INFO - Cosmos performance (nyc_green_taxi__transform) - [4d3972a47987|750]: It took 0.00967s to build the Airflow DAG.
[2024-11-21T06:39:54.791+0000] {processor.py:840} INFO - DAG(s) 'nyc_green_taxi' retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:39:54.836+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:39:54.835+0000] {dag.py:3089} INFO - Sync 1 DAGs
[2024-11-21T06:39:54.886+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:39:54.885+0000] {dag.py:3947} INFO - Setting next_dagrun for nyc_green_taxi to 2024-11-20 00:00:00+00:00, run_after=2024-11-20 00:00:00+00:00
[2024-11-21T06:39:54.933+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 4.484 seconds
[2024-11-21T06:40:25.176+0000] {processor.py:161} INFO - Started process (PID=758) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:40:25.178+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T06:40:25.184+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:40:25.183+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:40:25.300+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:40:25.299+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T06:40:29.370+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:40:29.370+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 4.035829040999943
[2024-11-21T06:40:29.372+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:40:29.372+0000] {graph.py:487} INFO - Cosmos performance [4d3972a47987|758]: The cache size for cosmos_cache__nyc_green_taxi__transform is 2621
[2024-11-21T06:40:29.374+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:40:29.374+0000] {graph.py:495} INFO - Cosmos performance: Cache hit for cosmos_cache__nyc_green_taxi__transform - 0535576c8d7b9c0b5de17cec0f5a6dce,16a7af22baa01082ccbc983a81f25573
[2024-11-21T06:40:29.376+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:40:29.375+0000] {graph.py:412} INFO - Total nodes: 3
[2024-11-21T06:40:29.378+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:40:29.378+0000] {graph.py:413} INFO - Total filtered nodes: 3
[2024-11-21T06:40:29.379+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:40:29.379+0000] {converter.py:264} INFO - Cosmos performance (nyc_green_taxi__transform) -  [4d3972a47987|758]: It took 4.08s to parse the dbt project for DAG using LoadMode.DBT_LS_CACHE
[2024-11-21T06:40:29.388+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:40:29.388+0000] {converter.py:308} INFO - Cosmos performance (nyc_green_taxi__transform) - [4d3972a47987|758]: It took 0.00894s to build the Airflow DAG.
[2024-11-21T06:40:29.392+0000] {processor.py:840} INFO - DAG(s) 'nyc_green_taxi' retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:40:29.436+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:40:29.436+0000] {dag.py:3089} INFO - Sync 1 DAGs
[2024-11-21T06:40:29.477+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:40:29.477+0000] {dag.py:3947} INFO - Setting next_dagrun for nyc_green_taxi to 2024-11-20 00:00:00+00:00, run_after=2024-11-20 00:00:00+00:00
[2024-11-21T06:40:29.515+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 4.358 seconds
[2024-11-21T06:41:00.615+0000] {processor.py:161} INFO - Started process (PID=766) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:41:00.617+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T06:41:00.621+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:41:00.621+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:41:00.725+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:41:00.725+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T06:41:04.985+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:41:04.984+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 4.230566236999948
[2024-11-21T06:41:04.986+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:41:04.986+0000] {graph.py:487} INFO - Cosmos performance [4d3972a47987|766]: The cache size for cosmos_cache__nyc_green_taxi__transform is 2621
[2024-11-21T06:41:04.988+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:41:04.988+0000] {graph.py:495} INFO - Cosmos performance: Cache hit for cosmos_cache__nyc_green_taxi__transform - 0535576c8d7b9c0b5de17cec0f5a6dce,16a7af22baa01082ccbc983a81f25573
[2024-11-21T06:41:04.991+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:41:04.989+0000] {graph.py:412} INFO - Total nodes: 3
[2024-11-21T06:41:04.992+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:41:04.992+0000] {graph.py:413} INFO - Total filtered nodes: 3
[2024-11-21T06:41:04.994+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:41:04.993+0000] {converter.py:264} INFO - Cosmos performance (nyc_green_taxi__transform) -  [4d3972a47987|766]: It took 4.27s to parse the dbt project for DAG using LoadMode.DBT_LS_CACHE
[2024-11-21T06:41:05.006+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:41:05.006+0000] {converter.py:308} INFO - Cosmos performance (nyc_green_taxi__transform) - [4d3972a47987|766]: It took 0.0127s to build the Airflow DAG.
[2024-11-21T06:41:05.010+0000] {processor.py:840} INFO - DAG(s) 'nyc_green_taxi' retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:41:05.087+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:41:05.087+0000] {dag.py:3089} INFO - Sync 1 DAGs
[2024-11-21T06:41:05.142+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:41:05.142+0000] {dag.py:3947} INFO - Setting next_dagrun for nyc_green_taxi to 2024-11-20 00:00:00+00:00, run_after=2024-11-20 00:00:00+00:00
[2024-11-21T06:41:05.191+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 4.594 seconds
[2024-11-21T06:41:35.608+0000] {processor.py:161} INFO - Started process (PID=780) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:41:35.610+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T06:41:35.615+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:41:35.615+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:41:35.722+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:41:35.721+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T06:41:40.050+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:41:40.050+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 4.296673702999669
[2024-11-21T06:41:40.052+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:41:40.051+0000] {graph.py:487} INFO - Cosmos performance [4d3972a47987|780]: The cache size for cosmos_cache__nyc_green_taxi__transform is 2621
[2024-11-21T06:41:40.054+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:41:40.053+0000] {graph.py:495} INFO - Cosmos performance: Cache hit for cosmos_cache__nyc_green_taxi__transform - 0535576c8d7b9c0b5de17cec0f5a6dce,16a7af22baa01082ccbc983a81f25573
[2024-11-21T06:41:40.055+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:41:40.054+0000] {graph.py:412} INFO - Total nodes: 3
[2024-11-21T06:41:40.057+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:41:40.056+0000] {graph.py:413} INFO - Total filtered nodes: 3
[2024-11-21T06:41:40.058+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:41:40.058+0000] {converter.py:264} INFO - Cosmos performance (nyc_green_taxi__transform) -  [4d3972a47987|780]: It took 4.34s to parse the dbt project for DAG using LoadMode.DBT_LS_CACHE
[2024-11-21T06:41:40.068+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:41:40.068+0000] {converter.py:308} INFO - Cosmos performance (nyc_green_taxi__transform) - [4d3972a47987|780]: It took 0.0106s to build the Airflow DAG.
[2024-11-21T06:41:40.071+0000] {processor.py:840} INFO - DAG(s) 'nyc_green_taxi' retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:41:40.116+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:41:40.116+0000] {dag.py:3089} INFO - Sync 1 DAGs
[2024-11-21T06:41:40.160+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:41:40.159+0000] {dag.py:3947} INFO - Setting next_dagrun for nyc_green_taxi to 2024-11-20 00:00:00+00:00, run_after=2024-11-20 00:00:00+00:00
[2024-11-21T06:41:40.200+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 4.607 seconds
[2024-11-21T06:42:10.526+0000] {processor.py:161} INFO - Started process (PID=788) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:42:10.528+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T06:42:10.533+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:42:10.532+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:42:10.645+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:42:10.645+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T06:42:15.067+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:42:15.067+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 4.391962589000286
[2024-11-21T06:42:15.069+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:42:15.069+0000] {graph.py:487} INFO - Cosmos performance [4d3972a47987|788]: The cache size for cosmos_cache__nyc_green_taxi__transform is 2621
[2024-11-21T06:42:15.071+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:42:15.070+0000] {graph.py:495} INFO - Cosmos performance: Cache hit for cosmos_cache__nyc_green_taxi__transform - 0535576c8d7b9c0b5de17cec0f5a6dce,16a7af22baa01082ccbc983a81f25573
[2024-11-21T06:42:15.073+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:42:15.072+0000] {graph.py:412} INFO - Total nodes: 3
[2024-11-21T06:42:15.074+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:42:15.074+0000] {graph.py:413} INFO - Total filtered nodes: 3
[2024-11-21T06:42:15.076+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:42:15.075+0000] {converter.py:264} INFO - Cosmos performance (nyc_green_taxi__transform) -  [4d3972a47987|788]: It took 4.43s to parse the dbt project for DAG using LoadMode.DBT_LS_CACHE
[2024-11-21T06:42:15.086+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:42:15.086+0000] {converter.py:308} INFO - Cosmos performance (nyc_green_taxi__transform) - [4d3972a47987|788]: It took 0.0104s to build the Airflow DAG.
[2024-11-21T06:42:15.089+0000] {processor.py:840} INFO - DAG(s) 'nyc_green_taxi' retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:42:15.135+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:42:15.135+0000] {dag.py:3089} INFO - Sync 1 DAGs
[2024-11-21T06:42:15.181+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:42:15.180+0000] {dag.py:3947} INFO - Setting next_dagrun for nyc_green_taxi to 2024-11-20 00:00:00+00:00, run_after=2024-11-20 00:00:00+00:00
[2024-11-21T06:42:15.224+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 4.713 seconds
[2024-11-21T06:42:45.524+0000] {processor.py:161} INFO - Started process (PID=796) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:42:45.527+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T06:42:45.531+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:42:45.531+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:42:45.644+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:42:45.643+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T06:42:50.085+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:42:50.084+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 4.398181167000075
[2024-11-21T06:42:50.086+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:42:50.086+0000] {graph.py:487} INFO - Cosmos performance [4d3972a47987|796]: The cache size for cosmos_cache__nyc_green_taxi__transform is 2621
[2024-11-21T06:42:50.088+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:42:50.088+0000] {graph.py:495} INFO - Cosmos performance: Cache hit for cosmos_cache__nyc_green_taxi__transform - 0535576c8d7b9c0b5de17cec0f5a6dce,16a7af22baa01082ccbc983a81f25573
[2024-11-21T06:42:50.090+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:42:50.089+0000] {graph.py:412} INFO - Total nodes: 3
[2024-11-21T06:42:50.091+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:42:50.091+0000] {graph.py:413} INFO - Total filtered nodes: 3
[2024-11-21T06:42:50.092+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:42:50.092+0000] {converter.py:264} INFO - Cosmos performance (nyc_green_taxi__transform) -  [4d3972a47987|796]: It took 4.45s to parse the dbt project for DAG using LoadMode.DBT_LS_CACHE
[2024-11-21T06:42:50.103+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:42:50.102+0000] {converter.py:308} INFO - Cosmos performance (nyc_green_taxi__transform) - [4d3972a47987|796]: It took 0.0102s to build the Airflow DAG.
[2024-11-21T06:42:50.107+0000] {processor.py:840} INFO - DAG(s) 'nyc_green_taxi' retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:42:50.166+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:42:50.165+0000] {dag.py:3089} INFO - Sync 1 DAGs
[2024-11-21T06:42:50.218+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:42:50.218+0000] {dag.py:3947} INFO - Setting next_dagrun for nyc_green_taxi to 2024-11-20 00:00:00+00:00, run_after=2024-11-20 00:00:00+00:00
[2024-11-21T06:42:50.268+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 4.766 seconds
[2024-11-21T06:43:20.553+0000] {processor.py:161} INFO - Started process (PID=805) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:43:20.556+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T06:43:20.560+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:43:20.559+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:43:20.665+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:43:20.664+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T06:43:24.928+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:43:24.928+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 4.232514461000392
[2024-11-21T06:43:24.929+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:43:24.929+0000] {graph.py:487} INFO - Cosmos performance [4d3972a47987|805]: The cache size for cosmos_cache__nyc_green_taxi__transform is 2621
[2024-11-21T06:43:24.931+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:43:24.931+0000] {graph.py:495} INFO - Cosmos performance: Cache hit for cosmos_cache__nyc_green_taxi__transform - 0535576c8d7b9c0b5de17cec0f5a6dce,16a7af22baa01082ccbc983a81f25573
[2024-11-21T06:43:24.933+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:43:24.932+0000] {graph.py:412} INFO - Total nodes: 3
[2024-11-21T06:43:24.934+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:43:24.934+0000] {graph.py:413} INFO - Total filtered nodes: 3
[2024-11-21T06:43:24.936+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:43:24.936+0000] {converter.py:264} INFO - Cosmos performance (nyc_green_taxi__transform) -  [4d3972a47987|805]: It took 4.27s to parse the dbt project for DAG using LoadMode.DBT_LS_CACHE
[2024-11-21T06:43:24.946+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:43:24.945+0000] {converter.py:308} INFO - Cosmos performance (nyc_green_taxi__transform) - [4d3972a47987|805]: It took 0.01s to build the Airflow DAG.
[2024-11-21T06:43:24.949+0000] {processor.py:840} INFO - DAG(s) 'nyc_green_taxi' retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:43:24.993+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:43:24.992+0000] {dag.py:3089} INFO - Sync 1 DAGs
[2024-11-21T06:43:25.033+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:43:25.032+0000] {dag.py:3947} INFO - Setting next_dagrun for nyc_green_taxi to 2024-11-20 00:00:00+00:00, run_after=2024-11-20 00:00:00+00:00
[2024-11-21T06:43:25.079+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 4.541 seconds
[2024-11-21T06:43:55.243+0000] {processor.py:161} INFO - Started process (PID=813) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:43:55.246+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T06:43:55.251+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:43:55.250+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:43:55.356+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:43:55.355+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T06:43:59.603+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:43:59.602+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 4.209614705000149
[2024-11-21T06:43:59.604+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:43:59.604+0000] {graph.py:487} INFO - Cosmos performance [4d3972a47987|813]: The cache size for cosmos_cache__nyc_green_taxi__transform is 2621
[2024-11-21T06:43:59.606+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:43:59.606+0000] {graph.py:495} INFO - Cosmos performance: Cache hit for cosmos_cache__nyc_green_taxi__transform - 0535576c8d7b9c0b5de17cec0f5a6dce,16a7af22baa01082ccbc983a81f25573
[2024-11-21T06:43:59.608+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:43:59.607+0000] {graph.py:412} INFO - Total nodes: 3
[2024-11-21T06:43:59.609+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:43:59.609+0000] {graph.py:413} INFO - Total filtered nodes: 3
[2024-11-21T06:43:59.610+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:43:59.610+0000] {converter.py:264} INFO - Cosmos performance (nyc_green_taxi__transform) -  [4d3972a47987|813]: It took 4.25s to parse the dbt project for DAG using LoadMode.DBT_LS_CACHE
[2024-11-21T06:43:59.620+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:43:59.619+0000] {converter.py:308} INFO - Cosmos performance (nyc_green_taxi__transform) - [4d3972a47987|813]: It took 0.0097s to build the Airflow DAG.
[2024-11-21T06:43:59.623+0000] {processor.py:840} INFO - DAG(s) 'nyc_green_taxi' retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:43:59.666+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:43:59.665+0000] {dag.py:3089} INFO - Sync 1 DAGs
[2024-11-21T06:43:59.708+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:43:59.707+0000] {dag.py:3947} INFO - Setting next_dagrun for nyc_green_taxi to 2024-11-20 00:00:00+00:00, run_after=2024-11-20 00:00:00+00:00
[2024-11-21T06:43:59.754+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 4.528 seconds
[2024-11-21T06:44:29.891+0000] {processor.py:161} INFO - Started process (PID=827) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:44:29.893+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T06:44:29.901+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:44:29.900+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:44:30.006+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:44:30.006+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T06:44:34.051+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:44:34.051+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 4.014534900999934
[2024-11-21T06:44:34.053+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:44:34.052+0000] {graph.py:487} INFO - Cosmos performance [4d3972a47987|827]: The cache size for cosmos_cache__nyc_green_taxi__transform is 2621
[2024-11-21T06:44:34.055+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:44:34.054+0000] {graph.py:495} INFO - Cosmos performance: Cache hit for cosmos_cache__nyc_green_taxi__transform - 0535576c8d7b9c0b5de17cec0f5a6dce,16a7af22baa01082ccbc983a81f25573
[2024-11-21T06:44:34.057+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:44:34.056+0000] {graph.py:412} INFO - Total nodes: 3
[2024-11-21T06:44:34.058+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:44:34.058+0000] {graph.py:413} INFO - Total filtered nodes: 3
[2024-11-21T06:44:34.059+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:44:34.059+0000] {converter.py:264} INFO - Cosmos performance (nyc_green_taxi__transform) -  [4d3972a47987|827]: It took 4.05s to parse the dbt project for DAG using LoadMode.DBT_LS_CACHE
[2024-11-21T06:44:34.069+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:44:34.069+0000] {converter.py:308} INFO - Cosmos performance (nyc_green_taxi__transform) - [4d3972a47987|827]: It took 0.00996s to build the Airflow DAG.
[2024-11-21T06:44:34.072+0000] {processor.py:840} INFO - DAG(s) 'nyc_green_taxi' retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:44:34.117+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:44:34.116+0000] {dag.py:3089} INFO - Sync 1 DAGs
[2024-11-21T06:44:34.164+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:44:34.163+0000] {dag.py:3947} INFO - Setting next_dagrun for nyc_green_taxi to 2024-11-20 00:00:00+00:00, run_after=2024-11-20 00:00:00+00:00
[2024-11-21T06:44:34.205+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 4.334 seconds
[2024-11-21T06:45:04.349+0000] {processor.py:161} INFO - Started process (PID=835) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:45:04.351+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T06:45:04.356+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:45:04.355+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:45:04.460+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:45:04.459+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T06:45:07.109+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:45:07.108+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 4.038598304000061
[2024-11-21T06:45:07.110+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:45:07.110+0000] {graph.py:487} INFO - Cosmos performance [4d3972a47987|835]: The cache size for cosmos_cache__nyc_green_taxi__transform is 2621
[2024-11-21T06:45:07.113+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:45:07.112+0000] {graph.py:495} INFO - Cosmos performance: Cache hit for cosmos_cache__nyc_green_taxi__transform - 0535576c8d7b9c0b5de17cec0f5a6dce,16a7af22baa01082ccbc983a81f25573
[2024-11-21T06:45:07.115+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:45:07.114+0000] {graph.py:412} INFO - Total nodes: 3
[2024-11-21T06:45:07.116+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:45:07.116+0000] {graph.py:413} INFO - Total filtered nodes: 3
[2024-11-21T06:45:07.117+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:45:07.117+0000] {converter.py:264} INFO - Cosmos performance (nyc_green_taxi__transform) -  [4d3972a47987|835]: It took 4.08s to parse the dbt project for DAG using LoadMode.DBT_LS_CACHE
[2024-11-21T06:45:07.128+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:45:07.128+0000] {converter.py:308} INFO - Cosmos performance (nyc_green_taxi__transform) - [4d3972a47987|835]: It took 0.011s to build the Airflow DAG.
[2024-11-21T06:45:07.131+0000] {processor.py:840} INFO - DAG(s) 'nyc_green_taxi' retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:45:07.184+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:45:07.184+0000] {dag.py:3089} INFO - Sync 1 DAGs
[2024-11-21T06:45:07.229+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:45:07.228+0000] {dag.py:3947} INFO - Setting next_dagrun for nyc_green_taxi to 2024-11-20 00:00:00+00:00, run_after=2024-11-20 00:00:00+00:00
[2024-11-21T06:45:07.294+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 4.379 seconds
[2024-11-21T06:45:37.450+0000] {processor.py:161} INFO - Started process (PID=843) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:45:37.452+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T06:45:37.457+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:45:37.456+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:45:37.566+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:45:37.566+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T06:45:41.195+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:45:41.195+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 3.599238061000051
[2024-11-21T06:45:41.197+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:45:41.196+0000] {graph.py:487} INFO - Cosmos performance [4d3972a47987|843]: The cache size for cosmos_cache__nyc_green_taxi__transform is 2621
[2024-11-21T06:45:41.199+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:45:41.198+0000] {graph.py:495} INFO - Cosmos performance: Cache hit for cosmos_cache__nyc_green_taxi__transform - 0535576c8d7b9c0b5de17cec0f5a6dce,16a7af22baa01082ccbc983a81f25573
[2024-11-21T06:45:41.200+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:45:41.200+0000] {graph.py:412} INFO - Total nodes: 3
[2024-11-21T06:45:41.202+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:45:41.201+0000] {graph.py:413} INFO - Total filtered nodes: 3
[2024-11-21T06:45:41.203+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:45:41.203+0000] {converter.py:264} INFO - Cosmos performance (nyc_green_taxi__transform) -  [4d3972a47987|843]: It took 3.64s to parse the dbt project for DAG using LoadMode.DBT_LS_CACHE
[2024-11-21T06:45:41.213+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:45:41.213+0000] {converter.py:308} INFO - Cosmos performance (nyc_green_taxi__transform) - [4d3972a47987|843]: It took 0.0103s to build the Airflow DAG.
[2024-11-21T06:45:41.216+0000] {processor.py:840} INFO - DAG(s) 'nyc_green_taxi' retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:45:41.261+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:45:41.261+0000] {dag.py:3089} INFO - Sync 1 DAGs
[2024-11-21T06:45:41.302+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:45:41.302+0000] {dag.py:3947} INFO - Setting next_dagrun for nyc_green_taxi to 2024-11-20 00:00:00+00:00, run_after=2024-11-20 00:00:00+00:00
[2024-11-21T06:45:41.346+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 3.913 seconds
[2024-11-21T06:46:11.548+0000] {processor.py:161} INFO - Started process (PID=851) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:46:11.550+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T06:46:11.554+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:46:11.554+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:46:11.656+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:46:11.656+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T06:46:15.957+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:46:15.956+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 4.2711410450001495
[2024-11-21T06:46:15.959+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:46:15.958+0000] {graph.py:487} INFO - Cosmos performance [4d3972a47987|851]: The cache size for cosmos_cache__nyc_green_taxi__transform is 2621
[2024-11-21T06:46:15.961+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:46:15.960+0000] {graph.py:495} INFO - Cosmos performance: Cache hit for cosmos_cache__nyc_green_taxi__transform - 0535576c8d7b9c0b5de17cec0f5a6dce,16a7af22baa01082ccbc983a81f25573
[2024-11-21T06:46:15.963+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:46:15.962+0000] {graph.py:412} INFO - Total nodes: 3
[2024-11-21T06:46:15.964+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:46:15.963+0000] {graph.py:413} INFO - Total filtered nodes: 3
[2024-11-21T06:46:15.965+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:46:15.965+0000] {converter.py:264} INFO - Cosmos performance (nyc_green_taxi__transform) -  [4d3972a47987|851]: It took 4.31s to parse the dbt project for DAG using LoadMode.DBT_LS_CACHE
[2024-11-21T06:46:15.975+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:46:15.975+0000] {converter.py:308} INFO - Cosmos performance (nyc_green_taxi__transform) - [4d3972a47987|851]: It took 0.0101s to build the Airflow DAG.
[2024-11-21T06:46:15.978+0000] {processor.py:840} INFO - DAG(s) 'nyc_green_taxi' retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:46:16.027+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:46:16.026+0000] {dag.py:3089} INFO - Sync 1 DAGs
[2024-11-21T06:46:16.070+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:46:16.070+0000] {dag.py:3947} INFO - Setting next_dagrun for nyc_green_taxi to 2024-11-20 00:00:00+00:00, run_after=2024-11-20 00:00:00+00:00
[2024-11-21T06:46:16.111+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 4.577 seconds
[2024-11-21T06:46:46.368+0000] {processor.py:161} INFO - Started process (PID=859) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:46:46.370+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T06:46:46.375+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:46:46.375+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:46:46.484+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:46:46.483+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T06:46:50.640+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:46:50.639+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 4.122546683999644
[2024-11-21T06:46:50.641+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:46:50.641+0000] {graph.py:487} INFO - Cosmos performance [4d3972a47987|859]: The cache size for cosmos_cache__nyc_green_taxi__transform is 2621
[2024-11-21T06:46:50.643+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:46:50.643+0000] {graph.py:495} INFO - Cosmos performance: Cache hit for cosmos_cache__nyc_green_taxi__transform - 0535576c8d7b9c0b5de17cec0f5a6dce,16a7af22baa01082ccbc983a81f25573
[2024-11-21T06:46:50.645+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:46:50.644+0000] {graph.py:412} INFO - Total nodes: 3
[2024-11-21T06:46:50.647+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:46:50.646+0000] {graph.py:413} INFO - Total filtered nodes: 3
[2024-11-21T06:46:50.648+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:46:50.647+0000] {converter.py:264} INFO - Cosmos performance (nyc_green_taxi__transform) -  [4d3972a47987|859]: It took 4.16s to parse the dbt project for DAG using LoadMode.DBT_LS_CACHE
[2024-11-21T06:46:50.658+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:46:50.657+0000] {converter.py:308} INFO - Cosmos performance (nyc_green_taxi__transform) - [4d3972a47987|859]: It took 0.00969s to build the Airflow DAG.
[2024-11-21T06:46:50.660+0000] {processor.py:840} INFO - DAG(s) 'nyc_green_taxi' retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:46:50.711+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:46:50.710+0000] {dag.py:3089} INFO - Sync 1 DAGs
[2024-11-21T06:46:50.761+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:46:50.760+0000] {dag.py:3947} INFO - Setting next_dagrun for nyc_green_taxi to 2024-11-20 00:00:00+00:00, run_after=2024-11-20 00:00:00+00:00
[2024-11-21T06:46:50.815+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 4.464 seconds
[2024-11-21T06:47:21.123+0000] {processor.py:161} INFO - Started process (PID=872) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:47:21.125+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T06:47:21.129+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:47:21.129+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:47:21.248+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:47:21.247+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T06:47:25.587+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:47:25.586+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 4.298769709000226
[2024-11-21T06:47:25.588+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:47:25.588+0000] {graph.py:487} INFO - Cosmos performance [4d3972a47987|872]: The cache size for cosmos_cache__nyc_green_taxi__transform is 2621
[2024-11-21T06:47:25.590+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:47:25.590+0000] {graph.py:495} INFO - Cosmos performance: Cache hit for cosmos_cache__nyc_green_taxi__transform - 0535576c8d7b9c0b5de17cec0f5a6dce,16a7af22baa01082ccbc983a81f25573
[2024-11-21T06:47:25.592+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:47:25.591+0000] {graph.py:412} INFO - Total nodes: 3
[2024-11-21T06:47:25.594+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:47:25.593+0000] {graph.py:413} INFO - Total filtered nodes: 3
[2024-11-21T06:47:25.595+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:47:25.595+0000] {converter.py:264} INFO - Cosmos performance (nyc_green_taxi__transform) -  [4d3972a47987|872]: It took 4.35s to parse the dbt project for DAG using LoadMode.DBT_LS_CACHE
[2024-11-21T06:47:25.605+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:47:25.604+0000] {converter.py:308} INFO - Cosmos performance (nyc_green_taxi__transform) - [4d3972a47987|872]: It took 0.00963s to build the Airflow DAG.
[2024-11-21T06:47:25.608+0000] {processor.py:840} INFO - DAG(s) 'nyc_green_taxi' retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:47:25.659+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:47:25.658+0000] {dag.py:3089} INFO - Sync 1 DAGs
[2024-11-21T06:47:25.705+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:47:25.704+0000] {dag.py:3947} INFO - Setting next_dagrun for nyc_green_taxi to 2024-11-20 00:00:00+00:00, run_after=2024-11-20 00:00:00+00:00
[2024-11-21T06:47:25.745+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 4.637 seconds
[2024-11-21T06:47:56.358+0000] {processor.py:161} INFO - Started process (PID=881) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:47:56.360+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T06:47:56.365+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:47:56.364+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:47:56.474+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:47:56.473+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T06:47:59.397+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:47:59.396+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 4.427322449999792
[2024-11-21T06:47:59.398+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:47:59.398+0000] {graph.py:487} INFO - Cosmos performance [4d3972a47987|881]: The cache size for cosmos_cache__nyc_green_taxi__transform is 2621
[2024-11-21T06:47:59.400+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:47:59.400+0000] {graph.py:495} INFO - Cosmos performance: Cache hit for cosmos_cache__nyc_green_taxi__transform - 0535576c8d7b9c0b5de17cec0f5a6dce,16a7af22baa01082ccbc983a81f25573
[2024-11-21T06:47:59.402+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:47:59.401+0000] {graph.py:412} INFO - Total nodes: 3
[2024-11-21T06:47:59.403+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:47:59.403+0000] {graph.py:413} INFO - Total filtered nodes: 3
[2024-11-21T06:47:59.405+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:47:59.405+0000] {converter.py:264} INFO - Cosmos performance (nyc_green_taxi__transform) -  [4d3972a47987|881]: It took 4.47s to parse the dbt project for DAG using LoadMode.DBT_LS_CACHE
[2024-11-21T06:47:59.415+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:47:59.414+0000] {converter.py:308} INFO - Cosmos performance (nyc_green_taxi__transform) - [4d3972a47987|881]: It took 0.00994s to build the Airflow DAG.
[2024-11-21T06:47:59.418+0000] {processor.py:840} INFO - DAG(s) 'nyc_green_taxi' retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:47:59.463+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:47:59.463+0000] {dag.py:3089} INFO - Sync 1 DAGs
[2024-11-21T06:47:59.508+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:47:59.507+0000] {dag.py:3947} INFO - Setting next_dagrun for nyc_green_taxi to 2024-11-20 00:00:00+00:00, run_after=2024-11-20 00:00:00+00:00
[2024-11-21T06:47:59.560+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 4.753 seconds
[2024-11-21T06:48:30.401+0000] {processor.py:161} INFO - Started process (PID=889) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:48:30.403+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T06:48:30.407+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:48:30.407+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:48:30.522+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:48:30.521+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T06:48:34.909+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:48:34.909+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 4.356841534000068
[2024-11-21T06:48:34.911+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:48:34.911+0000] {graph.py:487} INFO - Cosmos performance [4d3972a47987|889]: The cache size for cosmos_cache__nyc_green_taxi__transform is 2621
[2024-11-21T06:48:34.913+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:48:34.913+0000] {graph.py:495} INFO - Cosmos performance: Cache hit for cosmos_cache__nyc_green_taxi__transform - 0535576c8d7b9c0b5de17cec0f5a6dce,16a7af22baa01082ccbc983a81f25573
[2024-11-21T06:48:34.915+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:48:34.914+0000] {graph.py:412} INFO - Total nodes: 3
[2024-11-21T06:48:34.917+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:48:34.916+0000] {graph.py:413} INFO - Total filtered nodes: 3
[2024-11-21T06:48:34.918+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:48:34.918+0000] {converter.py:264} INFO - Cosmos performance (nyc_green_taxi__transform) -  [4d3972a47987|889]: It took 4.4s to parse the dbt project for DAG using LoadMode.DBT_LS_CACHE
[2024-11-21T06:48:34.929+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:48:34.928+0000] {converter.py:308} INFO - Cosmos performance (nyc_green_taxi__transform) - [4d3972a47987|889]: It took 0.0108s to build the Airflow DAG.
[2024-11-21T06:48:34.932+0000] {processor.py:840} INFO - DAG(s) 'nyc_green_taxi' retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:48:34.979+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:48:34.978+0000] {dag.py:3089} INFO - Sync 1 DAGs
[2024-11-21T06:48:35.018+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:48:35.018+0000] {dag.py:3947} INFO - Setting next_dagrun for nyc_green_taxi to 2024-11-20 00:00:00+00:00, run_after=2024-11-20 00:00:00+00:00
[2024-11-21T06:48:35.060+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 4.675 seconds
[2024-11-21T06:49:05.640+0000] {processor.py:161} INFO - Started process (PID=897) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:49:05.650+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T06:49:05.663+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:49:05.662+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:49:05.763+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:49:05.763+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T06:49:10.059+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:49:10.059+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 4.261147353000069
[2024-11-21T06:49:10.061+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:49:10.060+0000] {graph.py:487} INFO - Cosmos performance [4d3972a47987|897]: The cache size for cosmos_cache__nyc_green_taxi__transform is 2621
[2024-11-21T06:49:10.063+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:49:10.063+0000] {graph.py:495} INFO - Cosmos performance: Cache hit for cosmos_cache__nyc_green_taxi__transform - 0535576c8d7b9c0b5de17cec0f5a6dce,16a7af22baa01082ccbc983a81f25573
[2024-11-21T06:49:10.065+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:49:10.064+0000] {graph.py:412} INFO - Total nodes: 3
[2024-11-21T06:49:10.067+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:49:10.066+0000] {graph.py:413} INFO - Total filtered nodes: 3
[2024-11-21T06:49:10.068+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:49:10.068+0000] {converter.py:264} INFO - Cosmos performance (nyc_green_taxi__transform) -  [4d3972a47987|897]: It took 4.31s to parse the dbt project for DAG using LoadMode.DBT_LS_CACHE
[2024-11-21T06:49:10.078+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:49:10.078+0000] {converter.py:308} INFO - Cosmos performance (nyc_green_taxi__transform) - [4d3972a47987|897]: It took 0.0106s to build the Airflow DAG.
[2024-11-21T06:49:10.081+0000] {processor.py:840} INFO - DAG(s) 'nyc_green_taxi' retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:49:10.127+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:49:10.126+0000] {dag.py:3089} INFO - Sync 1 DAGs
[2024-11-21T06:49:10.171+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:49:10.170+0000] {dag.py:3947} INFO - Setting next_dagrun for nyc_green_taxi to 2024-11-20 00:00:00+00:00, run_after=2024-11-20 00:00:00+00:00
[2024-11-21T06:49:10.212+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 4.602 seconds
[2024-11-21T06:49:40.432+0000] {processor.py:161} INFO - Started process (PID=911) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:49:40.435+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T06:49:40.440+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:49:40.439+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:49:40.536+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:49:40.536+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T06:49:44.611+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:49:44.610+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 4.04391761099987
[2024-11-21T06:49:44.612+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:49:44.612+0000] {graph.py:487} INFO - Cosmos performance [4d3972a47987|911]: The cache size for cosmos_cache__nyc_green_taxi__transform is 2621
[2024-11-21T06:49:44.614+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:49:44.614+0000] {graph.py:495} INFO - Cosmos performance: Cache hit for cosmos_cache__nyc_green_taxi__transform - 0535576c8d7b9c0b5de17cec0f5a6dce,16a7af22baa01082ccbc983a81f25573
[2024-11-21T06:49:44.616+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:49:44.615+0000] {graph.py:412} INFO - Total nodes: 3
[2024-11-21T06:49:44.618+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:49:44.617+0000] {graph.py:413} INFO - Total filtered nodes: 3
[2024-11-21T06:49:44.619+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:49:44.619+0000] {converter.py:264} INFO - Cosmos performance (nyc_green_taxi__transform) -  [4d3972a47987|911]: It took 4.08s to parse the dbt project for DAG using LoadMode.DBT_LS_CACHE
[2024-11-21T06:49:44.631+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:49:44.630+0000] {converter.py:308} INFO - Cosmos performance (nyc_green_taxi__transform) - [4d3972a47987|911]: It took 0.0117s to build the Airflow DAG.
[2024-11-21T06:49:44.634+0000] {processor.py:840} INFO - DAG(s) 'nyc_green_taxi' retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:49:44.685+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:49:44.684+0000] {dag.py:3089} INFO - Sync 1 DAGs
[2024-11-21T06:49:44.732+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:49:44.731+0000] {dag.py:3947} INFO - Setting next_dagrun for nyc_green_taxi to 2024-11-20 00:00:00+00:00, run_after=2024-11-20 00:00:00+00:00
[2024-11-21T06:49:44.781+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 4.364 seconds
[2024-11-21T06:50:15.089+0000] {processor.py:161} INFO - Started process (PID=919) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:50:15.091+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T06:50:15.096+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:50:15.095+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:50:15.201+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:50:15.201+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T06:50:19.408+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:50:19.407+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 4.175336791000063
[2024-11-21T06:50:19.410+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:50:19.410+0000] {graph.py:487} INFO - Cosmos performance [4d3972a47987|919]: The cache size for cosmos_cache__nyc_green_taxi__transform is 2621
[2024-11-21T06:50:19.413+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:50:19.413+0000] {graph.py:495} INFO - Cosmos performance: Cache hit for cosmos_cache__nyc_green_taxi__transform - 0535576c8d7b9c0b5de17cec0f5a6dce,16a7af22baa01082ccbc983a81f25573
[2024-11-21T06:50:19.416+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:50:19.414+0000] {graph.py:412} INFO - Total nodes: 3
[2024-11-21T06:50:19.417+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:50:19.417+0000] {graph.py:413} INFO - Total filtered nodes: 3
[2024-11-21T06:50:19.420+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:50:19.419+0000] {converter.py:264} INFO - Cosmos performance (nyc_green_taxi__transform) -  [4d3972a47987|919]: It took 4.22s to parse the dbt project for DAG using LoadMode.DBT_LS_CACHE
[2024-11-21T06:50:19.437+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:50:19.436+0000] {converter.py:308} INFO - Cosmos performance (nyc_green_taxi__transform) - [4d3972a47987|919]: It took 0.0175s to build the Airflow DAG.
[2024-11-21T06:50:19.441+0000] {processor.py:840} INFO - DAG(s) 'nyc_green_taxi' retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:50:19.500+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:50:19.500+0000] {dag.py:3089} INFO - Sync 1 DAGs
[2024-11-21T06:50:19.562+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:50:19.561+0000] {dag.py:3947} INFO - Setting next_dagrun for nyc_green_taxi to 2024-11-20 00:00:00+00:00, run_after=2024-11-20 00:00:00+00:00
[2024-11-21T06:50:19.606+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 4.534 seconds
[2024-11-21T06:50:49.796+0000] {processor.py:161} INFO - Started process (PID=927) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:50:49.798+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T06:50:49.803+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:50:49.803+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:50:49.910+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:50:49.909+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T06:50:53.813+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:50:53.813+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 3.871130052999888
[2024-11-21T06:50:53.815+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:50:53.815+0000] {graph.py:487} INFO - Cosmos performance [4d3972a47987|927]: The cache size for cosmos_cache__nyc_green_taxi__transform is 2621
[2024-11-21T06:50:53.817+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:50:53.817+0000] {graph.py:495} INFO - Cosmos performance: Cache hit for cosmos_cache__nyc_green_taxi__transform - 0535576c8d7b9c0b5de17cec0f5a6dce,16a7af22baa01082ccbc983a81f25573
[2024-11-21T06:50:53.819+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:50:53.818+0000] {graph.py:412} INFO - Total nodes: 3
[2024-11-21T06:50:53.820+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:50:53.820+0000] {graph.py:413} INFO - Total filtered nodes: 3
[2024-11-21T06:50:53.822+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:50:53.821+0000] {converter.py:264} INFO - Cosmos performance (nyc_green_taxi__transform) -  [4d3972a47987|927]: It took 3.91s to parse the dbt project for DAG using LoadMode.DBT_LS_CACHE
[2024-11-21T06:50:53.832+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:50:53.831+0000] {converter.py:308} INFO - Cosmos performance (nyc_green_taxi__transform) - [4d3972a47987|927]: It took 0.00979s to build the Airflow DAG.
[2024-11-21T06:50:53.834+0000] {processor.py:840} INFO - DAG(s) 'nyc_green_taxi' retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:50:53.880+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:50:53.880+0000] {dag.py:3089} INFO - Sync 1 DAGs
[2024-11-21T06:50:53.922+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:50:53.921+0000] {dag.py:3947} INFO - Setting next_dagrun for nyc_green_taxi to 2024-11-20 00:00:00+00:00, run_after=2024-11-20 00:00:00+00:00
[2024-11-21T06:50:53.972+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 4.193 seconds
[2024-11-21T06:51:24.178+0000] {processor.py:161} INFO - Started process (PID=935) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:51:24.180+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T06:51:24.183+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:51:24.183+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:51:24.289+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:51:24.289+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T06:51:28.229+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:51:28.228+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 3.905494383000132
[2024-11-21T06:51:28.230+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:51:28.230+0000] {graph.py:487} INFO - Cosmos performance [4d3972a47987|935]: The cache size for cosmos_cache__nyc_green_taxi__transform is 2621
[2024-11-21T06:51:28.233+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:51:28.232+0000] {graph.py:495} INFO - Cosmos performance: Cache hit for cosmos_cache__nyc_green_taxi__transform - 0535576c8d7b9c0b5de17cec0f5a6dce,16a7af22baa01082ccbc983a81f25573
[2024-11-21T06:51:28.234+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:51:28.233+0000] {graph.py:412} INFO - Total nodes: 3
[2024-11-21T06:51:28.236+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:51:28.236+0000] {graph.py:413} INFO - Total filtered nodes: 3
[2024-11-21T06:51:28.237+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:51:28.237+0000] {converter.py:264} INFO - Cosmos performance (nyc_green_taxi__transform) -  [4d3972a47987|935]: It took 3.95s to parse the dbt project for DAG using LoadMode.DBT_LS_CACHE
[2024-11-21T06:51:28.249+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:51:28.248+0000] {converter.py:308} INFO - Cosmos performance (nyc_green_taxi__transform) - [4d3972a47987|935]: It took 0.0111s to build the Airflow DAG.
[2024-11-21T06:51:28.252+0000] {processor.py:840} INFO - DAG(s) 'nyc_green_taxi' retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:51:28.319+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:51:28.319+0000] {dag.py:3089} INFO - Sync 1 DAGs
[2024-11-21T06:51:28.368+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:51:28.367+0000] {dag.py:3947} INFO - Setting next_dagrun for nyc_green_taxi to 2024-11-20 00:00:00+00:00, run_after=2024-11-20 00:00:00+00:00
[2024-11-21T06:51:28.415+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 4.260 seconds
[2024-11-21T06:51:58.626+0000] {processor.py:161} INFO - Started process (PID=943) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:51:58.629+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T06:51:58.634+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:51:58.633+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:51:58.732+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:51:58.731+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T06:52:02.427+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:52:02.426+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 3.65626914700033
[2024-11-21T06:52:02.428+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:52:02.428+0000] {graph.py:487} INFO - Cosmos performance [4d3972a47987|943]: The cache size for cosmos_cache__nyc_green_taxi__transform is 2621
[2024-11-21T06:52:02.430+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:52:02.430+0000] {graph.py:495} INFO - Cosmos performance: Cache hit for cosmos_cache__nyc_green_taxi__transform - 0535576c8d7b9c0b5de17cec0f5a6dce,16a7af22baa01082ccbc983a81f25573
[2024-11-21T06:52:02.432+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:52:02.431+0000] {graph.py:412} INFO - Total nodes: 3
[2024-11-21T06:52:02.433+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:52:02.433+0000] {graph.py:413} INFO - Total filtered nodes: 3
[2024-11-21T06:52:02.435+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:52:02.434+0000] {converter.py:264} INFO - Cosmos performance (nyc_green_taxi__transform) -  [4d3972a47987|943]: It took 3.7s to parse the dbt project for DAG using LoadMode.DBT_LS_CACHE
[2024-11-21T06:52:02.446+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:52:02.445+0000] {converter.py:308} INFO - Cosmos performance (nyc_green_taxi__transform) - [4d3972a47987|943]: It took 0.011s to build the Airflow DAG.
[2024-11-21T06:52:02.449+0000] {processor.py:840} INFO - DAG(s) 'nyc_green_taxi' retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:52:02.501+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:52:02.501+0000] {dag.py:3089} INFO - Sync 1 DAGs
[2024-11-21T06:52:02.556+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:52:02.556+0000] {dag.py:3947} INFO - Setting next_dagrun for nyc_green_taxi to 2024-11-20 00:00:00+00:00, run_after=2024-11-20 00:00:00+00:00
[2024-11-21T06:52:02.603+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 3.999 seconds
[2024-11-21T06:52:32.879+0000] {processor.py:161} INFO - Started process (PID=958) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:52:32.881+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T06:52:32.886+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:52:32.885+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:52:32.996+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:52:32.995+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T06:52:37.321+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:52:37.321+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 4.294310812999811
[2024-11-21T06:52:37.323+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:52:37.322+0000] {graph.py:487} INFO - Cosmos performance [4d3972a47987|958]: The cache size for cosmos_cache__nyc_green_taxi__transform is 2621
[2024-11-21T06:52:37.325+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:52:37.324+0000] {graph.py:495} INFO - Cosmos performance: Cache hit for cosmos_cache__nyc_green_taxi__transform - 0535576c8d7b9c0b5de17cec0f5a6dce,16a7af22baa01082ccbc983a81f25573
[2024-11-21T06:52:37.326+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:52:37.326+0000] {graph.py:412} INFO - Total nodes: 3
[2024-11-21T06:52:37.328+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:52:37.327+0000] {graph.py:413} INFO - Total filtered nodes: 3
[2024-11-21T06:52:37.329+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:52:37.328+0000] {converter.py:264} INFO - Cosmos performance (nyc_green_taxi__transform) -  [4d3972a47987|958]: It took 4.33s to parse the dbt project for DAG using LoadMode.DBT_LS_CACHE
[2024-11-21T06:52:37.340+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:52:37.340+0000] {converter.py:308} INFO - Cosmos performance (nyc_green_taxi__transform) - [4d3972a47987|958]: It took 0.0113s to build the Airflow DAG.
[2024-11-21T06:52:37.344+0000] {processor.py:840} INFO - DAG(s) 'nyc_green_taxi' retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:52:37.395+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:52:37.394+0000] {dag.py:3089} INFO - Sync 1 DAGs
[2024-11-21T06:52:37.446+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:52:37.445+0000] {dag.py:3947} INFO - Setting next_dagrun for nyc_green_taxi to 2024-11-20 00:00:00+00:00, run_after=2024-11-20 00:00:00+00:00
[2024-11-21T06:52:37.494+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 4.629 seconds
[2024-11-21T06:53:07.889+0000] {processor.py:161} INFO - Started process (PID=966) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:53:07.891+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T06:53:07.895+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:53:07.895+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:53:08.009+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:53:08.008+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T06:53:10.841+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:53:10.841+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 4.319970658999864
[2024-11-21T06:53:10.842+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:53:10.842+0000] {graph.py:487} INFO - Cosmos performance [4d3972a47987|966]: The cache size for cosmos_cache__nyc_green_taxi__transform is 2621
[2024-11-21T06:53:10.844+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:53:10.844+0000] {graph.py:495} INFO - Cosmos performance: Cache hit for cosmos_cache__nyc_green_taxi__transform - 0535576c8d7b9c0b5de17cec0f5a6dce,16a7af22baa01082ccbc983a81f25573
[2024-11-21T06:53:10.846+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:53:10.845+0000] {graph.py:412} INFO - Total nodes: 3
[2024-11-21T06:53:10.847+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:53:10.847+0000] {graph.py:413} INFO - Total filtered nodes: 3
[2024-11-21T06:53:10.849+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:53:10.849+0000] {converter.py:264} INFO - Cosmos performance (nyc_green_taxi__transform) -  [4d3972a47987|966]: It took 4.36s to parse the dbt project for DAG using LoadMode.DBT_LS_CACHE
[2024-11-21T06:53:10.860+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:53:10.860+0000] {converter.py:308} INFO - Cosmos performance (nyc_green_taxi__transform) - [4d3972a47987|966]: It took 0.0114s to build the Airflow DAG.
[2024-11-21T06:53:10.863+0000] {processor.py:840} INFO - DAG(s) 'nyc_green_taxi' retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:53:10.909+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:53:10.908+0000] {dag.py:3089} INFO - Sync 1 DAGs
[2024-11-21T06:53:10.951+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:53:10.950+0000] {dag.py:3947} INFO - Setting next_dagrun for nyc_green_taxi to 2024-11-20 00:00:00+00:00, run_after=2024-11-20 00:00:00+00:00
[2024-11-21T06:53:10.996+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 4.645 seconds
[2024-11-21T06:53:41.187+0000] {processor.py:161} INFO - Started process (PID=974) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:53:41.190+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T06:53:41.194+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:53:41.194+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:53:41.303+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:53:41.303+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T06:53:45.721+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:53:45.721+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 4.3860977809999895
[2024-11-21T06:53:45.723+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:53:45.722+0000] {graph.py:487} INFO - Cosmos performance [4d3972a47987|974]: The cache size for cosmos_cache__nyc_green_taxi__transform is 2621
[2024-11-21T06:53:45.725+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:53:45.725+0000] {graph.py:495} INFO - Cosmos performance: Cache hit for cosmos_cache__nyc_green_taxi__transform - 0535576c8d7b9c0b5de17cec0f5a6dce,16a7af22baa01082ccbc983a81f25573
[2024-11-21T06:53:45.727+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:53:45.726+0000] {graph.py:412} INFO - Total nodes: 3
[2024-11-21T06:53:45.728+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:53:45.728+0000] {graph.py:413} INFO - Total filtered nodes: 3
[2024-11-21T06:53:45.730+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:53:45.729+0000] {converter.py:264} INFO - Cosmos performance (nyc_green_taxi__transform) -  [4d3972a47987|974]: It took 4.43s to parse the dbt project for DAG using LoadMode.DBT_LS_CACHE
[2024-11-21T06:53:45.740+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:53:45.740+0000] {converter.py:308} INFO - Cosmos performance (nyc_green_taxi__transform) - [4d3972a47987|974]: It took 0.0109s to build the Airflow DAG.
[2024-11-21T06:53:45.744+0000] {processor.py:840} INFO - DAG(s) 'nyc_green_taxi' retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:53:45.792+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:53:45.791+0000] {dag.py:3089} INFO - Sync 1 DAGs
[2024-11-21T06:53:45.839+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:53:45.839+0000] {dag.py:3947} INFO - Setting next_dagrun for nyc_green_taxi to 2024-11-20 00:00:00+00:00, run_after=2024-11-20 00:00:00+00:00
[2024-11-21T06:53:45.901+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 4.733 seconds
[2024-11-21T06:54:16.213+0000] {processor.py:161} INFO - Started process (PID=982) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:54:16.215+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T06:54:16.220+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:54:16.219+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:54:16.336+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:54:16.335+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T06:54:20.796+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:54:20.795+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 4.427909194999756
[2024-11-21T06:54:20.797+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:54:20.797+0000] {graph.py:487} INFO - Cosmos performance [4d3972a47987|982]: The cache size for cosmos_cache__nyc_green_taxi__transform is 2621
[2024-11-21T06:54:20.799+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:54:20.799+0000] {graph.py:495} INFO - Cosmos performance: Cache hit for cosmos_cache__nyc_green_taxi__transform - 0535576c8d7b9c0b5de17cec0f5a6dce,16a7af22baa01082ccbc983a81f25573
[2024-11-21T06:54:20.801+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:54:20.800+0000] {graph.py:412} INFO - Total nodes: 3
[2024-11-21T06:54:20.802+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:54:20.802+0000] {graph.py:413} INFO - Total filtered nodes: 3
[2024-11-21T06:54:20.804+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:54:20.803+0000] {converter.py:264} INFO - Cosmos performance (nyc_green_taxi__transform) -  [4d3972a47987|982]: It took 4.47s to parse the dbt project for DAG using LoadMode.DBT_LS_CACHE
[2024-11-21T06:54:20.814+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:54:20.814+0000] {converter.py:308} INFO - Cosmos performance (nyc_green_taxi__transform) - [4d3972a47987|982]: It took 0.0106s to build the Airflow DAG.
[2024-11-21T06:54:20.818+0000] {processor.py:840} INFO - DAG(s) 'nyc_green_taxi' retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:54:20.863+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:54:20.863+0000] {dag.py:3089} INFO - Sync 1 DAGs
[2024-11-21T06:54:20.904+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:54:20.904+0000] {dag.py:3947} INFO - Setting next_dagrun for nyc_green_taxi to 2024-11-20 00:00:00+00:00, run_after=2024-11-20 00:00:00+00:00
[2024-11-21T06:54:20.947+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 4.750 seconds
[2024-11-21T06:54:51.402+0000] {processor.py:161} INFO - Started process (PID=990) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:54:51.404+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T06:54:51.409+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:54:51.408+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:54:51.515+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:54:51.514+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T06:54:55.900+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:54:55.899+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 4.35433920000014
[2024-11-21T06:54:55.902+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:54:55.902+0000] {graph.py:487} INFO - Cosmos performance [4d3972a47987|990]: The cache size for cosmos_cache__nyc_green_taxi__transform is 2621
[2024-11-21T06:54:55.904+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:54:55.903+0000] {graph.py:495} INFO - Cosmos performance: Cache hit for cosmos_cache__nyc_green_taxi__transform - 0535576c8d7b9c0b5de17cec0f5a6dce,16a7af22baa01082ccbc983a81f25573
[2024-11-21T06:54:55.906+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:54:55.905+0000] {graph.py:412} INFO - Total nodes: 3
[2024-11-21T06:54:55.907+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:54:55.907+0000] {graph.py:413} INFO - Total filtered nodes: 3
[2024-11-21T06:54:55.909+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:54:55.908+0000] {converter.py:264} INFO - Cosmos performance (nyc_green_taxi__transform) -  [4d3972a47987|990]: It took 4.39s to parse the dbt project for DAG using LoadMode.DBT_LS_CACHE
[2024-11-21T06:54:55.919+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:54:55.918+0000] {converter.py:308} INFO - Cosmos performance (nyc_green_taxi__transform) - [4d3972a47987|990]: It took 0.01s to build the Airflow DAG.
[2024-11-21T06:54:55.922+0000] {processor.py:840} INFO - DAG(s) 'nyc_green_taxi' retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:54:55.977+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:54:55.977+0000] {dag.py:3089} INFO - Sync 1 DAGs
[2024-11-21T06:54:56.030+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:54:56.029+0000] {dag.py:3947} INFO - Setting next_dagrun for nyc_green_taxi to 2024-11-20 00:00:00+00:00, run_after=2024-11-20 00:00:00+00:00
[2024-11-21T06:54:56.081+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 4.693 seconds
[2024-11-21T06:55:26.462+0000] {processor.py:161} INFO - Started process (PID=1004) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:55:26.465+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T06:55:26.470+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:55:26.469+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:55:26.566+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:55:26.565+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T06:55:30.933+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:55:30.933+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 4.335997987000155
[2024-11-21T06:55:30.935+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:55:30.935+0000] {graph.py:487} INFO - Cosmos performance [4d3972a47987|1004]: The cache size for cosmos_cache__nyc_green_taxi__transform is 2621
[2024-11-21T06:55:30.937+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:55:30.937+0000] {graph.py:495} INFO - Cosmos performance: Cache hit for cosmos_cache__nyc_green_taxi__transform - 0535576c8d7b9c0b5de17cec0f5a6dce,16a7af22baa01082ccbc983a81f25573
[2024-11-21T06:55:30.939+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:55:30.938+0000] {graph.py:412} INFO - Total nodes: 3
[2024-11-21T06:55:30.940+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:55:30.940+0000] {graph.py:413} INFO - Total filtered nodes: 3
[2024-11-21T06:55:30.941+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:55:30.941+0000] {converter.py:264} INFO - Cosmos performance (nyc_green_taxi__transform) -  [4d3972a47987|1004]: It took 4.38s to parse the dbt project for DAG using LoadMode.DBT_LS_CACHE
[2024-11-21T06:55:30.952+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:55:30.952+0000] {converter.py:308} INFO - Cosmos performance (nyc_green_taxi__transform) - [4d3972a47987|1004]: It took 0.0107s to build the Airflow DAG.
[2024-11-21T06:55:30.955+0000] {processor.py:840} INFO - DAG(s) 'nyc_green_taxi' retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:55:30.999+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:55:30.999+0000] {dag.py:3089} INFO - Sync 1 DAGs
[2024-11-21T06:55:31.043+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:55:31.042+0000] {dag.py:3947} INFO - Setting next_dagrun for nyc_green_taxi to 2024-11-20 00:00:00+00:00, run_after=2024-11-20 00:00:00+00:00
[2024-11-21T06:55:31.083+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 4.639 seconds
[2024-11-21T06:56:01.705+0000] {processor.py:161} INFO - Started process (PID=1012) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:56:01.708+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T06:56:01.714+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:56:01.713+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:56:01.812+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:56:01.812+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T06:56:04.421+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:56:04.421+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 4.140101340000001
[2024-11-21T06:56:04.423+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:56:04.423+0000] {graph.py:487} INFO - Cosmos performance [4d3972a47987|1012]: The cache size for cosmos_cache__nyc_green_taxi__transform is 2621
[2024-11-21T06:56:04.425+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:56:04.425+0000] {graph.py:495} INFO - Cosmos performance: Cache hit for cosmos_cache__nyc_green_taxi__transform - 0535576c8d7b9c0b5de17cec0f5a6dce,16a7af22baa01082ccbc983a81f25573
[2024-11-21T06:56:04.427+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:56:04.426+0000] {graph.py:412} INFO - Total nodes: 3
[2024-11-21T06:56:04.428+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:56:04.428+0000] {graph.py:413} INFO - Total filtered nodes: 3
[2024-11-21T06:56:04.429+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:56:04.429+0000] {converter.py:264} INFO - Cosmos performance (nyc_green_taxi__transform) -  [4d3972a47987|1012]: It took 4.18s to parse the dbt project for DAG using LoadMode.DBT_LS_CACHE
[2024-11-21T06:56:04.439+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:56:04.439+0000] {converter.py:308} INFO - Cosmos performance (nyc_green_taxi__transform) - [4d3972a47987|1012]: It took 0.0102s to build the Airflow DAG.
[2024-11-21T06:56:04.442+0000] {processor.py:840} INFO - DAG(s) 'nyc_green_taxi' retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:56:04.488+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:56:04.488+0000] {dag.py:3089} INFO - Sync 1 DAGs
[2024-11-21T06:56:04.540+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:56:04.539+0000] {dag.py:3947} INFO - Setting next_dagrun for nyc_green_taxi to 2024-11-20 00:00:00+00:00, run_after=2024-11-20 00:00:00+00:00
[2024-11-21T06:56:04.589+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 4.471 seconds
[2024-11-21T06:56:35.014+0000] {processor.py:161} INFO - Started process (PID=1021) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:56:35.025+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T06:56:35.035+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:56:35.034+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:56:35.140+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:56:35.139+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T06:56:39.479+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:56:39.478+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 4.307499542000187
[2024-11-21T06:56:39.481+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:56:39.480+0000] {graph.py:487} INFO - Cosmos performance [4d3972a47987|1021]: The cache size for cosmos_cache__nyc_green_taxi__transform is 2621
[2024-11-21T06:56:39.483+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:56:39.482+0000] {graph.py:495} INFO - Cosmos performance: Cache hit for cosmos_cache__nyc_green_taxi__transform - 0535576c8d7b9c0b5de17cec0f5a6dce,16a7af22baa01082ccbc983a81f25573
[2024-11-21T06:56:39.485+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:56:39.484+0000] {graph.py:412} INFO - Total nodes: 3
[2024-11-21T06:56:39.486+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:56:39.486+0000] {graph.py:413} INFO - Total filtered nodes: 3
[2024-11-21T06:56:39.488+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:56:39.487+0000] {converter.py:264} INFO - Cosmos performance (nyc_green_taxi__transform) -  [4d3972a47987|1021]: It took 4.35s to parse the dbt project for DAG using LoadMode.DBT_LS_CACHE
[2024-11-21T06:56:39.499+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:56:39.499+0000] {converter.py:308} INFO - Cosmos performance (nyc_green_taxi__transform) - [4d3972a47987|1021]: It took 0.0114s to build the Airflow DAG.
[2024-11-21T06:56:39.502+0000] {processor.py:840} INFO - DAG(s) 'nyc_green_taxi' retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:56:39.549+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:56:39.548+0000] {dag.py:3089} INFO - Sync 1 DAGs
[2024-11-21T06:56:39.595+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:56:39.595+0000] {dag.py:3947} INFO - Setting next_dagrun for nyc_green_taxi to 2024-11-20 00:00:00+00:00, run_after=2024-11-20 00:00:00+00:00
[2024-11-21T06:56:39.639+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 4.644 seconds
[2024-11-21T06:57:09.907+0000] {processor.py:161} INFO - Started process (PID=1030) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:57:09.910+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T06:57:09.916+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:57:09.916+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:57:09.998+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:57:09.997+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T06:57:13.079+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:57:13.079+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 3.0495431889999054
[2024-11-21T06:57:13.081+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:57:13.080+0000] {graph.py:487} INFO - Cosmos performance [4d3972a47987|1030]: The cache size for cosmos_cache__nyc_green_taxi__transform is 2621
[2024-11-21T06:57:13.083+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:57:13.083+0000] {graph.py:495} INFO - Cosmos performance: Cache hit for cosmos_cache__nyc_green_taxi__transform - 0535576c8d7b9c0b5de17cec0f5a6dce,16a7af22baa01082ccbc983a81f25573
[2024-11-21T06:57:13.085+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:57:13.084+0000] {graph.py:412} INFO - Total nodes: 3
[2024-11-21T06:57:13.086+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:57:13.086+0000] {graph.py:413} INFO - Total filtered nodes: 3
[2024-11-21T06:57:13.087+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:57:13.087+0000] {converter.py:264} INFO - Cosmos performance (nyc_green_taxi__transform) -  [4d3972a47987|1030]: It took 3.09s to parse the dbt project for DAG using LoadMode.DBT_LS_CACHE
[2024-11-21T06:57:13.100+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:57:13.099+0000] {converter.py:308} INFO - Cosmos performance (nyc_green_taxi__transform) - [4d3972a47987|1030]: It took 0.0124s to build the Airflow DAG.
[2024-11-21T06:57:13.104+0000] {processor.py:840} INFO - DAG(s) 'nyc_green_taxi' retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:57:13.169+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:57:13.168+0000] {dag.py:3089} INFO - Sync 1 DAGs
[2024-11-21T06:57:13.241+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:57:13.240+0000] {dag.py:3947} INFO - Setting next_dagrun for nyc_green_taxi to 2024-11-20 00:00:00+00:00, run_after=2024-11-20 00:00:00+00:00
[2024-11-21T06:57:13.302+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 3.414 seconds
[2024-11-21T06:57:43.981+0000] {processor.py:161} INFO - Started process (PID=1038) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:57:43.984+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T06:57:43.989+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:57:43.988+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:57:44.081+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:57:44.080+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T06:57:47.933+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:57:47.933+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 3.826111440999739
[2024-11-21T06:57:47.935+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:57:47.935+0000] {graph.py:487} INFO - Cosmos performance [4d3972a47987|1038]: The cache size for cosmos_cache__nyc_green_taxi__transform is 2621
[2024-11-21T06:57:47.937+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:57:47.937+0000] {graph.py:495} INFO - Cosmos performance: Cache hit for cosmos_cache__nyc_green_taxi__transform - 0535576c8d7b9c0b5de17cec0f5a6dce,16a7af22baa01082ccbc983a81f25573
[2024-11-21T06:57:47.939+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:57:47.938+0000] {graph.py:412} INFO - Total nodes: 3
[2024-11-21T06:57:47.941+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:57:47.940+0000] {graph.py:413} INFO - Total filtered nodes: 3
[2024-11-21T06:57:47.942+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:57:47.941+0000] {converter.py:264} INFO - Cosmos performance (nyc_green_taxi__transform) -  [4d3972a47987|1038]: It took 3.86s to parse the dbt project for DAG using LoadMode.DBT_LS_CACHE
[2024-11-21T06:57:47.951+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:57:47.951+0000] {converter.py:308} INFO - Cosmos performance (nyc_green_taxi__transform) - [4d3972a47987|1038]: It took 0.00962s to build the Airflow DAG.
[2024-11-21T06:57:47.954+0000] {processor.py:840} INFO - DAG(s) 'nyc_green_taxi' retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:57:48.006+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:57:48.005+0000] {dag.py:3089} INFO - Sync 1 DAGs
[2024-11-21T06:57:48.058+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:57:48.057+0000] {dag.py:3947} INFO - Setting next_dagrun for nyc_green_taxi to 2024-11-20 00:00:00+00:00, run_after=2024-11-20 00:00:00+00:00
[2024-11-21T06:57:48.102+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 4.142 seconds
[2024-11-21T06:58:18.368+0000] {processor.py:161} INFO - Started process (PID=1053) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:58:18.371+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T06:58:18.375+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:58:18.375+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:58:18.484+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:58:18.484+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T06:58:22.164+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:58:22.163+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 3.6459312310003043
[2024-11-21T06:58:22.166+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:58:22.165+0000] {graph.py:487} INFO - Cosmos performance [4d3972a47987|1053]: The cache size for cosmos_cache__nyc_green_taxi__transform is 2621
[2024-11-21T06:58:22.168+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:58:22.168+0000] {graph.py:495} INFO - Cosmos performance: Cache hit for cosmos_cache__nyc_green_taxi__transform - 0535576c8d7b9c0b5de17cec0f5a6dce,16a7af22baa01082ccbc983a81f25573
[2024-11-21T06:58:22.170+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:58:22.169+0000] {graph.py:412} INFO - Total nodes: 3
[2024-11-21T06:58:22.172+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:58:22.171+0000] {graph.py:413} INFO - Total filtered nodes: 3
[2024-11-21T06:58:22.173+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:58:22.173+0000] {converter.py:264} INFO - Cosmos performance (nyc_green_taxi__transform) -  [4d3972a47987|1053]: It took 3.69s to parse the dbt project for DAG using LoadMode.DBT_LS_CACHE
[2024-11-21T06:58:22.184+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:58:22.184+0000] {converter.py:308} INFO - Cosmos performance (nyc_green_taxi__transform) - [4d3972a47987|1053]: It took 0.0107s to build the Airflow DAG.
[2024-11-21T06:58:22.187+0000] {processor.py:840} INFO - DAG(s) 'nyc_green_taxi' retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:58:22.233+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:58:22.232+0000] {dag.py:3089} INFO - Sync 1 DAGs
[2024-11-21T06:58:22.274+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:58:22.274+0000] {dag.py:3947} INFO - Setting next_dagrun for nyc_green_taxi to 2024-11-20 00:00:00+00:00, run_after=2024-11-20 00:00:00+00:00
[2024-11-21T06:58:22.313+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 3.959 seconds
[2024-11-21T06:58:52.018+0000] {processor.py:161} INFO - Started process (PID=1061) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:58:52.020+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T06:58:52.026+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:58:52.025+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:58:52.131+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:58:52.131+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T06:58:55.512+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:58:55.512+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 4.291894210999999
[2024-11-21T06:58:55.514+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:58:55.514+0000] {graph.py:487} INFO - Cosmos performance [4d3972a47987|1061]: The cache size for cosmos_cache__nyc_green_taxi__transform is 2621
[2024-11-21T06:58:55.516+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:58:55.516+0000] {graph.py:495} INFO - Cosmos performance: Cache hit for cosmos_cache__nyc_green_taxi__transform - 0535576c8d7b9c0b5de17cec0f5a6dce,16a7af22baa01082ccbc983a81f25573
[2024-11-21T06:58:55.518+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:58:55.517+0000] {graph.py:412} INFO - Total nodes: 3
[2024-11-21T06:58:55.519+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:58:55.519+0000] {graph.py:413} INFO - Total filtered nodes: 3
[2024-11-21T06:58:55.521+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:58:55.520+0000] {converter.py:264} INFO - Cosmos performance (nyc_green_taxi__transform) -  [4d3972a47987|1061]: It took 4.33s to parse the dbt project for DAG using LoadMode.DBT_LS_CACHE
[2024-11-21T06:58:55.531+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:58:55.531+0000] {converter.py:308} INFO - Cosmos performance (nyc_green_taxi__transform) - [4d3972a47987|1061]: It took 0.0104s to build the Airflow DAG.
[2024-11-21T06:58:55.534+0000] {processor.py:840} INFO - DAG(s) 'nyc_green_taxi' retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:58:55.584+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:58:55.583+0000] {dag.py:3089} INFO - Sync 1 DAGs
[2024-11-21T06:58:55.633+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:58:55.633+0000] {dag.py:3947} INFO - Setting next_dagrun for nyc_green_taxi to 2024-11-20 00:00:00+00:00, run_after=2024-11-20 00:00:00+00:00
[2024-11-21T06:58:55.673+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 4.612 seconds
[2024-11-21T06:59:25.948+0000] {processor.py:161} INFO - Started process (PID=1069) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:59:25.956+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T06:59:25.968+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:59:25.967+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:59:26.058+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:59:26.057+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T06:59:30.319+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:59:30.318+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 4.218645234000178
[2024-11-21T06:59:30.320+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:59:30.320+0000] {graph.py:487} INFO - Cosmos performance [4d3972a47987|1069]: The cache size for cosmos_cache__nyc_green_taxi__transform is 2621
[2024-11-21T06:59:30.322+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:59:30.322+0000] {graph.py:495} INFO - Cosmos performance: Cache hit for cosmos_cache__nyc_green_taxi__transform - 0535576c8d7b9c0b5de17cec0f5a6dce,16a7af22baa01082ccbc983a81f25573
[2024-11-21T06:59:30.324+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:59:30.323+0000] {graph.py:412} INFO - Total nodes: 3
[2024-11-21T06:59:30.326+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:59:30.325+0000] {graph.py:413} INFO - Total filtered nodes: 3
[2024-11-21T06:59:30.327+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:59:30.326+0000] {converter.py:264} INFO - Cosmos performance (nyc_green_taxi__transform) -  [4d3972a47987|1069]: It took 4.27s to parse the dbt project for DAG using LoadMode.DBT_LS_CACHE
[2024-11-21T06:59:30.341+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:59:30.341+0000] {converter.py:308} INFO - Cosmos performance (nyc_green_taxi__transform) - [4d3972a47987|1069]: It took 0.0144s to build the Airflow DAG.
[2024-11-21T06:59:30.345+0000] {processor.py:840} INFO - DAG(s) 'nyc_green_taxi' retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T06:59:30.389+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:59:30.388+0000] {dag.py:3089} INFO - Sync 1 DAGs
[2024-11-21T06:59:30.431+0000] {logging_mixin.py:188} INFO - [2024-11-21T06:59:30.431+0000] {dag.py:3947} INFO - Setting next_dagrun for nyc_green_taxi to 2024-11-20 00:00:00+00:00, run_after=2024-11-20 00:00:00+00:00
[2024-11-21T06:59:30.477+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 4.586 seconds
[2024-11-21T07:00:00.825+0000] {processor.py:161} INFO - Started process (PID=1077) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T07:00:00.828+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T07:00:00.832+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:00:00.832+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T07:00:00.940+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:00:00.939+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T07:00:04.913+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:00:04.912+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 3.940052969000135
[2024-11-21T07:00:04.914+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:00:04.914+0000] {graph.py:487} INFO - Cosmos performance [4d3972a47987|1077]: The cache size for cosmos_cache__nyc_green_taxi__transform is 2621
[2024-11-21T07:00:04.916+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:00:04.916+0000] {graph.py:495} INFO - Cosmos performance: Cache hit for cosmos_cache__nyc_green_taxi__transform - 0535576c8d7b9c0b5de17cec0f5a6dce,16a7af22baa01082ccbc983a81f25573
[2024-11-21T07:00:04.918+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:00:04.917+0000] {graph.py:412} INFO - Total nodes: 3
[2024-11-21T07:00:04.920+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:00:04.919+0000] {graph.py:413} INFO - Total filtered nodes: 3
[2024-11-21T07:00:04.921+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:00:04.921+0000] {converter.py:264} INFO - Cosmos performance (nyc_green_taxi__transform) -  [4d3972a47987|1077]: It took 3.98s to parse the dbt project for DAG using LoadMode.DBT_LS_CACHE
[2024-11-21T07:00:04.931+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:00:04.931+0000] {converter.py:308} INFO - Cosmos performance (nyc_green_taxi__transform) - [4d3972a47987|1077]: It took 0.0101s to build the Airflow DAG.
[2024-11-21T07:00:04.934+0000] {processor.py:840} INFO - DAG(s) 'nyc_green_taxi' retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T07:00:04.993+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:00:04.992+0000] {dag.py:3089} INFO - Sync 1 DAGs
[2024-11-21T07:00:05.039+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:00:05.039+0000] {dag.py:3947} INFO - Setting next_dagrun for nyc_green_taxi to 2024-11-20 00:00:00+00:00, run_after=2024-11-20 00:00:00+00:00
[2024-11-21T07:00:05.088+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 4.279 seconds
[2024-11-21T07:00:35.369+0000] {processor.py:161} INFO - Started process (PID=1092) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T07:00:35.371+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T07:00:35.376+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:00:35.375+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T07:00:35.506+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:00:35.505+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T07:00:43.142+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:00:43.142+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 7.606044989999646
[2024-11-21T07:00:43.144+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:00:43.143+0000] {graph.py:487} INFO - Cosmos performance [4d3972a47987|1092]: The cache size for cosmos_cache__nyc_green_taxi__transform is 2621
[2024-11-21T07:00:43.146+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:00:43.146+0000] {graph.py:495} INFO - Cosmos performance: Cache hit for cosmos_cache__nyc_green_taxi__transform - 0535576c8d7b9c0b5de17cec0f5a6dce,16a7af22baa01082ccbc983a81f25573
[2024-11-21T07:00:43.149+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:00:43.148+0000] {graph.py:412} INFO - Total nodes: 3
[2024-11-21T07:00:43.150+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:00:43.150+0000] {graph.py:413} INFO - Total filtered nodes: 3
[2024-11-21T07:00:43.152+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:00:43.151+0000] {converter.py:264} INFO - Cosmos performance (nyc_green_taxi__transform) -  [4d3972a47987|1092]: It took 7.65s to parse the dbt project for DAG using LoadMode.DBT_LS_CACHE
[2024-11-21T07:00:43.163+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:00:43.162+0000] {converter.py:308} INFO - Cosmos performance (nyc_green_taxi__transform) - [4d3972a47987|1092]: It took 0.0113s to build the Airflow DAG.
[2024-11-21T07:00:43.166+0000] {processor.py:840} INFO - DAG(s) 'nyc_green_taxi' retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T07:00:43.214+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:00:43.214+0000] {dag.py:3089} INFO - Sync 1 DAGs
[2024-11-21T07:00:43.271+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:00:43.270+0000] {dag.py:3947} INFO - Setting next_dagrun for nyc_green_taxi to 2024-11-20 00:00:00+00:00, run_after=2024-11-20 00:00:00+00:00
[2024-11-21T07:00:43.313+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 7.958 seconds
[2024-11-21T07:01:13.779+0000] {processor.py:161} INFO - Started process (PID=1101) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T07:01:13.782+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T07:01:13.786+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:01:13.786+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T07:01:13.900+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:01:13.900+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T07:01:16.497+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:01:16.496+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 4.229696742000215
[2024-11-21T07:01:16.498+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:01:16.498+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T07:01:16.500+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:01:16.499+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T07:01:16.521+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:01:16.520+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T07:01:16.570+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:01:16.570+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T07:01:16.603+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:01:16.603+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmph7rv55eo --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T07:01:27.579+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:01:27.577+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmph7rv55eo --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T07:01:42.156+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:01:42.155+0000] {timeout.py:68} ERROR - Process timed out, PID: 1101
[2024-11-21T07:02:12.740+0000] {processor.py:161} INFO - Started process (PID=1136) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T07:02:12.742+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T07:02:12.746+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:02:12.745+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T07:02:12.849+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:02:12.848+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T07:02:16.585+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:02:16.584+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 3.7039176739999675
[2024-11-21T07:02:16.586+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:02:16.586+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T07:02:16.588+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:02:16.588+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T07:02:16.608+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:02:16.608+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T07:02:16.625+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:02:16.625+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T07:02:16.654+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:02:16.654+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp1b2us013 --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T07:02:25.750+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:02:25.749+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp1b2us013 --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T07:02:41.203+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:02:41.202+0000] {timeout.py:68} ERROR - Process timed out, PID: 1136
[2024-11-21T07:03:11.445+0000] {processor.py:161} INFO - Started process (PID=1173) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T07:03:11.448+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T07:03:11.450+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:03:11.449+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T07:03:11.561+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:03:11.560+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T07:03:15.099+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:03:15.099+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 3.5096978459996535
[2024-11-21T07:03:15.101+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:03:15.100+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T07:03:15.102+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:03:15.102+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T07:03:15.118+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:03:15.118+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T07:03:15.134+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:03:15.133+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T07:03:15.157+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:03:15.157+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpd7xwlnzz --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T07:03:24.927+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:03:24.925+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpd7xwlnzz --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T07:03:39.954+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:03:39.952+0000] {timeout.py:68} ERROR - Process timed out, PID: 1173
[2024-11-21T07:04:10.165+0000] {processor.py:161} INFO - Started process (PID=1210) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T07:04:10.167+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T07:04:10.170+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:04:10.170+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T07:04:10.287+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:04:10.287+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T07:04:14.705+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:04:14.704+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 4.381880522999381
[2024-11-21T07:04:14.706+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:04:14.706+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T07:04:14.708+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:04:14.707+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T07:04:14.729+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:04:14.729+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T07:04:14.748+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:04:14.747+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T07:04:14.779+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:04:14.778+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpuwyux0cz --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T07:04:24.445+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:04:24.444+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpuwyux0cz --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T07:04:38.644+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:04:38.643+0000] {timeout.py:68} ERROR - Process timed out, PID: 1210
[2024-11-21T07:05:09.088+0000] {processor.py:161} INFO - Started process (PID=1246) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T07:05:09.090+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T07:05:09.092+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:05:09.092+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T07:05:09.205+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:05:09.204+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T07:05:13.468+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:05:13.468+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 4.2296897409996745
[2024-11-21T07:05:13.470+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:05:13.469+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T07:05:13.471+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:05:13.471+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T07:05:13.492+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:05:13.492+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T07:05:13.510+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:05:13.510+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T07:05:13.540+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:05:13.539+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmplx4695af --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T07:05:23.020+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:05:23.018+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmplx4695af --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T07:05:37.518+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:05:37.516+0000] {timeout.py:68} ERROR - Process timed out, PID: 1246
[2024-11-21T07:06:07.960+0000] {processor.py:161} INFO - Started process (PID=1282) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T07:06:07.962+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T07:06:07.965+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:06:07.964+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T07:06:08.085+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:06:08.085+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T07:06:12.479+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:06:12.479+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 4.357687930999418
[2024-11-21T07:06:12.481+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:06:12.480+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T07:06:12.482+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:06:12.482+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T07:06:12.502+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:06:12.502+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T07:06:12.519+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:06:12.519+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T07:06:12.546+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:06:12.546+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpy66zvwul --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T07:06:21.985+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:06:21.984+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpy66zvwul --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T07:06:36.375+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:06:36.374+0000] {timeout.py:68} ERROR - Process timed out, PID: 1282
[2024-11-21T07:07:06.633+0000] {processor.py:161} INFO - Started process (PID=1318) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T07:07:06.636+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T07:07:06.639+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:07:06.638+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T07:07:06.824+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:07:06.823+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T07:07:10.759+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:07:10.758+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 3.8867367490001925
[2024-11-21T07:07:10.761+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:07:10.760+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T07:07:10.762+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:07:10.762+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T07:07:10.777+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:07:10.777+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T07:07:10.795+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:07:10.795+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T07:07:10.821+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:07:10.821+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpqx5qdbwk --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T07:07:21.033+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:07:21.031+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpqx5qdbwk --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T07:07:35.108+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:07:35.107+0000] {timeout.py:68} ERROR - Process timed out, PID: 1318
[2024-11-21T07:08:05.874+0000] {processor.py:161} INFO - Started process (PID=1354) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T07:08:05.876+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T07:08:05.879+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:08:05.878+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T07:08:05.992+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:08:05.991+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T07:08:10.205+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:08:10.204+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 4.181296456999917
[2024-11-21T07:08:10.206+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:08:10.206+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T07:08:10.208+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:08:10.207+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T07:08:10.228+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:08:10.227+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T07:08:10.245+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:08:10.244+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T07:08:10.274+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:08:10.273+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmppkhcu5dy --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T07:08:19.475+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:08:19.474+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmppkhcu5dy --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T07:08:34.286+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:08:34.285+0000] {timeout.py:68} ERROR - Process timed out, PID: 1354
[2024-11-21T07:09:04.469+0000] {processor.py:161} INFO - Started process (PID=1390) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T07:09:04.471+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T07:09:04.473+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:09:04.472+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T07:09:04.578+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:09:04.577+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T07:09:08.408+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:09:08.407+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 3.793128936999892
[2024-11-21T07:09:08.410+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:09:08.409+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T07:09:08.411+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:09:08.411+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T07:09:08.425+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:09:08.425+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T07:09:08.443+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:09:08.443+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T07:09:08.464+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:09:08.463+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpv6b9f7te --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T07:09:17.141+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:09:17.139+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpv6b9f7te --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T07:09:32.916+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:09:32.915+0000] {timeout.py:68} ERROR - Process timed out, PID: 1390
[2024-11-21T07:10:03.135+0000] {processor.py:161} INFO - Started process (PID=1426) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T07:10:03.137+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T07:10:03.139+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:10:03.139+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T07:10:03.248+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:10:03.247+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T07:10:07.739+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:10:07.739+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 4.457710378999764
[2024-11-21T07:10:07.740+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:10:07.740+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T07:10:07.742+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:10:07.741+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T07:10:07.762+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:10:07.762+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T07:10:07.778+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:10:07.778+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T07:10:07.808+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:10:07.807+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp_20oqc6w --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T07:10:15.609+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:10:15.608+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp_20oqc6w --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T07:10:31.615+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:10:31.614+0000] {timeout.py:68} ERROR - Process timed out, PID: 1426
[2024-11-21T07:11:01.965+0000] {processor.py:161} INFO - Started process (PID=1468) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T07:11:01.967+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T07:11:01.970+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:11:01.969+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T07:11:02.075+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:11:02.074+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T07:11:06.192+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:11:06.191+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 4.08359493900025
[2024-11-21T07:11:06.193+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:11:06.193+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T07:11:06.195+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:11:06.194+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T07:11:06.215+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:11:06.215+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T07:11:06.234+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:11:06.234+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T07:11:06.260+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:11:06.260+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpml49svn0 --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T07:11:14.404+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:11:14.403+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpml49svn0 --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T07:11:30.418+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:11:30.417+0000] {timeout.py:68} ERROR - Process timed out, PID: 1468
[2024-11-21T07:12:00.682+0000] {processor.py:161} INFO - Started process (PID=1504) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T07:12:00.685+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T07:12:00.687+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:12:00.686+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T07:12:00.798+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:12:00.797+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T07:12:05.188+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:12:05.187+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 4.359419018000153
[2024-11-21T07:12:05.189+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:12:05.189+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T07:12:05.190+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:12:05.190+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T07:12:05.207+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:12:05.206+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T07:12:05.223+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:12:05.222+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T07:12:05.250+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:12:05.250+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpt3rcwria --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T07:12:12.985+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:12:12.983+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpt3rcwria --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T07:12:29.166+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:12:29.165+0000] {timeout.py:68} ERROR - Process timed out, PID: 1504
[2024-11-21T07:12:59.418+0000] {processor.py:161} INFO - Started process (PID=1540) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T07:12:59.421+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T07:12:59.424+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:12:59.423+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T07:12:59.519+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:12:59.518+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T07:13:03.595+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:13:03.595+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 4.043401463000009
[2024-11-21T07:13:03.597+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:13:03.596+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T07:13:03.598+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:13:03.598+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T07:13:03.618+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:13:03.618+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T07:13:03.635+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:13:03.635+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T07:13:03.665+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:13:03.664+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpshfywkx0 --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T07:13:11.427+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:13:11.425+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpshfywkx0 --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T07:13:25.634+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:13:25.620+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 203, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpshfywkx0', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
07:13:17  Running with dbt=1.8.7
07:13:20  Registered adapter: bigquery=1.8.3
07:13:22  [WARNING]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
07:13:22  Encountered an error:
Compilation Error
  dbt found two data_tests with the name "unique_fct_trips_trip_id" defined on column "trip_id" in "models.fct_trips".
  
  Since these resources have the same name, dbt will be unable to find the correct resource
  when running tests.
  
  To fix this, change the name of one of these resources:
  - test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab (models/tests/schema.yml)
  - test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab (models/tests/schema.yml)
[2024-11-21T07:13:25.636+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T07:13:25.673+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 27.837 seconds
[2024-11-21T07:13:55.864+0000] {processor.py:161} INFO - Started process (PID=1576) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T07:13:55.866+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T07:13:55.868+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:13:55.867+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T07:13:55.978+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:13:55.977+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T07:14:00.264+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:14:00.264+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 4.252740629999607
[2024-11-21T07:14:00.266+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:14:00.265+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T07:14:00.267+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:14:00.267+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T07:14:00.286+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:14:00.286+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T07:14:00.301+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:14:00.301+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T07:14:00.328+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:14:00.328+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpov74yvtt --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T07:14:08.684+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:14:08.683+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpov74yvtt --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T07:14:23.723+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:14:23.709+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 203, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpov74yvtt', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
07:14:15  Running with dbt=1.8.7
07:14:19  Registered adapter: bigquery=1.8.3
07:14:20  [WARNING]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
07:14:21  Encountered an error:
Compilation Error
  dbt found two data_tests with the name "unique_fct_trips_trip_id" defined on column "trip_id" in "models.fct_trips".
  
  Since these resources have the same name, dbt will be unable to find the correct resource
  when running tests.
  
  To fix this, change the name of one of these resources:
  - test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab (models/tests/schema.yml)
  - test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab (models/tests/schema.yml)
[2024-11-21T07:14:23.725+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T07:14:23.761+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 29.509 seconds
[2024-11-21T07:14:53.967+0000] {processor.py:161} INFO - Started process (PID=1612) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T07:14:53.969+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T07:14:53.971+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:14:53.971+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T07:14:54.071+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:14:54.070+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T07:14:56.668+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:14:56.668+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 4.192100442000083
[2024-11-21T07:14:56.670+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:14:56.669+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T07:14:56.672+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:14:56.671+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T07:14:56.691+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:14:56.691+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T07:14:56.709+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:14:56.708+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T07:14:56.738+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:14:56.737+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpvhm6ny5j --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T07:15:05.950+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:15:05.949+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpvhm6ny5j --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T07:15:20.698+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:15:20.670+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 203, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpvhm6ny5j', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
07:15:11  Running with dbt=1.8.7
07:15:15  Registered adapter: bigquery=1.8.3
07:15:17  [WARNING]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
07:15:17  Encountered an error:
Compilation Error
  dbt found two data_tests with the name "unique_fct_trips_trip_id" defined on column "trip_id" in "models.fct_trips".
  
  Since these resources have the same name, dbt will be unable to find the correct resource
  when running tests.
  
  To fix this, change the name of one of these resources:
  - test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab (models/tests/schema.yml)
  - test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab (models/tests/schema.yml)
[2024-11-21T07:15:20.701+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T07:15:20.737+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 28.410 seconds
[2024-11-21T07:15:50.870+0000] {processor.py:161} INFO - Started process (PID=1648) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T07:15:50.872+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T07:15:50.874+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:15:50.874+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T07:15:50.983+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:15:50.982+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T07:15:53.531+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:15:53.531+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 4.229547218999869
[2024-11-21T07:15:53.533+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:15:53.533+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T07:15:53.535+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:15:53.534+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T07:15:53.555+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:15:53.555+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T07:15:53.573+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:15:53.573+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T07:15:53.603+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:15:53.603+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp7gtsyyaz --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T07:16:02.900+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:16:02.899+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp7gtsyyaz --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T07:16:18.657+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:16:18.643+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 203, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmp7gtsyyaz', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
07:16:09  Running with dbt=1.8.7
07:16:13  Registered adapter: bigquery=1.8.3
07:16:15  [WARNING]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
07:16:15  Encountered an error:
Compilation Error
  dbt found two data_tests with the name "unique_fct_trips_trip_id" defined on column "trip_id" in "models.fct_trips".
  
  Since these resources have the same name, dbt will be unable to find the correct resource
  when running tests.
  
  To fix this, change the name of one of these resources:
  - test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab (models/tests/schema.yml)
  - test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab (models/tests/schema.yml)
[2024-11-21T07:16:18.659+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T07:16:18.694+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 29.549 seconds
[2024-11-21T07:16:49.007+0000] {processor.py:161} INFO - Started process (PID=1684) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T07:16:49.009+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T07:16:49.011+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:16:49.010+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T07:16:49.139+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:16:49.139+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T07:16:51.959+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:16:51.958+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 4.398602569000104
[2024-11-21T07:16:51.960+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:16:51.959+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T07:16:51.961+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:16:51.961+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T07:16:51.980+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:16:51.980+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T07:16:52.001+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:16:52.001+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T07:16:52.030+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:16:52.030+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpwm26me3q --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T07:17:01.871+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:17:01.870+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpwm26me3q --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T07:17:17.188+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:17:17.177+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 203, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpwm26me3q', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
07:17:07  Running with dbt=1.8.7
07:17:11  Registered adapter: bigquery=1.8.3
07:17:13  [WARNING]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
07:17:14  Encountered an error:
Compilation Error
  dbt found two data_tests with the name "unique_fct_trips_trip_id" defined on column "trip_id" in "models.fct_trips".
  
  Since these resources have the same name, dbt will be unable to find the correct resource
  when running tests.
  
  To fix this, change the name of one of these resources:
  - test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab (models/tests/schema.yml)
  - test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab (models/tests/schema.yml)
[2024-11-21T07:17:17.190+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T07:17:17.220+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 29.835 seconds
[2024-11-21T07:17:47.471+0000] {processor.py:161} INFO - Started process (PID=1720) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T07:17:47.474+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T07:17:47.477+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:17:47.476+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T07:17:47.590+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:17:47.590+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T07:17:50.365+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:17:50.365+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 4.396261693999804
[2024-11-21T07:17:50.366+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:17:50.366+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T07:17:50.368+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:17:50.367+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T07:17:50.386+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:17:50.386+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T07:17:50.402+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:17:50.402+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T07:17:50.431+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:17:50.430+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpjk0h05js --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T07:17:59.981+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:17:59.980+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpjk0h05js --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T07:18:15.578+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:18:15.564+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 203, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpjk0h05js', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
07:18:06  Running with dbt=1.8.7
07:18:10  Registered adapter: bigquery=1.8.3
07:18:12  [WARNING]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
07:18:12  Encountered an error:
Compilation Error
  dbt found two data_tests with the name "unique_fct_trips_trip_id" defined on column "trip_id" in "models.fct_trips".
  
  Since these resources have the same name, dbt will be unable to find the correct resource
  when running tests.
  
  To fix this, change the name of one of these resources:
  - test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab (models/tests/schema.yml)
  - test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab (models/tests/schema.yml)
[2024-11-21T07:18:15.581+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T07:18:15.606+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 29.802 seconds
[2024-11-21T07:18:45.907+0000] {processor.py:161} INFO - Started process (PID=1756) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T07:18:45.910+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T07:18:45.912+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:18:45.911+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T07:18:46.027+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:18:46.027+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T07:18:50.374+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:18:50.373+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 4.315262418000202
[2024-11-21T07:18:50.375+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:18:50.375+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T07:18:50.376+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:18:50.376+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T07:18:50.396+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:18:50.396+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T07:18:50.414+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:18:50.414+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T07:18:50.441+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:18:50.441+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmptkh1_f2k --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T07:19:00.096+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:19:00.095+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmptkh1_f2k --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T07:19:13.427+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:19:13.414+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 203, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmptkh1_f2k', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
07:19:05  Running with dbt=1.8.7
07:19:09  Registered adapter: bigquery=1.8.3
07:19:11  [WARNING]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
07:19:12  Encountered an error:
Compilation Error
  dbt found two data_tests with the name "unique_fct_trips_trip_id" defined on column "trip_id" in "models.fct_trips".
  
  Since these resources have the same name, dbt will be unable to find the correct resource
  when running tests.
  
  To fix this, change the name of one of these resources:
  - test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab (models/tests/schema.yml)
  - test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab (models/tests/schema.yml)
[2024-11-21T07:19:13.428+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T07:19:13.458+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 29.171 seconds
[2024-11-21T07:19:43.674+0000] {processor.py:161} INFO - Started process (PID=1808) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T07:19:43.676+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T07:19:43.679+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:19:43.678+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T07:19:43.785+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:19:43.784+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T07:19:47.797+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:19:47.796+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 3.9773725220002234
[2024-11-21T07:19:47.798+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:19:47.798+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T07:19:47.799+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:19:47.799+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T07:19:47.817+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:19:47.817+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T07:19:47.833+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:19:47.832+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T07:19:47.855+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:19:47.854+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpejrdhhle --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T07:19:57.989+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:19:57.988+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpejrdhhle --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T07:20:11.704+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:20:11.691+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 203, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpejrdhhle', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
07:20:04  Running with dbt=1.8.7
07:20:07  Registered adapter: bigquery=1.8.3
07:20:09  [WARNING]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
07:20:09  Encountered an error:
Compilation Error
  dbt found two data_tests with the name "unique_fct_trips_trip_id" defined on column "trip_id" in "models.fct_trips".
  
  Since these resources have the same name, dbt will be unable to find the correct resource
  when running tests.
  
  To fix this, change the name of one of these resources:
  - test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab (models/tests/schema.yml)
  - test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab (models/tests/schema.yml)
[2024-11-21T07:20:11.706+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T07:20:11.740+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 29.738 seconds
[2024-11-21T07:20:41.959+0000] {processor.py:161} INFO - Started process (PID=1860) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T07:20:41.961+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T07:20:41.964+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:20:41.963+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T07:20:42.078+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:20:42.078+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T07:20:46.475+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:20:46.474+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 4.3654179859995565
[2024-11-21T07:20:46.476+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:20:46.476+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T07:20:46.478+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:20:46.477+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T07:20:46.498+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:20:46.497+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T07:20:46.516+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:20:46.515+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T07:20:46.545+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:20:46.544+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpj1uloav7 --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T07:20:57.129+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:20:57.128+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpj1uloav7 --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T07:21:10.339+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:21:10.337+0000] {timeout.py:68} ERROR - Process timed out, PID: 1860
[2024-11-21T07:21:40.671+0000] {processor.py:161} INFO - Started process (PID=1911) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T07:21:40.673+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T07:21:40.676+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:21:40.675+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T07:21:40.778+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:21:40.777+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T07:21:44.698+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:21:44.696+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 3.883544308000637
[2024-11-21T07:21:44.699+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:21:44.699+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T07:21:44.701+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:21:44.700+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T07:21:44.721+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:21:44.720+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T07:21:44.741+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:21:44.740+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T07:21:44.767+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:21:44.766+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp6w8ztoep --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T07:21:55.144+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:21:55.142+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp6w8ztoep --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T07:22:08.364+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:22:08.351+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 203, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmp6w8ztoep', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
07:22:00  Running with dbt=1.8.7
07:22:02  Registered adapter: bigquery=1.8.3
07:22:05  [WARNING]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
07:22:05  Encountered an error:
Compilation Error
  dbt found two data_tests with the name "unique_fct_trips_trip_id" defined on column "trip_id" in "models.fct_trips".
  
  Since these resources have the same name, dbt will be unable to find the correct resource
  when running tests.
  
  To fix this, change the name of one of these resources:
  - test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab (models/tests/schema.yml)
  - test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab (models/tests/schema.yml)
[2024-11-21T07:22:08.366+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T07:22:08.400+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 29.335 seconds
[2024-11-21T07:22:38.678+0000] {processor.py:161} INFO - Started process (PID=1963) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T07:22:38.681+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T07:22:38.683+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:22:38.683+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T07:22:38.789+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:22:38.788+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T07:22:43.210+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:22:43.209+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 4.3852247810000335
[2024-11-21T07:22:43.211+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:22:43.210+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T07:22:43.212+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:22:43.212+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T07:22:43.231+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:22:43.231+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T07:22:43.248+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:22:43.247+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T07:22:43.274+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:22:43.274+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpdd_b2dex --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T07:22:52.898+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:22:52.897+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpdd_b2dex --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T07:23:06.668+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:23:06.655+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 203, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpdd_b2dex', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
07:22:58  Running with dbt=1.8.7
07:23:00  Registered adapter: bigquery=1.8.3
07:23:03  [WARNING]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
07:23:03  Encountered an error:
Compilation Error
  dbt found two data_tests with the name "unique_fct_trips_trip_id" defined on column "trip_id" in "models.fct_trips".
  
  Since these resources have the same name, dbt will be unable to find the correct resource
  when running tests.
  
  To fix this, change the name of one of these resources:
  - test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab (models/tests/schema.yml)
  - test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab (models/tests/schema.yml)
[2024-11-21T07:23:06.670+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T07:23:06.694+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 29.664 seconds
[2024-11-21T07:23:36.934+0000] {processor.py:161} INFO - Started process (PID=2015) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T07:23:36.936+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T07:23:36.940+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:23:36.939+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T07:23:37.045+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:23:37.044+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T07:23:40.799+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:23:40.798+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 3.719250318000377
[2024-11-21T07:23:40.800+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:23:40.799+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T07:23:40.801+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:23:40.801+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T07:23:40.817+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:23:40.817+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T07:23:40.843+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:23:40.843+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T07:23:40.863+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:23:40.862+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpx4613bk9 --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T07:23:51.347+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:23:51.345+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpx4613bk9 --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T07:24:05.670+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:24:05.640+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 203, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpx4613bk9', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
07:23:56  Running with dbt=1.8.7
07:24:00  Registered adapter: bigquery=1.8.3
07:24:02  [WARNING]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
07:24:02  Encountered an error:
Compilation Error
  dbt found two data_tests with the name "unique_fct_trips_trip_id" defined on column "trip_id" in "models.fct_trips".
  
  Since these resources have the same name, dbt will be unable to find the correct resource
  when running tests.
  
  To fix this, change the name of one of these resources:
  - test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab (models/tests/schema.yml)
  - test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab (models/tests/schema.yml)
[2024-11-21T07:24:05.674+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T07:24:05.756+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 29.507 seconds
[2024-11-21T07:24:35.925+0000] {processor.py:161} INFO - Started process (PID=2068) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T07:24:35.928+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T07:24:35.931+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:24:35.931+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T07:24:36.047+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:24:36.046+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T07:24:40.412+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:24:40.411+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 4.328563836000285
[2024-11-21T07:24:40.413+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:24:40.412+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T07:24:40.414+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:24:40.414+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T07:24:40.432+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:24:40.431+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T07:24:40.447+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:24:40.447+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T07:24:40.475+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:24:40.475+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp_8521u5z --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T07:24:50.145+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:24:50.144+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp_8521u5z --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T07:25:04.316+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:25:04.314+0000] {timeout.py:68} ERROR - Process timed out, PID: 2068
[2024-11-21T07:25:34.981+0000] {processor.py:161} INFO - Started process (PID=2120) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T07:25:34.983+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T07:25:34.986+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:25:34.985+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T07:25:35.095+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:25:35.095+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T07:25:38.817+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:25:38.817+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 3.686783776000084
[2024-11-21T07:25:38.819+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:25:38.818+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T07:25:38.820+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:25:38.820+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T07:25:38.839+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:25:38.839+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T07:25:38.856+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:25:38.856+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T07:25:38.884+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:25:38.883+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpq0dqiqwa --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T07:25:48.310+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:25:48.309+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpq0dqiqwa --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T07:26:01.727+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:26:01.714+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 203, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpq0dqiqwa', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
07:25:52  Running with dbt=1.8.7
07:25:56  Registered adapter: bigquery=1.8.3
07:25:58  [WARNING]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
07:25:58  Encountered an error:
Compilation Error
  dbt found two data_tests with the name "unique_fct_trips_trip_id" defined on column "trip_id" in "models.fct_trips".
  
  Since these resources have the same name, dbt will be unable to find the correct resource
  when running tests.
  
  To fix this, change the name of one of these resources:
  - test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab (models/tests/schema.yml)
  - test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab (models/tests/schema.yml)
[2024-11-21T07:26:01.729+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T07:26:01.763+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 28.491 seconds
[2024-11-21T07:26:32.735+0000] {processor.py:161} INFO - Started process (PID=2172) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T07:26:32.737+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T07:26:32.739+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:26:32.738+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T07:26:32.851+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:26:32.850+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T07:26:37.351+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:26:37.350+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 4.465716598999279
[2024-11-21T07:26:37.352+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:26:37.352+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T07:26:37.354+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:26:37.353+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T07:26:37.371+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:26:37.370+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T07:26:37.394+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:26:37.393+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T07:26:37.423+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:26:37.423+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmprf0w0ahh --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T07:26:45.717+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:26:45.716+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmprf0w0ahh --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T07:27:01.296+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:27:01.294+0000] {timeout.py:68} ERROR - Process timed out, PID: 2172
[2024-11-21T07:27:32.167+0000] {processor.py:161} INFO - Started process (PID=2224) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T07:27:32.169+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T07:27:32.171+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:27:32.171+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T07:27:32.282+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:27:32.281+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T07:27:36.665+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:27:36.664+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 4.348835912999675
[2024-11-21T07:27:36.666+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:27:36.666+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T07:27:36.673+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:27:36.672+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T07:27:36.692+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:27:36.691+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T07:27:36.707+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:27:36.706+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T07:27:36.737+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:27:36.736+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpzloigrcm --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T07:27:45.297+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:27:45.296+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpzloigrcm --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T07:28:00.514+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:28:00.514+0000] {timeout.py:68} ERROR - Process timed out, PID: 2224
[2024-11-21T07:28:30.715+0000] {processor.py:161} INFO - Started process (PID=2276) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T07:28:30.720+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T07:28:30.727+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:28:30.725+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T07:28:30.852+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:28:30.851+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T07:28:34.870+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:28:34.869+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 3.985198907999802
[2024-11-21T07:28:34.871+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:28:34.871+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T07:28:34.873+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:28:34.872+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T07:28:34.892+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:28:34.892+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T07:28:34.908+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:28:34.907+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T07:28:34.936+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:28:34.935+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpa6hdopg1 --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T07:28:43.479+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:28:43.478+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpa6hdopg1 --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T07:28:59.085+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:28:59.083+0000] {timeout.py:68} ERROR - Process timed out, PID: 2276
[2024-11-21T07:29:29.392+0000] {processor.py:161} INFO - Started process (PID=2328) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T07:29:29.394+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T07:29:29.396+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:29:29.395+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T07:29:29.508+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:29:29.507+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T07:29:33.973+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:29:33.972+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 4.434065494000606
[2024-11-21T07:29:33.975+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:29:33.974+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T07:29:33.976+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:29:33.976+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T07:29:33.995+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:29:33.995+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T07:29:34.013+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:29:34.013+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T07:29:34.040+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:29:34.039+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpj7kktc0p --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T07:29:41.460+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:29:41.459+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpj7kktc0p --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T07:29:56.708+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:29:56.695+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 203, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpj7kktc0p', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
07:29:47  Running with dbt=1.8.7
07:29:51  Registered adapter: bigquery=1.8.3
07:29:53  [WARNING]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
07:29:54  Encountered an error:
Compilation Error
  dbt found two data_tests with the name "unique_fct_trips_trip_id" defined on column "trip_id" in "models.fct_trips".
  
  Since these resources have the same name, dbt will be unable to find the correct resource
  when running tests.
  
  To fix this, change the name of one of these resources:
  - test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab (models/tests/schema.yml)
  - test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab (models/tests/schema.yml)
[2024-11-21T07:29:56.710+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T07:29:56.735+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 29.075 seconds
[2024-11-21T07:30:27.026+0000] {processor.py:161} INFO - Started process (PID=2380) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T07:30:27.029+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T07:30:27.032+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:30:27.031+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T07:30:27.153+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:30:27.152+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T07:30:31.559+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:30:31.558+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 4.368185022999569
[2024-11-21T07:30:31.560+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:30:31.560+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T07:30:31.561+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:30:31.561+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T07:30:31.576+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:30:31.575+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T07:30:31.593+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:30:31.593+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T07:30:31.618+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:30:31.618+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpua88x1kv --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T07:30:39.834+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:30:39.833+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpua88x1kv --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T07:30:55.212+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:30:55.197+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 203, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpua88x1kv', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
07:30:46  Running with dbt=1.8.7
07:30:49  Registered adapter: bigquery=1.8.3
07:30:52  [WARNING]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
07:30:52  Encountered an error:
Compilation Error
  dbt found two data_tests with the name "unique_fct_trips_trip_id" defined on column "trip_id" in "models.fct_trips".
  
  Since these resources have the same name, dbt will be unable to find the correct resource
  when running tests.
  
  To fix this, change the name of one of these resources:
  - test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab (models/tests/schema.yml)
  - test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab (models/tests/schema.yml)
[2024-11-21T07:30:55.222+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T07:30:55.249+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 29.951 seconds
[2024-11-21T07:31:25.396+0000] {processor.py:161} INFO - Started process (PID=2438) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T07:31:25.399+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T07:31:25.401+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:31:25.400+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T07:31:25.516+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:31:25.516+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T07:31:29.284+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:31:29.284+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 4.400056870000299
[2024-11-21T07:31:29.286+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:31:29.285+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T07:31:29.287+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:31:29.287+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T07:31:29.305+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:31:29.305+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T07:31:28.295+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:31:28.294+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T07:31:28.320+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:31:28.320+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpc3lsrlgb --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T07:31:37.626+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:31:37.625+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpc3lsrlgb --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T07:31:52.922+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:31:52.909+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 203, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpc3lsrlgb', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
07:31:43  Running with dbt=1.8.7
07:31:47  Registered adapter: bigquery=1.8.3
07:31:49  [WARNING]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
07:31:50  Encountered an error:
Compilation Error
  dbt found two data_tests with the name "unique_fct_trips_trip_id" defined on column "trip_id" in "models.fct_trips".
  
  Since these resources have the same name, dbt will be unable to find the correct resource
  when running tests.
  
  To fix this, change the name of one of these resources:
  - test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab (models/tests/schema.yml)
  - test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab (models/tests/schema.yml)
[2024-11-21T07:31:52.927+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T07:31:52.978+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 29.290 seconds
[2024-11-21T07:32:23.687+0000] {processor.py:161} INFO - Started process (PID=2489) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T07:32:23.689+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T07:32:23.692+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:32:23.691+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T07:32:23.806+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:32:23.806+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T07:32:26.121+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:32:26.120+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 3.9649254799996925
[2024-11-21T07:32:26.122+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:32:26.122+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T07:32:26.123+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:32:26.123+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T07:32:26.140+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:32:26.139+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T07:32:26.163+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:32:26.162+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T07:32:26.189+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:32:26.188+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp263yioyx --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T07:32:36.076+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:32:36.075+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp263yioyx --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T07:32:52.070+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:32:52.069+0000] {timeout.py:68} ERROR - Process timed out, PID: 2489
[2024-11-21T07:33:22.396+0000] {processor.py:161} INFO - Started process (PID=2541) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T07:33:22.399+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T07:33:22.401+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:33:22.401+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T07:33:22.512+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:33:22.511+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T07:33:25.113+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:33:25.113+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 4.268953724000312
[2024-11-21T07:33:25.115+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:33:25.114+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T07:33:25.116+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:33:25.116+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T07:33:25.135+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:33:25.135+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T07:33:25.153+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:33:25.152+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T07:33:25.179+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:33:25.178+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpq1oscks8 --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T07:33:34.213+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:33:34.212+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpq1oscks8 --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T07:33:49.254+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:33:49.242+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 203, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpq1oscks8', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
07:33:39  Running with dbt=1.8.7
07:33:43  Registered adapter: bigquery=1.8.3
07:33:46  [WARNING]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
07:33:46  Encountered an error:
Compilation Error
  dbt found two data_tests with the name "unique_fct_trips_trip_id" defined on column "trip_id" in "models.fct_trips".
  
  Since these resources have the same name, dbt will be unable to find the correct resource
  when running tests.
  
  To fix this, change the name of one of these resources:
  - test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab (models/tests/schema.yml)
  - test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab (models/tests/schema.yml)
[2024-11-21T07:33:49.257+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T07:33:49.287+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 28.607 seconds
[2024-11-21T07:34:19.452+0000] {processor.py:161} INFO - Started process (PID=2593) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T07:34:19.455+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T07:34:19.458+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:34:19.457+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T07:34:18.896+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:34:18.896+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T07:34:21.738+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:34:21.737+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 3.8152759340000557
[2024-11-21T07:34:21.739+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:34:21.739+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T07:34:21.741+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:34:21.740+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T07:34:21.759+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:34:21.759+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T07:34:21.776+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:34:21.775+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T07:34:21.802+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:34:21.802+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpibof3htm --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T07:34:31.602+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:34:31.600+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpibof3htm --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T07:34:46.448+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:34:46.433+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 203, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpibof3htm', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
07:34:37  Running with dbt=1.8.7
07:34:40  Registered adapter: bigquery=1.8.3
07:34:43  [WARNING]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
07:34:43  Encountered an error:
Compilation Error
  dbt found two data_tests with the name "unique_fct_trips_trip_id" defined on column "trip_id" in "models.fct_trips".
  
  Since these resources have the same name, dbt will be unable to find the correct resource
  when running tests.
  
  To fix this, change the name of one of these resources:
  - test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab (models/tests/schema.yml)
  - test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab (models/tests/schema.yml)
[2024-11-21T07:34:46.450+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T07:34:46.488+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 28.736 seconds
[2024-11-21T07:35:16.762+0000] {processor.py:161} INFO - Started process (PID=2645) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T07:35:16.764+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T07:35:16.766+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:35:16.766+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T07:35:16.878+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:35:16.877+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T07:35:21.285+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:35:21.285+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 4.377195380999183
[2024-11-21T07:35:21.287+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:35:21.286+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T07:35:21.288+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:35:21.287+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T07:35:21.300+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:35:21.300+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T07:35:21.316+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:35:21.316+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T07:35:21.342+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:35:21.341+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpboazq1rc --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T07:35:30.639+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:35:30.638+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpboazq1rc --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T07:35:45.094+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:35:45.091+0000] {timeout.py:68} ERROR - Process timed out, PID: 2645
[2024-11-21T07:36:15.354+0000] {processor.py:161} INFO - Started process (PID=2697) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T07:36:15.357+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T07:36:15.360+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:36:15.359+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T07:36:15.462+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:36:15.462+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T07:36:19.330+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:36:19.329+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 3.8275010560000737
[2024-11-21T07:36:19.332+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:36:19.331+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T07:36:19.333+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:36:19.333+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T07:36:19.351+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:36:19.350+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T07:36:19.374+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:36:19.373+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T07:36:19.400+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:36:19.399+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpkgobsqmx --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T07:36:28.974+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:36:28.973+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpkgobsqmx --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T07:36:43.443+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:36:43.429+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 203, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpkgobsqmx', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
07:36:35  Running with dbt=1.8.7
07:36:39  Registered adapter: bigquery=1.8.3
07:36:40  [WARNING]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
07:36:40  Encountered an error:
Compilation Error
  dbt found two data_tests with the name "unique_fct_trips_trip_id" defined on column "trip_id" in "models.fct_trips".
  
  Since these resources have the same name, dbt will be unable to find the correct resource
  when running tests.
  
  To fix this, change the name of one of these resources:
  - test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab (models/tests/schema.yml)
  - test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab (models/tests/schema.yml)
[2024-11-21T07:36:43.445+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T07:36:43.479+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 29.869 seconds
[2024-11-21T07:37:13.731+0000] {processor.py:161} INFO - Started process (PID=2750) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T07:37:13.733+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T07:37:13.736+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:37:13.735+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T07:37:13.846+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:37:13.845+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T07:37:18.171+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:37:18.170+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 4.2934520440003325
[2024-11-21T07:37:18.172+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:37:18.172+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T07:37:18.174+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:37:18.174+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T07:37:18.193+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:37:18.192+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T07:37:18.210+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:37:18.209+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T07:37:18.235+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:37:18.235+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpqza5kol_ --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T07:37:27.204+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:37:27.203+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpqza5kol_ --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T07:37:41.720+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:37:41.707+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 203, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpqza5kol_', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
07:37:33  Running with dbt=1.8.7
07:37:36  Registered adapter: bigquery=1.8.3
07:37:38  [WARNING]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
07:37:38  Encountered an error:
Compilation Error
  dbt found two data_tests with the name "unique_fct_trips_trip_id" defined on column "trip_id" in "models.fct_trips".
  
  Since these resources have the same name, dbt will be unable to find the correct resource
  when running tests.
  
  To fix this, change the name of one of these resources:
  - test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab (models/tests/schema.yml)
  - test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab (models/tests/schema.yml)
[2024-11-21T07:37:41.722+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T07:37:41.752+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 29.747 seconds
[2024-11-21T07:38:12.639+0000] {processor.py:161} INFO - Started process (PID=2802) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T07:38:12.644+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T07:38:12.647+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:38:12.646+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T07:38:12.759+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:38:12.758+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T07:38:17.119+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:38:17.119+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 4.309068528000353
[2024-11-21T07:38:17.120+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:38:17.120+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T07:38:17.122+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:38:17.121+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T07:38:17.141+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:38:17.141+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T07:38:17.158+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:38:17.157+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T07:38:17.186+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:38:17.185+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpca3hzqr7 --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T07:38:26.994+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:38:26.992+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpca3hzqr7 --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T07:38:40.501+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:38:40.487+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 203, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpca3hzqr7', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
07:38:32  Running with dbt=1.8.7
07:38:34  Registered adapter: bigquery=1.8.3
07:38:37  [WARNING]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
07:38:37  Encountered an error:
Compilation Error
  dbt found two data_tests with the name "unique_fct_trips_trip_id" defined on column "trip_id" in "models.fct_trips".
  
  Since these resources have the same name, dbt will be unable to find the correct resource
  when running tests.
  
  To fix this, change the name of one of these resources:
  - test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab (models/tests/schema.yml)
  - test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab (models/tests/schema.yml)
[2024-11-21T07:38:40.503+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T07:38:40.535+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 29.644 seconds
[2024-11-21T07:39:11.376+0000] {processor.py:161} INFO - Started process (PID=2854) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T07:39:11.379+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T07:39:11.382+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:39:11.381+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T07:39:11.483+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:39:11.483+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T07:39:15.867+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:39:15.866+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 4.351439594000112
[2024-11-21T07:39:15.868+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:39:15.868+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T07:39:15.870+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:39:15.869+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T07:39:15.886+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:39:15.885+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T07:39:15.904+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:39:15.903+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T07:39:15.929+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:39:15.929+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpcko93kaf --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T07:39:25.666+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:39:25.664+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpcko93kaf --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T07:39:38.974+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:39:38.961+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 203, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpcko93kaf', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
07:39:30  Running with dbt=1.8.7
07:39:33  Registered adapter: bigquery=1.8.3
07:39:35  [WARNING]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
07:39:36  Encountered an error:
Compilation Error
  dbt found two data_tests with the name "unique_fct_trips_trip_id" defined on column "trip_id" in "models.fct_trips".
  
  Since these resources have the same name, dbt will be unable to find the correct resource
  when running tests.
  
  To fix this, change the name of one of these resources:
  - test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab (models/tests/schema.yml)
  - test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab (models/tests/schema.yml)
[2024-11-21T07:39:38.976+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T07:39:39.018+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 29.441 seconds
[2024-11-21T07:40:09.366+0000] {processor.py:161} INFO - Started process (PID=2906) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T07:40:09.369+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T07:40:09.371+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:40:09.371+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T07:40:09.485+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:40:09.484+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T07:40:13.981+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:40:13.980+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 4.463894571999845
[2024-11-21T07:40:13.983+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:40:13.982+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T07:40:13.984+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:40:13.984+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T07:40:14.004+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:40:14.004+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T07:40:14.021+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:40:14.020+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T07:40:14.048+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:40:14.047+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpi8n4utug --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T07:40:23.365+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:40:23.363+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpi8n4utug --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T07:40:36.422+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:40:36.407+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 203, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpi8n4utug', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
07:40:27  Running with dbt=1.8.7
07:40:31  Registered adapter: bigquery=1.8.3
07:40:33  [WARNING]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
07:40:33  Encountered an error:
Compilation Error
  dbt found two data_tests with the name "unique_fct_trips_trip_id" defined on column "trip_id" in "models.fct_trips".
  
  Since these resources have the same name, dbt will be unable to find the correct resource
  when running tests.
  
  To fix this, change the name of one of these resources:
  - test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab (models/tests/schema.yml)
  - test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab (models/tests/schema.yml)
[2024-11-21T07:40:36.425+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T07:40:36.463+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 28.893 seconds
[2024-11-21T07:41:06.597+0000] {processor.py:161} INFO - Started process (PID=2957) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T07:41:06.601+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T07:41:06.605+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:41:06.604+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T07:41:06.701+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:41:06.700+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T07:41:10.945+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:41:10.944+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 4.213878214000033
[2024-11-21T07:41:10.946+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:41:10.946+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T07:41:10.948+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:41:10.947+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T07:41:10.968+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:41:10.967+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T07:41:10.984+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:41:10.983+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T07:41:11.011+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:41:11.011+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpm0sl078f --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T07:41:20.765+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:41:20.764+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpm0sl078f --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T07:41:34.868+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:41:34.867+0000] {timeout.py:68} ERROR - Process timed out, PID: 2957
[2024-11-21T07:42:05.034+0000] {processor.py:161} INFO - Started process (PID=3009) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T07:42:05.037+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T07:42:05.040+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:42:05.039+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T07:42:05.139+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:42:05.139+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T07:42:09.474+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:42:09.473+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 4.303740784999718
[2024-11-21T07:42:09.475+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:42:09.475+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T07:42:09.477+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:42:09.476+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T07:42:09.496+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:42:09.496+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T07:42:09.512+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:42:09.512+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T07:42:09.539+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:42:09.538+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpuvfefpdb --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T07:42:18.787+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:42:18.786+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpuvfefpdb --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T07:42:31.623+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:42:31.612+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 203, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpuvfefpdb', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
07:42:22  Running with dbt=1.8.7
07:42:26  Registered adapter: bigquery=1.8.3
07:42:28  [WARNING]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
07:42:29  Encountered an error:
Compilation Error
  dbt found two data_tests with the name "unique_fct_trips_trip_id" defined on column "trip_id" in "models.fct_trips".
  
  Since these resources have the same name, dbt will be unable to find the correct resource
  when running tests.
  
  To fix this, change the name of one of these resources:
  - test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab (models/tests/schema.yml)
  - test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab (models/tests/schema.yml)
[2024-11-21T07:42:31.625+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T07:42:31.654+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 28.373 seconds
[2024-11-21T07:43:01.781+0000] {processor.py:161} INFO - Started process (PID=3061) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T07:43:01.783+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T07:43:01.785+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:43:01.785+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T07:43:01.906+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:43:01.905+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T07:43:06.034+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:43:06.033+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 4.090372392000063
[2024-11-21T07:43:06.035+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:43:06.035+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T07:43:06.036+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:43:06.036+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T07:43:06.052+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:43:06.052+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T07:43:06.068+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:43:06.067+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T07:43:06.095+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:43:06.095+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp1r9yzu9u --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T07:43:16.044+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:43:16.043+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp1r9yzu9u --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T07:43:30.035+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:43:30.033+0000] {timeout.py:68} ERROR - Process timed out, PID: 3061
[2024-11-21T07:44:00.253+0000] {processor.py:161} INFO - Started process (PID=3113) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T07:44:00.255+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T07:44:00.258+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:44:00.257+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T07:44:00.360+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:44:00.359+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T07:44:04.715+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:44:04.715+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 4.3213734509999995
[2024-11-21T07:44:04.717+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:44:04.716+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T07:44:04.718+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:44:04.718+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T07:44:04.737+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:44:04.737+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T07:44:04.753+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:44:04.753+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T07:44:04.781+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:44:04.781+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp874kfukz --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T07:44:12.128+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:44:12.127+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp874kfukz --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T07:44:26.755+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:44:26.745+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 203, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmp874kfukz', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
07:44:17  Running with dbt=1.8.7
07:44:21  Registered adapter: bigquery=1.8.3
07:44:23  [WARNING]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
07:44:24  Encountered an error:
Compilation Error
  dbt found two data_tests with the name "unique_fct_trips_trip_id" defined on column "trip_id" in "models.fct_trips".
  
  Since these resources have the same name, dbt will be unable to find the correct resource
  when running tests.
  
  To fix this, change the name of one of these resources:
  - test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab (models/tests/schema.yml)
  - test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab (models/tests/schema.yml)
[2024-11-21T07:44:26.757+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T07:44:26.785+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 28.249 seconds
[2024-11-21T07:44:57.604+0000] {processor.py:161} INFO - Started process (PID=3165) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T07:44:57.607+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T07:44:57.609+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:44:57.609+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T07:44:57.714+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:44:57.713+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T07:45:01.877+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:45:01.877+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 4.1327264609999474
[2024-11-21T07:45:01.879+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:45:01.878+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T07:45:01.880+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:45:01.880+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T07:45:01.893+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:45:01.893+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T07:45:01.908+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:45:01.907+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T07:45:01.925+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:45:01.925+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmprl0d1iin --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T07:45:10.190+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:45:10.189+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmprl0d1iin --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T07:45:24.874+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:45:24.860+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 203, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmprl0d1iin', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
07:45:15  Running with dbt=1.8.7
07:45:19  Registered adapter: bigquery=1.8.3
07:45:21  [WARNING]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
07:45:22  Encountered an error:
Compilation Error
  dbt found two data_tests with the name "unique_fct_trips_trip_id" defined on column "trip_id" in "models.fct_trips".
  
  Since these resources have the same name, dbt will be unable to find the correct resource
  when running tests.
  
  To fix this, change the name of one of these resources:
  - test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab (models/tests/schema.yml)
  - test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab (models/tests/schema.yml)
[2024-11-21T07:45:24.876+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T07:45:24.901+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 29.001 seconds
[2024-11-21T07:45:55.764+0000] {processor.py:161} INFO - Started process (PID=3217) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T07:45:55.766+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T07:45:55.769+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:45:55.768+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T07:45:55.888+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:45:55.887+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T07:46:00.320+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:46:00.319+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 4.3985822510003345
[2024-11-21T07:46:00.321+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:46:00.321+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T07:46:00.323+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:46:00.322+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T07:46:00.342+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:46:00.342+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T07:46:00.359+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:46:00.358+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T07:46:00.387+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:46:00.386+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpgh77hcio --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T07:46:07.732+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:46:07.731+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpgh77hcio --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T07:46:22.978+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:46:22.962+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 203, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpgh77hcio', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
07:46:13  Running with dbt=1.8.7
07:46:17  Registered adapter: bigquery=1.8.3
07:46:19  [WARNING]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
07:46:20  Encountered an error:
Compilation Error
  dbt found two data_tests with the name "unique_fct_trips_trip_id" defined on column "trip_id" in "models.fct_trips".
  
  Since these resources have the same name, dbt will be unable to find the correct resource
  when running tests.
  
  To fix this, change the name of one of these resources:
  - test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab (models/tests/schema.yml)
  - test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab (models/tests/schema.yml)
[2024-11-21T07:46:22.981+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T07:46:23.018+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 28.994 seconds
[2024-11-21T07:46:53.143+0000] {processor.py:161} INFO - Started process (PID=3269) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T07:46:53.145+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T07:46:53.148+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:46:53.147+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T07:46:53.249+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:46:53.249+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T07:46:57.176+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:46:57.176+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 3.896504919999643
[2024-11-21T07:46:57.177+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:46:57.177+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T07:46:57.179+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:46:57.179+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T07:46:57.198+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:46:57.198+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T07:46:57.217+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:46:57.216+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T07:46:57.244+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:46:57.244+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpg7qw9_lq --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T07:47:05.394+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:47:05.393+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpg7qw9_lq --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T07:47:20.204+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:47:20.192+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 203, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpg7qw9_lq', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
07:47:10  Running with dbt=1.8.7
07:47:14  Registered adapter: bigquery=1.8.3
07:47:16  [WARNING]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
07:47:17  Encountered an error:
Compilation Error
  dbt found two data_tests with the name "unique_fct_trips_trip_id" defined on column "trip_id" in "models.fct_trips".
  
  Since these resources have the same name, dbt will be unable to find the correct resource
  when running tests.
  
  To fix this, change the name of one of these resources:
  - test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab (models/tests/schema.yml)
  - test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab (models/tests/schema.yml)
[2024-11-21T07:47:20.206+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T07:47:20.240+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 28.926 seconds
[2024-11-21T07:47:50.373+0000] {processor.py:161} INFO - Started process (PID=3322) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T07:47:50.375+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T07:47:50.379+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:47:50.378+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T07:47:50.503+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:47:50.502+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T07:47:54.889+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:47:54.889+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 4.353141382999638
[2024-11-21T07:47:54.890+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:47:54.890+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T07:47:54.892+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:47:54.891+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T07:47:54.906+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:47:54.906+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T07:47:54.921+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:47:54.921+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T07:47:54.950+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:47:54.950+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp79j8x6jq --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T07:48:02.510+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:48:02.509+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp79j8x6jq --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T07:48:17.760+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:48:17.747+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 203, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmp79j8x6jq', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
07:48:08  Running with dbt=1.8.7
07:48:12  Registered adapter: bigquery=1.8.3
07:48:14  [WARNING]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
07:48:15  Encountered an error:
Compilation Error
  dbt found two data_tests with the name "unique_fct_trips_trip_id" defined on column "trip_id" in "models.fct_trips".
  
  Since these resources have the same name, dbt will be unable to find the correct resource
  when running tests.
  
  To fix this, change the name of one of these resources:
  - test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab (models/tests/schema.yml)
  - test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab (models/tests/schema.yml)
[2024-11-21T07:48:17.762+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T07:48:17.783+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 29.178 seconds
[2024-11-21T07:48:48.013+0000] {processor.py:161} INFO - Started process (PID=3373) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T07:48:48.015+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T07:48:48.018+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:48:48.017+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T07:48:48.126+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:48:48.125+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T07:48:52.080+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:48:52.080+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 3.9206996490001984
[2024-11-21T07:48:52.082+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:48:52.081+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T07:48:52.083+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:48:52.083+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T07:48:52.100+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:48:52.099+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T07:48:52.120+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:48:52.119+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T07:48:52.143+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:48:52.143+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp3vevftap --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T07:49:00.192+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:49:00.190+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp3vevftap --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T07:49:14.818+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:49:14.804+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 203, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmp3vevftap', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
07:49:05  Running with dbt=1.8.7
07:49:09  Registered adapter: bigquery=1.8.3
07:49:11  [WARNING]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
07:49:12  Encountered an error:
Compilation Error
  dbt found two data_tests with the name "unique_fct_trips_trip_id" defined on column "trip_id" in "models.fct_trips".
  
  Since these resources have the same name, dbt will be unable to find the correct resource
  when running tests.
  
  To fix this, change the name of one of these resources:
  - test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab (models/tests/schema.yml)
  - test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab (models/tests/schema.yml)
[2024-11-21T07:49:14.820+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T07:49:14.929+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 28.708 seconds
[2024-11-21T07:49:45.999+0000] {processor.py:161} INFO - Started process (PID=3425) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T07:49:46.001+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T07:49:46.004+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:49:46.003+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T07:49:46.117+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:49:46.116+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T07:49:50.358+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:49:50.357+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 4.209959544999947
[2024-11-21T07:49:50.359+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:49:50.359+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T07:49:50.360+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:49:50.360+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T07:49:50.377+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:49:50.376+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T07:49:50.393+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:49:50.392+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T07:49:50.417+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:49:50.416+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp1d4e0hfg --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T07:49:57.809+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:49:57.808+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp1d4e0hfg --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T07:50:14.239+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:50:14.236+0000] {timeout.py:68} ERROR - Process timed out, PID: 3425
[2024-11-21T07:50:44.454+0000] {processor.py:161} INFO - Started process (PID=3477) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T07:50:44.456+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T07:50:44.458+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:50:44.457+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T07:50:44.557+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:50:44.556+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T07:50:47.859+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:50:47.859+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 3.9698780060007266
[2024-11-21T07:50:47.860+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:50:47.860+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T07:50:47.862+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:50:47.862+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T07:50:47.880+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:50:47.879+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T07:50:47.899+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:50:47.899+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T07:50:47.927+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:50:47.926+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp0jc3vnd3 --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T07:50:55.994+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:50:55.992+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp0jc3vnd3 --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T07:51:10.658+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:51:10.644+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 203, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmp0jc3vnd3', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
07:51:01  Running with dbt=1.8.7
07:51:05  Registered adapter: bigquery=1.8.3
07:51:07  [WARNING]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
07:51:07  Encountered an error:
Compilation Error
  dbt found two data_tests with the name "unique_fct_trips_trip_id" defined on column "trip_id" in "models.fct_trips".
  
  Since these resources have the same name, dbt will be unable to find the correct resource
  when running tests.
  
  To fix this, change the name of one of these resources:
  - test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab (models/tests/schema.yml)
  - test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab (models/tests/schema.yml)
[2024-11-21T07:51:10.661+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T07:51:10.687+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 28.027 seconds
[2024-11-21T07:51:40.863+0000] {processor.py:161} INFO - Started process (PID=3529) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T07:51:40.865+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T07:51:40.868+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:51:40.867+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T07:51:40.984+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:51:40.983+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T07:51:44.613+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:51:44.613+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 4.326100440999653
[2024-11-21T07:51:44.615+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:51:44.614+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T07:51:44.616+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:51:44.616+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T07:51:44.632+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:51:44.632+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T07:51:44.649+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:51:44.649+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T07:51:43.498+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:51:43.497+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp9vlw6zug --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T07:51:52.798+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:51:52.796+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp9vlw6zug --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T07:52:08.994+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:52:08.991+0000] {timeout.py:68} ERROR - Process timed out, PID: 3529
[2024-11-21T07:52:39.173+0000] {processor.py:161} INFO - Started process (PID=3581) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T07:52:39.175+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T07:52:39.177+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:52:39.177+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T07:52:39.273+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:52:39.273+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T07:52:41.400+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:52:41.399+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 3.892734408999786
[2024-11-21T07:52:41.401+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:52:41.401+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T07:52:41.403+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:52:41.402+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T07:52:41.421+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:52:41.420+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T07:52:41.438+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:52:41.437+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T07:52:41.462+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:52:41.462+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp3u0nuqzy --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T07:52:50.374+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:52:50.372+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp3u0nuqzy --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T07:53:05.007+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:53:04.996+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 203, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmp3u0nuqzy', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
07:52:56  Running with dbt=1.8.7
07:52:59  Registered adapter: bigquery=1.8.3
07:53:01  [WARNING]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
07:53:02  Encountered an error:
Compilation Error
  dbt found two data_tests with the name "unique_fct_trips_trip_id" defined on column "trip_id" in "models.fct_trips".
  
  Since these resources have the same name, dbt will be unable to find the correct resource
  when running tests.
  
  To fix this, change the name of one of these resources:
  - test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab (models/tests/schema.yml)
  - test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab (models/tests/schema.yml)
[2024-11-21T07:53:05.009+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T07:53:05.034+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 27.676 seconds
[2024-11-21T07:53:35.161+0000] {processor.py:161} INFO - Started process (PID=3633) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T07:53:35.163+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T07:53:35.166+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:53:35.165+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T07:53:35.263+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:53:35.263+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T07:53:37.553+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:53:37.552+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 4.009646315999817
[2024-11-21T07:53:37.554+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:53:37.554+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T07:53:37.556+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:53:37.555+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T07:53:37.574+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:53:37.574+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T07:53:37.590+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:53:37.589+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T07:53:37.617+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:53:37.617+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmptxldt4th --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T07:53:46.658+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:53:46.657+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmptxldt4th --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T07:54:02.520+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:54:02.502+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 203, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmptxldt4th', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
07:53:53  Running with dbt=1.8.7
07:53:57  Registered adapter: bigquery=1.8.3
07:53:59  [WARNING]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
07:53:59  Encountered an error:
Compilation Error
  dbt found two data_tests with the name "unique_fct_trips_trip_id" defined on column "trip_id" in "models.fct_trips".
  
  Since these resources have the same name, dbt will be unable to find the correct resource
  when running tests.
  
  To fix this, change the name of one of these resources:
  - test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab (models/tests/schema.yml)
  - test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab (models/tests/schema.yml)
[2024-11-21T07:54:02.523+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T07:54:02.568+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 29.174 seconds
[2024-11-21T07:54:32.822+0000] {processor.py:161} INFO - Started process (PID=3691) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T07:54:32.824+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T07:54:32.826+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:54:32.825+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T07:54:32.928+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:54:32.927+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T07:54:35.093+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:54:35.092+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 3.9296849049997036
[2024-11-21T07:54:35.095+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:54:35.094+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T07:54:35.096+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:54:35.096+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T07:54:35.115+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:54:35.115+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T07:54:35.130+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:54:35.130+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T07:54:35.157+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:54:35.157+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpo2nukpgg --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T07:54:44.450+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:54:44.449+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpo2nukpgg --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T07:54:58.958+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:54:58.945+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 203, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpo2nukpgg', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
07:54:50  Running with dbt=1.8.7
07:54:53  Registered adapter: bigquery=1.8.3
07:54:55  [WARNING]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
07:54:56  Encountered an error:
Compilation Error
  dbt found two data_tests with the name "unique_fct_trips_trip_id" defined on column "trip_id" in "models.fct_trips".
  
  Since these resources have the same name, dbt will be unable to find the correct resource
  when running tests.
  
  To fix this, change the name of one of these resources:
  - test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab (models/tests/schema.yml)
  - test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab (models/tests/schema.yml)
[2024-11-21T07:54:58.960+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T07:54:58.992+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 27.978 seconds
[2024-11-21T07:55:29.124+0000] {processor.py:161} INFO - Started process (PID=3743) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T07:55:29.126+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T07:55:29.128+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:55:29.127+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T07:55:29.231+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:55:29.231+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T07:55:31.677+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:55:31.676+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 4.239595191999797
[2024-11-21T07:55:31.678+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:55:31.678+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T07:55:31.679+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:55:31.679+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T07:55:31.696+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:55:31.695+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T07:55:31.712+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:55:31.712+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T07:55:31.740+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:55:31.740+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpe69wb1vy --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T07:55:40.604+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:55:40.603+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpe69wb1vy --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T07:55:56.459+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:55:56.444+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 203, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpe69wb1vy', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
07:55:47  Running with dbt=1.8.7
07:55:51  Registered adapter: bigquery=1.8.3
07:55:53  [WARNING]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
07:55:53  Encountered an error:
Compilation Error
  dbt found two data_tests with the name "unique_fct_trips_trip_id" defined on column "trip_id" in "models.fct_trips".
  
  Since these resources have the same name, dbt will be unable to find the correct resource
  when running tests.
  
  To fix this, change the name of one of these resources:
  - test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab (models/tests/schema.yml)
  - test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab (models/tests/schema.yml)
[2024-11-21T07:55:56.462+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T07:55:56.497+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 29.220 seconds
[2024-11-21T07:56:26.910+0000] {processor.py:161} INFO - Started process (PID=3794) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T07:56:26.912+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T07:56:26.915+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:56:26.914+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T07:56:27.018+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:56:27.017+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T07:56:29.115+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:56:29.115+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 3.8644097269998383
[2024-11-21T07:56:29.117+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:56:29.116+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T07:56:29.118+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:56:29.118+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T07:56:29.137+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:56:29.136+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T07:56:29.161+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:56:29.161+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T07:56:29.188+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:56:29.187+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpa5i__jkm --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T07:56:38.073+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:56:38.072+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpa5i__jkm --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T07:56:52.371+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:56:52.360+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 203, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpa5i__jkm', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
07:56:43  Running with dbt=1.8.7
07:56:47  Registered adapter: bigquery=1.8.3
07:56:49  [WARNING]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
07:56:49  Encountered an error:
Compilation Error
  dbt found two data_tests with the name "unique_fct_trips_trip_id" defined on column "trip_id" in "models.fct_trips".
  
  Since these resources have the same name, dbt will be unable to find the correct resource
  when running tests.
  
  To fix this, change the name of one of these resources:
  - test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab (models/tests/schema.yml)
  - test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab (models/tests/schema.yml)
[2024-11-21T07:56:52.373+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T07:56:52.408+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 27.311 seconds
[2024-11-21T07:57:22.623+0000] {processor.py:161} INFO - Started process (PID=3846) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T07:57:22.627+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T07:57:22.630+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:57:22.629+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T07:57:22.740+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:57:22.739+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T07:57:25.156+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:57:25.155+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 4.249346694999986
[2024-11-21T07:57:25.157+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:57:25.157+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T07:57:25.159+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:57:25.158+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T07:57:25.177+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:57:25.177+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T07:57:25.193+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:57:25.193+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T07:57:25.219+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:57:25.219+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmph2jfr3qv --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T07:57:34.831+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:57:34.830+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmph2jfr3qv --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T07:57:50.725+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:57:50.706+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 203, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmph2jfr3qv', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
07:57:41  Running with dbt=1.8.7
07:57:45  Registered adapter: bigquery=1.8.3
07:57:47  [WARNING]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
07:57:47  Encountered an error:
Compilation Error
  dbt found two data_tests with the name "unique_fct_trips_trip_id" defined on column "trip_id" in "models.fct_trips".
  
  Since these resources have the same name, dbt will be unable to find the correct resource
  when running tests.
  
  To fix this, change the name of one of these resources:
  - test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab (models/tests/schema.yml)
  - test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab (models/tests/schema.yml)
[2024-11-21T07:57:50.729+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T07:57:50.787+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 30.050 seconds
[2024-11-21T07:58:20.998+0000] {processor.py:161} INFO - Started process (PID=3898) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T07:58:21.000+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T07:58:21.003+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:58:21.002+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T07:58:21.116+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:58:21.116+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T07:58:25.450+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:58:25.450+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 4.300749762000123
[2024-11-21T07:58:25.452+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:58:25.451+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T07:58:25.453+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:58:25.453+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T07:58:25.472+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:58:25.472+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T07:58:25.490+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:58:25.489+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T07:58:25.517+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:58:25.517+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpc8auwjdu --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T07:58:34.641+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:58:34.640+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpc8auwjdu --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T07:58:47.539+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:58:47.526+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 203, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpc8auwjdu', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
07:58:40  Running with dbt=1.8.7
07:58:43  Registered adapter: bigquery=1.8.3
07:58:46  [WARNING]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
07:58:46  Encountered an error:
Compilation Error
  dbt found two data_tests with the name "unique_fct_trips_trip_id" defined on column "trip_id" in "models.fct_trips".
  
  Since these resources have the same name, dbt will be unable to find the correct resource
  when running tests.
  
  To fix this, change the name of one of these resources:
  - test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab (models/tests/schema.yml)
  - test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab (models/tests/schema.yml)
[2024-11-21T07:58:47.541+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T07:58:47.573+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 28.350 seconds
[2024-11-21T07:59:17.706+0000] {processor.py:161} INFO - Started process (PID=3950) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T07:59:17.708+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T07:59:17.711+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:59:17.710+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T07:59:17.821+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:59:17.821+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T07:59:22.143+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:59:22.143+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 4.28871574599998
[2024-11-21T07:59:22.145+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:59:22.144+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T07:59:22.146+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:59:22.146+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T07:59:22.165+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:59:22.165+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T07:59:22.182+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:59:22.181+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T07:59:22.209+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:59:22.208+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp5n_a610t --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T07:59:31.514+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:59:31.513+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp5n_a610t --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T07:59:45.029+0000] {logging_mixin.py:188} INFO - [2024-11-21T07:59:45.016+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 203, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmp5n_a610t', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
07:59:37  Running with dbt=1.8.7
07:59:41  Registered adapter: bigquery=1.8.3
07:59:43  [WARNING]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
07:59:43  Encountered an error:
Compilation Error
  dbt found two data_tests with the name "unique_fct_trips_trip_id" defined on column "trip_id" in "models.fct_trips".
  
  Since these resources have the same name, dbt will be unable to find the correct resource
  when running tests.
  
  To fix this, change the name of one of these resources:
  - test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab (models/tests/schema.yml)
  - test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab (models/tests/schema.yml)
[2024-11-21T07:59:45.031+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T07:59:45.061+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 29.103 seconds
[2024-11-21T08:00:15.282+0000] {processor.py:161} INFO - Started process (PID=4002) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T08:00:15.285+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T08:00:15.287+0000] {logging_mixin.py:188} INFO - [2024-11-21T08:00:15.287+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T08:00:15.391+0000] {logging_mixin.py:188} INFO - [2024-11-21T08:00:15.391+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T08:00:19.783+0000] {logging_mixin.py:188} INFO - [2024-11-21T08:00:19.783+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 4.36060413999985
[2024-11-21T08:00:19.785+0000] {logging_mixin.py:188} INFO - [2024-11-21T08:00:19.784+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T08:00:19.786+0000] {logging_mixin.py:188} INFO - [2024-11-21T08:00:19.786+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T08:00:19.806+0000] {logging_mixin.py:188} INFO - [2024-11-21T08:00:19.805+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T08:00:19.820+0000] {logging_mixin.py:188} INFO - [2024-11-21T08:00:19.820+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T08:00:19.845+0000] {logging_mixin.py:188} INFO - [2024-11-21T08:00:19.845+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpu6ln7yio --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T08:00:28.976+0000] {logging_mixin.py:188} INFO - [2024-11-21T08:00:28.975+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpu6ln7yio --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T08:00:41.658+0000] {logging_mixin.py:188} INFO - [2024-11-21T08:00:41.646+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 203, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpu6ln7yio', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
08:00:34  Running with dbt=1.8.7
08:00:38  Registered adapter: bigquery=1.8.3
08:00:40  [WARNING]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
08:00:40  Encountered an error:
Compilation Error
  dbt found two data_tests with the name "unique_fct_trips_trip_id" defined on column "trip_id" in "models.fct_trips".
  
  Since these resources have the same name, dbt will be unable to find the correct resource
  when running tests.
  
  To fix this, change the name of one of these resources:
  - test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab (models/tests/schema.yml)
  - test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab (models/tests/schema.yml)
[2024-11-21T08:00:41.661+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T08:00:41.690+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 28.216 seconds
[2024-11-21T08:01:11.898+0000] {processor.py:161} INFO - Started process (PID=4054) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T08:01:11.900+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T08:01:11.902+0000] {logging_mixin.py:188} INFO - [2024-11-21T08:01:11.901+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T08:01:12.007+0000] {logging_mixin.py:188} INFO - [2024-11-21T08:01:12.006+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T08:01:16.377+0000] {logging_mixin.py:188} INFO - [2024-11-21T08:01:16.376+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 4.338439163000658
[2024-11-21T08:01:16.378+0000] {logging_mixin.py:188} INFO - [2024-11-21T08:01:16.378+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T08:01:16.379+0000] {logging_mixin.py:188} INFO - [2024-11-21T08:01:16.379+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T08:01:16.400+0000] {logging_mixin.py:188} INFO - [2024-11-21T08:01:16.399+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T08:01:16.415+0000] {logging_mixin.py:188} INFO - [2024-11-21T08:01:16.415+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T08:01:16.442+0000] {logging_mixin.py:188} INFO - [2024-11-21T08:01:16.442+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpo6wxefra --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T08:01:26.112+0000] {logging_mixin.py:188} INFO - [2024-11-21T08:01:26.111+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpo6wxefra --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T08:01:39.433+0000] {logging_mixin.py:188} INFO - [2024-11-21T08:01:39.420+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 203, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpo6wxefra', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
08:01:32  Running with dbt=1.8.7
08:01:35  Registered adapter: bigquery=1.8.3
08:01:36  [WARNING]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
08:01:36  Encountered an error:
Compilation Error
  dbt found two data_tests with the name "unique_fct_trips_trip_id" defined on column "trip_id" in "models.fct_trips".
  
  Since these resources have the same name, dbt will be unable to find the correct resource
  when running tests.
  
  To fix this, change the name of one of these resources:
  - test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab (models/tests/schema.yml)
  - test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab (models/tests/schema.yml)
[2024-11-21T08:01:39.436+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T08:01:39.469+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 29.427 seconds
[2024-11-21T08:02:10.528+0000] {processor.py:161} INFO - Started process (PID=4105) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T08:02:10.534+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T08:02:10.537+0000] {logging_mixin.py:188} INFO - [2024-11-21T08:02:10.536+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T08:02:10.642+0000] {logging_mixin.py:188} INFO - [2024-11-21T08:02:10.642+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T08:02:14.930+0000] {logging_mixin.py:188} INFO - [2024-11-21T08:02:14.929+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 4.255342434999875
[2024-11-21T08:02:14.931+0000] {logging_mixin.py:188} INFO - [2024-11-21T08:02:14.931+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T08:02:14.933+0000] {logging_mixin.py:188} INFO - [2024-11-21T08:02:14.933+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T08:02:14.952+0000] {logging_mixin.py:188} INFO - [2024-11-21T08:02:14.951+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T08:02:14.967+0000] {logging_mixin.py:188} INFO - [2024-11-21T08:02:14.967+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T08:02:15.000+0000] {logging_mixin.py:188} INFO - [2024-11-21T08:02:15.000+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpkg89sb4q --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T08:02:24.082+0000] {logging_mixin.py:188} INFO - [2024-11-21T08:02:24.080+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpkg89sb4q --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T08:02:36.861+0000] {logging_mixin.py:188} INFO - [2024-11-21T08:02:36.851+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 203, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpkg89sb4q', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
08:02:29  Running with dbt=1.8.7
08:02:33  Registered adapter: bigquery=1.8.3
08:02:33  [WARNING]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
08:02:34  Encountered an error:
Compilation Error
  dbt found two data_tests with the name "unique_fct_trips_trip_id" defined on column "trip_id" in "models.fct_trips".
  
  Since these resources have the same name, dbt will be unable to find the correct resource
  when running tests.
  
  To fix this, change the name of one of these resources:
  - test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab (models/tests/schema.yml)
  - test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab (models/tests/schema.yml)
[2024-11-21T08:02:36.863+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T08:02:36.889+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 28.157 seconds
[2024-11-21T08:03:07.063+0000] {processor.py:161} INFO - Started process (PID=4157) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T08:03:07.065+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T08:03:07.067+0000] {logging_mixin.py:188} INFO - [2024-11-21T08:03:07.066+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T08:03:07.178+0000] {logging_mixin.py:188} INFO - [2024-11-21T08:03:07.177+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T08:03:11.597+0000] {logging_mixin.py:188} INFO - [2024-11-21T08:03:11.596+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 4.388994396000271
[2024-11-21T08:03:11.598+0000] {logging_mixin.py:188} INFO - [2024-11-21T08:03:11.598+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T08:03:11.600+0000] {logging_mixin.py:188} INFO - [2024-11-21T08:03:11.600+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T08:03:11.618+0000] {logging_mixin.py:188} INFO - [2024-11-21T08:03:11.618+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T08:03:11.640+0000] {logging_mixin.py:188} INFO - [2024-11-21T08:03:11.639+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T08:03:11.666+0000] {logging_mixin.py:188} INFO - [2024-11-21T08:03:11.665+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmppb8hn4_e --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T08:03:21.447+0000] {logging_mixin.py:188} INFO - [2024-11-21T08:03:21.446+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmppb8hn4_e --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T08:03:34.511+0000] {logging_mixin.py:188} INFO - [2024-11-21T08:03:34.496+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 203, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmppb8hn4_e', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
08:03:27  Running with dbt=1.8.7
08:03:29  Registered adapter: bigquery=1.8.3
08:03:31  [WARNING]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
08:03:31  Encountered an error:
Compilation Error
  dbt found two data_tests with the name "unique_fct_trips_trip_id" defined on column "trip_id" in "models.fct_trips".
  
  Since these resources have the same name, dbt will be unable to find the correct resource
  when running tests.
  
  To fix this, change the name of one of these resources:
  - test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab (models/tests/schema.yml)
  - test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab (models/tests/schema.yml)
[2024-11-21T08:03:34.513+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T08:03:34.539+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 29.272 seconds
[2024-11-21T08:04:04.696+0000] {processor.py:161} INFO - Started process (PID=4209) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T08:04:04.698+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T08:04:04.700+0000] {logging_mixin.py:188} INFO - [2024-11-21T08:04:04.700+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T08:04:04.809+0000] {logging_mixin.py:188} INFO - [2024-11-21T08:04:04.809+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T08:04:09.203+0000] {logging_mixin.py:188} INFO - [2024-11-21T08:04:09.202+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 4.36014149499988
[2024-11-21T08:04:09.204+0000] {logging_mixin.py:188} INFO - [2024-11-21T08:04:09.204+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T08:04:09.206+0000] {logging_mixin.py:188} INFO - [2024-11-21T08:04:09.206+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T08:04:09.224+0000] {logging_mixin.py:188} INFO - [2024-11-21T08:04:09.224+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T08:04:09.240+0000] {logging_mixin.py:188} INFO - [2024-11-21T08:04:09.240+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T08:04:09.270+0000] {logging_mixin.py:188} INFO - [2024-11-21T08:04:09.269+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp62kj56g2 --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T08:04:18.656+0000] {logging_mixin.py:188} INFO - [2024-11-21T08:04:18.654+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp62kj56g2 --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T08:04:31.368+0000] {logging_mixin.py:188} INFO - [2024-11-21T08:04:31.356+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 203, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmp62kj56g2', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
08:04:24  Running with dbt=1.8.7
08:04:26  Registered adapter: bigquery=1.8.3
08:04:28  [WARNING]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
08:04:28  Encountered an error:
Compilation Error
  dbt found two data_tests with the name "unique_fct_trips_trip_id" defined on column "trip_id" in "models.fct_trips".
  
  Since these resources have the same name, dbt will be unable to find the correct resource
  when running tests.
  
  To fix this, change the name of one of these resources:
  - test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab (models/tests/schema.yml)
  - test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab (models/tests/schema.yml)
[2024-11-21T08:04:31.370+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T08:04:31.402+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 28.536 seconds
[2024-11-21T08:05:02.160+0000] {processor.py:161} INFO - Started process (PID=4261) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T08:05:02.163+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T08:05:02.165+0000] {logging_mixin.py:188} INFO - [2024-11-21T08:05:02.165+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T08:05:02.285+0000] {logging_mixin.py:188} INFO - [2024-11-21T08:05:02.284+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T08:05:06.430+0000] {logging_mixin.py:188} INFO - [2024-11-21T08:05:06.429+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 4.1148651740004425
[2024-11-21T08:05:06.431+0000] {logging_mixin.py:188} INFO - [2024-11-21T08:05:06.430+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T08:05:06.432+0000] {logging_mixin.py:188} INFO - [2024-11-21T08:05:06.432+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T08:05:06.451+0000] {logging_mixin.py:188} INFO - [2024-11-21T08:05:06.451+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T08:05:06.468+0000] {logging_mixin.py:188} INFO - [2024-11-21T08:05:06.468+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T08:05:06.493+0000] {logging_mixin.py:188} INFO - [2024-11-21T08:05:06.493+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp8w6uv53x --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T08:05:16.411+0000] {logging_mixin.py:188} INFO - [2024-11-21T08:05:16.410+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp8w6uv53x --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T08:05:29.598+0000] {logging_mixin.py:188} INFO - [2024-11-21T08:05:29.581+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 203, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmp8w6uv53x', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
08:05:22  Running with dbt=1.8.7
08:05:24  Registered adapter: bigquery=1.8.3
08:05:26  [WARNING]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
08:05:26  Encountered an error:
Compilation Error
  dbt found two data_tests with the name "unique_fct_trips_trip_id" defined on column "trip_id" in "models.fct_trips".
  
  Since these resources have the same name, dbt will be unable to find the correct resource
  when running tests.
  
  To fix this, change the name of one of these resources:
  - test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab (models/tests/schema.yml)
  - test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab (models/tests/schema.yml)
[2024-11-21T08:05:29.600+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T08:05:29.637+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 29.341 seconds
[2024-11-21T08:05:59.799+0000] {processor.py:161} INFO - Started process (PID=4313) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T08:05:59.802+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T08:05:59.806+0000] {logging_mixin.py:188} INFO - [2024-11-21T08:05:59.805+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T08:05:59.923+0000] {logging_mixin.py:188} INFO - [2024-11-21T08:05:59.922+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T08:06:04.394+0000] {logging_mixin.py:188} INFO - [2024-11-21T08:06:04.393+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 4.438712041000144
[2024-11-21T08:06:04.395+0000] {logging_mixin.py:188} INFO - [2024-11-21T08:06:04.395+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T08:06:04.397+0000] {logging_mixin.py:188} INFO - [2024-11-21T08:06:04.396+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T08:06:04.415+0000] {logging_mixin.py:188} INFO - [2024-11-21T08:06:04.414+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T08:06:04.431+0000] {logging_mixin.py:188} INFO - [2024-11-21T08:06:04.431+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T08:06:04.457+0000] {logging_mixin.py:188} INFO - [2024-11-21T08:06:04.456+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpfcaes5wn --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T08:06:14.219+0000] {logging_mixin.py:188} INFO - [2024-11-21T08:06:14.218+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpfcaes5wn --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T08:06:27.451+0000] {logging_mixin.py:188} INFO - [2024-11-21T08:06:27.440+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 203, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpfcaes5wn', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
08:06:18  Running with dbt=1.8.7
08:06:22  Registered adapter: bigquery=1.8.3
08:06:24  [WARNING]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
08:06:24  Encountered an error:
Compilation Error
  dbt found two data_tests with the name "unique_fct_trips_trip_id" defined on column "trip_id" in "models.fct_trips".
  
  Since these resources have the same name, dbt will be unable to find the correct resource
  when running tests.
  
  To fix this, change the name of one of these resources:
  - test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab (models/tests/schema.yml)
  - test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab (models/tests/schema.yml)
[2024-11-21T08:06:27.453+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T08:06:27.481+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 29.494 seconds
[2024-11-21T08:06:57.686+0000] {processor.py:161} INFO - Started process (PID=4365) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T08:06:57.690+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T08:06:57.692+0000] {logging_mixin.py:188} INFO - [2024-11-21T08:06:57.692+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T08:06:57.799+0000] {logging_mixin.py:188} INFO - [2024-11-21T08:06:57.798+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T08:07:01.763+0000] {logging_mixin.py:188} INFO - [2024-11-21T08:07:01.762+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 3.9264654729995527
[2024-11-21T08:07:01.764+0000] {logging_mixin.py:188} INFO - [2024-11-21T08:07:01.764+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T08:07:01.766+0000] {logging_mixin.py:188} INFO - [2024-11-21T08:07:01.765+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T08:07:01.785+0000] {logging_mixin.py:188} INFO - [2024-11-21T08:07:01.784+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T08:07:01.800+0000] {logging_mixin.py:188} INFO - [2024-11-21T08:07:01.800+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T08:07:01.823+0000] {logging_mixin.py:188} INFO - [2024-11-21T08:07:01.822+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpdhxr37sa --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T08:07:12.188+0000] {logging_mixin.py:188} INFO - [2024-11-21T08:07:12.187+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpdhxr37sa --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T08:07:25.089+0000] {logging_mixin.py:188} INFO - [2024-11-21T08:07:25.076+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 203, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpdhxr37sa', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
08:07:16  Running with dbt=1.8.7
08:07:19  Registered adapter: bigquery=1.8.3
08:07:21  [WARNING]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
08:07:22  Encountered an error:
Compilation Error
  dbt found two data_tests with the name "unique_fct_trips_trip_id" defined on column "trip_id" in "models.fct_trips".
  
  Since these resources have the same name, dbt will be unable to find the correct resource
  when running tests.
  
  To fix this, change the name of one of these resources:
  - test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab (models/tests/schema.yml)
  - test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab (models/tests/schema.yml)
[2024-11-21T08:07:25.092+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T08:07:25.124+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 29.278 seconds
[2024-11-21T08:07:55.327+0000] {processor.py:161} INFO - Started process (PID=4417) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T08:07:55.330+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T08:07:55.332+0000] {logging_mixin.py:188} INFO - [2024-11-21T08:07:55.331+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T08:07:55.445+0000] {logging_mixin.py:188} INFO - [2024-11-21T08:07:55.445+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T08:07:59.834+0000] {logging_mixin.py:188} INFO - [2024-11-21T08:07:59.833+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 4.357072600001629
[2024-11-21T08:07:59.835+0000] {logging_mixin.py:188} INFO - [2024-11-21T08:07:59.835+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T08:07:59.837+0000] {logging_mixin.py:188} INFO - [2024-11-21T08:07:59.837+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T08:07:59.854+0000] {logging_mixin.py:188} INFO - [2024-11-21T08:07:59.854+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T08:07:59.872+0000] {logging_mixin.py:188} INFO - [2024-11-21T08:07:59.871+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T08:07:59.897+0000] {logging_mixin.py:188} INFO - [2024-11-21T08:07:59.897+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpgpw15j2x --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T08:08:08.828+0000] {logging_mixin.py:188} INFO - [2024-11-21T08:08:08.827+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpgpw15j2x --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T08:08:22.596+0000] {logging_mixin.py:188} INFO - [2024-11-21T08:08:22.582+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 203, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpgpw15j2x', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
08:08:12  Running with dbt=1.8.7
08:08:16  Registered adapter: bigquery=1.8.3
08:08:19  [WARNING]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
08:08:19  Encountered an error:
Compilation Error
  dbt found two data_tests with the name "unique_fct_trips_trip_id" defined on column "trip_id" in "models.fct_trips".
  
  Since these resources have the same name, dbt will be unable to find the correct resource
  when running tests.
  
  To fix this, change the name of one of these resources:
  - test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab (models/tests/schema.yml)
  - test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab (models/tests/schema.yml)
[2024-11-21T08:08:22.599+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T08:08:22.636+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 29.069 seconds
[2024-11-21T08:08:52.795+0000] {processor.py:161} INFO - Started process (PID=4469) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T08:08:52.797+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T08:08:52.799+0000] {logging_mixin.py:188} INFO - [2024-11-21T08:08:52.799+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T08:08:52.902+0000] {logging_mixin.py:188} INFO - [2024-11-21T08:08:52.902+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T08:08:54.888+0000] {logging_mixin.py:188} INFO - [2024-11-21T08:08:54.888+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 1.95896579500004
[2024-11-21T08:08:54.889+0000] {logging_mixin.py:188} INFO - [2024-11-21T08:08:54.888+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T08:08:54.889+0000] {logging_mixin.py:188} INFO - [2024-11-21T08:08:54.889+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T08:08:54.896+0000] {logging_mixin.py:188} INFO - [2024-11-21T08:08:54.896+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T08:08:54.908+0000] {logging_mixin.py:188} INFO - [2024-11-21T08:08:54.907+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T08:08:54.924+0000] {logging_mixin.py:188} INFO - [2024-11-21T08:08:54.924+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp7mrufi52 --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T08:09:04.790+0000] {logging_mixin.py:188} INFO - [2024-11-21T08:09:04.789+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp7mrufi52 --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T08:52:39.208+0000] {processor.py:161} INFO - Started process (PID=4514) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T08:52:39.210+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T08:52:39.212+0000] {logging_mixin.py:188} INFO - [2024-11-21T08:52:39.212+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T08:52:39.314+0000] {logging_mixin.py:188} INFO - [2024-11-21T08:52:39.313+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T08:52:41.385+0000] {logging_mixin.py:188} INFO - [2024-11-21T08:52:41.384+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 3.8370749429996067
[2024-11-21T08:52:41.386+0000] {logging_mixin.py:188} INFO - [2024-11-21T08:52:41.385+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T08:52:41.387+0000] {logging_mixin.py:188} INFO - [2024-11-21T08:52:41.387+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T08:52:41.403+0000] {logging_mixin.py:188} INFO - [2024-11-21T08:52:41.403+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T08:52:41.424+0000] {logging_mixin.py:188} INFO - [2024-11-21T08:52:41.423+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T08:52:41.449+0000] {logging_mixin.py:188} INFO - [2024-11-21T08:52:41.449+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmppoq36r52 --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T08:52:50.537+0000] {logging_mixin.py:188} INFO - [2024-11-21T08:52:50.536+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmppoq36r52 --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T08:53:06.338+0000] {logging_mixin.py:188} INFO - [2024-11-21T08:53:06.323+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 203, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmppoq36r52', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
08:52:56  Running with dbt=1.8.7
08:53:00  Registered adapter: bigquery=1.8.3
08:53:03  [WARNING]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
08:53:03  Encountered an error:
Compilation Error
  dbt found two data_tests with the name "unique_fct_trips_trip_id" defined on column "trip_id" in "models.fct_trips".
  
  Since these resources have the same name, dbt will be unable to find the correct resource
  when running tests.
  
  To fix this, change the name of one of these resources:
  - test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab (models/tests/schema.yml)
  - test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab (models/tests/schema.yml)
[2024-11-21T08:53:06.340+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T08:53:06.369+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 28.980 seconds
[2024-11-21T08:53:36.779+0000] {processor.py:161} INFO - Started process (PID=4566) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T08:53:36.781+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T08:53:36.784+0000] {logging_mixin.py:188} INFO - [2024-11-21T08:53:36.783+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T08:53:36.924+0000] {logging_mixin.py:188} INFO - [2024-11-21T08:53:36.923+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T08:53:39.376+0000] {logging_mixin.py:188} INFO - [2024-11-21T08:53:39.375+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 4.306256818999827
[2024-11-21T08:53:39.378+0000] {logging_mixin.py:188} INFO - [2024-11-21T08:53:39.377+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T08:53:39.380+0000] {logging_mixin.py:188} INFO - [2024-11-21T08:53:39.379+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T08:53:39.398+0000] {logging_mixin.py:188} INFO - [2024-11-21T08:53:39.397+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T08:53:39.428+0000] {logging_mixin.py:188} INFO - [2024-11-21T08:53:39.427+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T08:53:39.456+0000] {logging_mixin.py:188} INFO - [2024-11-21T08:53:39.455+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp03x0hxz5 --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T08:53:48.783+0000] {logging_mixin.py:188} INFO - [2024-11-21T08:53:48.782+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp03x0hxz5 --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T08:54:04.929+0000] {logging_mixin.py:188} INFO - [2024-11-21T08:54:04.924+0000] {timeout.py:68} ERROR - Process timed out, PID: 4566
[2024-11-21T08:54:35.212+0000] {processor.py:161} INFO - Started process (PID=4624) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T08:54:35.239+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T08:54:35.246+0000] {logging_mixin.py:188} INFO - [2024-11-21T08:54:35.245+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T08:54:35.361+0000] {logging_mixin.py:188} INFO - [2024-11-21T08:54:35.361+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T08:54:39.785+0000] {logging_mixin.py:188} INFO - [2024-11-21T08:54:39.784+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 4.392549862999658
[2024-11-21T08:54:39.786+0000] {logging_mixin.py:188} INFO - [2024-11-21T08:54:39.786+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T08:54:39.787+0000] {logging_mixin.py:188} INFO - [2024-11-21T08:54:39.787+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T08:54:39.806+0000] {logging_mixin.py:188} INFO - [2024-11-21T08:54:39.806+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T08:54:39.825+0000] {logging_mixin.py:188} INFO - [2024-11-21T08:54:39.825+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T08:54:39.851+0000] {logging_mixin.py:188} INFO - [2024-11-21T08:54:39.851+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpvghwqtp6 --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T08:54:49.809+0000] {logging_mixin.py:188} INFO - [2024-11-21T08:54:49.807+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpvghwqtp6 --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T08:55:02.740+0000] {logging_mixin.py:188} INFO - [2024-11-21T08:55:02.727+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 203, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpvghwqtp6', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
08:54:55  Running with dbt=1.8.7
08:54:59  Registered adapter: bigquery=1.8.3
08:55:01  [WARNING]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
08:55:01  Encountered an error:
Compilation Error
  dbt found two data_tests with the name "unique_fct_trips_trip_id" defined on column "trip_id" in "models.fct_trips".
  
  Since these resources have the same name, dbt will be unable to find the correct resource
  when running tests.
  
  To fix this, change the name of one of these resources:
  - test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab (models/tests/schema.yml)
  - test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab (models/tests/schema.yml)
[2024-11-21T08:55:02.742+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T08:55:02.767+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 29.343 seconds
[2024-11-21T08:55:32.886+0000] {processor.py:161} INFO - Started process (PID=4676) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T08:55:32.888+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T08:55:32.890+0000] {logging_mixin.py:188} INFO - [2024-11-21T08:55:32.890+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T08:55:33.005+0000] {logging_mixin.py:188} INFO - [2024-11-21T08:55:33.005+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T08:55:37.412+0000] {logging_mixin.py:188} INFO - [2024-11-21T08:55:37.412+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 4.374527019001107
[2024-11-21T08:55:37.413+0000] {logging_mixin.py:188} INFO - [2024-11-21T08:55:37.413+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T08:55:37.415+0000] {logging_mixin.py:188} INFO - [2024-11-21T08:55:37.414+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T08:55:37.433+0000] {logging_mixin.py:188} INFO - [2024-11-21T08:55:37.433+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T08:55:37.448+0000] {logging_mixin.py:188} INFO - [2024-11-21T08:55:37.447+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T08:55:37.474+0000] {logging_mixin.py:188} INFO - [2024-11-21T08:55:37.474+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp4p6r3cqb --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T08:55:47.226+0000] {logging_mixin.py:188} INFO - [2024-11-21T08:55:47.225+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp4p6r3cqb --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T08:56:00.633+0000] {logging_mixin.py:188} INFO - [2024-11-21T08:56:00.619+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 203, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmp4p6r3cqb', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
08:55:53  Running with dbt=1.8.7
08:55:57  Registered adapter: bigquery=1.8.3
08:55:57  [WARNING]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
08:55:58  Encountered an error:
Compilation Error
  dbt found two data_tests with the name "unique_fct_trips_trip_id" defined on column "trip_id" in "models.fct_trips".
  
  Since these resources have the same name, dbt will be unable to find the correct resource
  when running tests.
  
  To fix this, change the name of one of these resources:
  - test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab (models/tests/schema.yml)
  - test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab (models/tests/schema.yml)
[2024-11-21T08:56:00.635+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T08:56:00.667+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 29.599 seconds
[2024-11-21T08:56:31.532+0000] {processor.py:161} INFO - Started process (PID=4728) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T08:56:31.535+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T08:56:31.538+0000] {logging_mixin.py:188} INFO - [2024-11-21T08:56:31.537+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T08:56:31.654+0000] {logging_mixin.py:188} INFO - [2024-11-21T08:56:31.653+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T08:56:36.039+0000] {logging_mixin.py:188} INFO - [2024-11-21T08:56:36.038+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 4.351073677999011
[2024-11-21T08:56:36.040+0000] {logging_mixin.py:188} INFO - [2024-11-21T08:56:36.040+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T08:56:36.042+0000] {logging_mixin.py:188} INFO - [2024-11-21T08:56:36.041+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T08:56:36.061+0000] {logging_mixin.py:188} INFO - [2024-11-21T08:56:36.061+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T08:56:36.077+0000] {logging_mixin.py:188} INFO - [2024-11-21T08:56:36.077+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T08:56:36.106+0000] {logging_mixin.py:188} INFO - [2024-11-21T08:56:36.106+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp7tp_wojx --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T08:56:45.675+0000] {logging_mixin.py:188} INFO - [2024-11-21T08:56:45.674+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp7tp_wojx --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T08:56:59.337+0000] {logging_mixin.py:188} INFO - [2024-11-21T08:56:59.325+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 203, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmp7tp_wojx', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
08:56:51  Running with dbt=1.8.7
08:56:53  Registered adapter: bigquery=1.8.3
08:56:56  [WARNING]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
08:56:56  Encountered an error:
Compilation Error
  dbt found two data_tests with the name "unique_fct_trips_trip_id" defined on column "trip_id" in "models.fct_trips".
  
  Since these resources have the same name, dbt will be unable to find the correct resource
  when running tests.
  
  To fix this, change the name of one of these resources:
  - test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab (models/tests/schema.yml)
  - test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab (models/tests/schema.yml)
[2024-11-21T08:56:59.345+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T08:56:59.368+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 29.679 seconds
[2024-11-21T08:57:29.516+0000] {processor.py:161} INFO - Started process (PID=4780) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T08:57:29.519+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T08:57:29.521+0000] {logging_mixin.py:188} INFO - [2024-11-21T08:57:29.521+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T08:57:29.631+0000] {logging_mixin.py:188} INFO - [2024-11-21T08:57:29.630+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T08:57:33.904+0000] {logging_mixin.py:188} INFO - [2024-11-21T08:57:33.903+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 4.234475100000054
[2024-11-21T08:57:33.906+0000] {logging_mixin.py:188} INFO - [2024-11-21T08:57:33.905+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T08:57:33.908+0000] {logging_mixin.py:188} INFO - [2024-11-21T08:57:33.907+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T08:57:33.946+0000] {logging_mixin.py:188} INFO - [2024-11-21T08:57:33.945+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T08:57:33.973+0000] {logging_mixin.py:188} INFO - [2024-11-21T08:57:33.972+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T08:57:34.001+0000] {logging_mixin.py:188} INFO - [2024-11-21T08:57:34.001+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp4dicagmz --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T08:57:43.907+0000] {logging_mixin.py:188} INFO - [2024-11-21T08:57:43.906+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp4dicagmz --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T08:57:57.058+0000] {logging_mixin.py:188} INFO - [2024-11-21T08:57:57.046+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 203, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmp4dicagmz', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
08:57:49  Running with dbt=1.8.7
08:57:51  Registered adapter: bigquery=1.8.3
08:57:54  [WARNING]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
08:57:54  Encountered an error:
Compilation Error
  dbt found two data_tests with the name "unique_fct_trips_trip_id" defined on column "trip_id" in "models.fct_trips".
  
  Since these resources have the same name, dbt will be unable to find the correct resource
  when running tests.
  
  To fix this, change the name of one of these resources:
  - test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab (models/tests/schema.yml)
  - test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab (models/tests/schema.yml)
[2024-11-21T08:57:57.060+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T08:57:57.090+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 29.398 seconds
[2024-11-21T08:58:28.174+0000] {processor.py:161} INFO - Started process (PID=4832) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T08:58:28.177+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T08:58:28.179+0000] {logging_mixin.py:188} INFO - [2024-11-21T08:58:28.179+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T08:58:28.287+0000] {logging_mixin.py:188} INFO - [2024-11-21T08:58:28.287+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T08:58:32.462+0000] {logging_mixin.py:188} INFO - [2024-11-21T08:58:32.461+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 4.14307067899972
[2024-11-21T08:58:32.463+0000] {logging_mixin.py:188} INFO - [2024-11-21T08:58:32.462+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T08:58:32.464+0000] {logging_mixin.py:188} INFO - [2024-11-21T08:58:32.464+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T08:58:32.480+0000] {logging_mixin.py:188} INFO - [2024-11-21T08:58:32.479+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T08:58:32.495+0000] {logging_mixin.py:188} INFO - [2024-11-21T08:58:32.495+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T08:58:32.519+0000] {logging_mixin.py:188} INFO - [2024-11-21T08:58:32.518+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpq18_n1hr --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T08:58:42.157+0000] {logging_mixin.py:188} INFO - [2024-11-21T08:58:42.156+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpq18_n1hr --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T08:58:55.727+0000] {logging_mixin.py:188} INFO - [2024-11-21T08:58:55.716+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 203, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpq18_n1hr', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
08:58:46  Running with dbt=1.8.7
08:58:50  Registered adapter: bigquery=1.8.3
08:58:52  [WARNING]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
08:58:53  Encountered an error:
Compilation Error
  dbt found two data_tests with the name "unique_fct_trips_trip_id" defined on column "trip_id" in "models.fct_trips".
  
  Since these resources have the same name, dbt will be unable to find the correct resource
  when running tests.
  
  To fix this, change the name of one of these resources:
  - test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab (models/tests/schema.yml)
  - test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab (models/tests/schema.yml)
[2024-11-21T08:58:55.729+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T08:58:55.762+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 29.393 seconds
[2024-11-21T08:59:26.625+0000] {processor.py:161} INFO - Started process (PID=4884) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T08:59:26.627+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T08:59:26.630+0000] {logging_mixin.py:188} INFO - [2024-11-21T08:59:26.629+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T08:59:26.726+0000] {logging_mixin.py:188} INFO - [2024-11-21T08:59:26.726+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T08:59:30.594+0000] {logging_mixin.py:188} INFO - [2024-11-21T08:59:30.593+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 3.8271524900010263
[2024-11-21T08:59:30.596+0000] {logging_mixin.py:188} INFO - [2024-11-21T08:59:30.595+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T08:59:30.597+0000] {logging_mixin.py:188} INFO - [2024-11-21T08:59:30.597+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T08:59:30.612+0000] {logging_mixin.py:188} INFO - [2024-11-21T08:59:30.612+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T08:59:30.629+0000] {logging_mixin.py:188} INFO - [2024-11-21T08:59:30.629+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T08:59:30.655+0000] {logging_mixin.py:188} INFO - [2024-11-21T08:59:30.654+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpgpbrg3pf --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T08:59:40.599+0000] {logging_mixin.py:188} INFO - [2024-11-21T08:59:40.598+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpgpbrg3pf --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T08:59:54.215+0000] {logging_mixin.py:188} INFO - [2024-11-21T08:59:54.201+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 203, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpgpbrg3pf', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
08:59:44  Running with dbt=1.8.7
08:59:48  Registered adapter: bigquery=1.8.3
08:59:51  [WARNING]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
08:59:51  Encountered an error:
Compilation Error
  dbt found two data_tests with the name "unique_fct_trips_trip_id" defined on column "trip_id" in "models.fct_trips".
  
  Since these resources have the same name, dbt will be unable to find the correct resource
  when running tests.
  
  To fix this, change the name of one of these resources:
  - test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab (models/tests/schema.yml)
  - test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab (models/tests/schema.yml)
[2024-11-21T08:59:54.217+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T08:59:54.253+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 29.432 seconds
[2024-11-21T09:00:24.524+0000] {processor.py:161} INFO - Started process (PID=4936) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T09:00:24.529+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T09:00:24.532+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:00:24.531+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T09:00:24.628+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:00:24.627+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T09:00:28.834+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:00:28.833+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 4.175718020000204
[2024-11-21T09:00:28.835+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:00:28.835+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T09:00:28.837+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:00:28.837+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T09:00:28.859+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:00:28.858+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T09:00:28.880+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:00:28.880+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T09:00:28.904+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:00:28.904+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpc1p7rx0o --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T09:00:38.502+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:00:38.501+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpc1p7rx0o --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T09:00:52.469+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:00:52.455+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 203, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpc1p7rx0o', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
09:00:42  Running with dbt=1.8.7
09:00:47  Registered adapter: bigquery=1.8.3
09:00:49  [WARNING]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
09:00:49  Encountered an error:
Compilation Error
  dbt found two data_tests with the name "unique_fct_trips_trip_id" defined on column "trip_id" in "models.fct_trips".
  
  Since these resources have the same name, dbt will be unable to find the correct resource
  when running tests.
  
  To fix this, change the name of one of these resources:
  - test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab (models/tests/schema.yml)
  - test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab (models/tests/schema.yml)
[2024-11-21T09:00:52.471+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T09:00:52.497+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 29.851 seconds
[2024-11-21T09:01:23.457+0000] {processor.py:161} INFO - Started process (PID=4987) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T09:01:23.460+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T09:01:23.463+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:01:23.462+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T09:01:23.562+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:01:23.561+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T09:01:27.564+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:01:27.564+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 3.9741513379995013
[2024-11-21T09:01:27.565+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:01:27.565+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T09:01:27.567+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:01:27.566+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T09:01:27.580+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:01:27.580+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T09:01:27.597+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:01:27.596+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T09:01:27.620+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:01:27.619+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpslte_eg7 --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T09:01:35.018+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:01:35.017+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpslte_eg7 --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T09:01:49.990+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:01:49.976+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 203, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpslte_eg7', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
09:01:40  Running with dbt=1.8.7
09:01:44  Registered adapter: bigquery=1.8.3
09:01:46  [WARNING]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
09:01:47  Encountered an error:
Compilation Error
  dbt found two data_tests with the name "unique_fct_trips_trip_id" defined on column "trip_id" in "models.fct_trips".
  
  Since these resources have the same name, dbt will be unable to find the correct resource
  when running tests.
  
  To fix this, change the name of one of these resources:
  - test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab (models/tests/schema.yml)
  - test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab (models/tests/schema.yml)
[2024-11-21T09:01:49.992+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T09:01:50.026+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 28.527 seconds
[2024-11-21T09:02:20.184+0000] {processor.py:161} INFO - Started process (PID=5039) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T09:02:20.193+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T09:02:20.200+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:02:20.196+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T09:02:20.302+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:02:20.301+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T09:02:24.741+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:02:24.740+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 4.4046984359993075
[2024-11-21T09:02:24.742+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:02:24.742+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T09:02:24.744+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:02:24.743+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T09:02:24.762+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:02:24.762+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T09:02:24.789+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:02:24.789+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T09:02:24.817+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:02:24.816+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpyy9ly3cz --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T09:02:33.111+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:02:33.108+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpyy9ly3cz --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T09:02:48.337+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:02:48.336+0000] {timeout.py:68} ERROR - Process timed out, PID: 5039
[2024-11-21T09:03:18.531+0000] {processor.py:161} INFO - Started process (PID=5091) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T09:03:18.546+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T09:03:18.549+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:03:18.548+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T09:03:18.699+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:03:18.698+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T09:03:22.143+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:03:22.143+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 3.4167030850003357
[2024-11-21T09:03:22.145+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:03:22.144+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T09:03:22.146+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:03:22.146+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T09:03:22.165+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:03:22.165+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T09:03:22.182+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:03:22.182+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T09:03:22.204+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:03:22.203+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpvdscw1hx --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T09:03:29.964+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:03:29.963+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpvdscw1hx --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T09:03:45.463+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:03:45.449+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 203, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpvdscw1hx', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
09:03:35  Running with dbt=1.8.7
09:03:39  Registered adapter: bigquery=1.8.3
09:03:42  [WARNING]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
09:03:42  Encountered an error:
Compilation Error
  dbt found two data_tests with the name "unique_fct_trips_trip_id" defined on column "trip_id" in "models.fct_trips".
  
  Since these resources have the same name, dbt will be unable to find the correct resource
  when running tests.
  
  To fix this, change the name of one of these resources:
  - test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab (models/tests/schema.yml)
  - test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab (models/tests/schema.yml)
[2024-11-21T09:03:45.465+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T09:03:45.492+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 28.814 seconds
[2024-11-21T09:04:16.287+0000] {processor.py:161} INFO - Started process (PID=5143) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T09:04:16.289+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T09:04:16.292+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:04:16.291+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T09:04:16.410+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:04:16.409+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T09:04:20.723+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:04:20.723+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 4.283737326000846
[2024-11-21T09:04:20.725+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:04:20.724+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T09:04:20.727+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:04:20.726+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T09:04:20.747+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:04:20.747+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T09:04:20.767+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:04:20.767+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T09:04:20.795+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:04:20.794+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpmf6ybzsw --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T09:04:28.961+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:04:28.959+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpmf6ybzsw --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T09:04:44.438+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:04:44.436+0000] {timeout.py:68} ERROR - Process timed out, PID: 5143
[2024-11-21T09:05:14.734+0000] {processor.py:161} INFO - Started process (PID=5195) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T09:05:14.736+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T09:05:14.738+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:05:14.738+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T09:05:14.832+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:05:14.832+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T09:05:19.179+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:05:19.178+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 4.316692401000182
[2024-11-21T09:05:19.180+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:05:19.180+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T09:05:19.182+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:05:19.181+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T09:05:19.202+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:05:19.202+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T09:05:19.219+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:05:19.218+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T09:05:19.248+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:05:19.247+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmprjjd81go --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T09:05:26.662+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:05:26.661+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmprjjd81go --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T09:05:41.631+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:05:41.617+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 203, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmprjjd81go', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
09:05:32  Running with dbt=1.8.7
09:05:36  Registered adapter: bigquery=1.8.3
09:05:38  [WARNING]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
09:05:39  Encountered an error:
Compilation Error
  dbt found two data_tests with the name "unique_fct_trips_trip_id" defined on column "trip_id" in "models.fct_trips".
  
  Since these resources have the same name, dbt will be unable to find the correct resource
  when running tests.
  
  To fix this, change the name of one of these resources:
  - test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab (models/tests/schema.yml)
  - test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab (models/tests/schema.yml)
[2024-11-21T09:05:41.634+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T09:05:41.666+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 28.848 seconds
[2024-11-21T09:06:12.655+0000] {processor.py:161} INFO - Started process (PID=5247) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T09:06:12.657+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T09:06:12.659+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:06:12.658+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T09:06:12.760+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:06:12.759+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T09:06:17.173+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:06:17.172+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 4.381237822000912
[2024-11-21T09:06:17.174+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:06:17.174+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T09:06:17.175+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:06:17.175+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T09:06:17.198+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:06:17.198+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T09:06:17.215+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:06:17.214+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T09:06:17.243+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:06:17.242+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpni024d6f --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T09:06:24.915+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:06:24.913+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpni024d6f --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T09:06:40.819+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:06:40.818+0000] {timeout.py:68} ERROR - Process timed out, PID: 5247
[2024-11-21T09:07:11.358+0000] {processor.py:161} INFO - Started process (PID=5299) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T09:07:11.360+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T09:07:11.363+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:07:11.362+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T09:07:11.472+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:07:11.472+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T09:07:13.828+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:07:13.828+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 4.218391751001036
[2024-11-21T09:07:13.830+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:07:13.829+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T09:07:13.831+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:07:13.831+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T09:07:13.847+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:07:13.846+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T09:07:13.863+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:07:13.862+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T09:07:13.890+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:07:13.890+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmplzoubdw8 --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T09:07:23.399+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:07:23.398+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmplzoubdw8 --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T09:07:39.089+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:07:39.035+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 203, in <module>
    source_format="PARQUET",
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmplzoubdw8', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
09:07:29  Running with dbt=1.8.7
09:07:33  Registered adapter: bigquery=1.8.3
09:07:36  [WARNING]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
09:07:36  Encountered an error:
Compilation Error
  dbt found two data_tests with the name "unique_fct_trips_trip_id" defined on column "trip_id" in "models.fct_trips".
  
  Since these resources have the same name, dbt will be unable to find the correct resource
  when running tests.
  
  To fix this, change the name of one of these resources:
  - test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab (models/tests/schema.yml)
  - test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab (models/tests/schema.yml)
[2024-11-21T09:07:39.092+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T09:07:39.121+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 29.673 seconds
[2024-11-21T09:08:09.899+0000] {processor.py:161} INFO - Started process (PID=5352) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T09:08:09.901+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T09:08:09.903+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:08:09.903+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T09:08:09.326+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:08:09.325+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T09:08:12.429+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:08:12.428+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 4.309769270999823
[2024-11-21T09:08:12.431+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:08:12.430+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T09:08:12.432+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:08:12.432+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T09:08:12.447+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:08:12.446+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T09:08:12.470+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:08:12.470+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T09:08:12.493+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:08:12.492+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp8o5hqv90 --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T09:08:22.580+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:08:22.579+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp8o5hqv90 --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T09:08:37.309+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:08:37.308+0000] {timeout.py:68} ERROR - Process timed out, PID: 5352
[2024-11-21T09:09:07.984+0000] {processor.py:161} INFO - Started process (PID=5409) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T09:09:07.990+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T09:09:08.002+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:09:08.000+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T09:09:08.208+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:09:08.207+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T09:09:12.638+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:09:12.637+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 4.400814000000537
[2024-11-21T09:09:12.640+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:09:12.639+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T09:09:12.641+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:09:12.641+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T09:09:12.659+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:09:12.659+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T09:09:12.675+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:09:12.674+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T09:09:12.702+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:09:12.702+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpy6wl9arw --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T09:09:22.390+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:09:22.388+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpy6wl9arw --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T09:09:36.157+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:09:36.155+0000] {timeout.py:68} ERROR - Process timed out, PID: 5409
[2024-11-21T09:10:07.077+0000] {processor.py:161} INFO - Started process (PID=5459) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T09:10:07.081+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T09:10:07.083+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:10:07.083+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T09:10:07.164+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:10:07.163+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T09:10:11.204+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:10:11.204+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 4.0079060640000534
[2024-11-21T09:10:11.205+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:10:11.205+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T09:10:11.207+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:10:11.206+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T09:10:11.219+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:10:11.218+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T09:10:11.241+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:10:11.240+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T09:10:11.266+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:10:11.265+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmphwmfq617 --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T09:10:21.152+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:10:21.149+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmphwmfq617 --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T09:10:34.738+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:10:34.725+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 210, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmphwmfq617', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
09:10:27  Running with dbt=1.8.7
09:10:29  Registered adapter: bigquery=1.8.3
09:10:31  [WARNING]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
09:10:31  Encountered an error:
Compilation Error
  dbt found two data_tests with the name "unique_fct_trips_trip_id" defined on column "trip_id" in "models.fct_trips".
  
  Since these resources have the same name, dbt will be unable to find the correct resource
  when running tests.
  
  To fix this, change the name of one of these resources:
  - test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab (models/tests/schema.yml)
  - test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab (models/tests/schema.yml)
[2024-11-21T09:10:34.741+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T09:10:34.776+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 29.632 seconds
[2024-11-21T09:11:05.528+0000] {processor.py:161} INFO - Started process (PID=5511) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T09:11:05.531+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T09:11:05.533+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:11:05.532+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T09:11:05.646+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:11:05.645+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T09:11:09.930+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:11:09.929+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 4.2528449410001485
[2024-11-21T09:11:09.931+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:11:09.931+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T09:11:09.932+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:11:09.932+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T09:11:09.951+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:11:09.951+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T09:11:09.969+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:11:09.968+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T09:11:09.995+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:11:09.995+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpwxqrb7pc --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T09:11:19.586+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:11:19.585+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpwxqrb7pc --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T09:11:33.804+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:11:33.803+0000] {timeout.py:68} ERROR - Process timed out, PID: 5511
[2024-11-21T09:12:04.770+0000] {processor.py:161} INFO - Started process (PID=5563) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T09:12:04.772+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T09:12:04.775+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:12:04.774+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T09:12:04.893+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:12:04.893+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T09:12:08.636+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:12:08.636+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 3.7117525009998644
[2024-11-21T09:12:08.638+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:12:08.637+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T09:12:08.639+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:12:08.639+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T09:12:08.660+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:12:08.660+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T09:12:08.677+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:12:08.677+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T09:12:08.708+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:12:08.707+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp4bz1bf0q --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T09:12:18.370+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:12:18.369+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp4bz1bf0q --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T09:12:31.885+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:12:31.871+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 210, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmp4bz1bf0q', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
09:12:22  Running with dbt=1.8.7
09:12:26  Registered adapter: bigquery=1.8.3
09:12:28  [WARNING]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
09:12:28  Encountered an error:
Compilation Error
  dbt found two data_tests with the name "unique_fct_trips_trip_id" defined on column "trip_id" in "models.fct_trips".
  
  Since these resources have the same name, dbt will be unable to find the correct resource
  when running tests.
  
  To fix this, change the name of one of these resources:
  - test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab (models/tests/schema.yml)
  - test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab (models/tests/schema.yml)
[2024-11-21T09:12:31.887+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T09:12:31.912+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 29.112 seconds
[2024-11-21T09:13:02.645+0000] {processor.py:161} INFO - Started process (PID=5615) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T09:13:02.649+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T09:13:02.651+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:13:02.650+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T09:13:02.766+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:13:02.766+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T09:13:07.316+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:13:07.315+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 4.517755557000783
[2024-11-21T09:13:07.317+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:13:07.317+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T09:13:07.318+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:13:07.318+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T09:13:07.339+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:13:07.339+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T09:13:07.355+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:13:07.355+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T09:13:07.385+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:13:07.384+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpgilnmbaz --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T09:13:16.471+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:13:16.469+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpgilnmbaz --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T09:13:30.375+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:13:30.362+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 210, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpgilnmbaz', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
09:13:20  Running with dbt=1.8.7
09:13:24  Registered adapter: bigquery=1.8.3
09:13:27  [WARNING]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
09:13:27  Encountered an error:
Compilation Error
  dbt found two data_tests with the name "unique_fct_trips_trip_id" defined on column "trip_id" in "models.fct_trips".
  
  Since these resources have the same name, dbt will be unable to find the correct resource
  when running tests.
  
  To fix this, change the name of one of these resources:
  - test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab (models/tests/schema.yml)
  - test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab (models/tests/schema.yml)
[2024-11-21T09:13:30.377+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T09:13:30.409+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 29.757 seconds
[2024-11-21T09:14:01.235+0000] {processor.py:161} INFO - Started process (PID=5667) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T09:14:01.237+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T09:14:01.240+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:14:01.239+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T09:14:01.347+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:14:01.347+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T09:14:05.754+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:14:05.754+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 4.374884491000557
[2024-11-21T09:14:05.755+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:14:05.755+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T09:14:05.757+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:14:05.757+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T09:14:05.776+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:14:05.776+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T09:14:05.791+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:14:05.791+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T09:14:05.820+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:14:05.820+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpfwvrro7v --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T09:14:14.790+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:14:14.789+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpfwvrro7v --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T09:14:27.777+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:14:27.767+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 210, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpfwvrro7v', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
09:14:18  Running with dbt=1.8.7
09:14:22  Registered adapter: bigquery=1.8.3
09:14:24  [WARNING]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
09:14:24  Encountered an error:
Compilation Error
  dbt found two data_tests with the name "unique_fct_trips_trip_id" defined on column "trip_id" in "models.fct_trips".
  
  Since these resources have the same name, dbt will be unable to find the correct resource
  when running tests.
  
  To fix this, change the name of one of these resources:
  - test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab (models/tests/schema.yml)
  - test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab (models/tests/schema.yml)
[2024-11-21T09:14:27.779+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T09:14:27.800+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 28.577 seconds
[2024-11-21T09:14:58.678+0000] {processor.py:161} INFO - Started process (PID=5719) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T09:14:58.680+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T09:14:58.683+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:14:58.682+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T09:14:58.786+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:14:58.786+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T09:15:03.212+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:15:03.211+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 4.392017019999912
[2024-11-21T09:15:03.213+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:15:03.213+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T09:15:03.214+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:15:03.214+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T09:15:03.234+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:15:03.233+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T09:15:03.248+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:15:03.248+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T09:15:03.278+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:15:03.277+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpfvu59zw6 --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T09:15:11.196+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:15:11.195+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpfvu59zw6 --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T09:15:26.556+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:15:26.541+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 210, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpfvu59zw6', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
09:15:17  Running with dbt=1.8.7
09:15:20  Registered adapter: bigquery=1.8.3
09:15:23  [WARNING]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
09:15:23  Encountered an error:
Compilation Error
  dbt found two data_tests with the name "unique_fct_trips_trip_id" defined on column "trip_id" in "models.fct_trips".
  
  Since these resources have the same name, dbt will be unable to find the correct resource
  when running tests.
  
  To fix this, change the name of one of these resources:
  - test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab (models/tests/schema.yml)
  - test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab (models/tests/schema.yml)
[2024-11-21T09:15:26.559+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T09:15:26.590+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 29.836 seconds
[2024-11-21T09:15:57.266+0000] {processor.py:161} INFO - Started process (PID=5772) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T09:15:57.268+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T09:15:57.271+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:15:57.270+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T09:15:57.384+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:15:57.384+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T09:16:01.395+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:16:01.394+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 3.9796639239993965
[2024-11-21T09:16:01.396+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:16:01.396+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T09:16:01.397+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:16:01.397+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T09:16:01.418+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:16:01.418+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T09:16:01.435+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:16:01.434+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T09:16:01.462+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:16:01.461+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp8m56phew --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T09:16:08.767+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:16:08.766+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp8m56phew --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T09:16:23.831+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:16:23.819+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 210, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmp8m56phew', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
09:16:14  Running with dbt=1.8.7
09:16:18  Registered adapter: bigquery=1.8.3
09:16:20  [WARNING]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
09:16:20  Encountered an error:
Compilation Error
  dbt found two data_tests with the name "unique_fct_trips_trip_id" defined on column "trip_id" in "models.fct_trips".
  
  Since these resources have the same name, dbt will be unable to find the correct resource
  when running tests.
  
  To fix this, change the name of one of these resources:
  - test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab (models/tests/schema.yml)
  - test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab (models/tests/schema.yml)
[2024-11-21T09:16:23.833+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T09:16:23.860+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 28.503 seconds
[2024-11-21T09:16:53.981+0000] {processor.py:161} INFO - Started process (PID=5824) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T09:16:53.983+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T09:16:53.985+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:16:53.984+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T09:16:54.095+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:16:54.095+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T09:16:58.423+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:16:58.422+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 4.2963460800001485
[2024-11-21T09:16:58.424+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:16:58.423+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T09:16:58.425+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:16:58.425+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T09:16:58.438+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:16:58.438+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T09:16:58.455+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:16:58.455+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T09:16:58.475+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:16:58.475+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp4g6bb0w9 --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T09:17:06.563+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:17:06.562+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp4g6bb0w9 --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T09:17:22.116+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:17:22.115+0000] {timeout.py:68} ERROR - Process timed out, PID: 5824
[2024-11-21T09:17:52.414+0000] {processor.py:161} INFO - Started process (PID=5875) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T09:17:52.417+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T09:17:52.419+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:17:52.418+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T09:17:52.532+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:17:52.531+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T09:17:56.946+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:17:56.946+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 4.384466331999647
[2024-11-21T09:17:56.948+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:17:56.947+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T09:17:56.949+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:17:56.949+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T09:17:56.972+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:17:56.972+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T09:17:56.990+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:17:56.990+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T09:17:57.020+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:17:57.019+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp98fgmxks --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T09:18:04.216+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:18:04.215+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp98fgmxks --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T09:18:19.154+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:18:19.141+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 210, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmp98fgmxks', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
09:18:09  Running with dbt=1.8.7
09:18:13  Registered adapter: bigquery=1.8.3
09:18:16  [WARNING]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
09:18:16  Encountered an error:
Compilation Error
  dbt found two data_tests with the name "unique_fct_trips_trip_id" defined on column "trip_id" in "models.fct_trips".
  
  Since these resources have the same name, dbt will be unable to find the correct resource
  when running tests.
  
  To fix this, change the name of one of these resources:
  - test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab (models/tests/schema.yml)
  - test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab (models/tests/schema.yml)
[2024-11-21T09:18:19.156+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T09:18:19.189+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 28.772 seconds
[2024-11-21T09:18:50.084+0000] {processor.py:161} INFO - Started process (PID=5926) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T09:18:50.087+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T09:18:50.090+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:18:50.089+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T09:18:50.187+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:18:50.187+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T09:18:54.087+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:18:54.086+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 3.8679433159995824
[2024-11-21T09:18:54.088+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:18:54.088+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T09:18:54.090+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:18:54.089+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T09:18:54.109+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:18:54.109+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T09:18:54.130+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:18:54.130+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T09:18:54.158+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:18:54.157+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp1m8ft3un --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T09:19:02.538+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:19:02.536+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp1m8ft3un --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T09:19:17.723+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:19:17.709+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 210, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmp1m8ft3un', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
09:19:08  Running with dbt=1.8.7
09:19:11  Registered adapter: bigquery=1.8.3
09:19:14  [WARNING]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
09:19:14  Encountered an error:
Compilation Error
  dbt found two data_tests with the name "unique_fct_trips_trip_id" defined on column "trip_id" in "models.fct_trips".
  
  Since these resources have the same name, dbt will be unable to find the correct resource
  when running tests.
  
  To fix this, change the name of one of these resources:
  - test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab (models/tests/schema.yml)
  - test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab (models/tests/schema.yml)
[2024-11-21T09:19:17.725+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T09:19:17.758+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 29.745 seconds
[2024-11-21T09:19:48.718+0000] {processor.py:161} INFO - Started process (PID=5978) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T09:19:48.720+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T09:19:48.723+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:19:48.722+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T09:19:48.817+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:19:48.817+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T09:19:51.260+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:19:51.259+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 4.382064763000017
[2024-11-21T09:19:51.261+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:19:51.261+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T09:19:51.262+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:19:51.262+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T09:19:51.279+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:19:51.278+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T09:19:51.295+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:19:51.294+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T09:19:51.321+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:19:51.320+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpgkykvxmt --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T09:20:00.494+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:20:00.493+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpgkykvxmt --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T09:20:15.848+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:20:15.834+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 210, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpgkykvxmt', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
09:20:06  Running with dbt=1.8.7
09:20:10  Registered adapter: bigquery=1.8.3
09:20:12  [WARNING]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
09:20:13  Encountered an error:
Compilation Error
  dbt found two data_tests with the name "unique_fct_trips_trip_id" defined on column "trip_id" in "models.fct_trips".
  
  Since these resources have the same name, dbt will be unable to find the correct resource
  when running tests.
  
  To fix this, change the name of one of these resources:
  - test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab (models/tests/schema.yml)
  - test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab (models/tests/schema.yml)
[2024-11-21T09:20:15.850+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T09:20:15.884+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 29.153 seconds
[2024-11-21T09:20:46.833+0000] {processor.py:161} INFO - Started process (PID=6030) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T09:20:46.835+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T09:20:46.838+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:20:46.837+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T09:20:46.924+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:20:46.924+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T09:20:48.853+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:20:48.852+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 3.8493461210000532
[2024-11-21T09:20:48.854+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:20:48.854+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T09:20:48.855+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:20:48.855+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T09:20:48.868+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:20:48.868+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T09:20:48.884+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:20:48.883+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T09:20:48.906+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:20:48.905+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp7coa8a7z --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T09:20:58.587+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:20:58.585+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp7coa8a7z --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T09:21:13.600+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:21:13.586+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 210, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmp7coa8a7z', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
09:21:04  Running with dbt=1.8.7
09:21:07  Registered adapter: bigquery=1.8.3
09:21:10  [WARNING]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
09:21:10  Encountered an error:
Compilation Error
  dbt found two data_tests with the name "unique_fct_trips_trip_id" defined on column "trip_id" in "models.fct_trips".
  
  Since these resources have the same name, dbt will be unable to find the correct resource
  when running tests.
  
  To fix this, change the name of one of these resources:
  - test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab (models/tests/schema.yml)
  - test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab (models/tests/schema.yml)
[2024-11-21T09:21:13.602+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T09:21:13.626+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 28.758 seconds
[2024-11-21T09:21:44.341+0000] {processor.py:161} INFO - Started process (PID=6082) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T09:21:44.343+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T09:21:44.346+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:21:44.345+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T09:21:44.454+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:21:44.453+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T09:21:48.765+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:21:48.765+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 4.276101462000952
[2024-11-21T09:21:48.767+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:21:48.766+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T09:21:48.768+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:21:48.768+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T09:21:48.789+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:21:48.788+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T09:21:48.805+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:21:48.805+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T09:21:48.836+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:21:48.836+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpwlikruvf --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T09:21:58.220+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:21:58.219+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpwlikruvf --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T09:22:12.476+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:22:12.475+0000] {timeout.py:68} ERROR - Process timed out, PID: 6082
[2024-11-21T09:22:43.317+0000] {processor.py:161} INFO - Started process (PID=6134) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T09:22:43.321+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T09:22:43.326+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:22:43.325+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T09:22:43.413+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:22:43.413+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T09:22:47.767+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:22:47.766+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 4.32363263499974
[2024-11-21T09:22:47.768+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:22:47.768+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T09:22:47.769+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:22:47.769+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T09:22:47.791+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:22:47.790+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T09:22:47.806+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:22:47.805+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T09:22:47.834+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:22:47.834+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp4a4ps66i --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T09:22:57.127+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:22:57.126+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp4a4ps66i --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T09:23:10.295+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:23:10.270+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 210, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmp4a4ps66i', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
09:23:03  Running with dbt=1.8.7
09:23:06  Registered adapter: bigquery=1.8.3
09:23:07  [WARNING]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
09:23:07  Encountered an error:
Compilation Error
  dbt found two data_tests with the name "unique_fct_trips_trip_id" defined on column "trip_id" in "models.fct_trips".
  
  Since these resources have the same name, dbt will be unable to find the correct resource
  when running tests.
  
  To fix this, change the name of one of these resources:
  - test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab (models/tests/schema.yml)
  - test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab (models/tests/schema.yml)
[2024-11-21T09:23:10.297+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T09:23:10.347+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 29.089 seconds
[2024-11-21T09:23:40.622+0000] {processor.py:161} INFO - Started process (PID=6192) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T09:23:40.625+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T09:23:40.628+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:23:40.627+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T09:23:40.741+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:23:40.740+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T09:23:45.052+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:23:45.051+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 4.279749287001323
[2024-11-21T09:23:45.053+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:23:45.053+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T09:23:45.054+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:23:45.054+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T09:23:45.067+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:23:45.067+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T09:23:45.088+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:23:45.087+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T09:23:45.117+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:23:45.116+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp8qfsncwu --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T09:23:55.097+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:23:55.096+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp8qfsncwu --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T09:24:08.690+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:24:08.689+0000] {timeout.py:68} ERROR - Process timed out, PID: 6192
[2024-11-21T09:24:39.589+0000] {processor.py:161} INFO - Started process (PID=6244) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T09:24:39.592+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T09:24:39.596+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:24:39.594+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T09:24:39.812+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:24:39.811+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T09:24:44.040+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:24:44.040+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 4.146759253999335
[2024-11-21T09:24:44.041+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:24:44.041+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T09:24:44.043+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:24:44.042+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T09:24:44.061+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:24:44.061+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T09:24:44.076+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:24:44.076+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T09:24:44.106+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:24:44.105+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp5m0apsvq --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T09:24:54.213+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:24:54.212+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp5m0apsvq --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T09:25:07.688+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:25:07.687+0000] {timeout.py:68} ERROR - Process timed out, PID: 6244
[2024-11-21T09:25:38.642+0000] {processor.py:161} INFO - Started process (PID=6296) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T09:25:38.645+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T09:25:38.647+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:25:38.647+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T09:25:38.754+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:25:38.753+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T09:25:42.685+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:25:42.684+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 3.8974033659997076
[2024-11-21T09:25:42.686+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:25:42.686+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T09:25:42.688+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:25:42.688+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T09:25:42.705+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:25:42.705+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T09:25:42.727+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:25:42.726+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T09:25:42.765+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:25:42.764+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpd1ua9m0n --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T09:25:53.113+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:25:53.111+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpd1ua9m0n --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T09:26:06.680+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:26:06.678+0000] {timeout.py:68} ERROR - Process timed out, PID: 6296
[2024-11-21T09:26:37.620+0000] {processor.py:161} INFO - Started process (PID=6349) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T09:26:37.623+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T09:26:37.626+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:26:37.625+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T09:26:37.751+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:26:37.750+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T09:26:42.152+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:26:42.152+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 4.359826537000117
[2024-11-21T09:26:42.154+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:26:42.153+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T09:26:42.155+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:26:42.155+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T09:26:42.175+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:26:42.175+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T09:26:42.191+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:26:42.191+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T09:26:42.220+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:26:42.219+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp3z27vmxs --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T09:26:50.958+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:26:50.957+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp3z27vmxs --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T09:27:05.658+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:27:05.657+0000] {timeout.py:68} ERROR - Process timed out, PID: 6349
[2024-11-21T09:27:36.412+0000] {processor.py:161} INFO - Started process (PID=6401) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T09:27:36.414+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T09:27:36.416+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:27:36.416+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T09:27:36.508+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:27:36.507+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T09:27:40.416+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:27:40.415+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 3.8789307110000664
[2024-11-21T09:27:40.418+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:27:40.417+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T09:27:40.420+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:27:40.419+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T09:27:40.441+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:27:40.440+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T09:27:40.458+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:27:40.458+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T09:27:40.488+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:27:40.487+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpet7boje3 --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T09:27:48.234+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:27:48.233+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpet7boje3 --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T09:28:03.805+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:28:03.791+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 210, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpet7boje3', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
09:27:54  Running with dbt=1.8.7
09:27:58  Registered adapter: bigquery=1.8.3
09:28:00  [WARNING]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
09:28:01  Encountered an error:
Compilation Error
  dbt found two data_tests with the name "unique_fct_trips_trip_id" defined on column "trip_id" in "models.fct_trips".
  
  Since these resources have the same name, dbt will be unable to find the correct resource
  when running tests.
  
  To fix this, change the name of one of these resources:
  - test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab (models/tests/schema.yml)
  - test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab (models/tests/schema.yml)
[2024-11-21T09:28:03.807+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T09:28:03.846+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 29.519 seconds
[2024-11-21T09:28:34.748+0000] {processor.py:161} INFO - Started process (PID=6453) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T09:28:34.751+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T09:28:34.754+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:28:34.753+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T09:28:34.865+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:28:34.865+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T09:28:39.250+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:28:39.249+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 4.353981484000542
[2024-11-21T09:28:39.252+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:28:39.251+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T09:28:39.253+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:28:39.253+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T09:28:39.274+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:28:39.274+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T09:28:39.292+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:28:39.291+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T09:28:39.323+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:28:39.323+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp6uwnkpzr --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T09:28:46.953+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:28:46.952+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp6uwnkpzr --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T09:29:02.684+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:29:02.682+0000] {timeout.py:68} ERROR - Process timed out, PID: 6453
[2024-11-21T09:29:33.222+0000] {processor.py:161} INFO - Started process (PID=6505) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T09:29:33.224+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T09:29:33.227+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:29:33.226+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T09:29:33.315+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:29:33.314+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T09:29:37.400+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:29:37.400+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 4.058231189999788
[2024-11-21T09:29:37.404+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:29:37.403+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T09:29:37.405+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:29:37.405+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T09:29:37.423+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:29:37.423+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T09:29:37.439+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:29:37.439+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T09:29:37.468+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:29:37.467+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmprmh8dd7j --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T09:29:44.927+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:29:44.926+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmprmh8dd7j --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T09:29:59.867+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:29:59.854+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 210, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmprmh8dd7j', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
09:29:50  Running with dbt=1.8.7
09:29:54  Registered adapter: bigquery=1.8.3
09:29:56  [WARNING]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
09:29:57  Encountered an error:
Compilation Error
  dbt found two data_tests with the name "unique_fct_trips_trip_id" defined on column "trip_id" in "models.fct_trips".
  
  Since these resources have the same name, dbt will be unable to find the correct resource
  when running tests.
  
  To fix this, change the name of one of these resources:
  - test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab (models/tests/schema.yml)
  - test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab (models/tests/schema.yml)
[2024-11-21T09:29:59.869+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T09:29:59.892+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 28.738 seconds
[2024-11-21T09:30:30.786+0000] {processor.py:161} INFO - Started process (PID=6558) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T09:30:30.788+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T09:30:30.791+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:30:30.790+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T09:30:30.893+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:30:30.892+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T09:30:35.309+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:30:35.309+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 4.382585756999106
[2024-11-21T09:30:35.311+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:30:35.310+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T09:30:35.312+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:30:35.312+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T09:30:35.331+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:30:35.330+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T09:30:35.347+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:30:35.347+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T09:30:35.377+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:30:35.377+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpdieaix_z --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T09:30:42.905+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:30:42.904+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpdieaix_z --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T09:30:58.859+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:30:58.858+0000] {timeout.py:68} ERROR - Process timed out, PID: 6558
[2024-11-21T09:31:29.217+0000] {processor.py:161} INFO - Started process (PID=6610) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T09:31:29.220+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T09:31:29.222+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:31:29.222+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T09:31:29.327+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:31:29.326+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T09:31:31.772+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:31:31.771+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 4.403778939000404
[2024-11-21T09:31:31.773+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:31:31.772+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T09:31:31.774+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:31:31.774+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T09:31:31.795+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:31:31.794+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T09:31:31.817+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:31:31.816+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T09:31:31.842+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:31:31.841+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp8fzd9ftq --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T09:31:41.640+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:31:41.639+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp8fzd9ftq --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T09:31:57.258+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:31:57.257+0000] {timeout.py:68} ERROR - Process timed out, PID: 6610
[2024-11-21T09:32:27.640+0000] {processor.py:161} INFO - Started process (PID=6662) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T09:32:27.642+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T09:32:27.644+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:32:27.644+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T09:32:27.757+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:32:27.757+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T09:32:32.069+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:32:32.068+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 4.279795942999044
[2024-11-21T09:32:32.071+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:32:32.070+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T09:32:32.072+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:32:32.072+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T09:32:32.091+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:32:32.090+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T09:32:32.107+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:32:32.106+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T09:32:32.128+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:32:32.128+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpg8z9d_z6 --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T09:32:43.465+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:32:43.464+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpg8z9d_z6 --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T09:32:55.604+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:32:55.602+0000] {timeout.py:68} ERROR - Process timed out, PID: 6662
[2024-11-21T09:33:26.589+0000] {processor.py:161} INFO - Started process (PID=6714) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T09:33:26.591+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T09:33:26.593+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:33:26.593+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T09:33:26.697+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:33:26.697+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T09:33:31.300+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:33:31.299+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 4.570477290000781
[2024-11-21T09:33:31.301+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:33:31.301+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T09:33:31.302+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:33:31.302+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T09:33:31.321+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:33:31.321+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T09:33:31.338+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:33:31.338+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T09:33:31.364+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:33:31.363+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp8ppts9om --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T09:33:40.918+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:33:40.917+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp8ppts9om --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T09:33:54.564+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:33:54.562+0000] {timeout.py:68} ERROR - Process timed out, PID: 6714
[2024-11-21T09:34:24.963+0000] {processor.py:161} INFO - Started process (PID=6766) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T09:34:24.967+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T09:34:24.970+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:34:24.969+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T09:34:25.074+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:34:25.073+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T09:34:29.114+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:34:29.113+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 4.011046562000047
[2024-11-21T09:34:29.115+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:34:29.115+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T09:34:29.116+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:34:29.116+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T09:34:29.134+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:34:29.134+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T09:34:29.150+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:34:29.149+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T09:34:29.175+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:34:29.174+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp2zbn46g2 --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T09:34:39.640+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:34:39.639+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp2zbn46g2 --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T09:34:52.920+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:34:52.919+0000] {timeout.py:68} ERROR - Process timed out, PID: 6766
[2024-11-21T09:35:23.559+0000] {processor.py:161} INFO - Started process (PID=6824) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T09:35:23.562+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T09:35:23.564+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:35:23.563+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T09:35:23.680+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:35:23.679+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T09:35:28.040+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:35:28.040+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 4.329482559000098
[2024-11-21T09:35:28.042+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:35:28.041+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T09:35:28.043+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:35:28.043+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T09:35:28.062+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:35:28.062+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T09:35:28.077+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:35:28.077+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T09:35:28.106+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:35:28.105+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpm96b6ndx --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T09:35:37.300+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:35:37.298+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpm96b6ndx --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T09:35:51.388+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:35:51.374+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 210, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpm96b6ndx', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
09:35:42  Running with dbt=1.8.7
09:35:45  Registered adapter: bigquery=1.8.3
09:35:48  [WARNING]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
09:35:48  Encountered an error:
Compilation Error
  dbt found two data_tests with the name "unique_fct_trips_trip_id" defined on column "trip_id" in "models.fct_trips".
  
  Since these resources have the same name, dbt will be unable to find the correct resource
  when running tests.
  
  To fix this, change the name of one of these resources:
  - test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab (models/tests/schema.yml)
  - test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab (models/tests/schema.yml)
[2024-11-21T09:35:51.390+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T09:35:51.421+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 29.915 seconds
[2024-11-21T09:36:22.226+0000] {processor.py:161} INFO - Started process (PID=6876) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T09:36:22.228+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T09:36:22.231+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:36:22.231+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T09:36:22.331+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:36:22.330+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T09:36:26.180+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:36:26.179+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 3.8149449979991914
[2024-11-21T09:36:26.181+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:36:26.181+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T09:36:26.182+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:36:26.182+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T09:36:26.195+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:36:26.195+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T09:36:26.213+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:36:26.212+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T09:36:26.240+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:36:26.239+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp4ertxj1v --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T09:36:35.653+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:36:35.651+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp4ertxj1v --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T09:36:48.932+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:36:48.917+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 210, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmp4ertxj1v', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
09:36:39  Running with dbt=1.8.7
09:36:43  Registered adapter: bigquery=1.8.3
09:36:45  [WARNING]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
09:36:46  Encountered an error:
Compilation Error
  dbt found two data_tests with the name "unique_fct_trips_trip_id" defined on column "trip_id" in "models.fct_trips".
  
  Since these resources have the same name, dbt will be unable to find the correct resource
  when running tests.
  
  To fix this, change the name of one of these resources:
  - test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab (models/tests/schema.yml)
  - test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab (models/tests/schema.yml)
[2024-11-21T09:36:48.934+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T09:36:48.961+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 28.836 seconds
[2024-11-21T09:37:20.039+0000] {processor.py:161} INFO - Started process (PID=6927) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T09:37:20.042+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T09:37:20.045+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:37:20.044+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T09:37:20.141+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:37:20.140+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T09:37:24.567+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:37:24.566+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 4.3953522110005
[2024-11-21T09:37:24.568+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:37:24.568+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T09:37:24.569+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:37:24.569+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T09:37:24.589+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:37:24.589+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T09:37:24.604+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:37:24.604+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T09:37:24.632+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:37:24.632+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpap3pw3e6 --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T09:37:33.928+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:37:33.927+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpap3pw3e6 --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T09:37:47.894+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:37:47.879+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 210, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpap3pw3e6', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
09:37:38  Running with dbt=1.8.7
09:37:42  Registered adapter: bigquery=1.8.3
09:37:44  [WARNING]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
09:37:45  Encountered an error:
Compilation Error
  dbt found two data_tests with the name "unique_fct_trips_trip_id" defined on column "trip_id" in "models.fct_trips".
  
  Since these resources have the same name, dbt will be unable to find the correct resource
  when running tests.
  
  To fix this, change the name of one of these resources:
  - test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab (models/tests/schema.yml)
  - test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab (models/tests/schema.yml)
[2024-11-21T09:37:47.897+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T09:37:47.933+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 30.014 seconds
[2024-11-21T09:38:18.405+0000] {processor.py:161} INFO - Started process (PID=6979) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T09:38:18.407+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T09:38:18.409+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:38:18.409+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T09:38:18.502+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:38:18.502+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T09:38:22.856+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:38:22.855+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 4.322115646999009
[2024-11-21T09:38:22.857+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:38:22.857+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T09:38:22.859+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:38:22.858+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T09:38:22.877+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:38:22.876+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T09:38:22.894+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:38:22.894+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T09:38:22.921+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:38:22.921+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp6bnumvgz --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T09:38:29.982+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:38:29.981+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp6bnumvgz --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T09:38:45.384+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:38:45.372+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 210, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmp6bnumvgz', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
09:38:35  Running with dbt=1.8.7
09:38:39  Registered adapter: bigquery=1.8.3
09:38:41  [WARNING]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
09:38:42  Encountered an error:
Compilation Error
  dbt found two data_tests with the name "unique_fct_trips_trip_id" defined on column "trip_id" in "models.fct_trips".
  
  Since these resources have the same name, dbt will be unable to find the correct resource
  when running tests.
  
  To fix this, change the name of one of these resources:
  - test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab (models/tests/schema.yml)
  - test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab (models/tests/schema.yml)
[2024-11-21T09:38:45.387+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T09:38:45.442+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 29.091 seconds
[2024-11-21T09:39:15.660+0000] {processor.py:161} INFO - Started process (PID=7031) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T09:39:15.662+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T09:39:15.664+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:39:15.664+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T09:39:15.778+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:39:15.778+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T09:39:20.235+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:39:20.235+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 4.4269295030007925
[2024-11-21T09:39:20.236+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:39:20.236+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T09:39:20.237+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:39:20.237+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T09:39:20.257+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:39:20.257+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T09:39:20.272+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:39:20.272+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T09:39:20.299+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:39:20.298+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpyk070sdg --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T09:39:28.322+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:39:28.321+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpyk070sdg --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T09:39:43.826+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:39:43.814+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 210, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpyk070sdg', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
09:39:34  Running with dbt=1.8.7
09:39:38  Registered adapter: bigquery=1.8.3
09:39:40  [WARNING]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
09:39:41  Encountered an error:
Compilation Error
  dbt found two data_tests with the name "unique_fct_trips_trip_id" defined on column "trip_id" in "models.fct_trips".
  
  Since these resources have the same name, dbt will be unable to find the correct resource
  when running tests.
  
  To fix this, change the name of one of these resources:
  - test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab (models/tests/schema.yml)
  - test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab (models/tests/schema.yml)
[2024-11-21T09:39:43.828+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T09:39:43.859+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 30.063 seconds
[2024-11-21T09:40:14.538+0000] {processor.py:161} INFO - Started process (PID=7083) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T09:40:14.541+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T09:40:14.543+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:40:14.543+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T09:40:14.655+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:40:14.655+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T09:40:18.688+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:40:18.687+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 4.002012179000303
[2024-11-21T09:40:18.689+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:40:18.689+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T09:40:18.690+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:40:18.690+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T09:40:18.707+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:40:18.706+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T09:40:18.722+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:40:18.721+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T09:40:18.746+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:40:18.746+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpjj465vb8 --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T09:40:25.948+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:40:25.946+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpjj465vb8 --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T09:40:40.874+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:40:40.864+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 210, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpjj465vb8', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
09:40:31  Running with dbt=1.8.7
09:40:35  Registered adapter: bigquery=1.8.3
09:40:37  [WARNING]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
09:40:38  Encountered an error:
Compilation Error
  dbt found two data_tests with the name "unique_fct_trips_trip_id" defined on column "trip_id" in "models.fct_trips".
  
  Since these resources have the same name, dbt will be unable to find the correct resource
  when running tests.
  
  To fix this, change the name of one of these resources:
  - test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab (models/tests/schema.yml)
  - test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab (models/tests/schema.yml)
[2024-11-21T09:40:40.877+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T09:40:40.900+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 28.384 seconds
[2024-11-21T09:41:11.853+0000] {processor.py:161} INFO - Started process (PID=7135) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T09:41:11.856+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T09:41:11.859+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:41:11.858+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T09:41:11.973+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:41:11.973+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T09:41:16.244+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:41:16.243+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 4.236466598000334
[2024-11-21T09:41:16.245+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:41:16.245+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T09:41:16.246+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:41:16.246+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T09:41:16.264+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:41:16.263+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T09:41:16.280+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:41:16.280+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T09:41:16.306+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:41:16.305+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp_o9vrine --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T09:41:24.539+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:41:24.538+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp_o9vrine --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T09:41:39.855+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:41:39.853+0000] {timeout.py:68} ERROR - Process timed out, PID: 7135
[2024-11-21T09:42:10.046+0000] {processor.py:161} INFO - Started process (PID=7187) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T09:42:10.049+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T09:42:10.051+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:42:10.050+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T09:42:10.168+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:42:10.167+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T09:42:14.520+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:42:14.520+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 4.320446671999889
[2024-11-21T09:42:14.522+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:42:14.521+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T09:42:14.523+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:42:14.523+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T09:42:13.793+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:42:13.793+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T09:42:13.809+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:42:13.809+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T09:42:13.837+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:42:13.836+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp9ts56xne --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T09:42:21.759+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:42:21.758+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp9ts56xne --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T09:42:37.113+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:42:37.099+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 210, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmp9ts56xne', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
09:42:27  Running with dbt=1.8.7
09:42:31  Registered adapter: bigquery=1.8.3
09:42:33  [WARNING]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
09:42:34  Encountered an error:
Compilation Error
  dbt found two data_tests with the name "unique_fct_trips_trip_id" defined on column "trip_id" in "models.fct_trips".
  
  Since these resources have the same name, dbt will be unable to find the correct resource
  when running tests.
  
  To fix this, change the name of one of these resources:
  - test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab (models/tests/schema.yml)
  - test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab (models/tests/schema.yml)
[2024-11-21T09:42:37.114+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T09:42:37.140+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 29.147 seconds
[2024-11-21T09:43:07.702+0000] {processor.py:161} INFO - Started process (PID=7239) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T09:43:07.704+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T09:43:07.707+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:43:07.706+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T09:43:07.805+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:43:07.804+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T09:43:09.787+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:43:09.786+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 4.041934674000004
[2024-11-21T09:43:09.788+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:43:09.788+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T09:43:09.790+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:43:09.789+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T09:43:09.810+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:43:09.809+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T09:43:09.832+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:43:09.831+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T09:43:09.856+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:43:09.856+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpq4d25942 --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T09:43:19.572+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:43:19.570+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpq4d25942 --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T09:43:34.397+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:43:34.384+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 210, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpq4d25942', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
09:43:25  Running with dbt=1.8.7
09:43:28  Registered adapter: bigquery=1.8.3
09:43:31  [WARNING]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
09:43:31  Encountered an error:
Compilation Error
  dbt found two data_tests with the name "unique_fct_trips_trip_id" defined on column "trip_id" in "models.fct_trips".
  
  Since these resources have the same name, dbt will be unable to find the correct resource
  when running tests.
  
  To fix this, change the name of one of these resources:
  - test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab (models/tests/schema.yml)
  - test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab (models/tests/schema.yml)
[2024-11-21T09:43:34.407+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T09:43:34.434+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 28.842 seconds
[2024-11-21T09:44:05.071+0000] {processor.py:161} INFO - Started process (PID=7291) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T09:44:05.074+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T09:44:05.076+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:44:05.076+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T09:44:05.175+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:44:05.174+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T09:44:07.500+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:44:07.499+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 4.364942631998929
[2024-11-21T09:44:07.501+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:44:07.501+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T09:44:07.503+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:44:07.503+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T09:44:07.524+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:44:07.523+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T09:44:07.539+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:44:07.539+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T09:44:07.576+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:44:07.575+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp_j3gg1we --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T09:44:18.124+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:44:18.123+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp_j3gg1we --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T09:44:33.043+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:44:33.042+0000] {timeout.py:68} ERROR - Process timed out, PID: 7291
[2024-11-21T09:45:03.629+0000] {processor.py:161} INFO - Started process (PID=7343) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T09:45:03.632+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T09:45:03.634+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:45:03.633+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T09:45:03.736+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:45:03.735+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T09:45:07.571+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:45:07.571+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 3.8069792810001672
[2024-11-21T09:45:07.573+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:45:07.572+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T09:45:07.574+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:45:07.574+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T09:45:07.593+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:45:07.592+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T09:45:07.620+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:45:07.619+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T09:45:07.646+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:45:07.645+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpbp12kv90 --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T09:45:17.336+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:45:17.335+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpbp12kv90 --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T09:45:30.810+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:45:30.798+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 210, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpbp12kv90', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
09:45:23  Running with dbt=1.8.7
09:45:27  Registered adapter: bigquery=1.8.3
09:45:29  [WARNING]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
09:45:29  Encountered an error:
Compilation Error
  dbt found two data_tests with the name "unique_fct_trips_trip_id" defined on column "trip_id" in "models.fct_trips".
  
  Since these resources have the same name, dbt will be unable to find the correct resource
  when running tests.
  
  To fix this, change the name of one of these resources:
  - test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab (models/tests/schema.yml)
  - test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab (models/tests/schema.yml)
[2024-11-21T09:45:30.813+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T09:45:30.848+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 29.344 seconds
[2024-11-21T09:46:01.609+0000] {processor.py:161} INFO - Started process (PID=7394) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T09:46:01.612+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T09:46:01.615+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:46:01.614+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T09:46:01.740+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:46:01.739+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T09:46:06.187+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:46:06.186+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 4.413148055999045
[2024-11-21T09:46:06.188+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:46:06.188+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T09:46:06.189+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:46:06.189+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T09:46:06.211+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:46:06.211+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T09:46:06.228+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:46:06.228+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T09:46:06.257+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:46:06.257+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpsaxnlxuw --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T09:46:15.893+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:46:15.891+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpsaxnlxuw --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T09:46:29.552+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:46:29.550+0000] {timeout.py:68} ERROR - Process timed out, PID: 7394
[2024-11-21T09:46:59.859+0000] {processor.py:161} INFO - Started process (PID=7446) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T09:46:59.862+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T09:46:59.864+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:46:59.863+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T09:46:59.945+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:46:59.944+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T09:47:04.379+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:47:04.379+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 4.404358181000134
[2024-11-21T09:47:04.381+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:47:04.380+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T09:47:04.382+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:47:04.382+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T09:47:04.402+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:47:04.401+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T09:47:04.418+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:47:04.418+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T09:47:04.446+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:47:04.446+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpt4axo331 --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T09:47:13.531+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:47:13.529+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpt4axo331 --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T09:47:26.021+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:47:26.007+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 210, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpt4axo331', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
09:47:19  Running with dbt=1.8.7
09:47:20  Registered adapter: bigquery=1.8.3
09:47:22  [WARNING]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
09:47:23  Encountered an error:
Compilation Error
  dbt found two data_tests with the name "unique_fct_trips_trip_id" defined on column "trip_id" in "models.fct_trips".
  
  Since these resources have the same name, dbt will be unable to find the correct resource
  when running tests.
  
  To fix this, change the name of one of these resources:
  - test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab (models/tests/schema.yml)
  - test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab (models/tests/schema.yml)
[2024-11-21T09:47:26.024+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T09:47:26.052+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 28.280 seconds
[2024-11-21T09:47:56.649+0000] {processor.py:161} INFO - Started process (PID=7499) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T09:47:56.652+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T09:47:56.654+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:47:56.654+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T09:47:56.762+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:47:56.761+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T09:48:01.250+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:48:01.250+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 4.4376876759997685
[2024-11-21T09:48:01.251+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:48:01.251+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T09:48:01.253+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:48:01.252+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T09:48:01.272+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:48:01.271+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T09:48:01.291+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:48:01.290+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T09:48:01.317+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:48:01.317+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpwfeukrri --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T09:48:10.843+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:48:10.842+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpwfeukrri --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T09:48:23.845+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:48:23.831+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 210, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpwfeukrri', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
09:48:17  Running with dbt=1.8.7
09:48:18  Registered adapter: bigquery=1.8.3
09:48:20  [WARNING]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
09:48:21  Encountered an error:
Compilation Error
  dbt found two data_tests with the name "unique_fct_trips_trip_id" defined on column "trip_id" in "models.fct_trips".
  
  Since these resources have the same name, dbt will be unable to find the correct resource
  when running tests.
  
  To fix this, change the name of one of these resources:
  - test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab (models/tests/schema.yml)
  - test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab (models/tests/schema.yml)
[2024-11-21T09:48:23.847+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T09:48:23.872+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 29.325 seconds
[2024-11-21T09:48:54.706+0000] {processor.py:161} INFO - Started process (PID=7557) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T09:48:54.709+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T09:48:54.711+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:48:54.711+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T09:48:54.827+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:48:54.827+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T09:48:59.190+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:48:59.190+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 4.330245084000126
[2024-11-21T09:48:59.192+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:48:59.191+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T09:48:59.193+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:48:59.193+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T09:48:59.213+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:48:59.212+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T09:48:59.228+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:48:59.227+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T09:48:59.255+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:48:59.255+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp0cpqz0ez --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T09:49:08.375+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:49:08.373+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp0cpqz0ez --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T09:49:20.953+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:49:20.937+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 210, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmp0cpqz0ez', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
09:49:13  Running with dbt=1.8.7
09:49:15  Registered adapter: bigquery=1.8.3
09:49:17  [WARNING]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
09:49:18  Encountered an error:
Compilation Error
  dbt found two data_tests with the name "unique_fct_trips_trip_id" defined on column "trip_id" in "models.fct_trips".
  
  Since these resources have the same name, dbt will be unable to find the correct resource
  when running tests.
  
  To fix this, change the name of one of these resources:
  - test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab (models/tests/schema.yml)
  - test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab (models/tests/schema.yml)
[2024-11-21T09:49:20.956+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T09:49:20.997+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 28.384 seconds
[2024-11-21T09:49:51.242+0000] {processor.py:161} INFO - Started process (PID=7609) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T09:49:51.244+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T09:49:51.247+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:49:51.246+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T09:49:51.359+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:49:51.359+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T09:49:55.921+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:49:55.921+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 4.531069069000296
[2024-11-21T09:49:55.923+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:49:55.923+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T09:49:55.924+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:49:55.924+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T09:49:55.944+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:49:55.943+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T09:49:55.959+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:49:55.959+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T09:49:55.988+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:49:55.988+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpg1l120qm --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T09:50:05.790+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:50:05.787+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpg1l120qm --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T09:50:18.825+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:50:18.810+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 210, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpg1l120qm', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
09:50:09  Running with dbt=1.8.7
09:50:13  Registered adapter: bigquery=1.8.3
09:50:15  [WARNING]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
09:50:16  Encountered an error:
Compilation Error
  dbt found two data_tests with the name "unique_fct_trips_trip_id" defined on column "trip_id" in "models.fct_trips".
  
  Since these resources have the same name, dbt will be unable to find the correct resource
  when running tests.
  
  To fix this, change the name of one of these resources:
  - test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab (models/tests/schema.yml)
  - test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab (models/tests/schema.yml)
[2024-11-21T09:50:18.828+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T09:50:18.866+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 29.741 seconds
[2024-11-21T09:50:49.002+0000] {processor.py:161} INFO - Started process (PID=7661) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T09:50:49.005+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T09:50:49.007+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:50:49.007+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T09:50:49.126+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:50:49.126+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T09:50:53.402+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:50:53.401+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 4.236931127999924
[2024-11-21T09:50:53.403+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:50:53.402+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T09:50:53.405+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:50:53.404+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T09:50:53.422+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:50:53.422+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T09:50:53.443+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:50:53.442+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T09:50:53.468+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:50:53.467+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp6pac2lyi --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T09:51:04.385+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:51:04.383+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp6pac2lyi --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T09:51:16.919+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:51:16.917+0000] {timeout.py:68} ERROR - Process timed out, PID: 7661
[2024-11-21T09:51:47.562+0000] {processor.py:161} INFO - Started process (PID=7713) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T09:51:47.564+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T09:51:47.567+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:51:47.566+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T09:51:47.674+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:51:47.673+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T09:51:51.626+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:51:51.626+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 3.9163714309997886
[2024-11-21T09:51:51.628+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:51:51.627+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T09:51:51.629+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:51:51.629+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T09:51:51.647+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:51:51.646+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T09:51:51.665+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:51:51.664+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T09:51:51.692+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:51:51.691+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpaa88nxm8 --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T09:51:59.710+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:51:59.709+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpaa88nxm8 --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T09:52:15.037+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:52:15.025+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 210, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpaa88nxm8', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
09:52:05  Running with dbt=1.8.7
09:52:09  Registered adapter: bigquery=1.8.3
09:52:11  [WARNING]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
09:52:12  Encountered an error:
Compilation Error
  dbt found two data_tests with the name "unique_fct_trips_trip_id" defined on column "trip_id" in "models.fct_trips".
  
  Since these resources have the same name, dbt will be unable to find the correct resource
  when running tests.
  
  To fix this, change the name of one of these resources:
  - test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab (models/tests/schema.yml)
  - test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab (models/tests/schema.yml)
[2024-11-21T09:52:15.039+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T09:52:15.071+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 29.628 seconds
[2024-11-21T09:52:45.196+0000] {processor.py:161} INFO - Started process (PID=7765) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T09:52:45.199+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T09:52:45.201+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:52:45.200+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T09:52:45.316+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:52:45.316+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T09:52:49.810+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:52:49.809+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 4.456756372001109
[2024-11-21T09:52:49.811+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:52:49.811+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T09:52:49.812+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:52:49.812+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T09:52:49.831+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:52:49.830+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T09:52:49.848+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:52:49.848+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T09:52:49.876+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:52:49.875+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmph07n1b6m --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T09:52:57.398+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:52:57.397+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmph07n1b6m --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T09:53:13.174+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:53:13.173+0000] {timeout.py:68} ERROR - Process timed out, PID: 7765
[2024-11-21T09:53:44.219+0000] {processor.py:161} INFO - Started process (PID=7817) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T09:53:44.221+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T09:53:44.223+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:53:44.223+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T09:53:44.322+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:53:44.322+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T09:53:48.421+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:53:48.420+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 4.065613438999208
[2024-11-21T09:53:48.422+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:53:48.422+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T09:53:48.424+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:53:48.423+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T09:53:48.438+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:53:48.438+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T09:53:48.454+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:53:48.454+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T09:53:48.478+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:53:48.477+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpmvd39j4z --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T09:53:56.518+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:53:56.516+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpmvd39j4z --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T09:54:12.032+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:54:12.019+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 210, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpmvd39j4z', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
09:54:02  Running with dbt=1.8.7
09:54:06  Registered adapter: bigquery=1.8.3
09:54:08  [WARNING]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
09:54:09  Encountered an error:
Compilation Error
  dbt found two data_tests with the name "unique_fct_trips_trip_id" defined on column "trip_id" in "models.fct_trips".
  
  Since these resources have the same name, dbt will be unable to find the correct resource
  when running tests.
  
  To fix this, change the name of one of these resources:
  - test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab (models/tests/schema.yml)
  - test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab (models/tests/schema.yml)
[2024-11-21T09:54:12.034+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T09:54:12.065+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 29.937 seconds
[2024-11-21T09:54:42.455+0000] {processor.py:161} INFO - Started process (PID=7869) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T09:54:42.458+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T09:54:42.460+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:54:42.459+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T09:54:42.572+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:54:42.571+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T09:54:46.983+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:54:46.982+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 4.377232075001302
[2024-11-21T09:54:46.984+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:54:46.984+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T09:54:46.986+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:54:46.986+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T09:54:47.006+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:54:47.006+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T09:54:47.024+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:54:47.024+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T09:54:47.051+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:54:47.051+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpa2swbf3y --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T09:54:54.496+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:54:54.495+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpa2swbf3y --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T09:55:10.447+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:55:10.445+0000] {timeout.py:68} ERROR - Process timed out, PID: 7869
[2024-11-21T09:55:40.851+0000] {processor.py:161} INFO - Started process (PID=7921) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T09:55:40.854+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T09:55:40.856+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:55:40.855+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T09:55:40.942+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:55:40.941+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T09:55:44.104+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:55:44.104+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 3.9331741129990405
[2024-11-21T09:55:44.106+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:55:44.105+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T09:55:44.108+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:55:44.107+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T09:55:44.130+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:55:44.129+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T09:55:44.148+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:55:44.148+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T09:55:44.176+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:55:44.175+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpuyoh9rhc --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T09:55:52.343+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:55:52.340+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpuyoh9rhc --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T09:56:06.989+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:56:06.976+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 210, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpuyoh9rhc', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
09:55:58  Running with dbt=1.8.7
09:56:02  Registered adapter: bigquery=1.8.3
09:56:04  Encountered an error:
Parsing Error
  Invalid models config given in models/tests/schema.yml @ models: {'name': 'fct_trips', 'description': 'Fact Table of tripdata', 'columns': [{'name': 'trip_id', 'description': 'The primary key for this table', 'tests': ['unique']}, {'name': 'vendor_id', 'description': 'A code indicating the TPEP provider that provided the record', 'tests': ['not_null']}, {'name': 'pickup_time_id', 'description': 'id to get pickup time from dim_time', 'tests': ['not_null']}, {'name': 'dropoff_time_id', 'description': 'id to get dropoff time from dim_time', 'tests': ['unique']}, {'name': 'rate_code_id', 'description': 'The final rate code in effect at the end of the trip', 'tests': ['unique']}, {'name': 'pu_location_id', 'description': 'The pickup location', 'tests': ['not_null']}, {'name': 'do_location_id', 'description': 'The droppof location', 'tests': ['not_null']}, {'name': 'passenger_count', 'description': 'Customer count', 'tests': ['unique']}, {'name': 'trip_distance', 'description': 'trip distance', 'tests': ['not_null']}, {'name': 'fare_amount', 'description': 'The time-and-distance fare calculated by the meter.', 'tests': ['not_null']}, {'name': 'extra', 'description': 'Miscellaneous extras and surcharges. Currently, this only includes. the $0.50 and $1 rush hour and overnight charges', 'tests': ['not_null']}, {'name': 'mta_tax', 'description': '0.50 MTA tax that is automatically triggered based on the metered rate in use', 'tests': ['unique']}, {'name': 'tip_amount', 'description': 'Tip amount  This field is automatically populated for credit card tips.Cash tips are not included', 'tests': ['not_null']}, {'name': 'tolls_amount', 'description': 'Total amount of all tolls paid in trip', 'tests': ['not_null']}, {'name': 'improvement_surcharge', 'description': '0.30 improvement surcharge assessed trips at the flag drop. the improvement surcharge began being levied in 2015', 'tests': ['not_null']}, {'name': 'total_amount', 'description': 'The total amount charged to passengers. Does not include cash tips.', 'tests': ['not_null']}, {'name': 'payment_type', 'description': 'A numeric code signifying how the passenger paid for the trip', 'tests': ['not_null']}, {'name': 'trip_type', 'description': 'Year of pickup', 'tests': ['not_null']}, {'name': 'congestion_surcharge', 'description': 'An additional charge for trips taken during high traffic congestion times', 'tests': [None]}], 'original_file_path': 'models/tests/schema.yml', 'yaml_key': 'models', 'package_name': 'nyc_taxi'} - at path ['columns'][18]['tests'][0]: None is not valid under any of the given schemas
[2024-11-21T09:56:06.991+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T09:56:07.022+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 28.310 seconds
[2024-11-21T09:56:37.153+0000] {processor.py:161} INFO - Started process (PID=7973) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T09:56:37.156+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T09:56:37.158+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:56:37.157+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T09:56:37.269+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:56:37.268+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T09:56:39.462+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:56:39.461+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 4.379954953999913
[2024-11-21T09:56:39.463+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:56:39.463+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T09:56:39.464+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:56:39.464+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T09:56:39.483+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:56:39.483+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T09:56:39.509+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:56:39.509+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T09:56:39.538+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:56:39.538+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp6_zii5ei --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T09:56:48.341+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:56:48.340+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp6_zii5ei --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T09:57:03.891+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:57:03.877+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 210, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmp6_zii5ei', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
09:56:54  Running with dbt=1.8.7
09:56:58  Registered adapter: bigquery=1.8.3
09:57:01  Encountered an error:
Parsing Error
  Invalid models config given in models/tests/schema.yml @ models: {'name': 'fct_trips', 'description': 'Fact Table of tripdata', 'columns': [{'name': 'trip_id', 'description': 'The primary key for this table', 'tests': ['unique']}, {'name': 'vendor_id', 'description': 'A code indicating the TPEP provider that provided the record', 'tests': ['not_null']}, {'name': 'pickup_time_id', 'description': 'id to get pickup time from dim_time', 'tests': ['not_null']}, {'name': 'dropoff_time_id', 'description': 'id to get dropoff time from dim_time', 'tests': ['unique']}, {'name': 'rate_code_id', 'description': 'The final rate code in effect at the end of the trip', 'tests': ['unique']}, {'name': 'pu_location_id', 'description': 'The pickup location', 'tests': ['not_null']}, {'name': 'do_location_id', 'description': 'The droppof location', 'tests': ['not_null']}, {'name': 'passenger_count', 'description': 'Customer count', 'tests': ['unique']}, {'name': 'trip_distance', 'description': 'trip distance', 'tests': ['not_null']}, {'name': 'fare_amount', 'description': 'The time-and-distance fare calculated by the meter.', 'tests': ['not_null']}, {'name': 'extra', 'description': 'Miscellaneous extras and surcharges. Currently, this only includes. the $0.50 and $1 rush hour and overnight charges', 'tests': ['not_null']}, {'name': 'mta_tax', 'description': '0.50 MTA tax that is automatically triggered based on the metered rate in use', 'tests': ['unique']}, {'name': 'tip_amount', 'description': 'Tip amount  This field is automatically populated for credit card tips.Cash tips are not included', 'tests': ['not_null']}, {'name': 'tolls_amount', 'description': 'Total amount of all tolls paid in trip', 'tests': ['not_null']}, {'name': 'improvement_surcharge', 'description': '0.30 improvement surcharge assessed trips at the flag drop. the improvement surcharge began being levied in 2015', 'tests': ['not_null']}, {'name': 'total_amount', 'description': 'The total amount charged to passengers. Does not include cash tips.', 'tests': ['not_null']}, {'name': 'payment_type', 'description': 'A numeric code signifying how the passenger paid for the trip', 'tests': ['not_null']}, {'name': 'trip_type', 'description': 'Year of pickup', 'tests': ['not_null']}, {'name': 'congestion_surcharge', 'description': 'An additional charge for trips taken during high traffic congestion times', 'tests': [None]}], 'original_file_path': 'models/tests/schema.yml', 'yaml_key': 'models', 'package_name': 'nyc_taxi'} - at path ['columns'][18]['tests'][0]: None is not valid under any of the given schemas
[2024-11-21T09:57:03.893+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T09:57:03.925+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 29.006 seconds
[2024-11-21T09:57:34.053+0000] {processor.py:161} INFO - Started process (PID=8025) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T09:57:34.055+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T09:57:34.057+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:57:34.057+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T09:57:34.161+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:57:34.161+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T09:57:36.237+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:57:36.236+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 4.157076026998766
[2024-11-21T09:57:36.238+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:57:36.238+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T09:57:36.240+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:57:36.239+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T09:57:36.254+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:57:36.253+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T09:57:36.269+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:57:36.268+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T09:57:36.295+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:57:36.295+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpxu9xrme1 --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T09:57:45.348+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:57:45.347+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpxu9xrme1 --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T09:57:59.473+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:57:59.459+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 210, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpxu9xrme1', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
09:57:50  Running with dbt=1.8.7
09:57:54  Registered adapter: bigquery=1.8.3
09:57:56  Encountered an error:
Parsing Error
  Invalid models config given in models/tests/schema.yml @ models: {'name': 'fct_trips', 'description': 'Fact Table of tripdata', 'columns': [{'name': 'trip_id', 'description': 'The primary key for this table', 'tests': ['unique']}, {'name': 'vendor_id', 'description': 'A code indicating the TPEP provider that provided the record', 'tests': ['not_null']}, {'name': 'pickup_time_id', 'description': 'id to get pickup time from dim_time', 'tests': ['not_null']}, {'name': 'dropoff_time_id', 'description': 'id to get dropoff time from dim_time', 'tests': ['unique']}, {'name': 'rate_code_id', 'description': 'The final rate code in effect at the end of the trip', 'tests': ['unique']}, {'name': 'pu_location_id', 'description': 'The pickup location', 'tests': ['not_null']}, {'name': 'do_location_id', 'description': 'The droppof location', 'tests': ['not_null']}, {'name': 'passenger_count', 'description': 'Customer count', 'tests': ['unique']}, {'name': 'trip_distance', 'description': 'trip distance', 'tests': ['not_null']}, {'name': 'fare_amount', 'description': 'The time-and-distance fare calculated by the meter.', 'tests': ['not_null']}, {'name': 'extra', 'description': 'Miscellaneous extras and surcharges. Currently, this only includes. the $0.50 and $1 rush hour and overnight charges', 'tests': ['not_null']}, {'name': 'mta_tax', 'description': '0.50 MTA tax that is automatically triggered based on the metered rate in use', 'tests': ['unique']}, {'name': 'tip_amount', 'description': 'Tip amount  This field is automatically populated for credit card tips.Cash tips are not included', 'tests': ['not_null']}, {'name': 'tolls_amount', 'description': 'Total amount of all tolls paid in trip', 'tests': ['not_null']}, {'name': 'improvement_surcharge', 'description': '0.30 improvement surcharge assessed trips at the flag drop. the improvement surcharge began being levied in 2015', 'tests': ['not_null']}, {'name': 'total_amount', 'description': 'The total amount charged to passengers. Does not include cash tips.', 'tests': ['not_null']}, {'name': 'payment_type', 'description': 'A numeric code signifying how the passenger paid for the trip', 'tests': ['not_null']}, {'name': 'trip_type', 'description': 'Year of pickup', 'tests': ['not_null']}, {'name': 'congestion_surcharge', 'description': 'An additional charge for trips taken during high traffic congestion times', 'tests': [None]}], 'original_file_path': 'models/tests/schema.yml', 'yaml_key': 'models', 'package_name': 'nyc_taxi'} - at path ['columns'][18]['tests'][0]: None is not valid under any of the given schemas
[2024-11-21T09:57:59.475+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T09:57:59.505+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 27.575 seconds
[2024-11-21T09:58:30.328+0000] {processor.py:161} INFO - Started process (PID=8077) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T09:58:30.330+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T09:58:30.332+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:58:30.331+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T09:58:30.444+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:58:30.444+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T09:58:32.003+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:58:32.002+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 3.6320821160006744
[2024-11-21T09:58:32.004+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:58:32.004+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T09:58:32.006+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:58:32.005+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T09:58:32.023+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:58:32.023+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T09:58:32.042+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:58:32.042+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T09:58:32.066+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:58:32.065+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpnyyfux6e --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T09:58:41.139+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:58:41.137+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpnyyfux6e --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T09:58:56.433+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:58:56.419+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 210, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpnyyfux6e', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
09:58:47  Running with dbt=1.8.7
09:58:51  Registered adapter: bigquery=1.8.3
09:58:53  Encountered an error:
Parsing Error
  Invalid models config given in models/tests/schema.yml @ models: {'name': 'fct_trips', 'description': 'Fact Table of tripdata', 'columns': [{'name': 'trip_id', 'description': 'The primary key for this table', 'tests': ['unique']}, {'name': 'vendor_id', 'description': 'A code indicating the TPEP provider that provided the record', 'tests': ['not_null']}, {'name': 'pickup_time_id', 'description': 'id to get pickup time from dim_time', 'tests': ['not_null']}, {'name': 'dropoff_time_id', 'description': 'id to get dropoff time from dim_time', 'tests': ['unique']}, {'name': 'rate_code_id', 'description': 'The final rate code in effect at the end of the trip', 'tests': ['unique']}, {'name': 'pu_location_id', 'description': 'The pickup location', 'tests': ['not_null']}, {'name': 'do_location_id', 'description': 'The droppof location', 'tests': ['not_null']}, {'name': 'passenger_count', 'description': 'Customer count', 'tests': ['unique']}, {'name': 'trip_distance', 'description': 'trip distance', 'tests': ['not_null']}, {'name': 'fare_amount', 'description': 'The time-and-distance fare calculated by the meter.', 'tests': ['not_null']}, {'name': 'extra', 'description': 'Miscellaneous extras and surcharges. Currently, this only includes. the $0.50 and $1 rush hour and overnight charges', 'tests': ['not_null']}, {'name': 'mta_tax', 'description': '0.50 MTA tax that is automatically triggered based on the metered rate in use', 'tests': ['unique']}, {'name': 'tip_amount', 'description': 'Tip amount  This field is automatically populated for credit card tips.Cash tips are not included', 'tests': ['not_null']}, {'name': 'tolls_amount', 'description': 'Total amount of all tolls paid in trip', 'tests': ['not_null']}, {'name': 'improvement_surcharge', 'description': '0.30 improvement surcharge assessed trips at the flag drop. the improvement surcharge began being levied in 2015', 'tests': ['not_null']}, {'name': 'total_amount', 'description': 'The total amount charged to passengers. Does not include cash tips.', 'tests': ['not_null']}, {'name': 'payment_type', 'description': 'A numeric code signifying how the passenger paid for the trip', 'tests': ['not_null']}, {'name': 'trip_type', 'description': 'Year of pickup', 'tests': ['not_null']}, {'name': 'congestion_surcharge', 'description': 'An additional charge for trips taken during high traffic congestion times', 'tests': [None]}], 'original_file_path': 'models/tests/schema.yml', 'yaml_key': 'models', 'package_name': 'nyc_taxi'} - at path ['columns'][18]['tests'][0]: None is not valid under any of the given schemas
[2024-11-21T09:58:56.436+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T09:58:56.460+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 28.254 seconds
[2024-11-21T09:59:27.270+0000] {processor.py:161} INFO - Started process (PID=8129) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T09:59:27.272+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T09:59:27.275+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:59:27.274+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T09:59:27.364+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:59:27.363+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T09:59:29.757+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:59:29.756+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 4.463941246000104
[2024-11-21T09:59:29.759+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:59:29.758+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T09:59:29.761+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:59:29.760+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T09:59:29.780+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:59:29.780+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T09:59:29.796+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:59:29.795+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T09:59:29.823+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:59:29.823+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpo_9jbzmj --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T09:59:38.863+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:59:38.861+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpo_9jbzmj --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T09:59:52.707+0000] {logging_mixin.py:188} INFO - [2024-11-21T09:59:52.692+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 210, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpo_9jbzmj', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
09:59:44  Running with dbt=1.8.7
09:59:48  Registered adapter: bigquery=1.8.3
09:59:50  Encountered an error:
Parsing Error
  Invalid models config given in models/tests/schema.yml @ models: {'name': 'fct_trips', 'description': 'Fact Table of tripdata', 'columns': [{'name': 'trip_id', 'description': 'The primary key for this table', 'tests': ['unique']}, {'name': 'vendor_id', 'description': 'A code indicating the TPEP provider that provided the record', 'tests': ['not_null']}, {'name': 'pickup_time_id', 'description': 'id to get pickup time from dim_time', 'tests': ['not_null']}, {'name': 'dropoff_time_id', 'description': 'id to get dropoff time from dim_time', 'tests': ['unique']}, {'name': 'rate_code_id', 'description': 'The final rate code in effect at the end of the trip', 'tests': ['unique']}, {'name': 'pu_location_id', 'description': 'The pickup location', 'tests': ['not_null']}, {'name': 'do_location_id', 'description': 'The droppof location', 'tests': ['not_null']}, {'name': 'passenger_count', 'description': 'Customer count', 'tests': ['unique']}, {'name': 'trip_distance', 'description': 'trip distance', 'tests': ['not_null']}, {'name': 'fare_amount', 'description': 'The time-and-distance fare calculated by the meter.', 'tests': ['not_null']}, {'name': 'extra', 'description': 'Miscellaneous extras and surcharges. Currently, this only includes. the $0.50 and $1 rush hour and overnight charges', 'tests': ['not_null']}, {'name': 'mta_tax', 'description': '0.50 MTA tax that is automatically triggered based on the metered rate in use', 'tests': ['unique']}, {'name': 'tip_amount', 'description': 'Tip amount  This field is automatically populated for credit card tips.Cash tips are not included', 'tests': ['not_null']}, {'name': 'tolls_amount', 'description': 'Total amount of all tolls paid in trip', 'tests': ['not_null']}, {'name': 'improvement_surcharge', 'description': '0.30 improvement surcharge assessed trips at the flag drop. the improvement surcharge began being levied in 2015', 'tests': ['not_null']}, {'name': 'total_amount', 'description': 'The total amount charged to passengers. Does not include cash tips.', 'tests': ['not_null']}, {'name': 'payment_type', 'description': 'A numeric code signifying how the passenger paid for the trip', 'tests': ['not_null']}, {'name': 'trip_type', 'description': 'Year of pickup', 'tests': ['not_null']}, {'name': 'congestion_surcharge', 'description': 'An additional charge for trips taken during high traffic congestion times', 'tests': [None]}], 'original_file_path': 'models/tests/schema.yml', 'yaml_key': 'models', 'package_name': 'nyc_taxi'} - at path ['columns'][18]['tests'][0]: None is not valid under any of the given schemas
[2024-11-21T09:59:52.710+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T09:59:52.740+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 27.593 seconds
[2024-11-21T10:00:23.680+0000] {processor.py:161} INFO - Started process (PID=8181) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T10:00:23.682+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T10:00:23.685+0000] {logging_mixin.py:188} INFO - [2024-11-21T10:00:23.684+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T10:00:23.788+0000] {logging_mixin.py:188} INFO - [2024-11-21T10:00:23.787+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T10:00:25.850+0000] {logging_mixin.py:188} INFO - [2024-11-21T10:00:25.849+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 4.058087511000849
[2024-11-21T10:00:25.852+0000] {logging_mixin.py:188} INFO - [2024-11-21T10:00:25.851+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T10:00:25.853+0000] {logging_mixin.py:188} INFO - [2024-11-21T10:00:25.853+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T10:00:25.874+0000] {logging_mixin.py:188} INFO - [2024-11-21T10:00:25.873+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T10:00:25.907+0000] {logging_mixin.py:188} INFO - [2024-11-21T10:00:25.906+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T10:00:25.935+0000] {logging_mixin.py:188} INFO - [2024-11-21T10:00:25.935+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp7e2bf6zx --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T10:00:35.137+0000] {logging_mixin.py:188} INFO - [2024-11-21T10:00:35.136+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp7e2bf6zx --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T16:30:40.770+0000] {processor.py:161} INFO - Started process (PID=83) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T16:30:40.772+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T16:30:40.774+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:30:40.774+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T16:30:40.811+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:30:40.811+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T16:30:43.253+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:30:43.253+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 2.427721090999995
[2024-11-21T16:30:43.254+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:30:43.254+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T16:30:43.255+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:30:43.254+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T16:30:43.264+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:30:43.260+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T16:30:43.275+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:30:43.275+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T16:30:43.282+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:30:43.282+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp1pc36_ku --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T16:30:49.758+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:30:49.758+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp1pc36_ku --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T16:30:56.749+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:30:56.743+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 210, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmp1pc36_ku', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
16:30:51  Running with dbt=1.8.7
16:30:53  Registered adapter: bigquery=1.8.3
16:30:53  Encountered an error:
Parsing Error
  Invalid models config given in models/tests/schema.yml @ models: {'name': 'fct_trips', 'description': 'Fact Table of tripdata', 'columns': [{'name': 'trip_id', 'description': 'The primary key for this table', 'tests': ['unique']}, {'name': 'vendor_id', 'description': 'A code indicating the TPEP provider that provided the record', 'tests': ['not_null']}, {'name': 'pickup_time_id', 'description': 'id to get pickup time from dim_time', 'tests': ['not_null']}, {'name': 'dropoff_time_id', 'description': 'id to get dropoff time from dim_time', 'tests': ['unique']}, {'name': 'rate_code_id', 'description': 'The final rate code in effect at the end of the trip', 'tests': ['unique']}, {'name': 'pu_location_id', 'description': 'The pickup location', 'tests': ['not_null']}, {'name': 'do_location_id', 'description': 'The droppof location', 'tests': ['not_null']}, {'name': 'passenger_count', 'description': 'Customer count', 'tests': ['unique']}, {'name': 'trip_distance', 'description': 'trip distance', 'tests': ['not_null']}, {'name': 'fare_amount', 'description': 'The time-and-distance fare calculated by the meter.', 'tests': ['not_null']}, {'name': 'extra', 'description': 'Miscellaneous extras and surcharges. Currently, this only includes. the $0.50 and $1 rush hour and overnight charges', 'tests': ['not_null']}, {'name': 'mta_tax', 'description': '0.50 MTA tax that is automatically triggered based on the metered rate in use', 'tests': ['unique']}, {'name': 'tip_amount', 'description': 'Tip amount  This field is automatically populated for credit card tips.Cash tips are not included', 'tests': ['not_null']}, {'name': 'tolls_amount', 'description': 'Total amount of all tolls paid in trip', 'tests': ['not_null']}, {'name': 'improvement_surcharge', 'description': '0.30 improvement surcharge assessed trips at the flag drop. the improvement surcharge began being levied in 2015', 'tests': ['not_null']}, {'name': 'total_amount', 'description': 'The total amount charged to passengers. Does not include cash tips.', 'tests': ['not_null']}, {'name': 'payment_type', 'description': 'A numeric code signifying how the passenger paid for the trip', 'tests': ['not_null']}, {'name': 'trip_type', 'description': 'Year of pickup', 'tests': ['not_null']}, {'name': 'congestion_surcharge', 'description': 'An additional charge for trips taken during high traffic congestion times', 'tests': [None]}], 'original_file_path': 'models/tests/schema.yml', 'yaml_key': 'models', 'package_name': 'nyc_taxi'} - at path ['columns'][18]['tests'][0]: None is not valid under any of the given schemas
[2024-11-21T16:30:56.750+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T16:30:56.761+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 16.749 seconds
[2024-11-21T16:31:26.857+0000] {processor.py:161} INFO - Started process (PID=135) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T16:31:26.858+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T16:31:26.859+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:31:26.859+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T16:31:26.883+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:31:26.883+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T16:31:27.621+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:31:27.620+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 0.7256637860000126
[2024-11-21T16:31:27.621+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:31:27.621+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T16:31:27.621+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:31:27.621+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T16:31:27.626+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:31:27.625+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T16:31:27.632+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:31:27.632+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T16:31:27.638+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:31:27.637+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp7h0ly8cx --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T16:31:35.457+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:31:35.456+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp7h0ly8cx --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T16:31:42.258+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:31:42.254+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 210, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmp7h0ly8cx', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
16:31:37  Running with dbt=1.8.7
16:31:39  Registered adapter: bigquery=1.8.3
16:31:40  Encountered an error:
Parsing Error
  Invalid models config given in models/tests/schema.yml @ models: {'name': 'fct_trips', 'description': 'Fact Table of tripdata', 'columns': [{'name': 'trip_id', 'description': 'The primary key for this table', 'tests': ['unique']}, {'name': 'vendor_id', 'description': 'A code indicating the TPEP provider that provided the record', 'tests': ['not_null']}, {'name': 'pickup_time_id', 'description': 'id to get pickup time from dim_time', 'tests': ['not_null']}, {'name': 'dropoff_time_id', 'description': 'id to get dropoff time from dim_time', 'tests': ['unique']}, {'name': 'rate_code_id', 'description': 'The final rate code in effect at the end of the trip', 'tests': ['unique']}, {'name': 'pu_location_id', 'description': 'The pickup location', 'tests': ['not_null']}, {'name': 'do_location_id', 'description': 'The droppof location', 'tests': ['not_null']}, {'name': 'passenger_count', 'description': 'Customer count', 'tests': ['unique']}, {'name': 'trip_distance', 'description': 'trip distance', 'tests': ['not_null']}, {'name': 'fare_amount', 'description': 'The time-and-distance fare calculated by the meter.', 'tests': ['not_null']}, {'name': 'extra', 'description': 'Miscellaneous extras and surcharges. Currently, this only includes. the $0.50 and $1 rush hour and overnight charges', 'tests': ['not_null']}, {'name': 'mta_tax', 'description': '0.50 MTA tax that is automatically triggered based on the metered rate in use', 'tests': ['unique']}, {'name': 'tip_amount', 'description': 'Tip amount  This field is automatically populated for credit card tips.Cash tips are not included', 'tests': ['not_null']}, {'name': 'tolls_amount', 'description': 'Total amount of all tolls paid in trip', 'tests': ['not_null']}, {'name': 'improvement_surcharge', 'description': '0.30 improvement surcharge assessed trips at the flag drop. the improvement surcharge began being levied in 2015', 'tests': ['not_null']}, {'name': 'total_amount', 'description': 'The total amount charged to passengers. Does not include cash tips.', 'tests': ['not_null']}, {'name': 'payment_type', 'description': 'A numeric code signifying how the passenger paid for the trip', 'tests': ['not_null']}, {'name': 'trip_type', 'description': 'Year of pickup', 'tests': ['not_null']}, {'name': 'congestion_surcharge', 'description': 'An additional charge for trips taken during high traffic congestion times', 'tests': [None]}], 'original_file_path': 'models/tests/schema.yml', 'yaml_key': 'models', 'package_name': 'nyc_taxi'} - at path ['columns'][18]['tests'][0]: None is not valid under any of the given schemas
[2024-11-21T16:31:42.258+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T16:31:42.269+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 15.416 seconds
[2024-11-21T16:39:05.263+0000] {processor.py:161} INFO - Started process (PID=84) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T16:39:05.264+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T16:39:05.267+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:39:05.266+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T16:39:05.305+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:39:05.305+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T16:39:07.991+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:39:07.990+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 2.670990589999974
[2024-11-21T16:39:07.991+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:39:07.991+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T16:39:07.992+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:39:07.991+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T16:39:07.999+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:39:07.996+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T16:39:08.009+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:39:08.009+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T16:39:08.016+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:39:08.015+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp8wrogg99 --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T16:39:14.115+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:39:14.114+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp8wrogg99 --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T16:39:21.465+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:39:21.458+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 210, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmp8wrogg99', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
16:39:16  Running with dbt=1.8.7
16:39:18  Registered adapter: bigquery=1.8.3
16:39:19  Encountered an error:
Parsing Error
  Invalid models config given in models/tests/schema.yml @ models: {'name': 'fct_trips', 'description': 'Fact Table of tripdata', 'columns': [{'name': 'trip_id', 'description': 'The primary key for this table', 'tests': ['unique']}, {'name': 'vendor_id', 'description': 'A code indicating the TPEP provider that provided the record', 'tests': ['not_null']}, {'name': 'pickup_time_id', 'description': 'id to get pickup time from dim_time', 'tests': ['not_null']}, {'name': 'dropoff_time_id', 'description': 'id to get dropoff time from dim_time', 'tests': ['unique']}, {'name': 'rate_code_id', 'description': 'The final rate code in effect at the end of the trip', 'tests': ['unique']}, {'name': 'pu_location_id', 'description': 'The pickup location', 'tests': ['not_null']}, {'name': 'do_location_id', 'description': 'The droppof location', 'tests': ['not_null']}, {'name': 'passenger_count', 'description': 'Customer count', 'tests': ['unique']}, {'name': 'trip_distance', 'description': 'trip distance', 'tests': ['not_null']}, {'name': 'fare_amount', 'description': 'The time-and-distance fare calculated by the meter.', 'tests': ['not_null']}, {'name': 'extra', 'description': 'Miscellaneous extras and surcharges. Currently, this only includes. the $0.50 and $1 rush hour and overnight charges', 'tests': ['not_null']}, {'name': 'mta_tax', 'description': '0.50 MTA tax that is automatically triggered based on the metered rate in use', 'tests': ['unique']}, {'name': 'tip_amount', 'description': 'Tip amount  This field is automatically populated for credit card tips.Cash tips are not included', 'tests': ['not_null']}, {'name': 'tolls_amount', 'description': 'Total amount of all tolls paid in trip', 'tests': ['not_null']}, {'name': 'improvement_surcharge', 'description': '0.30 improvement surcharge assessed trips at the flag drop. the improvement surcharge began being levied in 2015', 'tests': ['not_null']}, {'name': 'total_amount', 'description': 'The total amount charged to passengers. Does not include cash tips.', 'tests': ['not_null']}, {'name': 'payment_type', 'description': 'A numeric code signifying how the passenger paid for the trip', 'tests': ['not_null']}, {'name': 'trip_type', 'description': 'Year of pickup', 'tests': ['not_null']}, {'name': 'congestion_surcharge', 'description': 'An additional charge for trips taken during high traffic congestion times', 'tests': [None]}], 'original_file_path': 'models/tests/schema.yml', 'yaml_key': 'models', 'package_name': 'nyc_taxi'} - at path ['columns'][18]['tests'][0]: None is not valid under any of the given schemas
[2024-11-21T16:39:21.466+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T16:39:21.480+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 16.924 seconds
[2024-11-21T16:39:52.015+0000] {processor.py:161} INFO - Started process (PID=136) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T16:39:52.016+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T16:39:52.017+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:39:52.017+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T16:39:52.040+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:39:52.039+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T16:39:52.763+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:39:52.763+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 0.712310092999985
[2024-11-21T16:39:52.764+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:39:52.763+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T16:39:52.764+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:39:52.764+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T16:39:52.768+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:39:52.767+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T16:39:52.774+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:39:52.774+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T16:39:52.780+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:39:52.780+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpw59tfdbc --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T16:39:57.678+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:39:57.678+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpw59tfdbc --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T16:40:03.548+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:40:03.544+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 210, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpw59tfdbc', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
16:39:59  Running with dbt=1.8.7
16:40:01  Registered adapter: bigquery=1.8.3
16:40:01  Encountered an error:
Parsing Error
  Invalid models config given in models/tests/schema.yml @ models: {'name': 'fct_trips', 'description': 'Fact Table of tripdata', 'columns': [{'name': 'trip_id', 'description': 'The primary key for this table', 'tests': ['unique']}, {'name': 'vendor_id', 'description': 'A code indicating the TPEP provider that provided the record', 'tests': ['not_null']}, {'name': 'pickup_time_id', 'description': 'id to get pickup time from dim_time', 'tests': ['not_null']}, {'name': 'dropoff_time_id', 'description': 'id to get dropoff time from dim_time', 'tests': ['unique']}, {'name': 'rate_code_id', 'description': 'The final rate code in effect at the end of the trip', 'tests': ['unique']}, {'name': 'pu_location_id', 'description': 'The pickup location', 'tests': ['not_null']}, {'name': 'do_location_id', 'description': 'The droppof location', 'tests': ['not_null']}, {'name': 'passenger_count', 'description': 'Customer count', 'tests': ['unique']}, {'name': 'trip_distance', 'description': 'trip distance', 'tests': ['not_null']}, {'name': 'fare_amount', 'description': 'The time-and-distance fare calculated by the meter.', 'tests': ['not_null']}, {'name': 'extra', 'description': 'Miscellaneous extras and surcharges. Currently, this only includes. the $0.50 and $1 rush hour and overnight charges', 'tests': ['not_null']}, {'name': 'mta_tax', 'description': '0.50 MTA tax that is automatically triggered based on the metered rate in use', 'tests': ['unique']}, {'name': 'tip_amount', 'description': 'Tip amount  This field is automatically populated for credit card tips.Cash tips are not included', 'tests': ['not_null']}, {'name': 'tolls_amount', 'description': 'Total amount of all tolls paid in trip', 'tests': ['not_null']}, {'name': 'improvement_surcharge', 'description': '0.30 improvement surcharge assessed trips at the flag drop. the improvement surcharge began being levied in 2015', 'tests': ['not_null']}, {'name': 'total_amount', 'description': 'The total amount charged to passengers. Does not include cash tips.', 'tests': ['not_null']}, {'name': 'payment_type', 'description': 'A numeric code signifying how the passenger paid for the trip', 'tests': ['not_null']}, {'name': 'trip_type', 'description': 'Year of pickup', 'tests': ['not_null']}, {'name': 'congestion_surcharge', 'description': 'An additional charge for trips taken during high traffic congestion times', 'tests': [None]}], 'original_file_path': 'models/tests/schema.yml', 'yaml_key': 'models', 'package_name': 'nyc_taxi'} - at path ['columns'][18]['tests'][0]: None is not valid under any of the given schemas
[2024-11-21T16:40:03.549+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T16:40:03.558+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 11.549 seconds
[2024-11-21T16:40:33.699+0000] {processor.py:161} INFO - Started process (PID=181) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T16:40:33.699+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T16:40:33.701+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:40:33.701+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T16:40:33.723+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:40:33.723+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T16:40:34.468+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:40:34.468+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 0.7342464179999979
[2024-11-21T16:40:34.469+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:40:34.469+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T16:40:34.469+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:40:34.469+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T16:40:34.473+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:40:34.473+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T16:40:34.480+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:40:34.480+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T16:40:34.486+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:40:34.485+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp72dwl6c_ --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T16:40:39.934+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:40:39.934+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp72dwl6c_ --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T16:40:46.506+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:40:46.502+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 210, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmp72dwl6c_', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
16:40:42  Running with dbt=1.8.7
16:40:43  Registered adapter: bigquery=1.8.3
16:40:44  Encountered an error:
Parsing Error
  Invalid models config given in models/tests/schema.yml @ models: {'name': 'fct_trips', 'description': 'Fact Table of tripdata', 'columns': [{'name': 'trip_id', 'description': 'The primary key for this table', 'tests': ['unique']}, {'name': 'vendor_id', 'description': 'A code indicating the TPEP provider that provided the record', 'tests': ['not_null']}, {'name': 'pickup_time_id', 'description': 'id to get pickup time from dim_time', 'tests': ['not_null']}, {'name': 'dropoff_time_id', 'description': 'id to get dropoff time from dim_time', 'tests': ['unique']}, {'name': 'rate_code_id', 'description': 'The final rate code in effect at the end of the trip', 'tests': ['unique']}, {'name': 'pu_location_id', 'description': 'The pickup location', 'tests': ['not_null']}, {'name': 'do_location_id', 'description': 'The droppof location', 'tests': ['not_null']}, {'name': 'passenger_count', 'description': 'Customer count', 'tests': ['unique']}, {'name': 'trip_distance', 'description': 'trip distance', 'tests': ['not_null']}, {'name': 'fare_amount', 'description': 'The time-and-distance fare calculated by the meter.', 'tests': ['not_null']}, {'name': 'extra', 'description': 'Miscellaneous extras and surcharges. Currently, this only includes. the $0.50 and $1 rush hour and overnight charges', 'tests': ['not_null']}, {'name': 'mta_tax', 'description': '0.50 MTA tax that is automatically triggered based on the metered rate in use', 'tests': ['unique']}, {'name': 'tip_amount', 'description': 'Tip amount  This field is automatically populated for credit card tips.Cash tips are not included', 'tests': ['not_null']}, {'name': 'tolls_amount', 'description': 'Total amount of all tolls paid in trip', 'tests': ['not_null']}, {'name': 'improvement_surcharge', 'description': '0.30 improvement surcharge assessed trips at the flag drop. the improvement surcharge began being levied in 2015', 'tests': ['not_null']}, {'name': 'total_amount', 'description': 'The total amount charged to passengers. Does not include cash tips.', 'tests': ['not_null']}, {'name': 'payment_type', 'description': 'A numeric code signifying how the passenger paid for the trip', 'tests': ['not_null']}, {'name': 'trip_type', 'description': 'Year of pickup', 'tests': ['not_null']}, {'name': 'congestion_surcharge', 'description': 'An additional charge for trips taken during high traffic congestion times', 'tests': [None]}], 'original_file_path': 'models/tests/schema.yml', 'yaml_key': 'models', 'package_name': 'nyc_taxi'} - at path ['columns'][18]['tests'][0]: None is not valid under any of the given schemas
[2024-11-21T16:40:46.506+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T16:40:46.517+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 13.445 seconds
[2024-11-21T16:41:16.847+0000] {processor.py:161} INFO - Started process (PID=233) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T16:41:16.848+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T16:41:16.850+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:41:16.849+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T16:41:16.877+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:41:16.877+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T16:41:17.629+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:41:17.629+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 0.7404236909999895
[2024-11-21T16:41:17.630+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:41:17.630+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T16:41:17.630+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:41:17.630+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T16:41:17.634+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:41:17.634+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T16:41:17.641+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:41:17.641+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T16:41:17.647+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:41:17.646+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpf5fzc77l --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T16:41:24.275+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:41:24.275+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpf5fzc77l --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T16:41:31.184+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:41:31.180+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 210, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpf5fzc77l', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
16:41:26  Running with dbt=1.8.7
16:41:27  Registered adapter: bigquery=1.8.3
16:41:28  Encountered an error:
Parsing Error
  Invalid models config given in models/tests/schema.yml @ models: {'name': 'fct_trips', 'description': 'Fact Table of tripdata', 'columns': [{'name': 'trip_id', 'description': 'The primary key for this table', 'tests': ['unique']}, {'name': 'vendor_id', 'description': 'A code indicating the TPEP provider that provided the record', 'tests': ['not_null']}, {'name': 'pickup_time_id', 'description': 'id to get pickup time from dim_time', 'tests': ['not_null']}, {'name': 'dropoff_time_id', 'description': 'id to get dropoff time from dim_time', 'tests': ['unique']}, {'name': 'rate_code_id', 'description': 'The final rate code in effect at the end of the trip', 'tests': ['unique']}, {'name': 'pu_location_id', 'description': 'The pickup location', 'tests': ['not_null']}, {'name': 'do_location_id', 'description': 'The droppof location', 'tests': ['not_null']}, {'name': 'passenger_count', 'description': 'Customer count', 'tests': ['unique']}, {'name': 'trip_distance', 'description': 'trip distance', 'tests': ['not_null']}, {'name': 'fare_amount', 'description': 'The time-and-distance fare calculated by the meter.', 'tests': ['not_null']}, {'name': 'extra', 'description': 'Miscellaneous extras and surcharges. Currently, this only includes. the $0.50 and $1 rush hour and overnight charges', 'tests': ['not_null']}, {'name': 'mta_tax', 'description': '0.50 MTA tax that is automatically triggered based on the metered rate in use', 'tests': ['unique']}, {'name': 'tip_amount', 'description': 'Tip amount  This field is automatically populated for credit card tips.Cash tips are not included', 'tests': ['not_null']}, {'name': 'tolls_amount', 'description': 'Total amount of all tolls paid in trip', 'tests': ['not_null']}, {'name': 'improvement_surcharge', 'description': '0.30 improvement surcharge assessed trips at the flag drop. the improvement surcharge began being levied in 2015', 'tests': ['not_null']}, {'name': 'total_amount', 'description': 'The total amount charged to passengers. Does not include cash tips.', 'tests': ['not_null']}, {'name': 'payment_type', 'description': 'A numeric code signifying how the passenger paid for the trip', 'tests': ['not_null']}, {'name': 'trip_type', 'description': 'Year of pickup', 'tests': ['not_null']}, {'name': 'congestion_surcharge', 'description': 'An additional charge for trips taken during high traffic congestion times', 'tests': [None]}], 'original_file_path': 'models/tests/schema.yml', 'yaml_key': 'models', 'package_name': 'nyc_taxi'} - at path ['columns'][18]['tests'][0]: None is not valid under any of the given schemas
[2024-11-21T16:41:31.185+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T16:41:31.195+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 14.355 seconds
[2024-11-21T16:42:01.617+0000] {processor.py:161} INFO - Started process (PID=278) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T16:42:01.617+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T16:42:01.619+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:42:01.618+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T16:42:01.640+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:42:01.640+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T16:42:02.457+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:42:02.457+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 0.8071105500000613
[2024-11-21T16:42:02.458+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:42:02.458+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T16:42:02.458+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:42:02.458+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T16:42:02.464+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:42:02.464+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T16:42:02.471+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:42:02.471+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T16:42:02.479+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:42:02.478+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp4fdcfnnz --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T16:42:08.181+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:42:08.181+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp4fdcfnnz --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T16:42:14.840+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:42:14.837+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 210, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmp4fdcfnnz', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
16:42:10  Running with dbt=1.8.7
16:42:11  Registered adapter: bigquery=1.8.3
16:42:12  Encountered an error:
Parsing Error
  Invalid models config given in models/tests/schema.yml @ models: {'name': 'fct_trips', 'description': 'Fact Table of tripdata', 'columns': [{'name': 'trip_id', 'description': 'The primary key for this table', 'tests': ['unique']}, {'name': 'vendor_id', 'description': 'A code indicating the TPEP provider that provided the record', 'tests': ['not_null']}, {'name': 'pickup_time_id', 'description': 'id to get pickup time from dim_time', 'tests': ['not_null']}, {'name': 'dropoff_time_id', 'description': 'id to get dropoff time from dim_time', 'tests': ['unique']}, {'name': 'rate_code_id', 'description': 'The final rate code in effect at the end of the trip', 'tests': ['unique']}, {'name': 'pu_location_id', 'description': 'The pickup location', 'tests': ['not_null']}, {'name': 'do_location_id', 'description': 'The droppof location', 'tests': ['not_null']}, {'name': 'passenger_count', 'description': 'Customer count', 'tests': ['unique']}, {'name': 'trip_distance', 'description': 'trip distance', 'tests': ['not_null']}, {'name': 'fare_amount', 'description': 'The time-and-distance fare calculated by the meter.', 'tests': ['not_null']}, {'name': 'extra', 'description': 'Miscellaneous extras and surcharges. Currently, this only includes. the $0.50 and $1 rush hour and overnight charges', 'tests': ['not_null']}, {'name': 'mta_tax', 'description': '0.50 MTA tax that is automatically triggered based on the metered rate in use', 'tests': ['unique']}, {'name': 'tip_amount', 'description': 'Tip amount  This field is automatically populated for credit card tips.Cash tips are not included', 'tests': ['not_null']}, {'name': 'tolls_amount', 'description': 'Total amount of all tolls paid in trip', 'tests': ['not_null']}, {'name': 'improvement_surcharge', 'description': '0.30 improvement surcharge assessed trips at the flag drop. the improvement surcharge began being levied in 2015', 'tests': ['not_null']}, {'name': 'total_amount', 'description': 'The total amount charged to passengers. Does not include cash tips.', 'tests': ['not_null']}, {'name': 'payment_type', 'description': 'A numeric code signifying how the passenger paid for the trip', 'tests': ['not_null']}, {'name': 'trip_type', 'description': 'Year of pickup', 'tests': ['not_null']}, {'name': 'congestion_surcharge', 'description': 'An additional charge for trips taken during high traffic congestion times', 'tests': [None]}], 'original_file_path': 'models/tests/schema.yml', 'yaml_key': 'models', 'package_name': 'nyc_taxi'} - at path ['columns'][18]['tests'][0]: None is not valid under any of the given schemas
[2024-11-21T16:42:14.841+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T16:42:14.851+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 13.913 seconds
[2024-11-21T16:42:45.329+0000] {processor.py:161} INFO - Started process (PID=330) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T16:42:45.331+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T16:42:45.332+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:42:45.332+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T16:42:45.354+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:42:45.354+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T16:42:46.172+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:42:46.172+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 0.8065452580000283
[2024-11-21T16:42:46.173+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:42:46.173+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T16:42:46.173+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:42:46.173+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T16:42:46.178+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:42:46.177+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T16:42:46.186+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:42:46.185+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T16:42:46.192+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:42:46.192+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmph8kdvfdc --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T16:42:51.524+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:42:51.523+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmph8kdvfdc --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T16:42:58.644+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:42:58.622+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 210, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmph8kdvfdc', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
16:42:53  Running with dbt=1.8.7
16:42:55  Registered adapter: bigquery=1.8.3
16:42:56  Encountered an error:
Parsing Error
  Invalid models config given in models/tests/schema.yml @ models: {'name': 'fct_trips', 'description': 'Fact Table of tripdata', 'columns': [{'name': 'trip_id', 'description': 'The primary key for this table', 'tests': ['unique']}, {'name': 'vendor_id', 'description': 'A code indicating the TPEP provider that provided the record', 'tests': ['not_null']}, {'name': 'pickup_time_id', 'description': 'id to get pickup time from dim_time', 'tests': ['not_null']}, {'name': 'dropoff_time_id', 'description': 'id to get dropoff time from dim_time', 'tests': ['unique']}, {'name': 'rate_code_id', 'description': 'The final rate code in effect at the end of the trip', 'tests': ['unique']}, {'name': 'pu_location_id', 'description': 'The pickup location', 'tests': ['not_null']}, {'name': 'do_location_id', 'description': 'The droppof location', 'tests': ['not_null']}, {'name': 'passenger_count', 'description': 'Customer count', 'tests': ['unique']}, {'name': 'trip_distance', 'description': 'trip distance', 'tests': ['not_null']}, {'name': 'fare_amount', 'description': 'The time-and-distance fare calculated by the meter.', 'tests': ['not_null']}, {'name': 'extra', 'description': 'Miscellaneous extras and surcharges. Currently, this only includes. the $0.50 and $1 rush hour and overnight charges', 'tests': ['not_null']}, {'name': 'mta_tax', 'description': '0.50 MTA tax that is automatically triggered based on the metered rate in use', 'tests': ['unique']}, {'name': 'tip_amount', 'description': 'Tip amount  This field is automatically populated for credit card tips.Cash tips are not included', 'tests': ['not_null']}, {'name': 'tolls_amount', 'description': 'Total amount of all tolls paid in trip', 'tests': ['not_null']}, {'name': 'improvement_surcharge', 'description': '0.30 improvement surcharge assessed trips at the flag drop. the improvement surcharge began being levied in 2015', 'tests': ['not_null']}, {'name': 'total_amount', 'description': 'The total amount charged to passengers. Does not include cash tips.', 'tests': ['not_null']}, {'name': 'payment_type', 'description': 'A numeric code signifying how the passenger paid for the trip', 'tests': ['not_null']}, {'name': 'trip_type', 'description': 'Year of pickup', 'tests': ['not_null']}, {'name': 'congestion_surcharge', 'description': 'An additional charge for trips taken during high traffic congestion times', 'tests': [None]}], 'original_file_path': 'models/tests/schema.yml', 'yaml_key': 'models', 'package_name': 'nyc_taxi'} - at path ['columns'][18]['tests'][0]: None is not valid under any of the given schemas
[2024-11-21T16:42:58.645+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T16:42:58.657+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 13.333 seconds
[2024-11-21T16:43:28.978+0000] {processor.py:161} INFO - Started process (PID=375) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T16:43:28.978+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T16:43:28.980+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:43:28.980+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T16:43:29.019+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:43:29.019+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T16:43:31.562+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:43:31.561+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 2.5315108159999227
[2024-11-21T16:43:31.562+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:43:31.562+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T16:43:31.563+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:43:31.562+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T16:43:31.567+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:43:31.567+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T16:43:31.575+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:43:31.575+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T16:43:31.582+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:43:31.582+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp_a7jw4_r --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T16:43:36.833+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:43:36.832+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp_a7jw4_r --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T16:43:44.316+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:43:44.312+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 210, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmp_a7jw4_r', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
16:43:39  Running with dbt=1.8.7
16:43:40  Registered adapter: bigquery=1.8.3
16:43:41  Encountered an error:
Parsing Error
  Invalid models config given in models/tests/schema.yml @ models: {'name': 'fct_trips', 'description': 'Fact Table of tripdata', 'columns': [{'name': 'trip_id', 'description': 'The primary key for this table', 'tests': ['unique']}, {'name': 'vendor_id', 'description': 'A code indicating the TPEP provider that provided the record', 'tests': ['not_null']}, {'name': 'pickup_time_id', 'description': 'id to get pickup time from dim_time', 'tests': ['not_null']}, {'name': 'dropoff_time_id', 'description': 'id to get dropoff time from dim_time', 'tests': ['unique']}, {'name': 'rate_code_id', 'description': 'The final rate code in effect at the end of the trip', 'tests': ['unique']}, {'name': 'pu_location_id', 'description': 'The pickup location', 'tests': ['not_null']}, {'name': 'do_location_id', 'description': 'The droppof location', 'tests': ['not_null']}, {'name': 'passenger_count', 'description': 'Customer count', 'tests': ['unique']}, {'name': 'trip_distance', 'description': 'trip distance', 'tests': ['not_null']}, {'name': 'fare_amount', 'description': 'The time-and-distance fare calculated by the meter.', 'tests': ['not_null']}, {'name': 'extra', 'description': 'Miscellaneous extras and surcharges. Currently, this only includes. the $0.50 and $1 rush hour and overnight charges', 'tests': ['not_null']}, {'name': 'mta_tax', 'description': '0.50 MTA tax that is automatically triggered based on the metered rate in use', 'tests': ['unique']}, {'name': 'tip_amount', 'description': 'Tip amount  This field is automatically populated for credit card tips.Cash tips are not included', 'tests': ['not_null']}, {'name': 'tolls_amount', 'description': 'Total amount of all tolls paid in trip', 'tests': ['not_null']}, {'name': 'improvement_surcharge', 'description': '0.30 improvement surcharge assessed trips at the flag drop. the improvement surcharge began being levied in 2015', 'tests': ['not_null']}, {'name': 'total_amount', 'description': 'The total amount charged to passengers. Does not include cash tips.', 'tests': ['not_null']}, {'name': 'payment_type', 'description': 'A numeric code signifying how the passenger paid for the trip', 'tests': ['not_null']}, {'name': 'trip_type', 'description': 'Year of pickup', 'tests': ['not_null']}, {'name': 'congestion_surcharge', 'description': 'An additional charge for trips taken during high traffic congestion times', 'tests': [None]}], 'original_file_path': 'models/tests/schema.yml', 'yaml_key': 'models', 'package_name': 'nyc_taxi'} - at path ['columns'][18]['tests'][0]: None is not valid under any of the given schemas
[2024-11-21T16:43:44.317+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T16:43:44.327+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 16.145 seconds
[2024-11-21T16:44:14.964+0000] {processor.py:161} INFO - Started process (PID=427) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T16:44:14.965+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T16:44:14.966+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:44:14.966+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T16:44:14.988+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:44:14.988+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T16:44:15.710+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:44:15.710+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 0.710761797000032
[2024-11-21T16:44:15.711+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:44:15.710+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T16:44:15.711+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:44:15.711+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T16:44:15.715+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:44:15.715+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T16:44:15.721+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:44:15.721+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T16:44:15.727+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:44:15.727+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp_wfrdjso --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T16:44:20.605+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:44:20.605+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp_wfrdjso --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T16:44:26.910+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:44:26.907+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 210, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmp_wfrdjso', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
16:44:22  Running with dbt=1.8.7
16:44:24  Registered adapter: bigquery=1.8.3
16:44:25  Encountered an error:
Parsing Error
  Invalid models config given in models/tests/schema.yml @ models: {'name': 'fct_trips', 'description': 'Fact Table of tripdata', 'columns': [{'name': 'trip_id', 'description': 'The primary key for this table', 'tests': ['unique']}, {'name': 'vendor_id', 'description': 'A code indicating the TPEP provider that provided the record', 'tests': ['not_null']}, {'name': 'pickup_time_id', 'description': 'id to get pickup time from dim_time', 'tests': ['not_null']}, {'name': 'dropoff_time_id', 'description': 'id to get dropoff time from dim_time', 'tests': ['unique']}, {'name': 'rate_code_id', 'description': 'The final rate code in effect at the end of the trip', 'tests': ['unique']}, {'name': 'pu_location_id', 'description': 'The pickup location', 'tests': ['not_null']}, {'name': 'do_location_id', 'description': 'The droppof location', 'tests': ['not_null']}, {'name': 'passenger_count', 'description': 'Customer count', 'tests': ['unique']}, {'name': 'trip_distance', 'description': 'trip distance', 'tests': ['not_null']}, {'name': 'fare_amount', 'description': 'The time-and-distance fare calculated by the meter.', 'tests': ['not_null']}, {'name': 'extra', 'description': 'Miscellaneous extras and surcharges. Currently, this only includes. the $0.50 and $1 rush hour and overnight charges', 'tests': ['not_null']}, {'name': 'mta_tax', 'description': '0.50 MTA tax that is automatically triggered based on the metered rate in use', 'tests': ['unique']}, {'name': 'tip_amount', 'description': 'Tip amount  This field is automatically populated for credit card tips.Cash tips are not included', 'tests': ['not_null']}, {'name': 'tolls_amount', 'description': 'Total amount of all tolls paid in trip', 'tests': ['not_null']}, {'name': 'improvement_surcharge', 'description': '0.30 improvement surcharge assessed trips at the flag drop. the improvement surcharge began being levied in 2015', 'tests': ['not_null']}, {'name': 'total_amount', 'description': 'The total amount charged to passengers. Does not include cash tips.', 'tests': ['not_null']}, {'name': 'payment_type', 'description': 'A numeric code signifying how the passenger paid for the trip', 'tests': ['not_null']}, {'name': 'trip_type', 'description': 'Year of pickup', 'tests': ['not_null']}, {'name': 'congestion_surcharge', 'description': 'An additional charge for trips taken during high traffic congestion times', 'tests': [None]}], 'original_file_path': 'models/tests/schema.yml', 'yaml_key': 'models', 'package_name': 'nyc_taxi'} - at path ['columns'][18]['tests'][0]: None is not valid under any of the given schemas
[2024-11-21T16:44:26.911+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T16:44:26.922+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 11.963 seconds
[2024-11-21T16:44:57.525+0000] {processor.py:161} INFO - Started process (PID=472) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T16:44:57.526+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T16:44:57.527+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:44:57.527+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T16:44:57.549+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:44:57.549+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T16:44:58.317+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:44:58.317+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 0.7583333829999219
[2024-11-21T16:44:58.318+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:44:58.317+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T16:44:58.318+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:44:58.318+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T16:44:58.322+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:44:58.322+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T16:44:58.328+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:44:58.328+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T16:44:58.335+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:44:58.334+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpn6vl87_d --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T16:45:02.870+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:45:02.870+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpn6vl87_d --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T16:45:09.351+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:45:09.348+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 210, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpn6vl87_d', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
16:45:05  Running with dbt=1.8.7
16:45:06  Registered adapter: bigquery=1.8.3
16:45:07  Encountered an error:
Parsing Error
  Invalid models config given in models/tests/schema.yml @ models: {'name': 'fct_trips', 'description': 'Fact Table of tripdata', 'columns': [{'name': 'trip_id', 'description': 'The primary key for this table', 'tests': ['unique']}, {'name': 'vendor_id', 'description': 'A code indicating the TPEP provider that provided the record', 'tests': ['not_null']}, {'name': 'pickup_time_id', 'description': 'id to get pickup time from dim_time', 'tests': ['not_null']}, {'name': 'dropoff_time_id', 'description': 'id to get dropoff time from dim_time', 'tests': ['unique']}, {'name': 'rate_code_id', 'description': 'The final rate code in effect at the end of the trip', 'tests': ['unique']}, {'name': 'pu_location_id', 'description': 'The pickup location', 'tests': ['not_null']}, {'name': 'do_location_id', 'description': 'The droppof location', 'tests': ['not_null']}, {'name': 'passenger_count', 'description': 'Customer count', 'tests': ['unique']}, {'name': 'trip_distance', 'description': 'trip distance', 'tests': ['not_null']}, {'name': 'fare_amount', 'description': 'The time-and-distance fare calculated by the meter.', 'tests': ['not_null']}, {'name': 'extra', 'description': 'Miscellaneous extras and surcharges. Currently, this only includes. the $0.50 and $1 rush hour and overnight charges', 'tests': ['not_null']}, {'name': 'mta_tax', 'description': '0.50 MTA tax that is automatically triggered based on the metered rate in use', 'tests': ['unique']}, {'name': 'tip_amount', 'description': 'Tip amount  This field is automatically populated for credit card tips.Cash tips are not included', 'tests': ['not_null']}, {'name': 'tolls_amount', 'description': 'Total amount of all tolls paid in trip', 'tests': ['not_null']}, {'name': 'improvement_surcharge', 'description': '0.30 improvement surcharge assessed trips at the flag drop. the improvement surcharge began being levied in 2015', 'tests': ['not_null']}, {'name': 'total_amount', 'description': 'The total amount charged to passengers. Does not include cash tips.', 'tests': ['not_null']}, {'name': 'payment_type', 'description': 'A numeric code signifying how the passenger paid for the trip', 'tests': ['not_null']}, {'name': 'trip_type', 'description': 'Year of pickup', 'tests': ['not_null']}, {'name': 'congestion_surcharge', 'description': 'An additional charge for trips taken during high traffic congestion times', 'tests': [None]}], 'original_file_path': 'models/tests/schema.yml', 'yaml_key': 'models', 'package_name': 'nyc_taxi'} - at path ['columns'][18]['tests'][0]: None is not valid under any of the given schemas
[2024-11-21T16:45:09.352+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T16:45:09.368+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 12.822 seconds
[2024-11-21T16:45:40.213+0000] {processor.py:161} INFO - Started process (PID=523) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T16:45:40.214+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T16:45:40.216+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:45:40.215+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T16:45:40.240+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:45:40.240+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T16:45:41.085+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:45:41.085+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 0.8348764869999741
[2024-11-21T16:45:41.086+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:45:41.085+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T16:45:41.086+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:45:41.086+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T16:45:41.090+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:45:41.090+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T16:45:41.096+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:45:41.096+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T16:45:41.102+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:45:41.102+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpdouqfuuj --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T16:45:46.037+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:45:46.036+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpdouqfuuj --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T16:45:52.547+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:45:52.543+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 210, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpdouqfuuj', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
16:45:48  Running with dbt=1.8.7
16:45:49  Registered adapter: bigquery=1.8.3
16:45:50  Encountered an error:
Parsing Error
  Invalid models config given in models/tests/schema.yml @ models: {'name': 'fct_trips', 'description': 'Fact Table of tripdata', 'columns': [{'name': 'trip_id', 'description': 'The primary key for this table', 'tests': ['unique']}, {'name': 'vendor_id', 'description': 'A code indicating the TPEP provider that provided the record', 'tests': ['not_null']}, {'name': 'pickup_time_id', 'description': 'id to get pickup time from dim_time', 'tests': ['not_null']}, {'name': 'dropoff_time_id', 'description': 'id to get dropoff time from dim_time', 'tests': ['unique']}, {'name': 'rate_code_id', 'description': 'The final rate code in effect at the end of the trip', 'tests': ['unique']}, {'name': 'pu_location_id', 'description': 'The pickup location', 'tests': ['not_null']}, {'name': 'do_location_id', 'description': 'The droppof location', 'tests': ['not_null']}, {'name': 'passenger_count', 'description': 'Customer count', 'tests': ['unique']}, {'name': 'trip_distance', 'description': 'trip distance', 'tests': ['not_null']}, {'name': 'fare_amount', 'description': 'The time-and-distance fare calculated by the meter.', 'tests': ['not_null']}, {'name': 'extra', 'description': 'Miscellaneous extras and surcharges. Currently, this only includes. the $0.50 and $1 rush hour and overnight charges', 'tests': ['not_null']}, {'name': 'mta_tax', 'description': '0.50 MTA tax that is automatically triggered based on the metered rate in use', 'tests': ['unique']}, {'name': 'tip_amount', 'description': 'Tip amount  This field is automatically populated for credit card tips.Cash tips are not included', 'tests': ['not_null']}, {'name': 'tolls_amount', 'description': 'Total amount of all tolls paid in trip', 'tests': ['not_null']}, {'name': 'improvement_surcharge', 'description': '0.30 improvement surcharge assessed trips at the flag drop. the improvement surcharge began being levied in 2015', 'tests': ['not_null']}, {'name': 'total_amount', 'description': 'The total amount charged to passengers. Does not include cash tips.', 'tests': ['not_null']}, {'name': 'payment_type', 'description': 'A numeric code signifying how the passenger paid for the trip', 'tests': ['not_null']}, {'name': 'trip_type', 'description': 'Year of pickup', 'tests': ['not_null']}, {'name': 'congestion_surcharge', 'description': 'An additional charge for trips taken during high traffic congestion times', 'tests': [None]}], 'original_file_path': 'models/tests/schema.yml', 'yaml_key': 'models', 'package_name': 'nyc_taxi'} - at path ['columns'][18]['tests'][0]: None is not valid under any of the given schemas
[2024-11-21T16:45:52.547+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T16:45:52.563+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 12.356 seconds
[2024-11-21T16:46:22.872+0000] {processor.py:161} INFO - Started process (PID=569) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T16:46:22.873+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T16:46:22.874+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:46:22.874+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T16:46:22.901+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:46:22.900+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T16:46:23.733+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:46:23.733+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 0.8185850880000771
[2024-11-21T16:46:23.734+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:46:23.733+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T16:46:23.734+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:46:23.734+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T16:46:23.739+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:46:23.738+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T16:46:23.745+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:46:23.745+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T16:46:23.751+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:46:23.751+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpiogxtsg5 --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T16:46:28.683+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:46:28.683+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpiogxtsg5 --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T16:46:38.790+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:46:38.787+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 210, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpiogxtsg5', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
16:46:31  Running with dbt=1.8.7
16:46:32  Registered adapter: bigquery=1.8.3
16:46:33  Encountered an error:
Parsing Error
  Invalid models config given in models/tests/schema.yml @ models: {'name': 'fct_trips', 'description': 'Fact Table of tripdata', 'columns': [{'name': 'trip_id', 'description': 'The primary key for this table', 'tests': ['unique']}, {'name': 'vendor_id', 'description': 'A code indicating the TPEP provider that provided the record', 'tests': ['not_null']}, {'name': 'pickup_time_id', 'description': 'id to get pickup time from dim_time', 'tests': ['not_null']}, {'name': 'dropoff_time_id', 'description': 'id to get dropoff time from dim_time', 'tests': ['unique']}, {'name': 'rate_code_id', 'description': 'The final rate code in effect at the end of the trip', 'tests': ['unique']}, {'name': 'pu_location_id', 'description': 'The pickup location', 'tests': ['not_null']}, {'name': 'do_location_id', 'description': 'The droppof location', 'tests': ['not_null']}, {'name': 'passenger_count', 'description': 'Customer count', 'tests': ['unique']}, {'name': 'trip_distance', 'description': 'trip distance', 'tests': ['not_null']}, {'name': 'fare_amount', 'description': 'The time-and-distance fare calculated by the meter.', 'tests': ['not_null']}, {'name': 'extra', 'description': 'Miscellaneous extras and surcharges. Currently, this only includes. the $0.50 and $1 rush hour and overnight charges', 'tests': ['not_null']}, {'name': 'mta_tax', 'description': '0.50 MTA tax that is automatically triggered based on the metered rate in use', 'tests': ['unique']}, {'name': 'tip_amount', 'description': 'Tip amount  This field is automatically populated for credit card tips.Cash tips are not included', 'tests': ['not_null']}, {'name': 'tolls_amount', 'description': 'Total amount of all tolls paid in trip', 'tests': ['not_null']}, {'name': 'improvement_surcharge', 'description': '0.30 improvement surcharge assessed trips at the flag drop. the improvement surcharge began being levied in 2015', 'tests': ['not_null']}, {'name': 'total_amount', 'description': 'The total amount charged to passengers. Does not include cash tips.', 'tests': ['not_null']}, {'name': 'payment_type', 'description': 'A numeric code signifying how the passenger paid for the trip', 'tests': ['not_null']}, {'name': 'trip_type', 'description': 'Year of pickup', 'tests': ['not_null']}, {'name': 'congestion_surcharge', 'description': 'An additional charge for trips taken during high traffic congestion times', 'tests': [None]}], 'original_file_path': 'models/tests/schema.yml', 'yaml_key': 'models', 'package_name': 'nyc_taxi'} - at path ['columns'][18]['tests'][0]: None is not valid under any of the given schemas
[2024-11-21T16:46:38.791+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T16:46:38.803+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 16.828 seconds
[2024-11-21T16:47:09.632+0000] {processor.py:161} INFO - Started process (PID=620) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T16:47:09.633+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T16:47:09.635+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:47:09.635+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T16:47:09.658+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:47:09.658+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T16:47:10.459+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:47:10.459+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 0.790013445999989
[2024-11-21T16:47:10.460+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:47:10.460+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T16:47:10.460+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:47:10.460+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T16:47:10.465+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:47:10.464+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T16:47:10.471+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:47:10.471+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T16:47:10.477+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:47:10.477+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpakgegi8p --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T16:47:16.386+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:47:16.385+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpakgegi8p --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T16:47:23.183+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:47:23.179+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 210, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpakgegi8p', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
16:47:18  Running with dbt=1.8.7
16:47:20  Registered adapter: bigquery=1.8.3
16:47:21  Encountered an error:
Parsing Error
  Invalid models config given in models/tests/schema.yml @ models: {'name': 'fct_trips', 'description': 'Fact Table of tripdata', 'columns': [{'name': 'trip_id', 'description': 'The primary key for this table', 'tests': ['unique']}, {'name': 'vendor_id', 'description': 'A code indicating the TPEP provider that provided the record', 'tests': ['not_null']}, {'name': 'pickup_time_id', 'description': 'id to get pickup time from dim_time', 'tests': ['not_null']}, {'name': 'dropoff_time_id', 'description': 'id to get dropoff time from dim_time', 'tests': ['unique']}, {'name': 'rate_code_id', 'description': 'The final rate code in effect at the end of the trip', 'tests': ['unique']}, {'name': 'pu_location_id', 'description': 'The pickup location', 'tests': ['not_null']}, {'name': 'do_location_id', 'description': 'The droppof location', 'tests': ['not_null']}, {'name': 'passenger_count', 'description': 'Customer count', 'tests': ['unique']}, {'name': 'trip_distance', 'description': 'trip distance', 'tests': ['not_null']}, {'name': 'fare_amount', 'description': 'The time-and-distance fare calculated by the meter.', 'tests': ['not_null']}, {'name': 'extra', 'description': 'Miscellaneous extras and surcharges. Currently, this only includes. the $0.50 and $1 rush hour and overnight charges', 'tests': ['not_null']}, {'name': 'mta_tax', 'description': '0.50 MTA tax that is automatically triggered based on the metered rate in use', 'tests': ['unique']}, {'name': 'tip_amount', 'description': 'Tip amount  This field is automatically populated for credit card tips.Cash tips are not included', 'tests': ['not_null']}, {'name': 'tolls_amount', 'description': 'Total amount of all tolls paid in trip', 'tests': ['not_null']}, {'name': 'improvement_surcharge', 'description': '0.30 improvement surcharge assessed trips at the flag drop. the improvement surcharge began being levied in 2015', 'tests': ['not_null']}, {'name': 'total_amount', 'description': 'The total amount charged to passengers. Does not include cash tips.', 'tests': ['not_null']}, {'name': 'payment_type', 'description': 'A numeric code signifying how the passenger paid for the trip', 'tests': ['not_null']}, {'name': 'trip_type', 'description': 'Year of pickup', 'tests': ['not_null']}, {'name': 'congestion_surcharge', 'description': 'An additional charge for trips taken during high traffic congestion times', 'tests': [None]}], 'original_file_path': 'models/tests/schema.yml', 'yaml_key': 'models', 'package_name': 'nyc_taxi'} - at path ['columns'][18]['tests'][0]: None is not valid under any of the given schemas
[2024-11-21T16:47:23.184+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T16:47:23.194+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 13.567 seconds
[2024-11-21T16:47:53.377+0000] {processor.py:161} INFO - Started process (PID=666) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T16:47:53.377+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T16:47:53.379+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:47:53.379+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T16:47:53.401+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:47:53.400+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T16:47:54.189+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:47:54.189+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 0.7764731140000549
[2024-11-21T16:47:54.190+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:47:54.189+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T16:47:54.190+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:47:54.190+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T16:47:54.194+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:47:54.194+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T16:47:54.200+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:47:54.200+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T16:47:54.206+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:47:54.206+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpbr6mxepo --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T16:47:59.808+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:47:59.808+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpbr6mxepo --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T16:48:06.286+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:48:06.282+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 210, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpbr6mxepo', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
16:48:02  Running with dbt=1.8.7
16:48:03  Registered adapter: bigquery=1.8.3
16:48:04  Encountered an error:
Parsing Error
  Invalid models config given in models/tests/schema.yml @ models: {'name': 'fct_trips', 'description': 'Fact Table of tripdata', 'columns': [{'name': 'trip_id', 'description': 'The primary key for this table', 'tests': ['unique']}, {'name': 'vendor_id', 'description': 'A code indicating the TPEP provider that provided the record', 'tests': ['not_null']}, {'name': 'pickup_time_id', 'description': 'id to get pickup time from dim_time', 'tests': ['not_null']}, {'name': 'dropoff_time_id', 'description': 'id to get dropoff time from dim_time', 'tests': ['unique']}, {'name': 'rate_code_id', 'description': 'The final rate code in effect at the end of the trip', 'tests': ['unique']}, {'name': 'pu_location_id', 'description': 'The pickup location', 'tests': ['not_null']}, {'name': 'do_location_id', 'description': 'The droppof location', 'tests': ['not_null']}, {'name': 'passenger_count', 'description': 'Customer count', 'tests': ['unique']}, {'name': 'trip_distance', 'description': 'trip distance', 'tests': ['not_null']}, {'name': 'fare_amount', 'description': 'The time-and-distance fare calculated by the meter.', 'tests': ['not_null']}, {'name': 'extra', 'description': 'Miscellaneous extras and surcharges. Currently, this only includes. the $0.50 and $1 rush hour and overnight charges', 'tests': ['not_null']}, {'name': 'mta_tax', 'description': '0.50 MTA tax that is automatically triggered based on the metered rate in use', 'tests': ['unique']}, {'name': 'tip_amount', 'description': 'Tip amount  This field is automatically populated for credit card tips.Cash tips are not included', 'tests': ['not_null']}, {'name': 'tolls_amount', 'description': 'Total amount of all tolls paid in trip', 'tests': ['not_null']}, {'name': 'improvement_surcharge', 'description': '0.30 improvement surcharge assessed trips at the flag drop. the improvement surcharge began being levied in 2015', 'tests': ['not_null']}, {'name': 'total_amount', 'description': 'The total amount charged to passengers. Does not include cash tips.', 'tests': ['not_null']}, {'name': 'payment_type', 'description': 'A numeric code signifying how the passenger paid for the trip', 'tests': ['not_null']}, {'name': 'trip_type', 'description': 'Year of pickup', 'tests': ['not_null']}, {'name': 'congestion_surcharge', 'description': 'An additional charge for trips taken during high traffic congestion times', 'tests': [None]}], 'original_file_path': 'models/tests/schema.yml', 'yaml_key': 'models', 'package_name': 'nyc_taxi'} - at path ['columns'][18]['tests'][0]: None is not valid under any of the given schemas
[2024-11-21T16:48:06.287+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T16:48:06.303+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 13.765 seconds
[2024-11-21T16:48:36.795+0000] {processor.py:161} INFO - Started process (PID=717) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T16:48:36.796+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T16:48:36.797+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:48:36.797+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T16:48:36.821+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:48:36.821+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T16:48:37.729+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:48:37.729+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 0.8965319289999343
[2024-11-21T16:48:37.730+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:48:37.730+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T16:48:37.730+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:48:37.730+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T16:48:37.735+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:48:37.735+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T16:48:37.743+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:48:37.742+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T16:48:37.749+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:48:37.748+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp23bsahn2 --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T16:48:44.095+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:48:44.094+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp23bsahn2 --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T16:48:50.646+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:48:50.642+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 210, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmp23bsahn2', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
16:48:46  Running with dbt=1.8.7
16:48:47  Registered adapter: bigquery=1.8.3
16:48:48  Encountered an error:
Parsing Error
  Invalid models config given in models/tests/schema.yml @ models: {'name': 'fct_trips', 'description': 'Fact Table of tripdata', 'columns': [{'name': 'trip_id', 'description': 'The primary key for this table', 'tests': ['unique']}, {'name': 'vendor_id', 'description': 'A code indicating the TPEP provider that provided the record', 'tests': ['not_null']}, {'name': 'pickup_time_id', 'description': 'id to get pickup time from dim_time', 'tests': ['not_null']}, {'name': 'dropoff_time_id', 'description': 'id to get dropoff time from dim_time', 'tests': ['unique']}, {'name': 'rate_code_id', 'description': 'The final rate code in effect at the end of the trip', 'tests': ['unique']}, {'name': 'pu_location_id', 'description': 'The pickup location', 'tests': ['not_null']}, {'name': 'do_location_id', 'description': 'The droppof location', 'tests': ['not_null']}, {'name': 'passenger_count', 'description': 'Customer count', 'tests': ['unique']}, {'name': 'trip_distance', 'description': 'trip distance', 'tests': ['not_null']}, {'name': 'fare_amount', 'description': 'The time-and-distance fare calculated by the meter.', 'tests': ['not_null']}, {'name': 'extra', 'description': 'Miscellaneous extras and surcharges. Currently, this only includes. the $0.50 and $1 rush hour and overnight charges', 'tests': ['not_null']}, {'name': 'mta_tax', 'description': '0.50 MTA tax that is automatically triggered based on the metered rate in use', 'tests': ['unique']}, {'name': 'tip_amount', 'description': 'Tip amount  This field is automatically populated for credit card tips.Cash tips are not included', 'tests': ['not_null']}, {'name': 'tolls_amount', 'description': 'Total amount of all tolls paid in trip', 'tests': ['not_null']}, {'name': 'improvement_surcharge', 'description': '0.30 improvement surcharge assessed trips at the flag drop. the improvement surcharge began being levied in 2015', 'tests': ['not_null']}, {'name': 'total_amount', 'description': 'The total amount charged to passengers. Does not include cash tips.', 'tests': ['not_null']}, {'name': 'payment_type', 'description': 'A numeric code signifying how the passenger paid for the trip', 'tests': ['not_null']}, {'name': 'trip_type', 'description': 'Year of pickup', 'tests': ['not_null']}, {'name': 'congestion_surcharge', 'description': 'An additional charge for trips taken during high traffic congestion times', 'tests': [None]}], 'original_file_path': 'models/tests/schema.yml', 'yaml_key': 'models', 'package_name': 'nyc_taxi'} - at path ['columns'][18]['tests'][0]: None is not valid under any of the given schemas
[2024-11-21T16:48:50.646+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T16:48:50.657+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 13.867 seconds
[2024-11-21T16:49:21.285+0000] {processor.py:161} INFO - Started process (PID=763) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T16:49:21.286+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T16:49:21.287+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:49:21.287+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T16:49:21.315+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:49:21.314+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T16:49:22.142+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:49:22.141+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 0.8165250629999719
[2024-11-21T16:49:22.142+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:49:22.142+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T16:49:22.143+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:49:22.142+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T16:49:22.147+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:49:22.147+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T16:49:22.155+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:49:22.155+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T16:49:22.162+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:49:22.161+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp3uffhzql --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T16:49:26.869+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:49:26.868+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp3uffhzql --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T16:49:34.314+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:49:34.311+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 210, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmp3uffhzql', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
16:49:29  Running with dbt=1.8.7
16:49:30  Registered adapter: bigquery=1.8.3
16:49:31  Encountered an error:
Parsing Error
  Invalid models config given in models/tests/schema.yml @ models: {'name': 'fct_trips', 'description': 'Fact Table of tripdata', 'columns': [{'name': 'trip_id', 'description': 'The primary key for this table', 'tests': ['unique']}, {'name': 'vendor_id', 'description': 'A code indicating the TPEP provider that provided the record', 'tests': ['not_null']}, {'name': 'pickup_time_id', 'description': 'id to get pickup time from dim_time', 'tests': ['not_null']}, {'name': 'dropoff_time_id', 'description': 'id to get dropoff time from dim_time', 'tests': ['unique']}, {'name': 'rate_code_id', 'description': 'The final rate code in effect at the end of the trip', 'tests': ['unique']}, {'name': 'pu_location_id', 'description': 'The pickup location', 'tests': ['not_null']}, {'name': 'do_location_id', 'description': 'The droppof location', 'tests': ['not_null']}, {'name': 'passenger_count', 'description': 'Customer count', 'tests': ['unique']}, {'name': 'trip_distance', 'description': 'trip distance', 'tests': ['not_null']}, {'name': 'fare_amount', 'description': 'The time-and-distance fare calculated by the meter.', 'tests': ['not_null']}, {'name': 'extra', 'description': 'Miscellaneous extras and surcharges. Currently, this only includes. the $0.50 and $1 rush hour and overnight charges', 'tests': ['not_null']}, {'name': 'mta_tax', 'description': '0.50 MTA tax that is automatically triggered based on the metered rate in use', 'tests': ['unique']}, {'name': 'tip_amount', 'description': 'Tip amount  This field is automatically populated for credit card tips.Cash tips are not included', 'tests': ['not_null']}, {'name': 'tolls_amount', 'description': 'Total amount of all tolls paid in trip', 'tests': ['not_null']}, {'name': 'improvement_surcharge', 'description': '0.30 improvement surcharge assessed trips at the flag drop. the improvement surcharge began being levied in 2015', 'tests': ['not_null']}, {'name': 'total_amount', 'description': 'The total amount charged to passengers. Does not include cash tips.', 'tests': ['not_null']}, {'name': 'payment_type', 'description': 'A numeric code signifying how the passenger paid for the trip', 'tests': ['not_null']}, {'name': 'trip_type', 'description': 'Year of pickup', 'tests': ['not_null']}, {'name': 'congestion_surcharge', 'description': 'An additional charge for trips taken during high traffic congestion times', 'tests': [None]}], 'original_file_path': 'models/tests/schema.yml', 'yaml_key': 'models', 'package_name': 'nyc_taxi'} - at path ['columns'][18]['tests'][0]: None is not valid under any of the given schemas
[2024-11-21T16:49:34.315+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T16:49:34.325+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 13.755 seconds
[2024-11-21T16:50:04.744+0000] {processor.py:161} INFO - Started process (PID=814) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T16:50:04.745+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T16:50:04.746+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:50:04.746+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T16:50:04.769+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:50:04.769+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T16:50:05.522+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:50:05.522+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 0.7408499680000205
[2024-11-21T16:50:05.522+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:50:05.522+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T16:50:05.523+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:50:05.523+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T16:50:05.526+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:50:05.526+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T16:50:05.533+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:50:05.533+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T16:50:05.539+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:50:05.539+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpv1b8rgze --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T16:50:10.244+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:50:10.244+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpv1b8rgze --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T16:50:16.545+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:50:16.541+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 210, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpv1b8rgze', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
16:50:12  Running with dbt=1.8.7
16:50:14  Registered adapter: bigquery=1.8.3
16:50:14  Encountered an error:
Parsing Error
  Invalid models config given in models/tests/schema.yml @ models: {'name': 'fct_trips', 'description': 'Fact Table of tripdata', 'columns': [{'name': 'trip_id', 'description': 'The primary key for this table', 'tests': ['unique']}, {'name': 'vendor_id', 'description': 'A code indicating the TPEP provider that provided the record', 'tests': ['not_null']}, {'name': 'pickup_time_id', 'description': 'id to get pickup time from dim_time', 'tests': ['not_null']}, {'name': 'dropoff_time_id', 'description': 'id to get dropoff time from dim_time', 'tests': ['unique']}, {'name': 'rate_code_id', 'description': 'The final rate code in effect at the end of the trip', 'tests': ['unique']}, {'name': 'pu_location_id', 'description': 'The pickup location', 'tests': ['not_null']}, {'name': 'do_location_id', 'description': 'The droppof location', 'tests': ['not_null']}, {'name': 'passenger_count', 'description': 'Customer count', 'tests': ['unique']}, {'name': 'trip_distance', 'description': 'trip distance', 'tests': ['not_null']}, {'name': 'fare_amount', 'description': 'The time-and-distance fare calculated by the meter.', 'tests': ['not_null']}, {'name': 'extra', 'description': 'Miscellaneous extras and surcharges. Currently, this only includes. the $0.50 and $1 rush hour and overnight charges', 'tests': ['not_null']}, {'name': 'mta_tax', 'description': '0.50 MTA tax that is automatically triggered based on the metered rate in use', 'tests': ['unique']}, {'name': 'tip_amount', 'description': 'Tip amount  This field is automatically populated for credit card tips.Cash tips are not included', 'tests': ['not_null']}, {'name': 'tolls_amount', 'description': 'Total amount of all tolls paid in trip', 'tests': ['not_null']}, {'name': 'improvement_surcharge', 'description': '0.30 improvement surcharge assessed trips at the flag drop. the improvement surcharge began being levied in 2015', 'tests': ['not_null']}, {'name': 'total_amount', 'description': 'The total amount charged to passengers. Does not include cash tips.', 'tests': ['not_null']}, {'name': 'payment_type', 'description': 'A numeric code signifying how the passenger paid for the trip', 'tests': ['not_null']}, {'name': 'trip_type', 'description': 'Year of pickup', 'tests': ['not_null']}, {'name': 'congestion_surcharge', 'description': 'An additional charge for trips taken during high traffic congestion times', 'tests': [None]}], 'original_file_path': 'models/tests/schema.yml', 'yaml_key': 'models', 'package_name': 'nyc_taxi'} - at path ['columns'][18]['tests'][0]: None is not valid under any of the given schemas
[2024-11-21T16:50:16.545+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T16:50:16.560+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 11.821 seconds
[2024-11-21T16:50:46.981+0000] {processor.py:161} INFO - Started process (PID=860) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T16:50:46.982+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T16:50:46.983+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:50:46.983+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T16:50:47.006+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:50:47.006+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T16:50:47.765+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:50:47.765+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 0.7480666599999495
[2024-11-21T16:50:47.766+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:50:47.766+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T16:50:47.766+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:50:47.766+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T16:50:47.771+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:50:47.770+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T16:50:47.777+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:50:47.777+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T16:50:47.784+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:50:47.784+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmphbt25h9k --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T16:50:52.244+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:50:52.244+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmphbt25h9k --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T16:50:58.782+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:50:58.778+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 210, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmphbt25h9k', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
16:50:54  Running with dbt=1.8.7
16:50:55  Registered adapter: bigquery=1.8.3
16:50:56  Encountered an error:
Parsing Error
  Invalid models config given in models/tests/schema.yml @ models: {'name': 'fct_trips', 'description': 'Fact Table of tripdata', 'columns': [{'name': 'trip_id', 'description': 'The primary key for this table', 'tests': ['unique']}, {'name': 'vendor_id', 'description': 'A code indicating the TPEP provider that provided the record', 'tests': ['not_null']}, {'name': 'pickup_time_id', 'description': 'id to get pickup time from dim_time', 'tests': ['not_null']}, {'name': 'dropoff_time_id', 'description': 'id to get dropoff time from dim_time', 'tests': ['unique']}, {'name': 'rate_code_id', 'description': 'The final rate code in effect at the end of the trip', 'tests': ['unique']}, {'name': 'pu_location_id', 'description': 'The pickup location', 'tests': ['not_null']}, {'name': 'do_location_id', 'description': 'The droppof location', 'tests': ['not_null']}, {'name': 'passenger_count', 'description': 'Customer count', 'tests': ['unique']}, {'name': 'trip_distance', 'description': 'trip distance', 'tests': ['not_null']}, {'name': 'fare_amount', 'description': 'The time-and-distance fare calculated by the meter.', 'tests': ['not_null']}, {'name': 'extra', 'description': 'Miscellaneous extras and surcharges. Currently, this only includes. the $0.50 and $1 rush hour and overnight charges', 'tests': ['not_null']}, {'name': 'mta_tax', 'description': '0.50 MTA tax that is automatically triggered based on the metered rate in use', 'tests': ['unique']}, {'name': 'tip_amount', 'description': 'Tip amount  This field is automatically populated for credit card tips.Cash tips are not included', 'tests': ['not_null']}, {'name': 'tolls_amount', 'description': 'Total amount of all tolls paid in trip', 'tests': ['not_null']}, {'name': 'improvement_surcharge', 'description': '0.30 improvement surcharge assessed trips at the flag drop. the improvement surcharge began being levied in 2015', 'tests': ['not_null']}, {'name': 'total_amount', 'description': 'The total amount charged to passengers. Does not include cash tips.', 'tests': ['not_null']}, {'name': 'payment_type', 'description': 'A numeric code signifying how the passenger paid for the trip', 'tests': ['not_null']}, {'name': 'trip_type', 'description': 'Year of pickup', 'tests': ['not_null']}, {'name': 'congestion_surcharge', 'description': 'An additional charge for trips taken during high traffic congestion times', 'tests': [None]}], 'original_file_path': 'models/tests/schema.yml', 'yaml_key': 'models', 'package_name': 'nyc_taxi'} - at path ['columns'][18]['tests'][0]: None is not valid under any of the given schemas
[2024-11-21T16:50:58.783+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T16:50:58.792+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 12.656 seconds
[2024-11-21T16:51:29.685+0000] {processor.py:161} INFO - Started process (PID=911) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T16:51:29.686+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T16:51:29.687+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:51:29.687+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T16:51:29.710+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:51:29.710+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T16:51:30.456+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:51:30.456+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 0.7354849630000899
[2024-11-21T16:51:30.457+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:51:30.457+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T16:51:30.457+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:51:30.457+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T16:51:30.461+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:51:30.461+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T16:51:30.467+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:51:30.467+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T16:51:30.473+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:51:30.473+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp64qsdp5z --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T16:51:35.556+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:51:35.555+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp64qsdp5z --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T16:51:41.634+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:51:41.631+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 210, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmp64qsdp5z', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
16:51:37  Running with dbt=1.8.7
16:51:39  Registered adapter: bigquery=1.8.3
16:51:39  Encountered an error:
Parsing Error
  Invalid models config given in models/tests/schema.yml @ models: {'name': 'fct_trips', 'description': 'Fact Table of tripdata', 'columns': [{'name': 'trip_id', 'description': 'The primary key for this table', 'tests': ['unique']}, {'name': 'vendor_id', 'description': 'A code indicating the TPEP provider that provided the record', 'tests': ['not_null']}, {'name': 'pickup_time_id', 'description': 'id to get pickup time from dim_time', 'tests': ['not_null']}, {'name': 'dropoff_time_id', 'description': 'id to get dropoff time from dim_time', 'tests': ['unique']}, {'name': 'rate_code_id', 'description': 'The final rate code in effect at the end of the trip', 'tests': ['unique']}, {'name': 'pu_location_id', 'description': 'The pickup location', 'tests': ['not_null']}, {'name': 'do_location_id', 'description': 'The droppof location', 'tests': ['not_null']}, {'name': 'passenger_count', 'description': 'Customer count', 'tests': ['unique']}, {'name': 'trip_distance', 'description': 'trip distance', 'tests': ['not_null']}, {'name': 'fare_amount', 'description': 'The time-and-distance fare calculated by the meter.', 'tests': ['not_null']}, {'name': 'extra', 'description': 'Miscellaneous extras and surcharges. Currently, this only includes. the $0.50 and $1 rush hour and overnight charges', 'tests': ['not_null']}, {'name': 'mta_tax', 'description': '0.50 MTA tax that is automatically triggered based on the metered rate in use', 'tests': ['unique']}, {'name': 'tip_amount', 'description': 'Tip amount  This field is automatically populated for credit card tips.Cash tips are not included', 'tests': ['not_null']}, {'name': 'tolls_amount', 'description': 'Total amount of all tolls paid in trip', 'tests': ['not_null']}, {'name': 'improvement_surcharge', 'description': '0.30 improvement surcharge assessed trips at the flag drop. the improvement surcharge began being levied in 2015', 'tests': ['not_null']}, {'name': 'total_amount', 'description': 'The total amount charged to passengers. Does not include cash tips.', 'tests': ['not_null']}, {'name': 'payment_type', 'description': 'A numeric code signifying how the passenger paid for the trip', 'tests': ['not_null']}, {'name': 'trip_type', 'description': 'Year of pickup', 'tests': ['not_null']}, {'name': 'congestion_surcharge', 'description': 'An additional charge for trips taken during high traffic congestion times', 'tests': [None]}], 'original_file_path': 'models/tests/schema.yml', 'yaml_key': 'models', 'package_name': 'nyc_taxi'} - at path ['columns'][18]['tests'][0]: None is not valid under any of the given schemas
[2024-11-21T16:51:41.635+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T16:51:41.650+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 11.971 seconds
[2024-11-21T16:52:12.173+0000] {processor.py:161} INFO - Started process (PID=956) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T16:52:12.173+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T16:52:12.175+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:52:12.174+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T16:52:12.199+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:52:12.198+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T16:52:12.916+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:52:12.915+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 0.7059576809999726
[2024-11-21T16:52:12.916+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:52:12.916+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T16:52:12.917+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:52:12.916+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T16:52:12.920+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:52:12.920+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T16:52:12.927+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:52:12.927+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T16:52:12.933+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:52:12.932+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp0pixa574 --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T16:52:17.808+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:52:17.807+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp0pixa574 --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T16:52:24.287+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:52:24.283+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 210, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmp0pixa574', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
16:52:20  Running with dbt=1.8.7
16:52:21  Registered adapter: bigquery=1.8.3
16:52:22  Encountered an error:
Parsing Error
  Invalid models config given in models/tests/schema.yml @ models: {'name': 'fct_trips', 'description': 'Fact Table of tripdata', 'columns': [{'name': 'trip_id', 'description': 'The primary key for this table', 'tests': ['unique']}, {'name': 'vendor_id', 'description': 'A code indicating the TPEP provider that provided the record', 'tests': ['not_null']}, {'name': 'pickup_time_id', 'description': 'id to get pickup time from dim_time', 'tests': ['not_null']}, {'name': 'dropoff_time_id', 'description': 'id to get dropoff time from dim_time', 'tests': ['unique']}, {'name': 'rate_code_id', 'description': 'The final rate code in effect at the end of the trip', 'tests': ['unique']}, {'name': 'pu_location_id', 'description': 'The pickup location', 'tests': ['not_null']}, {'name': 'do_location_id', 'description': 'The droppof location', 'tests': ['not_null']}, {'name': 'passenger_count', 'description': 'Customer count', 'tests': ['unique']}, {'name': 'trip_distance', 'description': 'trip distance', 'tests': ['not_null']}, {'name': 'fare_amount', 'description': 'The time-and-distance fare calculated by the meter.', 'tests': ['not_null']}, {'name': 'extra', 'description': 'Miscellaneous extras and surcharges. Currently, this only includes. the $0.50 and $1 rush hour and overnight charges', 'tests': ['not_null']}, {'name': 'mta_tax', 'description': '0.50 MTA tax that is automatically triggered based on the metered rate in use', 'tests': ['unique']}, {'name': 'tip_amount', 'description': 'Tip amount  This field is automatically populated for credit card tips.Cash tips are not included', 'tests': ['not_null']}, {'name': 'tolls_amount', 'description': 'Total amount of all tolls paid in trip', 'tests': ['not_null']}, {'name': 'improvement_surcharge', 'description': '0.30 improvement surcharge assessed trips at the flag drop. the improvement surcharge began being levied in 2015', 'tests': ['not_null']}, {'name': 'total_amount', 'description': 'The total amount charged to passengers. Does not include cash tips.', 'tests': ['not_null']}, {'name': 'payment_type', 'description': 'A numeric code signifying how the passenger paid for the trip', 'tests': ['not_null']}, {'name': 'trip_type', 'description': 'Year of pickup', 'tests': ['not_null']}, {'name': 'congestion_surcharge', 'description': 'An additional charge for trips taken during high traffic congestion times', 'tests': [None]}], 'original_file_path': 'models/tests/schema.yml', 'yaml_key': 'models', 'package_name': 'nyc_taxi'} - at path ['columns'][18]['tests'][0]: None is not valid under any of the given schemas
[2024-11-21T16:52:24.287+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T16:52:24.303+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 12.998 seconds
[2024-11-21T16:52:54.821+0000] {processor.py:161} INFO - Started process (PID=1009) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T16:52:54.822+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T16:52:54.823+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:52:54.823+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T16:52:54.846+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:52:54.846+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T16:52:55.606+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:52:55.606+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 0.7486136019999776
[2024-11-21T16:52:55.607+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:52:55.606+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T16:52:55.607+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:52:55.607+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T16:52:55.611+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:52:55.611+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T16:52:55.619+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:52:55.618+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T16:52:55.625+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:52:55.624+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp2g9zxsze --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T16:53:00.477+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:53:00.476+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp2g9zxsze --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T16:53:06.812+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:53:06.809+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 210, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmp2g9zxsze', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
16:53:02  Running with dbt=1.8.7
16:53:04  Registered adapter: bigquery=1.8.3
16:53:04  Encountered an error:
Parsing Error
  Invalid models config given in models/tests/schema.yml @ models: {'name': 'fct_trips', 'description': 'Fact Table of tripdata', 'columns': [{'name': 'trip_id', 'description': 'The primary key for this table', 'tests': ['unique']}, {'name': 'vendor_id', 'description': 'A code indicating the TPEP provider that provided the record', 'tests': ['not_null']}, {'name': 'pickup_time_id', 'description': 'id to get pickup time from dim_time', 'tests': ['not_null']}, {'name': 'dropoff_time_id', 'description': 'id to get dropoff time from dim_time', 'tests': ['unique']}, {'name': 'rate_code_id', 'description': 'The final rate code in effect at the end of the trip', 'tests': ['unique']}, {'name': 'pu_location_id', 'description': 'The pickup location', 'tests': ['not_null']}, {'name': 'do_location_id', 'description': 'The droppof location', 'tests': ['not_null']}, {'name': 'passenger_count', 'description': 'Customer count', 'tests': ['unique']}, {'name': 'trip_distance', 'description': 'trip distance', 'tests': ['not_null']}, {'name': 'fare_amount', 'description': 'The time-and-distance fare calculated by the meter.', 'tests': ['not_null']}, {'name': 'extra', 'description': 'Miscellaneous extras and surcharges. Currently, this only includes. the $0.50 and $1 rush hour and overnight charges', 'tests': ['not_null']}, {'name': 'mta_tax', 'description': '0.50 MTA tax that is automatically triggered based on the metered rate in use', 'tests': ['unique']}, {'name': 'tip_amount', 'description': 'Tip amount  This field is automatically populated for credit card tips.Cash tips are not included', 'tests': ['not_null']}, {'name': 'tolls_amount', 'description': 'Total amount of all tolls paid in trip', 'tests': ['not_null']}, {'name': 'improvement_surcharge', 'description': '0.30 improvement surcharge assessed trips at the flag drop. the improvement surcharge began being levied in 2015', 'tests': ['not_null']}, {'name': 'total_amount', 'description': 'The total amount charged to passengers. Does not include cash tips.', 'tests': ['not_null']}, {'name': 'payment_type', 'description': 'A numeric code signifying how the passenger paid for the trip', 'tests': ['not_null']}, {'name': 'trip_type', 'description': 'Year of pickup', 'tests': ['not_null']}, {'name': 'congestion_surcharge', 'description': 'An additional charge for trips taken during high traffic congestion times', 'tests': [None]}], 'original_file_path': 'models/tests/schema.yml', 'yaml_key': 'models', 'package_name': 'nyc_taxi'} - at path ['columns'][18]['tests'][0]: None is not valid under any of the given schemas
[2024-11-21T16:53:06.813+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T16:53:06.829+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 12.013 seconds
[2024-11-21T16:53:37.221+0000] {processor.py:161} INFO - Started process (PID=1054) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T16:53:37.222+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T16:53:37.223+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:53:37.223+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T16:53:37.249+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:53:37.249+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T16:53:38.073+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:53:38.073+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 0.8125882210001691
[2024-11-21T16:53:38.074+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:53:38.074+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T16:53:38.074+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:53:38.074+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T16:53:38.078+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:53:38.078+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T16:53:38.085+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:53:38.084+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T16:53:38.091+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:53:38.091+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpvw1cnfil --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T16:53:43.885+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:53:43.885+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpvw1cnfil --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T16:53:49.167+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:53:49.164+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 210, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpvw1cnfil', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
16:53:45  Running with dbt=1.8.7
16:53:46  Registered adapter: bigquery=1.8.3
16:53:47  Encountered an error:
Parsing Error
  Invalid models config given in models/tests/schema.yml @ models: {'name': 'fct_trips', 'description': 'Fact Table of tripdata', 'columns': [{'name': 'trip_id', 'description': 'The primary key for this table', 'tests': ['unique']}, {'name': 'vendor_id', 'description': 'A code indicating the TPEP provider that provided the record', 'tests': ['not_null']}, {'name': 'pickup_time_id', 'description': 'id to get pickup time from dim_time', 'tests': ['not_null']}, {'name': 'dropoff_time_id', 'description': 'id to get dropoff time from dim_time', 'tests': ['unique']}, {'name': 'rate_code_id', 'description': 'The final rate code in effect at the end of the trip', 'tests': ['unique']}, {'name': 'pu_location_id', 'description': 'The pickup location', 'tests': ['not_null']}, {'name': 'do_location_id', 'description': 'The droppof location', 'tests': ['not_null']}, {'name': 'passenger_count', 'description': 'Customer count', 'tests': ['unique']}, {'name': 'trip_distance', 'description': 'trip distance', 'tests': ['not_null']}, {'name': 'fare_amount', 'description': 'The time-and-distance fare calculated by the meter.', 'tests': ['not_null']}, {'name': 'extra', 'description': 'Miscellaneous extras and surcharges. Currently, this only includes. the $0.50 and $1 rush hour and overnight charges', 'tests': ['not_null']}, {'name': 'mta_tax', 'description': '0.50 MTA tax that is automatically triggered based on the metered rate in use', 'tests': ['unique']}, {'name': 'tip_amount', 'description': 'Tip amount  This field is automatically populated for credit card tips.Cash tips are not included', 'tests': ['not_null']}, {'name': 'tolls_amount', 'description': 'Total amount of all tolls paid in trip', 'tests': ['not_null']}, {'name': 'improvement_surcharge', 'description': '0.30 improvement surcharge assessed trips at the flag drop. the improvement surcharge began being levied in 2015', 'tests': ['not_null']}, {'name': 'total_amount', 'description': 'The total amount charged to passengers. Does not include cash tips.', 'tests': ['not_null']}, {'name': 'payment_type', 'description': 'A numeric code signifying how the passenger paid for the trip', 'tests': ['not_null']}, {'name': 'trip_type', 'description': 'Year of pickup', 'tests': ['not_null']}, {'name': 'congestion_surcharge', 'description': 'An additional charge for trips taken during high traffic congestion times', 'tests': [None]}], 'original_file_path': 'models/tests/schema.yml', 'yaml_key': 'models', 'package_name': 'nyc_taxi'} - at path ['columns'][18]['tests'][0]: None is not valid under any of the given schemas
[2024-11-21T16:53:49.168+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T16:53:49.184+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 12.935 seconds
[2024-11-21T16:54:19.744+0000] {processor.py:161} INFO - Started process (PID=1106) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T16:54:19.745+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T16:54:19.746+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:54:19.746+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T16:54:19.767+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:54:19.767+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T16:54:20.510+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:54:20.510+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 0.7323817139999846
[2024-11-21T16:54:20.511+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:54:20.511+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T16:54:20.511+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:54:20.511+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T16:54:20.515+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:54:20.515+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T16:54:20.522+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:54:20.522+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T16:54:20.528+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:54:20.528+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp4lx4kjas --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T16:54:25.949+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:54:25.948+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp4lx4kjas --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T16:54:32.492+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:54:32.488+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 210, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmp4lx4kjas', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
16:54:28  Running with dbt=1.8.7
16:54:29  Registered adapter: bigquery=1.8.3
16:54:30  Encountered an error:
Parsing Error
  Invalid models config given in models/tests/schema.yml @ models: {'name': 'fct_trips', 'description': 'Fact Table of tripdata', 'columns': [{'name': 'trip_id', 'description': 'The primary key for this table', 'tests': ['unique']}, {'name': 'vendor_id', 'description': 'A code indicating the TPEP provider that provided the record', 'tests': ['not_null']}, {'name': 'pickup_time_id', 'description': 'id to get pickup time from dim_time', 'tests': ['not_null']}, {'name': 'dropoff_time_id', 'description': 'id to get dropoff time from dim_time', 'tests': ['unique']}, {'name': 'rate_code_id', 'description': 'The final rate code in effect at the end of the trip', 'tests': ['unique']}, {'name': 'pu_location_id', 'description': 'The pickup location', 'tests': ['not_null']}, {'name': 'do_location_id', 'description': 'The droppof location', 'tests': ['not_null']}, {'name': 'passenger_count', 'description': 'Customer count', 'tests': ['unique']}, {'name': 'trip_distance', 'description': 'trip distance', 'tests': ['not_null']}, {'name': 'fare_amount', 'description': 'The time-and-distance fare calculated by the meter.', 'tests': ['not_null']}, {'name': 'extra', 'description': 'Miscellaneous extras and surcharges. Currently, this only includes. the $0.50 and $1 rush hour and overnight charges', 'tests': ['not_null']}, {'name': 'mta_tax', 'description': '0.50 MTA tax that is automatically triggered based on the metered rate in use', 'tests': ['unique']}, {'name': 'tip_amount', 'description': 'Tip amount  This field is automatically populated for credit card tips.Cash tips are not included', 'tests': ['not_null']}, {'name': 'tolls_amount', 'description': 'Total amount of all tolls paid in trip', 'tests': ['not_null']}, {'name': 'improvement_surcharge', 'description': '0.30 improvement surcharge assessed trips at the flag drop. the improvement surcharge began being levied in 2015', 'tests': ['not_null']}, {'name': 'total_amount', 'description': 'The total amount charged to passengers. Does not include cash tips.', 'tests': ['not_null']}, {'name': 'payment_type', 'description': 'A numeric code signifying how the passenger paid for the trip', 'tests': ['not_null']}, {'name': 'trip_type', 'description': 'Year of pickup', 'tests': ['not_null']}, {'name': 'congestion_surcharge', 'description': 'An additional charge for trips taken during high traffic congestion times', 'tests': [None]}], 'original_file_path': 'models/tests/schema.yml', 'yaml_key': 'models', 'package_name': 'nyc_taxi'} - at path ['columns'][18]['tests'][0]: None is not valid under any of the given schemas
[2024-11-21T16:54:32.493+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T16:54:32.509+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 12.770 seconds
[2024-11-21T16:55:02.955+0000] {processor.py:161} INFO - Started process (PID=1151) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T16:55:02.956+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T16:55:02.958+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:55:02.957+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T16:55:02.980+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:55:02.980+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T16:55:03.714+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:55:03.714+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 0.7236106459999974
[2024-11-21T16:55:03.714+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:55:03.714+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T16:55:03.715+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:55:03.715+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T16:55:03.719+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:55:03.719+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T16:55:03.724+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:55:03.724+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T16:55:03.730+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:55:03.730+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp8kopdn7a --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T16:55:08.781+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:55:08.781+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp8kopdn7a --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T16:55:14.203+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:55:14.200+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 210, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmp8kopdn7a', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
16:55:11  Running with dbt=1.8.7
16:55:12  Registered adapter: bigquery=1.8.3
16:55:12  Encountered an error:
Parsing Error
  Invalid models config given in models/tests/schema.yml @ models: {'name': 'fct_trips', 'description': 'Fact Table of tripdata', 'columns': [{'name': 'trip_id', 'description': 'The primary key for this table', 'tests': ['unique']}, {'name': 'vendor_id', 'description': 'A code indicating the TPEP provider that provided the record', 'tests': ['not_null']}, {'name': 'pickup_time_id', 'description': 'id to get pickup time from dim_time', 'tests': ['not_null']}, {'name': 'dropoff_time_id', 'description': 'id to get dropoff time from dim_time', 'tests': ['unique']}, {'name': 'rate_code_id', 'description': 'The final rate code in effect at the end of the trip', 'tests': ['unique']}, {'name': 'pu_location_id', 'description': 'The pickup location', 'tests': ['not_null']}, {'name': 'do_location_id', 'description': 'The droppof location', 'tests': ['not_null']}, {'name': 'passenger_count', 'description': 'Customer count', 'tests': ['unique']}, {'name': 'trip_distance', 'description': 'trip distance', 'tests': ['not_null']}, {'name': 'fare_amount', 'description': 'The time-and-distance fare calculated by the meter.', 'tests': ['not_null']}, {'name': 'extra', 'description': 'Miscellaneous extras and surcharges. Currently, this only includes. the $0.50 and $1 rush hour and overnight charges', 'tests': ['not_null']}, {'name': 'mta_tax', 'description': '0.50 MTA tax that is automatically triggered based on the metered rate in use', 'tests': ['unique']}, {'name': 'tip_amount', 'description': 'Tip amount  This field is automatically populated for credit card tips.Cash tips are not included', 'tests': ['not_null']}, {'name': 'tolls_amount', 'description': 'Total amount of all tolls paid in trip', 'tests': ['not_null']}, {'name': 'improvement_surcharge', 'description': '0.30 improvement surcharge assessed trips at the flag drop. the improvement surcharge began being levied in 2015', 'tests': ['not_null']}, {'name': 'total_amount', 'description': 'The total amount charged to passengers. Does not include cash tips.', 'tests': ['not_null']}, {'name': 'payment_type', 'description': 'A numeric code signifying how the passenger paid for the trip', 'tests': ['not_null']}, {'name': 'trip_type', 'description': 'Year of pickup', 'tests': ['not_null']}, {'name': 'congestion_surcharge', 'description': 'An additional charge for trips taken during high traffic congestion times', 'tests': [None]}], 'original_file_path': 'models/tests/schema.yml', 'yaml_key': 'models', 'package_name': 'nyc_taxi'} - at path ['columns'][18]['tests'][0]: None is not valid under any of the given schemas
[2024-11-21T16:55:14.203+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T16:55:14.219+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 12.159 seconds
[2024-11-21T16:55:44.728+0000] {processor.py:161} INFO - Started process (PID=1202) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T16:55:44.729+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T16:55:44.731+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:55:44.730+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T16:55:44.754+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:55:44.754+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T16:55:45.537+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:55:45.537+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 0.7721509220000371
[2024-11-21T16:55:45.538+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:55:45.537+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T16:55:45.538+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:55:45.538+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T16:55:45.542+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:55:45.542+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T16:55:45.550+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:55:45.549+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T16:55:45.555+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:55:45.555+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmphplo9dde --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T16:55:50.669+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:55:50.669+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmphplo9dde --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T16:55:57.037+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:55:57.033+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 210, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmphplo9dde', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
16:55:52  Running with dbt=1.8.7
16:55:54  Registered adapter: bigquery=1.8.3
16:55:55  Encountered an error:
Parsing Error
  Invalid models config given in models/tests/schema.yml @ models: {'name': 'fct_trips', 'description': 'Fact Table of tripdata', 'columns': [{'name': 'trip_id', 'description': 'The primary key for this table', 'tests': ['unique']}, {'name': 'vendor_id', 'description': 'A code indicating the TPEP provider that provided the record', 'tests': ['not_null']}, {'name': 'pickup_time_id', 'description': 'id to get pickup time from dim_time', 'tests': ['not_null']}, {'name': 'dropoff_time_id', 'description': 'id to get dropoff time from dim_time', 'tests': ['unique']}, {'name': 'rate_code_id', 'description': 'The final rate code in effect at the end of the trip', 'tests': ['unique']}, {'name': 'pu_location_id', 'description': 'The pickup location', 'tests': ['not_null']}, {'name': 'do_location_id', 'description': 'The droppof location', 'tests': ['not_null']}, {'name': 'passenger_count', 'description': 'Customer count', 'tests': ['unique']}, {'name': 'trip_distance', 'description': 'trip distance', 'tests': ['not_null']}, {'name': 'fare_amount', 'description': 'The time-and-distance fare calculated by the meter.', 'tests': ['not_null']}, {'name': 'extra', 'description': 'Miscellaneous extras and surcharges. Currently, this only includes. the $0.50 and $1 rush hour and overnight charges', 'tests': ['not_null']}, {'name': 'mta_tax', 'description': '0.50 MTA tax that is automatically triggered based on the metered rate in use', 'tests': ['unique']}, {'name': 'tip_amount', 'description': 'Tip amount  This field is automatically populated for credit card tips.Cash tips are not included', 'tests': ['not_null']}, {'name': 'tolls_amount', 'description': 'Total amount of all tolls paid in trip', 'tests': ['not_null']}, {'name': 'improvement_surcharge', 'description': '0.30 improvement surcharge assessed trips at the flag drop. the improvement surcharge began being levied in 2015', 'tests': ['not_null']}, {'name': 'total_amount', 'description': 'The total amount charged to passengers. Does not include cash tips.', 'tests': ['not_null']}, {'name': 'payment_type', 'description': 'A numeric code signifying how the passenger paid for the trip', 'tests': ['not_null']}, {'name': 'trip_type', 'description': 'Year of pickup', 'tests': ['not_null']}, {'name': 'congestion_surcharge', 'description': 'An additional charge for trips taken during high traffic congestion times', 'tests': [None]}], 'original_file_path': 'models/tests/schema.yml', 'yaml_key': 'models', 'package_name': 'nyc_taxi'} - at path ['columns'][18]['tests'][0]: None is not valid under any of the given schemas
[2024-11-21T16:55:57.038+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T16:55:57.054+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 12.332 seconds
[2024-11-21T16:56:27.343+0000] {processor.py:161} INFO - Started process (PID=1248) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T16:56:27.343+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T16:56:27.345+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:56:27.345+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T16:56:27.369+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:56:27.369+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T16:56:28.098+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:56:28.098+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 0.7184834089998731
[2024-11-21T16:56:28.099+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:56:28.099+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T16:56:28.099+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:56:28.099+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T16:56:28.103+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:56:28.103+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T16:56:28.109+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:56:28.109+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T16:56:28.114+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:56:28.114+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpjo207c48 --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T16:56:33.329+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:56:33.328+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpjo207c48 --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T16:56:39.569+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:56:39.565+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 210, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpjo207c48', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
16:56:35  Running with dbt=1.8.7
16:56:36  Registered adapter: bigquery=1.8.3
16:56:37  Encountered an error:
Parsing Error
  Invalid models config given in models/tests/schema.yml @ models: {'name': 'fct_trips', 'description': 'Fact Table of tripdata', 'columns': [{'name': 'trip_id', 'description': 'The primary key for this table', 'tests': ['unique']}, {'name': 'vendor_id', 'description': 'A code indicating the TPEP provider that provided the record', 'tests': ['not_null']}, {'name': 'pickup_time_id', 'description': 'id to get pickup time from dim_time', 'tests': ['not_null']}, {'name': 'dropoff_time_id', 'description': 'id to get dropoff time from dim_time', 'tests': ['unique']}, {'name': 'rate_code_id', 'description': 'The final rate code in effect at the end of the trip', 'tests': ['unique']}, {'name': 'pu_location_id', 'description': 'The pickup location', 'tests': ['not_null']}, {'name': 'do_location_id', 'description': 'The droppof location', 'tests': ['not_null']}, {'name': 'passenger_count', 'description': 'Customer count', 'tests': ['unique']}, {'name': 'trip_distance', 'description': 'trip distance', 'tests': ['not_null']}, {'name': 'fare_amount', 'description': 'The time-and-distance fare calculated by the meter.', 'tests': ['not_null']}, {'name': 'extra', 'description': 'Miscellaneous extras and surcharges. Currently, this only includes. the $0.50 and $1 rush hour and overnight charges', 'tests': ['not_null']}, {'name': 'mta_tax', 'description': '0.50 MTA tax that is automatically triggered based on the metered rate in use', 'tests': ['unique']}, {'name': 'tip_amount', 'description': 'Tip amount  This field is automatically populated for credit card tips.Cash tips are not included', 'tests': ['not_null']}, {'name': 'tolls_amount', 'description': 'Total amount of all tolls paid in trip', 'tests': ['not_null']}, {'name': 'improvement_surcharge', 'description': '0.30 improvement surcharge assessed trips at the flag drop. the improvement surcharge began being levied in 2015', 'tests': ['not_null']}, {'name': 'total_amount', 'description': 'The total amount charged to passengers. Does not include cash tips.', 'tests': ['not_null']}, {'name': 'payment_type', 'description': 'A numeric code signifying how the passenger paid for the trip', 'tests': ['not_null']}, {'name': 'trip_type', 'description': 'Year of pickup', 'tests': ['not_null']}, {'name': 'congestion_surcharge', 'description': 'An additional charge for trips taken during high traffic congestion times', 'tests': [None]}], 'original_file_path': 'models/tests/schema.yml', 'yaml_key': 'models', 'package_name': 'nyc_taxi'} - at path ['columns'][18]['tests'][0]: None is not valid under any of the given schemas
[2024-11-21T16:56:39.570+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T16:56:39.580+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 12.242 seconds
[2024-11-21T16:57:09.960+0000] {processor.py:161} INFO - Started process (PID=1299) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T16:57:09.961+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T16:57:09.962+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:57:09.962+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T16:57:09.984+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:57:09.984+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T16:57:10.716+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:57:10.716+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 0.7219841539999834
[2024-11-21T16:57:10.717+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:57:10.716+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T16:57:10.717+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:57:10.717+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T16:57:10.721+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:57:10.721+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T16:57:10.727+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:57:10.727+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T16:57:10.732+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:57:10.732+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpqy6tv3d_ --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T16:57:15.258+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:57:15.258+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpqy6tv3d_ --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T16:57:21.575+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:57:21.572+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 210, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpqy6tv3d_', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
16:57:17  Running with dbt=1.8.7
16:57:19  Registered adapter: bigquery=1.8.3
16:57:19  Encountered an error:
Parsing Error
  Invalid models config given in models/tests/schema.yml @ models: {'name': 'fct_trips', 'description': 'Fact Table of tripdata', 'columns': [{'name': 'trip_id', 'description': 'The primary key for this table', 'tests': ['unique']}, {'name': 'vendor_id', 'description': 'A code indicating the TPEP provider that provided the record', 'tests': ['not_null']}, {'name': 'pickup_time_id', 'description': 'id to get pickup time from dim_time', 'tests': ['not_null']}, {'name': 'dropoff_time_id', 'description': 'id to get dropoff time from dim_time', 'tests': ['unique']}, {'name': 'rate_code_id', 'description': 'The final rate code in effect at the end of the trip', 'tests': ['unique']}, {'name': 'pu_location_id', 'description': 'The pickup location', 'tests': ['not_null']}, {'name': 'do_location_id', 'description': 'The droppof location', 'tests': ['not_null']}, {'name': 'passenger_count', 'description': 'Customer count', 'tests': ['unique']}, {'name': 'trip_distance', 'description': 'trip distance', 'tests': ['not_null']}, {'name': 'fare_amount', 'description': 'The time-and-distance fare calculated by the meter.', 'tests': ['not_null']}, {'name': 'extra', 'description': 'Miscellaneous extras and surcharges. Currently, this only includes. the $0.50 and $1 rush hour and overnight charges', 'tests': ['not_null']}, {'name': 'mta_tax', 'description': '0.50 MTA tax that is automatically triggered based on the metered rate in use', 'tests': ['unique']}, {'name': 'tip_amount', 'description': 'Tip amount  This field is automatically populated for credit card tips.Cash tips are not included', 'tests': ['not_null']}, {'name': 'tolls_amount', 'description': 'Total amount of all tolls paid in trip', 'tests': ['not_null']}, {'name': 'improvement_surcharge', 'description': '0.30 improvement surcharge assessed trips at the flag drop. the improvement surcharge began being levied in 2015', 'tests': ['not_null']}, {'name': 'total_amount', 'description': 'The total amount charged to passengers. Does not include cash tips.', 'tests': ['not_null']}, {'name': 'payment_type', 'description': 'A numeric code signifying how the passenger paid for the trip', 'tests': ['not_null']}, {'name': 'trip_type', 'description': 'Year of pickup', 'tests': ['not_null']}, {'name': 'congestion_surcharge', 'description': 'An additional charge for trips taken during high traffic congestion times', 'tests': [None]}], 'original_file_path': 'models/tests/schema.yml', 'yaml_key': 'models', 'package_name': 'nyc_taxi'} - at path ['columns'][18]['tests'][0]: None is not valid under any of the given schemas
[2024-11-21T16:57:21.576+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T16:57:21.585+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 11.631 seconds
[2024-11-21T16:57:52.408+0000] {processor.py:161} INFO - Started process (PID=1345) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T16:57:52.409+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T16:57:52.410+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:57:52.410+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T16:57:52.434+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:57:52.434+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T16:57:53.261+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:57:53.261+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 0.8157922660000168
[2024-11-21T16:57:53.262+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:57:53.261+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T16:57:53.262+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:57:53.262+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T16:57:53.266+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:57:53.266+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T16:57:53.272+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:57:53.272+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T16:57:53.278+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:57:53.278+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmphw2g9rhy --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T16:57:58.343+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:57:58.343+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmphw2g9rhy --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T16:58:04.792+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:58:04.789+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 210, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmphw2g9rhy', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
16:58:00  Running with dbt=1.8.7
16:58:01  Registered adapter: bigquery=1.8.3
16:58:02  Encountered an error:
Parsing Error
  Invalid models config given in models/tests/schema.yml @ models: {'name': 'fct_trips', 'description': 'Fact Table of tripdata', 'columns': [{'name': 'trip_id', 'description': 'The primary key for this table', 'tests': ['unique']}, {'name': 'vendor_id', 'description': 'A code indicating the TPEP provider that provided the record', 'tests': ['not_null']}, {'name': 'pickup_time_id', 'description': 'id to get pickup time from dim_time', 'tests': ['not_null']}, {'name': 'dropoff_time_id', 'description': 'id to get dropoff time from dim_time', 'tests': ['unique']}, {'name': 'rate_code_id', 'description': 'The final rate code in effect at the end of the trip', 'tests': ['unique']}, {'name': 'pu_location_id', 'description': 'The pickup location', 'tests': ['not_null']}, {'name': 'do_location_id', 'description': 'The droppof location', 'tests': ['not_null']}, {'name': 'passenger_count', 'description': 'Customer count', 'tests': ['unique']}, {'name': 'trip_distance', 'description': 'trip distance', 'tests': ['not_null']}, {'name': 'fare_amount', 'description': 'The time-and-distance fare calculated by the meter.', 'tests': ['not_null']}, {'name': 'extra', 'description': 'Miscellaneous extras and surcharges. Currently, this only includes. the $0.50 and $1 rush hour and overnight charges', 'tests': ['not_null']}, {'name': 'mta_tax', 'description': '0.50 MTA tax that is automatically triggered based on the metered rate in use', 'tests': ['unique']}, {'name': 'tip_amount', 'description': 'Tip amount  This field is automatically populated for credit card tips.Cash tips are not included', 'tests': ['not_null']}, {'name': 'tolls_amount', 'description': 'Total amount of all tolls paid in trip', 'tests': ['not_null']}, {'name': 'improvement_surcharge', 'description': '0.30 improvement surcharge assessed trips at the flag drop. the improvement surcharge began being levied in 2015', 'tests': ['not_null']}, {'name': 'total_amount', 'description': 'The total amount charged to passengers. Does not include cash tips.', 'tests': ['not_null']}, {'name': 'payment_type', 'description': 'A numeric code signifying how the passenger paid for the trip', 'tests': ['not_null']}, {'name': 'trip_type', 'description': 'Year of pickup', 'tests': ['not_null']}, {'name': 'congestion_surcharge', 'description': 'An additional charge for trips taken during high traffic congestion times', 'tests': [None]}], 'original_file_path': 'models/tests/schema.yml', 'yaml_key': 'models', 'package_name': 'nyc_taxi'} - at path ['columns'][18]['tests'][0]: None is not valid under any of the given schemas
[2024-11-21T16:58:04.793+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T16:58:04.803+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 12.401 seconds
[2024-11-21T16:58:34.983+0000] {processor.py:161} INFO - Started process (PID=1390) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T16:58:34.984+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T16:58:34.985+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:58:34.985+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T16:58:35.009+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:58:35.008+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T16:58:35.732+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:58:35.732+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 0.712976787000116
[2024-11-21T16:58:35.732+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:58:35.732+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T16:58:35.733+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:58:35.733+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T16:58:35.736+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:58:35.736+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T16:58:35.743+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:58:35.742+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T16:58:35.748+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:58:35.748+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpahr8f5r5 --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T16:58:39.386+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:58:39.386+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpahr8f5r5 --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T16:58:45.480+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:58:45.476+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 210, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpahr8f5r5', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
16:58:41  Running with dbt=1.8.7
16:58:42  Registered adapter: bigquery=1.8.3
16:58:43  Encountered an error:
Parsing Error
  Invalid models config given in models/tests/schema.yml @ models: {'name': 'fct_trips', 'description': 'Fact Table of tripdata', 'columns': [{'name': 'trip_id', 'description': 'The primary key for this table', 'tests': ['unique']}, {'name': 'vendor_id', 'description': 'A code indicating the TPEP provider that provided the record', 'tests': ['not_null']}, {'name': 'pickup_time_id', 'description': 'id to get pickup time from dim_time', 'tests': ['not_null']}, {'name': 'dropoff_time_id', 'description': 'id to get dropoff time from dim_time', 'tests': ['unique']}, {'name': 'rate_code_id', 'description': 'The final rate code in effect at the end of the trip', 'tests': ['unique']}, {'name': 'pu_location_id', 'description': 'The pickup location', 'tests': ['not_null']}, {'name': 'do_location_id', 'description': 'The droppof location', 'tests': ['not_null']}, {'name': 'passenger_count', 'description': 'Customer count', 'tests': ['unique']}, {'name': 'trip_distance', 'description': 'trip distance', 'tests': ['not_null']}, {'name': 'fare_amount', 'description': 'The time-and-distance fare calculated by the meter.', 'tests': ['not_null']}, {'name': 'extra', 'description': 'Miscellaneous extras and surcharges. Currently, this only includes. the $0.50 and $1 rush hour and overnight charges', 'tests': ['not_null']}, {'name': 'mta_tax', 'description': '0.50 MTA tax that is automatically triggered based on the metered rate in use', 'tests': ['unique']}, {'name': 'tip_amount', 'description': 'Tip amount  This field is automatically populated for credit card tips.Cash tips are not included', 'tests': ['not_null']}, {'name': 'tolls_amount', 'description': 'Total amount of all tolls paid in trip', 'tests': ['not_null']}, {'name': 'improvement_surcharge', 'description': '0.30 improvement surcharge assessed trips at the flag drop. the improvement surcharge began being levied in 2015', 'tests': ['not_null']}, {'name': 'total_amount', 'description': 'The total amount charged to passengers. Does not include cash tips.', 'tests': ['not_null']}, {'name': 'payment_type', 'description': 'A numeric code signifying how the passenger paid for the trip', 'tests': ['not_null']}, {'name': 'trip_type', 'description': 'Year of pickup', 'tests': ['not_null']}, {'name': 'congestion_surcharge', 'description': 'An additional charge for trips taken during high traffic congestion times', 'tests': [None]}], 'original_file_path': 'models/tests/schema.yml', 'yaml_key': 'models', 'package_name': 'nyc_taxi'} - at path ['columns'][18]['tests'][0]: None is not valid under any of the given schemas
[2024-11-21T16:58:45.480+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T16:58:45.490+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 11.465 seconds
[2024-11-21T16:59:16.482+0000] {processor.py:161} INFO - Started process (PID=1441) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T16:59:16.483+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T16:59:16.484+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:59:16.484+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T16:59:16.513+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:59:16.513+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T16:59:17.329+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:59:17.329+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 0.8051511020000817
[2024-11-21T16:59:17.329+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:59:17.329+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T16:59:17.330+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:59:17.330+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T16:59:17.334+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:59:17.334+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T16:59:17.342+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:59:17.341+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T16:59:17.347+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:59:17.347+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpl4s0y0kj --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T16:59:22.316+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:59:22.315+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpl4s0y0kj --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T16:59:28.389+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:59:28.385+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 210, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpl4s0y0kj', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
16:59:24  Running with dbt=1.8.7
16:59:25  Registered adapter: bigquery=1.8.3
16:59:26  Encountered an error:
Parsing Error
  Invalid models config given in models/tests/schema.yml @ models: {'name': 'fct_trips', 'description': 'Fact Table of tripdata', 'columns': [{'name': 'trip_id', 'description': 'The primary key for this table', 'tests': ['unique']}, {'name': 'vendor_id', 'description': 'A code indicating the TPEP provider that provided the record', 'tests': ['not_null']}, {'name': 'pickup_time_id', 'description': 'id to get pickup time from dim_time', 'tests': ['not_null']}, {'name': 'dropoff_time_id', 'description': 'id to get dropoff time from dim_time', 'tests': ['unique']}, {'name': 'rate_code_id', 'description': 'The final rate code in effect at the end of the trip', 'tests': ['unique']}, {'name': 'pu_location_id', 'description': 'The pickup location', 'tests': ['not_null']}, {'name': 'do_location_id', 'description': 'The droppof location', 'tests': ['not_null']}, {'name': 'passenger_count', 'description': 'Customer count', 'tests': ['unique']}, {'name': 'trip_distance', 'description': 'trip distance', 'tests': ['not_null']}, {'name': 'fare_amount', 'description': 'The time-and-distance fare calculated by the meter.', 'tests': ['not_null']}, {'name': 'extra', 'description': 'Miscellaneous extras and surcharges. Currently, this only includes. the $0.50 and $1 rush hour and overnight charges', 'tests': ['not_null']}, {'name': 'mta_tax', 'description': '0.50 MTA tax that is automatically triggered based on the metered rate in use', 'tests': ['unique']}, {'name': 'tip_amount', 'description': 'Tip amount  This field is automatically populated for credit card tips.Cash tips are not included', 'tests': ['not_null']}, {'name': 'tolls_amount', 'description': 'Total amount of all tolls paid in trip', 'tests': ['not_null']}, {'name': 'improvement_surcharge', 'description': '0.30 improvement surcharge assessed trips at the flag drop. the improvement surcharge began being levied in 2015', 'tests': ['not_null']}, {'name': 'total_amount', 'description': 'The total amount charged to passengers. Does not include cash tips.', 'tests': ['not_null']}, {'name': 'payment_type', 'description': 'A numeric code signifying how the passenger paid for the trip', 'tests': ['not_null']}, {'name': 'trip_type', 'description': 'Year of pickup', 'tests': ['not_null']}, {'name': 'congestion_surcharge', 'description': 'An additional charge for trips taken during high traffic congestion times', 'tests': [None]}], 'original_file_path': 'models/tests/schema.yml', 'yaml_key': 'models', 'package_name': 'nyc_taxi'} - at path ['columns'][18]['tests'][0]: None is not valid under any of the given schemas
[2024-11-21T16:59:28.390+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T16:59:28.399+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 11.924 seconds
[2024-11-21T16:59:58.862+0000] {processor.py:161} INFO - Started process (PID=1487) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T16:59:58.863+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T16:59:58.864+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:59:58.864+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T16:59:58.886+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:59:58.886+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T16:59:59.648+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:59:59.648+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 0.7505427710000276
[2024-11-21T16:59:59.649+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:59:59.649+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T16:59:59.649+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:59:59.649+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T16:59:59.653+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:59:59.653+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T16:59:59.659+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:59:59.658+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T16:59:59.664+0000] {logging_mixin.py:188} INFO - [2024-11-21T16:59:59.664+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpo3i2on4z --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T17:00:04.164+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:00:04.164+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpo3i2on4z --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T17:00:10.535+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:00:10.532+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 210, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpo3i2on4z', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
17:00:06  Running with dbt=1.8.7
17:00:07  Registered adapter: bigquery=1.8.3
17:00:08  Encountered an error:
Parsing Error
  Invalid models config given in models/tests/schema.yml @ models: {'name': 'fct_trips', 'description': 'Fact Table of tripdata', 'columns': [{'name': 'trip_id', 'description': 'The primary key for this table', 'tests': ['unique']}, {'name': 'vendor_id', 'description': 'A code indicating the TPEP provider that provided the record', 'tests': ['not_null']}, {'name': 'pickup_time_id', 'description': 'id to get pickup time from dim_time', 'tests': ['not_null']}, {'name': 'dropoff_time_id', 'description': 'id to get dropoff time from dim_time', 'tests': ['unique']}, {'name': 'rate_code_id', 'description': 'The final rate code in effect at the end of the trip', 'tests': ['unique']}, {'name': 'pu_location_id', 'description': 'The pickup location', 'tests': ['not_null']}, {'name': 'do_location_id', 'description': 'The droppof location', 'tests': ['not_null']}, {'name': 'passenger_count', 'description': 'Customer count', 'tests': ['unique']}, {'name': 'trip_distance', 'description': 'trip distance', 'tests': ['not_null']}, {'name': 'fare_amount', 'description': 'The time-and-distance fare calculated by the meter.', 'tests': ['not_null']}, {'name': 'extra', 'description': 'Miscellaneous extras and surcharges. Currently, this only includes. the $0.50 and $1 rush hour and overnight charges', 'tests': ['not_null']}, {'name': 'mta_tax', 'description': '0.50 MTA tax that is automatically triggered based on the metered rate in use', 'tests': ['unique']}, {'name': 'tip_amount', 'description': 'Tip amount  This field is automatically populated for credit card tips.Cash tips are not included', 'tests': ['not_null']}, {'name': 'tolls_amount', 'description': 'Total amount of all tolls paid in trip', 'tests': ['not_null']}, {'name': 'improvement_surcharge', 'description': '0.30 improvement surcharge assessed trips at the flag drop. the improvement surcharge began being levied in 2015', 'tests': ['not_null']}, {'name': 'total_amount', 'description': 'The total amount charged to passengers. Does not include cash tips.', 'tests': ['not_null']}, {'name': 'payment_type', 'description': 'A numeric code signifying how the passenger paid for the trip', 'tests': ['not_null']}, {'name': 'trip_type', 'description': 'Year of pickup', 'tests': ['not_null']}, {'name': 'congestion_surcharge', 'description': 'An additional charge for trips taken during high traffic congestion times', 'tests': [None]}], 'original_file_path': 'models/tests/schema.yml', 'yaml_key': 'models', 'package_name': 'nyc_taxi'} - at path ['columns'][18]['tests'][0]: None is not valid under any of the given schemas
[2024-11-21T17:00:10.536+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:00:10.549+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 12.623 seconds
[2024-11-21T17:00:41.482+0000] {processor.py:161} INFO - Started process (PID=1538) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:00:41.482+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T17:00:41.484+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:00:41.484+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:00:41.505+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:00:41.505+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T17:00:42.224+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:00:42.224+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 0.7091023830000722
[2024-11-21T17:00:42.224+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:00:42.224+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T17:00:42.225+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:00:42.225+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T17:00:42.228+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:00:42.228+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T17:00:42.234+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:00:42.234+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T17:00:42.240+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:00:42.240+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp1nrbzl9i --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T17:00:47.534+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:00:47.534+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp1nrbzl9i --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T17:00:53.975+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:00:53.972+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 210, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmp1nrbzl9i', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
17:00:49  Running with dbt=1.8.7
17:00:51  Registered adapter: bigquery=1.8.3
17:00:52  Encountered an error:
Parsing Error
  Invalid models config given in models/tests/schema.yml @ models: {'name': 'fct_trips', 'description': 'Fact Table of tripdata', 'columns': [{'name': 'trip_id', 'description': 'The primary key for this table', 'tests': ['unique']}, {'name': 'vendor_id', 'description': 'A code indicating the TPEP provider that provided the record', 'tests': ['not_null']}, {'name': 'pickup_time_id', 'description': 'id to get pickup time from dim_time', 'tests': ['not_null']}, {'name': 'dropoff_time_id', 'description': 'id to get dropoff time from dim_time', 'tests': ['unique']}, {'name': 'rate_code_id', 'description': 'The final rate code in effect at the end of the trip', 'tests': ['unique']}, {'name': 'pu_location_id', 'description': 'The pickup location', 'tests': ['not_null']}, {'name': 'do_location_id', 'description': 'The droppof location', 'tests': ['not_null']}, {'name': 'passenger_count', 'description': 'Customer count', 'tests': ['unique']}, {'name': 'trip_distance', 'description': 'trip distance', 'tests': ['not_null']}, {'name': 'fare_amount', 'description': 'The time-and-distance fare calculated by the meter.', 'tests': ['not_null']}, {'name': 'extra', 'description': 'Miscellaneous extras and surcharges. Currently, this only includes. the $0.50 and $1 rush hour and overnight charges', 'tests': ['not_null']}, {'name': 'mta_tax', 'description': '0.50 MTA tax that is automatically triggered based on the metered rate in use', 'tests': ['unique']}, {'name': 'tip_amount', 'description': 'Tip amount  This field is automatically populated for credit card tips.Cash tips are not included', 'tests': ['not_null']}, {'name': 'tolls_amount', 'description': 'Total amount of all tolls paid in trip', 'tests': ['not_null']}, {'name': 'improvement_surcharge', 'description': '0.30 improvement surcharge assessed trips at the flag drop. the improvement surcharge began being levied in 2015', 'tests': ['not_null']}, {'name': 'total_amount', 'description': 'The total amount charged to passengers. Does not include cash tips.', 'tests': ['not_null']}, {'name': 'payment_type', 'description': 'A numeric code signifying how the passenger paid for the trip', 'tests': ['not_null']}, {'name': 'trip_type', 'description': 'Year of pickup', 'tests': ['not_null']}, {'name': 'congestion_surcharge', 'description': 'An additional charge for trips taken during high traffic congestion times', 'tests': [None]}], 'original_file_path': 'models/tests/schema.yml', 'yaml_key': 'models', 'package_name': 'nyc_taxi'} - at path ['columns'][18]['tests'][0]: None is not valid under any of the given schemas
[2024-11-21T17:00:53.976+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:00:53.992+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 12.515 seconds
[2024-11-21T17:01:24.090+0000] {processor.py:161} INFO - Started process (PID=1583) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:01:24.098+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T17:01:24.100+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:01:24.100+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:01:24.121+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:01:24.121+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T17:01:24.962+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:01:24.961+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 0.8289174889998776
[2024-11-21T17:01:24.962+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:01:24.962+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T17:01:24.963+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:01:24.963+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T17:01:24.967+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:01:24.967+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T17:01:24.979+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:01:24.979+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T17:01:24.987+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:01:24.986+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpwks22_6n --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T17:01:29.852+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:01:29.851+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpwks22_6n --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T17:01:35.074+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:01:35.071+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 210, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpwks22_6n', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
17:01:31  Running with dbt=1.8.7
17:01:32  Registered adapter: bigquery=1.8.3
17:01:33  Encountered an error:
Parsing Error
  Invalid models config given in models/tests/schema.yml @ models: {'name': 'fct_trips', 'description': 'Fact Table of tripdata', 'columns': [{'name': 'trip_id', 'description': 'The primary key for this table', 'tests': ['unique']}, {'name': 'vendor_id', 'description': 'A code indicating the TPEP provider that provided the record', 'tests': ['not_null']}, {'name': 'pickup_time_id', 'description': 'id to get pickup time from dim_time', 'tests': ['not_null']}, {'name': 'dropoff_time_id', 'description': 'id to get dropoff time from dim_time', 'tests': ['unique']}, {'name': 'rate_code_id', 'description': 'The final rate code in effect at the end of the trip', 'tests': ['unique']}, {'name': 'pu_location_id', 'description': 'The pickup location', 'tests': ['not_null']}, {'name': 'do_location_id', 'description': 'The droppof location', 'tests': ['not_null']}, {'name': 'passenger_count', 'description': 'Customer count', 'tests': ['unique']}, {'name': 'trip_distance', 'description': 'trip distance', 'tests': ['not_null']}, {'name': 'fare_amount', 'description': 'The time-and-distance fare calculated by the meter.', 'tests': ['not_null']}, {'name': 'extra', 'description': 'Miscellaneous extras and surcharges. Currently, this only includes. the $0.50 and $1 rush hour and overnight charges', 'tests': ['not_null']}, {'name': 'mta_tax', 'description': '0.50 MTA tax that is automatically triggered based on the metered rate in use', 'tests': ['unique']}, {'name': 'tip_amount', 'description': 'Tip amount  This field is automatically populated for credit card tips.Cash tips are not included', 'tests': ['not_null']}, {'name': 'tolls_amount', 'description': 'Total amount of all tolls paid in trip', 'tests': ['not_null']}, {'name': 'improvement_surcharge', 'description': '0.30 improvement surcharge assessed trips at the flag drop. the improvement surcharge began being levied in 2015', 'tests': ['not_null']}, {'name': 'total_amount', 'description': 'The total amount charged to passengers. Does not include cash tips.', 'tests': ['not_null']}, {'name': 'payment_type', 'description': 'A numeric code signifying how the passenger paid for the trip', 'tests': ['not_null']}, {'name': 'trip_type', 'description': 'Year of pickup', 'tests': ['not_null']}, {'name': 'congestion_surcharge', 'description': 'An additional charge for trips taken during high traffic congestion times', 'tests': [None]}], 'original_file_path': 'models/tests/schema.yml', 'yaml_key': 'models', 'package_name': 'nyc_taxi'} - at path ['columns'][18]['tests'][0]: None is not valid under any of the given schemas
[2024-11-21T17:01:35.075+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:01:35.091+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 11.924 seconds
[2024-11-21T17:02:05.535+0000] {processor.py:161} INFO - Started process (PID=1635) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:02:05.536+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T17:02:05.537+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:02:05.537+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:02:05.561+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:02:05.560+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T17:02:06.276+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:02:06.275+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 0.7047574299999724
[2024-11-21T17:02:06.276+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:02:06.276+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T17:02:06.276+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:02:06.276+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T17:02:06.280+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:02:06.280+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T17:02:06.286+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:02:06.286+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T17:02:06.292+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:02:06.291+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp9afy38fn --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T17:02:11.559+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:02:11.559+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp9afy38fn --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T17:02:17.869+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:02:17.865+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 210, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmp9afy38fn', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
17:02:13  Running with dbt=1.8.7
17:02:15  Registered adapter: bigquery=1.8.3
17:02:16  Encountered an error:
Parsing Error
  Invalid models config given in models/tests/schema.yml @ models: {'name': 'fct_trips', 'description': 'Fact Table of tripdata', 'columns': [{'name': 'trip_id', 'description': 'The primary key for this table', 'tests': ['unique']}, {'name': 'vendor_id', 'description': 'A code indicating the TPEP provider that provided the record', 'tests': ['not_null']}, {'name': 'pickup_time_id', 'description': 'id to get pickup time from dim_time', 'tests': ['not_null']}, {'name': 'dropoff_time_id', 'description': 'id to get dropoff time from dim_time', 'tests': ['unique']}, {'name': 'rate_code_id', 'description': 'The final rate code in effect at the end of the trip', 'tests': ['unique']}, {'name': 'pu_location_id', 'description': 'The pickup location', 'tests': ['not_null']}, {'name': 'do_location_id', 'description': 'The droppof location', 'tests': ['not_null']}, {'name': 'passenger_count', 'description': 'Customer count', 'tests': ['unique']}, {'name': 'trip_distance', 'description': 'trip distance', 'tests': ['not_null']}, {'name': 'fare_amount', 'description': 'The time-and-distance fare calculated by the meter.', 'tests': ['not_null']}, {'name': 'extra', 'description': 'Miscellaneous extras and surcharges. Currently, this only includes. the $0.50 and $1 rush hour and overnight charges', 'tests': ['not_null']}, {'name': 'mta_tax', 'description': '0.50 MTA tax that is automatically triggered based on the metered rate in use', 'tests': ['unique']}, {'name': 'tip_amount', 'description': 'Tip amount  This field is automatically populated for credit card tips.Cash tips are not included', 'tests': ['not_null']}, {'name': 'tolls_amount', 'description': 'Total amount of all tolls paid in trip', 'tests': ['not_null']}, {'name': 'improvement_surcharge', 'description': '0.30 improvement surcharge assessed trips at the flag drop. the improvement surcharge began being levied in 2015', 'tests': ['not_null']}, {'name': 'total_amount', 'description': 'The total amount charged to passengers. Does not include cash tips.', 'tests': ['not_null']}, {'name': 'payment_type', 'description': 'A numeric code signifying how the passenger paid for the trip', 'tests': ['not_null']}, {'name': 'trip_type', 'description': 'Year of pickup', 'tests': ['not_null']}, {'name': 'congestion_surcharge', 'description': 'An additional charge for trips taken during high traffic congestion times', 'tests': [None]}], 'original_file_path': 'models/tests/schema.yml', 'yaml_key': 'models', 'package_name': 'nyc_taxi'} - at path ['columns'][18]['tests'][0]: None is not valid under any of the given schemas
[2024-11-21T17:02:17.870+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:02:17.879+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 12.348 seconds
[2024-11-21T17:02:48.047+0000] {processor.py:161} INFO - Started process (PID=1680) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:02:48.050+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T17:02:48.057+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:02:48.056+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:02:48.118+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:02:48.118+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T17:02:48.926+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:02:48.926+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 0.7966185410000435
[2024-11-21T17:02:48.927+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:02:48.927+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T17:02:48.927+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:02:48.927+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T17:02:48.931+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:02:48.931+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T17:02:48.938+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:02:48.937+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T17:02:48.944+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:02:48.944+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpvpga42vq --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T17:02:54.140+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:02:54.139+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpvpga42vq --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T17:02:59.679+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:02:59.676+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 210, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpvpga42vq', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
17:02:56  Running with dbt=1.8.7
17:02:57  Registered adapter: bigquery=1.8.3
17:02:57  Encountered an error:
Parsing Error
  Invalid models config given in models/tests/schema.yml @ models: {'name': 'fct_trips', 'description': 'Fact Table of tripdata', 'columns': [{'name': 'trip_id', 'description': 'The primary key for this table', 'tests': ['unique']}, {'name': 'vendor_id', 'description': 'A code indicating the TPEP provider that provided the record', 'tests': ['not_null']}, {'name': 'pickup_time_id', 'description': 'id to get pickup time from dim_time', 'tests': ['not_null']}, {'name': 'dropoff_time_id', 'description': 'id to get dropoff time from dim_time', 'tests': ['unique']}, {'name': 'rate_code_id', 'description': 'The final rate code in effect at the end of the trip', 'tests': ['unique']}, {'name': 'pu_location_id', 'description': 'The pickup location', 'tests': ['not_null']}, {'name': 'do_location_id', 'description': 'The droppof location', 'tests': ['not_null']}, {'name': 'passenger_count', 'description': 'Customer count', 'tests': ['unique']}, {'name': 'trip_distance', 'description': 'trip distance', 'tests': ['not_null']}, {'name': 'fare_amount', 'description': 'The time-and-distance fare calculated by the meter.', 'tests': ['not_null']}, {'name': 'extra', 'description': 'Miscellaneous extras and surcharges. Currently, this only includes. the $0.50 and $1 rush hour and overnight charges', 'tests': ['not_null']}, {'name': 'mta_tax', 'description': '0.50 MTA tax that is automatically triggered based on the metered rate in use', 'tests': ['unique']}, {'name': 'tip_amount', 'description': 'Tip amount  This field is automatically populated for credit card tips.Cash tips are not included', 'tests': ['not_null']}, {'name': 'tolls_amount', 'description': 'Total amount of all tolls paid in trip', 'tests': ['not_null']}, {'name': 'improvement_surcharge', 'description': '0.30 improvement surcharge assessed trips at the flag drop. the improvement surcharge began being levied in 2015', 'tests': ['not_null']}, {'name': 'total_amount', 'description': 'The total amount charged to passengers. Does not include cash tips.', 'tests': ['not_null']}, {'name': 'payment_type', 'description': 'A numeric code signifying how the passenger paid for the trip', 'tests': ['not_null']}, {'name': 'trip_type', 'description': 'Year of pickup', 'tests': ['not_null']}, {'name': 'congestion_surcharge', 'description': 'An additional charge for trips taken during high traffic congestion times', 'tests': [None]}], 'original_file_path': 'models/tests/schema.yml', 'yaml_key': 'models', 'package_name': 'nyc_taxi'} - at path ['columns'][18]['tests'][0]: None is not valid under any of the given schemas
[2024-11-21T17:02:59.680+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:02:59.690+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 12.591 seconds
[2024-11-21T17:03:29.782+0000] {processor.py:161} INFO - Started process (PID=1732) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:03:29.783+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T17:03:29.784+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:03:29.784+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:03:29.807+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:03:29.807+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T17:03:30.554+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:03:30.554+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 0.7360421149999183
[2024-11-21T17:03:30.555+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:03:30.555+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T17:03:30.555+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:03:30.555+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T17:03:30.564+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:03:30.564+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T17:03:30.572+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:03:30.571+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T17:03:30.580+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:03:30.579+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmppas9l4y7 --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T17:03:35.562+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:03:35.562+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmppas9l4y7 --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T17:03:42.144+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:03:42.141+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 210, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmppas9l4y7', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
17:03:37  Running with dbt=1.8.7
17:03:39  Registered adapter: bigquery=1.8.3
17:03:40  Encountered an error:
Parsing Error
  Invalid models config given in models/tests/schema.yml @ models: {'name': 'fct_trips', 'description': 'Fact Table of tripdata', 'columns': [{'name': 'trip_id', 'description': 'The primary key for this table', 'tests': ['unique']}, {'name': 'vendor_id', 'description': 'A code indicating the TPEP provider that provided the record', 'tests': ['not_null']}, {'name': 'pickup_time_id', 'description': 'id to get pickup time from dim_time', 'tests': ['not_null']}, {'name': 'dropoff_time_id', 'description': 'id to get dropoff time from dim_time', 'tests': ['unique']}, {'name': 'rate_code_id', 'description': 'The final rate code in effect at the end of the trip', 'tests': ['unique']}, {'name': 'pu_location_id', 'description': 'The pickup location', 'tests': ['not_null']}, {'name': 'do_location_id', 'description': 'The droppof location', 'tests': ['not_null']}, {'name': 'passenger_count', 'description': 'Customer count', 'tests': ['unique']}, {'name': 'trip_distance', 'description': 'trip distance', 'tests': ['not_null']}, {'name': 'fare_amount', 'description': 'The time-and-distance fare calculated by the meter.', 'tests': ['not_null']}, {'name': 'extra', 'description': 'Miscellaneous extras and surcharges. Currently, this only includes. the $0.50 and $1 rush hour and overnight charges', 'tests': ['not_null']}, {'name': 'mta_tax', 'description': '0.50 MTA tax that is automatically triggered based on the metered rate in use', 'tests': ['unique']}, {'name': 'tip_amount', 'description': 'Tip amount  This field is automatically populated for credit card tips.Cash tips are not included', 'tests': ['not_null']}, {'name': 'tolls_amount', 'description': 'Total amount of all tolls paid in trip', 'tests': ['not_null']}, {'name': 'improvement_surcharge', 'description': '0.30 improvement surcharge assessed trips at the flag drop. the improvement surcharge began being levied in 2015', 'tests': ['not_null']}, {'name': 'total_amount', 'description': 'The total amount charged to passengers. Does not include cash tips.', 'tests': ['not_null']}, {'name': 'payment_type', 'description': 'A numeric code signifying how the passenger paid for the trip', 'tests': ['not_null']}, {'name': 'trip_type', 'description': 'Year of pickup', 'tests': ['not_null']}, {'name': 'congestion_surcharge', 'description': 'An additional charge for trips taken during high traffic congestion times', 'tests': [None]}], 'original_file_path': 'models/tests/schema.yml', 'yaml_key': 'models', 'package_name': 'nyc_taxi'} - at path ['columns'][18]['tests'][0]: None is not valid under any of the given schemas
[2024-11-21T17:03:42.145+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:03:42.159+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 12.383 seconds
[2024-11-21T17:04:12.255+0000] {processor.py:161} INFO - Started process (PID=1777) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:04:12.256+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T17:04:12.258+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:04:12.257+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:04:12.282+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:04:12.282+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T17:04:13.019+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:04:13.018+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 0.7263443419999476
[2024-11-21T17:04:13.019+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:04:13.019+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T17:04:13.020+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:04:13.019+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T17:04:13.026+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:04:13.026+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T17:04:13.032+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:04:13.032+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T17:04:13.038+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:04:13.038+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpz0dfpfsi --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T17:04:17.468+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:04:17.467+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpz0dfpfsi --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T17:04:23.840+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:04:23.837+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 210, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpz0dfpfsi', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
17:04:19  Running with dbt=1.8.7
17:04:21  Registered adapter: bigquery=1.8.3
17:04:21  [WARNING]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
17:04:21  Encountered an error:
Parsing Error
  Invalid models config given in models/tests/schema.yml @ models: {'name': 'fct_trips', 'description': 'Fact Table of tripdata', 'columns': [{'name': 'trip_id', 'description': 'The primary key for this table', 'tests': ['unique']}, {'name': 'vendor_id', 'description': 'A code indicating the TPEP provider that provided the record', 'tests': ['not_null']}, {'name': 'pickup_time_id', 'description': 'id to get pickup time from dim_time', 'tests': ['not_null']}, {'name': 'dropoff_time_id', 'description': 'id to get dropoff time from dim_time', 'tests': ['unique']}, {'name': 'rate_code_id', 'description': 'The final rate code in effect at the end of the trip', 'tests': ['unique']}, {'name': 'pu_location_id', 'description': 'The pickup location', 'tests': ['not_null']}, {'name': 'do_location_id', 'description': 'The droppof location', 'tests': ['not_null']}, {'name': 'passenger_count', 'description': 'Customer count', 'tests': ['unique']}, {'name': 'trip_distance', 'description': 'trip distance', 'tests': ['not_null']}, {'name': 'fare_amount', 'description': 'The time-and-distance fare calculated by the meter.', 'tests': ['not_null']}, {'name': 'extra', 'description': 'Miscellaneous extras and surcharges. Currently, this only includes. the $0.50 and $1 rush hour and overnight charges', 'tests': ['not_null']}, {'name': 'mta_tax', 'description': '0.50 MTA tax that is automatically triggered based on the metered rate in use', 'tests': ['unique']}, {'name': 'tip_amount', 'description': 'Tip amount  This field is automatically populated for credit card tips.Cash tips are not included', 'tests': ['not_null']}, {'name': 'tolls_amount', 'description': 'Total amount of all tolls paid in trip', 'tests': ['not_null']}, {'name': 'improvement_surcharge', 'description': '0.30 improvement surcharge assessed trips at the flag drop. the improvement surcharge began being levied in 2015', 'tests': ['not_null']}, {'name': 'total_amount', 'description': 'The total amount charged to passengers. Does not include cash tips.', 'tests': ['not_null']}, {'name': 'payment_type', 'description': 'A numeric code signifying how the passenger paid for the trip', 'tests': ['not_null']}, {'name': 'trip_type', 'description': 'Year of pickup', 'tests': ['not_null']}, {'name': 'congestion_surcharge', 'description': 'An additional charge for trips taken during high traffic congestion times', 'tests': [None]}], 'original_file_path': 'models/tests/schema.yml', 'yaml_key': 'models', 'package_name': 'nyc_taxi'} - at path ['columns'][18]['tests'][0]: None is not valid under any of the given schemas
[2024-11-21T17:04:23.841+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:04:23.850+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 11.601 seconds
[2024-11-21T17:04:54.875+0000] {processor.py:161} INFO - Started process (PID=1828) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:04:54.875+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T17:04:54.877+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:04:54.877+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:04:54.899+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:04:54.898+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T17:04:55.629+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:04:55.629+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 0.7207652549998329
[2024-11-21T17:04:55.630+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:04:55.630+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T17:04:55.630+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:04:55.630+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T17:04:55.634+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:04:55.634+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T17:04:55.641+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:04:55.640+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T17:04:55.646+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:04:55.646+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpb1b2tzse --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T17:05:01.663+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:05:01.662+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpb1b2tzse --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T17:05:07.744+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:05:07.741+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 210, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpb1b2tzse', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
17:05:03  Running with dbt=1.8.7
17:05:05  Registered adapter: bigquery=1.8.3
17:05:06  [WARNING]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
17:05:06  Encountered an error:
Parsing Error
  Invalid models config given in models/tests/schema.yml @ models: {'name': 'fct_trips', 'description': 'Fact Table of tripdata', 'columns': [{'name': 'trip_id', 'description': 'The primary key for this table', 'tests': ['unique']}, {'name': 'vendor_id', 'description': 'A code indicating the TPEP provider that provided the record', 'tests': ['not_null']}, {'name': 'pickup_time_id', 'description': 'id to get pickup time from dim_time', 'tests': ['not_null']}, {'name': 'dropoff_time_id', 'description': 'id to get dropoff time from dim_time', 'tests': ['unique']}, {'name': 'rate_code_id', 'description': 'The final rate code in effect at the end of the trip', 'tests': ['unique']}, {'name': 'pu_location_id', 'description': 'The pickup location', 'tests': ['not_null']}, {'name': 'do_location_id', 'description': 'The droppof location', 'tests': ['not_null']}, {'name': 'passenger_count', 'description': 'Customer count', 'tests': ['unique']}, {'name': 'trip_distance', 'description': 'trip distance', 'tests': ['not_null']}, {'name': 'fare_amount', 'description': 'The time-and-distance fare calculated by the meter.', 'tests': ['not_null']}, {'name': 'extra', 'description': 'Miscellaneous extras and surcharges. Currently, this only includes. the $0.50 and $1 rush hour and overnight charges', 'tests': ['not_null']}, {'name': 'mta_tax', 'description': '0.50 MTA tax that is automatically triggered based on the metered rate in use', 'tests': ['unique']}, {'name': 'tip_amount', 'description': 'Tip amount  This field is automatically populated for credit card tips.Cash tips are not included', 'tests': ['not_null']}, {'name': 'tolls_amount', 'description': 'Total amount of all tolls paid in trip', 'tests': ['not_null']}, {'name': 'improvement_surcharge', 'description': '0.30 improvement surcharge assessed trips at the flag drop. the improvement surcharge began being levied in 2015', 'tests': ['not_null']}, {'name': 'total_amount', 'description': 'The total amount charged to passengers. Does not include cash tips.', 'tests': ['not_null']}, {'name': 'payment_type', 'description': 'A numeric code signifying how the passenger paid for the trip', 'tests': ['not_null']}, {'name': 'trip_type', 'description': 'Year of pickup', 'tests': ['not_null']}, {'name': 'congestion_surcharge', 'description': 'An additional charge for trips taken during high traffic congestion times', 'tests': [None]}], 'original_file_path': 'models/tests/schema.yml', 'yaml_key': 'models', 'package_name': 'nyc_taxi'} - at path ['columns'][18]['tests'][0]: None is not valid under any of the given schemas
[2024-11-21T17:05:07.745+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:05:07.755+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 12.886 seconds
[2024-11-21T17:05:38.115+0000] {processor.py:161} INFO - Started process (PID=1875) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:05:38.116+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T17:05:38.118+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:05:38.118+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:05:38.141+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:05:38.141+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T17:05:38.883+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:05:38.883+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 0.7310623040000337
[2024-11-21T17:05:38.884+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:05:38.884+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T17:05:38.884+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:05:38.884+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T17:05:38.888+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:05:38.888+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T17:05:38.894+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:05:38.894+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T17:05:38.900+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:05:38.900+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp6f5to0gz --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T17:05:43.562+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:05:43.562+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp6f5to0gz --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T17:05:49.890+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:05:49.886+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 210, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmp6f5to0gz', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
17:05:45  Running with dbt=1.8.7
17:05:47  Registered adapter: bigquery=1.8.3
17:05:47  [WARNING]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
17:05:47  Encountered an error:
Parsing Error
  Invalid models config given in models/tests/schema.yml @ models: {'name': 'fct_trips', 'description': 'Fact Table of tripdata', 'columns': [{'name': 'trip_id', 'description': 'The primary key for this table', 'tests': ['unique']}, {'name': 'vendor_id', 'description': 'A code indicating the TPEP provider that provided the record', 'tests': ['not_null']}, {'name': 'pickup_time_id', 'description': 'id to get pickup time from dim_time', 'tests': ['not_null']}, {'name': 'dropoff_time_id', 'description': 'id to get dropoff time from dim_time', 'tests': ['unique']}, {'name': 'rate_code_id', 'description': 'The final rate code in effect at the end of the trip', 'tests': ['unique']}, {'name': 'pu_location_id', 'description': 'The pickup location', 'tests': ['not_null']}, {'name': 'do_location_id', 'description': 'The droppof location', 'tests': ['not_null']}, {'name': 'passenger_count', 'description': 'Customer count', 'tests': ['unique']}, {'name': 'trip_distance', 'description': 'trip distance', 'tests': ['not_null']}, {'name': 'fare_amount', 'description': 'The time-and-distance fare calculated by the meter.', 'tests': ['not_null']}, {'name': 'extra', 'description': 'Miscellaneous extras and surcharges. Currently, this only includes. the $0.50 and $1 rush hour and overnight charges', 'tests': ['not_null']}, {'name': 'mta_tax', 'description': '0.50 MTA tax that is automatically triggered based on the metered rate in use', 'tests': ['unique']}, {'name': 'tip_amount', 'description': 'Tip amount  This field is automatically populated for credit card tips.Cash tips are not included', 'tests': ['not_null']}, {'name': 'tolls_amount', 'description': 'Total amount of all tolls paid in trip', 'tests': ['not_null']}, {'name': 'improvement_surcharge', 'description': '0.30 improvement surcharge assessed trips at the flag drop. the improvement surcharge began being levied in 2015', 'tests': ['not_null']}, {'name': 'total_amount', 'description': 'The total amount charged to passengers. Does not include cash tips.', 'tests': ['not_null']}, {'name': 'payment_type', 'description': 'A numeric code signifying how the passenger paid for the trip', 'tests': ['not_null']}, {'name': 'trip_type', 'description': 'Year of pickup', 'tests': ['not_null']}, {'name': 'congestion_surcharge', 'description': 'An additional charge for trips taken during high traffic congestion times', 'tests': [None]}], 'original_file_path': 'models/tests/schema.yml', 'yaml_key': 'models', 'package_name': 'nyc_taxi'} - at path ['columns'][18]['tests'][0]: None is not valid under any of the given schemas
[2024-11-21T17:05:49.891+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:05:49.901+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 11.792 seconds
[2024-11-21T17:06:20.485+0000] {processor.py:161} INFO - Started process (PID=1920) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:06:20.486+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T17:06:20.487+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:06:20.487+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:06:20.508+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:06:20.508+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T17:06:20.840+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:06:20.840+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 0.7290948050001589
[2024-11-21T17:06:20.841+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:06:20.840+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T17:06:20.841+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:06:20.841+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T17:06:20.845+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:06:20.845+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T17:06:20.851+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:06:20.851+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T17:06:20.857+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:06:20.857+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpfd1uadvj --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T17:06:25.771+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:06:25.770+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpfd1uadvj --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T17:06:31.859+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:06:31.855+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 210, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpfd1uadvj', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
17:06:27  Running with dbt=1.8.7
17:06:29  Registered adapter: bigquery=1.8.3
17:06:30  [WARNING]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
17:06:30  Encountered an error:
Parsing Error
  Invalid models config given in models/tests/schema.yml @ models: {'name': 'fct_trips', 'description': 'Fact Table of tripdata', 'columns': [{'name': 'trip_id', 'description': 'The primary key for this table', 'tests': ['unique']}, {'name': 'vendor_id', 'description': 'A code indicating the TPEP provider that provided the record', 'tests': ['not_null']}, {'name': 'pickup_time_id', 'description': 'id to get pickup time from dim_time', 'tests': ['not_null']}, {'name': 'dropoff_time_id', 'description': 'id to get dropoff time from dim_time', 'tests': ['unique']}, {'name': 'rate_code_id', 'description': 'The final rate code in effect at the end of the trip', 'tests': ['unique']}, {'name': 'pu_location_id', 'description': 'The pickup location', 'tests': ['not_null']}, {'name': 'do_location_id', 'description': 'The droppof location', 'tests': ['not_null']}, {'name': 'passenger_count', 'description': 'Customer count', 'tests': ['unique']}, {'name': 'trip_distance', 'description': 'trip distance', 'tests': ['not_null']}, {'name': 'fare_amount', 'description': 'The time-and-distance fare calculated by the meter.', 'tests': ['not_null']}, {'name': 'extra', 'description': 'Miscellaneous extras and surcharges. Currently, this only includes. the $0.50 and $1 rush hour and overnight charges', 'tests': ['not_null']}, {'name': 'mta_tax', 'description': '0.50 MTA tax that is automatically triggered based on the metered rate in use', 'tests': ['unique']}, {'name': 'tip_amount', 'description': 'Tip amount  This field is automatically populated for credit card tips.Cash tips are not included', 'tests': ['not_null']}, {'name': 'tolls_amount', 'description': 'Total amount of all tolls paid in trip', 'tests': ['not_null']}, {'name': 'improvement_surcharge', 'description': '0.30 improvement surcharge assessed trips at the flag drop. the improvement surcharge began being levied in 2015', 'tests': ['not_null']}, {'name': 'total_amount', 'description': 'The total amount charged to passengers. Does not include cash tips.', 'tests': ['not_null']}, {'name': 'payment_type', 'description': 'A numeric code signifying how the passenger paid for the trip', 'tests': ['not_null']}, {'name': 'trip_type', 'description': 'Year of pickup', 'tests': ['not_null']}, {'name': 'congestion_surcharge', 'description': 'An additional charge for trips taken during high traffic congestion times', 'tests': [None]}], 'original_file_path': 'models/tests/schema.yml', 'yaml_key': 'models', 'package_name': 'nyc_taxi'} - at path ['columns'][18]['tests'][0]: None is not valid under any of the given schemas
[2024-11-21T17:06:31.859+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:06:31.874+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 12.363 seconds
[2024-11-21T17:07:01.971+0000] {processor.py:161} INFO - Started process (PID=1972) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:07:01.972+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T17:07:01.973+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:07:01.973+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:07:01.996+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:07:01.996+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T17:07:02.797+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:07:02.797+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 0.7901892379995843
[2024-11-21T17:07:02.798+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:07:02.797+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T17:07:02.798+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:07:02.798+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T17:07:02.803+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:07:02.802+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T17:07:02.810+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:07:02.809+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T17:07:02.817+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:07:02.817+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp5_qeohgx --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T17:07:07.437+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:07:07.437+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp5_qeohgx --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T17:07:13.599+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:07:13.596+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 210, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmp5_qeohgx', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
17:07:09  Running with dbt=1.8.7
17:07:11  Registered adapter: bigquery=1.8.3
17:07:11  [WARNING]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
17:07:11  Encountered an error:
Parsing Error
  Invalid models config given in models/tests/schema.yml @ models: {'name': 'fct_trips', 'description': 'Fact Table of tripdata', 'columns': [{'name': 'trip_id', 'description': 'The primary key for this table', 'tests': ['unique']}, {'name': 'vendor_id', 'description': 'A code indicating the TPEP provider that provided the record', 'tests': ['not_null']}, {'name': 'pickup_time_id', 'description': 'id to get pickup time from dim_time', 'tests': ['not_null']}, {'name': 'dropoff_time_id', 'description': 'id to get dropoff time from dim_time', 'tests': ['unique']}, {'name': 'rate_code_id', 'description': 'The final rate code in effect at the end of the trip', 'tests': ['unique']}, {'name': 'pu_location_id', 'description': 'The pickup location', 'tests': ['not_null']}, {'name': 'do_location_id', 'description': 'The droppof location', 'tests': ['not_null']}, {'name': 'passenger_count', 'description': 'Customer count', 'tests': ['unique']}, {'name': 'trip_distance', 'description': 'trip distance', 'tests': ['not_null']}, {'name': 'fare_amount', 'description': 'The time-and-distance fare calculated by the meter.', 'tests': ['not_null']}, {'name': 'extra', 'description': 'Miscellaneous extras and surcharges. Currently, this only includes. the $0.50 and $1 rush hour and overnight charges', 'tests': ['not_null']}, {'name': 'mta_tax', 'description': '0.50 MTA tax that is automatically triggered based on the metered rate in use', 'tests': ['unique']}, {'name': 'tip_amount', 'description': 'Tip amount  This field is automatically populated for credit card tips.Cash tips are not included', 'tests': ['not_null']}, {'name': 'tolls_amount', 'description': 'Total amount of all tolls paid in trip', 'tests': ['not_null']}, {'name': 'improvement_surcharge', 'description': '0.30 improvement surcharge assessed trips at the flag drop. the improvement surcharge began being levied in 2015', 'tests': ['not_null']}, {'name': 'total_amount', 'description': 'The total amount charged to passengers. Does not include cash tips.', 'tests': ['not_null']}, {'name': 'payment_type', 'description': 'A numeric code signifying how the passenger paid for the trip', 'tests': ['not_null']}, {'name': 'trip_type', 'description': 'Year of pickup', 'tests': ['not_null']}, {'name': 'congestion_surcharge', 'description': 'An additional charge for trips taken during high traffic congestion times', 'tests': [None]}], 'original_file_path': 'models/tests/schema.yml', 'yaml_key': 'models', 'package_name': 'nyc_taxi'} - at path ['columns'][18]['tests'][0]: None is not valid under any of the given schemas
[2024-11-21T17:07:13.600+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:07:13.610+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 11.644 seconds
[2024-11-21T17:07:44.393+0000] {processor.py:161} INFO - Started process (PID=2017) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:07:44.394+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T17:07:44.395+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:07:44.395+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:07:44.415+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:07:44.415+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T17:07:45.228+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:07:45.228+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 0.8019912909999221
[2024-11-21T17:07:45.229+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:07:45.229+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T17:07:45.229+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:07:45.229+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T17:07:45.233+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:07:45.233+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T17:07:45.241+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:07:45.240+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T17:07:45.248+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:07:45.247+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp9ap08j1n --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T17:07:49.290+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:07:49.289+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp9ap08j1n --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T17:07:55.315+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:07:55.312+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 210, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmp9ap08j1n', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
17:07:51  Running with dbt=1.8.7
17:07:52  Registered adapter: bigquery=1.8.3
17:07:53  [WARNING]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
17:07:53  Encountered an error:
Parsing Error
  Invalid models config given in models/tests/schema.yml @ models: {'name': 'fct_trips', 'description': 'Fact Table of tripdata', 'columns': [{'name': 'trip_id', 'description': 'The primary key for this table', 'tests': ['unique']}, {'name': 'vendor_id', 'description': 'A code indicating the TPEP provider that provided the record', 'tests': ['not_null']}, {'name': 'pickup_time_id', 'description': 'id to get pickup time from dim_time', 'tests': ['not_null']}, {'name': 'dropoff_time_id', 'description': 'id to get dropoff time from dim_time', 'tests': ['unique']}, {'name': 'rate_code_id', 'description': 'The final rate code in effect at the end of the trip', 'tests': ['unique']}, {'name': 'pu_location_id', 'description': 'The pickup location', 'tests': ['not_null']}, {'name': 'do_location_id', 'description': 'The droppof location', 'tests': ['not_null']}, {'name': 'passenger_count', 'description': 'Customer count', 'tests': ['unique']}, {'name': 'trip_distance', 'description': 'trip distance', 'tests': ['not_null']}, {'name': 'fare_amount', 'description': 'The time-and-distance fare calculated by the meter.', 'tests': ['not_null']}, {'name': 'extra', 'description': 'Miscellaneous extras and surcharges. Currently, this only includes. the $0.50 and $1 rush hour and overnight charges', 'tests': ['not_null']}, {'name': 'mta_tax', 'description': '0.50 MTA tax that is automatically triggered based on the metered rate in use', 'tests': ['unique']}, {'name': 'tip_amount', 'description': 'Tip amount  This field is automatically populated for credit card tips.Cash tips are not included', 'tests': ['not_null']}, {'name': 'tolls_amount', 'description': 'Total amount of all tolls paid in trip', 'tests': ['not_null']}, {'name': 'improvement_surcharge', 'description': '0.30 improvement surcharge assessed trips at the flag drop. the improvement surcharge began being levied in 2015', 'tests': ['not_null']}, {'name': 'total_amount', 'description': 'The total amount charged to passengers. Does not include cash tips.', 'tests': ['not_null']}, {'name': 'payment_type', 'description': 'A numeric code signifying how the passenger paid for the trip', 'tests': ['not_null']}, {'name': 'trip_type', 'description': 'Year of pickup', 'tests': ['not_null']}, {'name': 'congestion_surcharge', 'description': 'An additional charge for trips taken during high traffic congestion times', 'tests': [None]}], 'original_file_path': 'models/tests/schema.yml', 'yaml_key': 'models', 'package_name': 'nyc_taxi'} - at path ['columns'][18]['tests'][0]: None is not valid under any of the given schemas
[2024-11-21T17:07:55.316+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:07:55.331+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 11.902 seconds
[2024-11-21T17:08:25.612+0000] {processor.py:161} INFO - Started process (PID=2068) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:08:25.613+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T17:08:25.614+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:08:25.614+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:08:25.636+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:08:25.636+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T17:08:26.254+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:08:26.254+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 0.6076343859999724
[2024-11-21T17:08:26.255+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:08:26.255+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T17:08:26.255+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:08:26.255+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T17:08:26.259+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:08:26.259+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T17:08:26.266+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:08:26.266+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T17:08:26.271+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:08:26.271+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpywc9rm_6 --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T17:08:30.799+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:08:30.799+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpywc9rm_6 --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T17:08:37.120+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:08:37.116+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 210, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpywc9rm_6', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
17:08:33  Running with dbt=1.8.7
17:08:34  Registered adapter: bigquery=1.8.3
17:08:35  [WARNING]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
17:08:35  Encountered an error:
Parsing Error
  Invalid models config given in models/tests/schema.yml @ models: {'name': 'fct_trips', 'description': 'Fact Table of tripdata', 'columns': [{'name': 'trip_id', 'description': 'The primary key for this table', 'tests': ['unique']}, {'name': 'vendor_id', 'description': 'A code indicating the TPEP provider that provided the record', 'tests': ['not_null']}, {'name': 'pickup_time_id', 'description': 'id to get pickup time from dim_time', 'tests': ['not_null']}, {'name': 'dropoff_time_id', 'description': 'id to get dropoff time from dim_time', 'tests': ['unique']}, {'name': 'rate_code_id', 'description': 'The final rate code in effect at the end of the trip', 'tests': ['unique']}, {'name': 'pu_location_id', 'description': 'The pickup location', 'tests': ['not_null']}, {'name': 'do_location_id', 'description': 'The droppof location', 'tests': ['not_null']}, {'name': 'passenger_count', 'description': 'Customer count', 'tests': ['unique']}, {'name': 'trip_distance', 'description': 'trip distance', 'tests': ['not_null']}, {'name': 'fare_amount', 'description': 'The time-and-distance fare calculated by the meter.', 'tests': ['not_null']}, {'name': 'extra', 'description': 'Miscellaneous extras and surcharges. Currently, this only includes. the $0.50 and $1 rush hour and overnight charges', 'tests': ['not_null']}, {'name': 'mta_tax', 'description': '0.50 MTA tax that is automatically triggered based on the metered rate in use', 'tests': ['unique']}, {'name': 'tip_amount', 'description': 'Tip amount  This field is automatically populated for credit card tips.Cash tips are not included', 'tests': ['not_null']}, {'name': 'tolls_amount', 'description': 'Total amount of all tolls paid in trip', 'tests': ['not_null']}, {'name': 'improvement_surcharge', 'description': '0.30 improvement surcharge assessed trips at the flag drop. the improvement surcharge began being levied in 2015', 'tests': ['not_null']}, {'name': 'total_amount', 'description': 'The total amount charged to passengers. Does not include cash tips.', 'tests': ['not_null']}, {'name': 'payment_type', 'description': 'A numeric code signifying how the passenger paid for the trip', 'tests': ['not_null']}, {'name': 'trip_type', 'description': 'Year of pickup', 'tests': ['not_null']}, {'name': 'congestion_surcharge', 'description': 'An additional charge for trips taken during high traffic congestion times', 'tests': [None]}], 'original_file_path': 'models/tests/schema.yml', 'yaml_key': 'models', 'package_name': 'nyc_taxi'} - at path ['columns'][18]['tests'][0]: None is not valid under any of the given schemas
[2024-11-21T17:08:37.120+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:08:37.130+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 11.524 seconds
[2024-11-21T17:09:08.111+0000] {processor.py:161} INFO - Started process (PID=2114) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:09:08.112+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T17:09:08.114+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:09:08.113+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:09:08.139+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:09:08.139+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T17:09:08.999+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:09:08.999+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 0.8478825240003971
[2024-11-21T17:09:08.999+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:09:08.999+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T17:09:09.000+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:09:09.000+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T17:09:09.004+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:09:09.004+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T17:09:09.011+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:09:09.011+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T17:09:09.018+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:09:09.018+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpl21dm8vl --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T17:09:15.053+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:09:15.053+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpl21dm8vl --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T17:09:20.434+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:09:20.431+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 210, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpl21dm8vl', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
17:09:16  Running with dbt=1.8.7
17:09:17  Registered adapter: bigquery=1.8.3
17:09:18  [WARNING]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
17:09:18  Encountered an error:
Parsing Error
  Invalid models config given in models/tests/schema.yml @ models: {'name': 'fct_trips', 'description': 'Fact Table of tripdata', 'columns': [{'name': 'trip_id', 'description': 'The primary key for this table', 'tests': ['unique']}, {'name': 'vendor_id', 'description': 'A code indicating the TPEP provider that provided the record', 'tests': ['not_null']}, {'name': 'pickup_time_id', 'description': 'id to get pickup time from dim_time', 'tests': ['not_null']}, {'name': 'dropoff_time_id', 'description': 'id to get dropoff time from dim_time', 'tests': ['unique']}, {'name': 'rate_code_id', 'description': 'The final rate code in effect at the end of the trip', 'tests': ['unique']}, {'name': 'pu_location_id', 'description': 'The pickup location', 'tests': ['not_null']}, {'name': 'do_location_id', 'description': 'The droppof location', 'tests': ['not_null']}, {'name': 'passenger_count', 'description': 'Customer count', 'tests': ['unique']}, {'name': 'trip_distance', 'description': 'trip distance', 'tests': ['not_null']}, {'name': 'fare_amount', 'description': 'The time-and-distance fare calculated by the meter.', 'tests': ['not_null']}, {'name': 'extra', 'description': 'Miscellaneous extras and surcharges. Currently, this only includes. the $0.50 and $1 rush hour and overnight charges', 'tests': ['not_null']}, {'name': 'mta_tax', 'description': '0.50 MTA tax that is automatically triggered based on the metered rate in use', 'tests': ['unique']}, {'name': 'tip_amount', 'description': 'Tip amount  This field is automatically populated for credit card tips.Cash tips are not included', 'tests': ['not_null']}, {'name': 'tolls_amount', 'description': 'Total amount of all tolls paid in trip', 'tests': ['not_null']}, {'name': 'improvement_surcharge', 'description': '0.30 improvement surcharge assessed trips at the flag drop. the improvement surcharge began being levied in 2015', 'tests': ['not_null']}, {'name': 'total_amount', 'description': 'The total amount charged to passengers. Does not include cash tips.', 'tests': ['not_null']}, {'name': 'payment_type', 'description': 'A numeric code signifying how the passenger paid for the trip', 'tests': ['not_null']}, {'name': 'trip_type', 'description': 'Year of pickup', 'tests': ['not_null']}, {'name': 'congestion_surcharge', 'description': 'An additional charge for trips taken during high traffic congestion times', 'tests': [None]}], 'original_file_path': 'models/tests/schema.yml', 'yaml_key': 'models', 'package_name': 'nyc_taxi'} - at path ['columns'][18]['tests'][0]: None is not valid under any of the given schemas
[2024-11-21T17:09:20.435+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:09:20.451+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 13.281 seconds
[2024-11-21T17:09:50.535+0000] {processor.py:161} INFO - Started process (PID=2165) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:09:50.536+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T17:09:50.537+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:09:50.537+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:09:50.560+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:09:50.560+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T17:09:51.316+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:09:51.316+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 0.744223644000158
[2024-11-21T17:09:51.316+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:09:51.316+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T17:09:51.317+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:09:51.317+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T17:09:51.320+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:09:51.320+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T17:09:51.327+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:09:51.327+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T17:09:51.334+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:09:51.333+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpc4tt04c0 --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T17:09:56.054+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:09:56.053+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpc4tt04c0 --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T17:10:02.764+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:10:02.760+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 210, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpc4tt04c0', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
17:09:58  Running with dbt=1.8.7
17:09:59  Registered adapter: bigquery=1.8.3
17:10:00  [WARNING]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
17:10:00  Encountered an error:
Parsing Error
  Invalid models config given in models/tests/schema.yml @ models: {'name': 'fct_trips', 'description': 'Fact Table of tripdata', 'columns': [{'name': 'trip_id', 'description': 'The primary key for this table', 'tests': ['unique']}, {'name': 'vendor_id', 'description': 'A code indicating the TPEP provider that provided the record', 'tests': ['not_null']}, {'name': 'pickup_time_id', 'description': 'id to get pickup time from dim_time', 'tests': ['not_null']}, {'name': 'dropoff_time_id', 'description': 'id to get dropoff time from dim_time', 'tests': ['unique']}, {'name': 'rate_code_id', 'description': 'The final rate code in effect at the end of the trip', 'tests': ['unique']}, {'name': 'pu_location_id', 'description': 'The pickup location', 'tests': ['not_null']}, {'name': 'do_location_id', 'description': 'The droppof location', 'tests': ['not_null']}, {'name': 'passenger_count', 'description': 'Customer count', 'tests': ['unique']}, {'name': 'trip_distance', 'description': 'trip distance', 'tests': ['not_null']}, {'name': 'fare_amount', 'description': 'The time-and-distance fare calculated by the meter.', 'tests': ['not_null']}, {'name': 'extra', 'description': 'Miscellaneous extras and surcharges. Currently, this only includes. the $0.50 and $1 rush hour and overnight charges', 'tests': ['not_null']}, {'name': 'mta_tax', 'description': '0.50 MTA tax that is automatically triggered based on the metered rate in use', 'tests': ['unique']}, {'name': 'tip_amount', 'description': 'Tip amount  This field is automatically populated for credit card tips.Cash tips are not included', 'tests': ['not_null']}, {'name': 'tolls_amount', 'description': 'Total amount of all tolls paid in trip', 'tests': ['not_null']}, {'name': 'improvement_surcharge', 'description': '0.30 improvement surcharge assessed trips at the flag drop. the improvement surcharge began being levied in 2015', 'tests': ['not_null']}, {'name': 'total_amount', 'description': 'The total amount charged to passengers. Does not include cash tips.', 'tests': ['not_null']}, {'name': 'payment_type', 'description': 'A numeric code signifying how the passenger paid for the trip', 'tests': ['not_null']}, {'name': 'trip_type', 'description': 'Year of pickup', 'tests': ['not_null']}, {'name': 'congestion_surcharge', 'description': 'An additional charge for trips taken during high traffic congestion times', 'tests': [None]}], 'original_file_path': 'models/tests/schema.yml', 'yaml_key': 'models', 'package_name': 'nyc_taxi'} - at path ['columns'][18]['tests'][0]: None is not valid under any of the given schemas
[2024-11-21T17:10:02.765+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:10:02.774+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 12.245 seconds
[2024-11-21T17:10:33.090+0000] {processor.py:161} INFO - Started process (PID=2211) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:10:33.090+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T17:10:33.092+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:10:33.091+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:10:33.114+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:10:33.113+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T17:10:33.858+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:10:33.858+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 0.7338848259996666
[2024-11-21T17:10:33.859+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:10:33.858+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T17:10:33.859+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:10:33.859+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T17:10:33.863+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:10:33.863+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T17:10:33.869+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:10:33.869+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T17:10:33.875+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:10:33.875+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpkwob1evb --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T17:10:38.704+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:10:38.703+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpkwob1evb --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T17:10:44.108+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:10:44.105+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 210, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpkwob1evb', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
17:10:40  Running with dbt=1.8.7
17:10:42  Registered adapter: bigquery=1.8.3
17:10:42  [WARNING]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
17:10:42  Encountered an error:
Parsing Error
  Invalid models config given in models/tests/schema.yml @ models: {'name': 'fct_trips', 'description': 'Fact Table of tripdata', 'columns': [{'name': 'trip_id', 'description': 'The primary key for this table', 'tests': ['unique']}, {'name': 'vendor_id', 'description': 'A code indicating the TPEP provider that provided the record', 'tests': ['not_null']}, {'name': 'pickup_time_id', 'description': 'id to get pickup time from dim_time', 'tests': ['not_null']}, {'name': 'dropoff_time_id', 'description': 'id to get dropoff time from dim_time', 'tests': ['unique']}, {'name': 'rate_code_id', 'description': 'The final rate code in effect at the end of the trip', 'tests': ['unique']}, {'name': 'pu_location_id', 'description': 'The pickup location', 'tests': ['not_null']}, {'name': 'do_location_id', 'description': 'The droppof location', 'tests': ['not_null']}, {'name': 'passenger_count', 'description': 'Customer count', 'tests': ['unique']}, {'name': 'trip_distance', 'description': 'trip distance', 'tests': ['not_null']}, {'name': 'fare_amount', 'description': 'The time-and-distance fare calculated by the meter.', 'tests': ['not_null']}, {'name': 'extra', 'description': 'Miscellaneous extras and surcharges. Currently, this only includes. the $0.50 and $1 rush hour and overnight charges', 'tests': ['not_null']}, {'name': 'mta_tax', 'description': '0.50 MTA tax that is automatically triggered based on the metered rate in use', 'tests': ['unique']}, {'name': 'tip_amount', 'description': 'Tip amount  This field is automatically populated for credit card tips.Cash tips are not included', 'tests': ['not_null']}, {'name': 'tolls_amount', 'description': 'Total amount of all tolls paid in trip', 'tests': ['not_null']}, {'name': 'improvement_surcharge', 'description': '0.30 improvement surcharge assessed trips at the flag drop. the improvement surcharge began being levied in 2015', 'tests': ['not_null']}, {'name': 'total_amount', 'description': 'The total amount charged to passengers. Does not include cash tips.', 'tests': ['not_null']}, {'name': 'payment_type', 'description': 'A numeric code signifying how the passenger paid for the trip', 'tests': ['not_null']}, {'name': 'trip_type', 'description': 'Year of pickup', 'tests': ['not_null']}, {'name': 'congestion_surcharge', 'description': 'An additional charge for trips taken during high traffic congestion times', 'tests': [None]}], 'original_file_path': 'models/tests/schema.yml', 'yaml_key': 'models', 'package_name': 'nyc_taxi'} - at path ['columns'][18]['tests'][0]: None is not valid under any of the given schemas
[2024-11-21T17:10:44.109+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:10:44.125+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 12.098 seconds
[2024-11-21T17:11:14.533+0000] {processor.py:161} INFO - Started process (PID=2263) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:11:14.534+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T17:11:14.535+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:11:14.535+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:11:14.558+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:11:14.558+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T17:11:15.287+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:11:15.287+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 0.7189149760001783
[2024-11-21T17:11:15.288+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:11:15.288+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T17:11:15.288+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:11:15.288+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T17:11:15.292+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:11:15.292+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T17:11:15.298+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:11:15.298+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T17:11:15.303+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:11:15.303+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp85yvuwtu --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T17:11:20.045+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:11:20.045+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp85yvuwtu --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T17:11:26.891+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:11:26.886+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 210, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmp85yvuwtu', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
17:11:22  Running with dbt=1.8.7
17:11:24  Registered adapter: bigquery=1.8.3
17:11:25  [WARNING]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
17:11:25  Encountered an error:
Parsing Error
  Invalid models config given in models/tests/schema.yml @ models: {'name': 'fct_trips', 'description': 'Fact Table of tripdata', 'columns': [{'name': 'trip_id', 'description': 'The primary key for this table', 'tests': ['unique']}, {'name': 'vendor_id', 'description': 'A code indicating the TPEP provider that provided the record', 'tests': ['not_null']}, {'name': 'pickup_time_id', 'description': 'id to get pickup time from dim_time', 'tests': ['not_null']}, {'name': 'dropoff_time_id', 'description': 'id to get dropoff time from dim_time', 'tests': ['unique']}, {'name': 'rate_code_id', 'description': 'The final rate code in effect at the end of the trip', 'tests': ['unique']}, {'name': 'pu_location_id', 'description': 'The pickup location', 'tests': ['not_null']}, {'name': 'do_location_id', 'description': 'The droppof location', 'tests': ['not_null']}, {'name': 'passenger_count', 'description': 'Customer count', 'tests': ['unique']}, {'name': 'trip_distance', 'description': 'trip distance', 'tests': ['not_null']}, {'name': 'fare_amount', 'description': 'The time-and-distance fare calculated by the meter.', 'tests': ['not_null']}, {'name': 'extra', 'description': 'Miscellaneous extras and surcharges. Currently, this only includes. the $0.50 and $1 rush hour and overnight charges', 'tests': ['not_null']}, {'name': 'mta_tax', 'description': '0.50 MTA tax that is automatically triggered based on the metered rate in use', 'tests': ['unique']}, {'name': 'tip_amount', 'description': 'Tip amount  This field is automatically populated for credit card tips.Cash tips are not included', 'tests': ['not_null']}, {'name': 'tolls_amount', 'description': 'Total amount of all tolls paid in trip', 'tests': ['not_null']}, {'name': 'improvement_surcharge', 'description': '0.30 improvement surcharge assessed trips at the flag drop. the improvement surcharge began being levied in 2015', 'tests': ['not_null']}, {'name': 'total_amount', 'description': 'The total amount charged to passengers. Does not include cash tips.', 'tests': ['not_null']}, {'name': 'payment_type', 'description': 'A numeric code signifying how the passenger paid for the trip', 'tests': ['not_null']}, {'name': 'trip_type', 'description': 'Year of pickup', 'tests': ['not_null']}, {'name': 'congestion_surcharge', 'description': 'An additional charge for trips taken during high traffic congestion times', 'tests': [None]}], 'original_file_path': 'models/tests/schema.yml', 'yaml_key': 'models', 'package_name': 'nyc_taxi'} - at path ['columns'][18]['tests'][0]: None is not valid under any of the given schemas
[2024-11-21T17:11:26.891+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:11:26.907+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 12.379 seconds
[2024-11-21T17:11:56.989+0000] {processor.py:161} INFO - Started process (PID=2308) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:11:56.990+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T17:11:56.991+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:11:56.991+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:11:57.013+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:11:57.013+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T17:11:57.749+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:11:57.749+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 0.7259099040002184
[2024-11-21T17:11:57.750+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:11:57.750+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T17:11:57.750+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:11:57.750+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T17:11:57.754+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:11:57.754+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T17:11:57.760+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:11:57.760+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T17:11:57.766+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:11:57.766+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpo61_86v5 --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T17:12:03.389+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:12:03.388+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpo61_86v5 --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T17:12:09.247+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:12:09.244+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 210, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpo61_86v5', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
17:12:05  Running with dbt=1.8.7
17:12:07  Registered adapter: bigquery=1.8.3
17:12:07  [WARNING]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
17:12:07  Encountered an error:
Parsing Error
  Invalid models config given in models/tests/schema.yml @ models: {'name': 'fct_trips', 'description': 'Fact Table of tripdata', 'columns': [{'name': 'trip_id', 'description': 'The primary key for this table', 'tests': ['unique']}, {'name': 'vendor_id', 'description': 'A code indicating the TPEP provider that provided the record', 'tests': ['not_null']}, {'name': 'pickup_time_id', 'description': 'id to get pickup time from dim_time', 'tests': ['not_null']}, {'name': 'dropoff_time_id', 'description': 'id to get dropoff time from dim_time', 'tests': ['unique']}, {'name': 'rate_code_id', 'description': 'The final rate code in effect at the end of the trip', 'tests': ['unique']}, {'name': 'pu_location_id', 'description': 'The pickup location', 'tests': ['not_null']}, {'name': 'do_location_id', 'description': 'The droppof location', 'tests': ['not_null']}, {'name': 'passenger_count', 'description': 'Customer count', 'tests': ['unique']}, {'name': 'trip_distance', 'description': 'trip distance', 'tests': ['not_null']}, {'name': 'fare_amount', 'description': 'The time-and-distance fare calculated by the meter.', 'tests': ['not_null']}, {'name': 'extra', 'description': 'Miscellaneous extras and surcharges. Currently, this only includes. the $0.50 and $1 rush hour and overnight charges', 'tests': ['not_null']}, {'name': 'mta_tax', 'description': '0.50 MTA tax that is automatically triggered based on the metered rate in use', 'tests': ['unique']}, {'name': 'tip_amount', 'description': 'Tip amount  This field is automatically populated for credit card tips.Cash tips are not included', 'tests': ['not_null']}, {'name': 'tolls_amount', 'description': 'Total amount of all tolls paid in trip', 'tests': ['not_null']}, {'name': 'improvement_surcharge', 'description': '0.30 improvement surcharge assessed trips at the flag drop. the improvement surcharge began being levied in 2015', 'tests': ['not_null']}, {'name': 'total_amount', 'description': 'The total amount charged to passengers. Does not include cash tips.', 'tests': ['not_null']}, {'name': 'payment_type', 'description': 'A numeric code signifying how the passenger paid for the trip', 'tests': ['not_null']}, {'name': 'trip_type', 'description': 'Year of pickup', 'tests': ['not_null']}, {'name': 'congestion_surcharge', 'description': 'An additional charge for trips taken during high traffic congestion times', 'tests': [None]}], 'original_file_path': 'models/tests/schema.yml', 'yaml_key': 'models', 'package_name': 'nyc_taxi'} - at path ['columns'][18]['tests'][0]: None is not valid under any of the given schemas
[2024-11-21T17:12:09.248+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:12:09.264+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 12.685 seconds
[2024-11-21T17:12:39.440+0000] {processor.py:161} INFO - Started process (PID=2360) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:12:39.441+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T17:12:39.442+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:12:39.442+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:12:39.465+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:12:39.465+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T17:12:40.287+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:12:40.287+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 0.8107952780001142
[2024-11-21T17:12:40.288+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:12:40.288+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T17:12:40.288+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:12:40.288+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T17:12:40.292+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:12:40.292+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T17:12:40.299+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:12:40.299+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T17:12:40.305+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:12:40.305+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp1d7gk59a --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T17:12:45.266+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:12:45.266+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp1d7gk59a --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T17:12:51.608+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:12:51.604+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 210, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmp1d7gk59a', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
17:12:47  Running with dbt=1.8.7
17:12:48  Registered adapter: bigquery=1.8.3
17:12:49  [WARNING]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
17:12:49  Encountered an error:
Parsing Error
  Invalid models config given in models/tests/schema.yml @ models: {'name': 'fct_trips', 'description': 'Fact Table of tripdata', 'columns': [{'name': 'trip_id', 'description': 'The primary key for this table', 'tests': ['unique']}, {'name': 'vendor_id', 'description': 'A code indicating the TPEP provider that provided the record', 'tests': ['not_null']}, {'name': 'pickup_time_id', 'description': 'id to get pickup time from dim_time', 'tests': ['not_null']}, {'name': 'dropoff_time_id', 'description': 'id to get dropoff time from dim_time', 'tests': ['unique']}, {'name': 'rate_code_id', 'description': 'The final rate code in effect at the end of the trip', 'tests': ['unique']}, {'name': 'pu_location_id', 'description': 'The pickup location', 'tests': ['not_null']}, {'name': 'do_location_id', 'description': 'The droppof location', 'tests': ['not_null']}, {'name': 'passenger_count', 'description': 'Customer count', 'tests': ['unique']}, {'name': 'trip_distance', 'description': 'trip distance', 'tests': ['not_null']}, {'name': 'fare_amount', 'description': 'The time-and-distance fare calculated by the meter.', 'tests': ['not_null']}, {'name': 'extra', 'description': 'Miscellaneous extras and surcharges. Currently, this only includes. the $0.50 and $1 rush hour and overnight charges', 'tests': ['not_null']}, {'name': 'mta_tax', 'description': '0.50 MTA tax that is automatically triggered based on the metered rate in use', 'tests': ['unique']}, {'name': 'tip_amount', 'description': 'Tip amount  This field is automatically populated for credit card tips.Cash tips are not included', 'tests': ['not_null']}, {'name': 'tolls_amount', 'description': 'Total amount of all tolls paid in trip', 'tests': ['not_null']}, {'name': 'improvement_surcharge', 'description': '0.30 improvement surcharge assessed trips at the flag drop. the improvement surcharge began being levied in 2015', 'tests': ['not_null']}, {'name': 'total_amount', 'description': 'The total amount charged to passengers. Does not include cash tips.', 'tests': ['not_null']}, {'name': 'payment_type', 'description': 'A numeric code signifying how the passenger paid for the trip', 'tests': ['not_null']}, {'name': 'trip_type', 'description': 'Year of pickup', 'tests': ['not_null']}, {'name': 'congestion_surcharge', 'description': 'An additional charge for trips taken during high traffic congestion times', 'tests': [None]}], 'original_file_path': 'models/tests/schema.yml', 'yaml_key': 'models', 'package_name': 'nyc_taxi'} - at path ['columns'][18]['tests'][0]: None is not valid under any of the given schemas
[2024-11-21T17:12:51.609+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:12:51.618+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 12.184 seconds
[2024-11-21T17:13:21.882+0000] {processor.py:161} INFO - Started process (PID=2405) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:13:21.882+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T17:13:21.884+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:13:21.884+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:13:21.907+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:13:21.906+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T17:13:22.696+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:13:22.696+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 0.7791471410000668
[2024-11-21T17:13:22.697+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:13:22.697+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T17:13:22.697+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:13:22.697+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T17:13:22.701+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:13:22.701+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T17:13:22.708+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:13:22.708+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T17:13:22.714+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:13:22.714+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp3ftz0tis --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T17:13:28.601+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:13:28.600+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp3ftz0tis --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T17:13:35.396+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:13:35.391+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 210, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmp3ftz0tis', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
17:13:30  Running with dbt=1.8.7
17:13:32  Registered adapter: bigquery=1.8.3
17:13:33  [WARNING]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
17:13:33  Encountered an error:
Parsing Error
  Invalid models config given in models/tests/schema.yml @ models: {'name': 'fct_trips', 'description': 'Fact Table of tripdata', 'columns': [{'name': 'trip_id', 'description': 'The primary key for this table', 'tests': ['unique']}, {'name': 'vendor_id', 'description': 'A code indicating the TPEP provider that provided the record', 'tests': ['not_null']}, {'name': 'pickup_time_id', 'description': 'id to get pickup time from dim_time', 'tests': ['not_null']}, {'name': 'dropoff_time_id', 'description': 'id to get dropoff time from dim_time', 'tests': ['unique']}, {'name': 'rate_code_id', 'description': 'The final rate code in effect at the end of the trip', 'tests': ['unique']}, {'name': 'pu_location_id', 'description': 'The pickup location', 'tests': ['not_null']}, {'name': 'do_location_id', 'description': 'The droppof location', 'tests': ['not_null']}, {'name': 'passenger_count', 'description': 'Customer count', 'tests': ['unique']}, {'name': 'trip_distance', 'description': 'trip distance', 'tests': ['not_null']}, {'name': 'fare_amount', 'description': 'The time-and-distance fare calculated by the meter.', 'tests': ['not_null']}, {'name': 'extra', 'description': 'Miscellaneous extras and surcharges. Currently, this only includes. the $0.50 and $1 rush hour and overnight charges', 'tests': ['not_null']}, {'name': 'mta_tax', 'description': '0.50 MTA tax that is automatically triggered based on the metered rate in use', 'tests': ['unique']}, {'name': 'tip_amount', 'description': 'Tip amount  This field is automatically populated for credit card tips.Cash tips are not included', 'tests': ['not_null']}, {'name': 'tolls_amount', 'description': 'Total amount of all tolls paid in trip', 'tests': ['not_null']}, {'name': 'improvement_surcharge', 'description': '0.30 improvement surcharge assessed trips at the flag drop. the improvement surcharge began being levied in 2015', 'tests': ['not_null']}, {'name': 'total_amount', 'description': 'The total amount charged to passengers. Does not include cash tips.', 'tests': ['not_null']}, {'name': 'payment_type', 'description': 'A numeric code signifying how the passenger paid for the trip', 'tests': ['not_null']}, {'name': 'trip_type', 'description': 'Year of pickup', 'tests': ['not_null']}, {'name': 'congestion_surcharge', 'description': 'An additional charge for trips taken during high traffic congestion times', 'tests': [None]}], 'original_file_path': 'models/tests/schema.yml', 'yaml_key': 'models', 'package_name': 'nyc_taxi'} - at path ['columns'][18]['tests'][0]: None is not valid under any of the given schemas
[2024-11-21T17:13:35.397+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:13:35.413+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 13.536 seconds
[2024-11-21T17:14:06.383+0000] {processor.py:161} INFO - Started process (PID=2457) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:14:06.384+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T17:14:06.386+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:14:06.386+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:14:06.413+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:14:06.412+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T17:14:07.250+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:14:07.250+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 0.824674554000012
[2024-11-21T17:14:07.250+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:14:07.250+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T17:14:07.251+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:14:07.251+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T17:14:07.255+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:14:07.254+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T17:14:07.262+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:14:07.262+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T17:14:07.268+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:14:07.268+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp9vyvo2gg --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T17:14:12.181+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:14:12.180+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp9vyvo2gg --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T17:14:18.402+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:14:18.398+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 210, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmp9vyvo2gg', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
17:14:14  Running with dbt=1.8.7
17:14:15  Registered adapter: bigquery=1.8.3
17:14:16  [WARNING]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
17:14:16  Encountered an error:
Parsing Error
  Invalid models config given in models/tests/schema.yml @ models: {'name': 'fct_trips', 'description': 'Fact Table of tripdata', 'columns': [{'name': 'trip_id', 'description': 'The primary key for this table', 'tests': ['unique']}, {'name': 'vendor_id', 'description': 'A code indicating the TPEP provider that provided the record', 'tests': ['not_null']}, {'name': 'pickup_time_id', 'description': 'id to get pickup time from dim_time', 'tests': ['not_null']}, {'name': 'dropoff_time_id', 'description': 'id to get dropoff time from dim_time', 'tests': ['unique']}, {'name': 'rate_code_id', 'description': 'The final rate code in effect at the end of the trip', 'tests': ['unique']}, {'name': 'pu_location_id', 'description': 'The pickup location', 'tests': ['not_null']}, {'name': 'do_location_id', 'description': 'The droppof location', 'tests': ['not_null']}, {'name': 'passenger_count', 'description': 'Customer count', 'tests': ['unique']}, {'name': 'trip_distance', 'description': 'trip distance', 'tests': ['not_null']}, {'name': 'fare_amount', 'description': 'The time-and-distance fare calculated by the meter.', 'tests': ['not_null']}, {'name': 'extra', 'description': 'Miscellaneous extras and surcharges. Currently, this only includes. the $0.50 and $1 rush hour and overnight charges', 'tests': ['not_null']}, {'name': 'mta_tax', 'description': '0.50 MTA tax that is automatically triggered based on the metered rate in use', 'tests': ['unique']}, {'name': 'tip_amount', 'description': 'Tip amount  This field is automatically populated for credit card tips.Cash tips are not included', 'tests': ['not_null']}, {'name': 'tolls_amount', 'description': 'Total amount of all tolls paid in trip', 'tests': ['not_null']}, {'name': 'improvement_surcharge', 'description': '0.30 improvement surcharge assessed trips at the flag drop. the improvement surcharge began being levied in 2015', 'tests': ['not_null']}, {'name': 'total_amount', 'description': 'The total amount charged to passengers. Does not include cash tips.', 'tests': ['not_null']}, {'name': 'payment_type', 'description': 'A numeric code signifying how the passenger paid for the trip', 'tests': ['not_null']}, {'name': 'trip_type', 'description': 'Year of pickup', 'tests': ['not_null']}, {'name': 'congestion_surcharge', 'description': 'An additional charge for trips taken during high traffic congestion times', 'tests': [None]}], 'original_file_path': 'models/tests/schema.yml', 'yaml_key': 'models', 'package_name': 'nyc_taxi'} - at path ['columns'][18]['tests'][0]: None is not valid under any of the given schemas
[2024-11-21T17:14:18.403+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:14:18.413+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 12.036 seconds
[2024-11-21T17:14:48.865+0000] {processor.py:161} INFO - Started process (PID=2502) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:14:48.865+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T17:14:48.867+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:14:48.866+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:14:48.890+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:14:48.890+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T17:14:49.656+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:14:49.656+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 0.7552728839996234
[2024-11-21T17:14:49.657+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:14:49.656+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T17:14:49.657+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:14:49.657+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T17:14:49.661+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:14:49.661+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T17:14:49.667+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:14:49.667+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T17:14:49.673+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:14:49.673+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpu6wvprw2 --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T17:14:55.226+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:14:55.226+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpu6wvprw2 --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T17:15:01.734+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:15:01.730+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 210, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpu6wvprw2', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
17:14:57  Running with dbt=1.8.7
17:14:59  Registered adapter: bigquery=1.8.3
17:15:00  [WARNING]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
17:15:00  Encountered an error:
Parsing Error
  Invalid models config given in models/tests/schema.yml @ models: {'name': 'fct_trips', 'description': 'Fact Table of tripdata', 'columns': [{'name': 'trip_id', 'description': 'The primary key for this table', 'tests': ['unique']}, {'name': 'vendor_id', 'description': 'A code indicating the TPEP provider that provided the record', 'tests': ['not_null']}, {'name': 'pickup_time_id', 'description': 'id to get pickup time from dim_time', 'tests': ['not_null']}, {'name': 'dropoff_time_id', 'description': 'id to get dropoff time from dim_time', 'tests': ['unique']}, {'name': 'rate_code_id', 'description': 'The final rate code in effect at the end of the trip', 'tests': ['unique']}, {'name': 'pu_location_id', 'description': 'The pickup location', 'tests': ['not_null']}, {'name': 'do_location_id', 'description': 'The droppof location', 'tests': ['not_null']}, {'name': 'passenger_count', 'description': 'Customer count', 'tests': ['unique']}, {'name': 'trip_distance', 'description': 'trip distance', 'tests': ['not_null']}, {'name': 'fare_amount', 'description': 'The time-and-distance fare calculated by the meter.', 'tests': ['not_null']}, {'name': 'extra', 'description': 'Miscellaneous extras and surcharges. Currently, this only includes. the $0.50 and $1 rush hour and overnight charges', 'tests': ['not_null']}, {'name': 'mta_tax', 'description': '0.50 MTA tax that is automatically triggered based on the metered rate in use', 'tests': ['unique']}, {'name': 'tip_amount', 'description': 'Tip amount  This field is automatically populated for credit card tips.Cash tips are not included', 'tests': ['not_null']}, {'name': 'tolls_amount', 'description': 'Total amount of all tolls paid in trip', 'tests': ['not_null']}, {'name': 'improvement_surcharge', 'description': '0.30 improvement surcharge assessed trips at the flag drop. the improvement surcharge began being levied in 2015', 'tests': ['not_null']}, {'name': 'total_amount', 'description': 'The total amount charged to passengers. Does not include cash tips.', 'tests': ['not_null']}, {'name': 'payment_type', 'description': 'A numeric code signifying how the passenger paid for the trip', 'tests': ['not_null']}, {'name': 'trip_type', 'description': 'Year of pickup', 'tests': ['not_null']}, {'name': 'congestion_surcharge', 'description': 'An additional charge for trips taken during high traffic congestion times', 'tests': [None]}], 'original_file_path': 'models/tests/schema.yml', 'yaml_key': 'models', 'package_name': 'nyc_taxi'} - at path ['columns'][18]['tests'][0]: None is not valid under any of the given schemas
[2024-11-21T17:15:01.735+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:15:01.745+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 12.885 seconds
[2024-11-21T17:15:32.026+0000] {processor.py:161} INFO - Started process (PID=2547) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:15:32.027+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T17:15:32.028+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:15:32.028+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:15:32.051+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:15:32.050+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T17:15:31.833+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:15:31.832+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 0.7736402939999607
[2024-11-21T17:15:31.833+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:15:31.833+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T17:15:31.833+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:15:31.833+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T17:15:31.838+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:15:31.838+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T17:15:31.846+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:15:31.846+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T17:15:31.853+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:15:31.853+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpg0orygqm --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T17:15:39.860+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:15:39.860+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpg0orygqm --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T17:15:46.300+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:15:46.296+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 210, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpg0orygqm', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
17:15:42  Running with dbt=1.8.7
17:15:43  Registered adapter: bigquery=1.8.3
17:15:44  [WARNING]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
17:15:44  Encountered an error:
Parsing Error
  Invalid models config given in models/tests/schema.yml @ models: {'name': 'fct_trips', 'description': 'Fact Table of tripdata', 'columns': [{'name': 'trip_id', 'description': 'The primary key for this table', 'tests': ['unique']}, {'name': 'vendor_id', 'description': 'A code indicating the TPEP provider that provided the record', 'tests': ['not_null']}, {'name': 'pickup_time_id', 'description': 'id to get pickup time from dim_time', 'tests': ['not_null']}, {'name': 'dropoff_time_id', 'description': 'id to get dropoff time from dim_time', 'tests': ['unique']}, {'name': 'rate_code_id', 'description': 'The final rate code in effect at the end of the trip', 'tests': ['unique']}, {'name': 'pu_location_id', 'description': 'The pickup location', 'tests': ['not_null']}, {'name': 'do_location_id', 'description': 'The droppof location', 'tests': ['not_null']}, {'name': 'passenger_count', 'description': 'Customer count', 'tests': ['unique']}, {'name': 'trip_distance', 'description': 'trip distance', 'tests': ['not_null']}, {'name': 'fare_amount', 'description': 'The time-and-distance fare calculated by the meter.', 'tests': ['not_null']}, {'name': 'extra', 'description': 'Miscellaneous extras and surcharges. Currently, this only includes. the $0.50 and $1 rush hour and overnight charges', 'tests': ['not_null']}, {'name': 'mta_tax', 'description': '0.50 MTA tax that is automatically triggered based on the metered rate in use', 'tests': ['unique']}, {'name': 'tip_amount', 'description': 'Tip amount  This field is automatically populated for credit card tips.Cash tips are not included', 'tests': ['not_null']}, {'name': 'tolls_amount', 'description': 'Total amount of all tolls paid in trip', 'tests': ['not_null']}, {'name': 'improvement_surcharge', 'description': '0.30 improvement surcharge assessed trips at the flag drop. the improvement surcharge began being levied in 2015', 'tests': ['not_null']}, {'name': 'total_amount', 'description': 'The total amount charged to passengers. Does not include cash tips.', 'tests': ['not_null']}, {'name': 'payment_type', 'description': 'A numeric code signifying how the passenger paid for the trip', 'tests': ['not_null']}, {'name': 'trip_type', 'description': 'Year of pickup', 'tests': ['not_null']}, {'name': 'congestion_surcharge', 'description': 'An additional charge for trips taken during high traffic congestion times', 'tests': [None]}], 'original_file_path': 'models/tests/schema.yml', 'yaml_key': 'models', 'package_name': 'nyc_taxi'} - at path ['columns'][18]['tests'][0]: None is not valid under any of the given schemas
[2024-11-21T17:15:46.301+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:15:46.315+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 15.296 seconds
[2024-11-21T17:16:16.567+0000] {processor.py:161} INFO - Started process (PID=2599) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:16:16.567+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T17:16:16.569+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:16:16.569+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:16:16.591+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:16:16.591+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T17:16:17.329+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:16:17.329+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 0.7280061770002249
[2024-11-21T17:16:17.330+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:16:17.330+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T17:16:17.330+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:16:17.330+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T17:16:17.334+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:16:17.334+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T17:16:17.340+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:16:17.340+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T17:16:17.346+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:16:17.346+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpsalg0a96 --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T17:16:22.693+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:16:22.693+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpsalg0a96 --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T17:16:29.130+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:16:29.127+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 210, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpsalg0a96', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
17:16:24  Running with dbt=1.8.7
17:16:26  Registered adapter: bigquery=1.8.3
17:16:27  [WARNING]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
17:16:27  Encountered an error:
Parsing Error
  Invalid models config given in models/tests/schema.yml @ models: {'name': 'fct_trips', 'description': 'Fact Table of tripdata', 'columns': [{'name': 'trip_id', 'description': 'The primary key for this table', 'tests': ['unique']}, {'name': 'vendor_id', 'description': 'A code indicating the TPEP provider that provided the record', 'tests': ['not_null']}, {'name': 'pickup_time_id', 'description': 'id to get pickup time from dim_time', 'tests': ['not_null']}, {'name': 'dropoff_time_id', 'description': 'id to get dropoff time from dim_time', 'tests': ['unique']}, {'name': 'rate_code_id', 'description': 'The final rate code in effect at the end of the trip', 'tests': ['unique']}, {'name': 'pu_location_id', 'description': 'The pickup location', 'tests': ['not_null']}, {'name': 'do_location_id', 'description': 'The droppof location', 'tests': ['not_null']}, {'name': 'passenger_count', 'description': 'Customer count', 'tests': ['unique']}, {'name': 'trip_distance', 'description': 'trip distance', 'tests': ['not_null']}, {'name': 'fare_amount', 'description': 'The time-and-distance fare calculated by the meter.', 'tests': ['not_null']}, {'name': 'extra', 'description': 'Miscellaneous extras and surcharges. Currently, this only includes. the $0.50 and $1 rush hour and overnight charges', 'tests': ['not_null']}, {'name': 'mta_tax', 'description': '0.50 MTA tax that is automatically triggered based on the metered rate in use', 'tests': ['unique']}, {'name': 'tip_amount', 'description': 'Tip amount  This field is automatically populated for credit card tips.Cash tips are not included', 'tests': ['not_null']}, {'name': 'tolls_amount', 'description': 'Total amount of all tolls paid in trip', 'tests': ['not_null']}, {'name': 'improvement_surcharge', 'description': '0.30 improvement surcharge assessed trips at the flag drop. the improvement surcharge began being levied in 2015', 'tests': ['not_null']}, {'name': 'total_amount', 'description': 'The total amount charged to passengers. Does not include cash tips.', 'tests': ['not_null']}, {'name': 'payment_type', 'description': 'A numeric code signifying how the passenger paid for the trip', 'tests': ['not_null']}, {'name': 'trip_type', 'description': 'Year of pickup', 'tests': ['not_null']}, {'name': 'congestion_surcharge', 'description': 'An additional charge for trips taken during high traffic congestion times', 'tests': [None]}], 'original_file_path': 'models/tests/schema.yml', 'yaml_key': 'models', 'package_name': 'nyc_taxi'} - at path ['columns'][18]['tests'][0]: None is not valid under any of the given schemas
[2024-11-21T17:16:29.131+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:16:29.147+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 12.585 seconds
[2024-11-21T17:17:00.047+0000] {processor.py:161} INFO - Started process (PID=2650) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:17:00.048+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T17:17:00.049+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:17:00.049+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:17:00.073+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:17:00.073+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T17:17:00.849+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:17:00.848+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 0.7643397409997306
[2024-11-21T17:17:00.849+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:17:00.849+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T17:17:00.850+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:17:00.849+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T17:17:00.853+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:17:00.853+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T17:17:00.860+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:17:00.860+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T17:17:00.866+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:17:00.866+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpvh3k_d_l --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T17:17:05.642+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:17:05.641+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpvh3k_d_l --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T17:17:12.525+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:17:12.522+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 210, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpvh3k_d_l', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
17:17:07  Running with dbt=1.8.7
17:17:09  Registered adapter: bigquery=1.8.3
17:17:10  [WARNING]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
17:17:10  Encountered an error:
Parsing Error
  Invalid models config given in models/tests/schema.yml @ models: {'name': 'fct_trips', 'description': 'Fact Table of tripdata', 'columns': [{'name': 'trip_id', 'description': 'The primary key for this table', 'tests': ['unique']}, {'name': 'vendor_id', 'description': 'A code indicating the TPEP provider that provided the record', 'tests': ['not_null']}, {'name': 'pickup_time_id', 'description': 'id to get pickup time from dim_time', 'tests': ['not_null']}, {'name': 'dropoff_time_id', 'description': 'id to get dropoff time from dim_time', 'tests': ['unique']}, {'name': 'rate_code_id', 'description': 'The final rate code in effect at the end of the trip', 'tests': ['unique']}, {'name': 'pu_location_id', 'description': 'The pickup location', 'tests': ['not_null']}, {'name': 'do_location_id', 'description': 'The droppof location', 'tests': ['not_null']}, {'name': 'passenger_count', 'description': 'Customer count', 'tests': ['unique']}, {'name': 'trip_distance', 'description': 'trip distance', 'tests': ['not_null']}, {'name': 'fare_amount', 'description': 'The time-and-distance fare calculated by the meter.', 'tests': ['not_null']}, {'name': 'extra', 'description': 'Miscellaneous extras and surcharges. Currently, this only includes. the $0.50 and $1 rush hour and overnight charges', 'tests': ['not_null']}, {'name': 'mta_tax', 'description': '0.50 MTA tax that is automatically triggered based on the metered rate in use', 'tests': ['unique']}, {'name': 'tip_amount', 'description': 'Tip amount  This field is automatically populated for credit card tips.Cash tips are not included', 'tests': ['not_null']}, {'name': 'tolls_amount', 'description': 'Total amount of all tolls paid in trip', 'tests': ['not_null']}, {'name': 'improvement_surcharge', 'description': '0.30 improvement surcharge assessed trips at the flag drop. the improvement surcharge began being levied in 2015', 'tests': ['not_null']}, {'name': 'total_amount', 'description': 'The total amount charged to passengers. Does not include cash tips.', 'tests': ['not_null']}, {'name': 'payment_type', 'description': 'A numeric code signifying how the passenger paid for the trip', 'tests': ['not_null']}, {'name': 'trip_type', 'description': 'Year of pickup', 'tests': ['not_null']}, {'name': 'congestion_surcharge', 'description': 'An additional charge for trips taken during high traffic congestion times', 'tests': [None]}], 'original_file_path': 'models/tests/schema.yml', 'yaml_key': 'models', 'package_name': 'nyc_taxi'} - at path ['columns'][18]['tests'][0]: None is not valid under any of the given schemas
[2024-11-21T17:17:12.526+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:17:12.542+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 12.500 seconds
[2024-11-21T17:17:43.480+0000] {processor.py:161} INFO - Started process (PID=2696) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:17:43.481+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T17:17:43.483+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:17:43.482+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:17:43.505+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:17:43.505+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T17:17:44.256+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:17:44.255+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 0.7400417449998713
[2024-11-21T17:17:44.256+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:17:44.256+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T17:17:44.256+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:17:44.256+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T17:17:44.260+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:17:44.260+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T17:17:44.266+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:17:44.266+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T17:17:44.272+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:17:44.272+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp26ifohkc --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T17:17:50.491+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:17:50.491+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp26ifohkc --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T17:17:56.775+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:17:56.771+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 210, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmp26ifohkc', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
17:17:52  Running with dbt=1.8.7
17:17:54  Registered adapter: bigquery=1.8.3
17:17:55  [WARNING]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
17:17:55  Encountered an error:
Parsing Error
  Invalid models config given in models/tests/schema.yml @ models: {'name': 'fct_trips', 'description': 'Fact Table of tripdata', 'columns': [{'name': 'trip_id', 'description': 'The primary key for this table', 'tests': ['unique']}, {'name': 'vendor_id', 'description': 'A code indicating the TPEP provider that provided the record', 'tests': ['not_null']}, {'name': 'pickup_time_id', 'description': 'id to get pickup time from dim_time', 'tests': ['not_null']}, {'name': 'dropoff_time_id', 'description': 'id to get dropoff time from dim_time', 'tests': ['unique']}, {'name': 'rate_code_id', 'description': 'The final rate code in effect at the end of the trip', 'tests': ['unique']}, {'name': 'pu_location_id', 'description': 'The pickup location', 'tests': ['not_null']}, {'name': 'do_location_id', 'description': 'The droppof location', 'tests': ['not_null']}, {'name': 'passenger_count', 'description': 'Customer count', 'tests': ['unique']}, {'name': 'trip_distance', 'description': 'trip distance', 'tests': ['not_null']}, {'name': 'fare_amount', 'description': 'The time-and-distance fare calculated by the meter.', 'tests': ['not_null']}, {'name': 'extra', 'description': 'Miscellaneous extras and surcharges. Currently, this only includes. the $0.50 and $1 rush hour and overnight charges', 'tests': ['not_null']}, {'name': 'mta_tax', 'description': '0.50 MTA tax that is automatically triggered based on the metered rate in use', 'tests': ['unique']}, {'name': 'tip_amount', 'description': 'Tip amount  This field is automatically populated for credit card tips.Cash tips are not included', 'tests': ['not_null']}, {'name': 'tolls_amount', 'description': 'Total amount of all tolls paid in trip', 'tests': ['not_null']}, {'name': 'improvement_surcharge', 'description': '0.30 improvement surcharge assessed trips at the flag drop. the improvement surcharge began being levied in 2015', 'tests': ['not_null']}, {'name': 'total_amount', 'description': 'The total amount charged to passengers. Does not include cash tips.', 'tests': ['not_null']}, {'name': 'payment_type', 'description': 'A numeric code signifying how the passenger paid for the trip', 'tests': ['not_null']}, {'name': 'trip_type', 'description': 'Year of pickup', 'tests': ['not_null']}, {'name': 'congestion_surcharge', 'description': 'An additional charge for trips taken during high traffic congestion times', 'tests': [None]}], 'original_file_path': 'models/tests/schema.yml', 'yaml_key': 'models', 'package_name': 'nyc_taxi'} - at path ['columns'][18]['tests'][0]: None is not valid under any of the given schemas
[2024-11-21T17:17:56.776+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:17:56.792+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 13.318 seconds
[2024-11-21T17:18:26.843+0000] {processor.py:161} INFO - Started process (PID=2747) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:18:26.844+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T17:18:26.845+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:18:26.845+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:18:26.868+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:18:26.868+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T17:18:27.620+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:18:27.620+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 0.7410949820000496
[2024-11-21T17:18:27.620+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:18:27.620+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T17:18:27.621+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:18:27.620+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T17:18:27.624+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:18:27.624+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T17:18:27.630+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:18:27.630+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T17:18:27.636+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:18:27.636+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpmqe9uyd0 --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T17:18:32.601+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:18:32.600+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpmqe9uyd0 --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T17:18:39.180+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:18:39.176+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 210, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpmqe9uyd0', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
17:18:34  Running with dbt=1.8.7
17:18:36  Registered adapter: bigquery=1.8.3
17:18:37  [WARNING]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
17:18:37  Encountered an error:
Parsing Error
  Invalid models config given in models/tests/schema.yml @ models: {'name': 'fct_trips', 'description': 'Fact Table of tripdata', 'columns': [{'name': 'trip_id', 'description': 'The primary key for this table', 'tests': ['unique']}, {'name': 'vendor_id', 'description': 'A code indicating the TPEP provider that provided the record', 'tests': ['not_null']}, {'name': 'pickup_time_id', 'description': 'id to get pickup time from dim_time', 'tests': ['not_null']}, {'name': 'dropoff_time_id', 'description': 'id to get dropoff time from dim_time', 'tests': ['unique']}, {'name': 'rate_code_id', 'description': 'The final rate code in effect at the end of the trip', 'tests': ['unique']}, {'name': 'pu_location_id', 'description': 'The pickup location', 'tests': ['not_null']}, {'name': 'do_location_id', 'description': 'The droppof location', 'tests': ['not_null']}, {'name': 'passenger_count', 'description': 'Customer count', 'tests': ['unique']}, {'name': 'trip_distance', 'description': 'trip distance', 'tests': ['not_null']}, {'name': 'fare_amount', 'description': 'The time-and-distance fare calculated by the meter.', 'tests': ['not_null']}, {'name': 'extra', 'description': 'Miscellaneous extras and surcharges. Currently, this only includes. the $0.50 and $1 rush hour and overnight charges', 'tests': ['not_null']}, {'name': 'mta_tax', 'description': '0.50 MTA tax that is automatically triggered based on the metered rate in use', 'tests': ['unique']}, {'name': 'tip_amount', 'description': 'Tip amount  This field is automatically populated for credit card tips.Cash tips are not included', 'tests': ['not_null']}, {'name': 'tolls_amount', 'description': 'Total amount of all tolls paid in trip', 'tests': ['not_null']}, {'name': 'improvement_surcharge', 'description': '0.30 improvement surcharge assessed trips at the flag drop. the improvement surcharge began being levied in 2015', 'tests': ['not_null']}, {'name': 'total_amount', 'description': 'The total amount charged to passengers. Does not include cash tips.', 'tests': ['not_null']}, {'name': 'payment_type', 'description': 'A numeric code signifying how the passenger paid for the trip', 'tests': ['not_null']}, {'name': 'trip_type', 'description': 'Year of pickup', 'tests': ['not_null']}, {'name': 'congestion_surcharge', 'description': 'An additional charge for trips taken during high traffic congestion times', 'tests': [None]}], 'original_file_path': 'models/tests/schema.yml', 'yaml_key': 'models', 'package_name': 'nyc_taxi'} - at path ['columns'][18]['tests'][0]: None is not valid under any of the given schemas
[2024-11-21T17:18:39.181+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:18:39.190+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 12.352 seconds
[2024-11-21T17:19:09.277+0000] {processor.py:161} INFO - Started process (PID=2793) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:19:09.277+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T17:19:09.279+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:19:09.279+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:19:09.303+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:19:09.303+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T17:19:10.097+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:19:10.097+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 0.7818606409996391
[2024-11-21T17:19:10.098+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:19:10.098+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T17:19:10.098+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:19:10.098+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T17:19:10.104+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:19:10.104+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T17:19:10.111+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:19:10.111+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T17:19:10.118+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:19:10.117+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpn814x270 --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T17:19:15.078+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:19:15.078+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpn814x270 --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T17:19:21.473+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:19:21.470+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 210, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpn814x270', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
17:19:17  Running with dbt=1.8.7
17:19:18  Registered adapter: bigquery=1.8.3
17:19:19  [WARNING]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
17:19:19  Encountered an error:
Parsing Error
  Invalid models config given in models/tests/schema.yml @ models: {'name': 'fct_trips', 'description': 'Fact Table of tripdata', 'columns': [{'name': 'trip_id', 'description': 'The primary key for this table', 'tests': ['unique']}, {'name': 'vendor_id', 'description': 'A code indicating the TPEP provider that provided the record', 'tests': ['not_null']}, {'name': 'pickup_time_id', 'description': 'id to get pickup time from dim_time', 'tests': ['not_null']}, {'name': 'dropoff_time_id', 'description': 'id to get dropoff time from dim_time', 'tests': ['unique']}, {'name': 'rate_code_id', 'description': 'The final rate code in effect at the end of the trip', 'tests': ['unique']}, {'name': 'pu_location_id', 'description': 'The pickup location', 'tests': ['not_null']}, {'name': 'do_location_id', 'description': 'The droppof location', 'tests': ['not_null']}, {'name': 'passenger_count', 'description': 'Customer count', 'tests': ['unique']}, {'name': 'trip_distance', 'description': 'trip distance', 'tests': ['not_null']}, {'name': 'fare_amount', 'description': 'The time-and-distance fare calculated by the meter.', 'tests': ['not_null']}, {'name': 'extra', 'description': 'Miscellaneous extras and surcharges. Currently, this only includes. the $0.50 and $1 rush hour and overnight charges', 'tests': ['not_null']}, {'name': 'mta_tax', 'description': '0.50 MTA tax that is automatically triggered based on the metered rate in use', 'tests': ['unique']}, {'name': 'tip_amount', 'description': 'Tip amount  This field is automatically populated for credit card tips.Cash tips are not included', 'tests': ['not_null']}, {'name': 'tolls_amount', 'description': 'Total amount of all tolls paid in trip', 'tests': ['not_null']}, {'name': 'improvement_surcharge', 'description': '0.30 improvement surcharge assessed trips at the flag drop. the improvement surcharge began being levied in 2015', 'tests': ['not_null']}, {'name': 'total_amount', 'description': 'The total amount charged to passengers. Does not include cash tips.', 'tests': ['not_null']}, {'name': 'payment_type', 'description': 'A numeric code signifying how the passenger paid for the trip', 'tests': ['not_null']}, {'name': 'trip_type', 'description': 'Year of pickup', 'tests': ['not_null']}, {'name': 'congestion_surcharge', 'description': 'An additional charge for trips taken during high traffic congestion times', 'tests': [None]}], 'original_file_path': 'models/tests/schema.yml', 'yaml_key': 'models', 'package_name': 'nyc_taxi'} - at path ['columns'][18]['tests'][0]: None is not valid under any of the given schemas
[2024-11-21T17:19:21.474+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:19:21.483+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 12.213 seconds
[2024-11-21T17:19:51.763+0000] {processor.py:161} INFO - Started process (PID=2838) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:19:51.764+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T17:19:51.766+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:19:51.766+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:19:51.794+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:19:51.794+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T17:19:52.612+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:19:52.611+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 0.8062426950000372
[2024-11-21T17:19:52.612+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:19:52.612+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T17:19:52.613+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:19:52.613+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T17:19:52.617+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:19:52.617+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T17:19:52.625+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:19:52.624+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T17:19:52.630+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:19:52.630+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpnfvzw11y --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T17:19:56.344+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:19:56.343+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpnfvzw11y --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T17:20:02.668+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:20:02.664+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 210, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpnfvzw11y', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
17:19:58  Running with dbt=1.8.7
17:20:00  Registered adapter: bigquery=1.8.3
17:20:00  [WARNING]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
17:20:00  Encountered an error:
Parsing Error
  Invalid models config given in models/tests/schema.yml @ models: {'name': 'fct_trips', 'description': 'Fact Table of tripdata', 'columns': [{'name': 'trip_id', 'description': 'The primary key for this table', 'tests': ['unique']}, {'name': 'vendor_id', 'description': 'A code indicating the TPEP provider that provided the record', 'tests': ['not_null']}, {'name': 'pickup_time_id', 'description': 'id to get pickup time from dim_time', 'tests': ['not_null']}, {'name': 'dropoff_time_id', 'description': 'id to get dropoff time from dim_time', 'tests': ['unique']}, {'name': 'rate_code_id', 'description': 'The final rate code in effect at the end of the trip', 'tests': ['unique']}, {'name': 'pu_location_id', 'description': 'The pickup location', 'tests': ['not_null']}, {'name': 'do_location_id', 'description': 'The droppof location', 'tests': ['not_null']}, {'name': 'passenger_count', 'description': 'Customer count', 'tests': ['unique']}, {'name': 'trip_distance', 'description': 'trip distance', 'tests': ['not_null']}, {'name': 'fare_amount', 'description': 'The time-and-distance fare calculated by the meter.', 'tests': ['not_null']}, {'name': 'extra', 'description': 'Miscellaneous extras and surcharges. Currently, this only includes. the $0.50 and $1 rush hour and overnight charges', 'tests': ['not_null']}, {'name': 'mta_tax', 'description': '0.50 MTA tax that is automatically triggered based on the metered rate in use', 'tests': ['unique']}, {'name': 'tip_amount', 'description': 'Tip amount  This field is automatically populated for credit card tips.Cash tips are not included', 'tests': ['not_null']}, {'name': 'tolls_amount', 'description': 'Total amount of all tolls paid in trip', 'tests': ['not_null']}, {'name': 'improvement_surcharge', 'description': '0.30 improvement surcharge assessed trips at the flag drop. the improvement surcharge began being levied in 2015', 'tests': ['not_null']}, {'name': 'total_amount', 'description': 'The total amount charged to passengers. Does not include cash tips.', 'tests': ['not_null']}, {'name': 'payment_type', 'description': 'A numeric code signifying how the passenger paid for the trip', 'tests': ['not_null']}, {'name': 'trip_type', 'description': 'Year of pickup', 'tests': ['not_null']}, {'name': 'congestion_surcharge', 'description': 'An additional charge for trips taken during high traffic congestion times', 'tests': [None]}], 'original_file_path': 'models/tests/schema.yml', 'yaml_key': 'models', 'package_name': 'nyc_taxi'} - at path ['columns'][18]['tests'][0]: None is not valid under any of the given schemas
[2024-11-21T17:20:02.669+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:20:02.686+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 11.924 seconds
[2024-11-21T17:20:33.235+0000] {processor.py:161} INFO - Started process (PID=2889) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:20:33.236+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T17:20:33.237+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:20:33.237+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:20:33.260+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:20:33.260+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T17:20:33.977+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:20:33.977+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 0.7064436000000569
[2024-11-21T17:20:33.978+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:20:33.978+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T17:20:33.978+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:20:33.978+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T17:20:33.982+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:20:33.982+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T17:20:33.988+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:20:33.988+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T17:20:33.994+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:20:33.994+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpe0dwq0tk --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T17:20:38.976+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:20:38.975+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpe0dwq0tk --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T17:20:45.332+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:20:45.329+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 210, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpe0dwq0tk', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
17:20:41  Running with dbt=1.8.7
17:20:42  Registered adapter: bigquery=1.8.3
17:20:43  [WARNING]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
17:20:43  Encountered an error:
Parsing Error
  Invalid models config given in models/tests/schema.yml @ models: {'name': 'fct_trips', 'description': 'Fact Table of tripdata', 'columns': [{'name': 'trip_id', 'description': 'The primary key for this table', 'tests': ['unique']}, {'name': 'vendor_id', 'description': 'A code indicating the TPEP provider that provided the record', 'tests': ['not_null']}, {'name': 'pickup_time_id', 'description': 'id to get pickup time from dim_time', 'tests': ['not_null']}, {'name': 'dropoff_time_id', 'description': 'id to get dropoff time from dim_time', 'tests': ['unique']}, {'name': 'rate_code_id', 'description': 'The final rate code in effect at the end of the trip', 'tests': ['unique']}, {'name': 'pu_location_id', 'description': 'The pickup location', 'tests': ['not_null']}, {'name': 'do_location_id', 'description': 'The droppof location', 'tests': ['not_null']}, {'name': 'passenger_count', 'description': 'Customer count', 'tests': ['unique']}, {'name': 'trip_distance', 'description': 'trip distance', 'tests': ['not_null']}, {'name': 'fare_amount', 'description': 'The time-and-distance fare calculated by the meter.', 'tests': ['not_null']}, {'name': 'extra', 'description': 'Miscellaneous extras and surcharges. Currently, this only includes. the $0.50 and $1 rush hour and overnight charges', 'tests': ['not_null']}, {'name': 'mta_tax', 'description': '0.50 MTA tax that is automatically triggered based on the metered rate in use', 'tests': ['unique']}, {'name': 'tip_amount', 'description': 'Tip amount  This field is automatically populated for credit card tips.Cash tips are not included', 'tests': ['not_null']}, {'name': 'tolls_amount', 'description': 'Total amount of all tolls paid in trip', 'tests': ['not_null']}, {'name': 'improvement_surcharge', 'description': '0.30 improvement surcharge assessed trips at the flag drop. the improvement surcharge began being levied in 2015', 'tests': ['not_null']}, {'name': 'total_amount', 'description': 'The total amount charged to passengers. Does not include cash tips.', 'tests': ['not_null']}, {'name': 'payment_type', 'description': 'A numeric code signifying how the passenger paid for the trip', 'tests': ['not_null']}, {'name': 'trip_type', 'description': 'Year of pickup', 'tests': ['not_null']}, {'name': 'congestion_surcharge', 'description': 'An additional charge for trips taken during high traffic congestion times', 'tests': [None]}], 'original_file_path': 'models/tests/schema.yml', 'yaml_key': 'models', 'package_name': 'nyc_taxi'} - at path ['columns'][18]['tests'][0]: None is not valid under any of the given schemas
[2024-11-21T17:20:45.333+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:20:45.343+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 12.114 seconds
[2024-11-21T17:21:15.585+0000] {processor.py:161} INFO - Started process (PID=2935) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:21:15.586+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T17:21:15.588+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:21:15.588+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:21:15.611+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:21:15.610+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T17:21:16.431+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:21:16.430+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 0.8093519959998048
[2024-11-21T17:21:16.431+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:21:16.431+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T17:21:16.431+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:21:16.431+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T17:21:16.435+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:21:16.435+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T17:21:16.441+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:21:16.441+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T17:21:16.447+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:21:16.447+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpgll8th6t --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T17:21:20.200+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:21:20.199+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpgll8th6t --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T17:21:26.520+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:21:26.516+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 210, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpgll8th6t', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
17:21:22  Running with dbt=1.8.7
17:21:23  Registered adapter: bigquery=1.8.3
17:21:24  [WARNING]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
17:21:24  Encountered an error:
Parsing Error
  Invalid models config given in models/tests/schema.yml @ models: {'name': 'fct_trips', 'description': 'Fact Table of tripdata', 'columns': [{'name': 'trip_id', 'description': 'The primary key for this table', 'tests': ['unique']}, {'name': 'vendor_id', 'description': 'A code indicating the TPEP provider that provided the record', 'tests': ['not_null']}, {'name': 'pickup_time_id', 'description': 'id to get pickup time from dim_time', 'tests': ['not_null']}, {'name': 'dropoff_time_id', 'description': 'id to get dropoff time from dim_time', 'tests': ['unique']}, {'name': 'rate_code_id', 'description': 'The final rate code in effect at the end of the trip', 'tests': ['unique']}, {'name': 'pu_location_id', 'description': 'The pickup location', 'tests': ['not_null']}, {'name': 'do_location_id', 'description': 'The droppof location', 'tests': ['not_null']}, {'name': 'passenger_count', 'description': 'Customer count', 'tests': ['unique']}, {'name': 'trip_distance', 'description': 'trip distance', 'tests': ['not_null']}, {'name': 'fare_amount', 'description': 'The time-and-distance fare calculated by the meter.', 'tests': ['not_null']}, {'name': 'extra', 'description': 'Miscellaneous extras and surcharges. Currently, this only includes. the $0.50 and $1 rush hour and overnight charges', 'tests': ['not_null']}, {'name': 'mta_tax', 'description': '0.50 MTA tax that is automatically triggered based on the metered rate in use', 'tests': ['unique']}, {'name': 'tip_amount', 'description': 'Tip amount  This field is automatically populated for credit card tips.Cash tips are not included', 'tests': ['not_null']}, {'name': 'tolls_amount', 'description': 'Total amount of all tolls paid in trip', 'tests': ['not_null']}, {'name': 'improvement_surcharge', 'description': '0.30 improvement surcharge assessed trips at the flag drop. the improvement surcharge began being levied in 2015', 'tests': ['not_null']}, {'name': 'total_amount', 'description': 'The total amount charged to passengers. Does not include cash tips.', 'tests': ['not_null']}, {'name': 'payment_type', 'description': 'A numeric code signifying how the passenger paid for the trip', 'tests': ['not_null']}, {'name': 'trip_type', 'description': 'Year of pickup', 'tests': ['not_null']}, {'name': 'congestion_surcharge', 'description': 'An additional charge for trips taken during high traffic congestion times', 'tests': [None]}], 'original_file_path': 'models/tests/schema.yml', 'yaml_key': 'models', 'package_name': 'nyc_taxi'} - at path ['columns'][18]['tests'][0]: None is not valid under any of the given schemas
[2024-11-21T17:21:26.521+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:21:26.532+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 12.007 seconds
[2024-11-21T17:21:56.963+0000] {processor.py:161} INFO - Started process (PID=2986) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:21:56.964+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T17:21:56.965+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:21:56.965+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:21:56.987+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:21:56.987+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T17:21:57.752+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:21:57.752+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 0.7534553809996396
[2024-11-21T17:21:57.753+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:21:57.753+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T17:21:57.753+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:21:57.753+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T17:21:57.757+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:21:57.757+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T17:21:57.763+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:21:57.762+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T17:21:57.768+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:21:57.768+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpdas031r5 --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T17:22:02.839+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:22:02.838+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpdas031r5 --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T17:22:09.077+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:22:09.073+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 210, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpdas031r5', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
17:22:05  Running with dbt=1.8.7
17:22:06  Registered adapter: bigquery=1.8.3
17:22:07  [WARNING]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
17:22:07  Encountered an error:
Parsing Error
  Invalid models config given in models/tests/schema.yml @ models: {'name': 'fct_trips', 'description': 'Fact Table of tripdata', 'columns': [{'name': 'trip_id', 'description': 'The primary key for this table', 'tests': ['unique']}, {'name': 'vendor_id', 'description': 'A code indicating the TPEP provider that provided the record', 'tests': ['not_null']}, {'name': 'pickup_time_id', 'description': 'id to get pickup time from dim_time', 'tests': ['not_null']}, {'name': 'dropoff_time_id', 'description': 'id to get dropoff time from dim_time', 'tests': ['unique']}, {'name': 'rate_code_id', 'description': 'The final rate code in effect at the end of the trip', 'tests': ['unique']}, {'name': 'pu_location_id', 'description': 'The pickup location', 'tests': ['not_null']}, {'name': 'do_location_id', 'description': 'The droppof location', 'tests': ['not_null']}, {'name': 'passenger_count', 'description': 'Customer count', 'tests': ['unique']}, {'name': 'trip_distance', 'description': 'trip distance', 'tests': ['not_null']}, {'name': 'fare_amount', 'description': 'The time-and-distance fare calculated by the meter.', 'tests': ['not_null']}, {'name': 'extra', 'description': 'Miscellaneous extras and surcharges. Currently, this only includes. the $0.50 and $1 rush hour and overnight charges', 'tests': ['not_null']}, {'name': 'mta_tax', 'description': '0.50 MTA tax that is automatically triggered based on the metered rate in use', 'tests': ['unique']}, {'name': 'tip_amount', 'description': 'Tip amount  This field is automatically populated for credit card tips.Cash tips are not included', 'tests': ['not_null']}, {'name': 'tolls_amount', 'description': 'Total amount of all tolls paid in trip', 'tests': ['not_null']}, {'name': 'improvement_surcharge', 'description': '0.30 improvement surcharge assessed trips at the flag drop. the improvement surcharge began being levied in 2015', 'tests': ['not_null']}, {'name': 'total_amount', 'description': 'The total amount charged to passengers. Does not include cash tips.', 'tests': ['not_null']}, {'name': 'payment_type', 'description': 'A numeric code signifying how the passenger paid for the trip', 'tests': ['not_null']}, {'name': 'trip_type', 'description': 'Year of pickup', 'tests': ['not_null']}, {'name': 'congestion_surcharge', 'description': 'An additional charge for trips taken during high traffic congestion times', 'tests': [None]}], 'original_file_path': 'models/tests/schema.yml', 'yaml_key': 'models', 'package_name': 'nyc_taxi'} - at path ['columns'][18]['tests'][0]: None is not valid under any of the given schemas
[2024-11-21T17:22:09.077+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:22:09.087+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 12.128 seconds
[2024-11-21T17:22:39.318+0000] {processor.py:161} INFO - Started process (PID=3032) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:22:39.319+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T17:22:39.320+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:22:39.320+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:22:39.345+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:22:39.344+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T17:22:40.087+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:22:40.087+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 0.7314544989999376
[2024-11-21T17:22:40.088+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:22:40.088+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T17:22:40.089+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:22:40.089+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T17:22:40.094+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:22:40.093+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T17:22:40.101+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:22:40.101+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T17:22:40.109+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:22:40.109+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp6qus8_so --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T17:22:45.395+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:22:45.394+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp6qus8_so --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T17:22:50.628+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:22:50.625+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 210, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmp6qus8_so', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
17:22:47  Running with dbt=1.8.7
17:22:48  Registered adapter: bigquery=1.8.3
17:22:48  [WARNING]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
17:22:48  Encountered an error:
Parsing Error
  Invalid models config given in models/tests/schema.yml @ models: {'name': 'fct_trips', 'description': 'Fact Table of tripdata', 'columns': [{'name': 'trip_id', 'description': 'The primary key for this table', 'tests': ['unique']}, {'name': 'vendor_id', 'description': 'A code indicating the TPEP provider that provided the record', 'tests': ['not_null']}, {'name': 'pickup_time_id', 'description': 'id to get pickup time from dim_time', 'tests': ['not_null']}, {'name': 'dropoff_time_id', 'description': 'id to get dropoff time from dim_time', 'tests': ['unique']}, {'name': 'rate_code_id', 'description': 'The final rate code in effect at the end of the trip', 'tests': ['unique']}, {'name': 'pu_location_id', 'description': 'The pickup location', 'tests': ['not_null']}, {'name': 'do_location_id', 'description': 'The droppof location', 'tests': ['not_null']}, {'name': 'passenger_count', 'description': 'Customer count', 'tests': ['unique']}, {'name': 'trip_distance', 'description': 'trip distance', 'tests': ['not_null']}, {'name': 'fare_amount', 'description': 'The time-and-distance fare calculated by the meter.', 'tests': ['not_null']}, {'name': 'extra', 'description': 'Miscellaneous extras and surcharges. Currently, this only includes. the $0.50 and $1 rush hour and overnight charges', 'tests': ['not_null']}, {'name': 'mta_tax', 'description': '0.50 MTA tax that is automatically triggered based on the metered rate in use', 'tests': ['unique']}, {'name': 'tip_amount', 'description': 'Tip amount  This field is automatically populated for credit card tips.Cash tips are not included', 'tests': ['not_null']}, {'name': 'tolls_amount', 'description': 'Total amount of all tolls paid in trip', 'tests': ['not_null']}, {'name': 'improvement_surcharge', 'description': '0.30 improvement surcharge assessed trips at the flag drop. the improvement surcharge began being levied in 2015', 'tests': ['not_null']}, {'name': 'total_amount', 'description': 'The total amount charged to passengers. Does not include cash tips.', 'tests': ['not_null']}, {'name': 'payment_type', 'description': 'A numeric code signifying how the passenger paid for the trip', 'tests': ['not_null']}, {'name': 'trip_type', 'description': 'Year of pickup', 'tests': ['not_null']}, {'name': 'congestion_surcharge', 'description': 'An additional charge for trips taken during high traffic congestion times', 'tests': [None]}], 'original_file_path': 'models/tests/schema.yml', 'yaml_key': 'models', 'package_name': 'nyc_taxi'} - at path ['columns'][18]['tests'][0]: None is not valid under any of the given schemas
[2024-11-21T17:22:50.629+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:22:50.638+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 12.332 seconds
[2024-11-21T17:23:20.741+0000] {processor.py:161} INFO - Started process (PID=3083) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:23:20.742+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T17:23:20.743+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:23:20.743+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:23:20.765+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:23:20.765+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T17:23:21.502+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:23:21.502+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 0.7268009949998486
[2024-11-21T17:23:21.502+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:23:21.502+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T17:23:21.503+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:23:21.503+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T17:23:21.507+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:23:21.507+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T17:23:21.513+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:23:21.513+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T17:23:21.519+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:23:21.519+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpu28puol6 --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T17:23:28.837+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:23:28.836+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpu28puol6 --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T17:23:35.583+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:23:35.579+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 210, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpu28puol6', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
17:23:31  Running with dbt=1.8.7
17:23:32  Registered adapter: bigquery=1.8.3
17:23:33  [WARNING]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
17:23:33  Encountered an error:
Parsing Error
  Invalid models config given in models/tests/schema.yml @ models: {'name': 'fct_trips', 'description': 'Fact Table of tripdata', 'columns': [{'name': 'trip_id', 'description': 'The primary key for this table', 'tests': ['unique']}, {'name': 'vendor_id', 'description': 'A code indicating the TPEP provider that provided the record', 'tests': ['not_null']}, {'name': 'pickup_time_id', 'description': 'id to get pickup time from dim_time', 'tests': ['not_null']}, {'name': 'dropoff_time_id', 'description': 'id to get dropoff time from dim_time', 'tests': ['unique']}, {'name': 'rate_code_id', 'description': 'The final rate code in effect at the end of the trip', 'tests': ['unique']}, {'name': 'pu_location_id', 'description': 'The pickup location', 'tests': ['not_null']}, {'name': 'do_location_id', 'description': 'The droppof location', 'tests': ['not_null']}, {'name': 'passenger_count', 'description': 'Customer count', 'tests': ['unique']}, {'name': 'trip_distance', 'description': 'trip distance', 'tests': ['not_null']}, {'name': 'fare_amount', 'description': 'The time-and-distance fare calculated by the meter.', 'tests': ['not_null']}, {'name': 'extra', 'description': 'Miscellaneous extras and surcharges. Currently, this only includes. the $0.50 and $1 rush hour and overnight charges', 'tests': ['not_null']}, {'name': 'mta_tax', 'description': '0.50 MTA tax that is automatically triggered based on the metered rate in use', 'tests': ['unique']}, {'name': 'tip_amount', 'description': 'Tip amount  This field is automatically populated for credit card tips.Cash tips are not included', 'tests': ['not_null']}, {'name': 'tolls_amount', 'description': 'Total amount of all tolls paid in trip', 'tests': ['not_null']}, {'name': 'improvement_surcharge', 'description': '0.30 improvement surcharge assessed trips at the flag drop. the improvement surcharge began being levied in 2015', 'tests': ['not_null']}, {'name': 'total_amount', 'description': 'The total amount charged to passengers. Does not include cash tips.', 'tests': ['not_null']}, {'name': 'payment_type', 'description': 'A numeric code signifying how the passenger paid for the trip', 'tests': ['not_null']}, {'name': 'trip_type', 'description': 'Year of pickup', 'tests': ['not_null']}, {'name': 'congestion_surcharge', 'description': 'An additional charge for trips taken during high traffic congestion times', 'tests': [None]}], 'original_file_path': 'models/tests/schema.yml', 'yaml_key': 'models', 'package_name': 'nyc_taxi'} - at path ['columns'][18]['tests'][0]: None is not valid under any of the given schemas
[2024-11-21T17:23:35.584+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:23:35.594+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 14.859 seconds
[2024-11-21T17:24:06.186+0000] {processor.py:161} INFO - Started process (PID=3128) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:24:06.186+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T17:24:06.188+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:24:06.188+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:24:06.211+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:24:06.211+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T17:24:07.032+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:24:07.031+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 0.808310363000146
[2024-11-21T17:24:07.032+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:24:07.032+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T17:24:07.033+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:24:07.032+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T17:24:07.038+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:24:07.038+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T17:24:07.045+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:24:07.045+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T17:24:07.052+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:24:07.052+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpvz08pngl --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T17:24:11.903+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:24:11.903+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpvz08pngl --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T17:24:17.442+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:24:17.439+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 210, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpvz08pngl', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
17:24:14  Running with dbt=1.8.7
17:24:14  Registered adapter: bigquery=1.8.3
17:24:15  [WARNING]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
17:24:15  Encountered an error:
Parsing Error
  Invalid models config given in models/tests/schema.yml @ models: {'name': 'fct_trips', 'description': 'Fact Table of tripdata', 'columns': [{'name': 'trip_id', 'description': 'The primary key for this table', 'tests': ['unique']}, {'name': 'vendor_id', 'description': 'A code indicating the TPEP provider that provided the record', 'tests': ['not_null']}, {'name': 'pickup_time_id', 'description': 'id to get pickup time from dim_time', 'tests': ['not_null']}, {'name': 'dropoff_time_id', 'description': 'id to get dropoff time from dim_time', 'tests': ['unique']}, {'name': 'rate_code_id', 'description': 'The final rate code in effect at the end of the trip', 'tests': ['unique']}, {'name': 'pu_location_id', 'description': 'The pickup location', 'tests': ['not_null']}, {'name': 'do_location_id', 'description': 'The droppof location', 'tests': ['not_null']}, {'name': 'passenger_count', 'description': 'Customer count', 'tests': ['unique']}, {'name': 'trip_distance', 'description': 'trip distance', 'tests': ['not_null']}, {'name': 'fare_amount', 'description': 'The time-and-distance fare calculated by the meter.', 'tests': ['not_null']}, {'name': 'extra', 'description': 'Miscellaneous extras and surcharges. Currently, this only includes. the $0.50 and $1 rush hour and overnight charges', 'tests': ['not_null']}, {'name': 'mta_tax', 'description': '0.50 MTA tax that is automatically triggered based on the metered rate in use', 'tests': ['unique']}, {'name': 'tip_amount', 'description': 'Tip amount  This field is automatically populated for credit card tips.Cash tips are not included', 'tests': ['not_null']}, {'name': 'tolls_amount', 'description': 'Total amount of all tolls paid in trip', 'tests': ['not_null']}, {'name': 'improvement_surcharge', 'description': '0.30 improvement surcharge assessed trips at the flag drop. the improvement surcharge began being levied in 2015', 'tests': ['not_null']}, {'name': 'total_amount', 'description': 'The total amount charged to passengers. Does not include cash tips.', 'tests': ['not_null']}, {'name': 'payment_type', 'description': 'A numeric code signifying how the passenger paid for the trip', 'tests': ['not_null']}, {'name': 'trip_type', 'description': 'Year of pickup', 'tests': ['not_null']}, {'name': 'congestion_surcharge', 'description': 'An additional charge for trips taken during high traffic congestion times', 'tests': [None]}], 'original_file_path': 'models/tests/schema.yml', 'yaml_key': 'models', 'package_name': 'nyc_taxi'} - at path ['columns'][18]['tests'][0]: None is not valid under any of the given schemas
[2024-11-21T17:24:17.443+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:24:17.458+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 12.302 seconds
[2024-11-21T17:24:47.665+0000] {processor.py:161} INFO - Started process (PID=3180) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:24:47.666+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T17:24:47.667+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:24:47.667+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:24:47.692+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:24:47.691+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T17:24:48.507+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:24:48.507+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 0.8028334440000435
[2024-11-21T17:24:48.508+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:24:48.507+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T17:24:48.508+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:24:48.508+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T17:24:48.512+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:24:48.512+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T17:24:48.519+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:24:48.519+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T17:24:48.526+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:24:48.526+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpbein5z5w --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T17:24:53.551+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:24:53.550+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpbein5z5w --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T17:24:59.685+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:24:59.681+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 210, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpbein5z5w', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
17:24:55  Running with dbt=1.8.7
17:24:57  Registered adapter: bigquery=1.8.3
17:24:58  [WARNING]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
17:24:58  Encountered an error:
Parsing Error
  Invalid models config given in models/tests/schema.yml @ models: {'name': 'fct_trips', 'description': 'Fact Table of tripdata', 'columns': [{'name': 'trip_id', 'description': 'The primary key for this table', 'tests': ['unique']}, {'name': 'vendor_id', 'description': 'A code indicating the TPEP provider that provided the record', 'tests': ['not_null']}, {'name': 'pickup_time_id', 'description': 'id to get pickup time from dim_time', 'tests': ['not_null']}, {'name': 'dropoff_time_id', 'description': 'id to get dropoff time from dim_time', 'tests': ['unique']}, {'name': 'rate_code_id', 'description': 'The final rate code in effect at the end of the trip', 'tests': ['unique']}, {'name': 'pu_location_id', 'description': 'The pickup location', 'tests': ['not_null']}, {'name': 'do_location_id', 'description': 'The droppof location', 'tests': ['not_null']}, {'name': 'passenger_count', 'description': 'Customer count', 'tests': ['unique']}, {'name': 'trip_distance', 'description': 'trip distance', 'tests': ['not_null']}, {'name': 'fare_amount', 'description': 'The time-and-distance fare calculated by the meter.', 'tests': ['not_null']}, {'name': 'extra', 'description': 'Miscellaneous extras and surcharges. Currently, this only includes. the $0.50 and $1 rush hour and overnight charges', 'tests': ['not_null']}, {'name': 'mta_tax', 'description': '0.50 MTA tax that is automatically triggered based on the metered rate in use', 'tests': ['unique']}, {'name': 'tip_amount', 'description': 'Tip amount  This field is automatically populated for credit card tips.Cash tips are not included', 'tests': ['not_null']}, {'name': 'tolls_amount', 'description': 'Total amount of all tolls paid in trip', 'tests': ['not_null']}, {'name': 'improvement_surcharge', 'description': '0.30 improvement surcharge assessed trips at the flag drop. the improvement surcharge began being levied in 2015', 'tests': ['not_null']}, {'name': 'total_amount', 'description': 'The total amount charged to passengers. Does not include cash tips.', 'tests': ['not_null']}, {'name': 'payment_type', 'description': 'A numeric code signifying how the passenger paid for the trip', 'tests': ['not_null']}, {'name': 'trip_type', 'description': 'Year of pickup', 'tests': ['not_null']}, {'name': 'congestion_surcharge', 'description': 'An additional charge for trips taken during high traffic congestion times', 'tests': [None]}], 'original_file_path': 'models/tests/schema.yml', 'yaml_key': 'models', 'package_name': 'nyc_taxi'} - at path ['columns'][18]['tests'][0]: None is not valid under any of the given schemas
[2024-11-21T17:24:59.685+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:24:59.696+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 12.037 seconds
[2024-11-21T17:25:29.999+0000] {processor.py:161} INFO - Started process (PID=3225) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:25:30.000+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T17:25:30.002+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:25:30.001+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:25:30.024+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:25:30.024+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T17:25:30.945+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:25:30.945+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 0.9110058810001647
[2024-11-21T17:25:30.946+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:25:30.946+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T17:25:30.946+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:25:30.946+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T17:25:30.950+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:25:30.949+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T17:25:30.957+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:25:30.956+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T17:25:30.962+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:25:30.962+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp9h9dwl6e --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T17:25:35.729+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:25:35.729+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp9h9dwl6e --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T17:25:41.415+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:25:41.411+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 210, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmp9h9dwl6e', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
17:25:37  Running with dbt=1.8.7
17:25:39  Registered adapter: bigquery=1.8.3
17:25:40  [WARNING]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
17:25:40  Encountered an error:
Parsing Error
  Invalid models config given in models/tests/schema.yml @ models: {'name': 'fct_trips', 'description': 'Fact Table of tripdata', 'columns': [{'name': 'trip_id', 'description': 'The primary key for this table', 'tests': ['unique']}, {'name': 'vendor_id', 'description': 'A code indicating the TPEP provider that provided the record', 'tests': ['not_null']}, {'name': 'pickup_time_id', 'description': 'id to get pickup time from dim_time', 'tests': ['not_null']}, {'name': 'dropoff_time_id', 'description': 'id to get dropoff time from dim_time', 'tests': ['unique']}, {'name': 'rate_code_id', 'description': 'The final rate code in effect at the end of the trip', 'tests': ['unique']}, {'name': 'pu_location_id', 'description': 'The pickup location', 'tests': ['not_null']}, {'name': 'do_location_id', 'description': 'The droppof location', 'tests': ['not_null']}, {'name': 'passenger_count', 'description': 'Customer count', 'tests': ['unique']}, {'name': 'trip_distance', 'description': 'trip distance', 'tests': ['not_null']}, {'name': 'fare_amount', 'description': 'The time-and-distance fare calculated by the meter.', 'tests': ['not_null']}, {'name': 'extra', 'description': 'Miscellaneous extras and surcharges. Currently, this only includes. the $0.50 and $1 rush hour and overnight charges', 'tests': ['not_null']}, {'name': 'mta_tax', 'description': '0.50 MTA tax that is automatically triggered based on the metered rate in use', 'tests': ['unique']}, {'name': 'tip_amount', 'description': 'Tip amount  This field is automatically populated for credit card tips.Cash tips are not included', 'tests': ['not_null']}, {'name': 'tolls_amount', 'description': 'Total amount of all tolls paid in trip', 'tests': ['not_null']}, {'name': 'improvement_surcharge', 'description': '0.30 improvement surcharge assessed trips at the flag drop. the improvement surcharge began being levied in 2015', 'tests': ['not_null']}, {'name': 'total_amount', 'description': 'The total amount charged to passengers. Does not include cash tips.', 'tests': ['not_null']}, {'name': 'payment_type', 'description': 'A numeric code signifying how the passenger paid for the trip', 'tests': ['not_null']}, {'name': 'trip_type', 'description': 'Year of pickup', 'tests': ['not_null']}, {'name': 'congestion_surcharge', 'description': 'An additional charge for trips taken during high traffic congestion times', 'tests': [None]}], 'original_file_path': 'models/tests/schema.yml', 'yaml_key': 'models', 'package_name': 'nyc_taxi'} - at path ['columns'][18]['tests'][0]: None is not valid under any of the given schemas
[2024-11-21T17:25:41.415+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:25:41.426+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 12.486 seconds
[2024-11-21T17:26:11.473+0000] {processor.py:161} INFO - Started process (PID=3277) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:26:11.474+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T17:26:11.476+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:26:11.475+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:26:11.501+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:26:11.501+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T17:26:12.274+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:26:12.273+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 0.7619682260001355
[2024-11-21T17:26:12.274+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:26:12.274+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T17:26:12.275+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:26:12.275+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T17:26:12.279+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:26:12.279+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T17:26:12.285+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:26:12.285+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T17:26:12.291+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:26:12.291+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmppbbvz2kq --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T17:26:17.592+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:26:17.591+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmppbbvz2kq --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T17:26:24.035+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:26:24.032+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 210, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmppbbvz2kq', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
17:26:19  Running with dbt=1.8.7
17:26:21  Registered adapter: bigquery=1.8.3
17:26:22  [WARNING]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
17:26:22  Encountered an error:
Parsing Error
  Invalid models config given in models/tests/schema.yml @ models: {'name': 'fct_trips', 'description': 'Fact Table of tripdata', 'columns': [{'name': 'trip_id', 'description': 'The primary key for this table', 'tests': ['unique']}, {'name': 'vendor_id', 'description': 'A code indicating the TPEP provider that provided the record', 'tests': ['not_null']}, {'name': 'pickup_time_id', 'description': 'id to get pickup time from dim_time', 'tests': ['not_null']}, {'name': 'dropoff_time_id', 'description': 'id to get dropoff time from dim_time', 'tests': ['unique']}, {'name': 'rate_code_id', 'description': 'The final rate code in effect at the end of the trip', 'tests': ['unique']}, {'name': 'pu_location_id', 'description': 'The pickup location', 'tests': ['not_null']}, {'name': 'do_location_id', 'description': 'The droppof location', 'tests': ['not_null']}, {'name': 'passenger_count', 'description': 'Customer count', 'tests': ['unique']}, {'name': 'trip_distance', 'description': 'trip distance', 'tests': ['not_null']}, {'name': 'fare_amount', 'description': 'The time-and-distance fare calculated by the meter.', 'tests': ['not_null']}, {'name': 'extra', 'description': 'Miscellaneous extras and surcharges. Currently, this only includes. the $0.50 and $1 rush hour and overnight charges', 'tests': ['not_null']}, {'name': 'mta_tax', 'description': '0.50 MTA tax that is automatically triggered based on the metered rate in use', 'tests': ['unique']}, {'name': 'tip_amount', 'description': 'Tip amount  This field is automatically populated for credit card tips.Cash tips are not included', 'tests': ['not_null']}, {'name': 'tolls_amount', 'description': 'Total amount of all tolls paid in trip', 'tests': ['not_null']}, {'name': 'improvement_surcharge', 'description': '0.30 improvement surcharge assessed trips at the flag drop. the improvement surcharge began being levied in 2015', 'tests': ['not_null']}, {'name': 'total_amount', 'description': 'The total amount charged to passengers. Does not include cash tips.', 'tests': ['not_null']}, {'name': 'payment_type', 'description': 'A numeric code signifying how the passenger paid for the trip', 'tests': ['not_null']}, {'name': 'trip_type', 'description': 'Year of pickup', 'tests': ['not_null']}, {'name': 'congestion_surcharge', 'description': 'An additional charge for trips taken during high traffic congestion times', 'tests': [None]}], 'original_file_path': 'models/tests/schema.yml', 'yaml_key': 'models', 'package_name': 'nyc_taxi'} - at path ['columns'][18]['tests'][0]: None is not valid under any of the given schemas
[2024-11-21T17:26:24.036+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:26:24.046+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 12.578 seconds
[2024-11-21T17:26:54.762+0000] {processor.py:161} INFO - Started process (PID=3322) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:26:54.763+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T17:26:54.764+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:26:54.764+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:26:54.787+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:26:54.787+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T17:26:55.553+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:26:55.553+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 0.754654563999793
[2024-11-21T17:26:55.554+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:26:55.553+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T17:26:55.554+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:26:55.554+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T17:26:55.560+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:26:55.559+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T17:26:55.566+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:26:55.566+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T17:26:55.573+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:26:55.572+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpm2t7b9h6 --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T17:27:00.271+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:27:00.270+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpm2t7b9h6 --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T17:27:06.807+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:27:06.804+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 210, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpm2t7b9h6', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
17:27:02  Running with dbt=1.8.7
17:27:04  Registered adapter: bigquery=1.8.3
17:27:04  [WARNING]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
17:27:04  Encountered an error:
Parsing Error
  Invalid models config given in models/tests/schema.yml @ models: {'name': 'fct_trips', 'description': 'Fact Table of tripdata', 'columns': [{'name': 'trip_id', 'description': 'The primary key for this table', 'tests': ['unique']}, {'name': 'vendor_id', 'description': 'A code indicating the TPEP provider that provided the record', 'tests': ['not_null']}, {'name': 'pickup_time_id', 'description': 'id to get pickup time from dim_time', 'tests': ['not_null']}, {'name': 'dropoff_time_id', 'description': 'id to get dropoff time from dim_time', 'tests': ['unique']}, {'name': 'rate_code_id', 'description': 'The final rate code in effect at the end of the trip', 'tests': ['unique']}, {'name': 'pu_location_id', 'description': 'The pickup location', 'tests': ['not_null']}, {'name': 'do_location_id', 'description': 'The droppof location', 'tests': ['not_null']}, {'name': 'passenger_count', 'description': 'Customer count', 'tests': ['unique']}, {'name': 'trip_distance', 'description': 'trip distance', 'tests': ['not_null']}, {'name': 'fare_amount', 'description': 'The time-and-distance fare calculated by the meter.', 'tests': ['not_null']}, {'name': 'extra', 'description': 'Miscellaneous extras and surcharges. Currently, this only includes. the $0.50 and $1 rush hour and overnight charges', 'tests': ['not_null']}, {'name': 'mta_tax', 'description': '0.50 MTA tax that is automatically triggered based on the metered rate in use', 'tests': ['unique']}, {'name': 'tip_amount', 'description': 'Tip amount  This field is automatically populated for credit card tips.Cash tips are not included', 'tests': ['not_null']}, {'name': 'tolls_amount', 'description': 'Total amount of all tolls paid in trip', 'tests': ['not_null']}, {'name': 'improvement_surcharge', 'description': '0.30 improvement surcharge assessed trips at the flag drop. the improvement surcharge began being levied in 2015', 'tests': ['not_null']}, {'name': 'total_amount', 'description': 'The total amount charged to passengers. Does not include cash tips.', 'tests': ['not_null']}, {'name': 'payment_type', 'description': 'A numeric code signifying how the passenger paid for the trip', 'tests': ['not_null']}, {'name': 'trip_type', 'description': 'Year of pickup', 'tests': ['not_null']}, {'name': 'congestion_surcharge', 'description': 'An additional charge for trips taken during high traffic congestion times', 'tests': [None]}], 'original_file_path': 'models/tests/schema.yml', 'yaml_key': 'models', 'package_name': 'nyc_taxi'} - at path ['columns'][18]['tests'][0]: None is not valid under any of the given schemas
[2024-11-21T17:27:06.808+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:27:06.818+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 12.061 seconds
[2024-11-21T17:27:37.123+0000] {processor.py:161} INFO - Started process (PID=3367) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:27:37.124+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T17:27:37.125+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:27:37.125+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:27:37.147+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:27:37.147+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T17:27:36.853+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:27:36.853+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 0.7293525499999305
[2024-11-21T17:27:36.854+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:27:36.854+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T17:27:36.854+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:27:36.854+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T17:27:36.858+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:27:36.858+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T17:27:36.865+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:27:36.865+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T17:27:36.871+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:27:36.871+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpmopvoq9j --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T17:27:42.969+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:27:42.968+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpmopvoq9j --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T17:27:49.155+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:27:49.152+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 210, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpmopvoq9j', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
17:27:45  Running with dbt=1.8.7
17:27:46  Registered adapter: bigquery=1.8.3
17:27:47  [WARNING]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
17:27:47  Encountered an error:
Parsing Error
  Invalid models config given in models/tests/schema.yml @ models: {'name': 'fct_trips', 'description': 'Fact Table of tripdata', 'columns': [{'name': 'trip_id', 'description': 'The primary key for this table', 'tests': ['unique']}, {'name': 'vendor_id', 'description': 'A code indicating the TPEP provider that provided the record', 'tests': ['not_null']}, {'name': 'pickup_time_id', 'description': 'id to get pickup time from dim_time', 'tests': ['not_null']}, {'name': 'dropoff_time_id', 'description': 'id to get dropoff time from dim_time', 'tests': ['unique']}, {'name': 'rate_code_id', 'description': 'The final rate code in effect at the end of the trip', 'tests': ['unique']}, {'name': 'pu_location_id', 'description': 'The pickup location', 'tests': ['not_null']}, {'name': 'do_location_id', 'description': 'The droppof location', 'tests': ['not_null']}, {'name': 'passenger_count', 'description': 'Customer count', 'tests': ['unique']}, {'name': 'trip_distance', 'description': 'trip distance', 'tests': ['not_null']}, {'name': 'fare_amount', 'description': 'The time-and-distance fare calculated by the meter.', 'tests': ['not_null']}, {'name': 'extra', 'description': 'Miscellaneous extras and surcharges. Currently, this only includes. the $0.50 and $1 rush hour and overnight charges', 'tests': ['not_null']}, {'name': 'mta_tax', 'description': '0.50 MTA tax that is automatically triggered based on the metered rate in use', 'tests': ['unique']}, {'name': 'tip_amount', 'description': 'Tip amount  This field is automatically populated for credit card tips.Cash tips are not included', 'tests': ['not_null']}, {'name': 'tolls_amount', 'description': 'Total amount of all tolls paid in trip', 'tests': ['not_null']}, {'name': 'improvement_surcharge', 'description': '0.30 improvement surcharge assessed trips at the flag drop. the improvement surcharge began being levied in 2015', 'tests': ['not_null']}, {'name': 'total_amount', 'description': 'The total amount charged to passengers. Does not include cash tips.', 'tests': ['not_null']}, {'name': 'payment_type', 'description': 'A numeric code signifying how the passenger paid for the trip', 'tests': ['not_null']}, {'name': 'trip_type', 'description': 'Year of pickup', 'tests': ['not_null']}, {'name': 'congestion_surcharge', 'description': 'An additional charge for trips taken during high traffic congestion times', 'tests': [None]}], 'original_file_path': 'models/tests/schema.yml', 'yaml_key': 'models', 'package_name': 'nyc_taxi'} - at path ['columns'][18]['tests'][0]: None is not valid under any of the given schemas
[2024-11-21T17:27:49.156+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:27:49.172+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 13.087 seconds
[2024-11-21T17:28:19.567+0000] {processor.py:161} INFO - Started process (PID=3419) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:28:19.567+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T17:28:19.569+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:28:19.569+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:28:19.591+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:28:19.591+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T17:28:20.385+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:28:20.385+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 0.7826827199996842
[2024-11-21T17:28:20.386+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:28:20.386+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T17:28:20.386+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:28:20.386+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T17:28:20.390+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:28:20.390+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T17:28:20.396+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:28:20.395+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T17:28:20.401+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:28:20.401+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpbtb5exuf --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T17:28:24.803+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:28:24.803+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpbtb5exuf --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T17:28:31.144+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:28:31.141+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 210, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpbtb5exuf', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
17:28:26  Running with dbt=1.8.7
17:28:28  Registered adapter: bigquery=1.8.3
17:28:29  [WARNING]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
17:28:29  Encountered an error:
Parsing Error
  Invalid models config given in models/tests/schema.yml @ models: {'name': 'fct_trips', 'description': 'Fact Table of tripdata', 'columns': [{'name': 'trip_id', 'description': 'The primary key for this table', 'tests': ['unique']}, {'name': 'vendor_id', 'description': 'A code indicating the TPEP provider that provided the record', 'tests': ['not_null']}, {'name': 'pickup_time_id', 'description': 'id to get pickup time from dim_time', 'tests': ['not_null']}, {'name': 'dropoff_time_id', 'description': 'id to get dropoff time from dim_time', 'tests': ['unique']}, {'name': 'rate_code_id', 'description': 'The final rate code in effect at the end of the trip', 'tests': ['unique']}, {'name': 'pu_location_id', 'description': 'The pickup location', 'tests': ['not_null']}, {'name': 'do_location_id', 'description': 'The droppof location', 'tests': ['not_null']}, {'name': 'passenger_count', 'description': 'Customer count', 'tests': ['unique']}, {'name': 'trip_distance', 'description': 'trip distance', 'tests': ['not_null']}, {'name': 'fare_amount', 'description': 'The time-and-distance fare calculated by the meter.', 'tests': ['not_null']}, {'name': 'extra', 'description': 'Miscellaneous extras and surcharges. Currently, this only includes. the $0.50 and $1 rush hour and overnight charges', 'tests': ['not_null']}, {'name': 'mta_tax', 'description': '0.50 MTA tax that is automatically triggered based on the metered rate in use', 'tests': ['unique']}, {'name': 'tip_amount', 'description': 'Tip amount  This field is automatically populated for credit card tips.Cash tips are not included', 'tests': ['not_null']}, {'name': 'tolls_amount', 'description': 'Total amount of all tolls paid in trip', 'tests': ['not_null']}, {'name': 'improvement_surcharge', 'description': '0.30 improvement surcharge assessed trips at the flag drop. the improvement surcharge began being levied in 2015', 'tests': ['not_null']}, {'name': 'total_amount', 'description': 'The total amount charged to passengers. Does not include cash tips.', 'tests': ['not_null']}, {'name': 'payment_type', 'description': 'A numeric code signifying how the passenger paid for the trip', 'tests': ['not_null']}, {'name': 'trip_type', 'description': 'Year of pickup', 'tests': ['not_null']}, {'name': 'congestion_surcharge', 'description': 'An additional charge for trips taken during high traffic congestion times', 'tests': [None]}], 'original_file_path': 'models/tests/schema.yml', 'yaml_key': 'models', 'package_name': 'nyc_taxi'} - at path ['columns'][18]['tests'][0]: None is not valid under any of the given schemas
[2024-11-21T17:28:31.145+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:28:31.155+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 11.593 seconds
[2024-11-21T17:29:01.910+0000] {processor.py:161} INFO - Started process (PID=3464) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:29:01.911+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T17:29:01.913+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:29:01.913+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:29:01.940+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:29:01.940+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T17:29:02.736+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:29:02.736+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 0.7846326290000434
[2024-11-21T17:29:02.737+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:29:02.737+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T17:29:02.737+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:29:02.737+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T17:29:02.741+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:29:02.741+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T17:29:02.749+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:29:02.748+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T17:29:02.755+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:29:02.755+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpns_8u9jt --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T17:29:07.143+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:29:07.143+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpns_8u9jt --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T17:29:13.579+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:29:13.575+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 210, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpns_8u9jt', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
17:29:09  Running with dbt=1.8.7
17:29:10  Registered adapter: bigquery=1.8.3
17:29:11  [WARNING]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
17:29:11  Encountered an error:
Parsing Error
  Invalid models config given in models/tests/schema.yml @ models: {'name': 'fct_trips', 'description': 'Fact Table of tripdata', 'columns': [{'name': 'trip_id', 'description': 'The primary key for this table', 'tests': ['unique']}, {'name': 'vendor_id', 'description': 'A code indicating the TPEP provider that provided the record', 'tests': ['not_null']}, {'name': 'pickup_time_id', 'description': 'id to get pickup time from dim_time', 'tests': ['not_null']}, {'name': 'dropoff_time_id', 'description': 'id to get dropoff time from dim_time', 'tests': ['unique']}, {'name': 'rate_code_id', 'description': 'The final rate code in effect at the end of the trip', 'tests': ['unique']}, {'name': 'pu_location_id', 'description': 'The pickup location', 'tests': ['not_null']}, {'name': 'do_location_id', 'description': 'The droppof location', 'tests': ['not_null']}, {'name': 'passenger_count', 'description': 'Customer count', 'tests': ['unique']}, {'name': 'trip_distance', 'description': 'trip distance', 'tests': ['not_null']}, {'name': 'fare_amount', 'description': 'The time-and-distance fare calculated by the meter.', 'tests': ['not_null']}, {'name': 'extra', 'description': 'Miscellaneous extras and surcharges. Currently, this only includes. the $0.50 and $1 rush hour and overnight charges', 'tests': ['not_null']}, {'name': 'mta_tax', 'description': '0.50 MTA tax that is automatically triggered based on the metered rate in use', 'tests': ['unique']}, {'name': 'tip_amount', 'description': 'Tip amount  This field is automatically populated for credit card tips.Cash tips are not included', 'tests': ['not_null']}, {'name': 'tolls_amount', 'description': 'Total amount of all tolls paid in trip', 'tests': ['not_null']}, {'name': 'improvement_surcharge', 'description': '0.30 improvement surcharge assessed trips at the flag drop. the improvement surcharge began being levied in 2015', 'tests': ['not_null']}, {'name': 'total_amount', 'description': 'The total amount charged to passengers. Does not include cash tips.', 'tests': ['not_null']}, {'name': 'payment_type', 'description': 'A numeric code signifying how the passenger paid for the trip', 'tests': ['not_null']}, {'name': 'trip_type', 'description': 'Year of pickup', 'tests': ['not_null']}, {'name': 'congestion_surcharge', 'description': 'An additional charge for trips taken during high traffic congestion times', 'tests': [None]}], 'original_file_path': 'models/tests/schema.yml', 'yaml_key': 'models', 'package_name': 'nyc_taxi'} - at path ['columns'][18]['tests'][0]: None is not valid under any of the given schemas
[2024-11-21T17:29:13.579+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:29:13.592+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 12.692 seconds
[2024-11-21T17:29:44.367+0000] {processor.py:161} INFO - Started process (PID=3516) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:29:44.367+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T17:29:44.369+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:29:44.369+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:29:44.398+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:29:44.398+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T17:29:45.316+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:29:45.316+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 0.9065071559998614
[2024-11-21T17:29:45.317+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:29:45.317+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T17:29:45.318+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:29:45.318+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T17:29:45.323+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:29:45.323+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T17:29:45.331+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:29:45.331+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T17:29:45.338+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:29:45.338+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmph9ega1i0 --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T17:29:50.005+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:29:50.005+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmph9ega1i0 --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T17:29:56.341+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:29:56.337+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 210, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmph9ega1i0', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
17:29:52  Running with dbt=1.8.7
17:29:53  Registered adapter: bigquery=1.8.3
17:29:54  [WARNING]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
17:29:54  Encountered an error:
Parsing Error
  Invalid models config given in models/tests/schema.yml @ models: {'name': 'fct_trips', 'description': 'Fact Table of tripdata', 'columns': [{'name': 'trip_id', 'description': 'The primary key for this table', 'tests': ['unique']}, {'name': 'vendor_id', 'description': 'A code indicating the TPEP provider that provided the record', 'tests': ['not_null']}, {'name': 'pickup_time_id', 'description': 'id to get pickup time from dim_time', 'tests': ['not_null']}, {'name': 'dropoff_time_id', 'description': 'id to get dropoff time from dim_time', 'tests': ['unique']}, {'name': 'rate_code_id', 'description': 'The final rate code in effect at the end of the trip', 'tests': ['unique']}, {'name': 'pu_location_id', 'description': 'The pickup location', 'tests': ['not_null']}, {'name': 'do_location_id', 'description': 'The droppof location', 'tests': ['not_null']}, {'name': 'passenger_count', 'description': 'Customer count', 'tests': ['unique']}, {'name': 'trip_distance', 'description': 'trip distance', 'tests': ['not_null']}, {'name': 'fare_amount', 'description': 'The time-and-distance fare calculated by the meter.', 'tests': ['not_null']}, {'name': 'extra', 'description': 'Miscellaneous extras and surcharges. Currently, this only includes. the $0.50 and $1 rush hour and overnight charges', 'tests': ['not_null']}, {'name': 'mta_tax', 'description': '0.50 MTA tax that is automatically triggered based on the metered rate in use', 'tests': ['unique']}, {'name': 'tip_amount', 'description': 'Tip amount  This field is automatically populated for credit card tips.Cash tips are not included', 'tests': ['not_null']}, {'name': 'tolls_amount', 'description': 'Total amount of all tolls paid in trip', 'tests': ['not_null']}, {'name': 'improvement_surcharge', 'description': '0.30 improvement surcharge assessed trips at the flag drop. the improvement surcharge began being levied in 2015', 'tests': ['not_null']}, {'name': 'total_amount', 'description': 'The total amount charged to passengers. Does not include cash tips.', 'tests': ['not_null']}, {'name': 'payment_type', 'description': 'A numeric code signifying how the passenger paid for the trip', 'tests': ['not_null']}, {'name': 'trip_type', 'description': 'Year of pickup', 'tests': ['not_null']}, {'name': 'congestion_surcharge', 'description': 'An additional charge for trips taken during high traffic congestion times', 'tests': [None]}], 'original_file_path': 'models/tests/schema.yml', 'yaml_key': 'models', 'package_name': 'nyc_taxi'} - at path ['columns'][18]['tests'][0]: None is not valid under any of the given schemas
[2024-11-21T17:29:56.342+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:29:56.358+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 11.998 seconds
[2024-11-21T17:30:26.768+0000] {processor.py:161} INFO - Started process (PID=3561) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:30:26.769+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T17:30:26.770+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:30:26.770+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:30:26.792+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:30:26.792+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T17:30:27.533+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:30:27.533+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 0.7312121400000251
[2024-11-21T17:30:27.534+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:30:27.533+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T17:30:27.534+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:30:27.534+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T17:30:27.538+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:30:27.538+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T17:30:27.544+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:30:27.544+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T17:30:27.549+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:30:27.549+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpmveajod8 --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T17:30:31.377+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:30:31.377+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpmveajod8 --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T17:30:37.838+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:30:37.834+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 210, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpmveajod8', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
17:30:33  Running with dbt=1.8.7
17:30:35  Registered adapter: bigquery=1.8.3
17:30:35  [WARNING]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
17:30:35  Encountered an error:
Parsing Error
  Invalid models config given in models/tests/schema.yml @ models: {'name': 'fct_trips', 'description': 'Fact Table of tripdata', 'columns': [{'name': 'trip_id', 'description': 'The primary key for this table', 'tests': ['unique']}, {'name': 'vendor_id', 'description': 'A code indicating the TPEP provider that provided the record', 'tests': ['not_null']}, {'name': 'pickup_time_id', 'description': 'id to get pickup time from dim_time', 'tests': ['not_null']}, {'name': 'dropoff_time_id', 'description': 'id to get dropoff time from dim_time', 'tests': ['unique']}, {'name': 'rate_code_id', 'description': 'The final rate code in effect at the end of the trip', 'tests': ['unique']}, {'name': 'pu_location_id', 'description': 'The pickup location', 'tests': ['not_null']}, {'name': 'do_location_id', 'description': 'The droppof location', 'tests': ['not_null']}, {'name': 'passenger_count', 'description': 'Customer count', 'tests': ['unique']}, {'name': 'trip_distance', 'description': 'trip distance', 'tests': ['not_null']}, {'name': 'fare_amount', 'description': 'The time-and-distance fare calculated by the meter.', 'tests': ['not_null']}, {'name': 'extra', 'description': 'Miscellaneous extras and surcharges. Currently, this only includes. the $0.50 and $1 rush hour and overnight charges', 'tests': ['not_null']}, {'name': 'mta_tax', 'description': '0.50 MTA tax that is automatically triggered based on the metered rate in use', 'tests': ['unique']}, {'name': 'tip_amount', 'description': 'Tip amount  This field is automatically populated for credit card tips.Cash tips are not included', 'tests': ['not_null']}, {'name': 'tolls_amount', 'description': 'Total amount of all tolls paid in trip', 'tests': ['not_null']}, {'name': 'improvement_surcharge', 'description': '0.30 improvement surcharge assessed trips at the flag drop. the improvement surcharge began being levied in 2015', 'tests': ['not_null']}, {'name': 'total_amount', 'description': 'The total amount charged to passengers. Does not include cash tips.', 'tests': ['not_null']}, {'name': 'payment_type', 'description': 'A numeric code signifying how the passenger paid for the trip', 'tests': ['not_null']}, {'name': 'trip_type', 'description': 'Year of pickup', 'tests': ['not_null']}, {'name': 'congestion_surcharge', 'description': 'An additional charge for trips taken during high traffic congestion times', 'tests': [None]}], 'original_file_path': 'models/tests/schema.yml', 'yaml_key': 'models', 'package_name': 'nyc_taxi'} - at path ['columns'][18]['tests'][0]: None is not valid under any of the given schemas
[2024-11-21T17:30:37.838+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:30:37.848+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 12.159 seconds
[2024-11-21T17:31:08.024+0000] {processor.py:161} INFO - Started process (PID=3612) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:31:08.025+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T17:31:08.027+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:31:08.026+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:31:08.049+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:31:08.048+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T17:31:08.787+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:31:08.787+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 0.7285199070001909
[2024-11-21T17:31:08.788+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:31:08.788+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T17:31:08.788+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:31:08.788+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T17:31:08.792+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:31:08.792+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T17:31:08.799+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:31:08.799+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T17:31:08.804+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:31:08.804+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp7b1fcwg6 --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T17:31:13.742+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:31:13.741+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp7b1fcwg6 --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T17:31:20.426+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:31:20.423+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 210, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmp7b1fcwg6', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
17:31:16  Running with dbt=1.8.7
17:31:17  Registered adapter: bigquery=1.8.3
17:31:18  [WARNING]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
17:31:18  Encountered an error:
Parsing Error
  Invalid models config given in models/tests/schema.yml @ models: {'name': 'fct_trips', 'description': 'Fact Table of tripdata', 'columns': [{'name': 'trip_id', 'description': 'The primary key for this table', 'tests': ['unique']}, {'name': 'vendor_id', 'description': 'A code indicating the TPEP provider that provided the record', 'tests': ['not_null']}, {'name': 'pickup_time_id', 'description': 'id to get pickup time from dim_time', 'tests': ['not_null']}, {'name': 'dropoff_time_id', 'description': 'id to get dropoff time from dim_time', 'tests': ['unique']}, {'name': 'rate_code_id', 'description': 'The final rate code in effect at the end of the trip', 'tests': ['unique']}, {'name': 'pu_location_id', 'description': 'The pickup location', 'tests': ['not_null']}, {'name': 'do_location_id', 'description': 'The droppof location', 'tests': ['not_null']}, {'name': 'passenger_count', 'description': 'Customer count', 'tests': ['unique']}, {'name': 'trip_distance', 'description': 'trip distance', 'tests': ['not_null']}, {'name': 'fare_amount', 'description': 'The time-and-distance fare calculated by the meter.', 'tests': ['not_null']}, {'name': 'extra', 'description': 'Miscellaneous extras and surcharges. Currently, this only includes. the $0.50 and $1 rush hour and overnight charges', 'tests': ['not_null']}, {'name': 'mta_tax', 'description': '0.50 MTA tax that is automatically triggered based on the metered rate in use', 'tests': ['unique']}, {'name': 'tip_amount', 'description': 'Tip amount  This field is automatically populated for credit card tips.Cash tips are not included', 'tests': ['not_null']}, {'name': 'tolls_amount', 'description': 'Total amount of all tolls paid in trip', 'tests': ['not_null']}, {'name': 'improvement_surcharge', 'description': '0.30 improvement surcharge assessed trips at the flag drop. the improvement surcharge began being levied in 2015', 'tests': ['not_null']}, {'name': 'total_amount', 'description': 'The total amount charged to passengers. Does not include cash tips.', 'tests': ['not_null']}, {'name': 'payment_type', 'description': 'A numeric code signifying how the passenger paid for the trip', 'tests': ['not_null']}, {'name': 'trip_type', 'description': 'Year of pickup', 'tests': ['not_null']}, {'name': 'congestion_surcharge', 'description': 'An additional charge for trips taken during high traffic congestion times', 'tests': [None]}], 'original_file_path': 'models/tests/schema.yml', 'yaml_key': 'models', 'package_name': 'nyc_taxi'} - at path ['columns'][18]['tests'][0]: None is not valid under any of the given schemas
[2024-11-21T17:31:20.427+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:31:20.444+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 12.425 seconds
[2024-11-21T17:31:50.547+0000] {processor.py:161} INFO - Started process (PID=3658) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:31:50.548+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T17:31:50.551+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:31:50.550+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:31:50.581+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:31:50.581+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T17:31:51.359+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:31:51.359+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 0.7641720510000596
[2024-11-21T17:31:51.360+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:31:51.360+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T17:31:51.360+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:31:51.360+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T17:31:51.364+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:31:51.364+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T17:31:51.371+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:31:51.371+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T17:31:51.377+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:31:51.377+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp7g15ppxa --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T17:31:56.190+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:31:56.190+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp7g15ppxa --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T17:32:01.499+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:32:01.496+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 210, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmp7g15ppxa', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
17:31:57  Running with dbt=1.8.7
17:31:58  Registered adapter: bigquery=1.8.3
17:31:59  [WARNING]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
17:31:59  Encountered an error:
Parsing Error
  Invalid models config given in models/tests/schema.yml @ models: {'name': 'fct_trips', 'description': 'Fact Table of tripdata', 'columns': [{'name': 'trip_id', 'description': 'The primary key for this table', 'tests': ['unique']}, {'name': 'vendor_id', 'description': 'A code indicating the TPEP provider that provided the record', 'tests': ['not_null']}, {'name': 'pickup_time_id', 'description': 'id to get pickup time from dim_time', 'tests': ['not_null']}, {'name': 'dropoff_time_id', 'description': 'id to get dropoff time from dim_time', 'tests': ['unique']}, {'name': 'rate_code_id', 'description': 'The final rate code in effect at the end of the trip', 'tests': ['unique']}, {'name': 'pu_location_id', 'description': 'The pickup location', 'tests': ['not_null']}, {'name': 'do_location_id', 'description': 'The droppof location', 'tests': ['not_null']}, {'name': 'passenger_count', 'description': 'Customer count', 'tests': ['unique']}, {'name': 'trip_distance', 'description': 'trip distance', 'tests': ['not_null']}, {'name': 'fare_amount', 'description': 'The time-and-distance fare calculated by the meter.', 'tests': ['not_null']}, {'name': 'extra', 'description': 'Miscellaneous extras and surcharges. Currently, this only includes. the $0.50 and $1 rush hour and overnight charges', 'tests': ['not_null']}, {'name': 'mta_tax', 'description': '0.50 MTA tax that is automatically triggered based on the metered rate in use', 'tests': ['unique']}, {'name': 'tip_amount', 'description': 'Tip amount  This field is automatically populated for credit card tips.Cash tips are not included', 'tests': ['not_null']}, {'name': 'tolls_amount', 'description': 'Total amount of all tolls paid in trip', 'tests': ['not_null']}, {'name': 'improvement_surcharge', 'description': '0.30 improvement surcharge assessed trips at the flag drop. the improvement surcharge began being levied in 2015', 'tests': ['not_null']}, {'name': 'total_amount', 'description': 'The total amount charged to passengers. Does not include cash tips.', 'tests': ['not_null']}, {'name': 'payment_type', 'description': 'A numeric code signifying how the passenger paid for the trip', 'tests': ['not_null']}, {'name': 'trip_type', 'description': 'Year of pickup', 'tests': ['not_null']}, {'name': 'congestion_surcharge', 'description': 'An additional charge for trips taken during high traffic congestion times', 'tests': [None]}], 'original_file_path': 'models/tests/schema.yml', 'yaml_key': 'models', 'package_name': 'nyc_taxi'} - at path ['columns'][18]['tests'][0]: None is not valid under any of the given schemas
[2024-11-21T17:32:01.500+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:32:01.516+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 11.992 seconds
[2024-11-21T17:32:31.785+0000] {processor.py:161} INFO - Started process (PID=3709) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:32:31.786+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T17:32:31.787+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:32:31.787+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:32:31.811+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:32:31.810+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T17:32:32.579+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:32:32.578+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 0.7576711520000572
[2024-11-21T17:32:32.579+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:32:32.579+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T17:32:32.579+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:32:32.579+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T17:32:32.584+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:32:32.584+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T17:32:32.592+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:32:32.592+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T17:32:32.599+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:32:32.599+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpgb49p93a --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T17:32:37.083+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:32:37.082+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpgb49p93a --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T17:32:43.401+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:32:43.397+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 210, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpgb49p93a', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
17:32:39  Running with dbt=1.8.7
17:32:40  Registered adapter: bigquery=1.8.3
17:32:41  [WARNING]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
17:32:41  Encountered an error:
Parsing Error
  Invalid models config given in models/tests/schema.yml @ models: {'name': 'fct_trips', 'description': 'Fact Table of tripdata', 'columns': [{'name': 'trip_id', 'description': 'The primary key for this table', 'tests': ['unique']}, {'name': 'vendor_id', 'description': 'A code indicating the TPEP provider that provided the record', 'tests': ['not_null']}, {'name': 'pickup_time_id', 'description': 'id to get pickup time from dim_time', 'tests': ['not_null']}, {'name': 'dropoff_time_id', 'description': 'id to get dropoff time from dim_time', 'tests': ['unique']}, {'name': 'rate_code_id', 'description': 'The final rate code in effect at the end of the trip', 'tests': ['unique']}, {'name': 'pu_location_id', 'description': 'The pickup location', 'tests': ['not_null']}, {'name': 'do_location_id', 'description': 'The droppof location', 'tests': ['not_null']}, {'name': 'passenger_count', 'description': 'Customer count', 'tests': ['unique']}, {'name': 'trip_distance', 'description': 'trip distance', 'tests': ['not_null']}, {'name': 'fare_amount', 'description': 'The time-and-distance fare calculated by the meter.', 'tests': ['not_null']}, {'name': 'extra', 'description': 'Miscellaneous extras and surcharges. Currently, this only includes. the $0.50 and $1 rush hour and overnight charges', 'tests': ['not_null']}, {'name': 'mta_tax', 'description': '0.50 MTA tax that is automatically triggered based on the metered rate in use', 'tests': ['unique']}, {'name': 'tip_amount', 'description': 'Tip amount  This field is automatically populated for credit card tips.Cash tips are not included', 'tests': ['not_null']}, {'name': 'tolls_amount', 'description': 'Total amount of all tolls paid in trip', 'tests': ['not_null']}, {'name': 'improvement_surcharge', 'description': '0.30 improvement surcharge assessed trips at the flag drop. the improvement surcharge began being levied in 2015', 'tests': ['not_null']}, {'name': 'total_amount', 'description': 'The total amount charged to passengers. Does not include cash tips.', 'tests': ['not_null']}, {'name': 'payment_type', 'description': 'A numeric code signifying how the passenger paid for the trip', 'tests': ['not_null']}, {'name': 'trip_type', 'description': 'Year of pickup', 'tests': ['not_null']}, {'name': 'congestion_surcharge', 'description': 'An additional charge for trips taken during high traffic congestion times', 'tests': [None]}], 'original_file_path': 'models/tests/schema.yml', 'yaml_key': 'models', 'package_name': 'nyc_taxi'} - at path ['columns'][18]['tests'][0]: None is not valid under any of the given schemas
[2024-11-21T17:32:43.402+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:32:43.418+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 11.637 seconds
[2024-11-21T17:33:13.517+0000] {processor.py:161} INFO - Started process (PID=3755) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:33:13.517+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T17:33:13.519+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:33:13.519+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:33:13.541+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:33:13.541+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T17:33:14.276+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:33:14.275+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 0.7237586229998669
[2024-11-21T17:33:14.276+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:33:14.276+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T17:33:14.277+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:33:14.276+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T17:33:14.280+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:33:14.280+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T17:33:14.286+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:33:14.286+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T17:33:14.292+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:33:14.292+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpuzvzdco8 --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T17:33:20.289+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:33:20.289+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpuzvzdco8 --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T17:33:25.773+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:33:25.770+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 210, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpuzvzdco8', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
17:33:22  Running with dbt=1.8.7
17:33:24  Registered adapter: bigquery=1.8.3
17:33:24  [WARNING]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
17:33:24  Encountered an error:
Parsing Error
  Invalid models config given in models/tests/schema.yml @ models: {'name': 'fct_trips', 'description': 'Fact Table of tripdata', 'columns': [{'name': 'trip_id', 'description': 'The primary key for this table', 'tests': ['unique']}, {'name': 'vendor_id', 'description': 'A code indicating the TPEP provider that provided the record', 'tests': ['not_null']}, {'name': 'pickup_time_id', 'description': 'id to get pickup time from dim_time', 'tests': ['not_null']}, {'name': 'dropoff_time_id', 'description': 'id to get dropoff time from dim_time', 'tests': ['unique']}, {'name': 'rate_code_id', 'description': 'The final rate code in effect at the end of the trip', 'tests': ['unique']}, {'name': 'pu_location_id', 'description': 'The pickup location', 'tests': ['not_null']}, {'name': 'do_location_id', 'description': 'The droppof location', 'tests': ['not_null']}, {'name': 'passenger_count', 'description': 'Customer count', 'tests': ['unique']}, {'name': 'trip_distance', 'description': 'trip distance', 'tests': ['not_null']}, {'name': 'fare_amount', 'description': 'The time-and-distance fare calculated by the meter.', 'tests': ['not_null']}, {'name': 'extra', 'description': 'Miscellaneous extras and surcharges. Currently, this only includes. the $0.50 and $1 rush hour and overnight charges', 'tests': ['not_null']}, {'name': 'mta_tax', 'description': '0.50 MTA tax that is automatically triggered based on the metered rate in use', 'tests': ['unique']}, {'name': 'tip_amount', 'description': 'Tip amount  This field is automatically populated for credit card tips.Cash tips are not included', 'tests': ['not_null']}, {'name': 'tolls_amount', 'description': 'Total amount of all tolls paid in trip', 'tests': ['not_null']}, {'name': 'improvement_surcharge', 'description': '0.30 improvement surcharge assessed trips at the flag drop. the improvement surcharge began being levied in 2015', 'tests': ['not_null']}, {'name': 'total_amount', 'description': 'The total amount charged to passengers. Does not include cash tips.', 'tests': ['not_null']}, {'name': 'payment_type', 'description': 'A numeric code signifying how the passenger paid for the trip', 'tests': ['not_null']}, {'name': 'trip_type', 'description': 'Year of pickup', 'tests': ['not_null']}, {'name': 'congestion_surcharge', 'description': 'An additional charge for trips taken during high traffic congestion times', 'tests': [None]}], 'original_file_path': 'models/tests/schema.yml', 'yaml_key': 'models', 'package_name': 'nyc_taxi'} - at path ['columns'][18]['tests'][0]: None is not valid under any of the given schemas
[2024-11-21T17:33:25.774+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:33:25.789+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 13.346 seconds
[2024-11-21T17:33:56.408+0000] {processor.py:161} INFO - Started process (PID=3806) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:33:56.409+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T17:33:56.410+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:33:56.410+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:33:56.433+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:33:56.433+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T17:33:57.188+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:33:57.188+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 0.7433599510000022
[2024-11-21T17:33:57.189+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:33:57.189+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T17:33:57.189+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:33:57.189+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T17:33:57.193+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:33:57.193+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T17:33:57.199+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:33:57.199+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T17:33:57.205+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:33:57.204+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp3wuq_h3e --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T17:34:01.769+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:34:01.768+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp3wuq_h3e --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T17:34:08.305+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:34:08.302+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 210, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmp3wuq_h3e', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
17:34:04  Running with dbt=1.8.7
17:34:05  Registered adapter: bigquery=1.8.3
17:34:06  [WARNING]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
17:34:06  Encountered an error:
Parsing Error
  Invalid models config given in models/tests/schema.yml @ models: {'name': 'fct_trips', 'description': 'Fact Table of tripdata', 'columns': [{'name': 'trip_id', 'description': 'The primary key for this table', 'tests': ['unique']}, {'name': 'vendor_id', 'description': 'A code indicating the TPEP provider that provided the record', 'tests': ['not_null']}, {'name': 'pickup_time_id', 'description': 'id to get pickup time from dim_time', 'tests': ['not_null']}, {'name': 'dropoff_time_id', 'description': 'id to get dropoff time from dim_time', 'tests': ['unique']}, {'name': 'rate_code_id', 'description': 'The final rate code in effect at the end of the trip', 'tests': ['unique']}, {'name': 'pu_location_id', 'description': 'The pickup location', 'tests': ['not_null']}, {'name': 'do_location_id', 'description': 'The droppof location', 'tests': ['not_null']}, {'name': 'passenger_count', 'description': 'Customer count', 'tests': ['unique']}, {'name': 'trip_distance', 'description': 'trip distance', 'tests': ['not_null']}, {'name': 'fare_amount', 'description': 'The time-and-distance fare calculated by the meter.', 'tests': ['not_null']}, {'name': 'extra', 'description': 'Miscellaneous extras and surcharges. Currently, this only includes. the $0.50 and $1 rush hour and overnight charges', 'tests': ['not_null']}, {'name': 'mta_tax', 'description': '0.50 MTA tax that is automatically triggered based on the metered rate in use', 'tests': ['unique']}, {'name': 'tip_amount', 'description': 'Tip amount  This field is automatically populated for credit card tips.Cash tips are not included', 'tests': ['not_null']}, {'name': 'tolls_amount', 'description': 'Total amount of all tolls paid in trip', 'tests': ['not_null']}, {'name': 'improvement_surcharge', 'description': '0.30 improvement surcharge assessed trips at the flag drop. the improvement surcharge began being levied in 2015', 'tests': ['not_null']}, {'name': 'total_amount', 'description': 'The total amount charged to passengers. Does not include cash tips.', 'tests': ['not_null']}, {'name': 'payment_type', 'description': 'A numeric code signifying how the passenger paid for the trip', 'tests': ['not_null']}, {'name': 'trip_type', 'description': 'Year of pickup', 'tests': ['not_null']}, {'name': 'congestion_surcharge', 'description': 'An additional charge for trips taken during high traffic congestion times', 'tests': [None]}], 'original_file_path': 'models/tests/schema.yml', 'yaml_key': 'models', 'package_name': 'nyc_taxi'} - at path ['columns'][18]['tests'][0]: None is not valid under any of the given schemas
[2024-11-21T17:34:08.306+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:34:08.316+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 11.913 seconds
[2024-11-21T17:34:39.148+0000] {processor.py:161} INFO - Started process (PID=3851) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:34:39.148+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T17:34:39.150+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:34:39.150+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:34:39.173+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:34:39.173+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T17:34:39.986+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:34:39.986+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 0.8025542659997882
[2024-11-21T17:34:39.987+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:34:39.987+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T17:34:39.987+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:34:39.987+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T17:34:39.992+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:34:39.992+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T17:34:40.000+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:34:40.000+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T17:34:40.007+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:34:40.007+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmprb1s1b1b --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T17:34:45.313+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:34:45.312+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmprb1s1b1b --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T17:34:51.747+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:34:51.743+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 210, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmprb1s1b1b', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
17:34:47  Running with dbt=1.8.7
17:34:48  Registered adapter: bigquery=1.8.3
17:34:49  [WARNING]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
17:34:49  Encountered an error:
Parsing Error
  Invalid models config given in models/tests/schema.yml @ models: {'name': 'fct_trips', 'description': 'Fact Table of tripdata', 'columns': [{'name': 'trip_id', 'description': 'The primary key for this table', 'tests': ['unique']}, {'name': 'vendor_id', 'description': 'A code indicating the TPEP provider that provided the record', 'tests': ['not_null']}, {'name': 'pickup_time_id', 'description': 'id to get pickup time from dim_time', 'tests': ['not_null']}, {'name': 'dropoff_time_id', 'description': 'id to get dropoff time from dim_time', 'tests': ['unique']}, {'name': 'rate_code_id', 'description': 'The final rate code in effect at the end of the trip', 'tests': ['unique']}, {'name': 'pu_location_id', 'description': 'The pickup location', 'tests': ['not_null']}, {'name': 'do_location_id', 'description': 'The droppof location', 'tests': ['not_null']}, {'name': 'passenger_count', 'description': 'Customer count', 'tests': ['unique']}, {'name': 'trip_distance', 'description': 'trip distance', 'tests': ['not_null']}, {'name': 'fare_amount', 'description': 'The time-and-distance fare calculated by the meter.', 'tests': ['not_null']}, {'name': 'extra', 'description': 'Miscellaneous extras and surcharges. Currently, this only includes. the $0.50 and $1 rush hour and overnight charges', 'tests': ['not_null']}, {'name': 'mta_tax', 'description': '0.50 MTA tax that is automatically triggered based on the metered rate in use', 'tests': ['unique']}, {'name': 'tip_amount', 'description': 'Tip amount  This field is automatically populated for credit card tips.Cash tips are not included', 'tests': ['not_null']}, {'name': 'tolls_amount', 'description': 'Total amount of all tolls paid in trip', 'tests': ['not_null']}, {'name': 'improvement_surcharge', 'description': '0.30 improvement surcharge assessed trips at the flag drop. the improvement surcharge began being levied in 2015', 'tests': ['not_null']}, {'name': 'total_amount', 'description': 'The total amount charged to passengers. Does not include cash tips.', 'tests': ['not_null']}, {'name': 'payment_type', 'description': 'A numeric code signifying how the passenger paid for the trip', 'tests': ['not_null']}, {'name': 'trip_type', 'description': 'Year of pickup', 'tests': ['not_null']}, {'name': 'congestion_surcharge', 'description': 'An additional charge for trips taken during high traffic congestion times', 'tests': [None]}], 'original_file_path': 'models/tests/schema.yml', 'yaml_key': 'models', 'package_name': 'nyc_taxi'} - at path ['columns'][18]['tests'][0]: None is not valid under any of the given schemas
[2024-11-21T17:34:51.748+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:34:51.758+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 12.615 seconds
[2024-11-21T17:35:22.579+0000] {processor.py:161} INFO - Started process (PID=3903) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:35:22.580+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T17:35:22.582+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:35:22.581+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:35:22.608+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:35:22.608+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T17:35:23.380+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:35:23.379+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 0.7601842159997432
[2024-11-21T17:35:23.380+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:35:23.380+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T17:35:23.381+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:35:23.381+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T17:35:23.384+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:35:23.384+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T17:35:23.391+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:35:23.390+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T17:35:23.397+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:35:23.396+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpev0z78tg --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T17:35:27.818+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:35:27.817+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpev0z78tg --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T17:35:34.364+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:35:34.359+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 210, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpev0z78tg', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
17:35:29  Running with dbt=1.8.7
17:35:31  Registered adapter: bigquery=1.8.3
17:35:32  [WARNING]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
17:35:32  Encountered an error:
Parsing Error
  Invalid models config given in models/tests/schema.yml @ models: {'name': 'fct_trips', 'description': 'Fact Table of tripdata', 'columns': [{'name': 'trip_id', 'description': 'The primary key for this table', 'tests': ['unique']}, {'name': 'vendor_id', 'description': 'A code indicating the TPEP provider that provided the record', 'tests': ['not_null']}, {'name': 'pickup_time_id', 'description': 'id to get pickup time from dim_time', 'tests': ['not_null']}, {'name': 'dropoff_time_id', 'description': 'id to get dropoff time from dim_time', 'tests': ['unique']}, {'name': 'rate_code_id', 'description': 'The final rate code in effect at the end of the trip', 'tests': ['unique']}, {'name': 'pu_location_id', 'description': 'The pickup location', 'tests': ['not_null']}, {'name': 'do_location_id', 'description': 'The droppof location', 'tests': ['not_null']}, {'name': 'passenger_count', 'description': 'Customer count', 'tests': ['unique']}, {'name': 'trip_distance', 'description': 'trip distance', 'tests': ['not_null']}, {'name': 'fare_amount', 'description': 'The time-and-distance fare calculated by the meter.', 'tests': ['not_null']}, {'name': 'extra', 'description': 'Miscellaneous extras and surcharges. Currently, this only includes. the $0.50 and $1 rush hour and overnight charges', 'tests': ['not_null']}, {'name': 'mta_tax', 'description': '0.50 MTA tax that is automatically triggered based on the metered rate in use', 'tests': ['unique']}, {'name': 'tip_amount', 'description': 'Tip amount  This field is automatically populated for credit card tips.Cash tips are not included', 'tests': ['not_null']}, {'name': 'tolls_amount', 'description': 'Total amount of all tolls paid in trip', 'tests': ['not_null']}, {'name': 'improvement_surcharge', 'description': '0.30 improvement surcharge assessed trips at the flag drop. the improvement surcharge began being levied in 2015', 'tests': ['not_null']}, {'name': 'total_amount', 'description': 'The total amount charged to passengers. Does not include cash tips.', 'tests': ['not_null']}, {'name': 'payment_type', 'description': 'A numeric code signifying how the passenger paid for the trip', 'tests': ['not_null']}, {'name': 'trip_type', 'description': 'Year of pickup', 'tests': ['not_null']}, {'name': 'congestion_surcharge', 'description': 'An additional charge for trips taken during high traffic congestion times', 'tests': [None]}], 'original_file_path': 'models/tests/schema.yml', 'yaml_key': 'models', 'package_name': 'nyc_taxi'} - at path ['columns'][18]['tests'][0]: None is not valid under any of the given schemas
[2024-11-21T17:35:34.364+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:35:34.375+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 11.802 seconds
[2024-11-21T17:36:04.977+0000] {processor.py:161} INFO - Started process (PID=3948) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:36:04.978+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T17:36:04.979+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:36:04.979+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:36:05.000+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:36:05.000+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T17:36:05.707+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:36:05.707+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 0.6969382190000033
[2024-11-21T17:36:05.707+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:36:05.707+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T17:36:05.708+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:36:05.708+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T17:36:05.712+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:36:05.711+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T17:36:05.717+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:36:05.717+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T17:36:05.722+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:36:05.722+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmprqx7oagu --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T17:36:10.735+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:36:10.734+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmprqx7oagu --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T17:36:17.184+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:36:17.181+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 210, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmprqx7oagu', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
17:36:13  Running with dbt=1.8.7
17:36:14  Registered adapter: bigquery=1.8.3
17:36:15  [WARNING]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
17:36:15  Encountered an error:
Parsing Error
  Invalid models config given in models/tests/schema.yml @ models: {'name': 'fct_trips', 'description': 'Fact Table of tripdata', 'columns': [{'name': 'trip_id', 'description': 'The primary key for this table', 'tests': ['unique']}, {'name': 'vendor_id', 'description': 'A code indicating the TPEP provider that provided the record', 'tests': ['not_null']}, {'name': 'pickup_time_id', 'description': 'id to get pickup time from dim_time', 'tests': ['not_null']}, {'name': 'dropoff_time_id', 'description': 'id to get dropoff time from dim_time', 'tests': ['unique']}, {'name': 'rate_code_id', 'description': 'The final rate code in effect at the end of the trip', 'tests': ['unique']}, {'name': 'pu_location_id', 'description': 'The pickup location', 'tests': ['not_null']}, {'name': 'do_location_id', 'description': 'The droppof location', 'tests': ['not_null']}, {'name': 'passenger_count', 'description': 'Customer count', 'tests': ['unique']}, {'name': 'trip_distance', 'description': 'trip distance', 'tests': ['not_null']}, {'name': 'fare_amount', 'description': 'The time-and-distance fare calculated by the meter.', 'tests': ['not_null']}, {'name': 'extra', 'description': 'Miscellaneous extras and surcharges. Currently, this only includes. the $0.50 and $1 rush hour and overnight charges', 'tests': ['not_null']}, {'name': 'mta_tax', 'description': '0.50 MTA tax that is automatically triggered based on the metered rate in use', 'tests': ['unique']}, {'name': 'tip_amount', 'description': 'Tip amount  This field is automatically populated for credit card tips.Cash tips are not included', 'tests': ['not_null']}, {'name': 'tolls_amount', 'description': 'Total amount of all tolls paid in trip', 'tests': ['not_null']}, {'name': 'improvement_surcharge', 'description': '0.30 improvement surcharge assessed trips at the flag drop. the improvement surcharge began being levied in 2015', 'tests': ['not_null']}, {'name': 'total_amount', 'description': 'The total amount charged to passengers. Does not include cash tips.', 'tests': ['not_null']}, {'name': 'payment_type', 'description': 'A numeric code signifying how the passenger paid for the trip', 'tests': ['not_null']}, {'name': 'trip_type', 'description': 'Year of pickup', 'tests': ['not_null']}, {'name': 'congestion_surcharge', 'description': 'An additional charge for trips taken during high traffic congestion times', 'tests': [None]}], 'original_file_path': 'models/tests/schema.yml', 'yaml_key': 'models', 'package_name': 'nyc_taxi'} - at path ['columns'][18]['tests'][0]: None is not valid under any of the given schemas
[2024-11-21T17:36:17.185+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:36:17.201+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 12.229 seconds
[2024-11-21T17:36:47.482+0000] {processor.py:161} INFO - Started process (PID=3994) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:36:47.483+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T17:36:47.485+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:36:47.485+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:36:47.510+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:36:47.510+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T17:36:47.257+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:36:47.257+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 0.7856905090002329
[2024-11-21T17:36:47.258+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:36:47.258+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T17:36:47.258+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:36:47.258+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T17:36:47.263+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:36:47.262+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T17:36:47.270+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:36:47.270+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T17:36:47.276+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:36:47.275+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp80su0il6 --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T17:36:52.071+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:36:52.071+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp80su0il6 --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T17:36:58.543+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:36:58.540+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 210, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmp80su0il6', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
17:36:54  Running with dbt=1.8.7
17:36:55  Registered adapter: bigquery=1.8.3
17:36:56  [WARNING]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
17:36:56  Encountered an error:
Parsing Error
  Invalid models config given in models/tests/schema.yml @ models: {'name': 'fct_trips', 'description': 'Fact Table of tripdata', 'columns': [{'name': 'trip_id', 'description': 'The primary key for this table', 'tests': ['unique']}, {'name': 'vendor_id', 'description': 'A code indicating the TPEP provider that provided the record', 'tests': ['not_null']}, {'name': 'pickup_time_id', 'description': 'id to get pickup time from dim_time', 'tests': ['not_null']}, {'name': 'dropoff_time_id', 'description': 'id to get dropoff time from dim_time', 'tests': ['unique']}, {'name': 'rate_code_id', 'description': 'The final rate code in effect at the end of the trip', 'tests': ['unique']}, {'name': 'pu_location_id', 'description': 'The pickup location', 'tests': ['not_null']}, {'name': 'do_location_id', 'description': 'The droppof location', 'tests': ['not_null']}, {'name': 'passenger_count', 'description': 'Customer count', 'tests': ['unique']}, {'name': 'trip_distance', 'description': 'trip distance', 'tests': ['not_null']}, {'name': 'fare_amount', 'description': 'The time-and-distance fare calculated by the meter.', 'tests': ['not_null']}, {'name': 'extra', 'description': 'Miscellaneous extras and surcharges. Currently, this only includes. the $0.50 and $1 rush hour and overnight charges', 'tests': ['not_null']}, {'name': 'mta_tax', 'description': '0.50 MTA tax that is automatically triggered based on the metered rate in use', 'tests': ['unique']}, {'name': 'tip_amount', 'description': 'Tip amount  This field is automatically populated for credit card tips.Cash tips are not included', 'tests': ['not_null']}, {'name': 'tolls_amount', 'description': 'Total amount of all tolls paid in trip', 'tests': ['not_null']}, {'name': 'improvement_surcharge', 'description': '0.30 improvement surcharge assessed trips at the flag drop. the improvement surcharge began being levied in 2015', 'tests': ['not_null']}, {'name': 'total_amount', 'description': 'The total amount charged to passengers. Does not include cash tips.', 'tests': ['not_null']}, {'name': 'payment_type', 'description': 'A numeric code signifying how the passenger paid for the trip', 'tests': ['not_null']}, {'name': 'trip_type', 'description': 'Year of pickup', 'tests': ['not_null']}, {'name': 'congestion_surcharge', 'description': 'An additional charge for trips taken during high traffic congestion times', 'tests': [None]}], 'original_file_path': 'models/tests/schema.yml', 'yaml_key': 'models', 'package_name': 'nyc_taxi'} - at path ['columns'][18]['tests'][0]: None is not valid under any of the given schemas
[2024-11-21T17:36:58.544+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:36:58.554+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 12.130 seconds
[2024-11-21T17:37:28.761+0000] {processor.py:161} INFO - Started process (PID=4045) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:37:28.762+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T17:37:28.763+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:37:28.763+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:37:28.789+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:37:28.789+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T17:37:29.588+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:37:29.588+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 0.7871979890001057
[2024-11-21T17:37:29.589+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:37:29.588+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T17:37:29.589+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:37:29.589+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T17:37:29.592+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:37:29.592+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T17:37:29.598+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:37:29.598+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T17:37:29.604+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:37:29.604+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpfe___hjn --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T17:37:35.174+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:37:35.173+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpfe___hjn --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T17:37:41.338+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:37:41.334+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 210, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpfe___hjn', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
17:37:37  Running with dbt=1.8.7
17:37:38  Registered adapter: bigquery=1.8.3
17:37:39  [WARNING]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
17:37:39  Encountered an error:
Parsing Error
  Invalid models config given in models/tests/schema.yml @ models: {'name': 'fct_trips', 'description': 'Fact Table of tripdata', 'columns': [{'name': 'trip_id', 'description': 'The primary key for this table', 'tests': ['unique']}, {'name': 'vendor_id', 'description': 'A code indicating the TPEP provider that provided the record', 'tests': ['not_null']}, {'name': 'pickup_time_id', 'description': 'id to get pickup time from dim_time', 'tests': ['not_null']}, {'name': 'dropoff_time_id', 'description': 'id to get dropoff time from dim_time', 'tests': ['unique']}, {'name': 'rate_code_id', 'description': 'The final rate code in effect at the end of the trip', 'tests': ['unique']}, {'name': 'pu_location_id', 'description': 'The pickup location', 'tests': ['not_null']}, {'name': 'do_location_id', 'description': 'The droppof location', 'tests': ['not_null']}, {'name': 'passenger_count', 'description': 'Customer count', 'tests': ['unique']}, {'name': 'trip_distance', 'description': 'trip distance', 'tests': ['not_null']}, {'name': 'fare_amount', 'description': 'The time-and-distance fare calculated by the meter.', 'tests': ['not_null']}, {'name': 'extra', 'description': 'Miscellaneous extras and surcharges. Currently, this only includes. the $0.50 and $1 rush hour and overnight charges', 'tests': ['not_null']}, {'name': 'mta_tax', 'description': '0.50 MTA tax that is automatically triggered based on the metered rate in use', 'tests': ['unique']}, {'name': 'tip_amount', 'description': 'Tip amount  This field is automatically populated for credit card tips.Cash tips are not included', 'tests': ['not_null']}, {'name': 'tolls_amount', 'description': 'Total amount of all tolls paid in trip', 'tests': ['not_null']}, {'name': 'improvement_surcharge', 'description': '0.30 improvement surcharge assessed trips at the flag drop. the improvement surcharge began being levied in 2015', 'tests': ['not_null']}, {'name': 'total_amount', 'description': 'The total amount charged to passengers. Does not include cash tips.', 'tests': ['not_null']}, {'name': 'payment_type', 'description': 'A numeric code signifying how the passenger paid for the trip', 'tests': ['not_null']}, {'name': 'trip_type', 'description': 'Year of pickup', 'tests': ['not_null']}, {'name': 'congestion_surcharge', 'description': 'An additional charge for trips taken during high traffic congestion times', 'tests': [None]}], 'original_file_path': 'models/tests/schema.yml', 'yaml_key': 'models', 'package_name': 'nyc_taxi'} - at path ['columns'][18]['tests'][0]: None is not valid under any of the given schemas
[2024-11-21T17:37:41.338+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:37:41.348+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 12.593 seconds
[2024-11-21T17:38:12.262+0000] {processor.py:161} INFO - Started process (PID=4090) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:38:12.263+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T17:38:12.264+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:38:12.264+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:38:12.286+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:38:12.286+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T17:38:13.017+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:38:13.017+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 0.7212596190001932
[2024-11-21T17:38:13.018+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:38:13.018+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T17:38:13.018+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:38:13.018+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T17:38:13.022+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:38:13.022+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T17:38:13.029+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:38:13.028+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T17:38:13.034+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:38:13.034+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp4xd20pdh --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T17:38:16.722+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:38:16.722+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp4xd20pdh --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T17:38:23.070+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:38:23.067+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 210, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmp4xd20pdh', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
17:38:18  Running with dbt=1.8.7
17:38:20  Registered adapter: bigquery=1.8.3
17:38:21  [WARNING]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
17:38:21  Encountered an error:
Parsing Error
  Invalid models config given in models/tests/schema.yml @ models: {'name': 'fct_trips', 'description': 'Fact Table of tripdata', 'columns': [{'name': 'trip_id', 'description': 'The primary key for this table', 'tests': ['unique']}, {'name': 'vendor_id', 'description': 'A code indicating the TPEP provider that provided the record', 'tests': ['not_null']}, {'name': 'pickup_time_id', 'description': 'id to get pickup time from dim_time', 'tests': ['not_null']}, {'name': 'dropoff_time_id', 'description': 'id to get dropoff time from dim_time', 'tests': ['unique']}, {'name': 'rate_code_id', 'description': 'The final rate code in effect at the end of the trip', 'tests': ['unique']}, {'name': 'pu_location_id', 'description': 'The pickup location', 'tests': ['not_null']}, {'name': 'do_location_id', 'description': 'The droppof location', 'tests': ['not_null']}, {'name': 'passenger_count', 'description': 'Customer count', 'tests': ['unique']}, {'name': 'trip_distance', 'description': 'trip distance', 'tests': ['not_null']}, {'name': 'fare_amount', 'description': 'The time-and-distance fare calculated by the meter.', 'tests': ['not_null']}, {'name': 'extra', 'description': 'Miscellaneous extras and surcharges. Currently, this only includes. the $0.50 and $1 rush hour and overnight charges', 'tests': ['not_null']}, {'name': 'mta_tax', 'description': '0.50 MTA tax that is automatically triggered based on the metered rate in use', 'tests': ['unique']}, {'name': 'tip_amount', 'description': 'Tip amount  This field is automatically populated for credit card tips.Cash tips are not included', 'tests': ['not_null']}, {'name': 'tolls_amount', 'description': 'Total amount of all tolls paid in trip', 'tests': ['not_null']}, {'name': 'improvement_surcharge', 'description': '0.30 improvement surcharge assessed trips at the flag drop. the improvement surcharge began being levied in 2015', 'tests': ['not_null']}, {'name': 'total_amount', 'description': 'The total amount charged to passengers. Does not include cash tips.', 'tests': ['not_null']}, {'name': 'payment_type', 'description': 'A numeric code signifying how the passenger paid for the trip', 'tests': ['not_null']}, {'name': 'trip_type', 'description': 'Year of pickup', 'tests': ['not_null']}, {'name': 'congestion_surcharge', 'description': 'An additional charge for trips taken during high traffic congestion times', 'tests': [None]}], 'original_file_path': 'models/tests/schema.yml', 'yaml_key': 'models', 'package_name': 'nyc_taxi'} - at path ['columns'][18]['tests'][0]: None is not valid under any of the given schemas
[2024-11-21T17:38:23.071+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:38:23.081+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 11.822 seconds
[2024-11-21T17:38:53.711+0000] {processor.py:161} INFO - Started process (PID=4142) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:38:53.712+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T17:38:53.713+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:38:53.713+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:38:53.741+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:38:53.740+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T17:38:54.491+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:38:54.491+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 0.7402391349996833
[2024-11-21T17:38:54.492+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:38:54.492+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T17:38:54.492+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:38:54.492+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T17:38:54.500+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:38:54.500+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T17:38:54.507+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:38:54.507+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T17:38:54.514+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:38:54.514+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpvaf36p35 --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T17:38:59.872+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:38:59.872+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpvaf36p35 --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T17:39:06.242+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:39:06.239+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 210, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpvaf36p35', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
17:39:02  Running with dbt=1.8.7
17:39:03  Registered adapter: bigquery=1.8.3
17:39:04  [WARNING]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
17:39:04  Encountered an error:
Parsing Error
  Invalid models config given in models/tests/schema.yml @ models: {'name': 'fct_trips', 'description': 'Fact Table of tripdata', 'columns': [{'name': 'trip_id', 'description': 'The primary key for this table', 'tests': ['unique']}, {'name': 'vendor_id', 'description': 'A code indicating the TPEP provider that provided the record', 'tests': ['not_null']}, {'name': 'pickup_time_id', 'description': 'id to get pickup time from dim_time', 'tests': ['not_null']}, {'name': 'dropoff_time_id', 'description': 'id to get dropoff time from dim_time', 'tests': ['unique']}, {'name': 'rate_code_id', 'description': 'The final rate code in effect at the end of the trip', 'tests': ['unique']}, {'name': 'pu_location_id', 'description': 'The pickup location', 'tests': ['not_null']}, {'name': 'do_location_id', 'description': 'The droppof location', 'tests': ['not_null']}, {'name': 'passenger_count', 'description': 'Customer count', 'tests': ['unique']}, {'name': 'trip_distance', 'description': 'trip distance', 'tests': ['not_null']}, {'name': 'fare_amount', 'description': 'The time-and-distance fare calculated by the meter.', 'tests': ['not_null']}, {'name': 'extra', 'description': 'Miscellaneous extras and surcharges. Currently, this only includes. the $0.50 and $1 rush hour and overnight charges', 'tests': ['not_null']}, {'name': 'mta_tax', 'description': '0.50 MTA tax that is automatically triggered based on the metered rate in use', 'tests': ['unique']}, {'name': 'tip_amount', 'description': 'Tip amount  This field is automatically populated for credit card tips.Cash tips are not included', 'tests': ['not_null']}, {'name': 'tolls_amount', 'description': 'Total amount of all tolls paid in trip', 'tests': ['not_null']}, {'name': 'improvement_surcharge', 'description': '0.30 improvement surcharge assessed trips at the flag drop. the improvement surcharge began being levied in 2015', 'tests': ['not_null']}, {'name': 'total_amount', 'description': 'The total amount charged to passengers. Does not include cash tips.', 'tests': ['not_null']}, {'name': 'payment_type', 'description': 'A numeric code signifying how the passenger paid for the trip', 'tests': ['not_null']}, {'name': 'trip_type', 'description': 'Year of pickup', 'tests': ['not_null']}, {'name': 'congestion_surcharge', 'description': 'An additional charge for trips taken during high traffic congestion times', 'tests': [None]}], 'original_file_path': 'models/tests/schema.yml', 'yaml_key': 'models', 'package_name': 'nyc_taxi'} - at path ['columns'][18]['tests'][0]: None is not valid under any of the given schemas
[2024-11-21T17:39:06.243+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:39:06.259+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 12.555 seconds
[2024-11-21T17:39:37.221+0000] {processor.py:161} INFO - Started process (PID=4187) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:39:37.222+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T17:39:37.224+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:39:37.223+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:39:37.247+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:39:37.247+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T17:39:38.031+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:39:38.031+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 0.7736494729997503
[2024-11-21T17:39:38.032+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:39:38.032+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T17:39:38.032+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:39:38.032+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T17:39:38.036+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:39:38.036+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T17:39:38.043+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:39:38.043+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T17:39:38.049+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:39:38.049+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmppjp668i4 --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T17:39:43.302+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:39:43.302+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmppjp668i4 --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T17:39:49.492+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:39:49.488+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 210, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmppjp668i4', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
17:39:45  Running with dbt=1.8.7
17:39:46  Registered adapter: bigquery=1.8.3
17:39:47  [WARNING]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
17:39:47  Encountered an error:
Parsing Error
  Invalid models config given in models/tests/schema.yml @ models: {'name': 'fct_trips', 'description': 'Fact Table of tripdata', 'columns': [{'name': 'trip_id', 'description': 'The primary key for this table', 'tests': ['unique']}, {'name': 'vendor_id', 'description': 'A code indicating the TPEP provider that provided the record', 'tests': ['not_null']}, {'name': 'pickup_time_id', 'description': 'id to get pickup time from dim_time', 'tests': ['not_null']}, {'name': 'dropoff_time_id', 'description': 'id to get dropoff time from dim_time', 'tests': ['unique']}, {'name': 'rate_code_id', 'description': 'The final rate code in effect at the end of the trip', 'tests': ['unique']}, {'name': 'pu_location_id', 'description': 'The pickup location', 'tests': ['not_null']}, {'name': 'do_location_id', 'description': 'The droppof location', 'tests': ['not_null']}, {'name': 'passenger_count', 'description': 'Customer count', 'tests': ['unique']}, {'name': 'trip_distance', 'description': 'trip distance', 'tests': ['not_null']}, {'name': 'fare_amount', 'description': 'The time-and-distance fare calculated by the meter.', 'tests': ['not_null']}, {'name': 'extra', 'description': 'Miscellaneous extras and surcharges. Currently, this only includes. the $0.50 and $1 rush hour and overnight charges', 'tests': ['not_null']}, {'name': 'mta_tax', 'description': '0.50 MTA tax that is automatically triggered based on the metered rate in use', 'tests': ['unique']}, {'name': 'tip_amount', 'description': 'Tip amount  This field is automatically populated for credit card tips.Cash tips are not included', 'tests': ['not_null']}, {'name': 'tolls_amount', 'description': 'Total amount of all tolls paid in trip', 'tests': ['not_null']}, {'name': 'improvement_surcharge', 'description': '0.30 improvement surcharge assessed trips at the flag drop. the improvement surcharge began being levied in 2015', 'tests': ['not_null']}, {'name': 'total_amount', 'description': 'The total amount charged to passengers. Does not include cash tips.', 'tests': ['not_null']}, {'name': 'payment_type', 'description': 'A numeric code signifying how the passenger paid for the trip', 'tests': ['not_null']}, {'name': 'trip_type', 'description': 'Year of pickup', 'tests': ['not_null']}, {'name': 'congestion_surcharge', 'description': 'An additional charge for trips taken during high traffic congestion times', 'tests': [None]}], 'original_file_path': 'models/tests/schema.yml', 'yaml_key': 'models', 'package_name': 'nyc_taxi'} - at path ['columns'][18]['tests'][0]: None is not valid under any of the given schemas
[2024-11-21T17:39:49.493+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:39:49.503+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 13.350 seconds
[2024-11-21T17:40:19.765+0000] {processor.py:161} INFO - Started process (PID=4239) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:40:19.766+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T17:40:19.767+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:40:19.767+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:40:19.791+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:40:19.790+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T17:40:20.522+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:40:20.522+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 0.7212195730007807
[2024-11-21T17:40:20.523+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:40:20.523+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T17:40:20.523+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:40:20.523+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T17:40:20.527+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:40:20.527+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T17:40:20.535+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:40:20.535+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T17:40:20.541+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:40:20.541+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpqu4gpo7v --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T17:40:25.694+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:40:25.693+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpqu4gpo7v --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T17:40:31.838+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:40:31.834+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 210, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpqu4gpo7v', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
17:40:27  Running with dbt=1.8.7
17:40:29  Registered adapter: bigquery=1.8.3
17:40:30  [WARNING]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
17:40:30  Encountered an error:
Parsing Error
  Invalid models config given in models/tests/schema.yml @ models: {'name': 'fct_trips', 'description': 'Fact Table of tripdata', 'columns': [{'name': 'trip_id', 'description': 'The primary key for this table', 'tests': ['unique']}, {'name': 'vendor_id', 'description': 'A code indicating the TPEP provider that provided the record', 'tests': ['not_null']}, {'name': 'pickup_time_id', 'description': 'id to get pickup time from dim_time', 'tests': ['not_null']}, {'name': 'dropoff_time_id', 'description': 'id to get dropoff time from dim_time', 'tests': ['unique']}, {'name': 'rate_code_id', 'description': 'The final rate code in effect at the end of the trip', 'tests': ['unique']}, {'name': 'pu_location_id', 'description': 'The pickup location', 'tests': ['not_null']}, {'name': 'do_location_id', 'description': 'The droppof location', 'tests': ['not_null']}, {'name': 'passenger_count', 'description': 'Customer count', 'tests': ['unique']}, {'name': 'trip_distance', 'description': 'trip distance', 'tests': ['not_null']}, {'name': 'fare_amount', 'description': 'The time-and-distance fare calculated by the meter.', 'tests': ['not_null']}, {'name': 'extra', 'description': 'Miscellaneous extras and surcharges. Currently, this only includes. the $0.50 and $1 rush hour and overnight charges', 'tests': ['not_null']}, {'name': 'mta_tax', 'description': '0.50 MTA tax that is automatically triggered based on the metered rate in use', 'tests': ['unique']}, {'name': 'tip_amount', 'description': 'Tip amount  This field is automatically populated for credit card tips.Cash tips are not included', 'tests': ['not_null']}, {'name': 'tolls_amount', 'description': 'Total amount of all tolls paid in trip', 'tests': ['not_null']}, {'name': 'improvement_surcharge', 'description': '0.30 improvement surcharge assessed trips at the flag drop. the improvement surcharge began being levied in 2015', 'tests': ['not_null']}, {'name': 'total_amount', 'description': 'The total amount charged to passengers. Does not include cash tips.', 'tests': ['not_null']}, {'name': 'payment_type', 'description': 'A numeric code signifying how the passenger paid for the trip', 'tests': ['not_null']}, {'name': 'trip_type', 'description': 'Year of pickup', 'tests': ['not_null']}, {'name': 'congestion_surcharge', 'description': 'An additional charge for trips taken during high traffic congestion times', 'tests': [None]}], 'original_file_path': 'models/tests/schema.yml', 'yaml_key': 'models', 'package_name': 'nyc_taxi'} - at path ['columns'][18]['tests'][0]: None is not valid under any of the given schemas
[2024-11-21T17:40:31.838+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:40:31.853+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 12.093 seconds
[2024-11-21T17:41:02.157+0000] {processor.py:161} INFO - Started process (PID=4284) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:41:02.158+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T17:41:02.160+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:41:02.159+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:41:02.182+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:41:02.181+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T17:41:02.924+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:41:02.924+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 0.7321432380003898
[2024-11-21T17:41:02.924+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:41:02.924+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T17:41:02.925+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:41:02.925+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T17:41:02.929+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:41:02.929+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T17:41:02.935+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:41:02.935+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T17:41:02.941+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:41:02.941+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpeco74r23 --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T17:41:07.542+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:41:07.542+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpeco74r23 --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T17:41:13.034+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:41:13.030+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 210, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpeco74r23', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
17:41:08  Running with dbt=1.8.7
17:41:10  Registered adapter: bigquery=1.8.3
17:41:11  [WARNING]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
17:41:11  Encountered an error:
Parsing Error
  Invalid models config given in models/tests/schema.yml @ models: {'name': 'fct_trips', 'description': 'Fact Table of tripdata', 'columns': [{'name': 'trip_id', 'description': 'The primary key for this table', 'tests': ['unique']}, {'name': 'vendor_id', 'description': 'A code indicating the TPEP provider that provided the record', 'tests': ['not_null']}, {'name': 'pickup_time_id', 'description': 'id to get pickup time from dim_time', 'tests': ['not_null']}, {'name': 'dropoff_time_id', 'description': 'id to get dropoff time from dim_time', 'tests': ['unique']}, {'name': 'rate_code_id', 'description': 'The final rate code in effect at the end of the trip', 'tests': ['unique']}, {'name': 'pu_location_id', 'description': 'The pickup location', 'tests': ['not_null']}, {'name': 'do_location_id', 'description': 'The droppof location', 'tests': ['not_null']}, {'name': 'passenger_count', 'description': 'Customer count', 'tests': ['unique']}, {'name': 'trip_distance', 'description': 'trip distance', 'tests': ['not_null']}, {'name': 'fare_amount', 'description': 'The time-and-distance fare calculated by the meter.', 'tests': ['not_null']}, {'name': 'extra', 'description': 'Miscellaneous extras and surcharges. Currently, this only includes. the $0.50 and $1 rush hour and overnight charges', 'tests': ['not_null']}, {'name': 'mta_tax', 'description': '0.50 MTA tax that is automatically triggered based on the metered rate in use', 'tests': ['unique']}, {'name': 'tip_amount', 'description': 'Tip amount  This field is automatically populated for credit card tips.Cash tips are not included', 'tests': ['not_null']}, {'name': 'tolls_amount', 'description': 'Total amount of all tolls paid in trip', 'tests': ['not_null']}, {'name': 'improvement_surcharge', 'description': '0.30 improvement surcharge assessed trips at the flag drop. the improvement surcharge began being levied in 2015', 'tests': ['not_null']}, {'name': 'total_amount', 'description': 'The total amount charged to passengers. Does not include cash tips.', 'tests': ['not_null']}, {'name': 'payment_type', 'description': 'A numeric code signifying how the passenger paid for the trip', 'tests': ['not_null']}, {'name': 'trip_type', 'description': 'Year of pickup', 'tests': ['not_null']}, {'name': 'congestion_surcharge', 'description': 'An additional charge for trips taken during high traffic congestion times', 'tests': [None]}], 'original_file_path': 'models/tests/schema.yml', 'yaml_key': 'models', 'package_name': 'nyc_taxi'} - at path ['columns'][18]['tests'][0]: None is not valid under any of the given schemas
[2024-11-21T17:41:13.034+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:41:13.044+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 11.935 seconds
[2024-11-21T17:41:43.280+0000] {processor.py:161} INFO - Started process (PID=4335) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:41:43.281+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T17:41:43.283+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:41:43.283+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:41:43.307+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:41:43.307+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T17:41:44.162+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:41:44.162+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 0.8425299809996432
[2024-11-21T17:41:44.163+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:41:44.162+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T17:41:44.163+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:41:44.163+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T17:41:44.167+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:41:44.167+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T17:41:44.174+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:41:44.174+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T17:41:44.180+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:41:44.180+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp0xw_0rv1 --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T17:41:49.518+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:41:49.518+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp0xw_0rv1 --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T17:41:55.867+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:41:55.864+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 210, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmp0xw_0rv1', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
17:41:51  Running with dbt=1.8.7
17:41:53  Registered adapter: bigquery=1.8.3
17:41:54  [WARNING]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
17:41:54  Encountered an error:
Parsing Error
  Invalid models config given in models/tests/schema.yml @ models: {'name': 'fct_trips', 'description': 'Fact Table of tripdata', 'columns': [{'name': 'trip_id', 'description': 'The primary key for this table', 'tests': ['unique']}, {'name': 'vendor_id', 'description': 'A code indicating the TPEP provider that provided the record', 'tests': ['not_null']}, {'name': 'pickup_time_id', 'description': 'id to get pickup time from dim_time', 'tests': ['not_null']}, {'name': 'dropoff_time_id', 'description': 'id to get dropoff time from dim_time', 'tests': ['unique']}, {'name': 'rate_code_id', 'description': 'The final rate code in effect at the end of the trip', 'tests': ['unique']}, {'name': 'pu_location_id', 'description': 'The pickup location', 'tests': ['not_null']}, {'name': 'do_location_id', 'description': 'The droppof location', 'tests': ['not_null']}, {'name': 'passenger_count', 'description': 'Customer count', 'tests': ['unique']}, {'name': 'trip_distance', 'description': 'trip distance', 'tests': ['not_null']}, {'name': 'fare_amount', 'description': 'The time-and-distance fare calculated by the meter.', 'tests': ['not_null']}, {'name': 'extra', 'description': 'Miscellaneous extras and surcharges. Currently, this only includes. the $0.50 and $1 rush hour and overnight charges', 'tests': ['not_null']}, {'name': 'mta_tax', 'description': '0.50 MTA tax that is automatically triggered based on the metered rate in use', 'tests': ['unique']}, {'name': 'tip_amount', 'description': 'Tip amount  This field is automatically populated for credit card tips.Cash tips are not included', 'tests': ['not_null']}, {'name': 'tolls_amount', 'description': 'Total amount of all tolls paid in trip', 'tests': ['not_null']}, {'name': 'improvement_surcharge', 'description': '0.30 improvement surcharge assessed trips at the flag drop. the improvement surcharge began being levied in 2015', 'tests': ['not_null']}, {'name': 'total_amount', 'description': 'The total amount charged to passengers. Does not include cash tips.', 'tests': ['not_null']}, {'name': 'payment_type', 'description': 'A numeric code signifying how the passenger paid for the trip', 'tests': ['not_null']}, {'name': 'trip_type', 'description': 'Year of pickup', 'tests': ['not_null']}, {'name': 'congestion_surcharge', 'description': 'An additional charge for trips taken during high traffic congestion times', 'tests': [None]}], 'original_file_path': 'models/tests/schema.yml', 'yaml_key': 'models', 'package_name': 'nyc_taxi'} - at path ['columns'][18]['tests'][0]: None is not valid under any of the given schemas
[2024-11-21T17:41:55.867+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:41:55.883+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 12.610 seconds
[2024-11-21T17:42:26.766+0000] {processor.py:161} INFO - Started process (PID=4381) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:42:26.767+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T17:42:26.768+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:42:26.768+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:42:26.790+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:42:26.789+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T17:42:27.573+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:42:27.573+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 0.7719561539997812
[2024-11-21T17:42:27.574+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:42:27.573+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T17:42:27.574+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:42:27.574+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T17:42:27.578+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:42:27.578+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T17:42:27.584+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:42:27.584+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T17:42:27.590+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:42:27.590+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpakfufmdj --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T17:42:32.116+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:42:32.115+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpakfufmdj --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T17:42:37.248+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:42:37.245+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 210, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpakfufmdj', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
17:42:34  Running with dbt=1.8.7
17:42:34  Registered adapter: bigquery=1.8.3
17:42:35  [WARNING]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
17:42:35  Encountered an error:
Parsing Error
  Invalid models config given in models/tests/schema.yml @ models: {'name': 'fct_trips', 'description': 'Fact Table of tripdata', 'columns': [{'name': 'trip_id', 'description': 'The primary key for this table', 'tests': ['unique']}, {'name': 'vendor_id', 'description': 'A code indicating the TPEP provider that provided the record', 'tests': ['not_null']}, {'name': 'pickup_time_id', 'description': 'id to get pickup time from dim_time', 'tests': ['not_null']}, {'name': 'dropoff_time_id', 'description': 'id to get dropoff time from dim_time', 'tests': ['unique']}, {'name': 'rate_code_id', 'description': 'The final rate code in effect at the end of the trip', 'tests': ['unique']}, {'name': 'pu_location_id', 'description': 'The pickup location', 'tests': ['not_null']}, {'name': 'do_location_id', 'description': 'The droppof location', 'tests': ['not_null']}, {'name': 'passenger_count', 'description': 'Customer count', 'tests': ['unique']}, {'name': 'trip_distance', 'description': 'trip distance', 'tests': ['not_null']}, {'name': 'fare_amount', 'description': 'The time-and-distance fare calculated by the meter.', 'tests': ['not_null']}, {'name': 'extra', 'description': 'Miscellaneous extras and surcharges. Currently, this only includes. the $0.50 and $1 rush hour and overnight charges', 'tests': ['not_null']}, {'name': 'mta_tax', 'description': '0.50 MTA tax that is automatically triggered based on the metered rate in use', 'tests': ['unique']}, {'name': 'tip_amount', 'description': 'Tip amount  This field is automatically populated for credit card tips.Cash tips are not included', 'tests': ['not_null']}, {'name': 'tolls_amount', 'description': 'Total amount of all tolls paid in trip', 'tests': ['not_null']}, {'name': 'improvement_surcharge', 'description': '0.30 improvement surcharge assessed trips at the flag drop. the improvement surcharge began being levied in 2015', 'tests': ['not_null']}, {'name': 'total_amount', 'description': 'The total amount charged to passengers. Does not include cash tips.', 'tests': ['not_null']}, {'name': 'payment_type', 'description': 'A numeric code signifying how the passenger paid for the trip', 'tests': ['not_null']}, {'name': 'trip_type', 'description': 'Year of pickup', 'tests': ['not_null']}, {'name': 'congestion_surcharge', 'description': 'An additional charge for trips taken during high traffic congestion times', 'tests': [None]}], 'original_file_path': 'models/tests/schema.yml', 'yaml_key': 'models', 'package_name': 'nyc_taxi'} - at path ['columns'][18]['tests'][0]: None is not valid under any of the given schemas
[2024-11-21T17:42:37.249+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:42:37.265+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 11.578 seconds
[2024-11-21T17:43:08.085+0000] {processor.py:161} INFO - Started process (PID=4432) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:43:08.085+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T17:43:08.087+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:43:08.086+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:43:08.107+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:43:08.107+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T17:43:08.836+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:43:08.836+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 0.7188730919997397
[2024-11-21T17:43:08.837+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:43:08.837+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T17:43:08.837+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:43:08.837+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T17:43:08.841+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:43:08.841+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T17:43:08.847+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:43:08.846+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T17:43:08.853+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:43:08.853+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpwv6ux_8j --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T17:43:13.957+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:43:13.956+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpwv6ux_8j --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T17:43:20.483+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:43:20.480+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 210, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpwv6ux_8j', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
17:43:16  Running with dbt=1.8.7
17:43:17  Registered adapter: bigquery=1.8.3
17:43:18  [WARNING]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
17:43:18  Encountered an error:
Parsing Error
  Invalid models config given in models/tests/schema.yml @ models: {'name': 'fct_trips', 'description': 'Fact Table of tripdata', 'columns': [{'name': 'trip_id', 'description': 'The primary key for this table', 'tests': ['unique']}, {'name': 'vendor_id', 'description': 'A code indicating the TPEP provider that provided the record', 'tests': ['not_null']}, {'name': 'pickup_time_id', 'description': 'id to get pickup time from dim_time', 'tests': ['not_null']}, {'name': 'dropoff_time_id', 'description': 'id to get dropoff time from dim_time', 'tests': ['unique']}, {'name': 'rate_code_id', 'description': 'The final rate code in effect at the end of the trip', 'tests': ['unique']}, {'name': 'pu_location_id', 'description': 'The pickup location', 'tests': ['not_null']}, {'name': 'do_location_id', 'description': 'The droppof location', 'tests': ['not_null']}, {'name': 'passenger_count', 'description': 'Customer count', 'tests': ['unique']}, {'name': 'trip_distance', 'description': 'trip distance', 'tests': ['not_null']}, {'name': 'fare_amount', 'description': 'The time-and-distance fare calculated by the meter.', 'tests': ['not_null']}, {'name': 'extra', 'description': 'Miscellaneous extras and surcharges. Currently, this only includes. the $0.50 and $1 rush hour and overnight charges', 'tests': ['not_null']}, {'name': 'mta_tax', 'description': '0.50 MTA tax that is automatically triggered based on the metered rate in use', 'tests': ['unique']}, {'name': 'tip_amount', 'description': 'Tip amount  This field is automatically populated for credit card tips.Cash tips are not included', 'tests': ['not_null']}, {'name': 'tolls_amount', 'description': 'Total amount of all tolls paid in trip', 'tests': ['not_null']}, {'name': 'improvement_surcharge', 'description': '0.30 improvement surcharge assessed trips at the flag drop. the improvement surcharge began being levied in 2015', 'tests': ['not_null']}, {'name': 'total_amount', 'description': 'The total amount charged to passengers. Does not include cash tips.', 'tests': ['not_null']}, {'name': 'payment_type', 'description': 'A numeric code signifying how the passenger paid for the trip', 'tests': ['not_null']}, {'name': 'trip_type', 'description': 'Year of pickup', 'tests': ['not_null']}, {'name': 'congestion_surcharge', 'description': 'An additional charge for trips taken during high traffic congestion times', 'tests': [None]}], 'original_file_path': 'models/tests/schema.yml', 'yaml_key': 'models', 'package_name': 'nyc_taxi'} - at path ['columns'][18]['tests'][0]: None is not valid under any of the given schemas
[2024-11-21T17:43:20.484+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:43:20.494+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 12.414 seconds
[2024-11-21T17:43:50.544+0000] {processor.py:161} INFO - Started process (PID=4477) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:43:50.545+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T17:43:50.546+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:43:50.546+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:43:50.569+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:43:50.569+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T17:43:51.344+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:43:51.343+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 0.7638169499996366
[2024-11-21T17:43:51.344+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:43:51.344+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T17:43:51.344+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:43:51.344+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T17:43:51.348+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:43:51.348+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T17:43:51.354+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:43:51.354+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T17:43:51.360+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:43:51.359+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp7wt5jzqw --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T17:43:56.348+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:43:56.347+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp7wt5jzqw --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T17:44:01.690+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:44:01.686+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 210, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmp7wt5jzqw', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
17:43:58  Running with dbt=1.8.7
17:44:00  Registered adapter: bigquery=1.8.3
17:44:01  [WARNING]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
17:44:01  Encountered an error:
Parsing Error
  Invalid models config given in models/tests/schema.yml @ models: {'name': 'fct_trips', 'description': 'Fact Table of tripdata', 'columns': [{'name': 'trip_id', 'description': 'The primary key for this table', 'tests': ['unique']}, {'name': 'vendor_id', 'description': 'A code indicating the TPEP provider that provided the record', 'tests': ['not_null']}, {'name': 'pickup_time_id', 'description': 'id to get pickup time from dim_time', 'tests': ['not_null']}, {'name': 'dropoff_time_id', 'description': 'id to get dropoff time from dim_time', 'tests': ['unique']}, {'name': 'rate_code_id', 'description': 'The final rate code in effect at the end of the trip', 'tests': ['unique']}, {'name': 'pu_location_id', 'description': 'The pickup location', 'tests': ['not_null']}, {'name': 'do_location_id', 'description': 'The droppof location', 'tests': ['not_null']}, {'name': 'passenger_count', 'description': 'Customer count', 'tests': ['unique']}, {'name': 'trip_distance', 'description': 'trip distance', 'tests': ['not_null']}, {'name': 'fare_amount', 'description': 'The time-and-distance fare calculated by the meter.', 'tests': ['not_null']}, {'name': 'extra', 'description': 'Miscellaneous extras and surcharges. Currently, this only includes. the $0.50 and $1 rush hour and overnight charges', 'tests': ['not_null']}, {'name': 'mta_tax', 'description': '0.50 MTA tax that is automatically triggered based on the metered rate in use', 'tests': ['unique']}, {'name': 'tip_amount', 'description': 'Tip amount  This field is automatically populated for credit card tips.Cash tips are not included', 'tests': ['not_null']}, {'name': 'tolls_amount', 'description': 'Total amount of all tolls paid in trip', 'tests': ['not_null']}, {'name': 'improvement_surcharge', 'description': '0.30 improvement surcharge assessed trips at the flag drop. the improvement surcharge began being levied in 2015', 'tests': ['not_null']}, {'name': 'total_amount', 'description': 'The total amount charged to passengers. Does not include cash tips.', 'tests': ['not_null']}, {'name': 'payment_type', 'description': 'A numeric code signifying how the passenger paid for the trip', 'tests': ['not_null']}, {'name': 'trip_type', 'description': 'Year of pickup', 'tests': ['not_null']}, {'name': 'congestion_surcharge', 'description': 'An additional charge for trips taken during high traffic congestion times', 'tests': [None]}], 'original_file_path': 'models/tests/schema.yml', 'yaml_key': 'models', 'package_name': 'nyc_taxi'} - at path ['columns'][18]['tests'][0]: None is not valid under any of the given schemas
[2024-11-21T17:44:01.691+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:44:01.706+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 12.253 seconds
[2024-11-21T17:44:31.881+0000] {processor.py:161} INFO - Started process (PID=4523) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:44:31.881+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T17:44:31.883+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:44:31.883+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:44:31.906+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:44:31.905+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T17:44:32.693+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:44:32.693+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 0.7775804719994994
[2024-11-21T17:44:32.694+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:44:32.694+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T17:44:32.694+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:44:32.694+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T17:44:32.699+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:44:32.699+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T17:44:32.705+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:44:32.705+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T17:44:32.710+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:44:32.710+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpyy8quhbt --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T17:44:37.768+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:44:37.767+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpyy8quhbt --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T17:44:43.971+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:44:43.968+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 210, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpyy8quhbt', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
17:44:39  Running with dbt=1.8.7
17:44:41  Registered adapter: bigquery=1.8.3
17:44:42  [WARNING]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
17:44:42  Encountered an error:
Parsing Error
  Invalid models config given in models/tests/schema.yml @ models: {'name': 'fct_trips', 'description': 'Fact Table of tripdata', 'columns': [{'name': 'trip_id', 'description': 'The primary key for this table', 'tests': ['unique']}, {'name': 'vendor_id', 'description': 'A code indicating the TPEP provider that provided the record', 'tests': ['not_null']}, {'name': 'pickup_time_id', 'description': 'id to get pickup time from dim_time', 'tests': ['not_null']}, {'name': 'dropoff_time_id', 'description': 'id to get dropoff time from dim_time', 'tests': ['unique']}, {'name': 'rate_code_id', 'description': 'The final rate code in effect at the end of the trip', 'tests': ['unique']}, {'name': 'pu_location_id', 'description': 'The pickup location', 'tests': ['not_null']}, {'name': 'do_location_id', 'description': 'The droppof location', 'tests': ['not_null']}, {'name': 'passenger_count', 'description': 'Customer count', 'tests': ['unique']}, {'name': 'trip_distance', 'description': 'trip distance', 'tests': ['not_null']}, {'name': 'fare_amount', 'description': 'The time-and-distance fare calculated by the meter.', 'tests': ['not_null']}, {'name': 'extra', 'description': 'Miscellaneous extras and surcharges. Currently, this only includes. the $0.50 and $1 rush hour and overnight charges', 'tests': ['not_null']}, {'name': 'mta_tax', 'description': '0.50 MTA tax that is automatically triggered based on the metered rate in use', 'tests': ['unique']}, {'name': 'tip_amount', 'description': 'Tip amount  This field is automatically populated for credit card tips.Cash tips are not included', 'tests': ['not_null']}, {'name': 'tolls_amount', 'description': 'Total amount of all tolls paid in trip', 'tests': ['not_null']}, {'name': 'improvement_surcharge', 'description': '0.30 improvement surcharge assessed trips at the flag drop. the improvement surcharge began being levied in 2015', 'tests': ['not_null']}, {'name': 'total_amount', 'description': 'The total amount charged to passengers. Does not include cash tips.', 'tests': ['not_null']}, {'name': 'payment_type', 'description': 'A numeric code signifying how the passenger paid for the trip', 'tests': ['not_null']}, {'name': 'trip_type', 'description': 'Year of pickup', 'tests': ['not_null']}, {'name': 'congestion_surcharge', 'description': 'An additional charge for trips taken during high traffic congestion times', 'tests': [None]}], 'original_file_path': 'models/tests/schema.yml', 'yaml_key': 'models', 'package_name': 'nyc_taxi'} - at path ['columns'][18]['tests'][0]: None is not valid under any of the given schemas
[2024-11-21T17:44:43.971+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:44:43.987+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 12.111 seconds
[2024-11-21T17:45:14.286+0000] {processor.py:161} INFO - Started process (PID=4574) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:45:14.286+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T17:45:14.288+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:45:14.287+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:45:14.309+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:45:14.309+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T17:45:15.033+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:45:15.032+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 0.7133168059999662
[2024-11-21T17:45:15.034+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:45:15.033+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T17:45:15.034+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:45:15.034+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T17:45:15.038+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:45:15.038+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T17:45:15.047+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:45:15.047+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T17:45:15.053+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:45:15.053+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp0r5uxwon --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T17:45:20.937+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:45:20.937+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp0r5uxwon --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T17:45:27.046+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:45:27.042+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 210, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmp0r5uxwon', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
17:45:23  Running with dbt=1.8.7
17:45:24  Registered adapter: bigquery=1.8.3
17:45:25  [WARNING]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
17:45:25  Encountered an error:
Parsing Error
  Invalid models config given in models/tests/schema.yml @ models: {'name': 'fct_trips', 'description': 'Fact Table of tripdata', 'columns': [{'name': 'trip_id', 'description': 'The primary key for this table', 'tests': ['unique']}, {'name': 'vendor_id', 'description': 'A code indicating the TPEP provider that provided the record', 'tests': ['not_null']}, {'name': 'pickup_time_id', 'description': 'id to get pickup time from dim_time', 'tests': ['not_null']}, {'name': 'dropoff_time_id', 'description': 'id to get dropoff time from dim_time', 'tests': ['unique']}, {'name': 'rate_code_id', 'description': 'The final rate code in effect at the end of the trip', 'tests': ['unique']}, {'name': 'pu_location_id', 'description': 'The pickup location', 'tests': ['not_null']}, {'name': 'do_location_id', 'description': 'The droppof location', 'tests': ['not_null']}, {'name': 'passenger_count', 'description': 'Customer count', 'tests': ['unique']}, {'name': 'trip_distance', 'description': 'trip distance', 'tests': ['not_null']}, {'name': 'fare_amount', 'description': 'The time-and-distance fare calculated by the meter.', 'tests': ['not_null']}, {'name': 'extra', 'description': 'Miscellaneous extras and surcharges. Currently, this only includes. the $0.50 and $1 rush hour and overnight charges', 'tests': ['not_null']}, {'name': 'mta_tax', 'description': '0.50 MTA tax that is automatically triggered based on the metered rate in use', 'tests': ['unique']}, {'name': 'tip_amount', 'description': 'Tip amount  This field is automatically populated for credit card tips.Cash tips are not included', 'tests': ['not_null']}, {'name': 'tolls_amount', 'description': 'Total amount of all tolls paid in trip', 'tests': ['not_null']}, {'name': 'improvement_surcharge', 'description': '0.30 improvement surcharge assessed trips at the flag drop. the improvement surcharge began being levied in 2015', 'tests': ['not_null']}, {'name': 'total_amount', 'description': 'The total amount charged to passengers. Does not include cash tips.', 'tests': ['not_null']}, {'name': 'payment_type', 'description': 'A numeric code signifying how the passenger paid for the trip', 'tests': ['not_null']}, {'name': 'trip_type', 'description': 'Year of pickup', 'tests': ['not_null']}, {'name': 'congestion_surcharge', 'description': 'An additional charge for trips taken during high traffic congestion times', 'tests': [None]}], 'original_file_path': 'models/tests/schema.yml', 'yaml_key': 'models', 'package_name': 'nyc_taxi'} - at path ['columns'][18]['tests'][0]: None is not valid under any of the given schemas
[2024-11-21T17:45:27.047+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:45:27.059+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 12.779 seconds
[2024-11-21T17:45:57.684+0000] {processor.py:161} INFO - Started process (PID=4620) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:45:57.684+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T17:45:57.686+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:45:57.686+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:45:57.708+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:45:57.708+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T17:45:57.386+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:45:57.386+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 0.7215200500004357
[2024-11-21T17:45:57.386+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:45:57.386+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T17:45:57.387+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:45:57.387+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T17:45:57.390+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:45:57.390+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T17:45:57.397+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:45:57.396+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T17:45:57.402+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:45:57.402+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpsid_qen2 --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T17:46:02.473+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:46:02.473+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpsid_qen2 --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T17:46:08.667+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:46:08.664+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 210, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpsid_qen2', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
17:46:04  Running with dbt=1.8.7
17:46:06  Registered adapter: bigquery=1.8.3
17:46:06  [WARNING]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
17:46:06  Encountered an error:
Parsing Error
  Invalid models config given in models/tests/schema.yml @ models: {'name': 'fct_trips', 'description': 'Fact Table of tripdata', 'columns': [{'name': 'trip_id', 'description': 'The primary key for this table', 'tests': ['unique']}, {'name': 'vendor_id', 'description': 'A code indicating the TPEP provider that provided the record', 'tests': ['not_null']}, {'name': 'pickup_time_id', 'description': 'id to get pickup time from dim_time', 'tests': ['not_null']}, {'name': 'dropoff_time_id', 'description': 'id to get dropoff time from dim_time', 'tests': ['unique']}, {'name': 'rate_code_id', 'description': 'The final rate code in effect at the end of the trip', 'tests': ['unique']}, {'name': 'pu_location_id', 'description': 'The pickup location', 'tests': ['not_null']}, {'name': 'do_location_id', 'description': 'The droppof location', 'tests': ['not_null']}, {'name': 'passenger_count', 'description': 'Customer count', 'tests': ['unique']}, {'name': 'trip_distance', 'description': 'trip distance', 'tests': ['not_null']}, {'name': 'fare_amount', 'description': 'The time-and-distance fare calculated by the meter.', 'tests': ['not_null']}, {'name': 'extra', 'description': 'Miscellaneous extras and surcharges. Currently, this only includes. the $0.50 and $1 rush hour and overnight charges', 'tests': ['not_null']}, {'name': 'mta_tax', 'description': '0.50 MTA tax that is automatically triggered based on the metered rate in use', 'tests': ['unique']}, {'name': 'tip_amount', 'description': 'Tip amount  This field is automatically populated for credit card tips.Cash tips are not included', 'tests': ['not_null']}, {'name': 'tolls_amount', 'description': 'Total amount of all tolls paid in trip', 'tests': ['not_null']}, {'name': 'improvement_surcharge', 'description': '0.30 improvement surcharge assessed trips at the flag drop. the improvement surcharge began being levied in 2015', 'tests': ['not_null']}, {'name': 'total_amount', 'description': 'The total amount charged to passengers. Does not include cash tips.', 'tests': ['not_null']}, {'name': 'payment_type', 'description': 'A numeric code signifying how the passenger paid for the trip', 'tests': ['not_null']}, {'name': 'trip_type', 'description': 'Year of pickup', 'tests': ['not_null']}, {'name': 'congestion_surcharge', 'description': 'An additional charge for trips taken during high traffic congestion times', 'tests': [None]}], 'original_file_path': 'models/tests/schema.yml', 'yaml_key': 'models', 'package_name': 'nyc_taxi'} - at path ['columns'][18]['tests'][0]: None is not valid under any of the given schemas
[2024-11-21T17:46:08.668+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:46:08.678+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 12.053 seconds
[2024-11-21T17:46:38.895+0000] {processor.py:161} INFO - Started process (PID=4671) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:46:38.896+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T17:46:38.897+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:46:38.897+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:46:38.921+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:46:38.921+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T17:46:39.672+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:46:39.672+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 0.7404473410006176
[2024-11-21T17:46:39.673+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:46:39.673+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T17:46:39.673+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:46:39.673+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T17:46:39.678+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:46:39.677+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T17:46:39.685+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:46:39.684+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T17:46:39.690+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:46:39.690+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpxu8m53v3 --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T17:46:44.415+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:46:44.415+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpxu8m53v3 --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T17:46:50.726+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:46:50.723+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 210, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpxu8m53v3', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
17:46:46  Running with dbt=1.8.7
17:46:48  Registered adapter: bigquery=1.8.3
17:46:48  [WARNING]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
17:46:48  Encountered an error:
Parsing Error
  Invalid models config given in models/tests/schema.yml @ models: {'name': 'fct_trips', 'description': 'Fact Table of tripdata', 'columns': [{'name': 'trip_id', 'description': 'The primary key for this table', 'tests': ['unique']}, {'name': 'vendor_id', 'description': 'A code indicating the TPEP provider that provided the record', 'tests': ['not_null']}, {'name': 'pickup_time_id', 'description': 'id to get pickup time from dim_time', 'tests': ['not_null']}, {'name': 'dropoff_time_id', 'description': 'id to get dropoff time from dim_time', 'tests': ['unique']}, {'name': 'rate_code_id', 'description': 'The final rate code in effect at the end of the trip', 'tests': ['unique']}, {'name': 'pu_location_id', 'description': 'The pickup location', 'tests': ['not_null']}, {'name': 'do_location_id', 'description': 'The droppof location', 'tests': ['not_null']}, {'name': 'passenger_count', 'description': 'Customer count', 'tests': ['unique']}, {'name': 'trip_distance', 'description': 'trip distance', 'tests': ['not_null']}, {'name': 'fare_amount', 'description': 'The time-and-distance fare calculated by the meter.', 'tests': ['not_null']}, {'name': 'extra', 'description': 'Miscellaneous extras and surcharges. Currently, this only includes. the $0.50 and $1 rush hour and overnight charges', 'tests': ['not_null']}, {'name': 'mta_tax', 'description': '0.50 MTA tax that is automatically triggered based on the metered rate in use', 'tests': ['unique']}, {'name': 'tip_amount', 'description': 'Tip amount  This field is automatically populated for credit card tips.Cash tips are not included', 'tests': ['not_null']}, {'name': 'tolls_amount', 'description': 'Total amount of all tolls paid in trip', 'tests': ['not_null']}, {'name': 'improvement_surcharge', 'description': '0.30 improvement surcharge assessed trips at the flag drop. the improvement surcharge began being levied in 2015', 'tests': ['not_null']}, {'name': 'total_amount', 'description': 'The total amount charged to passengers. Does not include cash tips.', 'tests': ['not_null']}, {'name': 'payment_type', 'description': 'A numeric code signifying how the passenger paid for the trip', 'tests': ['not_null']}, {'name': 'trip_type', 'description': 'Year of pickup', 'tests': ['not_null']}, {'name': 'congestion_surcharge', 'description': 'An additional charge for trips taken during high traffic congestion times', 'tests': [None]}], 'original_file_path': 'models/tests/schema.yml', 'yaml_key': 'models', 'package_name': 'nyc_taxi'} - at path ['columns'][18]['tests'][0]: None is not valid under any of the given schemas
[2024-11-21T17:46:50.727+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:46:50.737+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 11.847 seconds
[2024-11-21T17:47:21.185+0000] {processor.py:161} INFO - Started process (PID=4716) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:47:21.185+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T17:47:21.187+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:47:21.187+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:47:21.209+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:47:21.209+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T17:47:22.039+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:47:22.039+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 0.8192599009998958
[2024-11-21T17:47:22.040+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:47:22.040+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T17:47:22.040+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:47:22.040+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T17:47:22.044+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:47:22.044+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T17:47:22.050+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:47:22.050+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T17:47:22.056+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:47:22.055+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpmpxoxg40 --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T17:47:26.282+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:47:26.282+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpmpxoxg40 --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T17:47:32.513+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:47:32.509+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 210, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpmpxoxg40', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
17:47:28  Running with dbt=1.8.7
17:47:29  Registered adapter: bigquery=1.8.3
17:47:30  [WARNING]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
17:47:30  Encountered an error:
Parsing Error
  Invalid models config given in models/tests/schema.yml @ models: {'name': 'fct_trips', 'description': 'Fact Table of tripdata', 'columns': [{'name': 'trip_id', 'description': 'The primary key for this table', 'tests': ['unique']}, {'name': 'vendor_id', 'description': 'A code indicating the TPEP provider that provided the record', 'tests': ['not_null']}, {'name': 'pickup_time_id', 'description': 'id to get pickup time from dim_time', 'tests': ['not_null']}, {'name': 'dropoff_time_id', 'description': 'id to get dropoff time from dim_time', 'tests': ['unique']}, {'name': 'rate_code_id', 'description': 'The final rate code in effect at the end of the trip', 'tests': ['unique']}, {'name': 'pu_location_id', 'description': 'The pickup location', 'tests': ['not_null']}, {'name': 'do_location_id', 'description': 'The droppof location', 'tests': ['not_null']}, {'name': 'passenger_count', 'description': 'Customer count', 'tests': ['unique']}, {'name': 'trip_distance', 'description': 'trip distance', 'tests': ['not_null']}, {'name': 'fare_amount', 'description': 'The time-and-distance fare calculated by the meter.', 'tests': ['not_null']}, {'name': 'extra', 'description': 'Miscellaneous extras and surcharges. Currently, this only includes. the $0.50 and $1 rush hour and overnight charges', 'tests': ['not_null']}, {'name': 'mta_tax', 'description': '0.50 MTA tax that is automatically triggered based on the metered rate in use', 'tests': ['unique']}, {'name': 'tip_amount', 'description': 'Tip amount  This field is automatically populated for credit card tips.Cash tips are not included', 'tests': ['not_null']}, {'name': 'tolls_amount', 'description': 'Total amount of all tolls paid in trip', 'tests': ['not_null']}, {'name': 'improvement_surcharge', 'description': '0.30 improvement surcharge assessed trips at the flag drop. the improvement surcharge began being levied in 2015', 'tests': ['not_null']}, {'name': 'total_amount', 'description': 'The total amount charged to passengers. Does not include cash tips.', 'tests': ['not_null']}, {'name': 'payment_type', 'description': 'A numeric code signifying how the passenger paid for the trip', 'tests': ['not_null']}, {'name': 'trip_type', 'description': 'Year of pickup', 'tests': ['not_null']}, {'name': 'congestion_surcharge', 'description': 'An additional charge for trips taken during high traffic congestion times', 'tests': [None]}], 'original_file_path': 'models/tests/schema.yml', 'yaml_key': 'models', 'package_name': 'nyc_taxi'} - at path ['columns'][18]['tests'][0]: None is not valid under any of the given schemas
[2024-11-21T17:47:32.514+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:47:32.524+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 12.439 seconds
[2024-11-21T17:48:02.618+0000] {processor.py:161} INFO - Started process (PID=4768) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:48:02.619+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T17:48:02.620+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:48:02.620+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:48:02.642+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:48:02.642+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T17:48:03.392+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:48:03.391+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 0.7395882110004095
[2024-11-21T17:48:03.392+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:48:03.392+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T17:48:03.393+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:48:03.392+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T17:48:03.401+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:48:03.401+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T17:48:03.407+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:48:03.407+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T17:48:03.414+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:48:03.414+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp1how08zn --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T17:48:08.119+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:48:08.119+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp1how08zn --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T17:48:14.241+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:48:14.237+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 210, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmp1how08zn', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
17:48:10  Running with dbt=1.8.7
17:48:11  Registered adapter: bigquery=1.8.3
17:48:12  [WARNING]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
17:48:12  Encountered an error:
Parsing Error
  Invalid models config given in models/tests/schema.yml @ models: {'name': 'fct_trips', 'description': 'Fact Table of tripdata', 'columns': [{'name': 'trip_id', 'description': 'The primary key for this table', 'tests': ['unique']}, {'name': 'vendor_id', 'description': 'A code indicating the TPEP provider that provided the record', 'tests': ['not_null']}, {'name': 'pickup_time_id', 'description': 'id to get pickup time from dim_time', 'tests': ['not_null']}, {'name': 'dropoff_time_id', 'description': 'id to get dropoff time from dim_time', 'tests': ['unique']}, {'name': 'rate_code_id', 'description': 'The final rate code in effect at the end of the trip', 'tests': ['unique']}, {'name': 'pu_location_id', 'description': 'The pickup location', 'tests': ['not_null']}, {'name': 'do_location_id', 'description': 'The droppof location', 'tests': ['not_null']}, {'name': 'passenger_count', 'description': 'Customer count', 'tests': ['unique']}, {'name': 'trip_distance', 'description': 'trip distance', 'tests': ['not_null']}, {'name': 'fare_amount', 'description': 'The time-and-distance fare calculated by the meter.', 'tests': ['not_null']}, {'name': 'extra', 'description': 'Miscellaneous extras and surcharges. Currently, this only includes. the $0.50 and $1 rush hour and overnight charges', 'tests': ['not_null']}, {'name': 'mta_tax', 'description': '0.50 MTA tax that is automatically triggered based on the metered rate in use', 'tests': ['unique']}, {'name': 'tip_amount', 'description': 'Tip amount  This field is automatically populated for credit card tips.Cash tips are not included', 'tests': ['not_null']}, {'name': 'tolls_amount', 'description': 'Total amount of all tolls paid in trip', 'tests': ['not_null']}, {'name': 'improvement_surcharge', 'description': '0.30 improvement surcharge assessed trips at the flag drop. the improvement surcharge began being levied in 2015', 'tests': ['not_null']}, {'name': 'total_amount', 'description': 'The total amount charged to passengers. Does not include cash tips.', 'tests': ['not_null']}, {'name': 'payment_type', 'description': 'A numeric code signifying how the passenger paid for the trip', 'tests': ['not_null']}, {'name': 'trip_type', 'description': 'Year of pickup', 'tests': ['not_null']}, {'name': 'congestion_surcharge', 'description': 'An additional charge for trips taken during high traffic congestion times', 'tests': [None]}], 'original_file_path': 'models/tests/schema.yml', 'yaml_key': 'models', 'package_name': 'nyc_taxi'} - at path ['columns'][18]['tests'][0]: None is not valid under any of the given schemas
[2024-11-21T17:48:14.241+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:48:14.250+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 11.637 seconds
[2024-11-21T17:48:44.901+0000] {processor.py:161} INFO - Started process (PID=4813) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:48:44.901+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T17:48:44.903+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:48:44.902+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:48:44.925+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:48:44.925+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T17:48:45.663+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:48:45.663+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 0.7275413480001589
[2024-11-21T17:48:45.664+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:48:45.663+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T17:48:45.664+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:48:45.664+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T17:48:45.668+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:48:45.667+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T17:48:45.675+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:48:45.674+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T17:48:45.681+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:48:45.680+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmptzcmifa1 --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T17:48:50.936+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:48:50.936+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmptzcmifa1 --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T17:48:56.937+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:48:56.934+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 210, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmptzcmifa1', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
17:48:52  Running with dbt=1.8.7
17:48:54  Registered adapter: bigquery=1.8.3
17:48:55  [WARNING]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
17:48:55  Encountered an error:
Parsing Error
  Invalid models config given in models/tests/schema.yml @ models: {'name': 'fct_trips', 'description': 'Fact Table of tripdata', 'columns': [{'name': 'trip_id', 'description': 'The primary key for this table', 'tests': ['unique']}, {'name': 'vendor_id', 'description': 'A code indicating the TPEP provider that provided the record', 'tests': ['not_null']}, {'name': 'pickup_time_id', 'description': 'id to get pickup time from dim_time', 'tests': ['not_null']}, {'name': 'dropoff_time_id', 'description': 'id to get dropoff time from dim_time', 'tests': ['unique']}, {'name': 'rate_code_id', 'description': 'The final rate code in effect at the end of the trip', 'tests': ['unique']}, {'name': 'pu_location_id', 'description': 'The pickup location', 'tests': ['not_null']}, {'name': 'do_location_id', 'description': 'The droppof location', 'tests': ['not_null']}, {'name': 'passenger_count', 'description': 'Customer count', 'tests': ['unique']}, {'name': 'trip_distance', 'description': 'trip distance', 'tests': ['not_null']}, {'name': 'fare_amount', 'description': 'The time-and-distance fare calculated by the meter.', 'tests': ['not_null']}, {'name': 'extra', 'description': 'Miscellaneous extras and surcharges. Currently, this only includes. the $0.50 and $1 rush hour and overnight charges', 'tests': ['not_null']}, {'name': 'mta_tax', 'description': '0.50 MTA tax that is automatically triggered based on the metered rate in use', 'tests': ['unique']}, {'name': 'tip_amount', 'description': 'Tip amount  This field is automatically populated for credit card tips.Cash tips are not included', 'tests': ['not_null']}, {'name': 'tolls_amount', 'description': 'Total amount of all tolls paid in trip', 'tests': ['not_null']}, {'name': 'improvement_surcharge', 'description': '0.30 improvement surcharge assessed trips at the flag drop. the improvement surcharge began being levied in 2015', 'tests': ['not_null']}, {'name': 'total_amount', 'description': 'The total amount charged to passengers. Does not include cash tips.', 'tests': ['not_null']}, {'name': 'payment_type', 'description': 'A numeric code signifying how the passenger paid for the trip', 'tests': ['not_null']}, {'name': 'trip_type', 'description': 'Year of pickup', 'tests': ['not_null']}, {'name': 'congestion_surcharge', 'description': 'An additional charge for trips taken during high traffic congestion times', 'tests': [None]}], 'original_file_path': 'models/tests/schema.yml', 'yaml_key': 'models', 'package_name': 'nyc_taxi'} - at path ['columns'][18]['tests'][0]: None is not valid under any of the given schemas
[2024-11-21T17:48:56.938+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:48:56.948+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 13.138 seconds
[2024-11-21T17:49:27.291+0000] {processor.py:161} INFO - Started process (PID=4865) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:49:27.292+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T17:49:27.295+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:49:27.294+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:49:27.333+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:49:27.333+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T17:49:28.199+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:49:28.199+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 0.851288241000475
[2024-11-21T17:49:28.199+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:49:28.199+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T17:49:28.200+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:49:28.200+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T17:49:28.204+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:49:28.204+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T17:49:28.221+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:49:28.221+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T17:49:28.228+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:49:28.228+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpfyyk9kwb --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T17:49:33.279+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:49:33.278+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpfyyk9kwb --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T17:49:39.523+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:49:39.520+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 210, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpfyyk9kwb', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
17:49:35  Running with dbt=1.8.7
17:49:36  Registered adapter: bigquery=1.8.3
17:49:37  [WARNING]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
17:49:37  Encountered an error:
Parsing Error
  Invalid models config given in models/tests/schema.yml @ models: {'name': 'fct_trips', 'description': 'Fact Table of tripdata', 'columns': [{'name': 'trip_id', 'description': 'The primary key for this table', 'tests': ['unique']}, {'name': 'vendor_id', 'description': 'A code indicating the TPEP provider that provided the record', 'tests': ['not_null']}, {'name': 'pickup_time_id', 'description': 'id to get pickup time from dim_time', 'tests': ['not_null']}, {'name': 'dropoff_time_id', 'description': 'id to get dropoff time from dim_time', 'tests': ['unique']}, {'name': 'rate_code_id', 'description': 'The final rate code in effect at the end of the trip', 'tests': ['unique']}, {'name': 'pu_location_id', 'description': 'The pickup location', 'tests': ['not_null']}, {'name': 'do_location_id', 'description': 'The droppof location', 'tests': ['not_null']}, {'name': 'passenger_count', 'description': 'Customer count', 'tests': ['unique']}, {'name': 'trip_distance', 'description': 'trip distance', 'tests': ['not_null']}, {'name': 'fare_amount', 'description': 'The time-and-distance fare calculated by the meter.', 'tests': ['not_null']}, {'name': 'extra', 'description': 'Miscellaneous extras and surcharges. Currently, this only includes. the $0.50 and $1 rush hour and overnight charges', 'tests': ['not_null']}, {'name': 'mta_tax', 'description': '0.50 MTA tax that is automatically triggered based on the metered rate in use', 'tests': ['unique']}, {'name': 'tip_amount', 'description': 'Tip amount  This field is automatically populated for credit card tips.Cash tips are not included', 'tests': ['not_null']}, {'name': 'tolls_amount', 'description': 'Total amount of all tolls paid in trip', 'tests': ['not_null']}, {'name': 'improvement_surcharge', 'description': '0.30 improvement surcharge assessed trips at the flag drop. the improvement surcharge began being levied in 2015', 'tests': ['not_null']}, {'name': 'total_amount', 'description': 'The total amount charged to passengers. Does not include cash tips.', 'tests': ['not_null']}, {'name': 'payment_type', 'description': 'A numeric code signifying how the passenger paid for the trip', 'tests': ['not_null']}, {'name': 'trip_type', 'description': 'Year of pickup', 'tests': ['not_null']}, {'name': 'congestion_surcharge', 'description': 'An additional charge for trips taken during high traffic congestion times', 'tests': [None]}], 'original_file_path': 'models/tests/schema.yml', 'yaml_key': 'models', 'package_name': 'nyc_taxi'} - at path ['columns'][18]['tests'][0]: None is not valid under any of the given schemas
[2024-11-21T17:49:39.524+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:49:39.539+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 12.256 seconds
[2024-11-21T17:50:09.611+0000] {processor.py:161} INFO - Started process (PID=4910) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:50:09.611+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T17:50:09.613+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:50:09.612+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:50:09.635+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:50:09.635+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T17:50:10.343+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:50:10.343+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 0.6975325690000318
[2024-11-21T17:50:10.343+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:50:10.343+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T17:50:10.344+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:50:10.344+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T17:50:10.347+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:50:10.347+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T17:50:10.353+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:50:10.353+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T17:50:10.358+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:50:10.358+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp_o5oauff --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T17:50:16.049+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:50:16.048+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp_o5oauff --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T17:50:21.094+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:50:21.091+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 210, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmp_o5oauff', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
17:50:17  Running with dbt=1.8.7
17:50:18  Registered adapter: bigquery=1.8.3
17:50:19  [WARNING]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
17:50:19  Encountered an error:
Parsing Error
  Invalid models config given in models/tests/schema.yml @ models: {'name': 'fct_trips', 'description': 'Fact Table of tripdata', 'columns': [{'name': 'trip_id', 'description': 'The primary key for this table', 'tests': ['unique']}, {'name': 'vendor_id', 'description': 'A code indicating the TPEP provider that provided the record', 'tests': ['not_null']}, {'name': 'pickup_time_id', 'description': 'id to get pickup time from dim_time', 'tests': ['not_null']}, {'name': 'dropoff_time_id', 'description': 'id to get dropoff time from dim_time', 'tests': ['unique']}, {'name': 'rate_code_id', 'description': 'The final rate code in effect at the end of the trip', 'tests': ['unique']}, {'name': 'pu_location_id', 'description': 'The pickup location', 'tests': ['not_null']}, {'name': 'do_location_id', 'description': 'The droppof location', 'tests': ['not_null']}, {'name': 'passenger_count', 'description': 'Customer count', 'tests': ['unique']}, {'name': 'trip_distance', 'description': 'trip distance', 'tests': ['not_null']}, {'name': 'fare_amount', 'description': 'The time-and-distance fare calculated by the meter.', 'tests': ['not_null']}, {'name': 'extra', 'description': 'Miscellaneous extras and surcharges. Currently, this only includes. the $0.50 and $1 rush hour and overnight charges', 'tests': ['not_null']}, {'name': 'mta_tax', 'description': '0.50 MTA tax that is automatically triggered based on the metered rate in use', 'tests': ['unique']}, {'name': 'tip_amount', 'description': 'Tip amount  This field is automatically populated for credit card tips.Cash tips are not included', 'tests': ['not_null']}, {'name': 'tolls_amount', 'description': 'Total amount of all tolls paid in trip', 'tests': ['not_null']}, {'name': 'improvement_surcharge', 'description': '0.30 improvement surcharge assessed trips at the flag drop. the improvement surcharge began being levied in 2015', 'tests': ['not_null']}, {'name': 'total_amount', 'description': 'The total amount charged to passengers. Does not include cash tips.', 'tests': ['not_null']}, {'name': 'payment_type', 'description': 'A numeric code signifying how the passenger paid for the trip', 'tests': ['not_null']}, {'name': 'trip_type', 'description': 'Year of pickup', 'tests': ['not_null']}, {'name': 'congestion_surcharge', 'description': 'An additional charge for trips taken during high traffic congestion times', 'tests': [None]}], 'original_file_path': 'models/tests/schema.yml', 'yaml_key': 'models', 'package_name': 'nyc_taxi'} - at path ['columns'][18]['tests'][0]: None is not valid under any of the given schemas
[2024-11-21T17:50:21.095+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:50:21.110+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 12.584 seconds
[2024-11-21T17:50:51.801+0000] {processor.py:161} INFO - Started process (PID=4961) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:50:51.801+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T17:50:51.802+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:50:51.802+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:50:51.826+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:50:51.826+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T17:50:52.572+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:50:52.572+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 0.7351376810001966
[2024-11-21T17:50:52.573+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:50:52.572+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T17:50:52.573+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:50:52.573+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T17:50:52.577+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:50:52.577+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T17:50:52.583+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:50:52.583+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T17:50:52.589+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:50:52.589+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmph7w6i13w --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T17:50:57.029+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:50:57.028+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmph7w6i13w --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T17:51:03.359+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:51:03.356+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 210, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmph7w6i13w', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
17:50:59  Running with dbt=1.8.7
17:51:00  Registered adapter: bigquery=1.8.3
17:51:01  [WARNING]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
17:51:01  Encountered an error:
Parsing Error
  Invalid models config given in models/tests/schema.yml @ models: {'name': 'fct_trips', 'description': 'Fact Table of tripdata', 'columns': [{'name': 'trip_id', 'description': 'The primary key for this table', 'tests': ['unique']}, {'name': 'vendor_id', 'description': 'A code indicating the TPEP provider that provided the record', 'tests': ['not_null']}, {'name': 'pickup_time_id', 'description': 'id to get pickup time from dim_time', 'tests': ['not_null']}, {'name': 'dropoff_time_id', 'description': 'id to get dropoff time from dim_time', 'tests': ['unique']}, {'name': 'rate_code_id', 'description': 'The final rate code in effect at the end of the trip', 'tests': ['unique']}, {'name': 'pu_location_id', 'description': 'The pickup location', 'tests': ['not_null']}, {'name': 'do_location_id', 'description': 'The droppof location', 'tests': ['not_null']}, {'name': 'passenger_count', 'description': 'Customer count', 'tests': ['unique']}, {'name': 'trip_distance', 'description': 'trip distance', 'tests': ['not_null']}, {'name': 'fare_amount', 'description': 'The time-and-distance fare calculated by the meter.', 'tests': ['not_null']}, {'name': 'extra', 'description': 'Miscellaneous extras and surcharges. Currently, this only includes. the $0.50 and $1 rush hour and overnight charges', 'tests': ['not_null']}, {'name': 'mta_tax', 'description': '0.50 MTA tax that is automatically triggered based on the metered rate in use', 'tests': ['unique']}, {'name': 'tip_amount', 'description': 'Tip amount  This field is automatically populated for credit card tips.Cash tips are not included', 'tests': ['not_null']}, {'name': 'tolls_amount', 'description': 'Total amount of all tolls paid in trip', 'tests': ['not_null']}, {'name': 'improvement_surcharge', 'description': '0.30 improvement surcharge assessed trips at the flag drop. the improvement surcharge began being levied in 2015', 'tests': ['not_null']}, {'name': 'total_amount', 'description': 'The total amount charged to passengers. Does not include cash tips.', 'tests': ['not_null']}, {'name': 'payment_type', 'description': 'A numeric code signifying how the passenger paid for the trip', 'tests': ['not_null']}, {'name': 'trip_type', 'description': 'Year of pickup', 'tests': ['not_null']}, {'name': 'congestion_surcharge', 'description': 'An additional charge for trips taken during high traffic congestion times', 'tests': [None]}], 'original_file_path': 'models/tests/schema.yml', 'yaml_key': 'models', 'package_name': 'nyc_taxi'} - at path ['columns'][18]['tests'][0]: None is not valid under any of the given schemas
[2024-11-21T17:51:03.360+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:51:03.369+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 11.573 seconds
[2024-11-21T17:51:34.290+0000] {processor.py:161} INFO - Started process (PID=5007) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:51:34.291+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T17:51:34.292+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:51:34.292+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:51:34.314+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:51:34.314+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T17:51:35.037+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:51:35.037+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 0.7117455319994406
[2024-11-21T17:51:35.038+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:51:35.037+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T17:51:35.038+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:51:35.038+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T17:51:35.042+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:51:35.041+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T17:51:35.047+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:51:35.047+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T17:51:35.053+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:51:35.053+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp7qwjgb8p --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T17:51:39.986+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:51:39.986+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp7qwjgb8p --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T17:51:45.341+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:51:45.338+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 210, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmp7qwjgb8p', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
17:51:42  Running with dbt=1.8.7
17:51:43  Registered adapter: bigquery=1.8.3
17:51:44  [WARNING]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
17:51:44  Encountered an error:
Parsing Error
  Invalid models config given in models/tests/schema.yml @ models: {'name': 'fct_trips', 'description': 'Fact Table of tripdata', 'columns': [{'name': 'trip_id', 'description': 'The primary key for this table', 'tests': ['unique']}, {'name': 'vendor_id', 'description': 'A code indicating the TPEP provider that provided the record', 'tests': ['not_null']}, {'name': 'pickup_time_id', 'description': 'id to get pickup time from dim_time', 'tests': ['not_null']}, {'name': 'dropoff_time_id', 'description': 'id to get dropoff time from dim_time', 'tests': ['unique']}, {'name': 'rate_code_id', 'description': 'The final rate code in effect at the end of the trip', 'tests': ['unique']}, {'name': 'pu_location_id', 'description': 'The pickup location', 'tests': ['not_null']}, {'name': 'do_location_id', 'description': 'The droppof location', 'tests': ['not_null']}, {'name': 'passenger_count', 'description': 'Customer count', 'tests': ['unique']}, {'name': 'trip_distance', 'description': 'trip distance', 'tests': ['not_null']}, {'name': 'fare_amount', 'description': 'The time-and-distance fare calculated by the meter.', 'tests': ['not_null']}, {'name': 'extra', 'description': 'Miscellaneous extras and surcharges. Currently, this only includes. the $0.50 and $1 rush hour and overnight charges', 'tests': ['not_null']}, {'name': 'mta_tax', 'description': '0.50 MTA tax that is automatically triggered based on the metered rate in use', 'tests': ['unique']}, {'name': 'tip_amount', 'description': 'Tip amount  This field is automatically populated for credit card tips.Cash tips are not included', 'tests': ['not_null']}, {'name': 'tolls_amount', 'description': 'Total amount of all tolls paid in trip', 'tests': ['not_null']}, {'name': 'improvement_surcharge', 'description': '0.30 improvement surcharge assessed trips at the flag drop. the improvement surcharge began being levied in 2015', 'tests': ['not_null']}, {'name': 'total_amount', 'description': 'The total amount charged to passengers. Does not include cash tips.', 'tests': ['not_null']}, {'name': 'payment_type', 'description': 'A numeric code signifying how the passenger paid for the trip', 'tests': ['not_null']}, {'name': 'trip_type', 'description': 'Year of pickup', 'tests': ['not_null']}, {'name': 'congestion_surcharge', 'description': 'An additional charge for trips taken during high traffic congestion times', 'tests': [None]}], 'original_file_path': 'models/tests/schema.yml', 'yaml_key': 'models', 'package_name': 'nyc_taxi'} - at path ['columns'][18]['tests'][0]: None is not valid under any of the given schemas
[2024-11-21T17:51:45.342+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:51:45.359+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 12.183 seconds
[2024-11-21T17:52:15.535+0000] {processor.py:161} INFO - Started process (PID=5058) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:52:15.536+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T17:52:15.538+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:52:15.537+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:52:15.560+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:52:15.560+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T17:52:16.299+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:52:16.298+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 0.7285389120006585
[2024-11-21T17:52:16.299+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:52:16.299+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T17:52:16.299+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:52:16.299+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T17:52:16.303+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:52:16.303+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T17:52:16.309+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:52:16.309+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T17:52:16.315+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:52:16.315+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpml0jicvg --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T17:52:20.814+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:52:20.813+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpml0jicvg --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T17:52:27.038+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:52:27.034+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 210, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpml0jicvg', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
17:52:22  Running with dbt=1.8.7
17:52:24  Registered adapter: bigquery=1.8.3
17:52:25  [WARNING]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
17:52:25  Encountered an error:
Parsing Error
  Invalid models config given in models/tests/schema.yml @ models: {'name': 'fct_trips', 'description': 'Fact Table of tripdata', 'columns': [{'name': 'trip_id', 'description': 'The primary key for this table', 'tests': ['unique']}, {'name': 'vendor_id', 'description': 'A code indicating the TPEP provider that provided the record', 'tests': ['not_null']}, {'name': 'pickup_time_id', 'description': 'id to get pickup time from dim_time', 'tests': ['not_null']}, {'name': 'dropoff_time_id', 'description': 'id to get dropoff time from dim_time', 'tests': ['unique']}, {'name': 'rate_code_id', 'description': 'The final rate code in effect at the end of the trip', 'tests': ['unique']}, {'name': 'pu_location_id', 'description': 'The pickup location', 'tests': ['not_null']}, {'name': 'do_location_id', 'description': 'The droppof location', 'tests': ['not_null']}, {'name': 'passenger_count', 'description': 'Customer count', 'tests': ['unique']}, {'name': 'trip_distance', 'description': 'trip distance', 'tests': ['not_null']}, {'name': 'fare_amount', 'description': 'The time-and-distance fare calculated by the meter.', 'tests': ['not_null']}, {'name': 'extra', 'description': 'Miscellaneous extras and surcharges. Currently, this only includes. the $0.50 and $1 rush hour and overnight charges', 'tests': ['not_null']}, {'name': 'mta_tax', 'description': '0.50 MTA tax that is automatically triggered based on the metered rate in use', 'tests': ['unique']}, {'name': 'tip_amount', 'description': 'Tip amount  This field is automatically populated for credit card tips.Cash tips are not included', 'tests': ['not_null']}, {'name': 'tolls_amount', 'description': 'Total amount of all tolls paid in trip', 'tests': ['not_null']}, {'name': 'improvement_surcharge', 'description': '0.30 improvement surcharge assessed trips at the flag drop. the improvement surcharge began being levied in 2015', 'tests': ['not_null']}, {'name': 'total_amount', 'description': 'The total amount charged to passengers. Does not include cash tips.', 'tests': ['not_null']}, {'name': 'payment_type', 'description': 'A numeric code signifying how the passenger paid for the trip', 'tests': ['not_null']}, {'name': 'trip_type', 'description': 'Year of pickup', 'tests': ['not_null']}, {'name': 'congestion_surcharge', 'description': 'An additional charge for trips taken during high traffic congestion times', 'tests': [None]}], 'original_file_path': 'models/tests/schema.yml', 'yaml_key': 'models', 'package_name': 'nyc_taxi'} - at path ['columns'][18]['tests'][0]: None is not valid under any of the given schemas
[2024-11-21T17:52:27.039+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:52:27.055+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 11.525 seconds
[2024-11-21T17:52:57.972+0000] {processor.py:161} INFO - Started process (PID=5104) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:52:57.972+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T17:52:57.974+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:52:57.974+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:52:57.998+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:52:57.998+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T17:52:58.772+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:52:58.771+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 0.7614954049995504
[2024-11-21T17:52:58.772+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:52:58.772+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T17:52:58.772+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:52:58.772+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T17:52:58.777+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:52:58.777+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T17:52:58.783+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:52:58.783+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T17:52:58.789+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:52:58.789+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpl1blem6q --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T17:53:03.819+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:53:03.818+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpl1blem6q --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T17:53:09.896+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:53:09.893+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 210, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpl1blem6q', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
17:53:05  Running with dbt=1.8.7
17:53:07  Registered adapter: bigquery=1.8.3
17:53:08  [WARNING]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
17:53:08  Encountered an error:
Parsing Error
  Invalid models config given in models/tests/schema.yml @ models: {'name': 'fct_trips', 'description': 'Fact Table of tripdata', 'columns': [{'name': 'trip_id', 'description': 'The primary key for this table', 'tests': ['unique']}, {'name': 'vendor_id', 'description': 'A code indicating the TPEP provider that provided the record', 'tests': ['not_null']}, {'name': 'pickup_time_id', 'description': 'id to get pickup time from dim_time', 'tests': ['not_null']}, {'name': 'dropoff_time_id', 'description': 'id to get dropoff time from dim_time', 'tests': ['unique']}, {'name': 'rate_code_id', 'description': 'The final rate code in effect at the end of the trip', 'tests': ['unique']}, {'name': 'pu_location_id', 'description': 'The pickup location', 'tests': ['not_null']}, {'name': 'do_location_id', 'description': 'The droppof location', 'tests': ['not_null']}, {'name': 'passenger_count', 'description': 'Customer count', 'tests': ['unique']}, {'name': 'trip_distance', 'description': 'trip distance', 'tests': ['not_null']}, {'name': 'fare_amount', 'description': 'The time-and-distance fare calculated by the meter.', 'tests': ['not_null']}, {'name': 'extra', 'description': 'Miscellaneous extras and surcharges. Currently, this only includes. the $0.50 and $1 rush hour and overnight charges', 'tests': ['not_null']}, {'name': 'mta_tax', 'description': '0.50 MTA tax that is automatically triggered based on the metered rate in use', 'tests': ['unique']}, {'name': 'tip_amount', 'description': 'Tip amount  This field is automatically populated for credit card tips.Cash tips are not included', 'tests': ['not_null']}, {'name': 'tolls_amount', 'description': 'Total amount of all tolls paid in trip', 'tests': ['not_null']}, {'name': 'improvement_surcharge', 'description': '0.30 improvement surcharge assessed trips at the flag drop. the improvement surcharge began being levied in 2015', 'tests': ['not_null']}, {'name': 'total_amount', 'description': 'The total amount charged to passengers. Does not include cash tips.', 'tests': ['not_null']}, {'name': 'payment_type', 'description': 'A numeric code signifying how the passenger paid for the trip', 'tests': ['not_null']}, {'name': 'trip_type', 'description': 'Year of pickup', 'tests': ['not_null']}, {'name': 'congestion_surcharge', 'description': 'An additional charge for trips taken during high traffic congestion times', 'tests': [None]}], 'original_file_path': 'models/tests/schema.yml', 'yaml_key': 'models', 'package_name': 'nyc_taxi'} - at path ['columns'][18]['tests'][0]: None is not valid under any of the given schemas
[2024-11-21T17:53:09.897+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:53:09.906+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 11.940 seconds
[2024-11-21T17:53:40.118+0000] {processor.py:161} INFO - Started process (PID=5149) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:53:40.119+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T17:53:40.121+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:53:40.121+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:53:40.144+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:53:40.144+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T17:53:39.778+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:53:39.777+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 0.722484037999493
[2024-11-21T17:53:39.778+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:53:39.778+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T17:53:39.779+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:53:39.778+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T17:53:39.782+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:53:39.782+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T17:53:39.789+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:53:39.789+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T17:53:39.795+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:53:39.795+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp1utuuwxg --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T17:53:45.807+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:53:45.807+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp1utuuwxg --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T17:53:52.297+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:53:52.293+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 210, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmp1utuuwxg', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
17:53:47  Running with dbt=1.8.7
17:53:49  Registered adapter: bigquery=1.8.3
17:53:50  [WARNING]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
17:53:50  Encountered an error:
Parsing Error
  Invalid models config given in models/tests/schema.yml @ models: {'name': 'fct_trips', 'description': 'Fact Table of tripdata', 'columns': [{'name': 'trip_id', 'description': 'The primary key for this table', 'tests': ['unique']}, {'name': 'vendor_id', 'description': 'A code indicating the TPEP provider that provided the record', 'tests': ['not_null']}, {'name': 'pickup_time_id', 'description': 'id to get pickup time from dim_time', 'tests': ['not_null']}, {'name': 'dropoff_time_id', 'description': 'id to get dropoff time from dim_time', 'tests': ['unique']}, {'name': 'rate_code_id', 'description': 'The final rate code in effect at the end of the trip', 'tests': ['unique']}, {'name': 'pu_location_id', 'description': 'The pickup location', 'tests': ['not_null']}, {'name': 'do_location_id', 'description': 'The droppof location', 'tests': ['not_null']}, {'name': 'passenger_count', 'description': 'Customer count', 'tests': ['unique']}, {'name': 'trip_distance', 'description': 'trip distance', 'tests': ['not_null']}, {'name': 'fare_amount', 'description': 'The time-and-distance fare calculated by the meter.', 'tests': ['not_null']}, {'name': 'extra', 'description': 'Miscellaneous extras and surcharges. Currently, this only includes. the $0.50 and $1 rush hour and overnight charges', 'tests': ['not_null']}, {'name': 'mta_tax', 'description': '0.50 MTA tax that is automatically triggered based on the metered rate in use', 'tests': ['unique']}, {'name': 'tip_amount', 'description': 'Tip amount  This field is automatically populated for credit card tips.Cash tips are not included', 'tests': ['not_null']}, {'name': 'tolls_amount', 'description': 'Total amount of all tolls paid in trip', 'tests': ['not_null']}, {'name': 'improvement_surcharge', 'description': '0.30 improvement surcharge assessed trips at the flag drop. the improvement surcharge began being levied in 2015', 'tests': ['not_null']}, {'name': 'total_amount', 'description': 'The total amount charged to passengers. Does not include cash tips.', 'tests': ['not_null']}, {'name': 'payment_type', 'description': 'A numeric code signifying how the passenger paid for the trip', 'tests': ['not_null']}, {'name': 'trip_type', 'description': 'Year of pickup', 'tests': ['not_null']}, {'name': 'congestion_surcharge', 'description': 'An additional charge for trips taken during high traffic congestion times', 'tests': [None]}], 'original_file_path': 'models/tests/schema.yml', 'yaml_key': 'models', 'package_name': 'nyc_taxi'} - at path ['columns'][18]['tests'][0]: None is not valid under any of the given schemas
[2024-11-21T17:53:52.298+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:53:52.315+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 13.302 seconds
[2024-11-21T17:54:23.246+0000] {processor.py:161} INFO - Started process (PID=5200) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:54:23.247+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T17:54:23.249+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:54:23.248+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:54:23.275+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:54:23.275+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T17:54:24.236+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:54:24.236+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 0.9496822159999283
[2024-11-21T17:54:24.237+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:54:24.236+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T17:54:24.237+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:54:24.237+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T17:54:24.243+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:54:24.242+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T17:54:24.250+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:54:24.250+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T17:54:24.256+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:54:24.256+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpqdrzjm_y --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T17:54:29.741+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:54:29.740+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpqdrzjm_y --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T17:54:36.432+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:54:36.428+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 210, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpqdrzjm_y', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
17:54:31  Running with dbt=1.8.7
17:54:33  Registered adapter: bigquery=1.8.3
17:54:34  [WARNING]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
17:54:34  Encountered an error:
Parsing Error
  Invalid models config given in models/tests/schema.yml @ models: {'name': 'fct_trips', 'description': 'Fact Table of tripdata', 'columns': [{'name': 'trip_id', 'description': 'The primary key for this table', 'tests': ['unique']}, {'name': 'vendor_id', 'description': 'A code indicating the TPEP provider that provided the record', 'tests': ['not_null']}, {'name': 'pickup_time_id', 'description': 'id to get pickup time from dim_time', 'tests': ['not_null']}, {'name': 'dropoff_time_id', 'description': 'id to get dropoff time from dim_time', 'tests': ['unique']}, {'name': 'rate_code_id', 'description': 'The final rate code in effect at the end of the trip', 'tests': ['unique']}, {'name': 'pu_location_id', 'description': 'The pickup location', 'tests': ['not_null']}, {'name': 'do_location_id', 'description': 'The droppof location', 'tests': ['not_null']}, {'name': 'passenger_count', 'description': 'Customer count', 'tests': ['unique']}, {'name': 'trip_distance', 'description': 'trip distance', 'tests': ['not_null']}, {'name': 'fare_amount', 'description': 'The time-and-distance fare calculated by the meter.', 'tests': ['not_null']}, {'name': 'extra', 'description': 'Miscellaneous extras and surcharges. Currently, this only includes. the $0.50 and $1 rush hour and overnight charges', 'tests': ['not_null']}, {'name': 'mta_tax', 'description': '0.50 MTA tax that is automatically triggered based on the metered rate in use', 'tests': ['unique']}, {'name': 'tip_amount', 'description': 'Tip amount  This field is automatically populated for credit card tips.Cash tips are not included', 'tests': ['not_null']}, {'name': 'tolls_amount', 'description': 'Total amount of all tolls paid in trip', 'tests': ['not_null']}, {'name': 'improvement_surcharge', 'description': '0.30 improvement surcharge assessed trips at the flag drop. the improvement surcharge began being levied in 2015', 'tests': ['not_null']}, {'name': 'total_amount', 'description': 'The total amount charged to passengers. Does not include cash tips.', 'tests': ['not_null']}, {'name': 'payment_type', 'description': 'A numeric code signifying how the passenger paid for the trip', 'tests': ['not_null']}, {'name': 'trip_type', 'description': 'Year of pickup', 'tests': ['not_null']}, {'name': 'congestion_surcharge', 'description': 'An additional charge for trips taken during high traffic congestion times', 'tests': [None]}], 'original_file_path': 'models/tests/schema.yml', 'yaml_key': 'models', 'package_name': 'nyc_taxi'} - at path ['columns'][18]['tests'][0]: None is not valid under any of the given schemas
[2024-11-21T17:54:36.432+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:54:36.449+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 13.209 seconds
[2024-11-21T17:55:06.629+0000] {processor.py:161} INFO - Started process (PID=5246) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:55:06.630+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T17:55:06.632+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:55:06.631+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:55:06.655+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:55:06.655+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T17:55:06.267+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:55:06.266+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 0.6964566500000728
[2024-11-21T17:55:06.267+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:55:06.267+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T17:55:06.267+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:55:06.267+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T17:55:06.271+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:55:06.271+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T17:55:06.277+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:55:06.277+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T17:55:06.283+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:55:06.283+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp08y20pdl --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T17:55:10.810+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:55:10.810+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp08y20pdl --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T17:55:17.023+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:55:17.020+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 210, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmp08y20pdl', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
17:55:12  Running with dbt=1.8.7
17:55:14  Registered adapter: bigquery=1.8.3
17:55:15  [WARNING]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
17:55:15  Encountered an error:
Parsing Error
  Invalid models config given in models/tests/schema.yml @ models: {'name': 'fct_trips', 'description': 'Fact Table of tripdata', 'columns': [{'name': 'trip_id', 'description': 'The primary key for this table', 'tests': ['unique']}, {'name': 'vendor_id', 'description': 'A code indicating the TPEP provider that provided the record', 'tests': ['not_null']}, {'name': 'pickup_time_id', 'description': 'id to get pickup time from dim_time', 'tests': ['not_null']}, {'name': 'dropoff_time_id', 'description': 'id to get dropoff time from dim_time', 'tests': ['unique']}, {'name': 'rate_code_id', 'description': 'The final rate code in effect at the end of the trip', 'tests': ['unique']}, {'name': 'pu_location_id', 'description': 'The pickup location', 'tests': ['not_null']}, {'name': 'do_location_id', 'description': 'The droppof location', 'tests': ['not_null']}, {'name': 'passenger_count', 'description': 'Customer count', 'tests': ['unique']}, {'name': 'trip_distance', 'description': 'trip distance', 'tests': ['not_null']}, {'name': 'fare_amount', 'description': 'The time-and-distance fare calculated by the meter.', 'tests': ['not_null']}, {'name': 'extra', 'description': 'Miscellaneous extras and surcharges. Currently, this only includes. the $0.50 and $1 rush hour and overnight charges', 'tests': ['not_null']}, {'name': 'mta_tax', 'description': '0.50 MTA tax that is automatically triggered based on the metered rate in use', 'tests': ['unique']}, {'name': 'tip_amount', 'description': 'Tip amount  This field is automatically populated for credit card tips.Cash tips are not included', 'tests': ['not_null']}, {'name': 'tolls_amount', 'description': 'Total amount of all tolls paid in trip', 'tests': ['not_null']}, {'name': 'improvement_surcharge', 'description': '0.30 improvement surcharge assessed trips at the flag drop. the improvement surcharge began being levied in 2015', 'tests': ['not_null']}, {'name': 'total_amount', 'description': 'The total amount charged to passengers. Does not include cash tips.', 'tests': ['not_null']}, {'name': 'payment_type', 'description': 'A numeric code signifying how the passenger paid for the trip', 'tests': ['not_null']}, {'name': 'trip_type', 'description': 'Year of pickup', 'tests': ['not_null']}, {'name': 'congestion_surcharge', 'description': 'An additional charge for trips taken during high traffic congestion times', 'tests': [None]}], 'original_file_path': 'models/tests/schema.yml', 'yaml_key': 'models', 'package_name': 'nyc_taxi'} - at path ['columns'][18]['tests'][0]: None is not valid under any of the given schemas
[2024-11-21T17:55:17.024+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:55:17.040+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 11.511 seconds
[2024-11-21T17:55:47.999+0000] {processor.py:161} INFO - Started process (PID=5297) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:55:47.999+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T17:55:48.001+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:55:48.000+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:55:48.024+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:55:48.024+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T17:55:48.804+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:55:48.803+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 0.7691332049998891
[2024-11-21T17:55:48.804+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:55:48.804+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T17:55:48.805+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:55:48.804+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T17:55:48.808+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:55:48.808+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T17:55:48.815+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:55:48.815+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T17:55:48.821+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:55:48.820+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpl4cr45mq --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T17:55:54.153+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:55:54.153+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpl4cr45mq --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T17:56:00.465+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:56:00.461+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 210, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpl4cr45mq', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
17:55:56  Running with dbt=1.8.7
17:55:57  Registered adapter: bigquery=1.8.3
17:55:58  [WARNING]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
17:55:58  Encountered an error:
Parsing Error
  Invalid models config given in models/tests/schema.yml @ models: {'name': 'fct_trips', 'description': 'Fact Table of tripdata', 'columns': [{'name': 'trip_id', 'description': 'The primary key for this table', 'tests': ['unique']}, {'name': 'vendor_id', 'description': 'A code indicating the TPEP provider that provided the record', 'tests': ['not_null']}, {'name': 'pickup_time_id', 'description': 'id to get pickup time from dim_time', 'tests': ['not_null']}, {'name': 'dropoff_time_id', 'description': 'id to get dropoff time from dim_time', 'tests': ['unique']}, {'name': 'rate_code_id', 'description': 'The final rate code in effect at the end of the trip', 'tests': ['unique']}, {'name': 'pu_location_id', 'description': 'The pickup location', 'tests': ['not_null']}, {'name': 'do_location_id', 'description': 'The droppof location', 'tests': ['not_null']}, {'name': 'passenger_count', 'description': 'Customer count', 'tests': ['unique']}, {'name': 'trip_distance', 'description': 'trip distance', 'tests': ['not_null']}, {'name': 'fare_amount', 'description': 'The time-and-distance fare calculated by the meter.', 'tests': ['not_null']}, {'name': 'extra', 'description': 'Miscellaneous extras and surcharges. Currently, this only includes. the $0.50 and $1 rush hour and overnight charges', 'tests': ['not_null']}, {'name': 'mta_tax', 'description': '0.50 MTA tax that is automatically triggered based on the metered rate in use', 'tests': ['unique']}, {'name': 'tip_amount', 'description': 'Tip amount  This field is automatically populated for credit card tips.Cash tips are not included', 'tests': ['not_null']}, {'name': 'tolls_amount', 'description': 'Total amount of all tolls paid in trip', 'tests': ['not_null']}, {'name': 'improvement_surcharge', 'description': '0.30 improvement surcharge assessed trips at the flag drop. the improvement surcharge began being levied in 2015', 'tests': ['not_null']}, {'name': 'total_amount', 'description': 'The total amount charged to passengers. Does not include cash tips.', 'tests': ['not_null']}, {'name': 'payment_type', 'description': 'A numeric code signifying how the passenger paid for the trip', 'tests': ['not_null']}, {'name': 'trip_type', 'description': 'Year of pickup', 'tests': ['not_null']}, {'name': 'congestion_surcharge', 'description': 'An additional charge for trips taken during high traffic congestion times', 'tests': [None]}], 'original_file_path': 'models/tests/schema.yml', 'yaml_key': 'models', 'package_name': 'nyc_taxi'} - at path ['columns'][18]['tests'][0]: None is not valid under any of the given schemas
[2024-11-21T17:56:00.465+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:56:00.476+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 12.482 seconds
[2024-11-21T17:56:31.404+0000] {processor.py:161} INFO - Started process (PID=5343) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:56:31.405+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T17:56:31.407+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:56:31.406+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:56:31.429+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:56:31.429+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T17:56:32.251+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:56:32.251+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 0.8110858629997892
[2024-11-21T17:56:32.251+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:56:32.251+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T17:56:32.252+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:56:32.252+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T17:56:32.256+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:56:32.256+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T17:56:32.263+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:56:32.263+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T17:56:32.269+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:56:32.269+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpnv3kbk85 --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T17:56:35.938+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:56:35.938+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpnv3kbk85 --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T17:56:42.591+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:56:42.580+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 210, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpnv3kbk85', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
17:56:38  Running with dbt=1.8.7
17:56:39  Registered adapter: bigquery=1.8.3
17:56:40  [WARNING]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
17:56:40  Encountered an error:
Parsing Error
  Invalid models config given in models/tests/schema.yml @ models: {'name': 'fct_trips', 'description': 'Fact Table of tripdata', 'columns': [{'name': 'trip_id', 'description': 'The primary key for this table', 'tests': ['unique']}, {'name': 'vendor_id', 'description': 'A code indicating the TPEP provider that provided the record', 'tests': ['not_null']}, {'name': 'pickup_time_id', 'description': 'id to get pickup time from dim_time', 'tests': ['not_null']}, {'name': 'dropoff_time_id', 'description': 'id to get dropoff time from dim_time', 'tests': ['unique']}, {'name': 'rate_code_id', 'description': 'The final rate code in effect at the end of the trip', 'tests': ['unique']}, {'name': 'pu_location_id', 'description': 'The pickup location', 'tests': ['not_null']}, {'name': 'do_location_id', 'description': 'The droppof location', 'tests': ['not_null']}, {'name': 'passenger_count', 'description': 'Customer count', 'tests': ['unique']}, {'name': 'trip_distance', 'description': 'trip distance', 'tests': ['not_null']}, {'name': 'fare_amount', 'description': 'The time-and-distance fare calculated by the meter.', 'tests': ['not_null']}, {'name': 'extra', 'description': 'Miscellaneous extras and surcharges. Currently, this only includes. the $0.50 and $1 rush hour and overnight charges', 'tests': ['not_null']}, {'name': 'mta_tax', 'description': '0.50 MTA tax that is automatically triggered based on the metered rate in use', 'tests': ['unique']}, {'name': 'tip_amount', 'description': 'Tip amount  This field is automatically populated for credit card tips.Cash tips are not included', 'tests': ['not_null']}, {'name': 'tolls_amount', 'description': 'Total amount of all tolls paid in trip', 'tests': ['not_null']}, {'name': 'improvement_surcharge', 'description': '0.30 improvement surcharge assessed trips at the flag drop. the improvement surcharge began being levied in 2015', 'tests': ['not_null']}, {'name': 'total_amount', 'description': 'The total amount charged to passengers. Does not include cash tips.', 'tests': ['not_null']}, {'name': 'payment_type', 'description': 'A numeric code signifying how the passenger paid for the trip', 'tests': ['not_null']}, {'name': 'trip_type', 'description': 'Year of pickup', 'tests': ['not_null']}, {'name': 'congestion_surcharge', 'description': 'An additional charge for trips taken during high traffic congestion times', 'tests': [None]}], 'original_file_path': 'models/tests/schema.yml', 'yaml_key': 'models', 'package_name': 'nyc_taxi'} - at path ['columns'][18]['tests'][0]: None is not valid under any of the given schemas
[2024-11-21T17:56:42.592+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:56:42.601+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 12.336 seconds
[2024-11-21T17:57:13.586+0000] {processor.py:161} INFO - Started process (PID=5394) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:57:13.587+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T17:57:13.588+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:57:13.588+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:57:13.610+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:57:13.610+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T17:57:14.387+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:57:14.387+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 0.7669837479998023
[2024-11-21T17:57:14.388+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:57:14.388+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T17:57:14.388+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:57:14.388+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T17:57:14.392+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:57:14.392+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T17:57:14.399+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:57:14.398+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T17:57:14.404+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:57:14.404+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpr4e6p52d --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T17:57:20.101+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:57:20.100+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpr4e6p52d --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T17:57:26.602+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:57:26.599+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 210, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpr4e6p52d', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
17:57:22  Running with dbt=1.8.7
17:57:24  Registered adapter: bigquery=1.8.3
17:57:24  [WARNING]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
17:57:24  Encountered an error:
Parsing Error
  Invalid models config given in models/tests/schema.yml @ models: {'name': 'fct_trips', 'description': 'Fact Table of tripdata', 'columns': [{'name': 'trip_id', 'description': 'The primary key for this table', 'tests': ['unique']}, {'name': 'vendor_id', 'description': 'A code indicating the TPEP provider that provided the record', 'tests': ['not_null']}, {'name': 'pickup_time_id', 'description': 'id to get pickup time from dim_time', 'tests': ['not_null']}, {'name': 'dropoff_time_id', 'description': 'id to get dropoff time from dim_time', 'tests': ['unique']}, {'name': 'rate_code_id', 'description': 'The final rate code in effect at the end of the trip', 'tests': ['unique']}, {'name': 'pu_location_id', 'description': 'The pickup location', 'tests': ['not_null']}, {'name': 'do_location_id', 'description': 'The droppof location', 'tests': ['not_null']}, {'name': 'passenger_count', 'description': 'Customer count', 'tests': ['unique']}, {'name': 'trip_distance', 'description': 'trip distance', 'tests': ['not_null']}, {'name': 'fare_amount', 'description': 'The time-and-distance fare calculated by the meter.', 'tests': ['not_null']}, {'name': 'extra', 'description': 'Miscellaneous extras and surcharges. Currently, this only includes. the $0.50 and $1 rush hour and overnight charges', 'tests': ['not_null']}, {'name': 'mta_tax', 'description': '0.50 MTA tax that is automatically triggered based on the metered rate in use', 'tests': ['unique']}, {'name': 'tip_amount', 'description': 'Tip amount  This field is automatically populated for credit card tips.Cash tips are not included', 'tests': ['not_null']}, {'name': 'tolls_amount', 'description': 'Total amount of all tolls paid in trip', 'tests': ['not_null']}, {'name': 'improvement_surcharge', 'description': '0.30 improvement surcharge assessed trips at the flag drop. the improvement surcharge began being levied in 2015', 'tests': ['not_null']}, {'name': 'total_amount', 'description': 'The total amount charged to passengers. Does not include cash tips.', 'tests': ['not_null']}, {'name': 'payment_type', 'description': 'A numeric code signifying how the passenger paid for the trip', 'tests': ['not_null']}, {'name': 'trip_type', 'description': 'Year of pickup', 'tests': ['not_null']}, {'name': 'congestion_surcharge', 'description': 'An additional charge for trips taken during high traffic congestion times', 'tests': [None]}], 'original_file_path': 'models/tests/schema.yml', 'yaml_key': 'models', 'package_name': 'nyc_taxi'} - at path ['columns'][18]['tests'][0]: None is not valid under any of the given schemas
[2024-11-21T17:57:26.603+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:57:26.612+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 13.031 seconds
[2024-11-21T17:57:56.816+0000] {processor.py:161} INFO - Started process (PID=5439) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:57:56.817+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T17:57:56.818+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:57:56.818+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:57:56.842+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:57:56.842+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T17:57:57.561+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:57:57.560+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 0.7088237600000866
[2024-11-21T17:57:57.561+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:57:57.561+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T17:57:57.561+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:57:57.561+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T17:57:57.566+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:57:57.566+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T17:57:57.573+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:57:57.572+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T17:57:57.578+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:57:57.578+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpzile_aml --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T17:58:00.945+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:58:00.945+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpzile_aml --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T17:58:07.051+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:58:07.047+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 210, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpzile_aml', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
17:58:03  Running with dbt=1.8.7
17:58:04  Registered adapter: bigquery=1.8.3
17:58:05  [WARNING]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
17:58:05  Encountered an error:
Parsing Error
  Invalid models config given in models/tests/schema.yml @ models: {'name': 'fct_trips', 'description': 'Fact Table of tripdata', 'columns': [{'name': 'trip_id', 'description': 'The primary key for this table', 'tests': ['unique']}, {'name': 'vendor_id', 'description': 'A code indicating the TPEP provider that provided the record', 'tests': ['not_null']}, {'name': 'pickup_time_id', 'description': 'id to get pickup time from dim_time', 'tests': ['not_null']}, {'name': 'dropoff_time_id', 'description': 'id to get dropoff time from dim_time', 'tests': ['unique']}, {'name': 'rate_code_id', 'description': 'The final rate code in effect at the end of the trip', 'tests': ['unique']}, {'name': 'pu_location_id', 'description': 'The pickup location', 'tests': ['not_null']}, {'name': 'do_location_id', 'description': 'The droppof location', 'tests': ['not_null']}, {'name': 'passenger_count', 'description': 'Customer count', 'tests': ['unique']}, {'name': 'trip_distance', 'description': 'trip distance', 'tests': ['not_null']}, {'name': 'fare_amount', 'description': 'The time-and-distance fare calculated by the meter.', 'tests': ['not_null']}, {'name': 'extra', 'description': 'Miscellaneous extras and surcharges. Currently, this only includes. the $0.50 and $1 rush hour and overnight charges', 'tests': ['not_null']}, {'name': 'mta_tax', 'description': '0.50 MTA tax that is automatically triggered based on the metered rate in use', 'tests': ['unique']}, {'name': 'tip_amount', 'description': 'Tip amount  This field is automatically populated for credit card tips.Cash tips are not included', 'tests': ['not_null']}, {'name': 'tolls_amount', 'description': 'Total amount of all tolls paid in trip', 'tests': ['not_null']}, {'name': 'improvement_surcharge', 'description': '0.30 improvement surcharge assessed trips at the flag drop. the improvement surcharge began being levied in 2015', 'tests': ['not_null']}, {'name': 'total_amount', 'description': 'The total amount charged to passengers. Does not include cash tips.', 'tests': ['not_null']}, {'name': 'payment_type', 'description': 'A numeric code signifying how the passenger paid for the trip', 'tests': ['not_null']}, {'name': 'trip_type', 'description': 'Year of pickup', 'tests': ['not_null']}, {'name': 'congestion_surcharge', 'description': 'An additional charge for trips taken during high traffic congestion times', 'tests': [None]}], 'original_file_path': 'models/tests/schema.yml', 'yaml_key': 'models', 'package_name': 'nyc_taxi'} - at path ['columns'][18]['tests'][0]: None is not valid under any of the given schemas
[2024-11-21T17:58:07.051+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:58:07.066+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 11.360 seconds
[2024-11-21T17:58:37.171+0000] {processor.py:161} INFO - Started process (PID=5491) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:58:37.172+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T17:58:37.174+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:58:37.173+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:58:37.201+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:58:37.201+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T17:58:37.938+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:58:37.938+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 0.7266697140003089
[2024-11-21T17:58:37.939+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:58:37.939+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T17:58:37.939+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:58:37.939+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T17:58:37.943+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:58:37.943+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T17:58:37.949+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:58:37.949+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T17:58:37.955+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:58:37.954+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpxs6drnix --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T17:58:44.077+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:58:44.076+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpxs6drnix --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T17:58:50.523+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:58:50.520+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 210, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpxs6drnix', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
17:58:46  Running with dbt=1.8.7
17:58:47  Registered adapter: bigquery=1.8.3
17:58:48  [WARNING]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
17:58:48  Encountered an error:
Parsing Error
  Invalid models config given in models/tests/schema.yml @ models: {'name': 'fct_trips', 'description': 'Fact Table of tripdata', 'columns': [{'name': 'trip_id', 'description': 'The primary key for this table', 'tests': ['unique']}, {'name': 'vendor_id', 'description': 'A code indicating the TPEP provider that provided the record', 'tests': ['not_null']}, {'name': 'pickup_time_id', 'description': 'id to get pickup time from dim_time', 'tests': ['not_null']}, {'name': 'dropoff_time_id', 'description': 'id to get dropoff time from dim_time', 'tests': ['unique']}, {'name': 'rate_code_id', 'description': 'The final rate code in effect at the end of the trip', 'tests': ['unique']}, {'name': 'pu_location_id', 'description': 'The pickup location', 'tests': ['not_null']}, {'name': 'do_location_id', 'description': 'The droppof location', 'tests': ['not_null']}, {'name': 'passenger_count', 'description': 'Customer count', 'tests': ['unique']}, {'name': 'trip_distance', 'description': 'trip distance', 'tests': ['not_null']}, {'name': 'fare_amount', 'description': 'The time-and-distance fare calculated by the meter.', 'tests': ['not_null']}, {'name': 'extra', 'description': 'Miscellaneous extras and surcharges. Currently, this only includes. the $0.50 and $1 rush hour and overnight charges', 'tests': ['not_null']}, {'name': 'mta_tax', 'description': '0.50 MTA tax that is automatically triggered based on the metered rate in use', 'tests': ['unique']}, {'name': 'tip_amount', 'description': 'Tip amount  This field is automatically populated for credit card tips.Cash tips are not included', 'tests': ['not_null']}, {'name': 'tolls_amount', 'description': 'Total amount of all tolls paid in trip', 'tests': ['not_null']}, {'name': 'improvement_surcharge', 'description': '0.30 improvement surcharge assessed trips at the flag drop. the improvement surcharge began being levied in 2015', 'tests': ['not_null']}, {'name': 'total_amount', 'description': 'The total amount charged to passengers. Does not include cash tips.', 'tests': ['not_null']}, {'name': 'payment_type', 'description': 'A numeric code signifying how the passenger paid for the trip', 'tests': ['not_null']}, {'name': 'trip_type', 'description': 'Year of pickup', 'tests': ['not_null']}, {'name': 'congestion_surcharge', 'description': 'An additional charge for trips taken during high traffic congestion times', 'tests': [None]}], 'original_file_path': 'models/tests/schema.yml', 'yaml_key': 'models', 'package_name': 'nyc_taxi'} - at path ['columns'][18]['tests'][0]: None is not valid under any of the given schemas
[2024-11-21T17:58:50.524+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:58:50.534+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 13.369 seconds
[2024-11-21T17:59:21.552+0000] {processor.py:161} INFO - Started process (PID=5536) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:59:21.552+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T17:59:21.554+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:59:21.553+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:59:21.576+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:59:21.576+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T17:59:22.481+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:59:22.480+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 0.8941257930000575
[2024-11-21T17:59:22.481+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:59:22.481+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T17:59:22.482+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:59:22.482+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T17:59:22.493+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:59:22.492+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T17:59:22.502+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:59:22.502+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T17:59:22.517+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:59:22.517+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpub3cbtcq --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T17:59:26.361+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:59:26.361+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpub3cbtcq --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T17:59:32.662+0000] {logging_mixin.py:188} INFO - [2024-11-21T17:59:32.659+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 210, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpub3cbtcq', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
17:59:28  Running with dbt=1.8.7
17:59:30  Registered adapter: bigquery=1.8.3
17:59:30  [WARNING]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
17:59:30  Encountered an error:
Parsing Error
  Invalid models config given in models/tests/schema.yml @ models: {'name': 'fct_trips', 'description': 'Fact Table of tripdata', 'columns': [{'name': 'trip_id', 'description': 'The primary key for this table', 'tests': ['unique']}, {'name': 'vendor_id', 'description': 'A code indicating the TPEP provider that provided the record', 'tests': ['not_null']}, {'name': 'pickup_time_id', 'description': 'id to get pickup time from dim_time', 'tests': ['not_null']}, {'name': 'dropoff_time_id', 'description': 'id to get dropoff time from dim_time', 'tests': ['unique']}, {'name': 'rate_code_id', 'description': 'The final rate code in effect at the end of the trip', 'tests': ['unique']}, {'name': 'pu_location_id', 'description': 'The pickup location', 'tests': ['not_null']}, {'name': 'do_location_id', 'description': 'The droppof location', 'tests': ['not_null']}, {'name': 'passenger_count', 'description': 'Customer count', 'tests': ['unique']}, {'name': 'trip_distance', 'description': 'trip distance', 'tests': ['not_null']}, {'name': 'fare_amount', 'description': 'The time-and-distance fare calculated by the meter.', 'tests': ['not_null']}, {'name': 'extra', 'description': 'Miscellaneous extras and surcharges. Currently, this only includes. the $0.50 and $1 rush hour and overnight charges', 'tests': ['not_null']}, {'name': 'mta_tax', 'description': '0.50 MTA tax that is automatically triggered based on the metered rate in use', 'tests': ['unique']}, {'name': 'tip_amount', 'description': 'Tip amount  This field is automatically populated for credit card tips.Cash tips are not included', 'tests': ['not_null']}, {'name': 'tolls_amount', 'description': 'Total amount of all tolls paid in trip', 'tests': ['not_null']}, {'name': 'improvement_surcharge', 'description': '0.30 improvement surcharge assessed trips at the flag drop. the improvement surcharge began being levied in 2015', 'tests': ['not_null']}, {'name': 'total_amount', 'description': 'The total amount charged to passengers. Does not include cash tips.', 'tests': ['not_null']}, {'name': 'payment_type', 'description': 'A numeric code signifying how the passenger paid for the trip', 'tests': ['not_null']}, {'name': 'trip_type', 'description': 'Year of pickup', 'tests': ['not_null']}, {'name': 'congestion_surcharge', 'description': 'An additional charge for trips taken during high traffic congestion times', 'tests': [None]}], 'original_file_path': 'models/tests/schema.yml', 'yaml_key': 'models', 'package_name': 'nyc_taxi'} - at path ['columns'][18]['tests'][0]: None is not valid under any of the given schemas
[2024-11-21T17:59:32.663+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T17:59:32.673+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 12.261 seconds
[2024-11-21T18:00:02.758+0000] {processor.py:161} INFO - Started process (PID=5588) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T18:00:02.759+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T18:00:02.760+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:00:02.760+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T18:00:02.782+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:00:02.782+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T18:00:03.516+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:00:03.516+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 0.7240714669997033
[2024-11-21T18:00:03.517+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:00:03.517+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T18:00:03.517+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:00:03.517+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T18:00:03.521+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:00:03.520+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T18:00:03.527+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:00:03.526+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T18:00:03.532+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:00:03.532+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpf3bb1_j_ --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T18:00:08.676+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:00:08.675+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpf3bb1_j_ --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T18:00:14.971+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:00:14.968+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 210, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpf3bb1_j_', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
18:00:10  Running with dbt=1.8.7
18:00:12  Registered adapter: bigquery=1.8.3
18:00:13  [WARNING]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
18:00:13  Encountered an error:
Parsing Error
  Invalid models config given in models/tests/schema.yml @ models: {'name': 'fct_trips', 'description': 'Fact Table of tripdata', 'columns': [{'name': 'trip_id', 'description': 'The primary key for this table', 'tests': ['unique']}, {'name': 'vendor_id', 'description': 'A code indicating the TPEP provider that provided the record', 'tests': ['not_null']}, {'name': 'pickup_time_id', 'description': 'id to get pickup time from dim_time', 'tests': ['not_null']}, {'name': 'dropoff_time_id', 'description': 'id to get dropoff time from dim_time', 'tests': ['unique']}, {'name': 'rate_code_id', 'description': 'The final rate code in effect at the end of the trip', 'tests': ['unique']}, {'name': 'pu_location_id', 'description': 'The pickup location', 'tests': ['not_null']}, {'name': 'do_location_id', 'description': 'The droppof location', 'tests': ['not_null']}, {'name': 'passenger_count', 'description': 'Customer count', 'tests': ['unique']}, {'name': 'trip_distance', 'description': 'trip distance', 'tests': ['not_null']}, {'name': 'fare_amount', 'description': 'The time-and-distance fare calculated by the meter.', 'tests': ['not_null']}, {'name': 'extra', 'description': 'Miscellaneous extras and surcharges. Currently, this only includes. the $0.50 and $1 rush hour and overnight charges', 'tests': ['not_null']}, {'name': 'mta_tax', 'description': '0.50 MTA tax that is automatically triggered based on the metered rate in use', 'tests': ['unique']}, {'name': 'tip_amount', 'description': 'Tip amount  This field is automatically populated for credit card tips.Cash tips are not included', 'tests': ['not_null']}, {'name': 'tolls_amount', 'description': 'Total amount of all tolls paid in trip', 'tests': ['not_null']}, {'name': 'improvement_surcharge', 'description': '0.30 improvement surcharge assessed trips at the flag drop. the improvement surcharge began being levied in 2015', 'tests': ['not_null']}, {'name': 'total_amount', 'description': 'The total amount charged to passengers. Does not include cash tips.', 'tests': ['not_null']}, {'name': 'payment_type', 'description': 'A numeric code signifying how the passenger paid for the trip', 'tests': ['not_null']}, {'name': 'trip_type', 'description': 'Year of pickup', 'tests': ['not_null']}, {'name': 'congestion_surcharge', 'description': 'An additional charge for trips taken during high traffic congestion times', 'tests': [None]}], 'original_file_path': 'models/tests/schema.yml', 'yaml_key': 'models', 'package_name': 'nyc_taxi'} - at path ['columns'][18]['tests'][0]: None is not valid under any of the given schemas
[2024-11-21T18:00:14.972+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T18:00:14.988+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 12.235 seconds
[2024-11-21T18:00:45.044+0000] {processor.py:161} INFO - Started process (PID=5633) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T18:00:45.045+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T18:00:45.046+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:00:45.046+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T18:00:45.069+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:00:45.069+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T18:00:45.918+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:00:45.918+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 0.8383998199997222
[2024-11-21T18:00:45.918+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:00:45.918+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T18:00:45.919+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:00:45.919+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T18:00:45.922+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:00:45.922+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T18:00:45.929+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:00:45.929+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T18:00:45.935+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:00:45.935+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpioxlo99b --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T18:00:50.675+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:00:50.674+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpioxlo99b --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T18:00:55.656+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:00:55.652+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 210, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpioxlo99b', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
18:00:52  Running with dbt=1.8.7
18:00:53  Registered adapter: bigquery=1.8.3
18:00:54  [WARNING]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
18:00:54  Encountered an error:
Parsing Error
  Invalid models config given in models/tests/schema.yml @ models: {'name': 'fct_trips', 'description': 'Fact Table of tripdata', 'columns': [{'name': 'trip_id', 'description': 'The primary key for this table', 'tests': ['unique']}, {'name': 'vendor_id', 'description': 'A code indicating the TPEP provider that provided the record', 'tests': ['not_null']}, {'name': 'pickup_time_id', 'description': 'id to get pickup time from dim_time', 'tests': ['not_null']}, {'name': 'dropoff_time_id', 'description': 'id to get dropoff time from dim_time', 'tests': ['unique']}, {'name': 'rate_code_id', 'description': 'The final rate code in effect at the end of the trip', 'tests': ['unique']}, {'name': 'pu_location_id', 'description': 'The pickup location', 'tests': ['not_null']}, {'name': 'do_location_id', 'description': 'The droppof location', 'tests': ['not_null']}, {'name': 'passenger_count', 'description': 'Customer count', 'tests': ['unique']}, {'name': 'trip_distance', 'description': 'trip distance', 'tests': ['not_null']}, {'name': 'fare_amount', 'description': 'The time-and-distance fare calculated by the meter.', 'tests': ['not_null']}, {'name': 'extra', 'description': 'Miscellaneous extras and surcharges. Currently, this only includes. the $0.50 and $1 rush hour and overnight charges', 'tests': ['not_null']}, {'name': 'mta_tax', 'description': '0.50 MTA tax that is automatically triggered based on the metered rate in use', 'tests': ['unique']}, {'name': 'tip_amount', 'description': 'Tip amount  This field is automatically populated for credit card tips.Cash tips are not included', 'tests': ['not_null']}, {'name': 'tolls_amount', 'description': 'Total amount of all tolls paid in trip', 'tests': ['not_null']}, {'name': 'improvement_surcharge', 'description': '0.30 improvement surcharge assessed trips at the flag drop. the improvement surcharge began being levied in 2015', 'tests': ['not_null']}, {'name': 'total_amount', 'description': 'The total amount charged to passengers. Does not include cash tips.', 'tests': ['not_null']}, {'name': 'payment_type', 'description': 'A numeric code signifying how the passenger paid for the trip', 'tests': ['not_null']}, {'name': 'trip_type', 'description': 'Year of pickup', 'tests': ['not_null']}, {'name': 'congestion_surcharge', 'description': 'An additional charge for trips taken during high traffic congestion times', 'tests': [None]}], 'original_file_path': 'models/tests/schema.yml', 'yaml_key': 'models', 'package_name': 'nyc_taxi'} - at path ['columns'][18]['tests'][0]: None is not valid under any of the given schemas
[2024-11-21T18:00:55.656+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T18:00:55.666+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 11.795 seconds
[2024-11-21T18:01:25.883+0000] {processor.py:161} INFO - Started process (PID=5684) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T18:01:25.884+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T18:01:25.885+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:01:25.885+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T18:01:25.911+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:01:25.911+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T18:01:26.841+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:01:26.841+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 0.9187738860000536
[2024-11-21T18:01:26.842+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:01:26.842+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T18:01:26.842+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:01:26.842+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T18:01:26.847+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:01:26.847+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T18:01:26.854+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:01:26.854+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T18:01:26.862+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:01:26.861+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp3x0qsmbu --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T18:01:32.041+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:01:32.041+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp3x0qsmbu --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T18:01:38.567+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:01:38.563+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 210, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmp3x0qsmbu', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
18:01:34  Running with dbt=1.8.7
18:01:35  Registered adapter: bigquery=1.8.3
18:01:36  [WARNING]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
18:01:36  Encountered an error:
Parsing Error
  Invalid models config given in models/tests/schema.yml @ models: {'name': 'fct_trips', 'description': 'Fact Table of tripdata', 'columns': [{'name': 'trip_id', 'description': 'The primary key for this table', 'tests': ['unique']}, {'name': 'vendor_id', 'description': 'A code indicating the TPEP provider that provided the record', 'tests': ['not_null']}, {'name': 'pickup_time_id', 'description': 'id to get pickup time from dim_time', 'tests': ['not_null']}, {'name': 'dropoff_time_id', 'description': 'id to get dropoff time from dim_time', 'tests': ['unique']}, {'name': 'rate_code_id', 'description': 'The final rate code in effect at the end of the trip', 'tests': ['unique']}, {'name': 'pu_location_id', 'description': 'The pickup location', 'tests': ['not_null']}, {'name': 'do_location_id', 'description': 'The droppof location', 'tests': ['not_null']}, {'name': 'passenger_count', 'description': 'Customer count', 'tests': ['unique']}, {'name': 'trip_distance', 'description': 'trip distance', 'tests': ['not_null']}, {'name': 'fare_amount', 'description': 'The time-and-distance fare calculated by the meter.', 'tests': ['not_null']}, {'name': 'extra', 'description': 'Miscellaneous extras and surcharges. Currently, this only includes. the $0.50 and $1 rush hour and overnight charges', 'tests': ['not_null']}, {'name': 'mta_tax', 'description': '0.50 MTA tax that is automatically triggered based on the metered rate in use', 'tests': ['unique']}, {'name': 'tip_amount', 'description': 'Tip amount  This field is automatically populated for credit card tips.Cash tips are not included', 'tests': ['not_null']}, {'name': 'tolls_amount', 'description': 'Total amount of all tolls paid in trip', 'tests': ['not_null']}, {'name': 'improvement_surcharge', 'description': '0.30 improvement surcharge assessed trips at the flag drop. the improvement surcharge began being levied in 2015', 'tests': ['not_null']}, {'name': 'total_amount', 'description': 'The total amount charged to passengers. Does not include cash tips.', 'tests': ['not_null']}, {'name': 'payment_type', 'description': 'A numeric code signifying how the passenger paid for the trip', 'tests': ['not_null']}, {'name': 'trip_type', 'description': 'Year of pickup', 'tests': ['not_null']}, {'name': 'congestion_surcharge', 'description': 'An additional charge for trips taken during high traffic congestion times', 'tests': [None]}], 'original_file_path': 'models/tests/schema.yml', 'yaml_key': 'models', 'package_name': 'nyc_taxi'} - at path ['columns'][18]['tests'][0]: None is not valid under any of the given schemas
[2024-11-21T18:01:38.567+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T18:01:38.577+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 12.700 seconds
[2024-11-21T18:02:09.244+0000] {processor.py:161} INFO - Started process (PID=5730) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T18:02:09.245+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T18:02:09.246+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:02:09.246+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T18:02:09.269+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:02:09.268+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T18:02:10.067+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:02:10.067+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 0.7873028479998538
[2024-11-21T18:02:10.068+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:02:10.067+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T18:02:10.068+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:02:10.068+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T18:02:10.072+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:02:10.072+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T18:02:10.078+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:02:10.078+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T18:02:10.084+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:02:10.084+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp9p3jfsec --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T18:02:15.917+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:02:15.917+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp9p3jfsec --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T18:02:21.043+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:02:21.039+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 210, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmp9p3jfsec', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
18:02:18  Running with dbt=1.8.7
18:02:19  Registered adapter: bigquery=1.8.3
18:02:20  [WARNING]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
18:02:19  Encountered an error:
Parsing Error
  Invalid models config given in models/tests/schema.yml @ models: {'name': 'fct_trips', 'description': 'Fact Table of tripdata', 'columns': [{'name': 'trip_id', 'description': 'The primary key for this table', 'tests': ['unique']}, {'name': 'vendor_id', 'description': 'A code indicating the TPEP provider that provided the record', 'tests': ['not_null']}, {'name': 'pickup_time_id', 'description': 'id to get pickup time from dim_time', 'tests': ['not_null']}, {'name': 'dropoff_time_id', 'description': 'id to get dropoff time from dim_time', 'tests': ['unique']}, {'name': 'rate_code_id', 'description': 'The final rate code in effect at the end of the trip', 'tests': ['unique']}, {'name': 'pu_location_id', 'description': 'The pickup location', 'tests': ['not_null']}, {'name': 'do_location_id', 'description': 'The droppof location', 'tests': ['not_null']}, {'name': 'passenger_count', 'description': 'Customer count', 'tests': ['unique']}, {'name': 'trip_distance', 'description': 'trip distance', 'tests': ['not_null']}, {'name': 'fare_amount', 'description': 'The time-and-distance fare calculated by the meter.', 'tests': ['not_null']}, {'name': 'extra', 'description': 'Miscellaneous extras and surcharges. Currently, this only includes. the $0.50 and $1 rush hour and overnight charges', 'tests': ['not_null']}, {'name': 'mta_tax', 'description': '0.50 MTA tax that is automatically triggered based on the metered rate in use', 'tests': ['unique']}, {'name': 'tip_amount', 'description': 'Tip amount  This field is automatically populated for credit card tips.Cash tips are not included', 'tests': ['not_null']}, {'name': 'tolls_amount', 'description': 'Total amount of all tolls paid in trip', 'tests': ['not_null']}, {'name': 'improvement_surcharge', 'description': '0.30 improvement surcharge assessed trips at the flag drop. the improvement surcharge began being levied in 2015', 'tests': ['not_null']}, {'name': 'total_amount', 'description': 'The total amount charged to passengers. Does not include cash tips.', 'tests': ['not_null']}, {'name': 'payment_type', 'description': 'A numeric code signifying how the passenger paid for the trip', 'tests': ['not_null']}, {'name': 'trip_type', 'description': 'Year of pickup', 'tests': ['not_null']}, {'name': 'congestion_surcharge', 'description': 'An additional charge for trips taken during high traffic congestion times', 'tests': [None]}], 'original_file_path': 'models/tests/schema.yml', 'yaml_key': 'models', 'package_name': 'nyc_taxi'} - at path ['columns'][18]['tests'][0]: None is not valid under any of the given schemas
[2024-11-21T18:02:21.044+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T18:02:21.054+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 12.943 seconds
[2024-11-21T18:02:51.471+0000] {processor.py:161} INFO - Started process (PID=5781) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T18:02:51.472+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T18:02:51.473+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:02:51.473+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T18:02:51.496+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:02:51.496+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T18:02:52.250+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:02:52.250+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 0.7428068080007506
[2024-11-21T18:02:52.250+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:02:52.250+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T18:02:52.251+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:02:52.251+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T18:02:52.256+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:02:52.256+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T18:02:52.263+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:02:52.262+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T18:02:52.268+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:02:52.268+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpbunzwaid --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T18:02:57.063+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:02:57.062+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpbunzwaid --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T18:03:03.146+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:03:03.142+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 210, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpbunzwaid', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
18:02:59  Running with dbt=1.8.7
18:03:00  Registered adapter: bigquery=1.8.3
18:03:01  [WARNING]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
18:03:01  Encountered an error:
Parsing Error
  Invalid models config given in models/tests/schema.yml @ models: {'name': 'fct_trips', 'description': 'Fact Table of tripdata', 'columns': [{'name': 'trip_id', 'description': 'The primary key for this table', 'tests': ['unique']}, {'name': 'vendor_id', 'description': 'A code indicating the TPEP provider that provided the record', 'tests': ['not_null']}, {'name': 'pickup_time_id', 'description': 'id to get pickup time from dim_time', 'tests': ['not_null']}, {'name': 'dropoff_time_id', 'description': 'id to get dropoff time from dim_time', 'tests': ['unique']}, {'name': 'rate_code_id', 'description': 'The final rate code in effect at the end of the trip', 'tests': ['unique']}, {'name': 'pu_location_id', 'description': 'The pickup location', 'tests': ['not_null']}, {'name': 'do_location_id', 'description': 'The droppof location', 'tests': ['not_null']}, {'name': 'passenger_count', 'description': 'Customer count', 'tests': ['unique']}, {'name': 'trip_distance', 'description': 'trip distance', 'tests': ['not_null']}, {'name': 'fare_amount', 'description': 'The time-and-distance fare calculated by the meter.', 'tests': ['not_null']}, {'name': 'extra', 'description': 'Miscellaneous extras and surcharges. Currently, this only includes. the $0.50 and $1 rush hour and overnight charges', 'tests': ['not_null']}, {'name': 'mta_tax', 'description': '0.50 MTA tax that is automatically triggered based on the metered rate in use', 'tests': ['unique']}, {'name': 'tip_amount', 'description': 'Tip amount  This field is automatically populated for credit card tips.Cash tips are not included', 'tests': ['not_null']}, {'name': 'tolls_amount', 'description': 'Total amount of all tolls paid in trip', 'tests': ['not_null']}, {'name': 'improvement_surcharge', 'description': '0.30 improvement surcharge assessed trips at the flag drop. the improvement surcharge began being levied in 2015', 'tests': ['not_null']}, {'name': 'total_amount', 'description': 'The total amount charged to passengers. Does not include cash tips.', 'tests': ['not_null']}, {'name': 'payment_type', 'description': 'A numeric code signifying how the passenger paid for the trip', 'tests': ['not_null']}, {'name': 'trip_type', 'description': 'Year of pickup', 'tests': ['not_null']}, {'name': 'congestion_surcharge', 'description': 'An additional charge for trips taken during high traffic congestion times', 'tests': [None]}], 'original_file_path': 'models/tests/schema.yml', 'yaml_key': 'models', 'package_name': 'nyc_taxi'} - at path ['columns'][18]['tests'][0]: None is not valid under any of the given schemas
[2024-11-21T18:03:03.146+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T18:03:03.161+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 11.696 seconds
[2024-11-21T18:03:33.851+0000] {processor.py:161} INFO - Started process (PID=5827) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T18:03:33.851+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T18:03:33.853+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:03:33.853+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T18:03:33.874+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:03:33.874+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T18:03:34.664+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:03:34.664+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 0.7792784180001036
[2024-11-21T18:03:34.664+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:03:34.664+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T18:03:34.665+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:03:34.665+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T18:03:34.669+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:03:34.668+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T18:03:34.675+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:03:34.674+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T18:03:34.680+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:03:34.680+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpz4n9haqg --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T18:03:39.221+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:03:39.221+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpz4n9haqg --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T18:03:45.430+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:03:45.427+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 210, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpz4n9haqg', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
18:03:41  Running with dbt=1.8.7
18:03:42  Registered adapter: bigquery=1.8.3
18:03:43  [WARNING]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
18:03:43  Encountered an error:
Parsing Error
  Invalid models config given in models/tests/schema.yml @ models: {'name': 'fct_trips', 'description': 'Fact Table of tripdata', 'columns': [{'name': 'trip_id', 'description': 'The primary key for this table', 'tests': ['unique']}, {'name': 'vendor_id', 'description': 'A code indicating the TPEP provider that provided the record', 'tests': ['not_null']}, {'name': 'pickup_time_id', 'description': 'id to get pickup time from dim_time', 'tests': ['not_null']}, {'name': 'dropoff_time_id', 'description': 'id to get dropoff time from dim_time', 'tests': ['unique']}, {'name': 'rate_code_id', 'description': 'The final rate code in effect at the end of the trip', 'tests': ['unique']}, {'name': 'pu_location_id', 'description': 'The pickup location', 'tests': ['not_null']}, {'name': 'do_location_id', 'description': 'The droppof location', 'tests': ['not_null']}, {'name': 'passenger_count', 'description': 'Customer count', 'tests': ['unique']}, {'name': 'trip_distance', 'description': 'trip distance', 'tests': ['not_null']}, {'name': 'fare_amount', 'description': 'The time-and-distance fare calculated by the meter.', 'tests': ['not_null']}, {'name': 'extra', 'description': 'Miscellaneous extras and surcharges. Currently, this only includes. the $0.50 and $1 rush hour and overnight charges', 'tests': ['not_null']}, {'name': 'mta_tax', 'description': '0.50 MTA tax that is automatically triggered based on the metered rate in use', 'tests': ['unique']}, {'name': 'tip_amount', 'description': 'Tip amount  This field is automatically populated for credit card tips.Cash tips are not included', 'tests': ['not_null']}, {'name': 'tolls_amount', 'description': 'Total amount of all tolls paid in trip', 'tests': ['not_null']}, {'name': 'improvement_surcharge', 'description': '0.30 improvement surcharge assessed trips at the flag drop. the improvement surcharge began being levied in 2015', 'tests': ['not_null']}, {'name': 'total_amount', 'description': 'The total amount charged to passengers. Does not include cash tips.', 'tests': ['not_null']}, {'name': 'payment_type', 'description': 'A numeric code signifying how the passenger paid for the trip', 'tests': ['not_null']}, {'name': 'trip_type', 'description': 'Year of pickup', 'tests': ['not_null']}, {'name': 'congestion_surcharge', 'description': 'An additional charge for trips taken during high traffic congestion times', 'tests': [None]}], 'original_file_path': 'models/tests/schema.yml', 'yaml_key': 'models', 'package_name': 'nyc_taxi'} - at path ['columns'][18]['tests'][0]: None is not valid under any of the given schemas
[2024-11-21T18:03:45.431+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T18:03:45.447+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 11.601 seconds
[2024-11-21T18:04:16.170+0000] {processor.py:161} INFO - Started process (PID=5872) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T18:04:16.171+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T18:04:16.172+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:04:16.172+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T18:04:16.195+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:04:16.195+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T18:04:17.018+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:04:17.018+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 0.811795587999768
[2024-11-21T18:04:17.019+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:04:17.019+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T18:04:17.019+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:04:17.019+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T18:04:17.024+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:04:17.024+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T18:04:17.031+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:04:17.030+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T18:04:17.037+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:04:17.036+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpyy8fplcn --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T18:04:22.137+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:04:22.136+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpyy8fplcn --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T18:04:28.422+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:04:28.419+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 210, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpyy8fplcn', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
18:04:24  Running with dbt=1.8.7
18:04:25  Registered adapter: bigquery=1.8.3
18:04:26  [WARNING]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
18:04:26  Encountered an error:
Parsing Error
  Invalid models config given in models/tests/schema.yml @ models: {'name': 'fct_trips', 'description': 'Fact Table of tripdata', 'columns': [{'name': 'trip_id', 'description': 'The primary key for this table', 'tests': ['unique']}, {'name': 'vendor_id', 'description': 'A code indicating the TPEP provider that provided the record', 'tests': ['not_null']}, {'name': 'pickup_time_id', 'description': 'id to get pickup time from dim_time', 'tests': ['not_null']}, {'name': 'dropoff_time_id', 'description': 'id to get dropoff time from dim_time', 'tests': ['unique']}, {'name': 'rate_code_id', 'description': 'The final rate code in effect at the end of the trip', 'tests': ['unique']}, {'name': 'pu_location_id', 'description': 'The pickup location', 'tests': ['not_null']}, {'name': 'do_location_id', 'description': 'The droppof location', 'tests': ['not_null']}, {'name': 'passenger_count', 'description': 'Customer count', 'tests': ['unique']}, {'name': 'trip_distance', 'description': 'trip distance', 'tests': ['not_null']}, {'name': 'fare_amount', 'description': 'The time-and-distance fare calculated by the meter.', 'tests': ['not_null']}, {'name': 'extra', 'description': 'Miscellaneous extras and surcharges. Currently, this only includes. the $0.50 and $1 rush hour and overnight charges', 'tests': ['not_null']}, {'name': 'mta_tax', 'description': '0.50 MTA tax that is automatically triggered based on the metered rate in use', 'tests': ['unique']}, {'name': 'tip_amount', 'description': 'Tip amount  This field is automatically populated for credit card tips.Cash tips are not included', 'tests': ['not_null']}, {'name': 'tolls_amount', 'description': 'Total amount of all tolls paid in trip', 'tests': ['not_null']}, {'name': 'improvement_surcharge', 'description': '0.30 improvement surcharge assessed trips at the flag drop. the improvement surcharge began being levied in 2015', 'tests': ['not_null']}, {'name': 'total_amount', 'description': 'The total amount charged to passengers. Does not include cash tips.', 'tests': ['not_null']}, {'name': 'payment_type', 'description': 'A numeric code signifying how the passenger paid for the trip', 'tests': ['not_null']}, {'name': 'trip_type', 'description': 'Year of pickup', 'tests': ['not_null']}, {'name': 'congestion_surcharge', 'description': 'An additional charge for trips taken during high traffic congestion times', 'tests': [None]}], 'original_file_path': 'models/tests/schema.yml', 'yaml_key': 'models', 'package_name': 'nyc_taxi'} - at path ['columns'][18]['tests'][0]: None is not valid under any of the given schemas
[2024-11-21T18:04:28.423+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T18:04:28.438+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 12.273 seconds
[2024-11-21T18:04:58.648+0000] {processor.py:161} INFO - Started process (PID=5923) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T18:04:58.649+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T18:04:58.650+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:04:58.650+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T18:04:58.671+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:04:58.671+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T18:04:59.444+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:04:59.444+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 0.7626612049998585
[2024-11-21T18:04:59.445+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:04:59.445+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T18:04:59.445+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:04:59.445+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T18:04:59.450+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:04:59.450+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T18:04:59.458+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:04:59.458+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T18:04:59.466+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:04:59.465+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpbd0fzihk --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T18:05:04.092+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:05:04.091+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpbd0fzihk --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T18:05:10.161+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:05:10.157+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 210, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpbd0fzihk', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
18:05:06  Running with dbt=1.8.7
18:05:07  Registered adapter: bigquery=1.8.3
18:05:08  [WARNING]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
18:05:08  Encountered an error:
Parsing Error
  Invalid models config given in models/tests/schema.yml @ models: {'name': 'fct_trips', 'description': 'Fact Table of tripdata', 'columns': [{'name': 'trip_id', 'description': 'The primary key for this table', 'tests': ['unique']}, {'name': 'vendor_id', 'description': 'A code indicating the TPEP provider that provided the record', 'tests': ['not_null']}, {'name': 'pickup_time_id', 'description': 'id to get pickup time from dim_time', 'tests': ['not_null']}, {'name': 'dropoff_time_id', 'description': 'id to get dropoff time from dim_time', 'tests': ['unique']}, {'name': 'rate_code_id', 'description': 'The final rate code in effect at the end of the trip', 'tests': ['unique']}, {'name': 'pu_location_id', 'description': 'The pickup location', 'tests': ['not_null']}, {'name': 'do_location_id', 'description': 'The droppof location', 'tests': ['not_null']}, {'name': 'passenger_count', 'description': 'Customer count', 'tests': ['unique']}, {'name': 'trip_distance', 'description': 'trip distance', 'tests': ['not_null']}, {'name': 'fare_amount', 'description': 'The time-and-distance fare calculated by the meter.', 'tests': ['not_null']}, {'name': 'extra', 'description': 'Miscellaneous extras and surcharges. Currently, this only includes. the $0.50 and $1 rush hour and overnight charges', 'tests': ['not_null']}, {'name': 'mta_tax', 'description': '0.50 MTA tax that is automatically triggered based on the metered rate in use', 'tests': ['unique']}, {'name': 'tip_amount', 'description': 'Tip amount  This field is automatically populated for credit card tips.Cash tips are not included', 'tests': ['not_null']}, {'name': 'tolls_amount', 'description': 'Total amount of all tolls paid in trip', 'tests': ['not_null']}, {'name': 'improvement_surcharge', 'description': '0.30 improvement surcharge assessed trips at the flag drop. the improvement surcharge began being levied in 2015', 'tests': ['not_null']}, {'name': 'total_amount', 'description': 'The total amount charged to passengers. Does not include cash tips.', 'tests': ['not_null']}, {'name': 'payment_type', 'description': 'A numeric code signifying how the passenger paid for the trip', 'tests': ['not_null']}, {'name': 'trip_type', 'description': 'Year of pickup', 'tests': ['not_null']}, {'name': 'congestion_surcharge', 'description': 'An additional charge for trips taken during high traffic congestion times', 'tests': [None]}], 'original_file_path': 'models/tests/schema.yml', 'yaml_key': 'models', 'package_name': 'nyc_taxi'} - at path ['columns'][18]['tests'][0]: None is not valid under any of the given schemas
[2024-11-21T18:05:10.161+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T18:05:10.171+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 11.528 seconds
[2024-11-21T18:05:41.133+0000] {processor.py:161} INFO - Started process (PID=5969) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T18:05:41.133+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T18:05:41.135+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:05:41.135+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T18:05:41.156+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:05:41.155+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T18:05:41.870+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:05:41.870+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 0.7043530780001674
[2024-11-21T18:05:41.870+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:05:41.870+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T18:05:41.871+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:05:41.871+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T18:05:41.875+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:05:41.874+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T18:05:41.881+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:05:41.881+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T18:05:41.886+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:05:41.886+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpclecz_4b --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T18:05:45.269+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:05:45.268+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpclecz_4b --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T18:05:51.382+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:05:51.379+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 210, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpclecz_4b', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
18:05:47  Running with dbt=1.8.7
18:05:48  Registered adapter: bigquery=1.8.3
18:05:49  [WARNING]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
18:05:49  Encountered an error:
Parsing Error
  Invalid models config given in models/tests/schema.yml @ models: {'name': 'fct_trips', 'description': 'Fact Table of tripdata', 'columns': [{'name': 'trip_id', 'description': 'The primary key for this table', 'tests': ['unique']}, {'name': 'vendor_id', 'description': 'A code indicating the TPEP provider that provided the record', 'tests': ['not_null']}, {'name': 'pickup_time_id', 'description': 'id to get pickup time from dim_time', 'tests': ['not_null']}, {'name': 'dropoff_time_id', 'description': 'id to get dropoff time from dim_time', 'tests': ['unique']}, {'name': 'rate_code_id', 'description': 'The final rate code in effect at the end of the trip', 'tests': ['unique']}, {'name': 'pu_location_id', 'description': 'The pickup location', 'tests': ['not_null']}, {'name': 'do_location_id', 'description': 'The droppof location', 'tests': ['not_null']}, {'name': 'passenger_count', 'description': 'Customer count', 'tests': ['unique']}, {'name': 'trip_distance', 'description': 'trip distance', 'tests': ['not_null']}, {'name': 'fare_amount', 'description': 'The time-and-distance fare calculated by the meter.', 'tests': ['not_null']}, {'name': 'extra', 'description': 'Miscellaneous extras and surcharges. Currently, this only includes. the $0.50 and $1 rush hour and overnight charges', 'tests': ['not_null']}, {'name': 'mta_tax', 'description': '0.50 MTA tax that is automatically triggered based on the metered rate in use', 'tests': ['unique']}, {'name': 'tip_amount', 'description': 'Tip amount  This field is automatically populated for credit card tips.Cash tips are not included', 'tests': ['not_null']}, {'name': 'tolls_amount', 'description': 'Total amount of all tolls paid in trip', 'tests': ['not_null']}, {'name': 'improvement_surcharge', 'description': '0.30 improvement surcharge assessed trips at the flag drop. the improvement surcharge began being levied in 2015', 'tests': ['not_null']}, {'name': 'total_amount', 'description': 'The total amount charged to passengers. Does not include cash tips.', 'tests': ['not_null']}, {'name': 'payment_type', 'description': 'A numeric code signifying how the passenger paid for the trip', 'tests': ['not_null']}, {'name': 'trip_type', 'description': 'Year of pickup', 'tests': ['not_null']}, {'name': 'congestion_surcharge', 'description': 'An additional charge for trips taken during high traffic congestion times', 'tests': [None]}], 'original_file_path': 'models/tests/schema.yml', 'yaml_key': 'models', 'package_name': 'nyc_taxi'} - at path ['columns'][18]['tests'][0]: None is not valid under any of the given schemas
[2024-11-21T18:05:51.383+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T18:05:51.394+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 11.407 seconds
[2024-11-21T18:06:22.339+0000] {processor.py:161} INFO - Started process (PID=6020) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T18:06:22.340+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T18:06:22.342+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:06:22.341+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T18:06:22.364+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:06:22.364+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T18:06:23.092+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:06:23.091+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 0.7173618180004269
[2024-11-21T18:06:23.092+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:06:23.092+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T18:06:23.092+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:06:23.092+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T18:06:23.096+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:06:23.096+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T18:06:23.103+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:06:23.103+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T18:06:23.108+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:06:23.108+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpnhxepiir --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T18:06:27.644+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:06:27.643+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpnhxepiir --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T18:06:34.330+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:06:34.327+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 210, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpnhxepiir', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
18:06:29  Running with dbt=1.8.7
18:06:31  Registered adapter: bigquery=1.8.3
18:06:32  [WARNING]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
18:06:32  Encountered an error:
Parsing Error
  Invalid models config given in models/tests/schema.yml @ models: {'name': 'fct_trips', 'description': 'Fact Table of tripdata', 'columns': [{'name': 'trip_id', 'description': 'The primary key for this table', 'tests': ['unique']}, {'name': 'vendor_id', 'description': 'A code indicating the TPEP provider that provided the record', 'tests': ['not_null']}, {'name': 'pickup_time_id', 'description': 'id to get pickup time from dim_time', 'tests': ['not_null']}, {'name': 'dropoff_time_id', 'description': 'id to get dropoff time from dim_time', 'tests': ['unique']}, {'name': 'rate_code_id', 'description': 'The final rate code in effect at the end of the trip', 'tests': ['unique']}, {'name': 'pu_location_id', 'description': 'The pickup location', 'tests': ['not_null']}, {'name': 'do_location_id', 'description': 'The droppof location', 'tests': ['not_null']}, {'name': 'passenger_count', 'description': 'Customer count', 'tests': ['unique']}, {'name': 'trip_distance', 'description': 'trip distance', 'tests': ['not_null']}, {'name': 'fare_amount', 'description': 'The time-and-distance fare calculated by the meter.', 'tests': ['not_null']}, {'name': 'extra', 'description': 'Miscellaneous extras and surcharges. Currently, this only includes. the $0.50 and $1 rush hour and overnight charges', 'tests': ['not_null']}, {'name': 'mta_tax', 'description': '0.50 MTA tax that is automatically triggered based on the metered rate in use', 'tests': ['unique']}, {'name': 'tip_amount', 'description': 'Tip amount  This field is automatically populated for credit card tips.Cash tips are not included', 'tests': ['not_null']}, {'name': 'tolls_amount', 'description': 'Total amount of all tolls paid in trip', 'tests': ['not_null']}, {'name': 'improvement_surcharge', 'description': '0.30 improvement surcharge assessed trips at the flag drop. the improvement surcharge began being levied in 2015', 'tests': ['not_null']}, {'name': 'total_amount', 'description': 'The total amount charged to passengers. Does not include cash tips.', 'tests': ['not_null']}, {'name': 'payment_type', 'description': 'A numeric code signifying how the passenger paid for the trip', 'tests': ['not_null']}, {'name': 'trip_type', 'description': 'Year of pickup', 'tests': ['not_null']}, {'name': 'congestion_surcharge', 'description': 'An additional charge for trips taken during high traffic congestion times', 'tests': [None]}], 'original_file_path': 'models/tests/schema.yml', 'yaml_key': 'models', 'package_name': 'nyc_taxi'} - at path ['columns'][18]['tests'][0]: None is not valid under any of the given schemas
[2024-11-21T18:06:34.331+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T18:06:34.343+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 12.008 seconds
[2024-11-21T18:07:04.693+0000] {processor.py:161} INFO - Started process (PID=6066) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T18:07:04.694+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T18:07:04.695+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:07:04.695+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T18:07:04.718+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:07:04.718+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T18:07:05.568+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:07:05.567+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 0.8366082929996992
[2024-11-21T18:07:05.568+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:07:05.568+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T18:07:05.569+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:07:05.568+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T18:07:05.573+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:07:05.573+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T18:07:05.580+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:07:05.580+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T18:07:05.586+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:07:05.586+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp2ivko3ji --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T18:07:09.513+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:07:09.513+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp2ivko3ji --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T18:07:15.945+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:07:15.942+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 210, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmp2ivko3ji', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
18:07:11  Running with dbt=1.8.7
18:07:13  Registered adapter: bigquery=1.8.3
18:07:14  [WARNING]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
18:07:14  Encountered an error:
Parsing Error
  Invalid models config given in models/tests/schema.yml @ models: {'name': 'fct_trips', 'description': 'Fact Table of tripdata', 'columns': [{'name': 'trip_id', 'description': 'The primary key for this table', 'tests': ['unique']}, {'name': 'vendor_id', 'description': 'A code indicating the TPEP provider that provided the record', 'tests': ['not_null']}, {'name': 'pickup_time_id', 'description': 'id to get pickup time from dim_time', 'tests': ['not_null']}, {'name': 'dropoff_time_id', 'description': 'id to get dropoff time from dim_time', 'tests': ['unique']}, {'name': 'rate_code_id', 'description': 'The final rate code in effect at the end of the trip', 'tests': ['unique']}, {'name': 'pu_location_id', 'description': 'The pickup location', 'tests': ['not_null']}, {'name': 'do_location_id', 'description': 'The droppof location', 'tests': ['not_null']}, {'name': 'passenger_count', 'description': 'Customer count', 'tests': ['unique']}, {'name': 'trip_distance', 'description': 'trip distance', 'tests': ['not_null']}, {'name': 'fare_amount', 'description': 'The time-and-distance fare calculated by the meter.', 'tests': ['not_null']}, {'name': 'extra', 'description': 'Miscellaneous extras and surcharges. Currently, this only includes. the $0.50 and $1 rush hour and overnight charges', 'tests': ['not_null']}, {'name': 'mta_tax', 'description': '0.50 MTA tax that is automatically triggered based on the metered rate in use', 'tests': ['unique']}, {'name': 'tip_amount', 'description': 'Tip amount  This field is automatically populated for credit card tips.Cash tips are not included', 'tests': ['not_null']}, {'name': 'tolls_amount', 'description': 'Total amount of all tolls paid in trip', 'tests': ['not_null']}, {'name': 'improvement_surcharge', 'description': '0.30 improvement surcharge assessed trips at the flag drop. the improvement surcharge began being levied in 2015', 'tests': ['not_null']}, {'name': 'total_amount', 'description': 'The total amount charged to passengers. Does not include cash tips.', 'tests': ['not_null']}, {'name': 'payment_type', 'description': 'A numeric code signifying how the passenger paid for the trip', 'tests': ['not_null']}, {'name': 'trip_type', 'description': 'Year of pickup', 'tests': ['not_null']}, {'name': 'congestion_surcharge', 'description': 'An additional charge for trips taken during high traffic congestion times', 'tests': [None]}], 'original_file_path': 'models/tests/schema.yml', 'yaml_key': 'models', 'package_name': 'nyc_taxi'} - at path ['columns'][18]['tests'][0]: None is not valid under any of the given schemas
[2024-11-21T18:07:15.946+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T18:07:15.962+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 12.443 seconds
[2024-11-21T18:07:46.790+0000] {processor.py:161} INFO - Started process (PID=6117) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T18:07:46.790+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T18:07:46.792+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:07:46.791+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T18:07:46.814+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:07:46.814+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T18:07:47.554+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:07:47.554+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 0.7295050120001179
[2024-11-21T18:07:47.555+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:07:47.554+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T18:07:47.555+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:07:47.555+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T18:07:47.559+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:07:47.559+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T18:07:47.565+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:07:47.565+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T18:07:47.571+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:07:47.571+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpxdk4e8sc --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T18:07:52.291+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:07:52.290+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpxdk4e8sc --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T18:07:58.580+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:07:58.576+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 210, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpxdk4e8sc', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
18:07:54  Running with dbt=1.8.7
18:07:55  Registered adapter: bigquery=1.8.3
18:07:56  [WARNING]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
18:07:56  Encountered an error:
Parsing Error
  Invalid models config given in models/tests/schema.yml @ models: {'name': 'fct_trips', 'description': 'Fact Table of tripdata', 'columns': [{'name': 'trip_id', 'description': 'The primary key for this table', 'tests': ['unique']}, {'name': 'vendor_id', 'description': 'A code indicating the TPEP provider that provided the record', 'tests': ['not_null']}, {'name': 'pickup_time_id', 'description': 'id to get pickup time from dim_time', 'tests': ['not_null']}, {'name': 'dropoff_time_id', 'description': 'id to get dropoff time from dim_time', 'tests': ['unique']}, {'name': 'rate_code_id', 'description': 'The final rate code in effect at the end of the trip', 'tests': ['unique']}, {'name': 'pu_location_id', 'description': 'The pickup location', 'tests': ['not_null']}, {'name': 'do_location_id', 'description': 'The droppof location', 'tests': ['not_null']}, {'name': 'passenger_count', 'description': 'Customer count', 'tests': ['unique']}, {'name': 'trip_distance', 'description': 'trip distance', 'tests': ['not_null']}, {'name': 'fare_amount', 'description': 'The time-and-distance fare calculated by the meter.', 'tests': ['not_null']}, {'name': 'extra', 'description': 'Miscellaneous extras and surcharges. Currently, this only includes. the $0.50 and $1 rush hour and overnight charges', 'tests': ['not_null']}, {'name': 'mta_tax', 'description': '0.50 MTA tax that is automatically triggered based on the metered rate in use', 'tests': ['unique']}, {'name': 'tip_amount', 'description': 'Tip amount  This field is automatically populated for credit card tips.Cash tips are not included', 'tests': ['not_null']}, {'name': 'tolls_amount', 'description': 'Total amount of all tolls paid in trip', 'tests': ['not_null']}, {'name': 'improvement_surcharge', 'description': '0.30 improvement surcharge assessed trips at the flag drop. the improvement surcharge began being levied in 2015', 'tests': ['not_null']}, {'name': 'total_amount', 'description': 'The total amount charged to passengers. Does not include cash tips.', 'tests': ['not_null']}, {'name': 'payment_type', 'description': 'A numeric code signifying how the passenger paid for the trip', 'tests': ['not_null']}, {'name': 'trip_type', 'description': 'Year of pickup', 'tests': ['not_null']}, {'name': 'congestion_surcharge', 'description': 'An additional charge for trips taken during high traffic congestion times', 'tests': [None]}], 'original_file_path': 'models/tests/schema.yml', 'yaml_key': 'models', 'package_name': 'nyc_taxi'} - at path ['columns'][18]['tests'][0]: None is not valid under any of the given schemas
[2024-11-21T18:07:58.581+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T18:07:58.597+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 11.812 seconds
[2024-11-21T18:08:29.078+0000] {processor.py:161} INFO - Started process (PID=6162) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T18:08:29.079+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T18:08:29.080+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:08:29.080+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T18:08:29.103+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:08:29.103+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T18:08:29.839+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:08:29.839+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 0.7255070319997685
[2024-11-21T18:08:29.840+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:08:29.840+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T18:08:29.840+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:08:29.840+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T18:08:29.844+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:08:29.844+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T18:08:29.850+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:08:29.850+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T18:08:29.856+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:08:29.856+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp511te4vv --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T18:08:34.694+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:08:34.694+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp511te4vv --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T18:08:40.081+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:08:40.077+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 210, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmp511te4vv', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
18:08:35  Running with dbt=1.8.7
18:08:37  Registered adapter: bigquery=1.8.3
18:08:38  [WARNING]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
18:08:38  Encountered an error:
Parsing Error
  Invalid models config given in models/tests/schema.yml @ models: {'name': 'fct_trips', 'description': 'Fact Table of tripdata', 'columns': [{'name': 'trip_id', 'description': 'The primary key for this table', 'tests': ['unique']}, {'name': 'vendor_id', 'description': 'A code indicating the TPEP provider that provided the record', 'tests': ['not_null']}, {'name': 'pickup_time_id', 'description': 'id to get pickup time from dim_time', 'tests': ['not_null']}, {'name': 'dropoff_time_id', 'description': 'id to get dropoff time from dim_time', 'tests': ['unique']}, {'name': 'rate_code_id', 'description': 'The final rate code in effect at the end of the trip', 'tests': ['unique']}, {'name': 'pu_location_id', 'description': 'The pickup location', 'tests': ['not_null']}, {'name': 'do_location_id', 'description': 'The droppof location', 'tests': ['not_null']}, {'name': 'passenger_count', 'description': 'Customer count', 'tests': ['unique']}, {'name': 'trip_distance', 'description': 'trip distance', 'tests': ['not_null']}, {'name': 'fare_amount', 'description': 'The time-and-distance fare calculated by the meter.', 'tests': ['not_null']}, {'name': 'extra', 'description': 'Miscellaneous extras and surcharges. Currently, this only includes. the $0.50 and $1 rush hour and overnight charges', 'tests': ['not_null']}, {'name': 'mta_tax', 'description': '0.50 MTA tax that is automatically triggered based on the metered rate in use', 'tests': ['unique']}, {'name': 'tip_amount', 'description': 'Tip amount  This field is automatically populated for credit card tips.Cash tips are not included', 'tests': ['not_null']}, {'name': 'tolls_amount', 'description': 'Total amount of all tolls paid in trip', 'tests': ['not_null']}, {'name': 'improvement_surcharge', 'description': '0.30 improvement surcharge assessed trips at the flag drop. the improvement surcharge began being levied in 2015', 'tests': ['not_null']}, {'name': 'total_amount', 'description': 'The total amount charged to passengers. Does not include cash tips.', 'tests': ['not_null']}, {'name': 'payment_type', 'description': 'A numeric code signifying how the passenger paid for the trip', 'tests': ['not_null']}, {'name': 'trip_type', 'description': 'Year of pickup', 'tests': ['not_null']}, {'name': 'congestion_surcharge', 'description': 'An additional charge for trips taken during high traffic congestion times', 'tests': [None]}], 'original_file_path': 'models/tests/schema.yml', 'yaml_key': 'models', 'package_name': 'nyc_taxi'} - at path ['columns'][18]['tests'][0]: None is not valid under any of the given schemas
[2024-11-21T18:08:40.082+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T18:08:40.092+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 12.213 seconds
[2024-11-21T18:09:10.576+0000] {processor.py:161} INFO - Started process (PID=6215) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T18:09:10.578+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T18:09:10.583+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:09:10.582+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T18:09:10.688+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:09:10.688+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T18:09:14.679+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:09:14.679+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 3.9601085979993513
[2024-11-21T18:09:14.680+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:09:14.680+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T18:09:14.682+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:09:14.681+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T18:09:14.699+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:09:14.698+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T18:09:14.721+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:09:14.721+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T18:09:14.740+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:09:14.739+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp5lbexk1v --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T18:09:24.920+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:09:24.919+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp5lbexk1v --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T18:09:38.657+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:09:38.645+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 210, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmp5lbexk1v', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
18:09:31  Running with dbt=1.8.7
18:09:33  Registered adapter: bigquery=1.8.3
18:09:35  [WARNING]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
18:09:35  Encountered an error:
Parsing Error
  Invalid models config given in models/tests/schema.yml @ models: {'name': 'fct_trips', 'description': 'Fact Table of tripdata', 'columns': [{'name': 'trip_id', 'description': 'The primary key for this table', 'tests': ['unique']}, {'name': 'vendor_id', 'description': 'A code indicating the TPEP provider that provided the record', 'tests': ['not_null']}, {'name': 'pickup_time_id', 'description': 'id to get pickup time from dim_time', 'tests': ['not_null']}, {'name': 'dropoff_time_id', 'description': 'id to get dropoff time from dim_time', 'tests': ['unique']}, {'name': 'rate_code_id', 'description': 'The final rate code in effect at the end of the trip', 'tests': ['unique']}, {'name': 'pu_location_id', 'description': 'The pickup location', 'tests': ['not_null']}, {'name': 'do_location_id', 'description': 'The droppof location', 'tests': ['not_null']}, {'name': 'passenger_count', 'description': 'Customer count', 'tests': ['unique']}, {'name': 'trip_distance', 'description': 'trip distance', 'tests': ['not_null']}, {'name': 'fare_amount', 'description': 'The time-and-distance fare calculated by the meter.', 'tests': ['not_null']}, {'name': 'extra', 'description': 'Miscellaneous extras and surcharges. Currently, this only includes. the $0.50 and $1 rush hour and overnight charges', 'tests': ['not_null']}, {'name': 'mta_tax', 'description': '0.50 MTA tax that is automatically triggered based on the metered rate in use', 'tests': ['unique']}, {'name': 'tip_amount', 'description': 'Tip amount  This field is automatically populated for credit card tips.Cash tips are not included', 'tests': ['not_null']}, {'name': 'tolls_amount', 'description': 'Total amount of all tolls paid in trip', 'tests': ['not_null']}, {'name': 'improvement_surcharge', 'description': '0.30 improvement surcharge assessed trips at the flag drop. the improvement surcharge began being levied in 2015', 'tests': ['not_null']}, {'name': 'total_amount', 'description': 'The total amount charged to passengers. Does not include cash tips.', 'tests': ['not_null']}, {'name': 'payment_type', 'description': 'A numeric code signifying how the passenger paid for the trip', 'tests': ['not_null']}, {'name': 'trip_type', 'description': 'Year of pickup', 'tests': ['not_null']}, {'name': 'congestion_surcharge', 'description': 'An additional charge for trips taken during high traffic congestion times', 'tests': [None]}], 'original_file_path': 'models/tests/schema.yml', 'yaml_key': 'models', 'package_name': 'nyc_taxi'} - at path ['columns'][18]['tests'][0]: None is not valid under any of the given schemas
[2024-11-21T18:09:38.659+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T18:09:38.682+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 29.352 seconds
[2024-11-21T18:10:09.545+0000] {processor.py:161} INFO - Started process (PID=6267) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T18:10:09.549+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T18:10:09.553+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:10:09.552+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T18:10:09.655+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:10:09.655+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T18:10:13.732+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:10:13.732+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 4.044614595999519
[2024-11-21T18:10:13.733+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:10:13.733+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T18:10:13.735+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:10:13.734+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T18:10:13.753+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:10:13.752+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T18:10:13.769+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:10:13.768+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T18:10:13.793+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:10:13.792+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpp3dimv48 --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T18:10:23.254+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:10:23.253+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpp3dimv48 --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T18:10:36.811+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:10:36.801+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 210, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpp3dimv48', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
18:10:29  Running with dbt=1.8.7
18:10:31  Registered adapter: bigquery=1.8.3
18:10:34  [WARNING]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
18:10:34  Encountered an error:
Parsing Error
  Invalid models config given in models/tests/schema.yml @ models: {'name': 'fct_trips', 'description': 'Fact Table of tripdata', 'columns': [{'name': 'trip_id', 'description': 'The primary key for this table', 'tests': ['unique']}, {'name': 'vendor_id', 'description': 'A code indicating the TPEP provider that provided the record', 'tests': ['not_null']}, {'name': 'pickup_time_id', 'description': 'id to get pickup time from dim_time', 'tests': ['not_null']}, {'name': 'dropoff_time_id', 'description': 'id to get dropoff time from dim_time', 'tests': ['not_null']}, {'name': 'rate_code_id', 'description': 'The final rate code in effect at the end of the trip', 'tests': ['not_null']}, {'name': 'pu_location_id', 'description': 'The pickup location', 'tests': ['not_null']}, {'name': 'do_location_id', 'description': 'The droppof location', 'tests': ['not_null']}, {'name': 'passenger_count', 'description': 'Customer count', 'tests': ['not_null']}, {'name': 'trip_distance', 'description': 'trip distance', 'tests': ['not_null']}, {'name': 'fare_amount', 'description': 'The time-and-distance fare calculated by the meter.', 'tests': ['not_null']}, {'name': 'extra', 'description': 'Miscellaneous extras and surcharges. Currently, this only includes. the $0.50 and $1 rush hour and overnight charges', 'tests': ['not_null']}, {'name': 'mta_tax', 'description': '0.50 MTA tax that is automatically triggered based on the metered rate in use', 'tests': ['not_null']}, {'name': 'tip_amount', 'description': 'Tip amount  This field is automatically populated for credit card tips.Cash tips are not included', 'tests': ['not_null']}, {'name': 'tolls_amount', 'description': 'Total amount of all tolls paid in trip', 'tests': ['not_null']}, {'name': 'improvement_surcharge', 'description': '0.30 improvement surcharge assessed trips at the flag drop. the improvement surcharge began being levied in 2015', 'tests': ['not_null']}, {'name': 'total_amount', 'description': 'The total amount charged to passengers. Does not include cash tips.', 'tests': ['not_null']}, {'name': 'payment_type', 'description': 'A numeric code signifying how the passenger paid for the trip', 'tests': ['not_null']}, {'name': 'trip_type', 'description': 'Year of pickup', 'tests': ['not_null']}, {'name': 'congestion_surcharge', 'description': 'An additional charge for trips taken during high traffic congestion times', 'tests': [None]}], 'original_file_path': 'models/tests/schema.yml', 'yaml_key': 'models', 'package_name': 'nyc_taxi'} - at path ['columns'][18]['tests'][0]: None is not valid under any of the given schemas
[2024-11-21T18:10:36.812+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T18:10:36.837+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 28.499 seconds
[2024-11-21T18:11:07.324+0000] {processor.py:161} INFO - Started process (PID=6319) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T18:11:07.327+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T18:11:07.331+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:11:07.331+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T18:11:07.418+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:11:07.418+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T18:11:11.065+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:11:11.065+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 3.617285751000054
[2024-11-21T18:11:11.067+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:11:11.066+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T18:11:11.068+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:11:11.067+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T18:11:11.084+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:11:11.083+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T18:11:11.099+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:11:11.098+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T18:11:11.121+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:11:11.121+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpjlp2o3re --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T18:11:20.415+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:11:20.414+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpjlp2o3re --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T18:11:34.063+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:11:34.050+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 210, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpjlp2o3re', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
18:11:26  Running with dbt=1.8.7
18:11:28  Registered adapter: bigquery=1.8.3
18:11:31  [WARNING]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
18:11:31  Encountered an error:
Parsing Error
  Invalid models config given in models/tests/schema.yml @ models: {'name': 'fct_trips', 'description': 'Fact Table of tripdata', 'columns': [{'name': 'trip_id', 'description': 'The primary key for this table', 'tests': ['unique']}, {'name': 'vendor_id', 'description': 'A code indicating the TPEP provider that provided the record', 'tests': ['not_null']}, {'name': 'pickup_time_id', 'description': 'id to get pickup time from dim_time', 'tests': ['not_null']}, {'name': 'dropoff_time_id', 'description': 'id to get dropoff time from dim_time', 'tests': ['not_null']}, {'name': 'rate_code_id', 'description': 'The final rate code in effect at the end of the trip', 'tests': ['not_null']}, {'name': 'pu_location_id', 'description': 'The pickup location', 'tests': ['not_null']}, {'name': 'do_location_id', 'description': 'The droppof location', 'tests': ['not_null']}, {'name': 'passenger_count', 'description': 'Customer count', 'tests': ['not_null']}, {'name': 'trip_distance', 'description': 'trip distance', 'tests': ['not_null']}, {'name': 'fare_amount', 'description': 'The time-and-distance fare calculated by the meter.', 'tests': ['not_null']}, {'name': 'extra', 'description': 'Miscellaneous extras and surcharges. Currently, this only includes. the $0.50 and $1 rush hour and overnight charges', 'tests': ['not_null']}, {'name': 'mta_tax', 'description': '0.50 MTA tax that is automatically triggered based on the metered rate in use', 'tests': ['not_null']}, {'name': 'tip_amount', 'description': 'Tip amount  This field is automatically populated for credit card tips.Cash tips are not included', 'tests': ['not_null']}, {'name': 'tolls_amount', 'description': 'Total amount of all tolls paid in trip', 'tests': ['not_null']}, {'name': 'improvement_surcharge', 'description': '0.30 improvement surcharge assessed trips at the flag drop. the improvement surcharge began being levied in 2015', 'tests': ['not_null']}, {'name': 'total_amount', 'description': 'The total amount charged to passengers. Does not include cash tips.', 'tests': ['not_null']}, {'name': 'payment_type', 'description': 'A numeric code signifying how the passenger paid for the trip', 'tests': ['not_null']}, {'name': 'trip_type', 'description': 'Year of pickup', 'tests': ['not_null']}, {'name': 'congestion_surcharge', 'description': 'An additional charge for trips taken during high traffic congestion times', 'tests': [None]}], 'original_file_path': 'models/tests/schema.yml', 'yaml_key': 'models', 'package_name': 'nyc_taxi'} - at path ['columns'][18]['tests'][0]: None is not valid under any of the given schemas
[2024-11-21T18:11:34.065+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T18:11:34.094+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 27.946 seconds
[2024-11-21T18:12:04.201+0000] {processor.py:161} INFO - Started process (PID=6370) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T18:12:04.203+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T18:12:04.208+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:12:04.207+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T18:12:04.303+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:12:04.302+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T18:12:07.557+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:12:07.556+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 3.226927667000382
[2024-11-21T18:12:07.558+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:12:07.557+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T18:12:07.559+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:12:07.559+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T18:12:07.572+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:12:07.571+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T18:12:07.585+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:12:07.585+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T18:12:07.603+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:12:07.603+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpl83qwj2q --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T18:12:17.194+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:12:17.192+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpl83qwj2q --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T18:12:30.376+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:12:30.366+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 210, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpl83qwj2q', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
18:12:22  Running with dbt=1.8.7
18:12:25  Registered adapter: bigquery=1.8.3
18:12:28  [WARNING]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
18:12:28  Encountered an error:
Parsing Error
  Invalid models config given in models/tests/schema.yml @ models: {'name': 'fct_trips', 'description': 'Fact Table of tripdata', 'columns': [{'name': 'trip_id', 'description': 'The primary key for this table', 'tests': ['unique']}, {'name': 'vendor_id', 'description': 'A code indicating the TPEP provider that provided the record', 'tests': ['not_null']}, {'name': 'pickup_time_id', 'description': 'id to get pickup time from dim_time', 'tests': ['not_null']}, {'name': 'dropoff_time_id', 'description': 'id to get dropoff time from dim_time', 'tests': ['not_null']}, {'name': 'rate_code_id', 'description': 'The final rate code in effect at the end of the trip', 'tests': ['not_null']}, {'name': 'pu_location_id', 'description': 'The pickup location', 'tests': ['not_null']}, {'name': 'do_location_id', 'description': 'The droppof location', 'tests': ['not_null']}, {'name': 'passenger_count', 'description': 'Customer count', 'tests': ['not_null']}, {'name': 'trip_distance', 'description': 'trip distance', 'tests': ['not_null']}, {'name': 'fare_amount', 'description': 'The time-and-distance fare calculated by the meter.', 'tests': ['not_null']}, {'name': 'extra', 'description': 'Miscellaneous extras and surcharges. Currently, this only includes. the $0.50 and $1 rush hour and overnight charges', 'tests': ['not_null']}, {'name': 'mta_tax', 'description': '0.50 MTA tax that is automatically triggered based on the metered rate in use', 'tests': ['not_null']}, {'name': 'tip_amount', 'description': 'Tip amount  This field is automatically populated for credit card tips.Cash tips are not included', 'tests': ['not_null']}, {'name': 'tolls_amount', 'description': 'Total amount of all tolls paid in trip', 'tests': ['not_null']}, {'name': 'improvement_surcharge', 'description': '0.30 improvement surcharge assessed trips at the flag drop. the improvement surcharge began being levied in 2015', 'tests': ['not_null']}, {'name': 'total_amount', 'description': 'The total amount charged to passengers. Does not include cash tips.', 'tests': ['not_null']}, {'name': 'payment_type', 'description': 'A numeric code signifying how the passenger paid for the trip', 'tests': ['not_null']}, {'name': 'trip_type', 'description': 'Year of pickup', 'tests': ['not_null']}, {'name': 'congestion_surcharge', 'description': 'An additional charge for trips taken during high traffic congestion times', 'tests': [None]}], 'original_file_path': 'models/tests/schema.yml', 'yaml_key': 'models', 'package_name': 'nyc_taxi'} - at path ['columns'][18]['tests'][0]: None is not valid under any of the given schemas
[2024-11-21T18:12:30.378+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T18:12:30.407+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 27.406 seconds
[2024-11-21T18:13:00.816+0000] {processor.py:161} INFO - Started process (PID=6422) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T18:13:00.818+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T18:13:00.822+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:13:00.821+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T18:13:00.917+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:13:00.916+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T18:13:04.644+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:13:04.643+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 3.6950693449998653
[2024-11-21T18:13:04.645+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:13:04.645+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T18:13:04.646+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:13:04.646+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T18:13:04.665+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:13:04.665+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T18:13:04.681+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:13:04.680+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T18:13:04.705+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:13:04.705+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpl8q8fcwq --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T18:13:13.849+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:13:13.848+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpl8q8fcwq --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T18:13:27.322+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:13:27.309+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 210, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpl8q8fcwq', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
18:13:19  Running with dbt=1.8.7
18:13:23  Registered adapter: bigquery=1.8.3
18:13:24  [WARNING]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
18:13:24  Encountered an error:
Parsing Error
  Invalid models config given in models/tests/schema.yml @ models: {'name': 'fct_trips', 'description': 'Fact Table of tripdata', 'columns': [{'name': 'trip_id', 'description': 'The primary key for this table', 'tests': ['unique']}, {'name': 'vendor_id', 'description': 'A code indicating the TPEP provider that provided the record', 'tests': ['not_null']}, {'name': 'pickup_time_id', 'description': 'id to get pickup time from dim_time', 'tests': ['not_null']}, {'name': 'dropoff_time_id', 'description': 'id to get dropoff time from dim_time', 'tests': ['not_null']}, {'name': 'rate_code_id', 'description': 'The final rate code in effect at the end of the trip', 'tests': ['not_null']}, {'name': 'pu_location_id', 'description': 'The pickup location', 'tests': ['not_null']}, {'name': 'do_location_id', 'description': 'The droppof location', 'tests': ['not_null']}, {'name': 'passenger_count', 'description': 'Customer count', 'tests': ['not_null']}, {'name': 'trip_distance', 'description': 'trip distance', 'tests': ['not_null']}, {'name': 'fare_amount', 'description': 'The time-and-distance fare calculated by the meter.', 'tests': ['not_null']}, {'name': 'extra', 'description': 'Miscellaneous extras and surcharges. Currently, this only includes. the $0.50 and $1 rush hour and overnight charges', 'tests': ['not_null']}, {'name': 'mta_tax', 'description': '0.50 MTA tax that is automatically triggered based on the metered rate in use', 'tests': ['not_null']}, {'name': 'tip_amount', 'description': 'Tip amount  This field is automatically populated for credit card tips.Cash tips are not included', 'tests': ['not_null']}, {'name': 'tolls_amount', 'description': 'Total amount of all tolls paid in trip', 'tests': ['not_null']}, {'name': 'improvement_surcharge', 'description': '0.30 improvement surcharge assessed trips at the flag drop. the improvement surcharge began being levied in 2015', 'tests': ['not_null']}, {'name': 'total_amount', 'description': 'The total amount charged to passengers. Does not include cash tips.', 'tests': ['not_null']}, {'name': 'payment_type', 'description': 'A numeric code signifying how the passenger paid for the trip', 'tests': ['not_null']}, {'name': 'trip_type', 'description': 'Year of pickup', 'tests': ['not_null']}, {'name': 'congestion_surcharge', 'description': 'An additional charge for trips taken during high traffic congestion times', 'tests': [None]}], 'original_file_path': 'models/tests/schema.yml', 'yaml_key': 'models', 'package_name': 'nyc_taxi'} - at path ['columns'][18]['tests'][0]: None is not valid under any of the given schemas
[2024-11-21T18:13:27.324+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T18:13:27.349+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 27.696 seconds
[2024-11-21T18:13:57.693+0000] {processor.py:161} INFO - Started process (PID=6475) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T18:13:57.696+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T18:13:57.702+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:13:57.702+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T18:13:57.807+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:13:57.807+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T18:14:01.641+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:14:01.640+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 3.803768210000271
[2024-11-21T18:14:01.642+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:14:01.642+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T18:14:01.644+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:14:01.643+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T18:14:01.661+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:14:01.660+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T18:14:01.682+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:14:01.682+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T18:14:01.701+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:14:01.700+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmprx3lsli4 --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T18:14:11.755+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:14:11.754+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmprx3lsli4 --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T18:14:25.110+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:14:25.098+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 210, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmprx3lsli4', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
18:14:17  Running with dbt=1.8.7
18:14:20  Registered adapter: bigquery=1.8.3
18:14:22  [WARNING]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
18:14:22  Encountered an error:
Parsing Error
  Invalid models config given in models/tests/schema.yml @ models: {'name': 'fct_trips', 'description': 'Fact Table of tripdata', 'columns': [{'name': 'trip_id', 'description': 'The primary key for this table', 'tests': ['unique']}, {'name': 'vendor_id', 'description': 'A code indicating the TPEP provider that provided the record', 'tests': ['not_null']}, {'name': 'pickup_time_id', 'description': 'id to get pickup time from dim_time', 'tests': ['not_null']}, {'name': 'dropoff_time_id', 'description': 'id to get dropoff time from dim_time', 'tests': ['not_null']}, {'name': 'rate_code_id', 'description': 'The final rate code in effect at the end of the trip', 'tests': ['not_null']}, {'name': 'pu_location_id', 'description': 'The pickup location', 'tests': ['not_null']}, {'name': 'do_location_id', 'description': 'The droppof location', 'tests': ['not_null']}, {'name': 'passenger_count', 'description': 'Customer count', 'tests': ['not_null']}, {'name': 'trip_distance', 'description': 'trip distance', 'tests': ['not_null']}, {'name': 'fare_amount', 'description': 'The time-and-distance fare calculated by the meter.', 'tests': ['not_null']}, {'name': 'extra', 'description': 'Miscellaneous extras and surcharges. Currently, this only includes. the $0.50 and $1 rush hour and overnight charges', 'tests': ['not_null']}, {'name': 'mta_tax', 'description': '0.50 MTA tax that is automatically triggered based on the metered rate in use', 'tests': ['not_null']}, {'name': 'tip_amount', 'description': 'Tip amount  This field is automatically populated for credit card tips.Cash tips are not included', 'tests': ['not_null']}, {'name': 'tolls_amount', 'description': 'Total amount of all tolls paid in trip', 'tests': ['not_null']}, {'name': 'improvement_surcharge', 'description': '0.30 improvement surcharge assessed trips at the flag drop. the improvement surcharge began being levied in 2015', 'tests': ['not_null']}, {'name': 'total_amount', 'description': 'The total amount charged to passengers. Does not include cash tips.', 'tests': ['not_null']}, {'name': 'payment_type', 'description': 'A numeric code signifying how the passenger paid for the trip', 'tests': ['not_null']}, {'name': 'trip_type', 'description': 'Year of pickup', 'tests': ['not_null']}, {'name': 'congestion_surcharge', 'description': 'An additional charge for trips taken during high traffic congestion times', 'tests': [None]}], 'original_file_path': 'models/tests/schema.yml', 'yaml_key': 'models', 'package_name': 'nyc_taxi'} - at path ['columns'][18]['tests'][0]: None is not valid under any of the given schemas
[2024-11-21T18:14:25.112+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T18:14:25.142+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 28.633 seconds
[2024-11-21T18:14:55.417+0000] {processor.py:161} INFO - Started process (PID=6527) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T18:14:55.419+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T18:14:55.422+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:14:55.422+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T18:14:55.525+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:14:55.524+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T18:14:59.327+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:14:59.326+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 3.775808397000219
[2024-11-21T18:14:59.328+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:14:59.328+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T18:14:59.329+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:14:59.329+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T18:14:59.349+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:14:59.348+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T18:14:59.363+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:14:59.362+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T18:14:59.383+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:14:59.382+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpy5ferf3i --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T18:15:09.008+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:15:09.007+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpy5ferf3i --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T18:15:22.831+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:15:22.818+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 210, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpy5ferf3i', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
18:15:15  Running with dbt=1.8.7
18:15:18  Registered adapter: bigquery=1.8.3
18:15:20  [WARNING]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
18:15:20  Encountered an error:
Parsing Error
  Invalid models config given in models/tests/schema.yml @ models: {'name': 'fct_trips', 'description': 'Fact Table of tripdata', 'columns': [{'name': 'trip_id', 'description': 'The primary key for this table', 'tests': ['unique']}, {'name': 'vendor_id', 'description': 'A code indicating the TPEP provider that provided the record', 'tests': ['not_null']}, {'name': 'pickup_time_id', 'description': 'id to get pickup time from dim_time', 'tests': ['not_null']}, {'name': 'dropoff_time_id', 'description': 'id to get dropoff time from dim_time', 'tests': ['not_null']}, {'name': 'rate_code_id', 'description': 'The final rate code in effect at the end of the trip', 'tests': ['not_null']}, {'name': 'pu_location_id', 'description': 'The pickup location', 'tests': ['not_null']}, {'name': 'do_location_id', 'description': 'The droppof location', 'tests': ['not_null']}, {'name': 'passenger_count', 'description': 'Customer count', 'tests': ['not_null']}, {'name': 'trip_distance', 'description': 'trip distance', 'tests': ['not_null']}, {'name': 'fare_amount', 'description': 'The time-and-distance fare calculated by the meter.', 'tests': ['not_null']}, {'name': 'extra', 'description': 'Miscellaneous extras and surcharges. Currently, this only includes. the $0.50 and $1 rush hour and overnight charges', 'tests': ['not_null']}, {'name': 'mta_tax', 'description': '0.50 MTA tax that is automatically triggered based on the metered rate in use', 'tests': ['not_null']}, {'name': 'tip_amount', 'description': 'Tip amount  This field is automatically populated for credit card tips.Cash tips are not included', 'tests': ['not_null']}, {'name': 'tolls_amount', 'description': 'Total amount of all tolls paid in trip', 'tests': ['not_null']}, {'name': 'improvement_surcharge', 'description': '0.30 improvement surcharge assessed trips at the flag drop. the improvement surcharge began being levied in 2015', 'tests': ['not_null']}, {'name': 'total_amount', 'description': 'The total amount charged to passengers. Does not include cash tips.', 'tests': ['not_null']}, {'name': 'payment_type', 'description': 'A numeric code signifying how the passenger paid for the trip', 'tests': ['not_null']}, {'name': 'trip_type', 'description': 'Year of pickup', 'tests': ['not_null']}, {'name': 'congestion_surcharge', 'description': 'An additional charge for trips taken during high traffic congestion times', 'tests': [None]}], 'original_file_path': 'models/tests/schema.yml', 'yaml_key': 'models', 'package_name': 'nyc_taxi'} - at path ['columns'][18]['tests'][0]: None is not valid under any of the given schemas
[2024-11-21T18:15:22.833+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T18:15:22.865+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 28.579 seconds
[2024-11-21T18:15:53.215+0000] {processor.py:161} INFO - Started process (PID=6579) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T18:15:53.217+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T18:15:53.220+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:15:53.220+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T18:15:53.316+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:15:53.316+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T18:15:57.224+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:15:57.224+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 3.880252298999949
[2024-11-21T18:15:57.225+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:15:57.225+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T18:15:57.227+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:15:57.226+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T18:15:57.244+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:15:57.243+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T18:15:57.261+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:15:57.260+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T18:15:57.285+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:15:57.284+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpeygp8im8 --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T18:16:06.751+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:16:06.750+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpeygp8im8 --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T18:16:19.842+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:16:19.830+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 210, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpeygp8im8', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
18:16:12  Running with dbt=1.8.7
18:16:15  Registered adapter: bigquery=1.8.3
18:16:17  [WARNING]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
18:16:17  Encountered an error:
Parsing Error
  Invalid models config given in models/tests/schema.yml @ models: {'name': 'fct_trips', 'description': 'Fact Table of tripdata', 'columns': [{'name': 'trip_id', 'description': 'The primary key for this table', 'tests': ['unique']}, {'name': 'vendor_id', 'description': 'A code indicating the TPEP provider that provided the record', 'tests': ['not_null']}, {'name': 'pickup_time_id', 'description': 'id to get pickup time from dim_time', 'tests': ['not_null']}, {'name': 'dropoff_time_id', 'description': 'id to get dropoff time from dim_time', 'tests': ['not_null']}, {'name': 'rate_code_id', 'description': 'The final rate code in effect at the end of the trip', 'tests': ['not_null']}, {'name': 'pu_location_id', 'description': 'The pickup location', 'tests': ['not_null']}, {'name': 'do_location_id', 'description': 'The droppof location', 'tests': ['not_null']}, {'name': 'passenger_count', 'description': 'Customer count', 'tests': ['not_null']}, {'name': 'trip_distance', 'description': 'trip distance', 'tests': ['not_null']}, {'name': 'fare_amount', 'description': 'The time-and-distance fare calculated by the meter.', 'tests': ['not_null']}, {'name': 'extra', 'description': 'Miscellaneous extras and surcharges. Currently, this only includes. the $0.50 and $1 rush hour and overnight charges', 'tests': ['not_null']}, {'name': 'mta_tax', 'description': '0.50 MTA tax that is automatically triggered based on the metered rate in use', 'tests': ['not_null']}, {'name': 'tip_amount', 'description': 'Tip amount  This field is automatically populated for credit card tips.Cash tips are not included', 'tests': ['not_null']}, {'name': 'tolls_amount', 'description': 'Total amount of all tolls paid in trip', 'tests': ['not_null']}, {'name': 'improvement_surcharge', 'description': '0.30 improvement surcharge assessed trips at the flag drop. the improvement surcharge began being levied in 2015', 'tests': ['not_null']}, {'name': 'total_amount', 'description': 'The total amount charged to passengers. Does not include cash tips.', 'tests': ['not_null']}, {'name': 'payment_type', 'description': 'A numeric code signifying how the passenger paid for the trip', 'tests': ['not_null']}, {'name': 'trip_type', 'description': 'Year of pickup', 'tests': ['not_null']}, {'name': 'congestion_surcharge', 'description': 'An additional charge for trips taken during high traffic congestion times', 'tests': [None]}], 'original_file_path': 'models/tests/schema.yml', 'yaml_key': 'models', 'package_name': 'nyc_taxi'} - at path ['columns'][18]['tests'][0]: None is not valid under any of the given schemas
[2024-11-21T18:16:19.844+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T18:16:19.870+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 27.801 seconds
[2024-11-21T18:16:50.183+0000] {processor.py:161} INFO - Started process (PID=6631) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T18:16:50.185+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T18:16:50.189+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:16:50.188+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T18:16:50.279+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:16:50.279+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T18:16:54.101+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:16:54.101+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 3.7955984560003344
[2024-11-21T18:16:54.103+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:16:54.102+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T18:16:54.104+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:16:54.104+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T18:16:54.121+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:16:54.120+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T18:16:54.137+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:16:54.137+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T18:16:54.158+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:16:54.157+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp7p5tf4_f --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T18:17:04.026+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:17:04.025+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp7p5tf4_f --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T18:17:18.474+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:17:18.461+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 210, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmp7p5tf4_f', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
18:17:10  Running with dbt=1.8.7
18:17:13  Registered adapter: bigquery=1.8.3
18:17:15  [WARNING]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
18:17:15  Encountered an error:
Parsing Error
  Invalid models config given in models/tests/schema.yml @ models: {'name': 'fct_trips', 'description': 'Fact Table of tripdata', 'columns': [{'name': 'trip_id', 'description': 'The primary key for this table', 'tests': ['unique']}, {'name': 'vendor_id', 'description': 'A code indicating the TPEP provider that provided the record', 'tests': ['not_null']}, {'name': 'pickup_time_id', 'description': 'id to get pickup time from dim_time', 'tests': ['not_null']}, {'name': 'dropoff_time_id', 'description': 'id to get dropoff time from dim_time', 'tests': ['not_null']}, {'name': 'rate_code_id', 'description': 'The final rate code in effect at the end of the trip', 'tests': ['not_null']}, {'name': 'pu_location_id', 'description': 'The pickup location', 'tests': ['not_null']}, {'name': 'do_location_id', 'description': 'The droppof location', 'tests': ['not_null']}, {'name': 'passenger_count', 'description': 'Customer count', 'tests': ['not_null']}, {'name': 'trip_distance', 'description': 'trip distance', 'tests': ['not_null']}, {'name': 'fare_amount', 'description': 'The time-and-distance fare calculated by the meter.', 'tests': ['not_null']}, {'name': 'extra', 'description': 'Miscellaneous extras and surcharges. Currently, this only includes. the $0.50 and $1 rush hour and overnight charges', 'tests': ['not_null']}, {'name': 'mta_tax', 'description': '0.50 MTA tax that is automatically triggered based on the metered rate in use', 'tests': ['not_null']}, {'name': 'tip_amount', 'description': 'Tip amount  This field is automatically populated for credit card tips.Cash tips are not included', 'tests': ['not_null']}, {'name': 'tolls_amount', 'description': 'Total amount of all tolls paid in trip', 'tests': ['not_null']}, {'name': 'improvement_surcharge', 'description': '0.30 improvement surcharge assessed trips at the flag drop. the improvement surcharge began being levied in 2015', 'tests': ['not_null']}, {'name': 'total_amount', 'description': 'The total amount charged to passengers. Does not include cash tips.', 'tests': ['not_null']}, {'name': 'payment_type', 'description': 'A numeric code signifying how the passenger paid for the trip', 'tests': ['not_null']}, {'name': 'trip_type', 'description': 'Year of pickup', 'tests': ['not_null']}, {'name': 'congestion_surcharge', 'description': 'An additional charge for trips taken during high traffic congestion times', 'tests': [None]}], 'original_file_path': 'models/tests/schema.yml', 'yaml_key': 'models', 'package_name': 'nyc_taxi'} - at path ['columns'][18]['tests'][0]: None is not valid under any of the given schemas
[2024-11-21T18:17:18.476+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T18:17:18.499+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 29.576 seconds
[2024-11-21T18:17:48.872+0000] {processor.py:161} INFO - Started process (PID=6683) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T18:17:48.874+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T18:17:48.878+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:17:48.877+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T18:17:48.978+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:17:48.978+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T18:17:52.960+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:17:52.959+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 3.954786934999902
[2024-11-21T18:17:52.962+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:17:52.961+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T18:17:52.963+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:17:52.963+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T18:17:52.983+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:17:52.982+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T18:17:52.999+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:17:52.999+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T18:17:53.024+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:17:53.024+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp55j7rxu7 --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T18:18:02.169+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:18:02.168+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp55j7rxu7 --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T18:18:15.408+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:18:15.397+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 210, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmp55j7rxu7', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
18:18:07  Running with dbt=1.8.7
18:18:11  Registered adapter: bigquery=1.8.3
18:18:12  [WARNING]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
18:18:13  Encountered an error:
Parsing Error
  Invalid models config given in models/tests/schema.yml @ models: {'name': 'fct_trips', 'description': 'Fact Table of tripdata', 'columns': [{'name': 'trip_id', 'description': 'The primary key for this table', 'tests': ['unique']}, {'name': 'vendor_id', 'description': 'A code indicating the TPEP provider that provided the record', 'tests': ['not_null']}, {'name': 'pickup_time_id', 'description': 'id to get pickup time from dim_time', 'tests': ['not_null']}, {'name': 'dropoff_time_id', 'description': 'id to get dropoff time from dim_time', 'tests': ['not_null']}, {'name': 'rate_code_id', 'description': 'The final rate code in effect at the end of the trip', 'tests': ['not_null']}, {'name': 'pu_location_id', 'description': 'The pickup location', 'tests': ['not_null']}, {'name': 'do_location_id', 'description': 'The droppof location', 'tests': ['not_null']}, {'name': 'passenger_count', 'description': 'Customer count', 'tests': ['not_null']}, {'name': 'trip_distance', 'description': 'trip distance', 'tests': ['not_null']}, {'name': 'fare_amount', 'description': 'The time-and-distance fare calculated by the meter.', 'tests': ['not_null']}, {'name': 'extra', 'description': 'Miscellaneous extras and surcharges. Currently, this only includes. the $0.50 and $1 rush hour and overnight charges', 'tests': ['not_null']}, {'name': 'mta_tax', 'description': '0.50 MTA tax that is automatically triggered based on the metered rate in use', 'tests': ['not_null']}, {'name': 'tip_amount', 'description': 'Tip amount  This field is automatically populated for credit card tips.Cash tips are not included', 'tests': ['not_null']}, {'name': 'tolls_amount', 'description': 'Total amount of all tolls paid in trip', 'tests': ['not_null']}, {'name': 'improvement_surcharge', 'description': '0.30 improvement surcharge assessed trips at the flag drop. the improvement surcharge began being levied in 2015', 'tests': ['not_null']}, {'name': 'total_amount', 'description': 'The total amount charged to passengers. Does not include cash tips.', 'tests': ['not_null']}, {'name': 'payment_type', 'description': 'A numeric code signifying how the passenger paid for the trip', 'tests': ['not_null']}, {'name': 'trip_type', 'description': 'Year of pickup', 'tests': ['not_null']}, {'name': 'congestion_surcharge', 'description': 'An additional charge for trips taken during high traffic congestion times', 'tests': [None]}], 'original_file_path': 'models/tests/schema.yml', 'yaml_key': 'models', 'package_name': 'nyc_taxi'} - at path ['columns'][18]['tests'][0]: None is not valid under any of the given schemas
[2024-11-21T18:18:15.410+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T18:18:15.432+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 27.824 seconds
[2024-11-21T18:18:45.792+0000] {processor.py:161} INFO - Started process (PID=6735) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T18:18:45.795+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T18:18:45.798+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:18:45.798+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T18:18:45.903+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:18:45.903+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T18:18:49.611+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:18:49.610+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 3.68034368500048
[2024-11-21T18:18:49.612+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:18:49.612+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T18:18:49.613+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:18:49.613+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T18:18:49.625+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:18:49.625+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T18:18:49.640+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:18:49.640+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T18:18:49.661+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:18:49.660+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpnyadh3hm --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T18:18:59.610+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:18:59.609+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpnyadh3hm --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T18:19:13.272+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:19:13.261+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 210, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpnyadh3hm', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
18:19:05  Running with dbt=1.8.7
18:19:08  Registered adapter: bigquery=1.8.3
18:19:10  [WARNING]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
18:19:10  Encountered an error:
Parsing Error
  Invalid models config given in models/tests/schema.yml @ models: {'name': 'fct_trips', 'description': 'Fact Table of tripdata', 'columns': [{'name': 'trip_id', 'description': 'The primary key for this table', 'tests': ['unique']}, {'name': 'vendor_id', 'description': 'A code indicating the TPEP provider that provided the record', 'tests': ['not_null']}, {'name': 'pickup_time_id', 'description': 'id to get pickup time from dim_time', 'tests': ['not_null']}, {'name': 'dropoff_time_id', 'description': 'id to get dropoff time from dim_time', 'tests': ['not_null']}, {'name': 'rate_code_id', 'description': 'The final rate code in effect at the end of the trip', 'tests': ['not_null']}, {'name': 'pu_location_id', 'description': 'The pickup location', 'tests': ['not_null']}, {'name': 'do_location_id', 'description': 'The droppof location', 'tests': ['not_null']}, {'name': 'passenger_count', 'description': 'Customer count', 'tests': ['not_null']}, {'name': 'trip_distance', 'description': 'trip distance', 'tests': ['not_null']}, {'name': 'fare_amount', 'description': 'The time-and-distance fare calculated by the meter.', 'tests': ['not_null']}, {'name': 'extra', 'description': 'Miscellaneous extras and surcharges. Currently, this only includes. the $0.50 and $1 rush hour and overnight charges', 'tests': ['not_null']}, {'name': 'mta_tax', 'description': '0.50 MTA tax that is automatically triggered based on the metered rate in use', 'tests': ['not_null']}, {'name': 'tip_amount', 'description': 'Tip amount  This field is automatically populated for credit card tips.Cash tips are not included', 'tests': ['not_null']}, {'name': 'tolls_amount', 'description': 'Total amount of all tolls paid in trip', 'tests': ['not_null']}, {'name': 'improvement_surcharge', 'description': '0.30 improvement surcharge assessed trips at the flag drop. the improvement surcharge began being levied in 2015', 'tests': ['not_null']}, {'name': 'total_amount', 'description': 'The total amount charged to passengers. Does not include cash tips.', 'tests': ['not_null']}, {'name': 'payment_type', 'description': 'A numeric code signifying how the passenger paid for the trip', 'tests': ['not_null']}, {'name': 'trip_type', 'description': 'Year of pickup', 'tests': ['not_null']}, {'name': 'congestion_surcharge', 'description': 'An additional charge for trips taken during high traffic congestion times', 'tests': [None]}], 'original_file_path': 'models/tests/schema.yml', 'yaml_key': 'models', 'package_name': 'nyc_taxi'} - at path ['columns'][18]['tests'][0]: None is not valid under any of the given schemas
[2024-11-21T18:19:13.274+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T18:19:13.303+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 28.769 seconds
[2024-11-21T18:19:43.579+0000] {processor.py:161} INFO - Started process (PID=6788) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T18:19:43.580+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T18:19:43.583+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:19:43.583+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T18:19:43.668+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:19:43.668+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T18:19:47.690+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:19:47.690+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 3.9972246590004943
[2024-11-21T18:19:47.692+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:19:47.691+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T18:19:47.693+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:19:47.693+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T18:19:47.711+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:19:47.711+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T18:19:47.726+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:19:47.725+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T18:19:47.749+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:19:47.748+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpw9qm3hmu --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T18:19:59.103+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:19:59.102+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpw9qm3hmu --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T18:20:12.365+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:20:12.363+0000] {timeout.py:68} ERROR - Process timed out, PID: 6788
[2024-11-21T18:20:43.365+0000] {processor.py:161} INFO - Started process (PID=6839) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T18:20:43.367+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T18:20:43.371+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:20:43.370+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T18:20:43.446+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:20:43.446+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T18:20:46.994+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:20:46.994+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 3.519586619999245
[2024-11-21T18:20:46.996+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:20:46.995+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T18:20:46.997+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:20:46.997+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T18:20:47.015+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:20:47.015+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T18:20:47.032+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:20:47.032+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T18:20:47.055+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:20:47.054+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpmjzvd5pz --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T18:20:56.429+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:20:56.428+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpmjzvd5pz --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T18:21:09.828+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:21:09.816+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 210, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpmjzvd5pz', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
18:21:02  Running with dbt=1.8.7
18:21:04  Registered adapter: bigquery=1.8.3
18:21:07  [WARNING]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
18:21:07  Encountered an error:
Parsing Error
  Invalid models config given in models/tests/schema.yml @ models: {'name': 'fct_trips', 'description': 'Fact Table of tripdata', 'columns': [{'name': 'trip_id', 'description': 'The primary key for this table', 'tests': ['unique']}, {'name': 'vendor_id', 'description': 'A code indicating the TPEP provider that provided the record', 'tests': ['not_null']}, {'name': 'pickup_time_id', 'description': 'id to get pickup time from dim_time', 'tests': ['not_null']}, {'name': 'dropoff_time_id', 'description': 'id to get dropoff time from dim_time', 'tests': ['not_null']}, {'name': 'rate_code_id', 'description': 'The final rate code in effect at the end of the trip', 'tests': ['not_null']}, {'name': 'pu_location_id', 'description': 'The pickup location', 'tests': ['not_null']}, {'name': 'do_location_id', 'description': 'The droppof location', 'tests': ['not_null']}, {'name': 'passenger_count', 'description': 'Customer count', 'tests': ['not_null']}, {'name': 'trip_distance', 'description': 'trip distance', 'tests': ['not_null']}, {'name': 'fare_amount', 'description': 'The time-and-distance fare calculated by the meter.', 'tests': ['not_null']}, {'name': 'extra', 'description': 'Miscellaneous extras and surcharges. Currently, this only includes. the $0.50 and $1 rush hour and overnight charges', 'tests': ['not_null']}, {'name': 'mta_tax', 'description': '0.50 MTA tax that is automatically triggered based on the metered rate in use', 'tests': ['not_null']}, {'name': 'tip_amount', 'description': 'Tip amount  This field is automatically populated for credit card tips.Cash tips are not included', 'tests': ['not_null']}, {'name': 'tolls_amount', 'description': 'Total amount of all tolls paid in trip', 'tests': ['not_null']}, {'name': 'improvement_surcharge', 'description': '0.30 improvement surcharge assessed trips at the flag drop. the improvement surcharge began being levied in 2015', 'tests': ['not_null']}, {'name': 'total_amount', 'description': 'The total amount charged to passengers. Does not include cash tips.', 'tests': ['not_null']}, {'name': 'payment_type', 'description': 'A numeric code signifying how the passenger paid for the trip', 'tests': ['not_null']}, {'name': 'trip_type', 'description': 'Year of pickup', 'tests': ['not_null']}, {'name': 'congestion_surcharge', 'description': 'An additional charge for trips taken during high traffic congestion times', 'tests': [None]}], 'original_file_path': 'models/tests/schema.yml', 'yaml_key': 'models', 'package_name': 'nyc_taxi'} - at path ['columns'][18]['tests'][0]: None is not valid under any of the given schemas
[2024-11-21T18:21:09.831+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T18:21:09.857+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 27.727 seconds
[2024-11-21T18:21:40.269+0000] {processor.py:161} INFO - Started process (PID=6892) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T18:21:40.271+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T18:21:40.274+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:21:40.274+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T18:21:40.356+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:21:40.355+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T18:21:44.360+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:21:44.359+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 3.976553888000126
[2024-11-21T18:21:44.361+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:21:44.361+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T18:21:44.363+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:21:44.362+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T18:21:44.377+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:21:44.376+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T18:21:44.394+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:21:44.393+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T18:21:44.414+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:21:44.413+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmptn2i6q3i --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T18:21:55.215+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:21:55.214+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmptn2i6q3i --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T18:22:08.932+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:22:08.920+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 210, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmptn2i6q3i', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
18:22:01  Running with dbt=1.8.7
18:22:03  Registered adapter: bigquery=1.8.3
18:22:06  [WARNING]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
18:22:06  Encountered an error:
Parsing Error
  Invalid models config given in models/tests/schema.yml @ models: {'name': 'fct_trips', 'description': 'Fact Table of tripdata', 'columns': [{'name': 'trip_id', 'description': 'The primary key for this table', 'tests': ['unique']}, {'name': 'vendor_id', 'description': 'A code indicating the TPEP provider that provided the record', 'tests': ['not_null']}, {'name': 'pickup_time_id', 'description': 'id to get pickup time from dim_time', 'tests': ['not_null']}, {'name': 'dropoff_time_id', 'description': 'id to get dropoff time from dim_time', 'tests': ['not_null']}, {'name': 'rate_code_id', 'description': 'The final rate code in effect at the end of the trip', 'tests': ['not_null']}, {'name': 'pu_location_id', 'description': 'The pickup location', 'tests': ['not_null']}, {'name': 'do_location_id', 'description': 'The droppof location', 'tests': ['not_null']}, {'name': 'passenger_count', 'description': 'Customer count', 'tests': ['not_null']}, {'name': 'trip_distance', 'description': 'trip distance', 'tests': ['not_null']}, {'name': 'fare_amount', 'description': 'The time-and-distance fare calculated by the meter.', 'tests': ['not_null']}, {'name': 'extra', 'description': 'Miscellaneous extras and surcharges. Currently, this only includes. the $0.50 and $1 rush hour and overnight charges', 'tests': ['not_null']}, {'name': 'mta_tax', 'description': '0.50 MTA tax that is automatically triggered based on the metered rate in use', 'tests': ['not_null']}, {'name': 'tip_amount', 'description': 'Tip amount  This field is automatically populated for credit card tips.Cash tips are not included', 'tests': ['not_null']}, {'name': 'tolls_amount', 'description': 'Total amount of all tolls paid in trip', 'tests': ['not_null']}, {'name': 'improvement_surcharge', 'description': '0.30 improvement surcharge assessed trips at the flag drop. the improvement surcharge began being levied in 2015', 'tests': ['not_null']}, {'name': 'total_amount', 'description': 'The total amount charged to passengers. Does not include cash tips.', 'tests': ['not_null']}, {'name': 'payment_type', 'description': 'A numeric code signifying how the passenger paid for the trip', 'tests': ['not_null']}, {'name': 'trip_type', 'description': 'Year of pickup', 'tests': ['not_null']}, {'name': 'congestion_surcharge', 'description': 'An additional charge for trips taken during high traffic congestion times', 'tests': [None]}], 'original_file_path': 'models/tests/schema.yml', 'yaml_key': 'models', 'package_name': 'nyc_taxi'} - at path ['columns'][18]['tests'][0]: None is not valid under any of the given schemas
[2024-11-21T18:22:08.934+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T18:22:08.955+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 29.919 seconds
[2024-11-21T18:22:39.390+0000] {processor.py:161} INFO - Started process (PID=6944) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T18:22:39.391+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T18:22:39.395+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:22:39.394+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T18:22:39.501+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:22:39.500+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T18:22:43.468+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:22:43.467+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 3.941912054000568
[2024-11-21T18:22:43.469+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:22:43.469+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T18:22:43.470+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:22:43.470+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T18:22:43.488+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:22:43.487+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T18:22:43.503+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:22:43.503+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T18:22:43.528+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:22:43.528+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpkl0_4227 --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T18:22:53.253+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:22:53.252+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpkl0_4227 --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T18:23:07.411+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:23:07.358+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 210, in <module>
    )
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpkl0_4227', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
18:22:59  Running with dbt=1.8.7
18:23:02  Registered adapter: bigquery=1.8.3
18:23:04  [WARNING]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
18:23:04  Encountered an error:
Parsing Error
  Invalid models config given in models/tests/schema.yml @ models: {'name': 'fct_trips', 'description': 'Fact Table of tripdata', 'columns': [{'name': 'trip_id', 'description': 'The primary key for this table', 'tests': ['unique']}, {'name': 'vendor_id', 'description': 'A code indicating the TPEP provider that provided the record', 'tests': ['not_null']}, {'name': 'pickup_time_id', 'description': 'id to get pickup time from dim_time', 'tests': ['not_null']}, {'name': 'dropoff_time_id', 'description': 'id to get dropoff time from dim_time', 'tests': ['not_null']}, {'name': 'rate_code_id', 'description': 'The final rate code in effect at the end of the trip', 'tests': ['not_null']}, {'name': 'pu_location_id', 'description': 'The pickup location', 'tests': ['not_null']}, {'name': 'do_location_id', 'description': 'The droppof location', 'tests': ['not_null']}, {'name': 'passenger_count', 'description': 'Customer count', 'tests': ['not_null']}, {'name': 'trip_distance', 'description': 'trip distance', 'tests': ['not_null']}, {'name': 'fare_amount', 'description': 'The time-and-distance fare calculated by the meter.', 'tests': ['not_null']}, {'name': 'extra', 'description': 'Miscellaneous extras and surcharges. Currently, this only includes. the $0.50 and $1 rush hour and overnight charges', 'tests': ['not_null']}, {'name': 'mta_tax', 'description': '0.50 MTA tax that is automatically triggered based on the metered rate in use', 'tests': ['not_null']}, {'name': 'tip_amount', 'description': 'Tip amount  This field is automatically populated for credit card tips.Cash tips are not included', 'tests': ['not_null']}, {'name': 'tolls_amount', 'description': 'Total amount of all tolls paid in trip', 'tests': ['not_null']}, {'name': 'improvement_surcharge', 'description': '0.30 improvement surcharge assessed trips at the flag drop. the improvement surcharge began being levied in 2015', 'tests': ['not_null']}, {'name': 'total_amount', 'description': 'The total amount charged to passengers. Does not include cash tips.', 'tests': ['not_null']}, {'name': 'payment_type', 'description': 'A numeric code signifying how the passenger paid for the trip', 'tests': ['not_null']}, {'name': 'trip_type', 'description': 'Year of pickup', 'tests': ['not_null']}, {'name': 'congestion_surcharge', 'description': 'An additional charge for trips taken during high traffic congestion times', 'tests': [None]}], 'original_file_path': 'models/tests/schema.yml', 'yaml_key': 'models', 'package_name': 'nyc_taxi'} - at path ['columns'][18]['tests'][0]: None is not valid under any of the given schemas
[2024-11-21T18:23:07.413+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T18:23:07.442+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 29.302 seconds
[2024-11-21T18:23:17.925+0000] {processor.py:161} INFO - Started process (PID=6990) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T18:23:17.927+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T18:23:17.931+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:23:17.930+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T18:23:18.053+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:23:18.053+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T18:23:22.068+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:23:22.068+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 3.9847389419992396
[2024-11-21T18:23:22.070+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:23:22.069+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T18:23:22.071+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:23:22.071+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T18:23:22.089+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:23:22.088+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T18:23:22.103+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:23:22.102+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T18:23:22.127+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:23:22.127+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpi_e0z3kh --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T18:23:30.460+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:23:30.459+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpi_e0z3kh --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T18:23:45.497+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:23:45.483+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 212, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpi_e0z3kh', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
18:23:36  Running with dbt=1.8.7
18:23:39  Registered adapter: bigquery=1.8.3
18:23:42  [WARNING]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
18:23:42  Encountered an error:
Parsing Error
  Invalid models config given in models/tests/schema.yml @ models: {'name': 'fct_trips', 'description': 'Fact Table of tripdata', 'columns': [{'name': 'trip_id', 'description': 'The primary key for this table', 'tests': ['unique']}, {'name': 'vendor_id', 'description': 'A code indicating the TPEP provider that provided the record', 'tests': ['not_null']}, {'name': 'pickup_time_id', 'description': 'id to get pickup time from dim_time', 'tests': ['not_null']}, {'name': 'dropoff_time_id', 'description': 'id to get dropoff time from dim_time', 'tests': ['not_null']}, {'name': 'rate_code_id', 'description': 'The final rate code in effect at the end of the trip', 'tests': ['not_null']}, {'name': 'pu_location_id', 'description': 'The pickup location', 'tests': ['not_null']}, {'name': 'do_location_id', 'description': 'The droppof location', 'tests': ['not_null']}, {'name': 'passenger_count', 'description': 'Customer count', 'tests': ['not_null']}, {'name': 'trip_distance', 'description': 'trip distance', 'tests': ['not_null']}, {'name': 'fare_amount', 'description': 'The time-and-distance fare calculated by the meter.', 'tests': ['not_null']}, {'name': 'extra', 'description': 'Miscellaneous extras and surcharges. Currently, this only includes. the $0.50 and $1 rush hour and overnight charges', 'tests': ['not_null']}, {'name': 'mta_tax', 'description': '0.50 MTA tax that is automatically triggered based on the metered rate in use', 'tests': ['not_null']}, {'name': 'tip_amount', 'description': 'Tip amount  This field is automatically populated for credit card tips.Cash tips are not included', 'tests': ['not_null']}, {'name': 'tolls_amount', 'description': 'Total amount of all tolls paid in trip', 'tests': ['not_null']}, {'name': 'improvement_surcharge', 'description': '0.30 improvement surcharge assessed trips at the flag drop. the improvement surcharge began being levied in 2015', 'tests': ['not_null']}, {'name': 'total_amount', 'description': 'The total amount charged to passengers. Does not include cash tips.', 'tests': ['not_null']}, {'name': 'payment_type', 'description': 'A numeric code signifying how the passenger paid for the trip', 'tests': ['not_null']}, {'name': 'trip_type', 'description': 'Year of pickup', 'tests': ['not_null']}, {'name': 'congestion_surcharge', 'description': 'An additional charge for trips taken during high traffic congestion times', 'tests': [None]}], 'original_file_path': 'models/tests/schema.yml', 'yaml_key': 'models', 'package_name': 'nyc_taxi'} - at path ['columns'][18]['tests'][0]: None is not valid under any of the given schemas
[2024-11-21T18:23:45.499+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T18:23:45.522+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 28.904 seconds
[2024-11-21T18:24:15.678+0000] {processor.py:161} INFO - Started process (PID=7041) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T18:24:15.680+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T18:24:15.684+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:24:15.683+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T18:24:15.768+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:24:15.767+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T18:24:19.714+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:24:19.714+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 3.921861458999956
[2024-11-21T18:24:19.716+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:24:19.715+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T18:24:19.717+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:24:19.717+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T18:24:19.735+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:24:19.735+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T18:24:19.751+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:24:19.749+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T18:24:19.773+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:24:19.772+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpwgz0af4n --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T18:24:27.972+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:24:27.971+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpwgz0af4n --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T18:24:42.197+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:24:42.185+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 212, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpwgz0af4n', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
18:24:33  Running with dbt=1.8.7
18:24:37  Registered adapter: bigquery=1.8.3
18:24:39  [WARNING]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
18:24:40  Encountered an error:
Parsing Error
  Invalid models config given in models/tests/schema.yml @ models: {'name': 'fct_trips', 'description': 'Fact Table of tripdata', 'columns': [{'name': 'trip_id', 'description': 'The primary key for this table', 'tests': ['unique']}, {'name': 'vendor_id', 'description': 'A code indicating the TPEP provider that provided the record', 'tests': ['not_null']}, {'name': 'pickup_time_id', 'description': 'id to get pickup time from dim_time', 'tests': ['not_null']}, {'name': 'dropoff_time_id', 'description': 'id to get dropoff time from dim_time', 'tests': ['not_null']}, {'name': 'rate_code_id', 'description': 'The final rate code in effect at the end of the trip', 'tests': ['not_null']}, {'name': 'pu_location_id', 'description': 'The pickup location', 'tests': ['not_null']}, {'name': 'do_location_id', 'description': 'The droppof location', 'tests': ['not_null']}, {'name': 'passenger_count', 'description': 'Customer count', 'tests': ['not_null']}, {'name': 'trip_distance', 'description': 'trip distance', 'tests': ['not_null']}, {'name': 'fare_amount', 'description': 'The time-and-distance fare calculated by the meter.', 'tests': ['not_null']}, {'name': 'extra', 'description': 'Miscellaneous extras and surcharges. Currently, this only includes. the $0.50 and $1 rush hour and overnight charges', 'tests': ['not_null']}, {'name': 'mta_tax', 'description': '0.50 MTA tax that is automatically triggered based on the metered rate in use', 'tests': ['not_null']}, {'name': 'tip_amount', 'description': 'Tip amount  This field is automatically populated for credit card tips.Cash tips are not included', 'tests': ['not_null']}, {'name': 'tolls_amount', 'description': 'Total amount of all tolls paid in trip', 'tests': ['not_null']}, {'name': 'improvement_surcharge', 'description': '0.30 improvement surcharge assessed trips at the flag drop. the improvement surcharge began being levied in 2015', 'tests': ['not_null']}, {'name': 'total_amount', 'description': 'The total amount charged to passengers. Does not include cash tips.', 'tests': ['not_null']}, {'name': 'payment_type', 'description': 'A numeric code signifying how the passenger paid for the trip', 'tests': ['not_null']}, {'name': 'trip_type', 'description': 'Year of pickup', 'tests': ['not_null']}, {'name': 'congestion_surcharge', 'description': 'An additional charge for trips taken during high traffic congestion times', 'tests': [None]}], 'original_file_path': 'models/tests/schema.yml', 'yaml_key': 'models', 'package_name': 'nyc_taxi'} - at path ['columns'][18]['tests'][0]: None is not valid under any of the given schemas
[2024-11-21T18:24:42.199+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T18:24:42.228+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 27.844 seconds
[2024-11-21T18:25:12.491+0000] {processor.py:161} INFO - Started process (PID=7093) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T18:25:12.493+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T18:25:12.497+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:25:12.496+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T18:25:12.587+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:25:12.586+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T18:25:16.387+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:25:16.387+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 3.773132600000281
[2024-11-21T18:25:16.389+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:25:16.388+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T18:25:16.390+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:25:16.390+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T18:25:16.408+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:25:16.407+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T18:25:16.425+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:25:16.425+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T18:25:16.449+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:25:16.448+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpp_4am74y --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T18:25:24.393+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:25:24.392+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpp_4am74y --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T18:25:39.765+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:25:39.754+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 212, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpp_4am74y', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
18:25:30  Running with dbt=1.8.7
18:25:33  Registered adapter: bigquery=1.8.3
18:25:36  [WARNING]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
18:25:36  Encountered an error:
Parsing Error
  Invalid models config given in models/tests/schema.yml @ models: {'name': 'fct_trips', 'description': 'Fact Table of tripdata', 'columns': [{'name': 'trip_id', 'description': 'The primary key for this table', 'tests': ['unique']}, {'name': 'vendor_id', 'description': 'A code indicating the TPEP provider that provided the record', 'tests': ['not_null']}, {'name': 'pickup_time_id', 'description': 'id to get pickup time from dim_time', 'tests': ['not_null']}, {'name': 'dropoff_time_id', 'description': 'id to get dropoff time from dim_time', 'tests': ['not_null']}, {'name': 'rate_code_id', 'description': 'The final rate code in effect at the end of the trip', 'tests': ['not_null']}, {'name': 'pu_location_id', 'description': 'The pickup location', 'tests': ['not_null']}, {'name': 'do_location_id', 'description': 'The droppof location', 'tests': ['not_null']}, {'name': 'passenger_count', 'description': 'Customer count', 'tests': ['not_null']}, {'name': 'trip_distance', 'description': 'trip distance', 'tests': ['not_null']}, {'name': 'fare_amount', 'description': 'The time-and-distance fare calculated by the meter.', 'tests': ['not_null']}, {'name': 'extra', 'description': 'Miscellaneous extras and surcharges. Currently, this only includes. the $0.50 and $1 rush hour and overnight charges', 'tests': ['not_null']}, {'name': 'mta_tax', 'description': '0.50 MTA tax that is automatically triggered based on the metered rate in use', 'tests': ['not_null']}, {'name': 'tip_amount', 'description': 'Tip amount  This field is automatically populated for credit card tips.Cash tips are not included', 'tests': ['not_null']}, {'name': 'tolls_amount', 'description': 'Total amount of all tolls paid in trip', 'tests': ['not_null']}, {'name': 'improvement_surcharge', 'description': '0.30 improvement surcharge assessed trips at the flag drop. the improvement surcharge began being levied in 2015', 'tests': ['not_null']}, {'name': 'total_amount', 'description': 'The total amount charged to passengers. Does not include cash tips.', 'tests': ['not_null']}, {'name': 'payment_type', 'description': 'A numeric code signifying how the passenger paid for the trip', 'tests': ['not_null']}, {'name': 'trip_type', 'description': 'Year of pickup', 'tests': ['not_null']}, {'name': 'congestion_surcharge', 'description': 'An additional charge for trips taken during high traffic congestion times', 'tests': [None]}], 'original_file_path': 'models/tests/schema.yml', 'yaml_key': 'models', 'package_name': 'nyc_taxi'} - at path ['columns'][18]['tests'][0]: None is not valid under any of the given schemas
[2024-11-21T18:25:39.767+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T18:25:39.796+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 28.598 seconds
[2024-11-21T18:26:10.025+0000] {processor.py:161} INFO - Started process (PID=7145) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T18:26:10.027+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T18:26:10.031+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:26:10.031+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T18:26:10.120+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:26:10.119+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T18:26:14.060+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:26:14.059+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 3.9133191989994884
[2024-11-21T18:26:14.061+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:26:14.061+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T18:26:14.062+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:26:14.062+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T18:26:14.081+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:26:14.081+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T18:26:14.094+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:26:14.094+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T18:26:14.119+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:26:14.118+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpms7ebxin --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T18:26:22.674+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:26:22.673+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpms7ebxin --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T18:26:36.895+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:26:36.877+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 212, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpms7ebxin', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
18:26:28  Running with dbt=1.8.7
18:26:32  Registered adapter: bigquery=1.8.3
18:26:34  [WARNING]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
18:26:34  Encountered an error:
Parsing Error
  Invalid models config given in models/tests/schema.yml @ models: {'name': 'fct_trips', 'description': 'Fact Table of tripdata', 'columns': [{'name': 'trip_id', 'description': 'The primary key for this table', 'tests': ['unique']}, {'name': 'vendor_id', 'description': 'A code indicating the TPEP provider that provided the record', 'tests': ['not_null']}, {'name': 'pickup_time_id', 'description': 'id to get pickup time from dim_time', 'tests': ['not_null']}, {'name': 'dropoff_time_id', 'description': 'id to get dropoff time from dim_time', 'tests': ['not_null']}, {'name': 'rate_code_id', 'description': 'The final rate code in effect at the end of the trip', 'tests': ['not_null']}, {'name': 'pu_location_id', 'description': 'The pickup location', 'tests': ['not_null']}, {'name': 'do_location_id', 'description': 'The droppof location', 'tests': ['not_null']}, {'name': 'passenger_count', 'description': 'Customer count', 'tests': ['not_null']}, {'name': 'trip_distance', 'description': 'trip distance', 'tests': ['not_null']}, {'name': 'fare_amount', 'description': 'The time-and-distance fare calculated by the meter.', 'tests': ['not_null']}, {'name': 'extra', 'description': 'Miscellaneous extras and surcharges. Currently, this only includes. the $0.50 and $1 rush hour and overnight charges', 'tests': ['not_null']}, {'name': 'mta_tax', 'description': '0.50 MTA tax that is automatically triggered based on the metered rate in use', 'tests': ['not_null']}, {'name': 'tip_amount', 'description': 'Tip amount  This field is automatically populated for credit card tips.Cash tips are not included', 'tests': ['not_null']}, {'name': 'tolls_amount', 'description': 'Total amount of all tolls paid in trip', 'tests': ['not_null']}, {'name': 'improvement_surcharge', 'description': '0.30 improvement surcharge assessed trips at the flag drop. the improvement surcharge began being levied in 2015', 'tests': ['not_null']}, {'name': 'total_amount', 'description': 'The total amount charged to passengers. Does not include cash tips.', 'tests': ['not_null']}, {'name': 'payment_type', 'description': 'A numeric code signifying how the passenger paid for the trip', 'tests': ['not_null']}, {'name': 'trip_type', 'description': 'Year of pickup', 'tests': ['not_null']}, {'name': 'congestion_surcharge', 'description': 'An additional charge for trips taken during high traffic congestion times', 'tests': [None]}], 'original_file_path': 'models/tests/schema.yml', 'yaml_key': 'models', 'package_name': 'nyc_taxi'} - at path ['columns'][18]['tests'][0]: None is not valid under any of the given schemas
[2024-11-21T18:26:36.902+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T18:26:36.952+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 28.144 seconds
[2024-11-21T18:27:07.095+0000] {processor.py:161} INFO - Started process (PID=7197) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T18:27:07.097+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T18:27:07.100+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:27:07.100+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T18:27:07.188+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:27:07.188+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T18:27:11.186+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:27:11.185+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 3.9694413819997862
[2024-11-21T18:27:11.187+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:27:11.187+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T18:27:11.189+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:27:11.188+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T18:27:11.207+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:27:11.207+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T18:27:11.227+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:27:11.226+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T18:27:11.246+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:27:11.246+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpcy0ukwim --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T18:27:21.093+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:27:21.092+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpcy0ukwim --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T18:27:35.814+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:27:35.804+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 212, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpcy0ukwim', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
18:27:27  Running with dbt=1.8.7
18:27:30  Registered adapter: bigquery=1.8.3
18:27:33  [WARNING]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
18:27:33  Encountered an error:
Parsing Error
  Invalid models config given in models/tests/schema.yml @ models: {'name': 'fct_trips', 'description': 'Fact Table of tripdata', 'columns': [{'name': 'trip_id', 'description': 'The primary key for this table', 'tests': ['unique']}, {'name': 'vendor_id', 'description': 'A code indicating the TPEP provider that provided the record', 'tests': ['not_null']}, {'name': 'pickup_time_id', 'description': 'id to get pickup time from dim_time', 'tests': ['not_null']}, {'name': 'dropoff_time_id', 'description': 'id to get dropoff time from dim_time', 'tests': ['not_null']}, {'name': 'rate_code_id', 'description': 'The final rate code in effect at the end of the trip', 'tests': ['not_null']}, {'name': 'pu_location_id', 'description': 'The pickup location', 'tests': ['not_null']}, {'name': 'do_location_id', 'description': 'The droppof location', 'tests': ['not_null']}, {'name': 'passenger_count', 'description': 'Customer count', 'tests': ['not_null']}, {'name': 'trip_distance', 'description': 'trip distance', 'tests': ['not_null']}, {'name': 'fare_amount', 'description': 'The time-and-distance fare calculated by the meter.', 'tests': ['not_null']}, {'name': 'extra', 'description': 'Miscellaneous extras and surcharges. Currently, this only includes. the $0.50 and $1 rush hour and overnight charges', 'tests': ['not_null']}, {'name': 'mta_tax', 'description': '0.50 MTA tax that is automatically triggered based on the metered rate in use', 'tests': ['not_null']}, {'name': 'tip_amount', 'description': 'Tip amount  This field is automatically populated for credit card tips.Cash tips are not included', 'tests': ['not_null']}, {'name': 'tolls_amount', 'description': 'Total amount of all tolls paid in trip', 'tests': ['not_null']}, {'name': 'improvement_surcharge', 'description': '0.30 improvement surcharge assessed trips at the flag drop. the improvement surcharge began being levied in 2015', 'tests': ['not_null']}, {'name': 'total_amount', 'description': 'The total amount charged to passengers. Does not include cash tips.', 'tests': ['not_null']}, {'name': 'payment_type', 'description': 'A numeric code signifying how the passenger paid for the trip', 'tests': ['not_null']}, {'name': 'trip_type', 'description': 'Year of pickup', 'tests': ['not_null']}, {'name': 'congestion_surcharge', 'description': 'An additional charge for trips taken during high traffic congestion times', 'tests': [None]}], 'original_file_path': 'models/tests/schema.yml', 'yaml_key': 'models', 'package_name': 'nyc_taxi'} - at path ['columns'][18]['tests'][0]: None is not valid under any of the given schemas
[2024-11-21T18:27:35.818+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T18:27:35.843+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 29.989 seconds
[2024-11-21T18:28:06.537+0000] {processor.py:161} INFO - Started process (PID=7249) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T18:28:06.540+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T18:28:06.544+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:28:06.544+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T18:28:06.627+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:28:06.626+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T18:28:10.265+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:28:10.264+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 3.612631039999542
[2024-11-21T18:28:10.266+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:28:10.266+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T18:28:10.268+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:28:10.267+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T18:28:10.287+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:28:10.287+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T18:28:10.300+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:28:10.300+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T18:28:10.324+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:28:10.324+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpkap0ahj5 --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T18:28:18.784+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:28:18.782+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpkap0ahj5 --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T18:28:34.344+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:28:34.331+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 212, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpkap0ahj5', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
18:28:24  Running with dbt=1.8.7
18:28:28  Registered adapter: bigquery=1.8.3
18:28:31  [WARNING]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
18:28:31  Encountered an error:
Parsing Error
  Invalid models config given in models/tests/schema.yml @ models: {'name': 'fct_trips', 'description': 'Fact Table of tripdata', 'columns': [{'name': 'trip_id', 'description': 'The primary key for this table', 'tests': ['unique']}, {'name': 'vendor_id', 'description': 'A code indicating the TPEP provider that provided the record', 'tests': ['not_null']}, {'name': 'pickup_time_id', 'description': 'id to get pickup time from dim_time', 'tests': ['not_null']}, {'name': 'dropoff_time_id', 'description': 'id to get dropoff time from dim_time', 'tests': ['not_null']}, {'name': 'rate_code_id', 'description': 'The final rate code in effect at the end of the trip', 'tests': ['not_null']}, {'name': 'pu_location_id', 'description': 'The pickup location', 'tests': ['not_null']}, {'name': 'do_location_id', 'description': 'The droppof location', 'tests': ['not_null']}, {'name': 'passenger_count', 'description': 'Customer count', 'tests': ['not_null']}, {'name': 'trip_distance', 'description': 'trip distance', 'tests': ['not_null']}, {'name': 'fare_amount', 'description': 'The time-and-distance fare calculated by the meter.', 'tests': ['not_null']}, {'name': 'extra', 'description': 'Miscellaneous extras and surcharges. Currently, this only includes. the $0.50 and $1 rush hour and overnight charges', 'tests': ['not_null']}, {'name': 'mta_tax', 'description': '0.50 MTA tax that is automatically triggered based on the metered rate in use', 'tests': ['not_null']}, {'name': 'tip_amount', 'description': 'Tip amount  This field is automatically populated for credit card tips.Cash tips are not included', 'tests': ['not_null']}, {'name': 'tolls_amount', 'description': 'Total amount of all tolls paid in trip', 'tests': ['not_null']}, {'name': 'improvement_surcharge', 'description': '0.30 improvement surcharge assessed trips at the flag drop. the improvement surcharge began being levied in 2015', 'tests': ['not_null']}, {'name': 'total_amount', 'description': 'The total amount charged to passengers. Does not include cash tips.', 'tests': ['not_null']}, {'name': 'payment_type', 'description': 'A numeric code signifying how the passenger paid for the trip', 'tests': ['not_null']}, {'name': 'trip_type', 'description': 'Year of pickup', 'tests': ['not_null']}, {'name': 'congestion_surcharge', 'description': 'An additional charge for trips taken during high traffic congestion times', 'tests': [None]}], 'original_file_path': 'models/tests/schema.yml', 'yaml_key': 'models', 'package_name': 'nyc_taxi'} - at path ['columns'][18]['tests'][0]: None is not valid under any of the given schemas
[2024-11-21T18:28:34.345+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T18:28:34.377+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 29.103 seconds
[2024-11-21T18:29:05.180+0000] {processor.py:161} INFO - Started process (PID=7301) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T18:29:05.182+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T18:29:05.196+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:29:05.195+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T18:29:05.294+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:29:05.294+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T18:29:09.144+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:29:09.143+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 3.8236162160001186
[2024-11-21T18:29:09.145+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:29:09.145+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T18:29:09.147+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:29:09.146+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T18:29:09.165+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:29:09.165+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T18:29:09.182+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:29:09.182+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T18:29:09.207+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:29:09.207+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpqbhg_96m --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T18:29:17.957+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:29:17.956+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpqbhg_96m --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T18:29:32.599+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:29:32.588+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 212, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpqbhg_96m', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
18:29:23  Running with dbt=1.8.7
18:29:27  Registered adapter: bigquery=1.8.3
18:29:29  [WARNING]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
18:29:29  Encountered an error:
Parsing Error
  Invalid models config given in models/tests/schema.yml @ models: {'name': 'fct_trips', 'description': 'Fact Table of tripdata', 'columns': [{'name': 'trip_id', 'description': 'The primary key for this table', 'tests': ['unique']}, {'name': 'vendor_id', 'description': 'A code indicating the TPEP provider that provided the record', 'tests': ['not_null']}, {'name': 'pickup_time_id', 'description': 'id to get pickup time from dim_time', 'tests': ['not_null']}, {'name': 'dropoff_time_id', 'description': 'id to get dropoff time from dim_time', 'tests': ['not_null']}, {'name': 'rate_code_id', 'description': 'The final rate code in effect at the end of the trip', 'tests': ['not_null']}, {'name': 'pu_location_id', 'description': 'The pickup location', 'tests': ['not_null']}, {'name': 'do_location_id', 'description': 'The droppof location', 'tests': ['not_null']}, {'name': 'passenger_count', 'description': 'Customer count', 'tests': ['not_null']}, {'name': 'trip_distance', 'description': 'trip distance', 'tests': ['not_null']}, {'name': 'fare_amount', 'description': 'The time-and-distance fare calculated by the meter.', 'tests': ['not_null']}, {'name': 'extra', 'description': 'Miscellaneous extras and surcharges. Currently, this only includes. the $0.50 and $1 rush hour and overnight charges', 'tests': ['not_null']}, {'name': 'mta_tax', 'description': '0.50 MTA tax that is automatically triggered based on the metered rate in use', 'tests': ['not_null']}, {'name': 'tip_amount', 'description': 'Tip amount  This field is automatically populated for credit card tips.Cash tips are not included', 'tests': ['not_null']}, {'name': 'tolls_amount', 'description': 'Total amount of all tolls paid in trip', 'tests': ['not_null']}, {'name': 'improvement_surcharge', 'description': '0.30 improvement surcharge assessed trips at the flag drop. the improvement surcharge began being levied in 2015', 'tests': ['not_null']}, {'name': 'total_amount', 'description': 'The total amount charged to passengers. Does not include cash tips.', 'tests': ['not_null']}, {'name': 'payment_type', 'description': 'A numeric code signifying how the passenger paid for the trip', 'tests': ['not_null']}, {'name': 'trip_type', 'description': 'Year of pickup', 'tests': ['not_null']}, {'name': 'congestion_surcharge', 'description': 'An additional charge for trips taken during high traffic congestion times', 'tests': [None]}], 'original_file_path': 'models/tests/schema.yml', 'yaml_key': 'models', 'package_name': 'nyc_taxi'} - at path ['columns'][18]['tests'][0]: None is not valid under any of the given schemas
[2024-11-21T18:29:32.601+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T18:29:32.627+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 28.689 seconds
[2024-11-21T18:30:02.921+0000] {processor.py:161} INFO - Started process (PID=7353) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T18:30:02.924+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T18:30:02.927+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:30:02.927+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T18:30:03.023+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:30:03.023+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T18:30:07.044+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:30:07.043+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 3.9927447769996434
[2024-11-21T18:30:07.045+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:30:07.045+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T18:30:07.046+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:30:07.046+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T18:30:07.060+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:30:07.060+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T18:30:07.073+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:30:07.073+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T18:30:07.093+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:30:07.092+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp_1igrl5j --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T18:30:15.148+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:30:15.147+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp_1igrl5j --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T18:30:29.945+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:30:29.934+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 212, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmp_1igrl5j', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
18:30:21  Running with dbt=1.8.7
18:30:25  Registered adapter: bigquery=1.8.3
18:30:27  [WARNING]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
18:30:27  Encountered an error:
Parsing Error
  Invalid models config given in models/tests/schema.yml @ models: {'name': 'fct_trips', 'description': 'Fact Table of tripdata', 'columns': [{'name': 'trip_id', 'description': 'The primary key for this table', 'tests': ['unique']}, {'name': 'vendor_id', 'description': 'A code indicating the TPEP provider that provided the record', 'tests': ['not_null']}, {'name': 'pickup_time_id', 'description': 'id to get pickup time from dim_time', 'tests': ['not_null']}, {'name': 'dropoff_time_id', 'description': 'id to get dropoff time from dim_time', 'tests': ['not_null']}, {'name': 'rate_code_id', 'description': 'The final rate code in effect at the end of the trip', 'tests': ['not_null']}, {'name': 'pu_location_id', 'description': 'The pickup location', 'tests': ['not_null']}, {'name': 'do_location_id', 'description': 'The droppof location', 'tests': ['not_null']}, {'name': 'passenger_count', 'description': 'Customer count', 'tests': ['not_null']}, {'name': 'trip_distance', 'description': 'trip distance', 'tests': ['not_null']}, {'name': 'fare_amount', 'description': 'The time-and-distance fare calculated by the meter.', 'tests': ['not_null']}, {'name': 'extra', 'description': 'Miscellaneous extras and surcharges. Currently, this only includes. the $0.50 and $1 rush hour and overnight charges', 'tests': ['not_null']}, {'name': 'mta_tax', 'description': '0.50 MTA tax that is automatically triggered based on the metered rate in use', 'tests': ['not_null']}, {'name': 'tip_amount', 'description': 'Tip amount  This field is automatically populated for credit card tips.Cash tips are not included', 'tests': ['not_null']}, {'name': 'tolls_amount', 'description': 'Total amount of all tolls paid in trip', 'tests': ['not_null']}, {'name': 'improvement_surcharge', 'description': '0.30 improvement surcharge assessed trips at the flag drop. the improvement surcharge began being levied in 2015', 'tests': ['not_null']}, {'name': 'total_amount', 'description': 'The total amount charged to passengers. Does not include cash tips.', 'tests': ['not_null']}, {'name': 'payment_type', 'description': 'A numeric code signifying how the passenger paid for the trip', 'tests': ['not_null']}, {'name': 'trip_type', 'description': 'Year of pickup', 'tests': ['not_null']}, {'name': 'congestion_surcharge', 'description': 'An additional charge for trips taken during high traffic congestion times', 'tests': [None]}], 'original_file_path': 'models/tests/schema.yml', 'yaml_key': 'models', 'package_name': 'nyc_taxi'} - at path ['columns'][18]['tests'][0]: None is not valid under any of the given schemas
[2024-11-21T18:30:29.947+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T18:30:29.976+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 28.261 seconds
[2024-11-21T18:31:00.631+0000] {processor.py:161} INFO - Started process (PID=7405) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T18:31:00.633+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T18:31:00.636+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:31:00.636+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T18:31:00.720+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:31:00.720+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T18:31:04.463+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:31:04.462+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 3.7127744710005572
[2024-11-21T18:31:04.464+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:31:04.464+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T18:31:04.465+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:31:04.465+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T18:31:04.481+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:31:04.481+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T18:31:04.503+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:31:04.503+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T18:31:04.526+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:31:04.525+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp2cjwrti1 --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T18:31:13.040+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:31:13.039+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp2cjwrti1 --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T18:31:27.407+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:31:27.395+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 212, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmp2cjwrti1', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
18:31:18  Running with dbt=1.8.7
18:31:22  Registered adapter: bigquery=1.8.3
18:31:24  [WARNING]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
18:31:24  Encountered an error:
Parsing Error
  Invalid models config given in models/tests/schema.yml @ models: {'name': 'fct_trips', 'description': 'Fact Table of tripdata', 'columns': [{'name': 'trip_id', 'description': 'The primary key for this table', 'tests': ['unique']}, {'name': 'vendor_id', 'description': 'A code indicating the TPEP provider that provided the record', 'tests': ['not_null']}, {'name': 'pickup_time_id', 'description': 'id to get pickup time from dim_time', 'tests': ['not_null']}, {'name': 'dropoff_time_id', 'description': 'id to get dropoff time from dim_time', 'tests': ['not_null']}, {'name': 'rate_code_id', 'description': 'The final rate code in effect at the end of the trip', 'tests': ['not_null']}, {'name': 'pu_location_id', 'description': 'The pickup location', 'tests': ['not_null']}, {'name': 'do_location_id', 'description': 'The droppof location', 'tests': ['not_null']}, {'name': 'passenger_count', 'description': 'Customer count', 'tests': ['not_null']}, {'name': 'trip_distance', 'description': 'trip distance', 'tests': ['not_null']}, {'name': 'fare_amount', 'description': 'The time-and-distance fare calculated by the meter.', 'tests': ['not_null']}, {'name': 'extra', 'description': 'Miscellaneous extras and surcharges. Currently, this only includes. the $0.50 and $1 rush hour and overnight charges', 'tests': ['not_null']}, {'name': 'mta_tax', 'description': '0.50 MTA tax that is automatically triggered based on the metered rate in use', 'tests': ['not_null']}, {'name': 'tip_amount', 'description': 'Tip amount  This field is automatically populated for credit card tips.Cash tips are not included', 'tests': ['not_null']}, {'name': 'tolls_amount', 'description': 'Total amount of all tolls paid in trip', 'tests': ['not_null']}, {'name': 'improvement_surcharge', 'description': '0.30 improvement surcharge assessed trips at the flag drop. the improvement surcharge began being levied in 2015', 'tests': ['not_null']}, {'name': 'total_amount', 'description': 'The total amount charged to passengers. Does not include cash tips.', 'tests': ['not_null']}, {'name': 'payment_type', 'description': 'A numeric code signifying how the passenger paid for the trip', 'tests': ['not_null']}, {'name': 'trip_type', 'description': 'Year of pickup', 'tests': ['not_null']}, {'name': 'congestion_surcharge', 'description': 'An additional charge for trips taken during high traffic congestion times', 'tests': [None]}], 'original_file_path': 'models/tests/schema.yml', 'yaml_key': 'models', 'package_name': 'nyc_taxi'} - at path ['columns'][18]['tests'][0]: None is not valid under any of the given schemas
[2024-11-21T18:31:27.409+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T18:31:27.439+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 28.068 seconds
[2024-11-21T18:31:57.599+0000] {processor.py:161} INFO - Started process (PID=7457) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T18:31:57.601+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T18:31:57.605+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:31:57.604+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T18:31:57.704+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:31:57.703+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T18:32:01.821+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:32:01.821+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 4.0892217900000105
[2024-11-21T18:32:01.822+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:32:01.822+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T18:32:01.823+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:32:01.823+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T18:32:01.841+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:32:01.841+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T18:32:01.854+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:32:01.854+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T18:32:01.878+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:32:01.877+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpmubd91pu --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T18:32:09.335+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:32:09.334+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpmubd91pu --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T18:32:24.470+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:32:24.457+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 212, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpmubd91pu', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
18:32:15  Running with dbt=1.8.7
18:32:19  Registered adapter: bigquery=1.8.3
18:32:21  [WARNING]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
18:32:21  Encountered an error:
Parsing Error
  Invalid models config given in models/tests/schema.yml @ models: {'name': 'fct_trips', 'description': 'Fact Table of tripdata', 'columns': [{'name': 'trip_id', 'description': 'The primary key for this table', 'tests': ['unique']}, {'name': 'vendor_id', 'description': 'A code indicating the TPEP provider that provided the record', 'tests': ['not_null']}, {'name': 'pickup_time_id', 'description': 'id to get pickup time from dim_time', 'tests': ['not_null']}, {'name': 'dropoff_time_id', 'description': 'id to get dropoff time from dim_time', 'tests': ['not_null']}, {'name': 'rate_code_id', 'description': 'The final rate code in effect at the end of the trip', 'tests': ['not_null']}, {'name': 'pu_location_id', 'description': 'The pickup location', 'tests': ['not_null']}, {'name': 'do_location_id', 'description': 'The droppof location', 'tests': ['not_null']}, {'name': 'passenger_count', 'description': 'Customer count', 'tests': ['not_null']}, {'name': 'trip_distance', 'description': 'trip distance', 'tests': ['not_null']}, {'name': 'fare_amount', 'description': 'The time-and-distance fare calculated by the meter.', 'tests': ['not_null']}, {'name': 'extra', 'description': 'Miscellaneous extras and surcharges. Currently, this only includes. the $0.50 and $1 rush hour and overnight charges', 'tests': ['not_null']}, {'name': 'mta_tax', 'description': '0.50 MTA tax that is automatically triggered based on the metered rate in use', 'tests': ['not_null']}, {'name': 'tip_amount', 'description': 'Tip amount  This field is automatically populated for credit card tips.Cash tips are not included', 'tests': ['not_null']}, {'name': 'tolls_amount', 'description': 'Total amount of all tolls paid in trip', 'tests': ['not_null']}, {'name': 'improvement_surcharge', 'description': '0.30 improvement surcharge assessed trips at the flag drop. the improvement surcharge began being levied in 2015', 'tests': ['not_null']}, {'name': 'total_amount', 'description': 'The total amount charged to passengers. Does not include cash tips.', 'tests': ['not_null']}, {'name': 'payment_type', 'description': 'A numeric code signifying how the passenger paid for the trip', 'tests': ['not_null']}, {'name': 'trip_type', 'description': 'Year of pickup', 'tests': ['not_null']}, {'name': 'congestion_surcharge', 'description': 'An additional charge for trips taken during high traffic congestion times', 'tests': [None]}], 'original_file_path': 'models/tests/schema.yml', 'yaml_key': 'models', 'package_name': 'nyc_taxi'} - at path ['columns'][18]['tests'][0]: None is not valid under any of the given schemas
[2024-11-21T18:32:24.472+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T18:32:24.501+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 28.203 seconds
[2024-11-21T18:32:55.033+0000] {processor.py:161} INFO - Started process (PID=7509) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T18:32:55.035+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T18:32:55.039+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:32:55.039+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T18:32:55.121+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:32:55.121+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T18:32:58.947+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:32:58.946+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 3.7956863919998796
[2024-11-21T18:32:58.948+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:32:58.948+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T18:32:58.950+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:32:58.949+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T18:32:58.968+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:32:58.967+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T18:32:58.987+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:32:58.986+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T18:32:59.011+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:32:59.011+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmph3843vuf --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T18:33:07.544+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:33:07.543+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmph3843vuf --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T18:33:22.416+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:33:22.405+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 212, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmph3843vuf', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
18:33:13  Running with dbt=1.8.7
18:33:17  Registered adapter: bigquery=1.8.3
18:33:19  [WARNING]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
18:33:20  Encountered an error:
Parsing Error
  Invalid models config given in models/tests/schema.yml @ models: {'name': 'fct_trips', 'description': 'Fact Table of tripdata', 'columns': [{'name': 'trip_id', 'description': 'The primary key for this table', 'tests': ['unique']}, {'name': 'vendor_id', 'description': 'A code indicating the TPEP provider that provided the record', 'tests': ['not_null']}, {'name': 'pickup_time_id', 'description': 'id to get pickup time from dim_time', 'tests': ['not_null']}, {'name': 'dropoff_time_id', 'description': 'id to get dropoff time from dim_time', 'tests': ['not_null']}, {'name': 'rate_code_id', 'description': 'The final rate code in effect at the end of the trip', 'tests': ['not_null']}, {'name': 'pu_location_id', 'description': 'The pickup location', 'tests': ['not_null']}, {'name': 'do_location_id', 'description': 'The droppof location', 'tests': ['not_null']}, {'name': 'passenger_count', 'description': 'Customer count', 'tests': ['not_null']}, {'name': 'trip_distance', 'description': 'trip distance', 'tests': ['not_null']}, {'name': 'fare_amount', 'description': 'The time-and-distance fare calculated by the meter.', 'tests': ['not_null']}, {'name': 'extra', 'description': 'Miscellaneous extras and surcharges. Currently, this only includes. the $0.50 and $1 rush hour and overnight charges', 'tests': ['not_null']}, {'name': 'mta_tax', 'description': '0.50 MTA tax that is automatically triggered based on the metered rate in use', 'tests': ['not_null']}, {'name': 'tip_amount', 'description': 'Tip amount  This field is automatically populated for credit card tips.Cash tips are not included', 'tests': ['not_null']}, {'name': 'tolls_amount', 'description': 'Total amount of all tolls paid in trip', 'tests': ['not_null']}, {'name': 'improvement_surcharge', 'description': '0.30 improvement surcharge assessed trips at the flag drop. the improvement surcharge began being levied in 2015', 'tests': ['not_null']}, {'name': 'total_amount', 'description': 'The total amount charged to passengers. Does not include cash tips.', 'tests': ['not_null']}, {'name': 'payment_type', 'description': 'A numeric code signifying how the passenger paid for the trip', 'tests': ['not_null']}, {'name': 'trip_type', 'description': 'Year of pickup', 'tests': ['not_null']}, {'name': 'congestion_surcharge', 'description': 'An additional charge for trips taken during high traffic congestion times', 'tests': [None]}], 'original_file_path': 'models/tests/schema.yml', 'yaml_key': 'models', 'package_name': 'nyc_taxi'} - at path ['columns'][18]['tests'][0]: None is not valid under any of the given schemas
[2024-11-21T18:33:22.418+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T18:33:22.442+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 28.644 seconds
[2024-11-21T18:33:52.679+0000] {processor.py:161} INFO - Started process (PID=7561) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T18:33:52.681+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T18:33:52.685+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:33:52.684+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T18:33:52.791+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:33:52.790+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T18:33:56.473+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:33:56.473+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 3.652024646999962
[2024-11-21T18:33:56.474+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:33:56.474+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T18:33:56.475+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:33:56.475+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T18:33:56.487+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:33:56.487+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T18:33:56.505+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:33:56.504+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T18:33:56.524+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:33:56.523+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp6dkjy5ho --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T18:34:04.826+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:34:04.825+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp6dkjy5ho --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T18:34:19.943+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:34:19.932+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 212, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmp6dkjy5ho', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
18:34:11  Running with dbt=1.8.7
18:34:15  Registered adapter: bigquery=1.8.3
18:34:17  [WARNING]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
18:34:17  Encountered an error:
Parsing Error
  Invalid models config given in models/tests/schema.yml @ models: {'name': 'fct_trips', 'description': 'Fact Table of tripdata', 'columns': [{'name': 'trip_id', 'description': 'The primary key for this table', 'tests': ['unique']}, {'name': 'vendor_id', 'description': 'A code indicating the TPEP provider that provided the record', 'tests': ['not_null']}, {'name': 'pickup_time_id', 'description': 'id to get pickup time from dim_time', 'tests': ['not_null']}, {'name': 'dropoff_time_id', 'description': 'id to get dropoff time from dim_time', 'tests': ['not_null']}, {'name': 'rate_code_id', 'description': 'The final rate code in effect at the end of the trip', 'tests': ['not_null']}, {'name': 'pu_location_id', 'description': 'The pickup location', 'tests': ['not_null']}, {'name': 'do_location_id', 'description': 'The droppof location', 'tests': ['not_null']}, {'name': 'passenger_count', 'description': 'Customer count', 'tests': ['not_null']}, {'name': 'trip_distance', 'description': 'trip distance', 'tests': ['not_null']}, {'name': 'fare_amount', 'description': 'The time-and-distance fare calculated by the meter.', 'tests': ['not_null']}, {'name': 'extra', 'description': 'Miscellaneous extras and surcharges. Currently, this only includes. the $0.50 and $1 rush hour and overnight charges', 'tests': ['not_null']}, {'name': 'mta_tax', 'description': '0.50 MTA tax that is automatically triggered based on the metered rate in use', 'tests': ['not_null']}, {'name': 'tip_amount', 'description': 'Tip amount  This field is automatically populated for credit card tips.Cash tips are not included', 'tests': ['not_null']}, {'name': 'tolls_amount', 'description': 'Total amount of all tolls paid in trip', 'tests': ['not_null']}, {'name': 'improvement_surcharge', 'description': '0.30 improvement surcharge assessed trips at the flag drop. the improvement surcharge began being levied in 2015', 'tests': ['not_null']}, {'name': 'total_amount', 'description': 'The total amount charged to passengers. Does not include cash tips.', 'tests': ['not_null']}, {'name': 'payment_type', 'description': 'A numeric code signifying how the passenger paid for the trip', 'tests': ['not_null']}, {'name': 'trip_type', 'description': 'Year of pickup', 'tests': ['not_null']}, {'name': 'congestion_surcharge', 'description': 'An additional charge for trips taken during high traffic congestion times', 'tests': [None]}], 'original_file_path': 'models/tests/schema.yml', 'yaml_key': 'models', 'package_name': 'nyc_taxi'} - at path ['columns'][18]['tests'][0]: None is not valid under any of the given schemas
[2024-11-21T18:34:19.946+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T18:34:19.974+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 28.540 seconds
[2024-11-21T18:34:50.386+0000] {processor.py:161} INFO - Started process (PID=7613) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T18:34:50.388+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T18:34:50.395+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:34:50.394+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T18:34:50.496+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:34:50.496+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T18:34:54.016+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:34:54.016+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 3.4904806459999236
[2024-11-21T18:34:54.018+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:34:54.017+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T18:34:54.019+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:34:54.019+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T18:34:54.038+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:34:54.038+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T18:34:54.053+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:34:54.053+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T18:34:54.079+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:34:54.078+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpwsg_t64i --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T18:35:02.399+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:35:02.398+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpwsg_t64i --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T18:35:17.153+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:35:17.143+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 212, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpwsg_t64i', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
18:35:08  Running with dbt=1.8.7
18:35:11  Registered adapter: bigquery=1.8.3
18:35:14  [WARNING]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
18:35:14  Encountered an error:
Parsing Error
  Invalid models config given in models/tests/schema.yml @ models: {'name': 'fct_trips', 'description': 'Fact Table of tripdata', 'columns': [{'name': 'trip_id', 'description': 'The primary key for this table', 'tests': ['unique']}, {'name': 'vendor_id', 'description': 'A code indicating the TPEP provider that provided the record', 'tests': ['not_null']}, {'name': 'pickup_time_id', 'description': 'id to get pickup time from dim_time', 'tests': ['not_null']}, {'name': 'dropoff_time_id', 'description': 'id to get dropoff time from dim_time', 'tests': ['not_null']}, {'name': 'rate_code_id', 'description': 'The final rate code in effect at the end of the trip', 'tests': ['not_null']}, {'name': 'pu_location_id', 'description': 'The pickup location', 'tests': ['not_null']}, {'name': 'do_location_id', 'description': 'The droppof location', 'tests': ['not_null']}, {'name': 'passenger_count', 'description': 'Customer count', 'tests': ['not_null']}, {'name': 'trip_distance', 'description': 'trip distance', 'tests': ['not_null']}, {'name': 'fare_amount', 'description': 'The time-and-distance fare calculated by the meter.', 'tests': ['not_null']}, {'name': 'extra', 'description': 'Miscellaneous extras and surcharges. Currently, this only includes. the $0.50 and $1 rush hour and overnight charges', 'tests': ['not_null']}, {'name': 'mta_tax', 'description': '0.50 MTA tax that is automatically triggered based on the metered rate in use', 'tests': ['not_null']}, {'name': 'tip_amount', 'description': 'Tip amount  This field is automatically populated for credit card tips.Cash tips are not included', 'tests': ['not_null']}, {'name': 'tolls_amount', 'description': 'Total amount of all tolls paid in trip', 'tests': ['not_null']}, {'name': 'improvement_surcharge', 'description': '0.30 improvement surcharge assessed trips at the flag drop. the improvement surcharge began being levied in 2015', 'tests': ['not_null']}, {'name': 'total_amount', 'description': 'The total amount charged to passengers. Does not include cash tips.', 'tests': ['not_null']}, {'name': 'payment_type', 'description': 'A numeric code signifying how the passenger paid for the trip', 'tests': ['not_null']}, {'name': 'trip_type', 'description': 'Year of pickup', 'tests': ['not_null']}, {'name': 'congestion_surcharge', 'description': 'An additional charge for trips taken during high traffic congestion times', 'tests': [None]}], 'original_file_path': 'models/tests/schema.yml', 'yaml_key': 'models', 'package_name': 'nyc_taxi'} - at path ['columns'][18]['tests'][0]: None is not valid under any of the given schemas
[2024-11-21T18:35:17.155+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T18:35:17.212+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 28.144 seconds
[2024-11-21T18:35:47.980+0000] {processor.py:161} INFO - Started process (PID=7665) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T18:35:47.983+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T18:35:47.987+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:35:47.986+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T18:35:48.087+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:35:48.087+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T18:35:52.136+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:35:52.135+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 4.019610995000221
[2024-11-21T18:35:52.137+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:35:52.137+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T18:35:52.139+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:35:52.138+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T18:35:52.157+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:35:52.157+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T18:35:52.176+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:35:52.176+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T18:35:52.200+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:35:52.200+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpex47dw99 --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T18:36:00.243+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:36:00.241+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpex47dw99 --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T18:36:15.071+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:36:15.059+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 212, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpex47dw99', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
18:36:06  Running with dbt=1.8.7
18:36:10  Registered adapter: bigquery=1.8.3
18:36:12  [WARNING]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
18:36:12  Encountered an error:
Parsing Error
  Invalid models config given in models/tests/schema.yml @ models: {'name': 'fct_trips', 'description': 'Fact Table of tripdata', 'columns': [{'name': 'trip_id', 'description': 'The primary key for this table', 'tests': ['unique']}, {'name': 'vendor_id', 'description': 'A code indicating the TPEP provider that provided the record', 'tests': ['not_null']}, {'name': 'pickup_time_id', 'description': 'id to get pickup time from dim_time', 'tests': ['not_null']}, {'name': 'dropoff_time_id', 'description': 'id to get dropoff time from dim_time', 'tests': ['not_null']}, {'name': 'rate_code_id', 'description': 'The final rate code in effect at the end of the trip', 'tests': ['not_null']}, {'name': 'pu_location_id', 'description': 'The pickup location', 'tests': ['not_null']}, {'name': 'do_location_id', 'description': 'The droppof location', 'tests': ['not_null']}, {'name': 'passenger_count', 'description': 'Customer count', 'tests': ['not_null']}, {'name': 'trip_distance', 'description': 'trip distance', 'tests': ['not_null']}, {'name': 'fare_amount', 'description': 'The time-and-distance fare calculated by the meter.', 'tests': ['not_null']}, {'name': 'extra', 'description': 'Miscellaneous extras and surcharges. Currently, this only includes. the $0.50 and $1 rush hour and overnight charges', 'tests': ['not_null']}, {'name': 'mta_tax', 'description': '0.50 MTA tax that is automatically triggered based on the metered rate in use', 'tests': ['not_null']}, {'name': 'tip_amount', 'description': 'Tip amount  This field is automatically populated for credit card tips.Cash tips are not included', 'tests': ['not_null']}, {'name': 'tolls_amount', 'description': 'Total amount of all tolls paid in trip', 'tests': ['not_null']}, {'name': 'improvement_surcharge', 'description': '0.30 improvement surcharge assessed trips at the flag drop. the improvement surcharge began being levied in 2015', 'tests': ['not_null']}, {'name': 'total_amount', 'description': 'The total amount charged to passengers. Does not include cash tips.', 'tests': ['not_null']}, {'name': 'payment_type', 'description': 'A numeric code signifying how the passenger paid for the trip', 'tests': ['not_null']}, {'name': 'trip_type', 'description': 'Year of pickup', 'tests': ['not_null']}, {'name': 'congestion_surcharge', 'description': 'An additional charge for trips taken during high traffic congestion times', 'tests': [None]}], 'original_file_path': 'models/tests/schema.yml', 'yaml_key': 'models', 'package_name': 'nyc_taxi'} - at path ['columns'][18]['tests'][0]: None is not valid under any of the given schemas
[2024-11-21T18:36:15.073+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T18:36:15.095+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 28.377 seconds
[2024-11-21T18:36:45.663+0000] {processor.py:161} INFO - Started process (PID=7717) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T18:36:45.665+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T18:36:45.669+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:36:45.668+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T18:36:45.766+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:36:45.766+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T18:36:49.804+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:36:49.803+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 4.007883612999649
[2024-11-21T18:36:49.805+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:36:49.805+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T18:36:49.807+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:36:49.806+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T18:36:49.824+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:36:49.824+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T18:36:49.846+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:36:49.846+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T18:36:49.872+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:36:49.871+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpyrnn4zue --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T18:36:58.477+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:36:58.475+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpyrnn4zue --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T18:37:13.054+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:37:13.042+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 212, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpyrnn4zue', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
18:37:04  Running with dbt=1.8.7
18:37:08  Registered adapter: bigquery=1.8.3
18:37:10  [WARNING]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
18:37:10  Encountered an error:
Parsing Error
  Invalid models config given in models/tests/schema.yml @ models: {'name': 'fct_trips', 'description': 'Fact Table of tripdata', 'columns': [{'name': 'trip_id', 'description': 'The primary key for this table', 'tests': ['unique']}, {'name': 'vendor_id', 'description': 'A code indicating the TPEP provider that provided the record', 'tests': ['not_null']}, {'name': 'pickup_time_id', 'description': 'id to get pickup time from dim_time', 'tests': ['not_null']}, {'name': 'dropoff_time_id', 'description': 'id to get dropoff time from dim_time', 'tests': ['not_null']}, {'name': 'rate_code_id', 'description': 'The final rate code in effect at the end of the trip', 'tests': ['not_null']}, {'name': 'pu_location_id', 'description': 'The pickup location', 'tests': ['not_null']}, {'name': 'do_location_id', 'description': 'The droppof location', 'tests': ['not_null']}, {'name': 'passenger_count', 'description': 'Customer count', 'tests': ['not_null']}, {'name': 'trip_distance', 'description': 'trip distance', 'tests': ['not_null']}, {'name': 'fare_amount', 'description': 'The time-and-distance fare calculated by the meter.', 'tests': ['not_null']}, {'name': 'extra', 'description': 'Miscellaneous extras and surcharges. Currently, this only includes. the $0.50 and $1 rush hour and overnight charges', 'tests': ['not_null']}, {'name': 'mta_tax', 'description': '0.50 MTA tax that is automatically triggered based on the metered rate in use', 'tests': ['not_null']}, {'name': 'tip_amount', 'description': 'Tip amount  This field is automatically populated for credit card tips.Cash tips are not included', 'tests': ['not_null']}, {'name': 'tolls_amount', 'description': 'Total amount of all tolls paid in trip', 'tests': ['not_null']}, {'name': 'improvement_surcharge', 'description': '0.30 improvement surcharge assessed trips at the flag drop. the improvement surcharge began being levied in 2015', 'tests': ['not_null']}, {'name': 'total_amount', 'description': 'The total amount charged to passengers. Does not include cash tips.', 'tests': ['not_null']}, {'name': 'payment_type', 'description': 'A numeric code signifying how the passenger paid for the trip', 'tests': ['not_null']}, {'name': 'trip_type', 'description': 'Year of pickup', 'tests': ['not_null']}, {'name': 'congestion_surcharge', 'description': 'An additional charge for trips taken during high traffic congestion times', 'tests': [None]}], 'original_file_path': 'models/tests/schema.yml', 'yaml_key': 'models', 'package_name': 'nyc_taxi'} - at path ['columns'][18]['tests'][0]: None is not valid under any of the given schemas
[2024-11-21T18:37:13.056+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T18:37:13.087+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 28.719 seconds
[2024-11-21T18:37:43.330+0000] {processor.py:161} INFO - Started process (PID=7769) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T18:37:43.332+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T18:37:43.337+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:37:43.336+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T18:37:43.414+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:37:43.413+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T18:37:47.608+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:37:47.608+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 4.165835390000211
[2024-11-21T18:37:47.609+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:37:47.609+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T18:37:47.611+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:37:47.611+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T18:37:47.629+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:37:47.628+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T18:37:47.645+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:37:47.645+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T18:37:47.671+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:37:47.670+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpl7ub32nn --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T18:37:55.583+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:37:55.582+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpl7ub32nn --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T18:38:10.490+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:38:10.448+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 212, in <module>
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpl7ub32nn', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
18:38:01  Running with dbt=1.8.7
18:38:05  Registered adapter: bigquery=1.8.3
18:38:08  [WARNING]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
18:38:08  Encountered an error:
Parsing Error
  Invalid models config given in models/tests/schema.yml @ models: {'name': 'fct_trips', 'description': 'Fact Table of tripdata', 'columns': [{'name': 'trip_id', 'description': 'The primary key for this table', 'tests': ['unique']}, {'name': 'vendor_id', 'description': 'A code indicating the TPEP provider that provided the record', 'tests': ['not_null']}, {'name': 'pickup_time_id', 'description': 'id to get pickup time from dim_time', 'tests': ['not_null']}, {'name': 'dropoff_time_id', 'description': 'id to get dropoff time from dim_time', 'tests': ['not_null']}, {'name': 'rate_code_id', 'description': 'The final rate code in effect at the end of the trip', 'tests': ['not_null']}, {'name': 'pu_location_id', 'description': 'The pickup location', 'tests': ['not_null']}, {'name': 'do_location_id', 'description': 'The droppof location', 'tests': ['not_null']}, {'name': 'passenger_count', 'description': 'Customer count', 'tests': ['not_null']}, {'name': 'trip_distance', 'description': 'trip distance', 'tests': ['not_null']}, {'name': 'fare_amount', 'description': 'The time-and-distance fare calculated by the meter.', 'tests': ['not_null']}, {'name': 'extra', 'description': 'Miscellaneous extras and surcharges. Currently, this only includes. the $0.50 and $1 rush hour and overnight charges', 'tests': ['not_null']}, {'name': 'mta_tax', 'description': '0.50 MTA tax that is automatically triggered based on the metered rate in use', 'tests': [{'conditional_values': {'condition': 'mta_tax >= 0'}}]}, {'name': 'tip_amount', 'description': 'Tip amount  This field is automatically populated for credit card tips.Cash tips are not included', 'tests': [{'conditional_values': {'condition': 'tip_amount >= 0'}}]}, {'name': 'tolls_amount', 'description': 'Total amount of all tolls paid in trip', 'tests': [{'conditional_values': {'condition': 'tolls_amount >= 0'}}]}, {'name': 'improvement_surcharge', 'description': '0.30 improvement surcharge assessed trips at the flag drop. the improvement surcharge began being levied in 2015', 'tests': ['not_null']}, {'name': 'total_amount', 'description': 'The total amount charged to passengers. Does not include cash tips.', 'tests': [{'conditional_values': {'condition': 'total_amount >= 0'}}]}, {'name': 'payment_type', 'description': 'A numeric code signifying how the passenger paid for the trip', 'tests': ['not_null']}, {'name': 'trip_type', 'description': 'Year of pickup', 'tests': [None]}, {'name': 'congestion_surcharge', 'description': 'An additional charge for trips taken during high traffic congestion times', 'tests': [None]}], 'original_file_path': 'models/tests/schema.yml', 'yaml_key': 'models', 'package_name': 'nyc_taxi'} - at path ['columns'][17]['tests'][0]: None is not valid under any of the given schemas
[2024-11-21T18:38:10.492+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T18:38:10.531+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 28.516 seconds
[2024-11-21T18:38:41.127+0000] {processor.py:161} INFO - Started process (PID=7821) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T18:38:41.129+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T18:38:41.133+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:38:41.132+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T18:38:41.260+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:38:41.260+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T18:38:45.328+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:38:45.327+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 4.041235375000724
[2024-11-21T18:38:45.329+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:38:45.328+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T18:38:45.330+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:38:45.330+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T18:38:45.345+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:38:45.344+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T18:38:45.359+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:38:45.359+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T18:38:45.380+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:38:45.379+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmphshxmdrm --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T18:38:54.342+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:38:54.341+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmphshxmdrm --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T18:39:09.118+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:39:09.107+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 213, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmphshxmdrm', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
18:39:00  Running with dbt=1.8.7
18:39:03  Registered adapter: bigquery=1.8.3
18:39:06  [WARNING]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
18:39:06  Encountered an error:
Parsing Error
  Invalid models config given in models/tests/schema.yml @ models: {'name': 'fct_trips', 'description': 'Fact Table of tripdata', 'columns': [{'name': 'trip_id', 'description': 'The primary key for this table', 'tests': ['unique']}, {'name': 'vendor_id', 'description': 'A code indicating the TPEP provider that provided the record', 'tests': ['not_null']}, {'name': 'pickup_time_id', 'description': 'id to get pickup time from dim_time', 'tests': ['not_null']}, {'name': 'dropoff_time_id', 'description': 'id to get dropoff time from dim_time', 'tests': ['not_null']}, {'name': 'rate_code_id', 'description': 'The final rate code in effect at the end of the trip', 'tests': ['not_null']}, {'name': 'pu_location_id', 'description': 'The pickup location', 'tests': ['not_null']}, {'name': 'do_location_id', 'description': 'The droppof location', 'tests': ['not_null']}, {'name': 'passenger_count', 'description': 'Customer count', 'tests': ['not_null']}, {'name': 'trip_distance', 'description': 'trip distance', 'tests': ['not_null']}, {'name': 'fare_amount', 'description': 'The time-and-distance fare calculated by the meter.', 'tests': ['not_null']}, {'name': 'extra', 'description': 'Miscellaneous extras and surcharges. Currently, this only includes. the $0.50 and $1 rush hour and overnight charges', 'tests': ['not_null']}, {'name': 'mta_tax', 'description': '0.50 MTA tax that is automatically triggered based on the metered rate in use', 'tests': [{'conditional_values': {'condition': 'mta_tax >= 0'}}]}, {'name': 'tip_amount', 'description': 'Tip amount  This field is automatically populated for credit card tips.Cash tips are not included', 'tests': [{'conditional_values': {'condition': 'tip_amount >= 0'}}]}, {'name': 'tolls_amount', 'description': 'Total amount of all tolls paid in trip', 'tests': ['not_null']}, {'name': 'improvement_surcharge', 'description': '0.30 improvement surcharge assessed trips at the flag drop. the improvement surcharge began being levied in 2015', 'tests': ['not_null']}, {'name': 'total_amount', 'description': 'The total amount charged to passengers. Does not include cash tips.', 'tests': [{'conditional_values': {'condition': 'total_amount >= 0'}}]}, {'name': 'payment_type', 'description': 'A numeric code signifying how the passenger paid for the trip', 'tests': ['not_null']}, {'name': 'trip_type', 'description': 'Year of pickup', 'tests': [None]}, {'name': 'congestion_surcharge', 'description': 'An additional charge for trips taken during high traffic congestion times', 'tests': [None]}], 'original_file_path': 'models/tests/schema.yml', 'yaml_key': 'models', 'package_name': 'nyc_taxi'} - at path ['columns'][17]['tests'][0]: None is not valid under any of the given schemas
[2024-11-21T18:39:09.120+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T18:39:09.151+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 29.290 seconds
[2024-11-21T18:39:39.797+0000] {processor.py:161} INFO - Started process (PID=7873) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T18:39:39.799+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T18:39:39.802+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:39:39.802+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T18:39:39.873+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:39:39.872+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T18:39:44.057+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:39:44.056+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 4.157038003999332
[2024-11-21T18:39:44.058+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:39:44.057+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T18:39:44.059+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:39:44.059+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T18:39:44.076+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:39:44.076+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T18:39:44.095+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:39:44.094+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T18:39:44.117+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:39:44.117+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpt1n7jiax --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T18:39:52.360+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:39:52.359+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpt1n7jiax --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T18:40:07.176+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:40:07.164+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 213, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpt1n7jiax', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
18:39:58  Running with dbt=1.8.7
18:40:02  Registered adapter: bigquery=1.8.3
18:40:04  [WARNING]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
18:40:04  Encountered an error:
Parsing Error
  Invalid models config given in models/tests/schema.yml @ models: {'name': 'fct_trips', 'description': 'Fact Table of tripdata', 'columns': [{'name': 'trip_id', 'description': 'The primary key for this table', 'tests': ['unique']}, {'name': 'vendor_id', 'description': 'A code indicating the TPEP provider that provided the record', 'tests': ['not_null']}, {'name': 'pickup_time_id', 'description': 'id to get pickup time from dim_time', 'tests': ['not_null']}, {'name': 'dropoff_time_id', 'description': 'id to get dropoff time from dim_time', 'tests': ['not_null']}, {'name': 'rate_code_id', 'description': 'The final rate code in effect at the end of the trip', 'tests': ['not_null']}, {'name': 'pu_location_id', 'description': 'The pickup location', 'tests': ['not_null']}, {'name': 'do_location_id', 'description': 'The droppof location', 'tests': ['not_null']}, {'name': 'passenger_count', 'description': 'Customer count', 'tests': ['not_null']}, {'name': 'trip_distance', 'description': 'trip distance', 'tests': ['not_null']}, {'name': 'fare_amount', 'description': 'The time-and-distance fare calculated by the meter.', 'tests': ['not_null']}, {'name': 'extra', 'description': 'Miscellaneous extras and surcharges. Currently, this only includes. the $0.50 and $1 rush hour and overnight charges', 'tests': ['not_null']}, {'name': 'mta_tax', 'description': '0.50 MTA tax that is automatically triggered based on the metered rate in use', 'tests': [{'conditional_values': {'condition': 'mta_tax >= 0'}}]}, {'name': 'tip_amount', 'description': 'Tip amount  This field is automatically populated for credit card tips.Cash tips are not included', 'tests': [{'conditional_values': {'condition': 'tip_amount >= 0'}}]}, {'name': 'tolls_amount', 'description': 'Total amount of all tolls paid in trip', 'tests': ['not_null']}, {'name': 'improvement_surcharge', 'description': '0.30 improvement surcharge assessed trips at the flag drop. the improvement surcharge began being levied in 2015', 'tests': ['not_null']}, {'name': 'total_amount', 'description': 'The total amount charged to passengers. Does not include cash tips.', 'tests': [{'conditional_values': {'condition': 'total_amount >= 0'}}]}, {'name': 'payment_type', 'description': 'A numeric code signifying how the passenger paid for the trip', 'tests': ['not_null']}, {'name': 'trip_type', 'description': 'Year of pickup', 'tests': [None]}, {'name': 'congestion_surcharge', 'description': 'An additional charge for trips taken during high traffic congestion times', 'tests': [None]}], 'original_file_path': 'models/tests/schema.yml', 'yaml_key': 'models', 'package_name': 'nyc_taxi'} - at path ['columns'][17]['tests'][0]: None is not valid under any of the given schemas
[2024-11-21T18:40:07.178+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T18:40:07.208+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 28.720 seconds
[2024-11-21T18:40:37.705+0000] {processor.py:161} INFO - Started process (PID=7925) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T18:40:37.707+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T18:40:37.711+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:40:37.710+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T18:40:37.810+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:40:37.810+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T18:40:41.981+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:40:41.980+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 4.142225125999175
[2024-11-21T18:40:41.982+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:40:41.981+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T18:40:41.983+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:40:41.983+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T18:40:42.002+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:40:42.002+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T18:40:42.016+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:40:42.016+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T18:40:42.040+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:40:42.040+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp153dm47a --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T18:40:50.448+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:40:50.447+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp153dm47a --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T18:41:04.785+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:41:04.774+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 213, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmp153dm47a', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
18:40:56  Running with dbt=1.8.7
18:40:59  Registered adapter: bigquery=1.8.3
18:41:02  [WARNING]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
18:41:02  Encountered an error:
Parsing Error
  Invalid models config given in models/tests/schema.yml @ models: {'name': 'fct_trips', 'description': 'Fact Table of tripdata', 'columns': [{'name': 'trip_id', 'description': 'The primary key for this table', 'tests': ['unique']}, {'name': 'vendor_id', 'description': 'A code indicating the TPEP provider that provided the record', 'tests': ['not_null']}, {'name': 'pickup_time_id', 'description': 'id to get pickup time from dim_time', 'tests': ['not_null']}, {'name': 'dropoff_time_id', 'description': 'id to get dropoff time from dim_time', 'tests': ['not_null']}, {'name': 'rate_code_id', 'description': 'The final rate code in effect at the end of the trip', 'tests': ['not_null']}, {'name': 'pu_location_id', 'description': 'The pickup location', 'tests': ['not_null']}, {'name': 'do_location_id', 'description': 'The droppof location', 'tests': ['not_null']}, {'name': 'passenger_count', 'description': 'Customer count', 'tests': ['not_null']}, {'name': 'trip_distance', 'description': 'trip distance', 'tests': ['not_null']}, {'name': 'fare_amount', 'description': 'The time-and-distance fare calculated by the meter.', 'tests': [{'conditional_values': {'condition': 'fare_amount >= 0'}}]}, {'name': 'extra', 'description': 'Miscellaneous extras and surcharges. Currently, this only includes. the $0.50 and $1 rush hour and overnight charges', 'tests': ['not_null']}, {'name': 'mta_tax', 'description': '0.50 MTA tax that is automatically triggered based on the metered rate in use', 'tests': [{'conditional_values': {'condition': 'mta_tax >= 0'}}]}, {'name': 'tip_amount', 'description': 'Tip amount  This field is automatically populated for credit card tips.Cash tips are not included', 'tests': [{'conditional_values': {'condition': 'tip_amount >= 0'}}]}, {'name': 'tolls_amount', 'description': 'Total amount of all tolls paid in trip', 'tests': [{'conditional_values': {'condition': 'tolls_amount >= 0'}}]}, {'name': 'improvement_surcharge', 'description': '0.30 improvement surcharge assessed trips at the flag drop. the improvement surcharge began being levied in 2015', 'tests': ['not_null']}, {'name': 'total_amount', 'description': 'The total amount charged to passengers. Does not include cash tips.', 'tests': [{'conditional_values': {'condition': 'total_amount >= 0'}}]}, {'name': 'payment_type', 'description': 'A numeric code signifying how the passenger paid for the trip', 'tests': ['not_null']}, {'name': 'trip_type', 'description': 'Year of pickup', 'tests': [None]}, {'name': 'congestion_surcharge', 'description': 'An additional charge for trips taken during high traffic congestion times', 'tests': [None]}], 'original_file_path': 'models/tests/schema.yml', 'yaml_key': 'models', 'package_name': 'nyc_taxi'} - at path ['columns'][17]['tests'][0]: None is not valid under any of the given schemas
[2024-11-21T18:41:04.788+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T18:41:04.830+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 28.406 seconds
[2024-11-21T18:41:35.301+0000] {processor.py:161} INFO - Started process (PID=7977) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T18:41:35.303+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T18:41:35.307+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:41:35.307+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T18:41:35.401+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:41:35.401+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T18:41:39.176+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:41:39.176+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 3.747005282999453
[2024-11-21T18:41:39.178+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:41:39.177+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T18:41:39.179+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:41:39.179+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T18:41:39.195+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:41:39.195+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T18:41:39.209+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:41:39.208+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T18:41:39.234+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:41:39.233+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpyrxg8igl --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T18:41:47.476+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:41:47.475+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpyrxg8igl --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T18:42:02.266+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:42:02.254+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 213, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpyrxg8igl', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
18:41:53  Running with dbt=1.8.7
18:41:57  Registered adapter: bigquery=1.8.3
18:41:59  [WARNING]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
18:41:59  Encountered an error:
Parsing Error
  Invalid models config given in models/tests/schema.yml @ models: {'name': 'fct_trips', 'description': 'Fact Table of tripdata', 'columns': [{'name': 'trip_id', 'description': 'The primary key for this table', 'tests': ['unique']}, {'name': 'vendor_id', 'description': 'A code indicating the TPEP provider that provided the record', 'tests': ['not_null']}, {'name': 'pickup_time_id', 'description': 'id to get pickup time from dim_time', 'tests': ['not_null']}, {'name': 'dropoff_time_id', 'description': 'id to get dropoff time from dim_time', 'tests': ['not_null']}, {'name': 'rate_code_id', 'description': 'The final rate code in effect at the end of the trip', 'tests': ['not_null']}, {'name': 'pu_location_id', 'description': 'The pickup location', 'tests': ['not_null']}, {'name': 'do_location_id', 'description': 'The droppof location', 'tests': ['not_null']}, {'name': 'passenger_count', 'description': 'Customer count', 'tests': ['not_null']}, {'name': 'trip_distance', 'description': 'trip distance', 'tests': ['not_null']}, {'name': 'fare_amount', 'description': 'The time-and-distance fare calculated by the meter.', 'tests': [{'conditional_values': {'condition': 'fare_amount >= 0'}}]}, {'name': 'extra', 'description': 'Miscellaneous extras and surcharges. Currently, this only includes. the $0.50 and $1 rush hour and overnight charges', 'tests': ['not_null']}, {'name': 'mta_tax', 'description': '0.50 MTA tax that is automatically triggered based on the metered rate in use', 'tests': [{'conditional_values': {'condition': 'mta_tax >= 0'}}]}, {'name': 'tip_amount', 'description': 'Tip amount  This field is automatically populated for credit card tips.Cash tips are not included', 'tests': [{'conditional_values': {'condition': 'tip_amount >= 0'}}]}, {'name': 'tolls_amount', 'description': 'Total amount of all tolls paid in trip', 'tests': [{'conditional_values': {'condition': 'tolls_amount >= 0'}}]}, {'name': 'improvement_surcharge', 'description': '0.30 improvement surcharge assessed trips at the flag drop. the improvement surcharge began being levied in 2015', 'tests': ['not_null']}, {'name': 'total_amount', 'description': 'The total amount charged to passengers. Does not include cash tips.', 'tests': [{'conditional_values': {'condition': 'total_amount >= 0'}}]}, {'name': 'payment_type', 'description': 'A numeric code signifying how the passenger paid for the trip', 'tests': ['not_null']}, {'name': 'trip_type', 'description': 'Year of pickup', 'tests': [None]}, {'name': 'congestion_surcharge', 'description': 'An additional charge for trips taken during high traffic congestion times', 'tests': [None]}], 'original_file_path': 'models/tests/schema.yml', 'yaml_key': 'models', 'package_name': 'nyc_taxi'} - at path ['columns'][17]['tests'][0]: None is not valid under any of the given schemas
[2024-11-21T18:42:02.268+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T18:42:02.292+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 28.315 seconds
[2024-11-21T18:42:33.082+0000] {processor.py:161} INFO - Started process (PID=8029) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T18:42:33.084+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T18:42:33.089+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:42:33.088+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T18:42:33.194+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:42:33.193+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T18:42:37.287+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:42:37.287+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 4.064925004000543
[2024-11-21T18:42:37.289+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:42:37.288+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T18:42:37.290+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:42:37.290+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T18:42:37.308+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:42:37.307+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T18:42:37.323+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:42:37.323+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T18:42:37.349+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:42:37.349+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmptqxa1emm --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T18:42:46.481+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:42:46.480+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmptqxa1emm --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T18:43:01.107+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:43:01.096+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 213, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmptqxa1emm', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
18:42:52  Running with dbt=1.8.7
18:42:56  Registered adapter: bigquery=1.8.3
18:42:58  [WARNING]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
18:42:58  Encountered an error:
Parsing Error
  Invalid models config given in models/tests/schema.yml @ models: {'name': 'fct_trips', 'description': 'Fact Table of tripdata', 'columns': [{'name': 'trip_id', 'description': 'The primary key for this table', 'tests': ['unique']}, {'name': 'vendor_id', 'description': 'A code indicating the TPEP provider that provided the record', 'tests': ['not_null']}, {'name': 'pickup_time_id', 'description': 'id to get pickup time from dim_time', 'tests': ['not_null']}, {'name': 'dropoff_time_id', 'description': 'id to get dropoff time from dim_time', 'tests': ['not_null']}, {'name': 'rate_code_id', 'description': 'The final rate code in effect at the end of the trip', 'tests': ['not_null']}, {'name': 'pu_location_id', 'description': 'The pickup location', 'tests': ['not_null']}, {'name': 'do_location_id', 'description': 'The droppof location', 'tests': ['not_null']}, {'name': 'passenger_count', 'description': 'Customer count', 'tests': ['not_null']}, {'name': 'trip_distance', 'description': 'trip distance', 'tests': ['not_null']}, {'name': 'fare_amount', 'description': 'The time-and-distance fare calculated by the meter.', 'tests': [{'conditional_values': {'condition': 'fare_amount >= 0'}}]}, {'name': 'extra', 'description': 'Miscellaneous extras and surcharges. Currently, this only includes. the $0.50 and $1 rush hour and overnight charges', 'tests': ['not_null']}, {'name': 'mta_tax', 'description': '0.50 MTA tax that is automatically triggered based on the metered rate in use', 'tests': [{'conditional_values': {'condition': 'mta_tax >= 0'}}]}, {'name': 'tip_amount', 'description': 'Tip amount  This field is automatically populated for credit card tips.Cash tips are not included', 'tests': [{'conditional_values': {'condition': 'tip_amount >= 0'}}]}, {'name': 'tolls_amount', 'description': 'Total amount of all tolls paid in trip', 'tests': [{'conditional_values': {'condition': 'tolls_amount >= 0'}}]}, {'name': 'improvement_surcharge', 'description': '0.30 improvement surcharge assessed trips at the flag drop. the improvement surcharge began being levied in 2015', 'tests': ['not_null']}, {'name': 'total_amount', 'description': 'The total amount charged to passengers. Does not include cash tips.', 'tests': [{'conditional_values': {'condition': 'total_amount >= 0'}}]}, {'name': 'payment_type', 'description': 'A numeric code signifying how the passenger paid for the trip', 'tests': ['not_null']}, {'name': 'trip_type', 'description': 'Year of pickup', 'tests': [None]}, {'name': 'congestion_surcharge', 'description': 'An additional charge for trips taken during high traffic congestion times', 'tests': [None]}], 'original_file_path': 'models/tests/schema.yml', 'yaml_key': 'models', 'package_name': 'nyc_taxi'} - at path ['columns'][17]['tests'][0]: None is not valid under any of the given schemas
[2024-11-21T18:43:01.108+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T18:43:01.131+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 29.340 seconds
[2024-11-21T18:43:31.403+0000] {processor.py:161} INFO - Started process (PID=8080) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T18:43:31.405+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T18:43:31.409+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:43:31.409+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T18:43:31.511+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:43:31.510+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T18:43:34.369+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:43:34.369+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 4.082736120999471
[2024-11-21T18:43:34.371+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:43:34.370+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T18:43:34.372+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:43:34.372+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T18:43:34.389+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:43:34.389+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T18:43:34.404+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:43:34.403+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T18:43:34.428+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:43:34.428+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp3dulgt24 --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T18:43:43.923+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:43:43.922+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp3dulgt24 --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T18:43:58.846+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:43:58.836+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 213, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmp3dulgt24', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
18:43:50  Running with dbt=1.8.7
18:43:53  Registered adapter: bigquery=1.8.3
18:43:56  [WARNING]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
18:43:56  Encountered an error:
Parsing Error
  Invalid models config given in models/tests/schema.yml @ models: {'name': 'fct_trips', 'description': 'Fact Table of tripdata', 'columns': [{'name': 'trip_id', 'description': 'The primary key for this table', 'tests': ['unique']}, {'name': 'vendor_id', 'description': 'A code indicating the TPEP provider that provided the record', 'tests': ['not_null']}, {'name': 'pickup_time_id', 'description': 'id to get pickup time from dim_time', 'tests': ['not_null']}, {'name': 'dropoff_time_id', 'description': 'id to get dropoff time from dim_time', 'tests': ['not_null']}, {'name': 'rate_code_id', 'description': 'The final rate code in effect at the end of the trip', 'tests': ['not_null']}, {'name': 'pu_location_id', 'description': 'The pickup location', 'tests': ['not_null']}, {'name': 'do_location_id', 'description': 'The droppof location', 'tests': ['not_null']}, {'name': 'passenger_count', 'description': 'Customer count', 'tests': ['not_null']}, {'name': 'trip_distance', 'description': 'trip distance', 'tests': ['not_null']}, {'name': 'fare_amount', 'description': 'The time-and-distance fare calculated by the meter.', 'tests': [{'conditional_values': {'condition': 'fare_amount >= 0'}}]}, {'name': 'extra', 'description': 'Miscellaneous extras and surcharges. Currently, this only includes. the $0.50 and $1 rush hour and overnight charges', 'tests': ['not_null']}, {'name': 'mta_tax', 'description': '0.50 MTA tax that is automatically triggered based on the metered rate in use', 'tests': [{'conditional_values': {'condition': 'mta_tax >= 0'}}]}, {'name': 'tip_amount', 'description': 'Tip amount  This field is automatically populated for credit card tips.Cash tips are not included', 'tests': [{'conditional_values': {'condition': 'tip_amount >= 0'}}]}, {'name': 'tolls_amount', 'description': 'Total amount of all tolls paid in trip', 'tests': [{'conditional_values': {'condition': 'tolls_amount >= 0'}}]}, {'name': 'improvement_surcharge', 'description': '0.30 improvement surcharge assessed trips at the flag drop. the improvement surcharge began being levied in 2015', 'tests': ['not_null']}, {'name': 'total_amount', 'description': 'The total amount charged to passengers. Does not include cash tips.', 'tests': [{'conditional_values': {'condition': 'total_amount >= 0'}}]}, {'name': 'payment_type', 'description': 'A numeric code signifying how the passenger paid for the trip', 'tests': ['not_null']}, {'name': 'trip_type', 'description': 'Year of pickup', 'tests': [None]}, {'name': 'congestion_surcharge', 'description': 'An additional charge for trips taken during high traffic congestion times', 'tests': [None]}], 'original_file_path': 'models/tests/schema.yml', 'yaml_key': 'models', 'package_name': 'nyc_taxi'} - at path ['columns'][17]['tests'][0]: None is not valid under any of the given schemas
[2024-11-21T18:43:58.848+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T18:43:58.870+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 28.732 seconds
[2024-11-21T18:44:29.229+0000] {processor.py:161} INFO - Started process (PID=8132) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T18:44:29.231+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T18:44:29.235+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:44:29.235+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T18:44:29.339+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:44:29.339+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T18:44:32.067+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:44:32.066+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 3.97532072300055
[2024-11-21T18:44:32.068+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:44:32.068+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T18:44:32.069+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:44:32.069+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T18:44:32.086+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:44:32.086+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T18:44:32.103+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:44:32.102+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T18:44:32.125+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:44:32.125+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpe7del9l_ --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T18:44:41.721+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:44:41.720+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpe7del9l_ --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T18:44:56.161+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:44:56.149+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 213, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpe7del9l_', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
18:44:47  Running with dbt=1.8.7
18:44:50  Registered adapter: bigquery=1.8.3
18:44:53  [WARNING]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
18:44:53  Encountered an error:
Parsing Error
  Invalid models config given in models/tests/schema.yml @ models: {'name': 'fct_trips', 'description': 'Fact Table of tripdata', 'columns': [{'name': 'trip_id', 'description': 'The primary key for this table', 'tests': ['unique']}, {'name': 'vendor_id', 'description': 'A code indicating the TPEP provider that provided the record', 'tests': ['not_null']}, {'name': 'pickup_time_id', 'description': 'id to get pickup time from dim_time', 'tests': ['not_null']}, {'name': 'dropoff_time_id', 'description': 'id to get dropoff time from dim_time', 'tests': ['not_null']}, {'name': 'rate_code_id', 'description': 'The final rate code in effect at the end of the trip', 'tests': ['not_null']}, {'name': 'pu_location_id', 'description': 'The pickup location', 'tests': ['not_null']}, {'name': 'do_location_id', 'description': 'The droppof location', 'tests': ['not_null']}, {'name': 'passenger_count', 'description': 'Customer count', 'tests': ['not_null']}, {'name': 'trip_distance', 'description': 'trip distance', 'tests': ['not_null']}, {'name': 'fare_amount', 'description': 'The time-and-distance fare calculated by the meter.', 'tests': [{'conditional_values': {'condition': 'fare_amount >= 0'}}]}, {'name': 'extra', 'description': 'Miscellaneous extras and surcharges. Currently, this only includes. the $0.50 and $1 rush hour and overnight charges', 'tests': ['not_null']}, {'name': 'mta_tax', 'description': '0.50 MTA tax that is automatically triggered based on the metered rate in use', 'tests': [{'conditional_values': {'condition': 'mta_tax >= 0'}}]}, {'name': 'tip_amount', 'description': 'Tip amount  This field is automatically populated for credit card tips.Cash tips are not included', 'tests': [{'conditional_values': {'condition': 'tip_amount >= 0'}}]}, {'name': 'tolls_amount', 'description': 'Total amount of all tolls paid in trip', 'tests': [{'conditional_values': {'condition': 'tolls_amount >= 0'}}]}, {'name': 'improvement_surcharge', 'description': '0.30 improvement surcharge assessed trips at the flag drop. the improvement surcharge began being levied in 2015', 'tests': ['not_null']}, {'name': 'total_amount', 'description': 'The total amount charged to passengers. Does not include cash tips.', 'tests': [{'conditional_values': {'condition': 'total_amount >= 0'}}]}, {'name': 'payment_type', 'description': 'A numeric code signifying how the passenger paid for the trip', 'tests': ['not_null']}, {'name': 'trip_type', 'description': 'Year of pickup', 'tests': [None]}, {'name': 'congestion_surcharge', 'description': 'An additional charge for trips taken during high traffic congestion times', 'tests': [None]}], 'original_file_path': 'models/tests/schema.yml', 'yaml_key': 'models', 'package_name': 'nyc_taxi'} - at path ['columns'][17]['tests'][0]: None is not valid under any of the given schemas
[2024-11-21T18:44:56.170+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T18:44:56.197+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 28.256 seconds
[2024-11-21T18:45:26.708+0000] {processor.py:161} INFO - Started process (PID=8184) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T18:45:26.710+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T18:45:26.715+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:45:26.715+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T18:45:26.828+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:45:26.828+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T18:45:29.708+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:45:29.708+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 4.118822099000681
[2024-11-21T18:45:29.710+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:45:29.709+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T18:45:29.711+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:45:29.711+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T18:45:29.728+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:45:29.728+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T18:45:29.745+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:45:29.745+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T18:45:29.765+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:45:29.765+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp1o38330c --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T18:45:39.457+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:45:39.456+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp1o38330c --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T18:45:53.943+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:45:53.933+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 213, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmp1o38330c', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
18:45:45  Running with dbt=1.8.7
18:45:49  Registered adapter: bigquery=1.8.3
18:45:51  [WARNING]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
18:45:51  Encountered an error:
Parsing Error
  Invalid models config given in models/tests/schema.yml @ models: {'name': 'fct_trips', 'description': 'Fact Table of tripdata', 'columns': [{'name': 'trip_id', 'description': 'The primary key for this table', 'tests': ['unique']}, {'name': 'vendor_id', 'description': 'A code indicating the TPEP provider that provided the record', 'tests': ['not_null']}, {'name': 'pickup_time_id', 'description': 'id to get pickup time from dim_time', 'tests': ['not_null']}, {'name': 'dropoff_time_id', 'description': 'id to get dropoff time from dim_time', 'tests': ['not_null']}, {'name': 'rate_code_id', 'description': 'The final rate code in effect at the end of the trip', 'tests': ['not_null']}, {'name': 'pu_location_id', 'description': 'The pickup location', 'tests': ['not_null']}, {'name': 'do_location_id', 'description': 'The droppof location', 'tests': ['not_null']}, {'name': 'passenger_count', 'description': 'Customer count', 'tests': ['not_null']}, {'name': 'trip_distance', 'description': 'trip distance', 'tests': ['not_null']}, {'name': 'fare_amount', 'description': 'The time-and-distance fare calculated by the meter.', 'tests': [{'conditional_values': {'condition': 'fare_amount >= 0'}}]}, {'name': 'extra', 'description': 'Miscellaneous extras and surcharges. Currently, this only includes. the $0.50 and $1 rush hour and overnight charges', 'tests': ['not_null']}, {'name': 'mta_tax', 'description': '0.50 MTA tax that is automatically triggered based on the metered rate in use', 'tests': [{'conditional_values': {'condition': 'mta_tax >= 0'}}]}, {'name': 'tip_amount', 'description': 'Tip amount  This field is automatically populated for credit card tips.Cash tips are not included', 'tests': [{'conditional_values': {'condition': 'tip_amount >= 0'}}]}, {'name': 'tolls_amount', 'description': 'Total amount of all tolls paid in trip', 'tests': [{'conditional_values': {'condition': 'tolls_amount >= 0'}}]}, {'name': 'improvement_surcharge', 'description': '0.30 improvement surcharge assessed trips at the flag drop. the improvement surcharge began being levied in 2015', 'tests': ['not_null']}, {'name': 'total_amount', 'description': 'The total amount charged to passengers. Does not include cash tips.', 'tests': [{'conditional_values': {'condition': 'total_amount >= 0'}}]}, {'name': 'payment_type', 'description': 'A numeric code signifying how the passenger paid for the trip', 'tests': ['not_null']}, {'name': 'trip_type', 'description': 'Year of pickup', 'tests': [None]}, {'name': 'congestion_surcharge', 'description': 'An additional charge for trips taken during high traffic congestion times', 'tests': [None]}], 'original_file_path': 'models/tests/schema.yml', 'yaml_key': 'models', 'package_name': 'nyc_taxi'} - at path ['columns'][17]['tests'][0]: None is not valid under any of the given schemas
[2024-11-21T18:45:53.945+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T18:45:53.981+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 28.563 seconds
[2024-11-21T18:46:24.206+0000] {processor.py:161} INFO - Started process (PID=8236) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T18:46:24.208+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T18:46:24.213+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:46:24.212+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T18:46:24.305+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:46:24.305+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T18:46:27.012+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:46:27.012+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 4.036538810998536
[2024-11-21T18:46:27.013+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:46:27.013+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T18:46:27.015+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:46:27.014+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T18:46:27.032+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:46:27.032+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T18:46:27.047+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:46:27.047+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T18:46:27.069+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:46:27.069+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpfu8pyx5f --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T18:46:36.820+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:46:36.819+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpfu8pyx5f --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T18:46:51.485+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:46:51.474+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 213, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpfu8pyx5f', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
18:46:42  Running with dbt=1.8.7
18:46:46  Registered adapter: bigquery=1.8.3
18:46:48  [WARNING]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
18:46:49  Encountered an error:
Parsing Error
  Invalid models config given in models/tests/schema.yml @ models: {'name': 'fct_trips', 'description': 'Fact Table of tripdata', 'columns': [{'name': 'trip_id', 'description': 'The primary key for this table', 'tests': ['unique']}, {'name': 'vendor_id', 'description': 'A code indicating the TPEP provider that provided the record', 'tests': ['not_null']}, {'name': 'pickup_time_id', 'description': 'id to get pickup time from dim_time', 'tests': ['not_null']}, {'name': 'dropoff_time_id', 'description': 'id to get dropoff time from dim_time', 'tests': ['not_null']}, {'name': 'rate_code_id', 'description': 'The final rate code in effect at the end of the trip', 'tests': ['not_null']}, {'name': 'pu_location_id', 'description': 'The pickup location', 'tests': ['not_null']}, {'name': 'do_location_id', 'description': 'The droppof location', 'tests': ['not_null']}, {'name': 'passenger_count', 'description': 'Customer count', 'tests': ['not_null']}, {'name': 'trip_distance', 'description': 'trip distance', 'tests': ['not_null']}, {'name': 'fare_amount', 'description': 'The time-and-distance fare calculated by the meter.', 'tests': [{'conditional_values': {'condition': 'fare_amount >= 0'}}]}, {'name': 'extra', 'description': 'Miscellaneous extras and surcharges. Currently, this only includes. the $0.50 and $1 rush hour and overnight charges', 'tests': ['not_null']}, {'name': 'mta_tax', 'description': '0.50 MTA tax that is automatically triggered based on the metered rate in use', 'tests': [{'conditional_values': {'condition': 'mta_tax >= 0'}}]}, {'name': 'tip_amount', 'description': 'Tip amount  This field is automatically populated for credit card tips.Cash tips are not included', 'tests': [{'conditional_values': {'condition': 'tip_amount >= 0'}}]}, {'name': 'tolls_amount', 'description': 'Total amount of all tolls paid in trip', 'tests': [{'conditional_values': {'condition': 'tolls_amount >= 0'}}]}, {'name': 'improvement_surcharge', 'description': '0.30 improvement surcharge assessed trips at the flag drop. the improvement surcharge began being levied in 2015', 'tests': ['not_null']}, {'name': 'total_amount', 'description': 'The total amount charged to passengers. Does not include cash tips.', 'tests': [{'conditional_values': {'condition': 'total_amount >= 0'}}]}, {'name': 'payment_type', 'description': 'A numeric code signifying how the passenger paid for the trip', 'tests': ['not_null']}, {'name': 'trip_type', 'description': 'Year of pickup', 'tests': [None]}, {'name': 'congestion_surcharge', 'description': 'An additional charge for trips taken during high traffic congestion times', 'tests': [None]}], 'original_file_path': 'models/tests/schema.yml', 'yaml_key': 'models', 'package_name': 'nyc_taxi'} - at path ['columns'][17]['tests'][0]: None is not valid under any of the given schemas
[2024-11-21T18:46:51.487+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T18:46:51.510+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 28.682 seconds
[2024-11-21T18:47:21.818+0000] {processor.py:161} INFO - Started process (PID=8288) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T18:47:21.820+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T18:47:21.824+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:47:21.823+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T18:47:21.919+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:47:21.919+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T18:47:24.860+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:47:24.860+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 4.191223429999809
[2024-11-21T18:47:24.862+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:47:24.861+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T18:47:24.863+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:47:24.863+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T18:47:24.882+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:47:24.881+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T18:47:24.896+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:47:24.896+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T18:47:24.921+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:47:24.921+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp3t85wx9l --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T18:47:35.139+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:47:35.138+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp3t85wx9l --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T18:47:49.778+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:47:49.767+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 213, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmp3t85wx9l', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
18:47:40  Running with dbt=1.8.7
18:47:44  Registered adapter: bigquery=1.8.3
18:47:47  [WARNING]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
18:47:47  Encountered an error:
Parsing Error
  Invalid models config given in models/tests/schema.yml @ models: {'name': 'fct_trips', 'description': 'Fact Table of tripdata', 'columns': [{'name': 'trip_id', 'description': 'The primary key for this table', 'tests': ['unique']}, {'name': 'vendor_id', 'description': 'A code indicating the TPEP provider that provided the record', 'tests': ['not_null']}, {'name': 'pickup_time_id', 'description': 'id to get pickup time from dim_time', 'tests': ['not_null']}, {'name': 'dropoff_time_id', 'description': 'id to get dropoff time from dim_time', 'tests': ['not_null']}, {'name': 'rate_code_id', 'description': 'The final rate code in effect at the end of the trip', 'tests': ['not_null']}, {'name': 'pu_location_id', 'description': 'The pickup location', 'tests': ['not_null']}, {'name': 'do_location_id', 'description': 'The droppof location', 'tests': ['not_null']}, {'name': 'passenger_count', 'description': 'Customer count', 'tests': ['not_null']}, {'name': 'trip_distance', 'description': 'trip distance', 'tests': ['not_null']}, {'name': 'fare_amount', 'description': 'The time-and-distance fare calculated by the meter.', 'tests': [{'conditional_values': {'condition': 'fare_amount >= 0'}}]}, {'name': 'extra', 'description': 'Miscellaneous extras and surcharges. Currently, this only includes. the $0.50 and $1 rush hour and overnight charges', 'tests': ['not_null']}, {'name': 'mta_tax', 'description': '0.50 MTA tax that is automatically triggered based on the metered rate in use', 'tests': [{'conditional_values': {'condition': 'mta_tax >= 0'}}]}, {'name': 'tip_amount', 'description': 'Tip amount  This field is automatically populated for credit card tips.Cash tips are not included', 'tests': [{'conditional_values': {'condition': 'tip_amount >= 0'}}]}, {'name': 'tolls_amount', 'description': 'Total amount of all tolls paid in trip', 'tests': [{'conditional_values': {'condition': 'tolls_amount >= 0'}}]}, {'name': 'improvement_surcharge', 'description': '0.30 improvement surcharge assessed trips at the flag drop. the improvement surcharge began being levied in 2015', 'tests': ['not_null']}, {'name': 'total_amount', 'description': 'The total amount charged to passengers. Does not include cash tips.', 'tests': [{'conditional_values': {'condition': 'total_amount >= 0'}}]}, {'name': 'payment_type', 'description': 'A numeric code signifying how the passenger paid for the trip', 'tests': ['not_null']}, {'name': 'trip_type', 'description': 'Year of pickup', 'tests': [None]}, {'name': 'congestion_surcharge', 'description': 'An additional charge for trips taken during high traffic congestion times', 'tests': [None]}], 'original_file_path': 'models/tests/schema.yml', 'yaml_key': 'models', 'package_name': 'nyc_taxi'} - at path ['columns'][17]['tests'][0]: None is not valid under any of the given schemas
[2024-11-21T18:47:49.780+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T18:47:49.809+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 29.287 seconds
[2024-11-21T18:48:20.273+0000] {processor.py:161} INFO - Started process (PID=8340) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T18:48:20.275+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T18:48:20.279+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:48:20.278+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T18:48:20.381+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:48:20.381+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T18:48:23.112+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:48:23.111+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 4.015499769999224
[2024-11-21T18:48:23.113+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:48:23.113+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T18:48:23.114+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:48:23.114+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T18:48:23.132+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:48:23.132+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T18:48:23.155+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:48:23.155+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T18:48:23.175+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:48:23.174+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpbh8pkpbq --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T18:48:33.172+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:48:33.171+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpbh8pkpbq --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T18:48:47.607+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:48:47.595+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 213, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpbh8pkpbq', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
18:48:39  Running with dbt=1.8.7
18:48:42  Registered adapter: bigquery=1.8.3
18:48:45  [WARNING]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
18:48:45  Encountered an error:
Parsing Error
  Invalid models config given in models/tests/schema.yml @ models: {'name': 'fct_trips', 'description': 'Fact Table of tripdata', 'columns': [{'name': 'trip_id', 'description': 'The primary key for this table', 'tests': ['unique']}, {'name': 'vendor_id', 'description': 'A code indicating the TPEP provider that provided the record', 'tests': ['not_null']}, {'name': 'pickup_time_id', 'description': 'id to get pickup time from dim_time', 'tests': ['not_null']}, {'name': 'dropoff_time_id', 'description': 'id to get dropoff time from dim_time', 'tests': ['not_null']}, {'name': 'rate_code_id', 'description': 'The final rate code in effect at the end of the trip', 'tests': ['not_null']}, {'name': 'pu_location_id', 'description': 'The pickup location', 'tests': ['not_null']}, {'name': 'do_location_id', 'description': 'The droppof location', 'tests': ['not_null']}, {'name': 'passenger_count', 'description': 'Customer count', 'tests': ['not_null']}, {'name': 'trip_distance', 'description': 'trip distance', 'tests': ['not_null']}, {'name': 'fare_amount', 'description': 'The time-and-distance fare calculated by the meter.', 'tests': [{'conditional_values': {'condition': 'fare_amount >= 0'}}]}, {'name': 'extra', 'description': 'Miscellaneous extras and surcharges. Currently, this only includes. the $0.50 and $1 rush hour and overnight charges', 'tests': ['not_null']}, {'name': 'mta_tax', 'description': '0.50 MTA tax that is automatically triggered based on the metered rate in use', 'tests': [{'conditional_values': {'condition': 'mta_tax >= 0'}}]}, {'name': 'tip_amount', 'description': 'Tip amount  This field is automatically populated for credit card tips.Cash tips are not included', 'tests': [{'conditional_values': {'condition': 'tip_amount >= 0'}}]}, {'name': 'tolls_amount', 'description': 'Total amount of all tolls paid in trip', 'tests': [{'conditional_values': {'condition': 'tolls_amount >= 0'}}]}, {'name': 'improvement_surcharge', 'description': '0.30 improvement surcharge assessed trips at the flag drop. the improvement surcharge began being levied in 2015', 'tests': ['not_null']}, {'name': 'total_amount', 'description': 'The total amount charged to passengers. Does not include cash tips.', 'tests': [{'conditional_values': {'condition': 'total_amount >= 0'}}]}, {'name': 'payment_type', 'description': 'A numeric code signifying how the passenger paid for the trip', 'tests': ['not_null']}, {'name': 'trip_type', 'description': 'Year of pickup', 'tests': [None]}, {'name': 'congestion_surcharge', 'description': 'An additional charge for trips taken during high traffic congestion times', 'tests': [None]}], 'original_file_path': 'models/tests/schema.yml', 'yaml_key': 'models', 'package_name': 'nyc_taxi'} - at path ['columns'][17]['tests'][0]: None is not valid under any of the given schemas
[2024-11-21T18:48:47.609+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T18:48:47.638+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 28.694 seconds
[2024-11-21T18:49:17.870+0000] {processor.py:161} INFO - Started process (PID=8392) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T18:49:17.872+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T18:49:17.878+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:49:17.877+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T18:49:17.988+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:49:17.987+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T18:49:20.514+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:49:20.514+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 3.86765283099885
[2024-11-21T18:49:20.516+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:49:20.515+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T18:49:20.517+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:49:20.517+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T18:49:20.533+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:49:20.533+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T18:49:20.549+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:49:20.548+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T18:49:20.572+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:49:20.572+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpe6p55s75 --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T18:49:30.684+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:49:30.683+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpe6p55s75 --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T18:49:45.024+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:49:45.014+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 213, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpe6p55s75', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
18:49:36  Running with dbt=1.8.7
18:49:40  Registered adapter: bigquery=1.8.3
18:49:42  [WARNING]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
18:49:42  Encountered an error:
Parsing Error
  Invalid models config given in models/tests/schema.yml @ models: {'name': 'fct_trips', 'description': 'Fact Table of tripdata', 'columns': [{'name': 'trip_id', 'description': 'The primary key for this table', 'tests': ['unique']}, {'name': 'vendor_id', 'description': 'A code indicating the TPEP provider that provided the record', 'tests': ['not_null']}, {'name': 'pickup_time_id', 'description': 'id to get pickup time from dim_time', 'tests': ['not_null']}, {'name': 'dropoff_time_id', 'description': 'id to get dropoff time from dim_time', 'tests': ['not_null']}, {'name': 'rate_code_id', 'description': 'The final rate code in effect at the end of the trip', 'tests': ['not_null']}, {'name': 'pu_location_id', 'description': 'The pickup location', 'tests': ['not_null']}, {'name': 'do_location_id', 'description': 'The droppof location', 'tests': ['not_null']}, {'name': 'passenger_count', 'description': 'Customer count', 'tests': ['not_null']}, {'name': 'trip_distance', 'description': 'trip distance', 'tests': ['not_null']}, {'name': 'fare_amount', 'description': 'The time-and-distance fare calculated by the meter.', 'tests': [{'conditional_values': {'condition': 'fare_amount >= 0'}}]}, {'name': 'extra', 'description': 'Miscellaneous extras and surcharges. Currently, this only includes. the $0.50 and $1 rush hour and overnight charges', 'tests': ['not_null']}, {'name': 'mta_tax', 'description': '0.50 MTA tax that is automatically triggered based on the metered rate in use', 'tests': [{'conditional_values': {'condition': 'mta_tax >= 0'}}]}, {'name': 'tip_amount', 'description': 'Tip amount  This field is automatically populated for credit card tips.Cash tips are not included', 'tests': [{'conditional_values': {'condition': 'tip_amount >= 0'}}]}, {'name': 'tolls_amount', 'description': 'Total amount of all tolls paid in trip', 'tests': [{'conditional_values': {'condition': 'tolls_amount >= 0'}}]}, {'name': 'improvement_surcharge', 'description': '0.30 improvement surcharge assessed trips at the flag drop. the improvement surcharge began being levied in 2015', 'tests': ['not_null']}, {'name': 'total_amount', 'description': 'The total amount charged to passengers. Does not include cash tips.', 'tests': [{'conditional_values': {'condition': 'total_amount >= 0'}}]}, {'name': 'payment_type', 'description': 'A numeric code signifying how the passenger paid for the trip', 'tests': ['not_null']}, {'name': 'trip_type', 'description': 'Year of pickup', 'tests': [None]}, {'name': 'congestion_surcharge', 'description': 'An additional charge for trips taken during high traffic congestion times', 'tests': [None]}], 'original_file_path': 'models/tests/schema.yml', 'yaml_key': 'models', 'package_name': 'nyc_taxi'} - at path ['columns'][17]['tests'][0]: None is not valid under any of the given schemas
[2024-11-21T18:49:45.026+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T18:49:45.053+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 28.577 seconds
[2024-11-21T18:50:15.611+0000] {processor.py:161} INFO - Started process (PID=8444) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T18:50:15.613+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T18:50:15.617+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:50:15.616+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T18:50:15.725+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:50:15.725+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T18:50:18.420+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:50:18.419+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 4.00636740399932
[2024-11-21T18:50:18.421+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:50:18.420+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T18:50:18.422+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:50:18.422+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T18:50:18.441+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:50:18.441+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T18:50:18.457+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:50:18.456+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T18:50:18.486+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:50:18.485+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpv0y6pbvi --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T18:50:29.231+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:50:29.230+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpv0y6pbvi --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T18:50:43.917+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:50:43.905+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 213, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpv0y6pbvi', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
18:50:35  Running with dbt=1.8.7
18:50:38  Registered adapter: bigquery=1.8.3
18:50:41  [WARNING]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
18:50:41  Encountered an error:
Parsing Error
  Invalid models config given in models/tests/schema.yml @ models: {'name': 'fct_trips', 'description': 'Fact Table of tripdata', 'columns': [{'name': 'trip_id', 'description': 'The primary key for this table', 'tests': ['unique']}, {'name': 'vendor_id', 'description': 'A code indicating the TPEP provider that provided the record', 'tests': ['not_null']}, {'name': 'pickup_time_id', 'description': 'id to get pickup time from dim_time', 'tests': ['not_null']}, {'name': 'dropoff_time_id', 'description': 'id to get dropoff time from dim_time', 'tests': ['not_null']}, {'name': 'rate_code_id', 'description': 'The final rate code in effect at the end of the trip', 'tests': ['not_null']}, {'name': 'pu_location_id', 'description': 'The pickup location', 'tests': ['not_null']}, {'name': 'do_location_id', 'description': 'The droppof location', 'tests': ['not_null']}, {'name': 'passenger_count', 'description': 'Customer count', 'tests': ['not_null']}, {'name': 'trip_distance', 'description': 'trip distance', 'tests': ['not_null']}, {'name': 'fare_amount', 'description': 'The time-and-distance fare calculated by the meter.', 'tests': [{'conditional_values': {'condition': 'fare_amount >= 0'}}]}, {'name': 'extra', 'description': 'Miscellaneous extras and surcharges. Currently, this only includes. the $0.50 and $1 rush hour and overnight charges', 'tests': ['not_null']}, {'name': 'mta_tax', 'description': '0.50 MTA tax that is automatically triggered based on the metered rate in use', 'tests': [{'conditional_values': {'condition': 'mta_tax >= 0'}}]}, {'name': 'tip_amount', 'description': 'Tip amount  This field is automatically populated for credit card tips.Cash tips are not included', 'tests': [{'conditional_values': {'condition': 'tip_amount >= 0'}}]}, {'name': 'tolls_amount', 'description': 'Total amount of all tolls paid in trip', 'tests': [{'conditional_values': {'condition': 'tolls_amount >= 0'}}]}, {'name': 'improvement_surcharge', 'description': '0.30 improvement surcharge assessed trips at the flag drop. the improvement surcharge began being levied in 2015', 'tests': ['not_null']}, {'name': 'total_amount', 'description': 'The total amount charged to passengers. Does not include cash tips.', 'tests': [{'conditional_values': {'condition': 'total_amount >= 0'}}]}, {'name': 'payment_type', 'description': 'A numeric code signifying how the passenger paid for the trip', 'tests': ['not_null']}, {'name': 'trip_type', 'description': 'Year of pickup', 'tests': [None]}, {'name': 'congestion_surcharge', 'description': 'An additional charge for trips taken during high traffic congestion times', 'tests': [None]}], 'original_file_path': 'models/tests/schema.yml', 'yaml_key': 'models', 'package_name': 'nyc_taxi'} - at path ['columns'][17]['tests'][0]: None is not valid under any of the given schemas
[2024-11-21T18:50:43.919+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T18:50:43.941+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 29.686 seconds
[2024-11-21T18:51:14.216+0000] {processor.py:161} INFO - Started process (PID=8496) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T18:51:14.219+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T18:51:14.223+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:51:14.223+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T18:51:14.324+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:51:14.323+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T18:51:16.970+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:51:16.969+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 4.033745591001207
[2024-11-21T18:51:16.971+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:51:16.971+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T18:51:16.972+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:51:16.972+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T18:51:16.989+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:51:16.989+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T18:51:17.003+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:51:17.003+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T18:51:17.029+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:51:17.028+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpggi1m3gr --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T18:51:27.196+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:51:27.195+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpggi1m3gr --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T18:51:42.261+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:51:42.249+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 213, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpggi1m3gr', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
18:51:33  Running with dbt=1.8.7
18:51:37  Registered adapter: bigquery=1.8.3
18:51:39  [WARNING]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
18:51:39  Encountered an error:
Parsing Error
  Invalid models config given in models/tests/schema.yml @ models: {'name': 'fct_trips', 'description': 'Fact Table of tripdata', 'columns': [{'name': 'trip_id', 'description': 'The primary key for this table', 'tests': ['unique']}, {'name': 'vendor_id', 'description': 'A code indicating the TPEP provider that provided the record', 'tests': ['not_null']}, {'name': 'pickup_time_id', 'description': 'id to get pickup time from dim_time', 'tests': ['not_null']}, {'name': 'dropoff_time_id', 'description': 'id to get dropoff time from dim_time', 'tests': ['not_null']}, {'name': 'rate_code_id', 'description': 'The final rate code in effect at the end of the trip', 'tests': ['not_null']}, {'name': 'pu_location_id', 'description': 'The pickup location', 'tests': ['not_null']}, {'name': 'do_location_id', 'description': 'The droppof location', 'tests': ['not_null']}, {'name': 'passenger_count', 'description': 'Customer count', 'tests': ['not_null']}, {'name': 'trip_distance', 'description': 'trip distance', 'tests': ['not_null']}, {'name': 'fare_amount', 'description': 'The time-and-distance fare calculated by the meter.', 'tests': [{'conditional_values': {'condition': 'fare_amount >= 0'}}]}, {'name': 'extra', 'description': 'Miscellaneous extras and surcharges. Currently, this only includes. the $0.50 and $1 rush hour and overnight charges', 'tests': ['not_null']}, {'name': 'mta_tax', 'description': '0.50 MTA tax that is automatically triggered based on the metered rate in use', 'tests': [{'conditional_values': {'condition': 'mta_tax >= 0'}}]}, {'name': 'tip_amount', 'description': 'Tip amount  This field is automatically populated for credit card tips.Cash tips are not included', 'tests': [{'conditional_values': {'condition': 'tip_amount >= 0'}}]}, {'name': 'tolls_amount', 'description': 'Total amount of all tolls paid in trip', 'tests': [{'conditional_values': {'condition': 'tolls_amount >= 0'}}]}, {'name': 'improvement_surcharge', 'description': '0.30 improvement surcharge assessed trips at the flag drop. the improvement surcharge began being levied in 2015', 'tests': ['not_null']}, {'name': 'total_amount', 'description': 'The total amount charged to passengers. Does not include cash tips.', 'tests': [{'conditional_values': {'condition': 'total_amount >= 0'}}]}, {'name': 'payment_type', 'description': 'A numeric code signifying how the passenger paid for the trip', 'tests': ['not_null']}, {'name': 'trip_type', 'description': 'Year of pickup', 'tests': [None]}, {'name': 'congestion_surcharge', 'description': 'An additional charge for trips taken during high traffic congestion times', 'tests': [None]}], 'original_file_path': 'models/tests/schema.yml', 'yaml_key': 'models', 'package_name': 'nyc_taxi'} - at path ['columns'][17]['tests'][0]: None is not valid under any of the given schemas
[2024-11-21T18:51:42.263+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T18:51:42.294+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 29.513 seconds
[2024-11-21T18:52:12.502+0000] {processor.py:161} INFO - Started process (PID=8548) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T18:52:12.505+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T18:52:12.509+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:52:12.509+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T18:52:12.605+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:52:12.604+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T18:52:16.291+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:52:16.291+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 3.658669776001261
[2024-11-21T18:52:16.292+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:52:16.292+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T18:52:16.293+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:52:16.293+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T18:52:16.305+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:52:16.305+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T18:52:16.322+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:52:16.321+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T18:52:16.344+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:52:16.344+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpts9oc3tk --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T18:52:26.331+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:52:26.330+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpts9oc3tk --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T18:52:40.115+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:52:40.104+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 213, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpts9oc3tk', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
18:52:32  Running with dbt=1.8.7
18:52:36  Registered adapter: bigquery=1.8.3
18:52:38  [WARNING]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
18:52:38  Encountered an error:
Parsing Error
  Invalid models config given in models/tests/schema.yml @ models: {'name': 'fct_trips', 'description': 'Fact Table of tripdata', 'columns': [{'name': 'trip_id', 'description': 'The primary key for this table', 'tests': ['unique']}, {'name': 'vendor_id', 'description': 'A code indicating the TPEP provider that provided the record', 'tests': ['not_null']}, {'name': 'pickup_time_id', 'description': 'id to get pickup time from dim_time', 'tests': ['not_null']}, {'name': 'dropoff_time_id', 'description': 'id to get dropoff time from dim_time', 'tests': ['not_null']}, {'name': 'rate_code_id', 'description': 'The final rate code in effect at the end of the trip', 'tests': ['not_null']}, {'name': 'pu_location_id', 'description': 'The pickup location', 'tests': ['not_null']}, {'name': 'do_location_id', 'description': 'The droppof location', 'tests': ['not_null']}, {'name': 'passenger_count', 'description': 'Customer count', 'tests': ['not_null']}, {'name': 'trip_distance', 'description': 'trip distance', 'tests': ['not_null']}, {'name': 'fare_amount', 'description': 'The time-and-distance fare calculated by the meter.', 'tests': [{'conditional_values': {'condition': 'fare_amount >= 0'}}]}, {'name': 'extra', 'description': 'Miscellaneous extras and surcharges. Currently, this only includes. the $0.50 and $1 rush hour and overnight charges', 'tests': ['not_null']}, {'name': 'mta_tax', 'description': '0.50 MTA tax that is automatically triggered based on the metered rate in use', 'tests': [{'conditional_values': {'condition': 'mta_tax >= 0'}}]}, {'name': 'tip_amount', 'description': 'Tip amount  This field is automatically populated for credit card tips.Cash tips are not included', 'tests': [{'conditional_values': {'condition': 'tip_amount >= 0'}}]}, {'name': 'tolls_amount', 'description': 'Total amount of all tolls paid in trip', 'tests': [{'conditional_values': {'condition': 'tolls_amount >= 0'}}]}, {'name': 'improvement_surcharge', 'description': '0.30 improvement surcharge assessed trips at the flag drop. the improvement surcharge began being levied in 2015', 'tests': ['not_null']}, {'name': 'total_amount', 'description': 'The total amount charged to passengers. Does not include cash tips.', 'tests': [{'conditional_values': {'condition': 'total_amount >= 0'}}]}, {'name': 'payment_type', 'description': 'A numeric code signifying how the passenger paid for the trip', 'tests': ['not_null']}, {'name': 'trip_type', 'description': 'Year of pickup', 'tests': [None]}, {'name': 'congestion_surcharge', 'description': 'An additional charge for trips taken during high traffic congestion times', 'tests': [None]}], 'original_file_path': 'models/tests/schema.yml', 'yaml_key': 'models', 'package_name': 'nyc_taxi'} - at path ['columns'][17]['tests'][0]: None is not valid under any of the given schemas
[2024-11-21T18:52:40.117+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T18:52:40.140+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 29.033 seconds
[2024-11-21T18:53:10.404+0000] {processor.py:161} INFO - Started process (PID=8599) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T18:53:10.406+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T18:53:10.410+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:53:10.409+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T18:53:10.504+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:53:10.503+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T18:53:14.491+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:53:14.491+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 3.9553579600014928
[2024-11-21T18:53:14.493+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:53:14.492+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T18:53:14.494+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:53:14.494+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T18:53:14.510+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:53:14.510+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T18:53:14.524+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:53:14.523+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T18:53:14.548+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:53:14.547+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpw6zqo9q3 --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T18:53:24.629+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:53:24.628+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpw6zqo9q3 --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T18:53:38.080+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:53:38.069+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 213, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpw6zqo9q3', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
18:53:30  Running with dbt=1.8.7
18:53:34  Registered adapter: bigquery=1.8.3
18:53:36  [WARNING]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
18:53:37  Encountered an error:
Parsing Error
  Invalid models config given in models/tests/schema.yml @ models: {'name': 'fct_trips', 'description': 'Fact Table of tripdata', 'columns': [{'name': 'trip_id', 'description': 'The primary key for this table', 'tests': ['unique']}, {'name': 'vendor_id', 'description': 'A code indicating the TPEP provider that provided the record', 'tests': ['not_null']}, {'name': 'pickup_time_id', 'description': 'id to get pickup time from dim_time', 'tests': ['not_null']}, {'name': 'dropoff_time_id', 'description': 'id to get dropoff time from dim_time', 'tests': ['not_null']}, {'name': 'rate_code_id', 'description': 'The final rate code in effect at the end of the trip', 'tests': ['not_null']}, {'name': 'pu_location_id', 'description': 'The pickup location', 'tests': ['not_null']}, {'name': 'do_location_id', 'description': 'The droppof location', 'tests': ['not_null']}, {'name': 'passenger_count', 'description': 'Customer count', 'tests': ['not_null']}, {'name': 'trip_distance', 'description': 'trip distance', 'tests': ['not_null']}, {'name': 'fare_amount', 'description': 'The time-and-distance fare calculated by the meter.', 'tests': [{'conditional_values': {'condition': 'fare_amount >= 0'}}]}, {'name': 'extra', 'description': 'Miscellaneous extras and surcharges. Currently, this only includes. the $0.50 and $1 rush hour and overnight charges', 'tests': ['not_null']}, {'name': 'mta_tax', 'description': '0.50 MTA tax that is automatically triggered based on the metered rate in use', 'tests': [{'conditional_values': {'condition': 'mta_tax >= 0'}}]}, {'name': 'tip_amount', 'description': 'Tip amount  This field is automatically populated for credit card tips.Cash tips are not included', 'tests': [{'conditional_values': {'condition': 'tip_amount >= 0'}}]}, {'name': 'tolls_amount', 'description': 'Total amount of all tolls paid in trip', 'tests': [{'conditional_values': {'condition': 'tolls_amount >= 0'}}]}, {'name': 'improvement_surcharge', 'description': '0.30 improvement surcharge assessed trips at the flag drop. the improvement surcharge began being levied in 2015', 'tests': ['not_null']}, {'name': 'total_amount', 'description': 'The total amount charged to passengers. Does not include cash tips.', 'tests': [{'conditional_values': {'condition': 'total_amount >= 0'}}]}, {'name': 'payment_type', 'description': 'A numeric code signifying how the passenger paid for the trip', 'tests': ['not_null']}, {'name': 'trip_type', 'description': 'Year of pickup', 'tests': [None]}, {'name': 'congestion_surcharge', 'description': 'An additional charge for trips taken during high traffic congestion times', 'tests': [None]}], 'original_file_path': 'models/tests/schema.yml', 'yaml_key': 'models', 'package_name': 'nyc_taxi'} - at path ['columns'][17]['tests'][0]: None is not valid under any of the given schemas
[2024-11-21T18:53:38.081+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T18:53:38.108+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 29.054 seconds
[2024-11-21T18:54:08.329+0000] {processor.py:161} INFO - Started process (PID=8651) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T18:54:08.331+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T18:54:08.335+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:54:08.334+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T18:54:08.432+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:54:08.431+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T18:54:12.198+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:54:12.197+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 3.7408356739997544
[2024-11-21T18:54:12.199+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:54:12.199+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T18:54:12.200+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:54:12.200+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T18:54:12.215+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:54:12.215+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T18:54:12.233+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:54:12.233+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T18:54:12.254+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:54:12.254+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp57j5c_u8 --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T18:54:22.772+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:54:22.770+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp57j5c_u8 --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T18:54:36.427+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:54:36.415+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 213, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmp57j5c_u8', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
18:54:28  Running with dbt=1.8.7
18:54:32  Registered adapter: bigquery=1.8.3
18:54:34  [WARNING]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
18:54:34  Encountered an error:
Parsing Error
  Invalid models config given in models/tests/schema.yml @ models: {'name': 'fct_trips', 'description': 'Fact Table of tripdata', 'columns': [{'name': 'trip_id', 'description': 'The primary key for this table', 'tests': ['unique']}, {'name': 'vendor_id', 'description': 'A code indicating the TPEP provider that provided the record', 'tests': ['not_null']}, {'name': 'pickup_time_id', 'description': 'id to get pickup time from dim_time', 'tests': ['not_null']}, {'name': 'dropoff_time_id', 'description': 'id to get dropoff time from dim_time', 'tests': ['not_null']}, {'name': 'rate_code_id', 'description': 'The final rate code in effect at the end of the trip', 'tests': ['not_null']}, {'name': 'pu_location_id', 'description': 'The pickup location', 'tests': ['not_null']}, {'name': 'do_location_id', 'description': 'The droppof location', 'tests': ['not_null']}, {'name': 'passenger_count', 'description': 'Customer count', 'tests': ['not_null']}, {'name': 'trip_distance', 'description': 'trip distance', 'tests': ['not_null']}, {'name': 'fare_amount', 'description': 'The time-and-distance fare calculated by the meter.', 'tests': [{'conditional_values': {'condition': 'fare_amount >= 0'}}]}, {'name': 'extra', 'description': 'Miscellaneous extras and surcharges. Currently, this only includes. the $0.50 and $1 rush hour and overnight charges', 'tests': ['not_null']}, {'name': 'mta_tax', 'description': '0.50 MTA tax that is automatically triggered based on the metered rate in use', 'tests': [{'conditional_values': {'condition': 'mta_tax >= 0'}}]}, {'name': 'tip_amount', 'description': 'Tip amount  This field is automatically populated for credit card tips.Cash tips are not included', 'tests': [{'conditional_values': {'condition': 'tip_amount >= 0'}}]}, {'name': 'tolls_amount', 'description': 'Total amount of all tolls paid in trip', 'tests': [{'conditional_values': {'condition': 'tolls_amount >= 0'}}]}, {'name': 'improvement_surcharge', 'description': '0.30 improvement surcharge assessed trips at the flag drop. the improvement surcharge began being levied in 2015', 'tests': ['not_null']}, {'name': 'total_amount', 'description': 'The total amount charged to passengers. Does not include cash tips.', 'tests': [{'conditional_values': {'condition': 'total_amount >= 0'}}]}, {'name': 'payment_type', 'description': 'A numeric code signifying how the passenger paid for the trip', 'tests': ['not_null']}, {'name': 'trip_type', 'description': 'Year of pickup', 'tests': [None]}, {'name': 'congestion_surcharge', 'description': 'An additional charge for trips taken during high traffic congestion times', 'tests': [None]}], 'original_file_path': 'models/tests/schema.yml', 'yaml_key': 'models', 'package_name': 'nyc_taxi'} - at path ['columns'][17]['tests'][0]: None is not valid under any of the given schemas
[2024-11-21T18:54:36.429+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T18:54:36.451+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 29.488 seconds
[2024-11-21T18:55:06.663+0000] {processor.py:161} INFO - Started process (PID=8703) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T18:55:06.665+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T18:55:06.669+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:55:06.668+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T18:55:06.773+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:55:06.773+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T18:55:10.678+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:55:10.677+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 3.876879823001218
[2024-11-21T18:55:10.679+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:55:10.679+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T18:55:10.681+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:55:10.680+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T18:55:10.698+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:55:10.697+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T18:55:10.719+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:55:10.718+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T18:55:10.744+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:55:10.744+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpowqmer6_ --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T18:55:20.335+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:55:20.334+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpowqmer6_ --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T18:55:34.719+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:55:34.707+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 213, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpowqmer6_', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
18:55:26  Running with dbt=1.8.7
18:55:30  Registered adapter: bigquery=1.8.3
18:55:31  [WARNING]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
18:55:32  Encountered an error:
Parsing Error
  Invalid models config given in models/tests/schema.yml @ models: {'name': 'fct_trips', 'description': 'Fact Table of tripdata', 'columns': [{'name': 'trip_id', 'description': 'The primary key for this table', 'tests': ['unique']}, {'name': 'vendor_id', 'description': 'A code indicating the TPEP provider that provided the record', 'tests': ['not_null']}, {'name': 'pickup_time_id', 'description': 'id to get pickup time from dim_time', 'tests': ['not_null']}, {'name': 'dropoff_time_id', 'description': 'id to get dropoff time from dim_time', 'tests': ['not_null']}, {'name': 'rate_code_id', 'description': 'The final rate code in effect at the end of the trip', 'tests': ['not_null']}, {'name': 'pu_location_id', 'description': 'The pickup location', 'tests': ['not_null']}, {'name': 'do_location_id', 'description': 'The droppof location', 'tests': ['not_null']}, {'name': 'passenger_count', 'description': 'Customer count', 'tests': ['not_null']}, {'name': 'trip_distance', 'description': 'trip distance', 'tests': ['not_null']}, {'name': 'fare_amount', 'description': 'The time-and-distance fare calculated by the meter.', 'tests': [{'conditional_values': {'condition': 'fare_amount >= 0'}}]}, {'name': 'extra', 'description': 'Miscellaneous extras and surcharges. Currently, this only includes. the $0.50 and $1 rush hour and overnight charges', 'tests': ['not_null']}, {'name': 'mta_tax', 'description': '0.50 MTA tax that is automatically triggered based on the metered rate in use', 'tests': [{'conditional_values': {'condition': 'mta_tax >= 0'}}]}, {'name': 'tip_amount', 'description': 'Tip amount  This field is automatically populated for credit card tips.Cash tips are not included', 'tests': [{'conditional_values': {'condition': 'tip_amount >= 0'}}]}, {'name': 'tolls_amount', 'description': 'Total amount of all tolls paid in trip', 'tests': [{'conditional_values': {'condition': 'tolls_amount >= 0'}}]}, {'name': 'improvement_surcharge', 'description': '0.30 improvement surcharge assessed trips at the flag drop. the improvement surcharge began being levied in 2015', 'tests': ['not_null']}, {'name': 'total_amount', 'description': 'The total amount charged to passengers. Does not include cash tips.', 'tests': [{'conditional_values': {'condition': 'total_amount >= 0'}}]}, {'name': 'payment_type', 'description': 'A numeric code signifying how the passenger paid for the trip', 'tests': ['not_null']}, {'name': 'trip_type', 'description': 'Year of pickup', 'tests': [None]}, {'name': 'congestion_surcharge', 'description': 'An additional charge for trips taken during high traffic congestion times', 'tests': [None]}], 'original_file_path': 'models/tests/schema.yml', 'yaml_key': 'models', 'package_name': 'nyc_taxi'} - at path ['columns'][17]['tests'][0]: None is not valid under any of the given schemas
[2024-11-21T18:55:34.722+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T18:55:34.746+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 29.318 seconds
[2024-11-21T18:56:05.199+0000] {processor.py:161} INFO - Started process (PID=8755) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T18:56:05.201+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T18:56:05.205+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:56:05.204+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T18:56:05.305+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:56:05.304+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T18:56:09.285+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:56:09.285+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 3.952701161000732
[2024-11-21T18:56:09.286+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:56:09.286+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T18:56:09.287+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:56:09.287+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T18:56:09.305+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:56:09.305+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T18:56:09.322+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:56:09.322+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T18:56:09.346+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:56:09.346+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpe2e1qrmc --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T18:56:19.374+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:56:19.373+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpe2e1qrmc --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T18:56:32.703+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:56:32.692+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 213, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpe2e1qrmc', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
18:56:25  Running with dbt=1.8.7
18:56:29  Registered adapter: bigquery=1.8.3
18:56:30  [WARNING]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
18:56:30  Encountered an error:
Parsing Error
  Invalid models config given in models/tests/schema.yml @ models: {'name': 'fct_trips', 'description': 'Fact Table of tripdata', 'columns': [{'name': 'trip_id', 'description': 'The primary key for this table', 'tests': ['unique']}, {'name': 'vendor_id', 'description': 'A code indicating the TPEP provider that provided the record', 'tests': ['not_null']}, {'name': 'pickup_time_id', 'description': 'id to get pickup time from dim_time', 'tests': ['not_null']}, {'name': 'dropoff_time_id', 'description': 'id to get dropoff time from dim_time', 'tests': ['not_null']}, {'name': 'rate_code_id', 'description': 'The final rate code in effect at the end of the trip', 'tests': ['not_null']}, {'name': 'pu_location_id', 'description': 'The pickup location', 'tests': ['not_null']}, {'name': 'do_location_id', 'description': 'The droppof location', 'tests': ['not_null']}, {'name': 'passenger_count', 'description': 'Customer count', 'tests': ['not_null']}, {'name': 'trip_distance', 'description': 'trip distance', 'tests': ['not_null']}, {'name': 'fare_amount', 'description': 'The time-and-distance fare calculated by the meter.', 'tests': [{'conditional_values': {'condition': 'fare_amount >= 0'}}]}, {'name': 'extra', 'description': 'Miscellaneous extras and surcharges. Currently, this only includes. the $0.50 and $1 rush hour and overnight charges', 'tests': ['not_null']}, {'name': 'mta_tax', 'description': '0.50 MTA tax that is automatically triggered based on the metered rate in use', 'tests': [{'conditional_values': {'condition': 'mta_tax >= 0'}}]}, {'name': 'tip_amount', 'description': 'Tip amount  This field is automatically populated for credit card tips.Cash tips are not included', 'tests': [{'conditional_values': {'condition': 'tip_amount >= 0'}}]}, {'name': 'tolls_amount', 'description': 'Total amount of all tolls paid in trip', 'tests': [{'conditional_values': {'condition': 'tolls_amount >= 0'}}]}, {'name': 'improvement_surcharge', 'description': '0.30 improvement surcharge assessed trips at the flag drop. the improvement surcharge began being levied in 2015', 'tests': ['not_null']}, {'name': 'total_amount', 'description': 'The total amount charged to passengers. Does not include cash tips.', 'tests': [{'conditional_values': {'condition': 'total_amount >= 0'}}]}, {'name': 'payment_type', 'description': 'A numeric code signifying how the passenger paid for the trip', 'tests': ['not_null']}, {'name': 'trip_type', 'description': 'Year of pickup', 'tests': [None]}, {'name': 'congestion_surcharge', 'description': 'An additional charge for trips taken during high traffic congestion times', 'tests': [None]}], 'original_file_path': 'models/tests/schema.yml', 'yaml_key': 'models', 'package_name': 'nyc_taxi'} - at path ['columns'][17]['tests'][0]: None is not valid under any of the given schemas
[2024-11-21T18:56:32.705+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T18:56:32.727+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 28.926 seconds
[2024-11-21T18:57:02.995+0000] {processor.py:161} INFO - Started process (PID=8807) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T18:57:02.997+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T18:57:03.000+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:57:03.000+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T18:57:03.100+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:57:03.099+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T18:57:06.906+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:57:06.905+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 3.7784798390002834
[2024-11-21T18:57:06.907+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:57:06.907+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T18:57:06.909+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:57:06.908+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T18:57:06.923+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:57:06.923+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T18:57:06.939+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:57:06.938+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T18:57:06.963+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:57:06.962+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpwjz05ttt --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T18:57:17.013+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:57:17.012+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpwjz05ttt --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T18:57:31.693+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:57:31.691+0000] {timeout.py:68} ERROR - Process timed out, PID: 8807
[2024-11-21T18:57:31.706+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:57:31.694+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpwjz05ttt', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
18:57:23  Running with dbt=1.8.7
18:57:25  Registered adapter: bigquery=1.8.3
18:57:28  [WARNING]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
18:57:28  Encountered an error:
Parsing Error
  Invalid models config given in models/tests/schema.yml @ models: {'name': 'fct_trips', 'description': 'Fact Table of tripdata', 'columns': [{'name': 'trip_id', 'description': 'The primary key for this table', 'tests': ['unique']}, {'name': 'vendor_id', 'description': 'A code indicating the TPEP provider that provided the record', 'tests': ['not_null']}, {'name': 'pickup_time_id', 'description': 'id to get pickup time from dim_time', 'tests': ['not_null']}, {'name': 'dropoff_time_id', 'description': 'id to get dropoff time from dim_time', 'tests': ['not_null']}, {'name': 'rate_code_id', 'description': 'The final rate code in effect at the end of the trip', 'tests': ['not_null']}, {'name': 'pu_location_id', 'description': 'The pickup location', 'tests': ['not_null']}, {'name': 'do_location_id', 'description': 'The droppof location', 'tests': ['not_null']}, {'name': 'passenger_count', 'description': 'Customer count', 'tests': ['not_null']}, {'name': 'trip_distance', 'description': 'trip distance', 'tests': ['not_null']}, {'name': 'fare_amount', 'description': 'The time-and-distance fare calculated by the meter.', 'tests': [{'conditional_values': {'condition': 'fare_amount >= 0'}}]}, {'name': 'extra', 'description': 'Miscellaneous extras and surcharges. Currently, this only includes. the $0.50 and $1 rush hour and overnight charges', 'tests': ['not_null']}, {'name': 'mta_tax', 'description': '0.50 MTA tax that is automatically triggered based on the metered rate in use', 'tests': [{'conditional_values': {'condition': 'mta_tax >= 0'}}]}, {'name': 'tip_amount', 'description': 'Tip amount  This field is automatically populated for credit card tips.Cash tips are not included', 'tests': [{'conditional_values': {'condition': 'tip_amount >= 0'}}]}, {'name': 'tolls_amount', 'description': 'Total amount of all tolls paid in trip', 'tests': [{'conditional_values': {'condition': 'tolls_amount >= 0'}}]}, {'name': 'improvement_surcharge', 'description': '0.30 improvement surcharge assessed trips at the flag drop. the improvement surcharge began being levied in 2015', 'tests': ['not_null']}, {'name': 'total_amount', 'description': 'The total amount charged to passengers. Does not include cash tips.', 'tests': [{'conditional_values': {'condition': 'total_amount >= 0'}}]}, {'name': 'payment_type', 'description': 'A numeric code signifying how the passenger paid for the trip', 'tests': ['not_null']}, {'name': 'trip_type', 'description': 'Year of pickup', 'tests': [None]}, {'name': 'congestion_surcharge', 'description': 'An additional charge for trips taken during high traffic congestion times', 'tests': [None]}], 'original_file_path': 'models/tests/schema.yml', 'yaml_key': 'models', 'package_name': 'nyc_taxi'} - at path ['columns'][17]['tests'][0]: None is not valid under any of the given schemas


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.9/shutil.py", line 669, in _rmtree_safe_fd
    os.close(dirfd)
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: DagBag import timeout for /opt/airflow/dags/data_ingestion.py after 30.0s.
Please take a look at these docs to improve your DAG import time:
* https://airflow.apache.org/docs/apache-airflow/2.9.3/best-practices.html#top-level-python-code
* https://airflow.apache.org/docs/apache-airflow/2.9.3/best-practices.html#reducing-dag-complexity, PID: 8807

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 213, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 587, in load_via_dbt_ls_without_cache
    cache._update_partial_parse_cache(partial_parse_file, self.cache_dir)
  File "/usr/local/lib/python3.9/tempfile.py", line 839, in __exit__
    self.cleanup()
  File "/usr/local/lib/python3.9/tempfile.py", line 843, in cleanup
    self._rmtree(self.name)
  File "/usr/local/lib/python3.9/tempfile.py", line 825, in _rmtree
    _shutil.rmtree(name, onerror=onerror)
  File "/usr/local/lib/python3.9/shutil.py", line 734, in rmtree
    _rmtree_safe_fd(fd, path, onerror)
  File "/usr/local/lib/python3.9/shutil.py", line 667, in _rmtree_safe_fd
    _rmtree_safe_fd(dirfd, fullname, onerror)
  File "/usr/local/lib/python3.9/shutil.py", line 667, in _rmtree_safe_fd
    _rmtree_safe_fd(dirfd, fullname, onerror)
  File "/usr/local/lib/python3.9/shutil.py", line 667, in _rmtree_safe_fd
    _rmtree_safe_fd(dirfd, fullname, onerror)
  File "/usr/local/lib/python3.9/shutil.py", line 685, in _rmtree_safe_fd
    os.close(dirfd)
OSError: [Errno 9] Bad file descriptor
[2024-11-21T18:57:31.709+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T18:57:31.734+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 30.089 seconds
[2024-11-21T18:58:02.595+0000] {processor.py:161} INFO - Started process (PID=8859) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T18:58:02.597+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T18:58:02.602+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:58:02.601+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T18:58:02.686+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:58:02.686+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T18:58:06.362+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:58:06.361+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 3.646115255998666
[2024-11-21T18:58:06.363+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:58:06.363+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T18:58:06.364+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:58:06.364+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T18:58:06.381+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:58:06.381+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T18:58:06.397+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:58:06.397+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T18:58:06.420+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:58:06.420+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp4x8zmlgp --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T18:58:16.369+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:58:16.368+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmp4x8zmlgp --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T18:58:30.372+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:58:30.359+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 213, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmp4x8zmlgp', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
18:58:22  Running with dbt=1.8.7
18:58:24  Registered adapter: bigquery=1.8.3
18:58:27  [WARNING]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
18:58:27  Encountered an error:
Parsing Error
  Invalid models config given in models/tests/schema.yml @ models: {'name': 'fct_trips', 'description': 'Fact Table of tripdata', 'columns': [{'name': 'trip_id', 'description': 'The primary key for this table', 'tests': ['unique']}, {'name': 'vendor_id', 'description': 'A code indicating the TPEP provider that provided the record', 'tests': ['not_null']}, {'name': 'pickup_time_id', 'description': 'id to get pickup time from dim_time', 'tests': ['not_null']}, {'name': 'dropoff_time_id', 'description': 'id to get dropoff time from dim_time', 'tests': ['not_null']}, {'name': 'rate_code_id', 'description': 'The final rate code in effect at the end of the trip', 'tests': ['not_null']}, {'name': 'pu_location_id', 'description': 'The pickup location', 'tests': ['not_null']}, {'name': 'do_location_id', 'description': 'The droppof location', 'tests': ['not_null']}, {'name': 'passenger_count', 'description': 'Customer count', 'tests': ['not_null']}, {'name': 'trip_distance', 'description': 'trip distance', 'tests': ['not_null']}, {'name': 'fare_amount', 'description': 'The time-and-distance fare calculated by the meter.', 'tests': [{'conditional_values': {'condition': 'fare_amount >= 0'}}]}, {'name': 'extra', 'description': 'Miscellaneous extras and surcharges. Currently, this only includes. the $0.50 and $1 rush hour and overnight charges', 'tests': ['not_null']}, {'name': 'mta_tax', 'description': '0.50 MTA tax that is automatically triggered based on the metered rate in use', 'tests': [{'conditional_values': {'condition': 'mta_tax >= 0'}}]}, {'name': 'tip_amount', 'description': 'Tip amount  This field is automatically populated for credit card tips.Cash tips are not included', 'tests': [{'conditional_values': {'condition': 'tip_amount >= 0'}}]}, {'name': 'tolls_amount', 'description': 'Total amount of all tolls paid in trip', 'tests': [{'conditional_values': {'condition': 'tolls_amount >= 0'}}]}, {'name': 'improvement_surcharge', 'description': '0.30 improvement surcharge assessed trips at the flag drop. the improvement surcharge began being levied in 2015', 'tests': ['not_null']}, {'name': 'total_amount', 'description': 'The total amount charged to passengers. Does not include cash tips.', 'tests': [{'conditional_values': {'condition': 'total_amount >= 0'}}]}, {'name': 'payment_type', 'description': 'A numeric code signifying how the passenger paid for the trip', 'tests': ['not_null']}, {'name': 'trip_type', 'description': 'Year of pickup', 'tests': [None]}, {'name': 'congestion_surcharge', 'description': 'An additional charge for trips taken during high traffic congestion times', 'tests': [None]}], 'original_file_path': 'models/tests/schema.yml', 'yaml_key': 'models', 'package_name': 'nyc_taxi'} - at path ['columns'][17]['tests'][0]: None is not valid under any of the given schemas
[2024-11-21T18:58:30.374+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T18:58:30.400+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 29.177 seconds
[2024-11-21T18:59:01.306+0000] {processor.py:161} INFO - Started process (PID=8911) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T18:59:01.308+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T18:59:01.313+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:59:01.312+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T18:59:01.398+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:59:01.398+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T18:59:05.491+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:59:05.491+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 4.065491906998432
[2024-11-21T18:59:05.493+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:59:05.492+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T18:59:05.494+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:59:05.494+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T18:59:05.511+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:59:05.511+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T18:59:05.536+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:59:05.535+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T18:59:05.558+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:59:05.558+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmphxnaluk9 --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T18:59:16.330+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:59:16.330+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmphxnaluk9 --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T18:59:29.712+0000] {logging_mixin.py:188} INFO - [2024-11-21T18:59:29.701+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 213, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmphxnaluk9', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
18:59:21  Running with dbt=1.8.7
18:59:24  Registered adapter: bigquery=1.8.3
18:59:27  [WARNING]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
18:59:27  Encountered an error:
Parsing Error
  Invalid models config given in models/tests/schema.yml @ models: {'name': 'fct_trips', 'description': 'Fact Table of tripdata', 'columns': [{'name': 'trip_id', 'description': 'The primary key for this table', 'tests': ['unique']}, {'name': 'vendor_id', 'description': 'A code indicating the TPEP provider that provided the record', 'tests': ['not_null']}, {'name': 'pickup_time_id', 'description': 'id to get pickup time from dim_time', 'tests': ['not_null']}, {'name': 'dropoff_time_id', 'description': 'id to get dropoff time from dim_time', 'tests': ['not_null']}, {'name': 'rate_code_id', 'description': 'The final rate code in effect at the end of the trip', 'tests': ['not_null']}, {'name': 'pu_location_id', 'description': 'The pickup location', 'tests': ['not_null']}, {'name': 'do_location_id', 'description': 'The droppof location', 'tests': ['not_null']}, {'name': 'passenger_count', 'description': 'Customer count', 'tests': ['not_null']}, {'name': 'trip_distance', 'description': 'trip distance', 'tests': ['not_null']}, {'name': 'fare_amount', 'description': 'The time-and-distance fare calculated by the meter.', 'tests': [{'conditional_values': {'condition': 'fare_amount >= 0'}}]}, {'name': 'extra', 'description': 'Miscellaneous extras and surcharges. Currently, this only includes. the $0.50 and $1 rush hour and overnight charges', 'tests': ['not_null']}, {'name': 'mta_tax', 'description': '0.50 MTA tax that is automatically triggered based on the metered rate in use', 'tests': [{'conditional_values': {'condition': 'mta_tax >= 0'}}]}, {'name': 'tip_amount', 'description': 'Tip amount  This field is automatically populated for credit card tips.Cash tips are not included', 'tests': [{'conditional_values': {'condition': 'tip_amount >= 0'}}]}, {'name': 'tolls_amount', 'description': 'Total amount of all tolls paid in trip', 'tests': [{'conditional_values': {'condition': 'tolls_amount >= 0'}}]}, {'name': 'improvement_surcharge', 'description': '0.30 improvement surcharge assessed trips at the flag drop. the improvement surcharge began being levied in 2015', 'tests': ['not_null']}, {'name': 'total_amount', 'description': 'The total amount charged to passengers. Does not include cash tips.', 'tests': [{'conditional_values': {'condition': 'total_amount >= 0'}}]}, {'name': 'payment_type', 'description': 'A numeric code signifying how the passenger paid for the trip', 'tests': ['not_null']}, {'name': 'trip_type', 'description': 'Year of pickup', 'tests': [None]}, {'name': 'congestion_surcharge', 'description': 'An additional charge for trips taken during high traffic congestion times', 'tests': [None]}], 'original_file_path': 'models/tests/schema.yml', 'yaml_key': 'models', 'package_name': 'nyc_taxi'} - at path ['columns'][17]['tests'][0]: None is not valid under any of the given schemas
[2024-11-21T18:59:29.714+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T18:59:29.744+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 29.878 seconds
[2024-11-21T19:00:00.054+0000] {processor.py:161} INFO - Started process (PID=8969) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T19:00:00.056+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T19:00:00.060+0000] {logging_mixin.py:188} INFO - [2024-11-21T19:00:00.059+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T19:00:00.162+0000] {logging_mixin.py:188} INFO - [2024-11-21T19:00:00.162+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T19:00:04.256+0000] {logging_mixin.py:188} INFO - [2024-11-21T19:00:04.255+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 4.065935308999542
[2024-11-21T19:00:04.258+0000] {logging_mixin.py:188} INFO - [2024-11-21T19:00:04.257+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T19:00:04.259+0000] {logging_mixin.py:188} INFO - [2024-11-21T19:00:04.259+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T19:00:04.276+0000] {logging_mixin.py:188} INFO - [2024-11-21T19:00:04.275+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T19:00:04.299+0000] {logging_mixin.py:188} INFO - [2024-11-21T19:00:04.298+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T19:00:04.321+0000] {logging_mixin.py:188} INFO - [2024-11-21T19:00:04.320+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpiqkgxr0d --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T19:00:14.051+0000] {logging_mixin.py:188} INFO - [2024-11-21T19:00:14.050+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpiqkgxr0d --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T19:00:27.591+0000] {logging_mixin.py:188} INFO - [2024-11-21T19:00:27.578+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 213, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpiqkgxr0d', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
19:00:19  Running with dbt=1.8.7
19:00:22  Registered adapter: bigquery=1.8.3
19:00:24  [WARNING]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
19:00:24  Encountered an error:
Parsing Error
  Invalid models config given in models/tests/schema.yml @ models: {'name': 'fct_trips', 'description': 'Fact Table of tripdata', 'columns': [{'name': 'trip_id', 'description': 'The primary key for this table', 'tests': ['unique']}, {'name': 'vendor_id', 'description': 'A code indicating the TPEP provider that provided the record', 'tests': ['not_null']}, {'name': 'pickup_time_id', 'description': 'id to get pickup time from dim_time', 'tests': ['not_null']}, {'name': 'dropoff_time_id', 'description': 'id to get dropoff time from dim_time', 'tests': ['not_null']}, {'name': 'rate_code_id', 'description': 'The final rate code in effect at the end of the trip', 'tests': ['not_null']}, {'name': 'pu_location_id', 'description': 'The pickup location', 'tests': ['not_null']}, {'name': 'do_location_id', 'description': 'The droppof location', 'tests': ['not_null']}, {'name': 'passenger_count', 'description': 'Customer count', 'tests': ['not_null']}, {'name': 'trip_distance', 'description': 'trip distance', 'tests': ['not_null']}, {'name': 'fare_amount', 'description': 'The time-and-distance fare calculated by the meter.', 'tests': [{'conditional_values': {'condition': 'fare_amount >= 0'}}]}, {'name': 'extra', 'description': 'Miscellaneous extras and surcharges. Currently, this only includes. the $0.50 and $1 rush hour and overnight charges', 'tests': ['not_null']}, {'name': 'mta_tax', 'description': '0.50 MTA tax that is automatically triggered based on the metered rate in use', 'tests': [{'conditional_values': {'condition': 'mta_tax >= 0'}}]}, {'name': 'tip_amount', 'description': 'Tip amount  This field is automatically populated for credit card tips.Cash tips are not included', 'tests': [{'conditional_values': {'condition': 'tip_amount >= 0'}}]}, {'name': 'tolls_amount', 'description': 'Total amount of all tolls paid in trip', 'tests': [{'conditional_values': {'condition': 'tolls_amount >= 0'}}]}, {'name': 'improvement_surcharge', 'description': '0.30 improvement surcharge assessed trips at the flag drop. the improvement surcharge began being levied in 2015', 'tests': ['not_null']}, {'name': 'total_amount', 'description': 'The total amount charged to passengers. Does not include cash tips.', 'tests': [{'conditional_values': {'condition': 'total_amount >= 0'}}]}, {'name': 'payment_type', 'description': 'A numeric code signifying how the passenger paid for the trip', 'tests': ['not_null']}, {'name': 'trip_type', 'description': 'Year of pickup', 'tests': [None]}, {'name': 'congestion_surcharge', 'description': 'An additional charge for trips taken during high traffic congestion times', 'tests': [None]}], 'original_file_path': 'models/tests/schema.yml', 'yaml_key': 'models', 'package_name': 'nyc_taxi'} - at path ['columns'][17]['tests'][0]: None is not valid under any of the given schemas
[2024-11-21T19:00:27.592+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T19:00:27.614+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 28.939 seconds
[2024-11-21T19:00:57.873+0000] {processor.py:161} INFO - Started process (PID=9022) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T19:00:57.875+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T19:00:57.879+0000] {logging_mixin.py:188} INFO - [2024-11-21T19:00:57.879+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T19:00:57.985+0000] {logging_mixin.py:188} INFO - [2024-11-21T19:00:57.985+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T19:01:02.229+0000] {logging_mixin.py:188} INFO - [2024-11-21T19:01:02.229+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 4.2153931009997905
[2024-11-21T19:01:02.231+0000] {logging_mixin.py:188} INFO - [2024-11-21T19:01:02.230+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T19:01:02.232+0000] {logging_mixin.py:188} INFO - [2024-11-21T19:01:02.232+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T19:01:02.250+0000] {logging_mixin.py:188} INFO - [2024-11-21T19:01:02.250+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T19:01:02.264+0000] {logging_mixin.py:188} INFO - [2024-11-21T19:01:02.264+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T19:01:02.289+0000] {logging_mixin.py:188} INFO - [2024-11-21T19:01:02.288+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmpeoxl__nv --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
[2024-11-21T19:01:11.592+0000] {logging_mixin.py:188} INFO - [2024-11-21T19:01:11.591+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt ls --output json --project-dir /tmp/tmpeoxl__nv --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev --select path:models/transform`
[2024-11-21T19:01:24.939+0000] {logging_mixin.py:188} INFO - [2024-11-21T19:01:24.928+0000] {dagbag.py:355} ERROR - Failed to import: /opt/airflow/dags/data_ingestion.py
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.9/site-packages/airflow/models/dagbag.py", line 351, in parse
    loader.exec_module(new_module)
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/opt/airflow/dags/data_ingestion.py", line 213, in <module>
    transform_dbt_task = DbtTaskGroup(
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/airflow/task_group.py", line 28, in __init__
    DbtToAirflowConverter.__init__(self, *args, **specific_kwargs(**kwargs))
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/converter.py", line 260, in __init__
    self.dbt_graph.load(method=render_config.load_method, execution_mode=execution_config.execution_mode)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 408, in load
    load_method[method]()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 461, in load_via_dbt_ls
    self.load_via_dbt_ls_without_cache()
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 580, in load_via_dbt_ls_without_cache
    nodes = self.run_dbt_ls(dbt_cmd, self.project_path, tmpdir_path, env)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 442, in run_dbt_ls
    stdout = run_command(ls_command, tmp_dir, env_vars)
  File "/home/airflow/.local/lib/python3.9/site-packages/cosmos/dbt/graph.py", line 156, in run_command
    raise CosmosLoadDbtException(f"Unable to run {command} due to the error:\n{details}")
cosmos.dbt.graph.CosmosLoadDbtException: Unable to run ['/home/airflow/.local/bin/dbt', 'ls', '--output', 'json', '--project-dir', '/tmp/tmpeoxl__nv', '--profiles-dir', '/opt/airflow/include/dbt', '--profile', 'nyc_taxi', '--target', 'dev', '--select', 'path:models/transform'] due to the error:
19:01:16  Running with dbt=1.8.7
19:01:19  Registered adapter: bigquery=1.8.3
19:01:22  [WARNING]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
19:01:22  Encountered an error:
Parsing Error
  Invalid models config given in models/tests/schema.yml @ models: {'name': 'fct_trips', 'description': 'Fact Table of tripdata', 'columns': [{'name': 'trip_id', 'description': 'The primary key for this table', 'tests': ['unique']}, {'name': 'vendor_id', 'description': 'A code indicating the TPEP provider that provided the record', 'tests': ['not_null']}, {'name': 'pickup_time_id', 'description': 'id to get pickup time from dim_time', 'tests': ['not_null']}, {'name': 'dropoff_time_id', 'description': 'id to get dropoff time from dim_time', 'tests': ['not_null']}, {'name': 'rate_code_id', 'description': 'The final rate code in effect at the end of the trip', 'tests': ['not_null']}, {'name': 'pu_location_id', 'description': 'The pickup location', 'tests': ['not_null']}, {'name': 'do_location_id', 'description': 'The droppof location', 'tests': ['not_null']}, {'name': 'passenger_count', 'description': 'Customer count', 'tests': ['not_null']}, {'name': 'trip_distance', 'description': 'trip distance', 'tests': ['not_null']}, {'name': 'fare_amount', 'description': 'The time-and-distance fare calculated by the meter.', 'tests': [{'conditional_values': {'condition': 'fare_amount >= 0'}}]}, {'name': 'extra', 'description': 'Miscellaneous extras and surcharges. Currently, this only includes. the $0.50 and $1 rush hour and overnight charges', 'tests': ['not_null']}, {'name': 'mta_tax', 'description': '0.50 MTA tax that is automatically triggered based on the metered rate in use', 'tests': [{'conditional_values': {'condition': 'mta_tax >= 0'}}]}, {'name': 'tip_amount', 'description': 'Tip amount  This field is automatically populated for credit card tips.Cash tips are not included', 'tests': [{'conditional_values': {'condition': 'tip_amount >= 0'}}]}, {'name': 'tolls_amount', 'description': 'Total amount of all tolls paid in trip', 'tests': [{'conditional_values': {'condition': 'tolls_amount >= 0'}}]}, {'name': 'improvement_surcharge', 'description': '0.30 improvement surcharge assessed trips at the flag drop. the improvement surcharge began being levied in 2015', 'tests': ['not_null']}, {'name': 'total_amount', 'description': 'The total amount charged to passengers. Does not include cash tips.', 'tests': [{'conditional_values': {'condition': 'total_amount >= 0'}}]}, {'name': 'payment_type', 'description': 'A numeric code signifying how the passenger paid for the trip', 'tests': ['not_null']}, {'name': 'trip_type', 'description': 'Year of pickup', 'tests': [None]}, {'name': 'congestion_surcharge', 'description': 'An additional charge for trips taken during high traffic congestion times', 'tests': [None]}], 'original_file_path': 'models/tests/schema.yml', 'yaml_key': 'models', 'package_name': 'nyc_taxi'} - at path ['columns'][17]['tests'][0]: None is not valid under any of the given schemas
[2024-11-21T19:01:24.941+0000] {processor.py:842} WARNING - No viable dags retrieved from /opt/airflow/dags/data_ingestion.py
[2024-11-21T19:01:24.972+0000] {processor.py:183} INFO - Processing /opt/airflow/dags/data_ingestion.py took 28.479 seconds
[2024-11-21T19:01:55.416+0000] {processor.py:161} INFO - Started process (PID=9074) to work on /opt/airflow/dags/data_ingestion.py
[2024-11-21T19:01:55.418+0000] {processor.py:830} INFO - Processing file /opt/airflow/dags/data_ingestion.py for tasks to queue
[2024-11-21T19:01:55.422+0000] {logging_mixin.py:188} INFO - [2024-11-21T19:01:55.422+0000] {dagbag.py:545} INFO - Filling up the DagBag from /opt/airflow/dags/data_ingestion.py
[2024-11-21T19:01:55.527+0000] {logging_mixin.py:188} INFO - [2024-11-21T19:01:55.527+0000] {graph.py:470} INFO - Trying to parse the dbt project using dbt ls cache cosmos_cache__nyc_green_taxi__transform...
[2024-11-21T19:01:59.073+0000] {logging_mixin.py:188} INFO - [2024-11-21T19:01:59.072+0000] {cache.py:320} INFO - Cosmos performance: time to calculate cache identifier cosmos_cache__nyc_green_taxi__transform for current version: 3.5153526939993753
[2024-11-21T19:01:59.074+0000] {logging_mixin.py:188} INFO - [2024-11-21T19:01:59.074+0000] {graph.py:497} INFO - Cosmos performance: Cache miss for cosmos_cache__nyc_green_taxi__transform - skipped
[2024-11-21T19:01:59.076+0000] {logging_mixin.py:188} INFO - [2024-11-21T19:01:59.075+0000] {graph.py:528} INFO - Trying to parse the dbt project in `/opt/airflow/include/dbt` using dbt ls...
[2024-11-21T19:01:59.095+0000] {logging_mixin.py:188} INFO - [2024-11-21T19:01:59.094+0000] {graph.py:547} INFO - Partial parse is enabled and the latest partial parse file is /tmp/cosmos/nyc_green_taxi__transform/target/partial_parse.msgpack
[2024-11-21T19:01:59.110+0000] {logging_mixin.py:188} INFO - [2024-11-21T19:01:59.110+0000] {config.py:332} INFO - Using user-supplied profiles.yml at /opt/airflow/include/dbt/profiles.yml
[2024-11-21T19:01:59.134+0000] {logging_mixin.py:188} INFO - [2024-11-21T19:01:59.134+0000] {graph.py:136} INFO - Running command: `/home/airflow/.local/bin/dbt deps --project-dir /tmp/tmp47fb3_o_ --profiles-dir /opt/airflow/include/dbt --profile nyc_taxi --target dev`
