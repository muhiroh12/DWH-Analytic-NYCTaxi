{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.8.9", "generated_at": "2024-12-16T22:49:45.163142Z", "invocation_id": "2aa2d857-48e0-4981-8058-fe1102dcbb77", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-16T22:49:30.844666Z", "completed_at": "2024-12-16T22:49:30.865336Z"}, {"name": "execute", "started_at": "2024-12-16T22:49:30.866887Z", "completed_at": "2024-12-16T22:49:45.143586Z"}], "thread_id": "Thread-1", "execution_time": 14.302021980285645, "adapter_response": {"_message": "CREATE TABLE (664.8k rows, 138.8 MiB processed)", "code": "CREATE TABLE", "rows_affected": 664806, "bytes_processed": 145535214, "bytes_billed": 145752064, "location": "us-central1", "project_id": "northern-shield-437204-m0", "job_id": "1701604f-19e1-4e15-8c93-70b1bcc6a8aa", "slot_ms": 50466}, "message": "CREATE TABLE (664.8k rows, 138.8 MiB processed)", "failures": null, "unique_id": "model.nyc_taxi.analytic_greentripdata", "compiled": true, "compiled_code": "WITH \npickup_times AS (\n    SELECT \n        fct.trip_id,\n        pu_t.date_part AS pickup_datetime,\n        pu_t.date AS pickup_date,\n        pu_t.hour AS pickup_hour,\n        FORMAT_DATE('%b', pu_t.date) AS month_name,\n        UPPER(LEFT(pu_t.weekday, 3)) AS day_of_week\n    FROM \n        `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips` fct\n    JOIN `northern-shield-437204-m0`.`nyc_taxi`.`dim_time` pu_t ON fct.pickup_time_id = pu_t.time_id\n),\ndropoff_times AS (\n    SELECT \n        fct.trip_id,\n        do_t.date_part AS dropoff_datetime,\n        TIMESTAMP_DIFF(do_t.date_part, pu_t.date_part, MINUTE) AS trip_duration_minutes\n    FROM \n        `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips` fct\n    JOIN `northern-shield-437204-m0`.`nyc_taxi`.`dim_time` pu_t ON fct.pickup_time_id = pu_t.time_id\n    JOIN `northern-shield-437204-m0`.`nyc_taxi`.`dim_time` do_t ON fct.dropoff_time_id = do_t.time_id\n),\ntrip_details AS (\n    SELECT \n        fct.trip_id,\n        v.vendor_name,\n        p.payment_name AS payment_type,\n        z_pickup.zone AS pu_zone,\n        z_dropoff.zone AS do_zone,\n        r.rate_code_name,\n        tt.trip_name,\n        fct.passenger_count,\n        CASE \n            WHEN fct.passenger_count > 3 THEN '>3'\n            ELSE CAST(fct.passenger_count AS STRING)\n        END AS passenger_count_group,\n        fct.fare_amount,\n        fct.tip_amount,\n        fct.total_amount,\n        (fct.total_amount - fct.fare_amount - fct.tip_amount) AS other_amount,\n        fct.trip_distance,\n        CASE \n            WHEN fct.trip_distance < 5 THEN '<5 miles'\n            WHEN fct.trip_distance >= 5 AND fct.trip_distance < 10 THEN '5-10 miles'\n            WHEN fct.trip_distance >= 10 AND fct.trip_distance < 20 THEN '11-20 miles'\n            WHEN fct.trip_distance >= 20 AND fct.trip_distance < 30 THEN '21-30 miles'\n            WHEN fct.trip_distance >= 30 AND fct.trip_distance < 40 THEN '31-40 miles'\n            ELSE '>40 miles'\n        END AS trip_distance_group\n    FROM \n        `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips` fct\n    JOIN `northern-shield-437204-m0`.`nyc_taxi`.`dim_vendor` v ON fct.vendor_id = v.id\n    JOIN `northern-shield-437204-m0`.`nyc_taxi`.`dim_payment` p ON fct.payment_type = p.type_id\n    JOIN `northern-shield-437204-m0`.`nyc_taxi`.`dim_zone` z_pickup ON fct.pu_location_id = z_pickup.location_id\n    JOIN `northern-shield-437204-m0`.`nyc_taxi`.`dim_zone` z_dropoff ON fct.do_location_id = z_dropoff.location_id\n    JOIN `northern-shield-437204-m0`.`nyc_taxi`.`dim_ratecode` r ON fct.rate_code_id = r.rate_id\n    JOIN `northern-shield-437204-m0`.`nyc_taxi`.`dim_triptype` tt ON fct.trip_type = tt.type_id\n    WHERE \n        fct.trip_type IS NOT NULL\n        AND fct.rate_code_id IS NOT NULL\n        AND fct.trip_type != 99\n        AND fct.rate_code_id != 99\n)\nSELECT \n\ttd.trip_id,\n    pt.pickup_datetime,\n    pt.pickup_date,\n    pt.pickup_hour,\n    pt.month_name,\n    pt.day_of_week,\n    dt.trip_duration_minutes,\n    td.vendor_name,\n    td.payment_type,\n    td.pu_zone,\n    td.do_zone,\n    td.rate_code_name,\n    td.trip_name,\n    td.passenger_count,\n    td.passenger_count_group,\n    td.fare_amount,\n    td.tip_amount,\n    td.total_amount,\n    td.other_amount,\n    td.trip_distance,\n    td.trip_distance_group\nFROM \n    pickup_times pt\nJOIN dropoff_times dt ON pt.trip_id = dt.trip_id\nJOIN trip_details td ON pt.trip_id = td.trip_id\nORDER BY \n    td.trip_id", "relation_name": "`northern-shield-437204-m0`.`nyc_taxi`.`analytic_greentripdata`"}], "elapsed_time": 15.694083213806152, "args": {"empty": false, "log_level_file": "debug", "send_anonymous_usage_stats": true, "populate_cache": true, "macro_debugging": false, "printer_width": 80, "log_path": "/opt/airflow/include/dbt/logs", "require_resource_names_without_spaces": false, "version_check": true, "quiet": false, "log_format": "default", "indirect_selection": "eager", "vars": {}, "favor_state": false, "log_level": "info", "exclude": [], "require_explicit_package_overrides_for_builtin_materializations": true, "profiles_dir": "/opt/airflow/include/dbt", "introspect": true, "project_dir": "/opt/airflow/include/dbt", "warn_error_options": {"include": [], "exclude": []}, "print": true, "which": "run", "use_colors_file": true, "partial_parse": true, "strict_mode": false, "use_colors": true, "select": ["analytic_greentripdata"], "defer": false, "cache_selected_only": false, "source_freshness_run_project_hooks": false, "log_file_max_bytes": 10485760, "static_parser": true, "enable_legacy_logger": false, "log_format_file": "debug", "partial_parse_file_diff": true, "write_json": true, "invocation_command": "dbt run --select analytic_greentripdata", "show_resource_report": false}}