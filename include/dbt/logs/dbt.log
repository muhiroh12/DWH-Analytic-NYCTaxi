[0m06:17:23.895822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb11e4405b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb11c3655e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb11c365670>]}


============================== 06:17:23.912417 | c1da1aa9-3c38-4729-ac9a-3cfa982e5db7 ==============================
[0m06:17:23.912417 [info ] [MainThread]: Running with dbt=1.8.7
[0m06:17:23.916659 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'target_path': 'None', 'printer_width': '80', 'quiet': 'False', 'use_colors': 'True', 'fail_fast': 'False', 'invocation_command': 'dbt deps', 'version_check': 'True', 'empty': 'None', 'no_print': 'None', 'cache_selected_only': 'False', 'introspect': 'True', 'debug': 'False', 'profiles_dir': '/opt/airflow/include/dbt', 'log_path': '/opt/airflow/include/dbt/logs', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'warn_error': 'None', 'indirect_selection': 'eager', 'static_parser': 'True', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'write_json': 'True', 'log_cache_events': 'False'}
[0m06:17:24.286264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c1da1aa9-3c38-4729-ac9a-3cfa982e5db7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb11c32d3d0>]}
[0m06:17:24.349676 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-pzcsqleo'
[0m06:17:24.353309 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:17:24.682934 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:17:24.687250 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:17:24.842969 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:17:24.898736 [info ] [MainThread]: Updating lock file in file path: /opt/airflow/include/dbt/package-lock.yml
[0m06:17:24.918549 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-zglhvbsj'
[0m06:17:24.933670 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:17:31.336656 [info ] [MainThread]: Installed from version 1.3.0
[0m06:17:31.339591 [info ] [MainThread]: Up to date!
[0m06:17:31.342537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'c1da1aa9-3c38-4729-ac9a-3cfa982e5db7', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb11c3d4ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb11d7ba640>]}
[0m06:17:31.347673 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 7.6718817, "process_user_time": 5.274974, "process_kernel_time": 0.813023, "process_mem_max_rss": "94112", "process_in_blocks": "39984", "process_out_blocks": "176"}
[0m06:17:31.351616 [debug] [MainThread]: Command `dbt deps` succeeded at 06:17:31.351098 after 7.68 seconds
[0m06:17:31.354805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb11e4405b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb11d7ba640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb11c2fec10>]}
[0m06:17:31.358080 [debug] [MainThread]: Flushing usage events
[0m06:18:56.057027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4000085670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ffdf69be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ffdf69b80>]}


============================== 06:18:56.082203 | eef31c8a-149d-4b6d-8668-47a02c1799ef ==============================
[0m06:18:56.082203 [info ] [MainThread]: Running with dbt=1.8.7
[0m06:18:56.088449 [debug] [MainThread]: running dbt with arguments {'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'empty': 'False', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'write_json': 'True', 'profiles_dir': '/opt/airflow/include/dbt/', 'partial_parse': 'True', 'target_path': 'None', 'log_path': '/opt/airflow/include/dbt/logs', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'warn_error': 'None', 'use_experimental_parser': 'False', 'log_format': 'default', 'cache_selected_only': 'False', 'quiet': 'False', 'printer_width': '80', 'introspect': 'True', 'no_print': 'None', 'version_check': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/include/dbt/'}
[0m06:19:00.585835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'eef31c8a-149d-4b6d-8668-47a02c1799ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ffe35b280>]}
[0m06:19:00.760950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'eef31c8a-149d-4b6d-8668-47a02c1799ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3fc786bd90>]}
[0m06:19:00.764187 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m06:19:01.318147 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m06:19:01.337702 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:19:01.343069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'eef31c8a-149d-4b6d-8668-47a02c1799ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3fc790a9d0>]}
[0m06:19:07.399159 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.nyc_green_taxi.dim_time' (models/transform/dim_time.sql) depends on a source named 'nyc_taxi.green_tripdata' which was not found
[0m06:19:07.403952 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 12.853502, "process_user_time": 13.86914, "process_kernel_time": 1.139664, "process_mem_max_rss": "225168", "process_in_blocks": "173192", "command_success": false, "process_out_blocks": "0"}
[0m06:19:07.407795 [debug] [MainThread]: Command `dbt run` failed at 06:19:07.407351 after 12.86 seconds
[0m06:19:07.410905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4000085670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3fff475610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ffec48100>]}
[0m06:19:07.414269 [debug] [MainThread]: Flushing usage events
[0m06:38:50.539768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa90e68c640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa90c5705b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa90c570610>]}


============================== 06:38:50.560490 | 2a7c8bfa-abf6-40c2-9c36-2fc507b0bfd5 ==============================
[0m06:38:50.560490 [info ] [MainThread]: Running with dbt=1.8.7
[0m06:38:50.566018 [debug] [MainThread]: running dbt with arguments {'debug': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'profiles_dir': '/opt/airflow/include/dbt/', 'use_colors': 'True', 'use_experimental_parser': 'False', 'cache_selected_only': 'False', 'log_path': '/opt/airflow/include/dbt/logs', 'target_path': 'None', 'write_json': 'True', 'printer_width': '80', 'empty': 'None', 'no_print': 'None', 'indirect_selection': 'eager', 'warn_error': 'None', 'quiet': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'introspect': 'True', 'partial_parse': 'True', 'invocation_command': 'dbt debug --profiles-dir /opt/airflow/include/dbt/', 'log_format': 'default', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'static_parser': 'True'}
[0m06:38:50.619115 [info ] [MainThread]: dbt version: 1.8.7
[0m06:38:50.622052 [info ] [MainThread]: python version: 3.9.19
[0m06:38:50.624737 [info ] [MainThread]: python path: /opt/airflow/dbt_venv/bin/python
[0m06:38:50.627404 [info ] [MainThread]: os info: Linux-5.15.167.4-microsoft-standard-WSL2-x86_64-with-glibc2.36
[0m06:38:53.413739 [info ] [MainThread]: Using profiles dir at /opt/airflow/include/dbt/
[0m06:38:53.416987 [info ] [MainThread]: Using profiles.yml file at /opt/airflow/include/dbt/profiles.yml
[0m06:38:53.419994 [info ] [MainThread]: Using dbt_project.yml file at /opt/airflow/include/dbt/dbt_project.yml
[0m06:38:53.422878 [info ] [MainThread]: adapter type: bigquery
[0m06:38:53.426472 [info ] [MainThread]: adapter version: 1.8.3
[0m06:38:53.756143 [info ] [MainThread]: Configuration:
[0m06:38:53.759245 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m06:38:53.762152 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m06:38:53.765721 [info ] [MainThread]: Required dependencies:
[0m06:38:53.769306 [debug] [MainThread]: Executing "git --help"
[0m06:38:53.791983 [info ] [MainThread]:  - git [[31mERROR[0m]

[0m06:38:53.796096 [info ] [MainThread]: Connection:
[0m06:38:53.799209 [info ] [MainThread]:   method: service-account
[0m06:38:53.802004 [info ] [MainThread]:   database: northern-shield-437204-m0
[0m06:38:53.805153 [info ] [MainThread]:   execution_project: northern-shield-437204-m0
[0m06:38:53.807822 [info ] [MainThread]:   schema: nyc_taxi
[0m06:38:53.810946 [info ] [MainThread]:   location: us-central1
[0m06:38:53.814352 [info ] [MainThread]:   priority: None
[0m06:38:53.817450 [info ] [MainThread]:   maximum_bytes_billed: None
[0m06:38:53.820342 [info ] [MainThread]:   impersonate_service_account: None
[0m06:38:53.823525 [info ] [MainThread]:   job_retry_deadline_seconds: None
[0m06:38:53.826663 [info ] [MainThread]:   job_retries: 1
[0m06:38:53.829939 [info ] [MainThread]:   job_creation_timeout_seconds: None
[0m06:38:53.833669 [info ] [MainThread]:   job_execution_timeout_seconds: 300
[0m06:38:53.836719 [info ] [MainThread]:   timeout_seconds: 300
[0m06:38:53.839785 [info ] [MainThread]:   client_id: None
[0m06:38:53.843409 [info ] [MainThread]:   token_uri: None
[0m06:38:53.846600 [info ] [MainThread]:   dataproc_region: None
[0m06:38:53.849533 [info ] [MainThread]:   dataproc_cluster_name: None
[0m06:38:53.852261 [info ] [MainThread]:   gcs_bucket: None
[0m06:38:53.855332 [info ] [MainThread]:   dataproc_batch: None
[0m06:38:53.859710 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m06:38:54.276116 [debug] [MainThread]: Acquiring new bigquery connection 'debug'
[0m06:38:54.280278 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:38:54.310066 [debug] [MainThread]: On debug: select 1 as id
[0m06:38:55.599157 [debug] [MainThread]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:ae71cfd7-a9fe-4575-b870-f7b95bf39402&page=queryresults
[0m06:38:56.542903 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m06:38:56.547800 [info ] [MainThread]: [31m1 check failed:[0m
[0m06:38:56.551912 [info ] [MainThread]: Error from git --help: User does not have permissions for this command: "git"

[0m06:38:56.558840 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_wall_clock_time": 6.1995416, "process_user_time": 9.345705, "process_kernel_time": 0.810154, "process_mem_max_rss": "233184", "process_in_blocks": "7048", "command_success": false, "process_out_blocks": "0"}
[0m06:38:56.563459 [debug] [MainThread]: Command `dbt debug` failed at 06:38:56.562833 after 6.20 seconds
[0m06:38:56.567349 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m06:38:56.571297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa90e68c640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa90e9dd970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8d517ee50>]}
[0m06:38:56.574956 [debug] [MainThread]: Flushing usage events
[0m06:45:05.949150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbbc0f35e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbb9fd6ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbb9fd6a60>]}


============================== 06:45:05.969451 | 715406c2-9c5b-4d78-ad6e-c680fd1cf8e0 ==============================
[0m06:45:05.969451 [info ] [MainThread]: Running with dbt=1.8.7
[0m06:45:05.972916 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'printer_width': '80', 'invocation_command': 'dbt clean --profiles-dir /opt/airflow/include/dbt/', 'quiet': 'False', 'version_check': 'True', 'use_colors': 'True', 'log_cache_events': 'False', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'warn_error': 'None', 'profiles_dir': '/opt/airflow/include/dbt/', 'no_print': 'None', 'partial_parse': 'True', 'log_path': '/opt/airflow/include/dbt/logs', 'write_json': 'True', 'use_experimental_parser': 'False', 'fail_fast': 'False', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'empty': 'None', 'debug': 'False'}
[0m06:45:06.348523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '715406c2-9c5b-4d78-ad6e-c680fd1cf8e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbb9fcb070>]}
[0m06:45:06.391905 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.6749886, "process_user_time": 5.299673, "process_kernel_time": 0.191323, "process_mem_max_rss": "92940", "process_in_blocks": "8", "process_out_blocks": "0"}
[0m06:45:06.396080 [debug] [MainThread]: Command `dbt clean` succeeded at 06:45:06.395566 after 0.68 seconds
[0m06:45:06.399162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbbc0f35e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbb9edbeb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbb9fcbe20>]}
[0m06:45:06.402770 [debug] [MainThread]: Flushing usage events
[0m06:45:31.297286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5a39b9610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5a189e8b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5a189e850>]}


============================== 06:45:31.312877 | 9ff6fcf5-e3eb-4c4f-bb61-c1dbcbc50bd8 ==============================
[0m06:45:31.312877 [info ] [MainThread]: Running with dbt=1.8.7
[0m06:45:31.316865 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'log_cache_events': 'False', 'introspect': 'True', 'log_format': 'default', 'cache_selected_only': 'False', 'quiet': 'False', 'indirect_selection': 'eager', 'warn_error': 'None', 'use_experimental_parser': 'False', 'use_colors': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'invocation_command': 'dbt deps --profiles-dir /opt/airflow/include/dbt/', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'debug': 'False', 'version_check': 'True', 'partial_parse': 'True', 'log_path': '/opt/airflow/include/dbt/logs', 'fail_fast': 'False', 'empty': 'None', 'no_print': 'None', 'profiles_dir': '/opt/airflow/include/dbt/', 'write_json': 'True'}
[0m06:45:31.630093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9ff6fcf5-e3eb-4c4f-bb61-c1dbcbc50bd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5a202edf0>]}
[0m06:45:32.511915 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-of8php6v'
[0m06:45:32.514928 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:45:32.701118 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:45:32.705344 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:45:32.811502 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:45:32.826589 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:45:39.345622 [info ] [MainThread]: Installed from version 1.3.0
[0m06:45:39.348696 [info ] [MainThread]: Up to date!
[0m06:45:39.352107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '9ff6fcf5-e3eb-4c4f-bb61-c1dbcbc50bd8', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5a2d08e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5a2c1b160>]}
[0m06:45:39.356936 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 8.285108, "process_user_time": 4.882458, "process_kernel_time": 0.7042, "process_mem_max_rss": "94660", "process_in_blocks": "144", "process_out_blocks": "176"}
[0m06:45:39.360058 [debug] [MainThread]: Command `dbt deps` succeeded at 06:45:39.359506 after 8.29 seconds
[0m06:45:39.363620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5a39b9610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5a186fdf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5a2d76a90>]}
[0m06:45:39.367117 [debug] [MainThread]: Flushing usage events
[0m07:11:21.895591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce2c558640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce2a43bb20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce2a43bac0>]}


============================== 07:11:21.911379 | 149bbaa1-4753-40ee-9683-1cab05ca839a ==============================
[0m07:11:21.911379 [info ] [MainThread]: Running with dbt=1.8.7
[0m07:11:21.915326 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'log_cache_events': 'False', 'use_experimental_parser': 'False', 'debug': 'False', 'send_anonymous_usage_stats': 'True', 'empty': 'False', 'log_format': 'default', 'fail_fast': 'False', 'version_check': 'True', 'quiet': 'False', 'indirect_selection': 'eager', 'warn_error': 'None', 'use_colors': 'True', 'introspect': 'True', 'profiles_dir': '/opt/airflow/include/dbt/', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/include/dbt/', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'write_json': 'True', 'static_parser': 'True', 'no_print': 'None', 'cache_selected_only': 'False', 'log_path': '/opt/airflow/include/dbt/logs', 'partial_parse': 'True'}
[0m07:11:24.651388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '149bbaa1-4753-40ee-9683-1cab05ca839a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcdf30c2280>]}
[0m07:11:24.816469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '149bbaa1-4753-40ee-9683-1cab05ca839a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce2a82d310>]}
[0m07:11:24.820553 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m07:11:25.273642 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m07:11:25.289460 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m07:11:25.293297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '149bbaa1-4753-40ee-9683-1cab05ca839a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcdf2fc0910>]}
[0m07:11:32.426867 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.nyc_green_taxi.dim_time' (models/transform/dim_time.sql) depends on a source named 'nyc_taxi.green_tripdata' which was not found
[0m07:11:32.431360 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 10.728028, "process_user_time": 12.89929, "process_kernel_time": 0.820688, "process_mem_max_rss": "227264", "process_in_blocks": "520", "command_success": false, "process_out_blocks": "0"}
[0m07:11:32.435196 [debug] [MainThread]: Command `dbt run` failed at 07:11:32.434864 after 10.73 seconds
[0m07:11:32.438352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce2c558640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce2589caf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce2589cb50>]}
[0m07:11:32.441787 [debug] [MainThread]: Flushing usage events
[0m07:12:54.263026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f538ead3640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f538c9b6940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f538c9b68e0>]}


============================== 07:12:54.278797 | 1c6552d7-d523-4aa6-89a7-4ee68613a814 ==============================
[0m07:12:54.278797 [info ] [MainThread]: Running with dbt=1.8.7
[0m07:12:54.283685 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'target_path': 'None', 'invocation_command': 'dbt clean --profiles-dir /opt/airflow/include/dbt/', 'use_experimental_parser': 'False', 'fail_fast': 'False', 'empty': 'None', 'log_path': '/opt/airflow/include/dbt/logs', 'profiles_dir': '/opt/airflow/include/dbt/', 'log_cache_events': 'False', 'write_json': 'True', 'cache_selected_only': 'False', 'static_parser': 'True', 'warn_error': 'None', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'version_check': 'True', 'introspect': 'True', 'log_format': 'default', 'printer_width': '80', 'partial_parse': 'True', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'no_print': 'None', 'debug': 'False'}
[0m07:12:54.514950 [error] [MainThread]: Encountered an error:
object of type 'NoneType' has no len()
[0m07:12:54.522513 [error] [MainThread]: Traceback (most recent call last):
  File "/opt/airflow/dbt_venv/lib/python3.9/site-packages/dbt/cli/requires.py", line 138, in wrapper
    result, success = func(*args, **kwargs)
  File "/opt/airflow/dbt_venv/lib/python3.9/site-packages/dbt/cli/requires.py", line 101, in wrapper
    return func(*args, **kwargs)
  File "/opt/airflow/dbt_venv/lib/python3.9/site-packages/dbt/cli/requires.py", line 201, in wrapper
    return func(*args, **kwargs)
  File "/opt/airflow/dbt_venv/lib/python3.9/site-packages/dbt/cli/requires.py", line 234, in wrapper
    project = load_project(
  File "/opt/airflow/dbt_venv/lib/python3.9/site-packages/dbt/config/runtime.py", line 51, in load_project
    project = Project.from_project_root(
  File "/opt/airflow/dbt_venv/lib/python3.9/site-packages/dbt/config/project.py", line 765, in from_project_root
    return partial.render(renderer)
  File "/opt/airflow/dbt_venv/lib/python3.9/site-packages/dbt/config/project.py", line 335, in render
    return self.create_project(rendered)
  File "/opt/airflow/dbt_venv/lib/python3.9/site-packages/dbt/config/project.py", line 482, in create_project
    packages: PackageConfig = package_config_from_data(
  File "/opt/airflow/dbt_venv/lib/python3.9/site-packages/dbt/config/project.py", line 144, in package_config_from_data
    for i in range(0, len(packages_data.get("packages", []))):
TypeError: object of type 'NoneType' has no len()

[0m07:12:54.528130 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_wall_clock_time": 0.47716424, "process_user_time": 4.673445, "process_kernel_time": 0.284966, "process_mem_max_rss": "92576", "process_in_blocks": "104", "command_success": false, "process_out_blocks": "0"}
[0m07:12:54.532737 [debug] [MainThread]: Command `dbt clean` failed at 07:12:54.532100 after 0.48 seconds
[0m07:12:54.537075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f538ead3640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f538de2bdf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f538c995e20>]}
[0m07:12:54.540424 [debug] [MainThread]: Flushing usage events
[0m07:13:41.959623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f69a3c735b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f69a1b55b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f69a1b55b20>]}


============================== 07:13:41.976265 | 49c5988b-7c0a-4404-8c15-8e62b31edf22 ==============================
[0m07:13:41.976265 [info ] [MainThread]: Running with dbt=1.8.7
[0m07:13:41.980044 [debug] [MainThread]: running dbt with arguments {'quiet': 'False', 'introspect': 'True', 'fail_fast': 'False', 'static_parser': 'True', 'version_check': 'True', 'use_colors': 'True', 'debug': 'False', 'write_json': 'True', 'warn_error': 'None', 'use_experimental_parser': 'False', 'send_anonymous_usage_stats': 'True', 'log_cache_events': 'False', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/include/dbt/', 'printer_width': '80', 'log_path': '/opt/airflow/include/dbt/logs', 'log_format': 'default', 'partial_parse': 'True', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/include/dbt/', 'target_path': 'None', 'empty': 'False', 'no_print': 'None'}
[0m07:13:42.005531 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'nyc_taxi'
[0m07:13:42.010455 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.27772576, "process_user_time": 5.145722, "process_kernel_time": 0.381871, "process_mem_max_rss": "91540", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m07:13:42.014636 [debug] [MainThread]: Command `dbt run` failed at 07:13:42.014238 after 0.28 seconds
[0m07:13:42.017691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f69a3c735b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f69a282fb20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f69a1c0da90>]}
[0m07:13:42.020942 [debug] [MainThread]: Flushing usage events
[0m07:14:46.645903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7843112610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78410395e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7841039640>]}


============================== 07:14:46.662610 | 697aa5f0-d671-467b-9886-d98743d6cf91 ==============================
[0m07:14:46.662610 [info ] [MainThread]: Running with dbt=1.8.7
[0m07:14:46.666388 [debug] [MainThread]: running dbt with arguments {'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'cache_selected_only': 'False', 'log_path': '/opt/airflow/include/dbt/logs', 'introspect': 'True', 'invocation_command': 'dbt deps', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'write_json': 'True', 'log_cache_events': 'False', 'send_anonymous_usage_stats': 'True', 'profiles_dir': '/opt/airflow/include/dbt', 'debug': 'False', 'target_path': 'None', 'partial_parse': 'True', 'warn_error': 'None', 'fail_fast': 'False', 'printer_width': '80', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'use_colors': 'True', 'empty': 'None', 'version_check': 'True', 'static_parser': 'True'}
[0m07:14:46.906707 [error] [MainThread]: Encountered an error:
object of type 'NoneType' has no len()
[0m07:14:46.918727 [error] [MainThread]: Traceback (most recent call last):
  File "/opt/airflow/dbt_venv/lib/python3.9/site-packages/dbt/cli/requires.py", line 138, in wrapper
    result, success = func(*args, **kwargs)
  File "/opt/airflow/dbt_venv/lib/python3.9/site-packages/dbt/cli/requires.py", line 101, in wrapper
    return func(*args, **kwargs)
  File "/opt/airflow/dbt_venv/lib/python3.9/site-packages/dbt/cli/requires.py", line 201, in wrapper
    return func(*args, **kwargs)
  File "/opt/airflow/dbt_venv/lib/python3.9/site-packages/dbt/cli/requires.py", line 234, in wrapper
    project = load_project(
  File "/opt/airflow/dbt_venv/lib/python3.9/site-packages/dbt/config/runtime.py", line 51, in load_project
    project = Project.from_project_root(
  File "/opt/airflow/dbt_venv/lib/python3.9/site-packages/dbt/config/project.py", line 765, in from_project_root
    return partial.render(renderer)
  File "/opt/airflow/dbt_venv/lib/python3.9/site-packages/dbt/config/project.py", line 335, in render
    return self.create_project(rendered)
  File "/opt/airflow/dbt_venv/lib/python3.9/site-packages/dbt/config/project.py", line 482, in create_project
    packages: PackageConfig = package_config_from_data(
  File "/opt/airflow/dbt_venv/lib/python3.9/site-packages/dbt/config/project.py", line 144, in package_config_from_data
    for i in range(0, len(packages_data.get("packages", []))):
TypeError: object of type 'NoneType' has no len()

[0m07:14:46.923997 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_wall_clock_time": 0.50163615, "process_user_time": 4.849597, "process_kernel_time": 0.217428, "process_mem_max_rss": "92608", "process_in_blocks": "8", "command_success": false, "process_out_blocks": "0"}
[0m07:14:46.928295 [debug] [MainThread]: Command `dbt deps` failed at 07:14:46.927744 after 0.51 seconds
[0m07:14:46.932753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7843112610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7840ffa670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7840ffaca0>]}
[0m07:14:46.935945 [debug] [MainThread]: Flushing usage events
[0m07:15:54.942462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00435415e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00414665e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0041466640>]}


============================== 07:15:54.957967 | 3b9cf1fd-d519-4c4a-9a25-3931b78adc10 ==============================
[0m07:15:54.957967 [info ] [MainThread]: Running with dbt=1.8.7
[0m07:15:54.962448 [debug] [MainThread]: running dbt with arguments {'empty': 'None', 'invocation_command': 'dbt deps', 'write_json': 'True', 'introspect': 'True', 'cache_selected_only': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'profiles_dir': '/opt/airflow/include/dbt', 'target_path': 'None', 'send_anonymous_usage_stats': 'True', 'log_path': '/opt/airflow/include/dbt/logs', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'static_parser': 'True', 'warn_error': 'None', 'fail_fast': 'False', 'quiet': 'False', 'log_format': 'default', 'partial_parse': 'True', 'use_colors': 'True', 'debug': 'False', 'indirect_selection': 'eager', 'no_print': 'None', 'version_check': 'True', 'printer_width': '80'}
[0m07:15:55.283270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3b9cf1fd-d519-4c4a-9a25-3931b78adc10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0042dc2670>]}
[0m07:15:56.119960 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-m9c6_39e'
[0m07:15:56.123022 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m07:15:56.303269 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m07:15:56.307144 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m07:15:56.426593 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m07:15:56.443056 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m07:16:03.585320 [info ] [MainThread]: Installed from version 1.3.0
[0m07:16:03.588234 [info ] [MainThread]: Up to date!
[0m07:16:03.591616 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '3b9cf1fd-d519-4c4a-9a25-3931b78adc10', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0041466a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00414c1460>]}
[0m07:16:03.597266 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 8.877201, "process_user_time": 4.971158, "process_kernel_time": 0.66156, "process_mem_max_rss": "94244", "process_out_blocks": "176", "process_in_blocks": "0"}
[0m07:16:03.600612 [debug] [MainThread]: Command `dbt deps` succeeded at 07:16:03.600222 after 8.88 seconds
[0m07:16:03.603444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00435415e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00413a0880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0041466a60>]}
[0m07:16:03.606410 [debug] [MainThread]: Flushing usage events
[0m07:16:35.086860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f828ec4e670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f828cb31c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f828cb31c10>]}


============================== 07:16:35.103020 | c1523ada-dc8a-4ae5-beb1-59f72fb0c6ae ==============================
[0m07:16:35.103020 [info ] [MainThread]: Running with dbt=1.8.7
[0m07:16:35.108145 [debug] [MainThread]: running dbt with arguments {'log_path': '/opt/airflow/include/dbt/logs', 'use_experimental_parser': 'False', 'quiet': 'False', 'printer_width': '80', 'empty': 'False', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'version_check': 'True', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/include/dbt/', 'warn_error': 'None', 'cache_selected_only': 'False', 'write_json': 'True', 'partial_parse': 'True', 'log_cache_events': 'False', 'use_colors': 'True', 'indirect_selection': 'eager', 'no_print': 'None', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/include/dbt/', 'log_format': 'default', 'debug': 'False', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'target_path': 'None'}
[0m07:16:37.736880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c1523ada-dc8a-4ae5-beb1-59f72fb0c6ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82557fffa0>]}
[0m07:16:37.896076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c1523ada-dc8a-4ae5-beb1-59f72fb0c6ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f828f030700>]}
[0m07:16:37.900071 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m07:16:38.419151 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m07:16:38.438680 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m07:16:38.442271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c1523ada-dc8a-4ae5-beb1-59f72fb0c6ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f828cbcc400>]}
[0m07:16:46.095120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c1523ada-dc8a-4ae5-beb1-59f72fb0c6ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82557cbb20>]}
[0m07:16:46.501988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c1523ada-dc8a-4ae5-beb1-59f72fb0c6ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8255703f70>]}
[0m07:16:46.505231 [info ] [MainThread]: Found 3 models, 2 sources, 600 macros
[0m07:16:46.508591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c1523ada-dc8a-4ae5-beb1-59f72fb0c6ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8287fb57c0>]}
[0m07:16:46.515165 [info ] [MainThread]: 
[0m07:16:46.518802 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m07:16:46.535759 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_northern-shield-437204-m0'
[0m07:16:46.538957 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:16:47.261902 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_northern-shield-437204-m0, now list_northern-shield-437204-m0_nyc_taxi)
[0m07:16:47.265068 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:16:48.015258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c1523ada-dc8a-4ae5-beb1-59f72fb0c6ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f828efdfc70>]}
[0m07:16:48.019067 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:16:48.022488 [info ] [MainThread]: 
[0m07:16:48.049330 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_time
[0m07:16:48.053656 [info ] [Thread-1  ]: 1 of 3 START sql table model nyc_taxi.dim_time ................................. [RUN]
[0m07:16:48.058331 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_northern-shield-437204-m0_nyc_taxi, now model.nyc_taxi.dim_time)
[0m07:16:48.062374 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_time
[0m07:16:48.089239 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_time"
[0m07:16:48.138586 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_time
[0m07:16:48.269689 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.dim_time"
[0m07:16:48.320986 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:16:48.331603 [debug] [Thread-1  ]: On model.nyc_taxi.dim_time: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.dim_time"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`dim_time`
      
    
    

    OPTIONS()
    as (
      WITH datetime_cte AS (
    SELECT DISTINCT
        ROW_NUMBER() OVER () AS time_id,
        DATE(lpep_pickup_datetime) AS date,
        lpep_pickup_datetime AS date_part 
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata`
)
SELECT
    time_id,
    date,
    EXTRACT(YEAR FROM date_part) AS year,
    EXTRACT(MONTH FROM date_part) AS month,
    EXTRACT(DAY FROM date_part) AS day,
    EXTRACT(HOUR FROM date_part) AS hour,
    EXTRACT(MINUTE FROM date_part) AS minute,
    FORMAT_TIMESTAMP('%A', date_part) AS weekday 
FROM datetime_cte;
    );
  
[0m07:16:48.978054 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:05bf6418-44e5-4363-9048-8bb4471560a2&page=queryresults
[0m07:16:48.982629 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected ")" but got ";" at [29:18]; reason: invalidQuery, location: query, message: Syntax error: Expected ")" but got ";" at [29:18]')
[0m07:16:50.275179 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:bf220d5e-68cd-4f50-9ff6-eed9b101b93b&page=queryresults
[0m07:16:50.279811 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:bf220d5e-68cd-4f50-9ff6-eed9b101b93b&page=queryresults
[0m07:16:50.306406 [debug] [Thread-1  ]: Database Error in model dim_time (models/transform/dim_time.sql)
  Syntax error: Expected ")" but got ";" at [29:18]
  compiled code at target/run/nyc_taxi/models/transform/dim_time.sql
[0m07:16:50.313268 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c1523ada-dc8a-4ae5-beb1-59f72fb0c6ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8287e9cd00>]}
[0m07:16:50.319497 [error] [Thread-1  ]: 1 of 3 ERROR creating sql table model nyc_taxi.dim_time ........................ [[31mERROR[0m in 2.25s]
[0m07:16:50.324758 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_time
[0m07:16:50.328557 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_zone
[0m07:16:50.332794 [info ] [Thread-1  ]: 2 of 3 START sql table model nyc_taxi.dim_zone ................................. [RUN]
[0m07:16:50.336967 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_time, now model.nyc_taxi.dim_zone)
[0m07:16:50.340207 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_zone
[0m07:16:50.358200 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_zone"
[0m07:16:50.376814 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_zone
[0m07:16:50.392088 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.dim_zone"
[0m07:16:50.409163 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:16:50.419555 [debug] [Thread-1  ]: On model.nyc_taxi.dim_zone: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.dim_zone"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`dim_zone`
      
    
    

    OPTIONS()
    as (
      SELECT
    location_id,
    borough,
    zone,
    replace(service_zone, 'Boro', 'Green') as service_zone
FROM `northern-shield-437204-m0`.`nyc_taxi`.`zone_map`
    );
  
[0m07:16:51.571550 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:bc26e00d-3a38-4414-ab3c-678630ee7aac&page=queryresults
[0m07:16:53.084226 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c1523ada-dc8a-4ae5-beb1-59f72fb0c6ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f828d87de80>]}
[0m07:16:53.098112 [info ] [Thread-1  ]: 2 of 3 OK created sql table model nyc_taxi.dim_zone ............................ [[32mCREATE TABLE (265.0 rows, 12.1 KiB processed)[0m in 2.75s]
[0m07:16:53.102978 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_zone
[0m07:16:53.107520 [debug] [Thread-1  ]: Began running node model.nyc_taxi.fct_trips
[0m07:16:53.110950 [info ] [Thread-1  ]: 3 of 3 SKIP relation nyc_taxi.fct_trips ........................................ [[33mSKIP[0m]
[0m07:16:53.116401 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.fct_trips
[0m07:16:53.123509 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:16:53.126284 [debug] [MainThread]: Connection 'model.nyc_taxi.dim_zone' was properly closed.
[0m07:16:53.129368 [info ] [MainThread]: 
[0m07:16:53.133329 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 6.61 seconds (6.61s).
[0m07:16:53.139717 [debug] [MainThread]: Command end result
[0m07:16:53.348079 [info ] [MainThread]: 
[0m07:16:53.350799 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m07:16:53.353751 [info ] [MainThread]: 
[0m07:16:53.356780 [error] [MainThread]:   Database Error in model dim_time (models/transform/dim_time.sql)
  Syntax error: Expected ")" but got ";" at [29:18]
  compiled code at target/run/nyc_taxi/models/transform/dim_time.sql
[0m07:16:53.359257 [info ] [MainThread]: 
[0m07:16:53.362550 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=1 TOTAL=3
[0m07:16:53.367499 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 19.926844, "process_user_time": 14.098482, "process_kernel_time": 0.898479, "process_mem_max_rss": "231232", "process_in_blocks": "1312", "command_success": false, "process_out_blocks": "0"}
[0m07:16:53.371779 [debug] [MainThread]: Command `dbt run` failed at 07:16:53.371056 after 19.93 seconds
[0m07:16:53.375546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f828ec4e670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8287ff3940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82557fffa0>]}
[0m07:16:53.377974 [debug] [MainThread]: Flushing usage events
[0m07:18:55.144190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1b40b35e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1b1f96b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1b1f96af0>]}


============================== 07:18:55.160888 | 16aa8a5c-3010-4b54-95b4-661ad32affd8 ==============================
[0m07:18:55.160888 [info ] [MainThread]: Running with dbt=1.8.7
[0m07:18:55.166080 [debug] [MainThread]: running dbt with arguments {'warn_error': 'None', 'fail_fast': 'False', 'cache_selected_only': 'False', 'introspect': 'True', 'version_check': 'True', 'partial_parse': 'True', 'quiet': 'False', 'write_json': 'True', 'log_path': '/opt/airflow/include/dbt/logs', 'target_path': 'None', 'static_parser': 'True', 'empty': 'False', 'profiles_dir': '/opt/airflow/include/dbt/', 'printer_width': '80', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/include/dbt/', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'indirect_selection': 'eager', 'debug': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'use_experimental_parser': 'False', 'no_print': 'None', 'log_format': 'default', 'log_cache_events': 'False'}
[0m07:18:57.779848 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '16aa8a5c-3010-4b54-95b4-661ad32affd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff17b93be50>]}
[0m07:18:57.939165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '16aa8a5c-3010-4b54-95b4-661ad32affd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1b26e8580>]}
[0m07:18:57.943366 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m07:18:58.411277 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m07:19:01.552672 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m07:19:01.556147 [debug] [MainThread]: Partial parsing: updated file: nyc_taxi://models/transform/dim_time.sql
[0m07:19:02.335662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '16aa8a5c-3010-4b54-95b4-661ad32affd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1ac754130>]}
[0m07:19:02.887340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '16aa8a5c-3010-4b54-95b4-661ad32affd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1ad3b9910>]}
[0m07:19:02.890773 [info ] [MainThread]: Found 3 models, 2 sources, 600 macros
[0m07:19:02.895487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '16aa8a5c-3010-4b54-95b4-661ad32affd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1ac754e80>]}
[0m07:19:02.901927 [info ] [MainThread]: 
[0m07:19:02.907912 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m07:19:02.924227 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_northern-shield-437204-m0'
[0m07:19:02.928033 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:19:03.780034 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_northern-shield-437204-m0, now list_northern-shield-437204-m0_nyc_taxi)
[0m07:19:03.785549 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:19:04.410522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '16aa8a5c-3010-4b54-95b4-661ad32affd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1b3886310>]}
[0m07:19:04.414676 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:19:04.417867 [info ] [MainThread]: 
[0m07:19:04.439694 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_time
[0m07:19:04.444184 [info ] [Thread-1  ]: 1 of 3 START sql table model nyc_taxi.dim_time ................................. [RUN]
[0m07:19:04.448263 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_northern-shield-437204-m0_nyc_taxi, now model.nyc_taxi.dim_time)
[0m07:19:04.451683 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_time
[0m07:19:04.490560 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_time"
[0m07:19:04.516507 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_time
[0m07:19:04.644355 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.dim_time"
[0m07:19:04.667813 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:19:04.679021 [debug] [Thread-1  ]: On model.nyc_taxi.dim_time: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.dim_time"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`dim_time`
      
    
    

    OPTIONS()
    as (
      WITH datetime_cte AS (
    SELECT DISTINCT
        ROW_NUMBER() OVER () AS time_id,
        DATE(lpep_pickup_datetime) AS date,
        lpep_pickup_datetime AS date_part 
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata`
)
SELECT
    time_id,
    date,
    EXTRACT(YEAR FROM date_part) AS year,
    EXTRACT(MONTH FROM date_part) AS month,
    EXTRACT(DAY FROM date_part) AS day,
    EXTRACT(HOUR FROM date_part) AS hour,
    EXTRACT(MINUTE FROM date_part) AS minute,
    FORMAT_TIMESTAMP('%A', date_part) AS weekday 
FROM datetime_cte
    );
  
[0m07:19:05.611314 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:bdb68ab3-975c-42d9-891f-fac086d2b5d4&page=queryresults
[0m07:19:09.874071 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '16aa8a5c-3010-4b54-95b4-661ad32affd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff17ac4dd30>]}
[0m07:19:09.878592 [info ] [Thread-1  ]: 1 of 3 OK created sql table model nyc_taxi.dim_time ............................ [[32mCREATE TABLE (180.8k rows, 1.4 MiB processed)[0m in 5.42s]
[0m07:19:09.884089 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_time
[0m07:19:09.887550 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_zone
[0m07:19:09.891357 [info ] [Thread-1  ]: 2 of 3 START sql table model nyc_taxi.dim_zone ................................. [RUN]
[0m07:19:09.895274 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_time, now model.nyc_taxi.dim_zone)
[0m07:19:09.898975 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_zone
[0m07:19:09.911643 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_zone"
[0m07:19:09.930705 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_zone
[0m07:19:09.943195 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:19:10.614314 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.dim_zone"
[0m07:19:10.636966 [debug] [Thread-1  ]: On model.nyc_taxi.dim_zone: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.dim_zone"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`dim_zone`
      
    
    

    OPTIONS()
    as (
      SELECT
    location_id,
    borough,
    zone,
    replace(service_zone, 'Boro', 'Green') as service_zone
FROM `northern-shield-437204-m0`.`nyc_taxi`.`zone_map`
    );
  
[0m07:19:11.333394 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:aeb8ea8f-1998-4029-95e8-0e61df599af9&page=queryresults
[0m07:19:15.630048 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '16aa8a5c-3010-4b54-95b4-661ad32affd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff17ac79850>]}
[0m07:19:15.634012 [info ] [Thread-1  ]: 2 of 3 OK created sql table model nyc_taxi.dim_zone ............................ [[32mCREATE TABLE (265.0 rows, 12.1 KiB processed)[0m in 5.74s]
[0m07:19:15.638308 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_zone
[0m07:19:15.641686 [debug] [Thread-1  ]: Began running node model.nyc_taxi.fct_trips
[0m07:19:15.645080 [info ] [Thread-1  ]: 3 of 3 START sql table model nyc_taxi.fct_trips ................................ [RUN]
[0m07:19:15.649382 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_zone, now model.nyc_taxi.fct_trips)
[0m07:19:15.653832 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.fct_trips
[0m07:19:15.680429 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.fct_trips"
[0m07:19:15.703690 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.fct_trips
[0m07:19:15.718282 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.fct_trips"
[0m07:19:15.738017 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:19:15.747553 [debug] [Thread-1  ]: On model.nyc_taxi.fct_trips: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.fct_trips"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips`
      
    
    

    OPTIONS()
    as (
      WITH trip_with_time AS (
    SELECT 
        t.trip_id,
        t.vendor_id,
        t.lpep_pickup_datetime,
        t.lpep_dropoff_datetime,
        td_pickup.time_id AS pickup_time_id,
        td_dropoff.time_id AS dropoff_time_id,
        t.pu_location_id,
        t.do_location_id,
        t.passenger_count,
        t.trip_distance,
        t.fare_amount,
        t.extra,
        t.mta_tax,
        t.tip_amount,
        t.tolls_amount,
        t.ehail_fee,
        t.improvement_surcharge,
        t.total_amount,
        t.payment_type,
        t.trip_type,
        t.congestion_surcharge
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata` AS t
    LEFT JOIN `northern-shield-437204-m0`.`nyc_taxi`.`dim_time` AS td_pickup
        ON TIMESTAMP_TRUNC(t.lpep_pickup_datetime, HOUR) = td_pickup.time
    LEFT JOIN `northern-shield-437204-m0`.`nyc_taxi`.`dim_time` AS td_dropoff
        ON TIMESTAMP_TRUNC(t.lpep_dropoff_datetime, HOUR) = td_dropoff.time
)

SELECT 
    trip_id,
    vendor_id,
    pickup_time_id,
    dropoff_time_id,
    pu_location_id,
    do_location_id,
    passenger_count,
    trip_distance,
    fare_amount,
    extra,
    mta_tax,
    tip_amount,
    tolls_amount,
    ehail_fee,
    improvement_surcharge,
    total_amount,
    payment_type,
    trip_type,
    congestion_surcharge
FROM trip_with_time;
    );
  
[0m07:19:16.476825 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:52eec1c7-e74d-4b2f-9b54-793b74fca0d0&page=queryresults
[0m07:19:16.480837 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected ")" but got ";" at [63:20]; reason: invalidQuery, location: query, message: Syntax error: Expected ")" but got ";" at [63:20]')
[0m07:19:17.768127 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:00ccc53a-c481-42f5-a063-52b1a6cb3807&page=queryresults
[0m07:19:17.771721 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:00ccc53a-c481-42f5-a063-52b1a6cb3807&page=queryresults
[0m07:19:17.781348 [debug] [Thread-1  ]: Database Error in model fct_trips (models/transform/fct_trips.sql)
  Syntax error: Expected ")" but got ";" at [63:20]
  compiled code at target/run/nyc_taxi/models/transform/fct_trips.sql
[0m07:19:17.786114 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '16aa8a5c-3010-4b54-95b4-661ad32affd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1ac69c160>]}
[0m07:19:17.790274 [error] [Thread-1  ]: 3 of 3 ERROR creating sql table model nyc_taxi.fct_trips ....................... [[31mERROR[0m in 2.14s]
[0m07:19:17.795317 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.fct_trips
[0m07:19:17.802243 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:19:17.823775 [debug] [MainThread]: Connection 'model.nyc_taxi.fct_trips' was properly closed.
[0m07:19:17.877000 [info ] [MainThread]: 
[0m07:19:17.881894 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 14.97 seconds (14.97s).
[0m07:19:17.891232 [debug] [MainThread]: Command end result
[0m07:19:18.095991 [info ] [MainThread]: 
[0m07:19:18.099359 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m07:19:18.102716 [info ] [MainThread]: 
[0m07:19:18.106149 [error] [MainThread]:   Database Error in model fct_trips (models/transform/fct_trips.sql)
  Syntax error: Expected ")" but got ";" at [63:20]
  compiled code at target/run/nyc_taxi/models/transform/fct_trips.sql
[0m07:19:18.111370 [info ] [MainThread]: 
[0m07:19:18.114831 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m07:19:18.120719 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 24.72068, "process_user_time": 10.994823, "process_kernel_time": 0.837609, "process_mem_max_rss": "228076", "process_in_blocks": "2152", "command_success": false, "process_out_blocks": "0"}
[0m07:19:18.124605 [debug] [MainThread]: Command `dbt run` failed at 07:19:18.124071 after 24.72 seconds
[0m07:19:18.127664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1b40b35e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1ac7379d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1ac737df0>]}
[0m07:19:18.130456 [debug] [MainThread]: Flushing usage events
[0m07:20:31.611310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f59821c7670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f59800abc70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f59800abc10>]}


============================== 07:20:31.626676 | 6918fcd4-995e-40b3-8ae7-231b6528828c ==============================
[0m07:20:31.626676 [info ] [MainThread]: Running with dbt=1.8.7
[0m07:20:31.630482 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'quiet': 'False', 'fail_fast': 'False', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/include/dbt/', 'write_json': 'True', 'use_colors': 'True', 'log_cache_events': 'False', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'indirect_selection': 'eager', 'target_path': 'None', 'printer_width': '80', 'log_path': '/opt/airflow/include/dbt/logs', 'warn_error': 'None', 'profiles_dir': '/opt/airflow/include/dbt/', 'empty': 'False', 'version_check': 'True', 'no_print': 'None', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'log_format': 'default', 'debug': 'False', 'static_parser': 'True', 'partial_parse': 'True'}
[0m07:20:34.506420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6918fcd4-995e-40b3-8ae7-231b6528828c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5949a09c70>]}
[0m07:20:34.665549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6918fcd4-995e-40b3-8ae7-231b6528828c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5949a3acd0>]}
[0m07:20:34.669351 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m07:20:35.197441 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m07:20:37.921893 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m07:20:37.925295 [debug] [MainThread]: Partial parsing: updated file: nyc_taxi://models/transform/fct_trips.sql
[0m07:20:38.787087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6918fcd4-995e-40b3-8ae7-231b6528828c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f597a94fe80>]}
[0m07:20:39.405176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6918fcd4-995e-40b3-8ae7-231b6528828c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5948c699a0>]}
[0m07:20:39.409098 [info ] [MainThread]: Found 3 models, 2 sources, 600 macros
[0m07:20:39.413114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6918fcd4-995e-40b3-8ae7-231b6528828c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f597b6168b0>]}
[0m07:20:39.420680 [info ] [MainThread]: 
[0m07:20:39.424186 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m07:20:39.441005 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_northern-shield-437204-m0'
[0m07:20:39.444272 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:20:40.087283 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_northern-shield-437204-m0, now list_northern-shield-437204-m0_nyc_taxi)
[0m07:20:40.090403 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:20:40.100268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6918fcd4-995e-40b3-8ae7-231b6528828c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f59822a9c70>]}
[0m07:20:40.103731 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:20:40.109155 [info ] [MainThread]: 
[0m07:20:39.283167 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_time
[0m07:20:39.288963 [info ] [Thread-1  ]: 1 of 3 START sql table model nyc_taxi.dim_time ................................. [RUN]
[0m07:20:39.296768 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_northern-shield-437204-m0_nyc_taxi, now model.nyc_taxi.dim_time)
[0m07:20:39.302527 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_time
[0m07:20:39.354667 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_time"
[0m07:20:39.377369 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_time
[0m07:20:39.435569 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:20:40.130084 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.dim_time"
[0m07:20:40.153568 [debug] [Thread-1  ]: On model.nyc_taxi.dim_time: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.dim_time"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`dim_time`
      
    
    

    OPTIONS()
    as (
      WITH datetime_cte AS (
    SELECT DISTINCT
        ROW_NUMBER() OVER () AS time_id,
        DATE(lpep_pickup_datetime) AS date,
        lpep_pickup_datetime AS date_part 
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata`
)
SELECT
    time_id,
    date,
    EXTRACT(YEAR FROM date_part) AS year,
    EXTRACT(MONTH FROM date_part) AS month,
    EXTRACT(DAY FROM date_part) AS day,
    EXTRACT(HOUR FROM date_part) AS hour,
    EXTRACT(MINUTE FROM date_part) AS minute,
    FORMAT_TIMESTAMP('%A', date_part) AS weekday 
FROM datetime_cte
    );
  
[0m07:20:40.852924 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:2068a18d-9dd0-4121-92ff-8c3af2782132&page=queryresults
[0m07:20:45.328297 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6918fcd4-995e-40b3-8ae7-231b6528828c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5949ab8820>]}
[0m07:20:45.333180 [info ] [Thread-1  ]: 1 of 3 OK created sql table model nyc_taxi.dim_time ............................ [[32mCREATE TABLE (180.8k rows, 1.4 MiB processed)[0m in 6.03s]
[0m07:20:45.339084 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_time
[0m07:20:45.342945 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_zone
[0m07:20:45.347155 [info ] [Thread-1  ]: 2 of 3 START sql table model nyc_taxi.dim_zone ................................. [RUN]
[0m07:20:45.351721 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_time, now model.nyc_taxi.dim_zone)
[0m07:20:45.355417 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_zone
[0m07:20:45.369150 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_zone"
[0m07:20:45.394172 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_zone
[0m07:20:45.413010 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:20:46.131639 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.dim_zone"
[0m07:20:46.156091 [debug] [Thread-1  ]: On model.nyc_taxi.dim_zone: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.dim_zone"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`dim_zone`
      
    
    

    OPTIONS()
    as (
      SELECT
    location_id,
    borough,
    zone,
    replace(service_zone, 'Boro', 'Green') as service_zone
FROM `northern-shield-437204-m0`.`nyc_taxi`.`zone_map`
    );
  
[0m07:20:46.882642 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:c47bb8a1-5313-4fbc-9986-82225266899f&page=queryresults
[0m07:20:49.469972 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6918fcd4-995e-40b3-8ae7-231b6528828c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f597a8b0d30>]}
[0m07:20:49.474879 [info ] [Thread-1  ]: 2 of 3 OK created sql table model nyc_taxi.dim_zone ............................ [[32mCREATE TABLE (265.0 rows, 12.1 KiB processed)[0m in 4.12s]
[0m07:20:49.481542 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_zone
[0m07:20:49.485980 [debug] [Thread-1  ]: Began running node model.nyc_taxi.fct_trips
[0m07:20:49.490180 [info ] [Thread-1  ]: 3 of 3 START sql table model nyc_taxi.fct_trips ................................ [RUN]
[0m07:20:49.493965 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_zone, now model.nyc_taxi.fct_trips)
[0m07:20:49.496930 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.fct_trips
[0m07:20:49.519681 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.fct_trips"
[0m07:20:49.543985 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.fct_trips
[0m07:20:49.558561 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.fct_trips"
[0m07:20:49.584603 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:20:49.595611 [debug] [Thread-1  ]: On model.nyc_taxi.fct_trips: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.fct_trips"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips`
      
    
    

    OPTIONS()
    as (
      WITH tripdata_cte AS (
    SELECT 
        t.trip_id,
        t.vendor_id,
        t.lpep_pickup_datetime,
        t.lpep_dropoff_datetime,
        td_pickup.time_id AS pickup_time_id,
        td_dropoff.time_id AS dropoff_time_id,
        t.pu_location_id,
        t.do_location_id,
        t.passenger_count,
        t.trip_distance,
        t.fare_amount,
        t.extra,
        t.mta_tax,
        t.tip_amount,
        t.tolls_amount,
        t.ehail_fee,
        t.improvement_surcharge,
        t.total_amount,
        t.payment_type,
        t.trip_type,
        t.congestion_surcharge
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata` AS t
    LEFT JOIN `northern-shield-437204-m0`.`nyc_taxi`.`dim_time` AS td_pickup
        ON TIMESTAMP_TRUNC(t.lpep_pickup_datetime, HOUR) = td_pickup.time
    LEFT JOIN `northern-shield-437204-m0`.`nyc_taxi`.`dim_time` AS td_dropoff
        ON TIMESTAMP_TRUNC(t.lpep_dropoff_datetime, HOUR) = td_dropoff.time
)

SELECT 
    trip_id,
    vendor_id,
    pickup_time_id,
    dropoff_time_id,
    pu_location_id,
    do_location_id,
    passenger_count,
    trip_distance,
    fare_amount,
    extra,
    mta_tax,
    tip_amount,
    tolls_amount,
    ehail_fee,
    improvement_surcharge,
    total_amount,
    payment_type,
    trip_type,
    congestion_surcharge
FROM tripdata_cte
    );
  
[0m07:20:50.543452 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:625497a8-89c4-490a-9056-4605588d9eb7&page=queryresults
[0m07:20:50.843804 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Name time not found inside td_pickup at [38:70]; reason: invalidQuery, location: query, message: Name time not found inside td_pickup at [38:70]')
[0m07:20:51.729663 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:2baac75f-116a-472b-a4ab-2ce068793ebf&page=queryresults
[0m07:20:52.028355 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:2baac75f-116a-472b-a4ab-2ce068793ebf&page=queryresults
[0m07:20:52.042205 [debug] [Thread-1  ]: Database Error in model fct_trips (models/transform/fct_trips.sql)
  Name time not found inside td_pickup at [38:70]
  compiled code at target/run/nyc_taxi/models/transform/fct_trips.sql
[0m07:20:52.045701 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6918fcd4-995e-40b3-8ae7-231b6528828c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f597b4fa5e0>]}
[0m07:20:52.050902 [error] [Thread-1  ]: 3 of 3 ERROR creating sql table model nyc_taxi.fct_trips ....................... [[31mERROR[0m in 2.55s]
[0m07:20:52.056790 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.fct_trips
[0m07:20:52.065199 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:20:52.075682 [debug] [MainThread]: Connection 'model.nyc_taxi.fct_trips' was properly closed.
[0m07:20:52.079826 [info ] [MainThread]: 
[0m07:20:52.084440 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 12.66 seconds (12.66s).
[0m07:20:52.097417 [debug] [MainThread]: Command end result
[0m07:20:52.297442 [info ] [MainThread]: 
[0m07:20:52.300888 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m07:20:52.304081 [info ] [MainThread]: 
[0m07:20:52.307491 [error] [MainThread]:   Database Error in model fct_trips (models/transform/fct_trips.sql)
  Name time not found inside td_pickup at [38:70]
  compiled code at target/run/nyc_taxi/models/transform/fct_trips.sql
[0m07:20:52.310905 [info ] [MainThread]: 
[0m07:20:52.314480 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m07:20:52.320248 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 22.424059, "process_user_time": 11.288925, "process_kernel_time": 0.996366, "process_mem_max_rss": "230532", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m07:20:52.324290 [debug] [MainThread]: Command `dbt run` failed at 07:20:52.323943 after 22.43 seconds
[0m07:20:52.327785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f59821c7670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f597b4f8f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5949a09d00>]}
[0m07:20:52.331347 [debug] [MainThread]: Flushing usage events
[0m07:27:18.407337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d21b20640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d1fa02c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d1fa02bb0>]}


============================== 07:27:18.422928 | 46d611ad-ef55-4c75-b8a9-47146d5af295 ==============================
[0m07:27:18.422928 [info ] [MainThread]: Running with dbt=1.8.7
[0m07:27:18.426744 [debug] [MainThread]: running dbt with arguments {'use_experimental_parser': 'False', 'printer_width': '80', 'warn_error': 'None', 'log_format': 'default', 'cache_selected_only': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'profiles_dir': '/opt/airflow/include/dbt/', 'empty': 'False', 'no_print': 'None', 'indirect_selection': 'eager', 'target_path': 'None', 'write_json': 'True', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/include/dbt/logs', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'partial_parse': 'True', 'use_colors': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/include/dbt/', 'debug': 'False', 'introspect': 'True', 'log_cache_events': 'False'}
[0m07:27:19.684663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '46d611ad-ef55-4c75-b8a9-47146d5af295', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d20e04fa0>]}
[0m07:27:19.851264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '46d611ad-ef55-4c75-b8a9-47146d5af295', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ced41cc40>]}
[0m07:27:19.855322 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m07:27:20.373488 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m07:27:23.574981 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m07:27:23.578361 [debug] [MainThread]: Partial parsing: updated file: nyc_taxi://models/transform/dim_time.sql
[0m07:27:24.420520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '46d611ad-ef55-4c75-b8a9-47146d5af295', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d1a349fa0>]}
[0m07:27:25.021324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '46d611ad-ef55-4c75-b8a9-47146d5af295', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d1aeb6b20>]}
[0m07:27:25.024760 [info ] [MainThread]: Found 3 models, 2 sources, 600 macros
[0m07:27:25.028079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '46d611ad-ef55-4c75-b8a9-47146d5af295', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d1aef8040>]}
[0m07:27:25.034127 [info ] [MainThread]: 
[0m07:27:25.038271 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m07:27:25.056768 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_northern-shield-437204-m0'
[0m07:27:25.060550 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:27:25.738519 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_northern-shield-437204-m0, now list_northern-shield-437204-m0_nyc_taxi)
[0m07:27:25.742653 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:27:26.464792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '46d611ad-ef55-4c75-b8a9-47146d5af295', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d21c013d0>]}
[0m07:27:26.469097 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:27:26.473382 [info ] [MainThread]: 
[0m07:27:26.495041 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_time
[0m07:27:26.499205 [info ] [Thread-1  ]: 1 of 3 START sql table model nyc_taxi.dim_time ................................. [RUN]
[0m07:27:26.504958 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_northern-shield-437204-m0_nyc_taxi, now model.nyc_taxi.dim_time)
[0m07:27:26.511736 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_time
[0m07:27:26.550605 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_time"
[0m07:27:26.573902 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_time
[0m07:27:26.626484 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:27:27.333848 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.dim_time"
[0m07:27:27.358492 [debug] [Thread-1  ]: On model.nyc_taxi.dim_time: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.dim_time"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`dim_time`
      
    
    

    OPTIONS()
    as (
      WITH datetime_cte AS (
    SELECT DISTINCT
        ROW_NUMBER() OVER () AS time_id,
        DATE(lpep_pickup_datetime) AS date,
        lpep_pickup_datetime AS date_part 
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata`
)
SELECT
    time_id,
    date,
    EXTRACT(YEAR FROM date_part) AS year,
    EXTRACT(MONTH FROM date_part) AS month,
    EXTRACT(DAY FROM date_part) AS day,
    EXTRACT(HOUR FROM date_part) AS hour,
    EXTRACT(MINUTE FROM date_part) AS minute,
    FORMAT_TIMESTAMP('%A', date_part) AS weekday,
    TIMESTAMP_TRUNC(date_part, HOUR) AS time
FROM datetime_cte
    );
  
[0m07:27:28.291754 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:ec0fd516-33e6-44e3-ac0d-fef5350f9e96&page=queryresults
[0m07:27:34.079222 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '46d611ad-ef55-4c75-b8a9-47146d5af295', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ced41c940>]}
[0m07:27:34.085014 [info ] [Thread-1  ]: 1 of 3 OK created sql table model nyc_taxi.dim_time ............................ [[32mCREATE TABLE (180.8k rows, 1.4 MiB processed)[0m in 7.57s]
[0m07:27:34.090595 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_time
[0m07:27:34.094851 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_zone
[0m07:27:34.099038 [info ] [Thread-1  ]: 2 of 3 START sql table model nyc_taxi.dim_zone ................................. [RUN]
[0m07:27:34.103124 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_time, now model.nyc_taxi.dim_zone)
[0m07:27:34.107353 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_zone
[0m07:27:34.124622 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_zone"
[0m07:27:34.145477 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_zone
[0m07:27:34.156955 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:27:34.871105 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.dim_zone"
[0m07:27:34.894837 [debug] [Thread-1  ]: On model.nyc_taxi.dim_zone: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.dim_zone"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`dim_zone`
      
    
    

    OPTIONS()
    as (
      SELECT
    location_id,
    borough,
    zone,
    replace(service_zone, 'Boro', 'Green') as service_zone
FROM `northern-shield-437204-m0`.`nyc_taxi`.`zone_map`
    );
  
[0m07:27:35.514843 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:7c9e3925-4b53-4440-bba3-d7d99daf8605&page=queryresults
[0m07:27:38.323330 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '46d611ad-ef55-4c75-b8a9-47146d5af295', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d1a2a1be0>]}
[0m07:27:38.327776 [info ] [Thread-1  ]: 2 of 3 OK created sql table model nyc_taxi.dim_zone ............................ [[32mCREATE TABLE (265.0 rows, 12.1 KiB processed)[0m in 4.22s]
[0m07:27:38.332080 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_zone
[0m07:27:38.335672 [debug] [Thread-1  ]: Began running node model.nyc_taxi.fct_trips
[0m07:27:38.339766 [info ] [Thread-1  ]: 3 of 3 START sql table model nyc_taxi.fct_trips ................................ [RUN]
[0m07:27:38.343246 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_zone, now model.nyc_taxi.fct_trips)
[0m07:27:38.346248 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.fct_trips
[0m07:27:38.365877 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.fct_trips"
[0m07:27:38.388527 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.fct_trips
[0m07:27:38.400811 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.fct_trips"
[0m07:27:38.426374 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:27:38.438068 [debug] [Thread-1  ]: On model.nyc_taxi.fct_trips: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.fct_trips"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips`
      
    
    

    OPTIONS()
    as (
      WITH tripdata_cte AS (
    SELECT 
        t.trip_id,
        t.vendor_id,
        t.lpep_pickup_datetime,
        t.lpep_dropoff_datetime,
        td_pickup.time_id AS pickup_time_id,
        td_dropoff.time_id AS dropoff_time_id,
        t.pu_location_id,
        t.do_location_id,
        t.passenger_count,
        t.trip_distance,
        t.fare_amount,
        t.extra,
        t.mta_tax,
        t.tip_amount,
        t.tolls_amount,
        t.ehail_fee,
        t.improvement_surcharge,
        t.total_amount,
        t.payment_type,
        t.trip_type,
        t.congestion_surcharge
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata` AS t
    LEFT JOIN `northern-shield-437204-m0`.`nyc_taxi`.`dim_time` AS td_pickup
        ON TIMESTAMP_TRUNC(t.lpep_pickup_datetime, HOUR) = td_pickup.time
    LEFT JOIN `northern-shield-437204-m0`.`nyc_taxi`.`dim_time` AS td_dropoff
        ON TIMESTAMP_TRUNC(t.lpep_dropoff_datetime, HOUR) = td_dropoff.time
)

SELECT 
    trip_id,
    vendor_id,
    pickup_time_id,
    dropoff_time_id,
    pu_location_id,
    do_location_id,
    passenger_count,
    trip_distance,
    fare_amount,
    extra,
    mta_tax,
    tip_amount,
    tolls_amount,
    ehail_fee,
    improvement_surcharge,
    total_amount,
    payment_type,
    trip_type,
    congestion_surcharge
FROM tripdata_cte
    );
  
[0m07:27:39.397844 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:70f1c39b-5e6d-4c23-8ed2-6b34ba0503f1&page=queryresults
[0m07:27:39.721570 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Name trip_id not found inside t at [15:11]; reason: invalidQuery, location: query, message: Name trip_id not found inside t at [15:11]')
[0m07:27:41.342288 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:4d0e6d46-0645-4c84-a673-6ee9344e4ff6&page=queryresults
[0m07:27:41.885299 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:4d0e6d46-0645-4c84-a673-6ee9344e4ff6&page=queryresults
[0m07:27:41.897875 [debug] [Thread-1  ]: Database Error in model fct_trips (models/transform/fct_trips.sql)
  Name trip_id not found inside t at [15:11]
  compiled code at target/run/nyc_taxi/models/transform/fct_trips.sql
[0m07:27:41.901697 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '46d611ad-ef55-4c75-b8a9-47146d5af295', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cec698e20>]}
[0m07:27:41.905716 [error] [Thread-1  ]: 3 of 3 ERROR creating sql table model nyc_taxi.fct_trips ....................... [[31mERROR[0m in 3.56s]
[0m07:27:41.910780 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.fct_trips
[0m07:27:41.917956 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:27:41.921365 [debug] [MainThread]: Connection 'model.nyc_taxi.fct_trips' was properly closed.
[0m07:27:41.924404 [info ] [MainThread]: 
[0m07:27:41.927400 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 16.89 seconds (16.89s).
[0m07:27:41.937978 [debug] [MainThread]: Command end result
[0m07:27:42.129275 [info ] [MainThread]: 
[0m07:27:42.132285 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m07:27:42.135033 [info ] [MainThread]: 
[0m07:27:42.137895 [error] [MainThread]:   Database Error in model fct_trips (models/transform/fct_trips.sql)
  Name trip_id not found inside t at [15:11]
  compiled code at target/run/nyc_taxi/models/transform/fct_trips.sql
[0m07:27:42.141083 [info ] [MainThread]: 
[0m07:27:42.144445 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m07:27:42.149684 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 25.394075, "process_user_time": 11.231707, "process_kernel_time": 0.989321, "process_mem_max_rss": "227336", "process_in_blocks": "32", "command_success": false, "process_out_blocks": "0"}
[0m07:27:42.153756 [debug] [MainThread]: Command `dbt run` failed at 07:27:42.153285 after 25.40 seconds
[0m07:27:42.156465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d21b20640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ced41cc40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d1a349fa0>]}
[0m07:27:42.159476 [debug] [MainThread]: Flushing usage events
[0m07:28:49.079109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7786f15b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7765d3b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7765d3b20>]}


============================== 07:28:49.096098 | c7dd9f96-aae7-4f92-a595-b0f9c79d215d ==============================
[0m07:28:49.096098 [info ] [MainThread]: Running with dbt=1.8.7
[0m07:28:49.099800 [debug] [MainThread]: running dbt with arguments {'empty': 'False', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'use_experimental_parser': 'False', 'cache_selected_only': 'False', 'use_colors': 'True', 'indirect_selection': 'eager', 'introspect': 'True', 'log_cache_events': 'False', 'log_format': 'default', 'quiet': 'False', 'partial_parse': 'True', 'profiles_dir': '/opt/airflow/include/dbt/', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'version_check': 'True', 'log_path': '/opt/airflow/include/dbt/logs', 'debug': 'False', 'no_print': 'None', 'write_json': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/include/dbt/', 'printer_width': '80'}
[0m07:28:52.112208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c7dd9f96-aae7-4f92-a595-b0f9c79d215d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff776d65370>]}
[0m07:28:52.287686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c7dd9f96-aae7-4f92-a595-b0f9c79d215d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff73f1d86a0>]}
[0m07:28:52.292027 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m07:28:52.788239 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m07:28:55.672584 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m07:28:55.676983 [debug] [MainThread]: Partial parsing: updated file: nyc_taxi://models/transform/fct_trips.sql
[0m07:28:56.533346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c7dd9f96-aae7-4f92-a595-b0f9c79d215d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff770f44ee0>]}
[0m07:28:57.175497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c7dd9f96-aae7-4f92-a595-b0f9c79d215d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff771ba5e50>]}
[0m07:28:57.179566 [info ] [MainThread]: Found 3 models, 2 sources, 600 macros
[0m07:28:57.185046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c7dd9f96-aae7-4f92-a595-b0f9c79d215d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff771af8c10>]}
[0m07:28:57.192056 [info ] [MainThread]: 
[0m07:28:57.195578 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m07:28:57.212820 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_northern-shield-437204-m0'
[0m07:28:57.216482 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:28:57.894824 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_northern-shield-437204-m0, now list_northern-shield-437204-m0_nyc_taxi)
[0m07:28:57.899277 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:28:58.648787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c7dd9f96-aae7-4f92-a595-b0f9c79d215d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff77661d3a0>]}
[0m07:28:58.652634 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:28:58.655852 [info ] [MainThread]: 
[0m07:28:58.676968 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_time
[0m07:28:58.681319 [info ] [Thread-1  ]: 1 of 3 START sql table model nyc_taxi.dim_time ................................. [RUN]
[0m07:28:58.693262 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_northern-shield-437204-m0_nyc_taxi, now model.nyc_taxi.dim_time)
[0m07:28:58.696348 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_time
[0m07:28:58.732558 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_time"
[0m07:28:58.758581 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_time
[0m07:28:58.805913 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:28:59.493298 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.dim_time"
[0m07:28:59.512970 [debug] [Thread-1  ]: On model.nyc_taxi.dim_time: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.dim_time"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`dim_time`
      
    
    

    OPTIONS()
    as (
      WITH datetime_cte AS (
    SELECT DISTINCT
        ROW_NUMBER() OVER () AS time_id,
        DATE(lpep_pickup_datetime) AS date,
        lpep_pickup_datetime AS date_part 
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata`
)
SELECT
    time_id,
    date,
    EXTRACT(YEAR FROM date_part) AS year,
    EXTRACT(MONTH FROM date_part) AS month,
    EXTRACT(DAY FROM date_part) AS day,
    EXTRACT(HOUR FROM date_part) AS hour,
    EXTRACT(MINUTE FROM date_part) AS minute,
    FORMAT_TIMESTAMP('%A', date_part) AS weekday,
    TIMESTAMP_TRUNC(date_part, HOUR) AS time
FROM datetime_cte
    );
  
[0m07:29:00.152113 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:ecbcf5d2-aff0-4504-a8a3-f0cc1cca3e4c&page=queryresults
[0m07:29:04.519758 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c7dd9f96-aae7-4f92-a595-b0f9c79d215d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff73ff029d0>]}
[0m07:29:04.524800 [info ] [Thread-1  ]: 1 of 3 OK created sql table model nyc_taxi.dim_time ............................ [[32mCREATE TABLE (180.8k rows, 1.4 MiB processed)[0m in 5.82s]
[0m07:29:04.530045 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_time
[0m07:29:04.533813 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_zone
[0m07:29:04.537386 [info ] [Thread-1  ]: 2 of 3 START sql table model nyc_taxi.dim_zone ................................. [RUN]
[0m07:29:04.541109 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_time, now model.nyc_taxi.dim_zone)
[0m07:29:04.544686 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_zone
[0m07:29:04.581788 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_zone"
[0m07:29:04.602537 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_zone
[0m07:29:04.616014 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:29:05.328628 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.dim_zone"
[0m07:29:05.347057 [debug] [Thread-1  ]: On model.nyc_taxi.dim_zone: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.dim_zone"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`dim_zone`
      
    
    

    OPTIONS()
    as (
      SELECT
    location_id,
    borough,
    zone,
    replace(service_zone, 'Boro', 'Green') as service_zone
FROM `northern-shield-437204-m0`.`nyc_taxi`.`zone_map`
    );
  
[0m07:29:05.972089 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:810e69ad-4c14-4495-880f-4535c98efd9c&page=queryresults
[0m07:29:08.672302 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c7dd9f96-aae7-4f92-a595-b0f9c79d215d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff770f2d2b0>]}
[0m07:29:08.676876 [info ] [Thread-1  ]: 2 of 3 OK created sql table model nyc_taxi.dim_zone ............................ [[32mCREATE TABLE (265.0 rows, 12.1 KiB processed)[0m in 4.13s]
[0m07:29:08.681620 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_zone
[0m07:29:08.685401 [debug] [Thread-1  ]: Began running node model.nyc_taxi.fct_trips
[0m07:29:08.689217 [info ] [Thread-1  ]: 3 of 3 START sql table model nyc_taxi.fct_trips ................................ [RUN]
[0m07:29:08.693503 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_zone, now model.nyc_taxi.fct_trips)
[0m07:29:08.696930 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.fct_trips
[0m07:29:08.722641 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.fct_trips"
[0m07:29:08.746431 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.fct_trips
[0m07:29:08.760984 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.fct_trips"
[0m07:29:08.785380 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:29:08.796451 [debug] [Thread-1  ]: On model.nyc_taxi.fct_trips: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.fct_trips"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips`
      
    
    

    OPTIONS()
    as (
      WITH tripdata_cte AS (
    SELECT 
        ROW_NUMBER() OVER () AS trip_id,
        t.vendor_id,
        t.lpep_pickup_datetime,
        t.lpep_dropoff_datetime,
        td_pickup.time_id AS pickup_time_id,
        td_dropoff.time_id AS dropoff_time_id,
        t.pu_location_id,
        t.do_location_id,
        t.passenger_count,
        t.trip_distance,
        t.fare_amount,
        t.extra,
        t.mta_tax,
        t.tip_amount,
        t.tolls_amount,
        t.ehail_fee,
        t.improvement_surcharge,
        t.total_amount,
        t.payment_type,
        t.trip_type,
        t.congestion_surcharge
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata` AS t
    LEFT JOIN `northern-shield-437204-m0`.`nyc_taxi`.`dim_time` AS td_pickup
        ON TIMESTAMP_TRUNC(t.lpep_pickup_datetime, HOUR) = td_pickup.time
    LEFT JOIN `northern-shield-437204-m0`.`nyc_taxi`.`dim_time` AS td_dropoff
        ON TIMESTAMP_TRUNC(t.lpep_dropoff_datetime, HOUR) = td_dropoff.time
)

SELECT 
    trip_id,
    vendor_id,
    pickup_time_id,
    dropoff_time_id,
    pu_location_id,
    do_location_id,
    passenger_count,
    trip_distance,
    fare_amount,
    extra,
    mta_tax,
    tip_amount,
    tolls_amount,
    ehail_fee,
    improvement_surcharge,
    total_amount,
    payment_type,
    trip_type,
    congestion_surcharge
FROM tripdata_cte
    );
  
[0m07:29:09.746565 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:cff8702c-359d-4191-ad00-2f08d268f979&page=queryresults
[0m07:34:01.096172 [debug] [Thread-1  ]: BigQuery adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.fct_trips"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips`
      
    
    

    OPTIONS()
    as (
      WITH tripdata_cte AS (
    SELECT 
        ROW_NUMBER() OVER () AS trip_id,
        t.vendor_id,
        t.lpep_pickup_datetime,
        t.lpep_dropoff_datetime,
        td_pickup.time_id AS pickup_time_id,
        td_dropoff.time_id AS dropoff_time_id,
        t.pu_location_id,
        t.do_location_id,
        t.passenger_count,
        t.trip_distance,
        t.fare_amount,
        t.extra,
        t.mta_tax,
        t.tip_amount,
        t.tolls_amount,
        t.ehail_fee,
        t.improvement_surcharge,
        t.total_amount,
        t.payment_type,
        t.trip_type,
        t.congestion_surcharge
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata` AS t
    LEFT JOIN `northern-shield-437204-m0`.`nyc_taxi`.`dim_time` AS td_pickup
        ON TIMESTAMP_TRUNC(t.lpep_pickup_datetime, HOUR) = td_pickup.time
    LEFT JOIN `northern-shield-437204-m0`.`nyc_taxi`.`dim_time` AS td_dropoff
        ON TIMESTAMP_TRUNC(t.lpep_dropoff_datetime, HOUR) = td_dropoff.time
)

SELECT 
    trip_id,
    vendor_id,
    pickup_time_id,
    dropoff_time_id,
    pu_location_id,
    do_location_id,
    passenger_count,
    trip_distance,
    fare_amount,
    extra,
    mta_tax,
    tip_amount,
    tolls_amount,
    ehail_fee,
    improvement_surcharge,
    total_amount,
    payment_type,
    trip_type,
    congestion_surcharge
FROM tripdata_cte
    );
  
[0m07:34:01.102043 [debug] [Thread-1  ]: BigQuery adapter: Operation did not complete within the designated timeout of 300 seconds.
[0m07:34:01.115886 [debug] [Thread-1  ]: Runtime Error in model fct_trips (models/transform/fct_trips.sql)
  Operation did not complete within the designated timeout of 300 seconds.
[0m07:34:01.120344 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c7dd9f96-aae7-4f92-a595-b0f9c79d215d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff771af6c10>]}
[0m07:34:01.127930 [error] [Thread-1  ]: 3 of 3 ERROR creating sql table model nyc_taxi.fct_trips ....................... [[31mERROR[0m in 292.43s]
[0m07:34:01.135452 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.fct_trips
[0m07:34:01.145936 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:34:01.149080 [debug] [MainThread]: Connection 'model.nyc_taxi.fct_trips' was properly closed.
[0m07:34:01.152767 [info ] [MainThread]: 
[0m07:34:01.158114 [info ] [MainThread]: Finished running 3 table models in 0 hours 5 minutes and 3.96 seconds (303.96s).
[0m07:34:01.166470 [debug] [MainThread]: Command end result
[0m07:34:01.408571 [info ] [MainThread]: 
[0m07:34:01.412750 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m07:34:01.416272 [info ] [MainThread]: 
[0m07:34:01.419905 [error] [MainThread]:   Runtime Error in model fct_trips (models/transform/fct_trips.sql)
  Operation did not complete within the designated timeout of 300 seconds.
[0m07:34:01.423199 [info ] [MainThread]: 
[0m07:34:01.427113 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m07:34:01.432586 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 329.43057, "process_user_time": 12.188147, "process_kernel_time": 0.909563, "process_mem_max_rss": "227608", "process_in_blocks": "816", "command_success": false, "process_out_blocks": "0"}
[0m07:34:01.436683 [debug] [MainThread]: Command `dbt run` failed at 07:34:01.436032 after 329.43 seconds
[0m07:34:01.440957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7786f15b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff73f1d86a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff770e51d90>]}
[0m07:34:01.444150 [debug] [MainThread]: Flushing usage events
[0m07:35:19.428627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa74ad65580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa748c47b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa748c47af0>]}


============================== 07:35:19.445104 | 3d62c2ce-a599-45dd-bafa-c1a9768ac1d2 ==============================
[0m07:35:19.445104 [info ] [MainThread]: Running with dbt=1.8.7
[0m07:35:19.449515 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run --profiles-dir /opt/airflow/include/dbt/', 'cache_selected_only': 'False', 'partial_parse': 'True', 'log_format': 'default', 'fail_fast': 'False', 'no_print': 'None', 'debug': 'False', 'target_path': 'None', 'profiles_dir': '/opt/airflow/include/dbt/', 'introspect': 'True', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'warn_error': 'None', 'quiet': 'False', 'empty': 'False', 'printer_width': '80', 'write_json': 'True', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'version_check': 'True', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'log_path': '/opt/airflow/include/dbt/logs', 'static_parser': 'True'}
[0m07:35:22.015518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3d62c2ce-a599-45dd-bafa-c1a9768ac1d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7125fb9d0>]}
[0m07:35:22.175360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3d62c2ce-a599-45dd-bafa-c1a9768ac1d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa711916610>]}
[0m07:35:22.178627 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m07:35:22.685204 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m07:35:24.224182 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:35:24.227605 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:35:24.351478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3d62c2ce-a599-45dd-bafa-c1a9768ac1d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7440a3130>]}
[0m07:35:24.727195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3d62c2ce-a599-45dd-bafa-c1a9768ac1d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7440523d0>]}
[0m07:35:24.731522 [info ] [MainThread]: Found 3 models, 2 sources, 600 macros
[0m07:35:24.736067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3d62c2ce-a599-45dd-bafa-c1a9768ac1d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7440b0dc0>]}
[0m07:35:24.742558 [info ] [MainThread]: 
[0m07:35:24.746272 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m07:35:24.762804 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_northern-shield-437204-m0'
[0m07:35:24.766773 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:35:25.518230 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_northern-shield-437204-m0, now list_northern-shield-437204-m0_nyc_taxi)
[0m07:35:25.521825 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:35:26.120927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3d62c2ce-a599-45dd-bafa-c1a9768ac1d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7440b0dc0>]}
[0m07:35:26.125188 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:35:26.127955 [info ] [MainThread]: 
[0m07:35:26.149503 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_time
[0m07:35:26.154136 [info ] [Thread-1  ]: 1 of 3 START sql table model nyc_taxi.dim_time ................................. [RUN]
[0m07:35:26.157378 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_northern-shield-437204-m0_nyc_taxi, now model.nyc_taxi.dim_time)
[0m07:35:26.160687 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_time
[0m07:35:26.200864 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_time"
[0m07:35:26.224501 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_time
[0m07:35:26.274512 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:35:26.991615 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.dim_time"
[0m07:35:27.014766 [debug] [Thread-1  ]: On model.nyc_taxi.dim_time: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.dim_time"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`dim_time`
      
    
    

    OPTIONS()
    as (
      WITH datetime_cte AS (
    SELECT DISTINCT
        ROW_NUMBER() OVER () AS time_id,
        DATE(lpep_pickup_datetime) AS date,
        lpep_pickup_datetime AS date_part 
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata`
)
SELECT
    time_id,
    date,
    EXTRACT(YEAR FROM date_part) AS year,
    EXTRACT(MONTH FROM date_part) AS month,
    EXTRACT(DAY FROM date_part) AS day,
    EXTRACT(HOUR FROM date_part) AS hour,
    EXTRACT(MINUTE FROM date_part) AS minute,
    FORMAT_TIMESTAMP('%A', date_part) AS weekday,
    TIMESTAMP_TRUNC(date_part, HOUR) AS time
FROM datetime_cte
    );
  
[0m07:35:27.781544 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:654b43a9-7126-4bdf-8a9b-8c6965d57917&page=queryresults
[0m07:35:31.938152 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3d62c2ce-a599-45dd-bafa-c1a9768ac1d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7125fb670>]}
[0m07:35:31.943459 [info ] [Thread-1  ]: 1 of 3 OK created sql table model nyc_taxi.dim_time ............................ [[32mCREATE TABLE (180.8k rows, 1.4 MiB processed)[0m in 5.78s]
[0m07:35:31.948417 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_time
[0m07:35:31.952687 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_zone
[0m07:35:31.956383 [info ] [Thread-1  ]: 2 of 3 START sql table model nyc_taxi.dim_zone ................................. [RUN]
[0m07:35:31.961050 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_time, now model.nyc_taxi.dim_zone)
[0m07:35:31.964075 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_zone
[0m07:35:31.979041 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_zone"
[0m07:35:32.010662 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_zone
[0m07:35:32.031061 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:35:32.747803 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.dim_zone"
[0m07:35:32.777178 [debug] [Thread-1  ]: On model.nyc_taxi.dim_zone: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.dim_zone"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`dim_zone`
      
    
    

    OPTIONS()
    as (
      SELECT
    location_id,
    borough,
    zone,
    replace(service_zone, 'Boro', 'Green') as service_zone
FROM `northern-shield-437204-m0`.`nyc_taxi`.`zone_map`
    );
  
[0m07:35:33.394983 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:28bfeff8-5112-46bd-8211-3b714687c3a6&page=queryresults
[0m07:35:35.582415 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3d62c2ce-a599-45dd-bafa-c1a9768ac1d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa743fbf760>]}
[0m07:35:35.587252 [info ] [Thread-1  ]: 2 of 3 OK created sql table model nyc_taxi.dim_zone ............................ [[32mCREATE TABLE (265.0 rows, 12.1 KiB processed)[0m in 3.62s]
[0m07:35:35.592823 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_zone
[0m07:35:35.596551 [debug] [Thread-1  ]: Began running node model.nyc_taxi.fct_trips
[0m07:35:35.600521 [info ] [Thread-1  ]: 3 of 3 START sql table model nyc_taxi.fct_trips ................................ [RUN]
[0m07:35:35.604617 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_zone, now model.nyc_taxi.fct_trips)
[0m07:35:35.608207 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.fct_trips
[0m07:35:35.629320 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.fct_trips"
[0m07:35:35.654835 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.fct_trips
[0m07:35:35.669494 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.fct_trips"
[0m07:35:35.694588 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:35:35.709564 [debug] [Thread-1  ]: On model.nyc_taxi.fct_trips: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.fct_trips"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips`
      
    
    

    OPTIONS()
    as (
      WITH tripdata_cte AS (
    SELECT 
        ROW_NUMBER() OVER () AS trip_id,
        t.vendor_id,
        t.lpep_pickup_datetime,
        t.lpep_dropoff_datetime,
        td_pickup.time_id AS pickup_time_id,
        td_dropoff.time_id AS dropoff_time_id,
        t.pu_location_id,
        t.do_location_id,
        t.passenger_count,
        t.trip_distance,
        t.fare_amount,
        t.extra,
        t.mta_tax,
        t.tip_amount,
        t.tolls_amount,
        t.ehail_fee,
        t.improvement_surcharge,
        t.total_amount,
        t.payment_type,
        t.trip_type,
        t.congestion_surcharge
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata` AS t
    LEFT JOIN `northern-shield-437204-m0`.`nyc_taxi`.`dim_time` AS td_pickup
        ON TIMESTAMP_TRUNC(t.lpep_pickup_datetime, HOUR) = td_pickup.time
    LEFT JOIN `northern-shield-437204-m0`.`nyc_taxi`.`dim_time` AS td_dropoff
        ON TIMESTAMP_TRUNC(t.lpep_dropoff_datetime, HOUR) = td_dropoff.time
)

SELECT 
    trip_id,
    vendor_id,
    pickup_time_id,
    dropoff_time_id,
    pu_location_id,
    do_location_id,
    passenger_count,
    trip_distance,
    fare_amount,
    extra,
    mta_tax,
    tip_amount,
    tolls_amount,
    ehail_fee,
    improvement_surcharge,
    total_amount,
    payment_type,
    trip_type,
    congestion_surcharge
FROM tripdata_cte
    );
  
[0m07:35:36.640201 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:b8a2c97c-bf72-471b-90dc-448527ebee42&page=queryresults
[0m07:40:29.533767 [debug] [Thread-1  ]: BigQuery adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.fct_trips"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips`
      
    
    

    OPTIONS()
    as (
      WITH tripdata_cte AS (
    SELECT 
        ROW_NUMBER() OVER () AS trip_id,
        t.vendor_id,
        t.lpep_pickup_datetime,
        t.lpep_dropoff_datetime,
        td_pickup.time_id AS pickup_time_id,
        td_dropoff.time_id AS dropoff_time_id,
        t.pu_location_id,
        t.do_location_id,
        t.passenger_count,
        t.trip_distance,
        t.fare_amount,
        t.extra,
        t.mta_tax,
        t.tip_amount,
        t.tolls_amount,
        t.ehail_fee,
        t.improvement_surcharge,
        t.total_amount,
        t.payment_type,
        t.trip_type,
        t.congestion_surcharge
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata` AS t
    LEFT JOIN `northern-shield-437204-m0`.`nyc_taxi`.`dim_time` AS td_pickup
        ON TIMESTAMP_TRUNC(t.lpep_pickup_datetime, HOUR) = td_pickup.time
    LEFT JOIN `northern-shield-437204-m0`.`nyc_taxi`.`dim_time` AS td_dropoff
        ON TIMESTAMP_TRUNC(t.lpep_dropoff_datetime, HOUR) = td_dropoff.time
)

SELECT 
    trip_id,
    vendor_id,
    pickup_time_id,
    dropoff_time_id,
    pu_location_id,
    do_location_id,
    passenger_count,
    trip_distance,
    fare_amount,
    extra,
    mta_tax,
    tip_amount,
    tolls_amount,
    ehail_fee,
    improvement_surcharge,
    total_amount,
    payment_type,
    trip_type,
    congestion_surcharge
FROM tripdata_cte
    );
  
[0m07:40:29.538573 [debug] [Thread-1  ]: BigQuery adapter: Operation did not complete within the designated timeout of 300 seconds.
[0m07:40:29.553021 [debug] [Thread-1  ]: Runtime Error in model fct_trips (models/transform/fct_trips.sql)
  Operation did not complete within the designated timeout of 300 seconds.
[0m07:40:29.557317 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3d62c2ce-a599-45dd-bafa-c1a9768ac1d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa743f3d730>]}
[0m07:40:29.561978 [error] [Thread-1  ]: 3 of 3 ERROR creating sql table model nyc_taxi.fct_trips ....................... [[31mERROR[0m in 293.95s]
[0m07:40:29.566896 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.fct_trips
[0m07:40:29.574774 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:40:29.578335 [debug] [MainThread]: Connection 'model.nyc_taxi.fct_trips' was properly closed.
[0m07:40:29.582184 [info ] [MainThread]: 
[0m07:40:29.586360 [info ] [MainThread]: Finished running 3 table models in 0 hours 5 minutes and 4.84 seconds (304.84s).
[0m07:40:29.595630 [debug] [MainThread]: Command end result
[0m07:40:30.099723 [info ] [MainThread]: 
[0m07:40:30.102978 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m07:40:30.106123 [info ] [MainThread]: 
[0m07:40:30.109383 [error] [MainThread]:   Runtime Error in model fct_trips (models/transform/fct_trips.sql)
  Operation did not complete within the designated timeout of 300 seconds.
[0m07:40:30.113818 [info ] [MainThread]: 
[0m07:40:30.117336 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m07:40:30.122635 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 327.99435, "process_user_time": 11.080458, "process_kernel_time": 0.853835, "process_mem_max_rss": "225344", "process_in_blocks": "1024", "command_success": false, "process_out_blocks": "0"}
[0m07:40:30.126582 [debug] [MainThread]: Command `dbt run` failed at 07:40:30.126049 after 328.00 seconds
[0m07:40:30.130595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa74ad65580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa71247e400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa71246e370>]}
[0m07:40:30.134122 [debug] [MainThread]: Flushing usage events
[0m07:44:01.203670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16f31a65e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16f1089b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16f1089b20>]}


============================== 07:44:01.219451 | 7e70a9a5-cd41-4b4d-8bb2-4f13e27ecabc ==============================
[0m07:44:01.219451 [info ] [MainThread]: Running with dbt=1.8.7
[0m07:44:01.223184 [debug] [MainThread]: running dbt with arguments {'profiles_dir': '/opt/airflow/include/dbt/', 'use_colors': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/include/dbt/', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'cache_selected_only': 'False', 'log_path': '/opt/airflow/include/dbt/logs', 'fail_fast': 'False', 'static_parser': 'True', 'target_path': 'None', 'debug': 'False', 'use_experimental_parser': 'False', 'empty': 'False', 'printer_width': '80', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'no_print': 'None', 'warn_error': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'quiet': 'False', 'write_json': 'True', 'version_check': 'True'}
[0m07:44:04.259680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7e70a9a5-cd41-4b4d-8bb2-4f13e27ecabc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16f3551190>]}
[0m07:44:04.418675 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7e70a9a5-cd41-4b4d-8bb2-4f13e27ecabc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16f1e0c9d0>]}
[0m07:44:04.422810 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m07:44:04.905037 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m07:44:05.255910 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m07:44:05.259679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '7e70a9a5-cd41-4b4d-8bb2-4f13e27ecabc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16f1dc8550>]}
[0m07:44:12.316072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7e70a9a5-cd41-4b4d-8bb2-4f13e27ecabc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16eb9db130>]}
[0m07:44:12.748965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7e70a9a5-cd41-4b4d-8bb2-4f13e27ecabc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16eb8eed60>]}
[0m07:44:12.751825 [info ] [MainThread]: Found 3 models, 2 sources, 600 macros
[0m07:44:12.755859 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7e70a9a5-cd41-4b4d-8bb2-4f13e27ecabc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16eb9f6eb0>]}
[0m07:44:12.762275 [info ] [MainThread]: 
[0m07:44:12.766872 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m07:44:12.785077 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_northern-shield-437204-m0'
[0m07:44:12.788604 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:44:13.459756 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_northern-shield-437204-m0, now list_northern-shield-437204-m0_nyc_taxi)
[0m07:44:13.463614 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:44:14.187642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7e70a9a5-cd41-4b4d-8bb2-4f13e27ecabc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16ba9191c0>]}
[0m07:44:14.191558 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:44:14.194939 [info ] [MainThread]: 
[0m07:44:14.218784 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_time
[0m07:44:14.223460 [info ] [Thread-1  ]: 1 of 3 START sql table model nyc_taxi.dim_time ................................. [RUN]
[0m07:44:14.227338 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_northern-shield-437204-m0_nyc_taxi, now model.nyc_taxi.dim_time)
[0m07:44:14.230705 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_time
[0m07:44:14.262455 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_time"
[0m07:44:14.286447 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_time
[0m07:44:14.336690 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:44:15.137991 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.dim_time"
[0m07:44:15.188864 [debug] [Thread-1  ]: On model.nyc_taxi.dim_time: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.dim_time"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`dim_time`
      
    
    

    OPTIONS()
    as (
      WITH datetime_cte AS (
    SELECT DISTINCT
        ROW_NUMBER() OVER () AS time_id,
        DATE(lpep_pickup_datetime) AS date,
        lpep_pickup_datetime AS date_part 
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata`
)
SELECT
    time_id,
    date,
    EXTRACT(YEAR FROM date_part) AS year,
    EXTRACT(MONTH FROM date_part) AS month,
    EXTRACT(DAY FROM date_part) AS day,
    EXTRACT(HOUR FROM date_part) AS hour,
    EXTRACT(MINUTE FROM date_part) AS minute,
    FORMAT_TIMESTAMP('%A', date_part) AS weekday,
    TIMESTAMP_TRUNC(date_part, HOUR) AS time
FROM datetime_cte
    );
  
[0m07:44:15.910594 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:67544b94-eaf4-4e5f-bd9a-fd2d5af1896d&page=queryresults
[0m07:44:19.750578 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7e70a9a5-cd41-4b4d-8bb2-4f13e27ecabc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16eb8fa070>]}
[0m07:44:19.754861 [info ] [Thread-1  ]: 1 of 3 OK created sql table model nyc_taxi.dim_time ............................ [[32mCREATE TABLE (180.8k rows, 1.4 MiB processed)[0m in 5.52s]
[0m07:44:19.759473 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_time
[0m07:44:19.763200 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_zone
[0m07:44:19.767168 [info ] [Thread-1  ]: 2 of 3 START sql table model nyc_taxi.dim_zone ................................. [RUN]
[0m07:44:19.772030 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_time, now model.nyc_taxi.dim_zone)
[0m07:44:19.775151 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_zone
[0m07:44:19.788864 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_zone"
[0m07:44:19.814276 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_zone
[0m07:44:19.833347 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:44:20.557633 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.dim_zone"
[0m07:44:20.579937 [debug] [Thread-1  ]: On model.nyc_taxi.dim_zone: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.dim_zone"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`dim_zone`
      
    
    

    OPTIONS()
    as (
      SELECT
    location_id,
    borough,
    zone,
    replace(service_zone, 'Boro', 'Green') as service_zone
FROM `northern-shield-437204-m0`.`nyc_taxi`.`zone_map`
    );
  
[0m07:44:21.151019 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:f53d8ee6-cbc2-428d-9cab-f0ecd43d0de3&page=queryresults
[0m07:44:23.691045 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7e70a9a5-cd41-4b4d-8bb2-4f13e27ecabc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16e91a0340>]}
[0m07:44:23.695623 [info ] [Thread-1  ]: 2 of 3 OK created sql table model nyc_taxi.dim_zone ............................ [[32mCREATE TABLE (265.0 rows, 12.1 KiB processed)[0m in 3.92s]
[0m07:44:23.712611 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_zone
[0m07:44:23.717412 [debug] [Thread-1  ]: Began running node model.nyc_taxi.fct_trips
[0m07:44:23.721663 [info ] [Thread-1  ]: 3 of 3 START sql table model nyc_taxi.fct_trips ................................ [RUN]
[0m07:44:23.726465 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_zone, now model.nyc_taxi.fct_trips)
[0m07:44:23.730211 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.fct_trips
[0m07:44:23.752224 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.fct_trips"
[0m07:44:23.778571 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.fct_trips
[0m07:44:23.791673 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.fct_trips"
[0m07:44:23.843892 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:44:23.853844 [debug] [Thread-1  ]: On model.nyc_taxi.fct_trips: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.fct_trips"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips`
      
    
    

    OPTIONS()
    as (
      WITH tripdata_cte AS (
    SELECT 
        ROW_NUMBER() OVER () AS trip_id,
        t.vendor_id,
        t.lpep_pickup_datetime,
        t.lpep_dropoff_datetime,
        td_pickup.time_id AS pickup_time_id,
        td_dropoff.time_id AS dropoff_time_id,
        t.pu_location_id,
        t.do_location_id,
        t.passenger_count,
        t.trip_distance,
        t.fare_amount,
        t.extra,
        t.mta_tax,
        t.tip_amount,
        t.tolls_amount,
        t.ehail_fee,
        t.improvement_surcharge,
        t.total_amount,
        t.payment_type,
        t.trip_type,
        t.congestion_surcharge
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata` AS t
    LEFT JOIN `northern-shield-437204-m0`.`nyc_taxi`.`dim_time` AS td_pickup
        ON TIMESTAMP_TRUNC(t.lpep_pickup_datetime, HOUR) = td_pickup.time
    LEFT JOIN `northern-shield-437204-m0`.`nyc_taxi`.`dim_time` AS td_dropoff
        ON TIMESTAMP_TRUNC(t.lpep_dropoff_datetime, HOUR) = td_dropoff.time
)

SELECT 
    trip_id,
    vendor_id,
    pickup_time_id,
    dropoff_time_id,
    pu_location_id,
    do_location_id,
    passenger_count,
    trip_distance,
    fare_amount,
    extra,
    mta_tax,
    tip_amount,
    tolls_amount,
    ehail_fee,
    improvement_surcharge,
    total_amount,
    payment_type,
    trip_type,
    congestion_surcharge
FROM tripdata_cte
    );
  
[0m07:44:23.171562 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:3c247c6c-a5cd-4477-a99b-ea93655fe976&page=queryresults
[0m07:53:58.434319 [debug] [Thread-1  ]: BigQuery adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.fct_trips"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips`
      
    
    

    OPTIONS()
    as (
      WITH tripdata_cte AS (
    SELECT 
        ROW_NUMBER() OVER () AS trip_id,
        t.vendor_id,
        t.lpep_pickup_datetime,
        t.lpep_dropoff_datetime,
        td_pickup.time_id AS pickup_time_id,
        td_dropoff.time_id AS dropoff_time_id,
        t.pu_location_id,
        t.do_location_id,
        t.passenger_count,
        t.trip_distance,
        t.fare_amount,
        t.extra,
        t.mta_tax,
        t.tip_amount,
        t.tolls_amount,
        t.ehail_fee,
        t.improvement_surcharge,
        t.total_amount,
        t.payment_type,
        t.trip_type,
        t.congestion_surcharge
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata` AS t
    LEFT JOIN `northern-shield-437204-m0`.`nyc_taxi`.`dim_time` AS td_pickup
        ON TIMESTAMP_TRUNC(t.lpep_pickup_datetime, HOUR) = td_pickup.time
    LEFT JOIN `northern-shield-437204-m0`.`nyc_taxi`.`dim_time` AS td_dropoff
        ON TIMESTAMP_TRUNC(t.lpep_dropoff_datetime, HOUR) = td_dropoff.time
)

SELECT 
    trip_id,
    vendor_id,
    pickup_time_id,
    dropoff_time_id,
    pu_location_id,
    do_location_id,
    passenger_count,
    trip_distance,
    fare_amount,
    extra,
    mta_tax,
    tip_amount,
    tolls_amount,
    ehail_fee,
    improvement_surcharge,
    total_amount,
    payment_type,
    trip_type,
    congestion_surcharge
FROM tripdata_cte
    );
  
[0m07:53:58.439184 [debug] [Thread-1  ]: BigQuery adapter: Operation did not complete within the designated timeout of 600 seconds.
[0m07:53:58.449960 [debug] [Thread-1  ]: Runtime Error in model fct_trips (models/transform/fct_trips.sql)
  Operation did not complete within the designated timeout of 600 seconds.
[0m07:53:58.454154 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7e70a9a5-cd41-4b4d-8bb2-4f13e27ecabc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16e91b0880>]}
[0m07:53:58.459042 [error] [Thread-1  ]: 3 of 3 ERROR creating sql table model nyc_taxi.fct_trips ....................... [[31mERROR[0m in 574.73s]
[0m07:53:58.463907 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.fct_trips
[0m07:53:58.472622 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:53:58.475760 [debug] [MainThread]: Connection 'model.nyc_taxi.fct_trips' was properly closed.
[0m07:53:58.479658 [info ] [MainThread]: 
[0m07:53:58.487423 [info ] [MainThread]: Finished running 3 table models in 0 hours 9 minutes and 45.71 seconds (585.71s).
[0m07:53:58.497802 [debug] [MainThread]: Command end result
[0m07:53:58.720527 [info ] [MainThread]: 
[0m07:53:58.724155 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m07:53:58.727631 [info ] [MainThread]: 
[0m07:53:58.732092 [error] [MainThread]:   Runtime Error in model fct_trips (models/transform/fct_trips.sql)
  Operation did not complete within the designated timeout of 600 seconds.
[0m07:53:58.736515 [info ] [MainThread]: 
[0m07:53:58.740362 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m07:53:58.746420 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 631.006, "process_user_time": 16.013588, "process_kernel_time": 0.925529, "process_mem_max_rss": "232120", "process_in_blocks": "456", "command_success": false, "process_out_blocks": "0"}
[0m07:53:58.750800 [debug] [MainThread]: Command `dbt run` failed at 07:53:58.750317 after 631.01 seconds
[0m07:53:58.754830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16f31a65e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16f1e0c9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16b9c6adf0>]}
[0m07:53:58.758463 [debug] [MainThread]: Flushing usage events
[0m08:05:43.413430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc29f97640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc27e7ab20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc27e7aac0>]}


============================== 08:05:43.428565 | cac2e45a-03d9-41a7-a5c8-05cac053eb1e ==============================
[0m08:05:43.428565 [info ] [MainThread]: Running with dbt=1.8.7
[0m08:05:43.432742 [debug] [MainThread]: running dbt with arguments {'use_experimental_parser': 'False', 'log_format': 'default', 'no_print': 'None', 'fail_fast': 'False', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'empty': 'False', 'indirect_selection': 'eager', 'use_colors': 'True', 'cache_selected_only': 'False', 'log_path': '/opt/airflow/include/dbt/logs', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/include/dbt/', 'printer_width': '80', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'debug': 'False', 'version_check': 'True', 'log_cache_events': 'False', 'warn_error': 'None', 'profiles_dir': '/opt/airflow/include/dbt/', 'partial_parse': 'True', 'target_path': 'None', 'write_json': 'True'}
[0m08:05:46.210532 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cac2e45a-03d9-41a7-a5c8-05cac053eb1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbf1b8fa60>]}
[0m08:05:46.404301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cac2e45a-03d9-41a7-a5c8-05cac053eb1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc2826c310>]}
[0m08:05:46.408986 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m08:05:46.911655 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m08:05:50.137037 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m08:05:50.141192 [debug] [MainThread]: Partial parsing: updated file: nyc_taxi://models/transform/fct_trips.sql
[0m08:05:50.945660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cac2e45a-03d9-41a7-a5c8-05cac053eb1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc230e9130>]}
[0m08:05:51.521325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cac2e45a-03d9-41a7-a5c8-05cac053eb1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbf0a8b190>]}
[0m08:05:51.524547 [info ] [MainThread]: Found 3 models, 2 sources, 600 macros
[0m08:05:51.528443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cac2e45a-03d9-41a7-a5c8-05cac053eb1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc23233dc0>]}
[0m08:05:51.535733 [info ] [MainThread]: 
[0m08:05:51.540614 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m08:05:51.560490 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_northern-shield-437204-m0'
[0m08:05:51.564175 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:05:52.242868 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_northern-shield-437204-m0, now list_northern-shield-437204-m0_nyc_taxi)
[0m08:05:52.246859 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:05:52.940912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cac2e45a-03d9-41a7-a5c8-05cac053eb1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcbf0ab2d30>]}
[0m08:05:52.945283 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:05:52.949208 [info ] [MainThread]: 
[0m08:05:52.976747 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_time
[0m08:05:52.982217 [info ] [Thread-1  ]: 1 of 3 START sql table model nyc_taxi.dim_time ................................. [RUN]
[0m08:05:52.987559 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_northern-shield-437204-m0_nyc_taxi, now model.nyc_taxi.dim_time)
[0m08:05:52.992530 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_time
[0m08:05:53.041645 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_time"
[0m08:05:53.064911 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_time
[0m08:05:53.135400 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m08:05:53.873186 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.dim_time"
[0m08:05:53.892061 [debug] [Thread-1  ]: On model.nyc_taxi.dim_time: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.dim_time"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`dim_time`
      
    
    

    OPTIONS()
    as (
      WITH datetime_cte AS (
    SELECT DISTINCT
        ROW_NUMBER() OVER () AS time_id,
        DATE(lpep_pickup_datetime) AS date,
        lpep_pickup_datetime AS date_part 
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata`
)
SELECT
    time_id,
    date,
    EXTRACT(YEAR FROM date_part) AS year,
    EXTRACT(MONTH FROM date_part) AS month,
    EXTRACT(DAY FROM date_part) AS day,
    EXTRACT(HOUR FROM date_part) AS hour,
    EXTRACT(MINUTE FROM date_part) AS minute,
    FORMAT_TIMESTAMP('%A', date_part) AS weekday,
    TIMESTAMP_TRUNC(date_part, HOUR) AS time
FROM datetime_cte
    );
  
[0m08:05:54.559095 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:7751b855-adc7-4769-8557-e8428516e2ec&page=queryresults
[0m08:05:59.097745 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cac2e45a-03d9-41a7-a5c8-05cac053eb1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc284edc70>]}
[0m08:05:59.102346 [info ] [Thread-1  ]: 1 of 3 OK created sql table model nyc_taxi.dim_time ............................ [[32mCREATE TABLE (180.8k rows, 1.4 MiB processed)[0m in 6.11s]
[0m08:05:59.106864 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_time
[0m08:05:59.110521 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_zone
[0m08:05:59.114289 [info ] [Thread-1  ]: 2 of 3 START sql table model nyc_taxi.dim_zone ................................. [RUN]
[0m08:05:59.117670 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_time, now model.nyc_taxi.dim_zone)
[0m08:05:59.122185 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_zone
[0m08:05:59.147064 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_zone"
[0m08:05:59.167916 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_zone
[0m08:05:59.190582 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m08:05:59.834832 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.dim_zone"
[0m08:05:59.858436 [debug] [Thread-1  ]: On model.nyc_taxi.dim_zone: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.dim_zone"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`dim_zone`
      
    
    

    OPTIONS()
    as (
      SELECT
    location_id,
    borough,
    zone,
    replace(service_zone, 'Boro', 'Green') as service_zone
FROM `northern-shield-437204-m0`.`nyc_taxi`.`zone_map`
    );
  
[0m08:06:00.494520 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:6c59c2e7-191a-4703-8496-36fd3fd58a0f&page=queryresults
[0m08:06:03.533468 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cac2e45a-03d9-41a7-a5c8-05cac053eb1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc231a7790>]}
[0m08:06:03.542823 [info ] [Thread-1  ]: 2 of 3 OK created sql table model nyc_taxi.dim_zone ............................ [[32mCREATE TABLE (265.0 rows, 12.1 KiB processed)[0m in 4.42s]
[0m08:06:03.550804 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_zone
[0m08:06:03.555892 [debug] [Thread-1  ]: Began running node model.nyc_taxi.fct_trips
[0m08:06:03.560551 [info ] [Thread-1  ]: 3 of 3 START sql table model nyc_taxi.fct_trips ................................ [RUN]
[0m08:06:03.572033 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_zone, now model.nyc_taxi.fct_trips)
[0m08:06:03.576286 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.fct_trips
[0m08:06:03.614042 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.fct_trips"
[0m08:06:03.640202 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.fct_trips
[0m08:06:03.660940 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.fct_trips"
[0m08:06:03.687782 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m08:06:03.703526 [debug] [Thread-1  ]: On model.nyc_taxi.fct_trips: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.fct_trips"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips`
      
    
    

    OPTIONS()
    as (
      WITH tripdata_cte AS (
    SELECT 
        to_hex(md5(cast(coalesce(cast(vendor_id as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(lpep_pickup_datetime as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(lpep_dropoff_datetime as string), '_dbt_utils_surrogate_key_null_') as string)))  AS trip_id,
        t.vendor_id,
        t.lpep_pickup_datetime,
        t.lpep_dropoff_datetime,
        td_pickup.time_id AS pickup_time_id,
        td_dropoff.time_id AS dropoff_time_id,
        t.pu_location_id,
        t.do_location_id,
        t.passenger_count,
        t.trip_distance,
        t.fare_amount,
        t.extra,
        t.mta_tax,
        t.tip_amount,
        t.tolls_amount,
        t.ehail_fee,
        t.improvement_surcharge,
        t.total_amount,
        t.payment_type,
        t.trip_type,
        t.congestion_surcharge
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata` AS t
    LEFT JOIN `northern-shield-437204-m0`.`nyc_taxi`.`dim_time` AS td_pickup
        ON TIMESTAMP_TRUNC(t.lpep_pickup_datetime, HOUR) = td_pickup.time
    LEFT JOIN `northern-shield-437204-m0`.`nyc_taxi`.`dim_time` AS td_dropoff
        ON TIMESTAMP_TRUNC(t.lpep_dropoff_datetime, HOUR) = td_dropoff.time
)

SELECT 
    trip_id,
    vendor_id,
    pickup_time_id,
    dropoff_time_id,
    pu_location_id,
    do_location_id,
    passenger_count,
    trip_distance,
    fare_amount,
    extra,
    mta_tax,
    tip_amount,
    tolls_amount,
    ehail_fee,
    improvement_surcharge,
    total_amount,
    payment_type,
    trip_type,
    congestion_surcharge
FROM tripdata_cte
    );
  
[0m08:06:04.657925 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:72d93b3b-c0ef-4fda-acbe-8a54d5aab881&page=queryresults
[0m08:15:37.665593 [debug] [Thread-1  ]: BigQuery adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.fct_trips"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips`
      
    
    

    OPTIONS()
    as (
      WITH tripdata_cte AS (
    SELECT 
        to_hex(md5(cast(coalesce(cast(vendor_id as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(lpep_pickup_datetime as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(lpep_dropoff_datetime as string), '_dbt_utils_surrogate_key_null_') as string)))  AS trip_id,
        t.vendor_id,
        t.lpep_pickup_datetime,
        t.lpep_dropoff_datetime,
        td_pickup.time_id AS pickup_time_id,
        td_dropoff.time_id AS dropoff_time_id,
        t.pu_location_id,
        t.do_location_id,
        t.passenger_count,
        t.trip_distance,
        t.fare_amount,
        t.extra,
        t.mta_tax,
        t.tip_amount,
        t.tolls_amount,
        t.ehail_fee,
        t.improvement_surcharge,
        t.total_amount,
        t.payment_type,
        t.trip_type,
        t.congestion_surcharge
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata` AS t
    LEFT JOIN `northern-shield-437204-m0`.`nyc_taxi`.`dim_time` AS td_pickup
        ON TIMESTAMP_TRUNC(t.lpep_pickup_datetime, HOUR) = td_pickup.time
    LEFT JOIN `northern-shield-437204-m0`.`nyc_taxi`.`dim_time` AS td_dropoff
        ON TIMESTAMP_TRUNC(t.lpep_dropoff_datetime, HOUR) = td_dropoff.time
)

SELECT 
    trip_id,
    vendor_id,
    pickup_time_id,
    dropoff_time_id,
    pu_location_id,
    do_location_id,
    passenger_count,
    trip_distance,
    fare_amount,
    extra,
    mta_tax,
    tip_amount,
    tolls_amount,
    ehail_fee,
    improvement_surcharge,
    total_amount,
    payment_type,
    trip_type,
    congestion_surcharge
FROM tripdata_cte
    );
  
[0m08:15:37.668059 [debug] [Thread-1  ]: BigQuery adapter: Operation did not complete within the designated timeout of 600 seconds.
[0m08:15:37.673855 [debug] [Thread-1  ]: Runtime Error in model fct_trips (models/transform/fct_trips.sql)
  Operation did not complete within the designated timeout of 600 seconds.
[0m08:15:37.675769 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cac2e45a-03d9-41a7-a5c8-05cac053eb1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc2306b5e0>]}
[0m08:15:37.678029 [error] [Thread-1  ]: 3 of 3 ERROR creating sql table model nyc_taxi.fct_trips ....................... [[31mERROR[0m in 574.10s]
[0m08:15:37.680158 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.fct_trips
[0m08:15:37.684060 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:15:37.684910 [debug] [MainThread]: Connection 'model.nyc_taxi.fct_trips' was properly closed.
[0m08:15:37.685965 [info ] [MainThread]: 
[0m08:15:37.686984 [info ] [MainThread]: Finished running 3 table models in 0 hours 9 minutes and 46.15 seconds (586.15s).
[0m08:15:37.689586 [debug] [MainThread]: Command end result
[0m08:15:37.761751 [info ] [MainThread]: 
[0m08:15:37.763148 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m08:15:37.764242 [info ] [MainThread]: 
[0m08:15:37.765302 [error] [MainThread]:   Runtime Error in model fct_trips (models/transform/fct_trips.sql)
  Operation did not complete within the designated timeout of 600 seconds.
[0m08:15:37.766289 [info ] [MainThread]: 
[0m08:15:37.767339 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m08:15:37.769904 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 627.71045, "process_user_time": 11.605043, "process_kernel_time": 0.796048, "process_mem_max_rss": "228496", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m08:15:37.771648 [debug] [MainThread]: Command `dbt run` failed at 08:15:37.771418 after 627.71 seconds
[0m08:15:37.772712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc29f97640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc231d3850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc285f8820>]}
[0m08:15:37.773654 [debug] [MainThread]: Flushing usage events
[0m08:16:08.623044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8891dcf5b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f888fcb1a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f888fcb19d0>]}


============================== 08:16:08.629531 | f6d0c03e-6cde-42a0-9db0-062da48ede2c ==============================
[0m08:16:08.629531 [info ] [MainThread]: Running with dbt=1.8.7
[0m08:16:08.631053 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'cache_selected_only': 'False', 'use_colors': 'True', 'debug': 'False', 'write_json': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'no_print': 'None', 'quiet': 'False', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'empty': 'False', 'warn_error': 'None', 'version_check': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/include/dbt/', 'log_format': 'default', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'profiles_dir': '/opt/airflow/include/dbt/', 'introspect': 'True', 'log_path': '/opt/airflow/include/dbt/logs', 'fail_fast': 'False'}
[0m08:16:09.720697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f6d0c03e-6cde-42a0-9db0-062da48ede2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8891650640>]}
[0m08:16:09.784981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f6d0c03e-6cde-42a0-9db0-062da48ede2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88596befa0>]}
[0m08:16:09.786698 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m08:16:09.961959 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m08:16:10.838189 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m08:16:10.839458 [debug] [MainThread]: Partial parsing: updated file: nyc_taxi://models/transform/fct_trips.sql
[0m08:16:11.141665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f6d0c03e-6cde-42a0-9db0-062da48ede2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f888aee7df0>]}
[0m08:16:11.390587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f6d0c03e-6cde-42a0-9db0-062da48ede2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f888afa0df0>]}
[0m08:16:11.391909 [info ] [MainThread]: Found 3 models, 2 sources, 600 macros
[0m08:16:11.393086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f6d0c03e-6cde-42a0-9db0-062da48ede2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f888aee7880>]}
[0m08:16:11.395628 [info ] [MainThread]: 
[0m08:16:11.397133 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m08:16:11.403438 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_northern-shield-437204-m0'
[0m08:16:11.404504 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:16:12.040099 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_northern-shield-437204-m0, now list_northern-shield-437204-m0_nyc_taxi)
[0m08:16:12.041661 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:16:12.629094 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f6d0c03e-6cde-42a0-9db0-062da48ede2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8858877d60>]}
[0m08:16:12.630800 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:16:12.632092 [info ] [MainThread]: 
[0m08:16:12.641286 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_time
[0m08:16:12.642775 [info ] [Thread-1  ]: 1 of 3 START sql table model nyc_taxi.dim_time ................................. [RUN]
[0m08:16:12.644181 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_northern-shield-437204-m0_nyc_taxi, now model.nyc_taxi.dim_time)
[0m08:16:12.645522 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_time
[0m08:16:12.657170 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_time"
[0m08:16:12.662435 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_time
[0m08:16:12.682049 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m08:16:13.835970 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.dim_time"
[0m08:16:13.842216 [debug] [Thread-1  ]: On model.nyc_taxi.dim_time: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.dim_time"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`dim_time`
      
    
    

    OPTIONS()
    as (
      WITH datetime_cte AS (
    SELECT DISTINCT
        ROW_NUMBER() OVER () AS time_id,
        DATE(lpep_pickup_datetime) AS date,
        lpep_pickup_datetime AS date_part 
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata`
)
SELECT
    time_id,
    date,
    EXTRACT(YEAR FROM date_part) AS year,
    EXTRACT(MONTH FROM date_part) AS month,
    EXTRACT(DAY FROM date_part) AS day,
    EXTRACT(HOUR FROM date_part) AS hour,
    EXTRACT(MINUTE FROM date_part) AS minute,
    FORMAT_TIMESTAMP('%A', date_part) AS weekday,
    TIMESTAMP_TRUNC(date_part, HOUR) AS time
FROM datetime_cte
    );
  
[0m08:16:14.409240 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:ece9cb50-2784-49e8-867f-030a87d3d67a&page=queryresults
[0m08:16:19.442722 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f6d0c03e-6cde-42a0-9db0-062da48ede2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f888b058280>]}
[0m08:16:19.444604 [info ] [Thread-1  ]: 1 of 3 OK created sql table model nyc_taxi.dim_time ............................ [[32mCREATE TABLE (180.8k rows, 1.4 MiB processed)[0m in 6.80s]
[0m08:16:19.446506 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_time
[0m08:16:19.447740 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_zone
[0m08:16:19.448967 [info ] [Thread-1  ]: 2 of 3 START sql table model nyc_taxi.dim_zone ................................. [RUN]
[0m08:16:19.450110 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_time, now model.nyc_taxi.dim_zone)
[0m08:16:19.450982 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_zone
[0m08:16:19.457289 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_zone"
[0m08:16:19.463909 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_zone
[0m08:16:19.468692 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m08:16:20.033780 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.dim_zone"
[0m08:16:20.040801 [debug] [Thread-1  ]: On model.nyc_taxi.dim_zone: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.dim_zone"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`dim_zone`
      
    
    

    OPTIONS()
    as (
      SELECT
    location_id,
    borough,
    zone,
    replace(service_zone, 'Boro', 'Green') as service_zone
FROM `northern-shield-437204-m0`.`nyc_taxi`.`zone_map`
    );
  
[0m08:16:20.661735 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:20d98151-daa9-4ede-a19a-37cacc124591&page=queryresults
[0m08:16:23.408448 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f6d0c03e-6cde-42a0-9db0-062da48ede2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f888b017b50>]}
[0m08:16:23.410713 [info ] [Thread-1  ]: 2 of 3 OK created sql table model nyc_taxi.dim_zone ............................ [[32mCREATE TABLE (265.0 rows, 12.1 KiB processed)[0m in 3.96s]
[0m08:16:23.413019 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_zone
[0m08:16:23.414568 [debug] [Thread-1  ]: Began running node model.nyc_taxi.fct_trips
[0m08:16:23.416003 [info ] [Thread-1  ]: 3 of 3 START sql table model nyc_taxi.fct_trips ................................ [RUN]
[0m08:16:23.417417 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_zone, now model.nyc_taxi.fct_trips)
[0m08:16:23.418565 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.fct_trips
[0m08:16:23.427352 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.fct_trips"
[0m08:16:23.433623 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.fct_trips
[0m08:16:23.438942 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.fct_trips"
[0m08:16:23.444048 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m08:16:23.447466 [debug] [Thread-1  ]: On model.nyc_taxi.fct_trips: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.fct_trips"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips`
      
    
    

    OPTIONS()
    as (
      WITH tripdata_cte AS (
    SELECT 
        to_hex(md5(cast(coalesce(cast(vendor_id as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(lpep_pickup_datetime as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(lpep_dropoff_datetime as string), '_dbt_utils_surrogate_key_null_') as string)))  AS trip_id,
        t.vendor_id,
        t.lpep_pickup_datetime,
        t.lpep_dropoff_datetime,
        td_pickup.time_id AS pickup_time_id,
        td_dropoff.time_id AS dropoff_time_id,
        t.pu_location_id,
        t.do_location_id,
        t.passenger_count,
        t.trip_distance,
        t.fare_amount,
        t.extra,
        t.mta_tax,
        t.tip_amount,
        t.tolls_amount,
        t.ehail_fee,
        t.improvement_surcharge,
        t.total_amount,
        t.payment_type,
        t.trip_type,
        t.congestion_surcharge
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata` AS t
    LEFT JOIN `northern-shield-437204-m0`.`nyc_taxi`.`dim_time` AS td_pickup
        ON TIMESTAMP_TRUNC(t.lpep_pickup_datetime, HOUR) = td_pickup.time
    LEFT JOIN `northern-shield-437204-m0`.`nyc_taxi`.`dim_time` AS td_dropoff
        ON TIMESTAMP_TRUNC(t.lpep_dropoff_datetime, HOUR) = td_dropoff.time
    WHERE DATE(lpep_pickup_datetime) >= '2023-01-01' AND DATE(lpep_pickup_datetime) < '2023-01-31'
)

SELECT 
    trip_id,
    vendor_id,
    pickup_time_id,
    dropoff_time_id,
    pu_location_id,
    do_location_id,
    passenger_count,
    trip_distance,
    fare_amount,
    extra,
    mta_tax,
    tip_amount,
    tolls_amount,
    ehail_fee,
    improvement_surcharge,
    total_amount,
    payment_type,
    trip_type,
    congestion_surcharge
FROM tripdata_cte
    );
  
[0m08:16:24.138251 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:0ab03d8f-5515-4af3-8f22-5f1685f7857b&page=queryresults
[0m08:25:55.729128 [debug] [Thread-1  ]: BigQuery adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.fct_trips"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips`
      
    
    

    OPTIONS()
    as (
      WITH tripdata_cte AS (
    SELECT 
        to_hex(md5(cast(coalesce(cast(vendor_id as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(lpep_pickup_datetime as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(lpep_dropoff_datetime as string), '_dbt_utils_surrogate_key_null_') as string)))  AS trip_id,
        t.vendor_id,
        t.lpep_pickup_datetime,
        t.lpep_dropoff_datetime,
        td_pickup.time_id AS pickup_time_id,
        td_dropoff.time_id AS dropoff_time_id,
        t.pu_location_id,
        t.do_location_id,
        t.passenger_count,
        t.trip_distance,
        t.fare_amount,
        t.extra,
        t.mta_tax,
        t.tip_amount,
        t.tolls_amount,
        t.ehail_fee,
        t.improvement_surcharge,
        t.total_amount,
        t.payment_type,
        t.trip_type,
        t.congestion_surcharge
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata` AS t
    LEFT JOIN `northern-shield-437204-m0`.`nyc_taxi`.`dim_time` AS td_pickup
        ON TIMESTAMP_TRUNC(t.lpep_pickup_datetime, HOUR) = td_pickup.time
    LEFT JOIN `northern-shield-437204-m0`.`nyc_taxi`.`dim_time` AS td_dropoff
        ON TIMESTAMP_TRUNC(t.lpep_dropoff_datetime, HOUR) = td_dropoff.time
    WHERE DATE(lpep_pickup_datetime) >= '2023-01-01' AND DATE(lpep_pickup_datetime) < '2023-01-31'
)

SELECT 
    trip_id,
    vendor_id,
    pickup_time_id,
    dropoff_time_id,
    pu_location_id,
    do_location_id,
    passenger_count,
    trip_distance,
    fare_amount,
    extra,
    mta_tax,
    tip_amount,
    tolls_amount,
    ehail_fee,
    improvement_surcharge,
    total_amount,
    payment_type,
    trip_type,
    congestion_surcharge
FROM tripdata_cte
    );
  
[0m08:25:55.731371 [debug] [Thread-1  ]: BigQuery adapter: Operation did not complete within the designated timeout of 600 seconds.
[0m08:25:55.736451 [debug] [Thread-1  ]: Runtime Error in model fct_trips (models/transform/fct_trips.sql)
  Operation did not complete within the designated timeout of 600 seconds.
[0m08:25:55.738016 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f6d0c03e-6cde-42a0-9db0-062da48ede2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f888ae6af10>]}
[0m08:25:55.740085 [error] [Thread-1  ]: 3 of 3 ERROR creating sql table model nyc_taxi.fct_trips ....................... [[31mERROR[0m in 572.32s]
[0m08:25:55.742062 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.fct_trips
[0m08:25:55.744772 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:25:55.745630 [debug] [MainThread]: Connection 'model.nyc_taxi.fct_trips' was properly closed.
[0m08:25:55.746555 [info ] [MainThread]: 
[0m08:25:55.747676 [info ] [MainThread]: Finished running 3 table models in 0 hours 9 minutes and 44.35 seconds (584.35s).
[0m08:25:55.750232 [debug] [MainThread]: Command end result
[0m08:25:55.816497 [info ] [MainThread]: 
[0m08:25:55.817885 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m08:25:55.819068 [info ] [MainThread]: 
[0m08:25:55.820199 [error] [MainThread]:   Runtime Error in model fct_trips (models/transform/fct_trips.sql)
  Operation did not complete within the designated timeout of 600 seconds.
[0m08:25:55.821258 [info ] [MainThread]: 
[0m08:25:55.822510 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m08:25:55.825105 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 621.0053, "process_user_time": 5.368309, "process_kernel_time": 0.36795, "process_mem_max_rss": "245336", "process_in_blocks": "16", "command_success": false, "process_out_blocks": "0"}
[0m08:25:55.826502 [debug] [MainThread]: Command `dbt run` failed at 08:25:55.826307 after 621.01 seconds
[0m08:25:55.827531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8891dcf5b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f888afa0520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f885963a9a0>]}
[0m08:25:55.828482 [debug] [MainThread]: Flushing usage events
[0m08:26:50.770739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e86324580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e84207a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e842079d0>]}


============================== 08:26:50.777531 | df2fab84-3241-458b-aee0-2fccd144adb7 ==============================
[0m08:26:50.777531 [info ] [MainThread]: Running with dbt=1.8.7
[0m08:26:50.779084 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/include/dbt/', 'empty': 'False', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'fail_fast': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'no_print': 'None', 'partial_parse': 'True', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'log_path': '/opt/airflow/include/dbt/logs', 'version_check': 'True', 'printer_width': '80', 'static_parser': 'True', 'quiet': 'False', 'target_path': 'None', 'profiles_dir': '/opt/airflow/include/dbt/', 'use_experimental_parser': 'False', 'log_cache_events': 'False'}
[0m08:26:51.890253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'df2fab84-3241-458b-aee0-2fccd144adb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e85ba5610>]}
[0m08:26:51.955261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'df2fab84-3241-458b-aee0-2fccd144adb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e845f5640>]}
[0m08:26:51.956812 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m08:26:52.128905 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m08:26:52.256225 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m08:26:52.257978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'df2fab84-3241-458b-aee0-2fccd144adb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e84f8adf0>]}
[0m08:26:54.549673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'df2fab84-3241-458b-aee0-2fccd144adb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e7f7607f0>]}
[0m08:26:54.693673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'df2fab84-3241-458b-aee0-2fccd144adb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e7f63a640>]}
[0m08:26:54.694958 [info ] [MainThread]: Found 3 models, 2 sources, 600 macros
[0m08:26:54.696031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'df2fab84-3241-458b-aee0-2fccd144adb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e7f7e9280>]}
[0m08:26:54.698410 [info ] [MainThread]: 
[0m08:26:54.699994 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m08:26:54.707404 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_northern-shield-437204-m0'
[0m08:26:54.708539 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:26:55.378864 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_northern-shield-437204-m0, now list_northern-shield-437204-m0_nyc_taxi)
[0m08:26:55.380190 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:26:55.954732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'df2fab84-3241-458b-aee0-2fccd144adb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e85af7970>]}
[0m08:26:55.956470 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:26:55.957958 [info ] [MainThread]: 
[0m08:26:55.967554 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_time
[0m08:26:55.969302 [info ] [Thread-1  ]: 1 of 3 START sql table model nyc_taxi.dim_time ................................. [RUN]
[0m08:26:55.970693 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_northern-shield-437204-m0_nyc_taxi, now model.nyc_taxi.dim_time)
[0m08:26:55.971722 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_time
[0m08:26:55.983083 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_time"
[0m08:26:55.988512 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_time
[0m08:26:56.008591 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m08:26:56.609753 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.dim_time"
[0m08:26:56.616210 [debug] [Thread-1  ]: On model.nyc_taxi.dim_time: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.dim_time"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`dim_time`
      
    
    

    OPTIONS()
    as (
      WITH datetime_cte AS (
    SELECT DISTINCT
        ROW_NUMBER() OVER () AS time_id,
        DATE(lpep_pickup_datetime) AS date,
        lpep_pickup_datetime AS date_part 
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata`
)
SELECT
    time_id,
    date,
    EXTRACT(YEAR FROM date_part) AS year,
    EXTRACT(MONTH FROM date_part) AS month,
    EXTRACT(DAY FROM date_part) AS day,
    EXTRACT(HOUR FROM date_part) AS hour,
    EXTRACT(MINUTE FROM date_part) AS minute,
    FORMAT_TIMESTAMP('%A', date_part) AS weekday,
    TIMESTAMP_TRUNC(date_part, HOUR) AS time
FROM datetime_cte
    );
  
[0m08:26:57.221985 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:cbc2c374-ae3c-47dc-8f89-9beb7bd84a6c&page=queryresults
[0m08:26:59.758283 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df2fab84-3241-458b-aee0-2fccd144adb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e4dbad370>]}
[0m08:26:59.760080 [info ] [Thread-1  ]: 1 of 3 OK created sql table model nyc_taxi.dim_time ............................ [[32mCREATE TABLE (180.8k rows, 1.4 MiB processed)[0m in 3.79s]
[0m08:26:59.761764 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_time
[0m08:26:59.763039 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_zone
[0m08:26:59.764298 [info ] [Thread-1  ]: 2 of 3 START sql table model nyc_taxi.dim_zone ................................. [RUN]
[0m08:26:59.765479 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_time, now model.nyc_taxi.dim_zone)
[0m08:26:59.766402 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_zone
[0m08:26:59.772858 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_zone"
[0m08:26:59.778576 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_zone
[0m08:26:59.782970 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m08:27:00.385553 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.dim_zone"
[0m08:27:00.391947 [debug] [Thread-1  ]: On model.nyc_taxi.dim_zone: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.dim_zone"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`dim_zone`
      
    
    

    OPTIONS()
    as (
      SELECT
    location_id,
    borough,
    zone,
    replace(service_zone, 'Boro', 'Green') as service_zone
FROM `northern-shield-437204-m0`.`nyc_taxi`.`zone_map`
    );
  
[0m08:27:00.907894 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:281f6faa-d33f-4cb6-b0bc-178928fa2856&page=queryresults
[0m08:27:03.630219 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df2fab84-3241-458b-aee0-2fccd144adb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e79bf8f70>]}
[0m08:27:03.631822 [info ] [Thread-1  ]: 2 of 3 OK created sql table model nyc_taxi.dim_zone ............................ [[32mCREATE TABLE (265.0 rows, 12.1 KiB processed)[0m in 3.86s]
[0m08:27:03.633562 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_zone
[0m08:27:03.635068 [debug] [Thread-1  ]: Began running node model.nyc_taxi.fct_trips
[0m08:27:03.636490 [info ] [Thread-1  ]: 3 of 3 START sql table model nyc_taxi.fct_trips ................................ [RUN]
[0m08:27:03.638479 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_zone, now model.nyc_taxi.fct_trips)
[0m08:27:03.639862 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.fct_trips
[0m08:27:03.647735 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.fct_trips"
[0m08:27:03.652743 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.fct_trips
[0m08:27:03.658461 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.fct_trips"
[0m08:27:03.663844 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m08:27:03.667062 [debug] [Thread-1  ]: On model.nyc_taxi.fct_trips: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.fct_trips"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips`
      
    
    

    OPTIONS()
    as (
      WITH dim_time_transformed AS (
    SELECT 
        time_id,
        TIMESTAMP_TRUNC(time, HOUR) AS truncated_time
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`dim_time`
),
tripdata_cte AS (
    SELECT 
        to_hex(md5(cast(coalesce(cast(vendor_id as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(lpep_pickup_datetime as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(lpep_dropoff_datetime as string), '_dbt_utils_surrogate_key_null_') as string))) AS trip_id,
        t.vendor_id,
        t.lpep_pickup_datetime,
        t.lpep_dropoff_datetime,
        td_pickup.time_id AS pickup_time_id,
        td_dropoff.time_id AS dropoff_time_id,
        t.pu_location_id,
        t.do_location_id,
        t.passenger_count,
        t.trip_distance,
        t.fare_amount,
        t.extra,
        t.mta_tax,
        t.tip_amount,
        t.tolls_amount,
        t.ehail_fee,
        t.improvement_surcharge,
        t.total_amount,
        t.payment_type,
        t.trip_type,
        t.congestion_surcharge
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata` AS t
    LEFT JOIN dim_time_transformed AS td_pickup
        ON TIMESTAMP_TRUNC(t.lpep_pickup_datetime, HOUR) = td_pickup.truncated_time
    LEFT JOIN dim_time_transformed AS td_dropoff
        ON TIMESTAMP_TRUNC(t.lpep_dropoff_datetime, HOUR) = td_dropoff.truncated_time
    WHERE DATE(lpep_pickup_datetime) >= '2023-01-01' AND DATE(lpep_pickup_datetime) < '2023-01-31'
)
    );
  
[0m08:27:04.189580 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:22f47de2-3a9a-446f-9bb5-26c1364806e7&page=queryresults
[0m08:27:04.191336 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Unexpected ")" at [49:5]; reason: invalidQuery, location: query, message: Syntax error: Unexpected ")" at [49:5]')
[0m08:27:04.984860 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:f6612a31-dcc8-4303-ad25-b691105f6a8c&page=queryresults
[0m08:27:04.986657 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:f6612a31-dcc8-4303-ad25-b691105f6a8c&page=queryresults
[0m08:27:04.991038 [debug] [Thread-1  ]: Database Error in model fct_trips (models/transform/fct_trips.sql)
  Syntax error: Unexpected ")" at [49:5]
  compiled code at target/run/nyc_taxi/models/transform/fct_trips.sql
[0m08:27:04.992298 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df2fab84-3241-458b-aee0-2fccd144adb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e79b6bf70>]}
[0m08:27:04.993954 [error] [Thread-1  ]: 3 of 3 ERROR creating sql table model nyc_taxi.fct_trips ....................... [[31mERROR[0m in 1.35s]
[0m08:27:04.995726 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.fct_trips
[0m08:27:04.998900 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:27:05.000099 [debug] [MainThread]: Connection 'model.nyc_taxi.fct_trips' was properly closed.
[0m08:27:05.001215 [info ] [MainThread]: 
[0m08:27:05.002399 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 10.30 seconds (10.30s).
[0m08:27:05.004531 [debug] [MainThread]: Command end result
[0m08:27:05.066775 [info ] [MainThread]: 
[0m08:27:05.068082 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m08:27:05.069185 [info ] [MainThread]: 
[0m08:27:05.070434 [error] [MainThread]:   Database Error in model fct_trips (models/transform/fct_trips.sql)
  Syntax error: Unexpected ")" at [49:5]
  compiled code at target/run/nyc_taxi/models/transform/fct_trips.sql
[0m08:27:05.071439 [info ] [MainThread]: 
[0m08:27:05.072589 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m08:27:05.074212 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 16.079866, "process_user_time": 6.329434, "process_kernel_time": 0.414427, "process_mem_max_rss": "240984", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m08:27:05.075504 [debug] [MainThread]: Command `dbt run` failed at 08:27:05.075316 after 16.08 seconds
[0m08:27:05.076632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e86324580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e7f81d220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e79b93a00>]}
[0m08:27:05.077587 [debug] [MainThread]: Flushing usage events
[0m08:31:03.370807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4cac91640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4c8b74b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4c8b74ac0>]}


============================== 08:31:03.377126 | 676287b8-0a3e-4ad6-b2ec-cbb818ca82e1 ==============================
[0m08:31:03.377126 [info ] [MainThread]: Running with dbt=1.8.7
[0m08:31:03.378464 [debug] [MainThread]: running dbt with arguments {'empty': 'False', 'log_format': 'default', 'no_print': 'None', 'cache_selected_only': 'False', 'target_path': 'None', 'introspect': 'True', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/include/dbt/', 'write_json': 'True', 'log_cache_events': 'False', 'log_path': '/opt/airflow/include/dbt/logs', 'printer_width': '80', 'debug': 'False', 'quiet': 'False', 'version_check': 'True', 'warn_error': 'None', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'profiles_dir': '/opt/airflow/include/dbt/', 'fail_fast': 'False', 'use_colors': 'True'}
[0m08:31:04.460504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '676287b8-0a3e-4ad6-b2ec-cbb818ca82e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb492507130>]}
[0m08:31:04.531470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '676287b8-0a3e-4ad6-b2ec-cbb818ca82e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4924beb20>]}
[0m08:31:04.532917 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m08:31:04.715767 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m08:31:05.344829 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m08:31:05.346147 [debug] [MainThread]: Partial parsing: updated file: nyc_taxi://models/transform/fct_trips.sql
[0m08:31:05.653728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '676287b8-0a3e-4ad6-b2ec-cbb818ca82e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4c3ce5fa0>]}
[0m08:31:05.902391 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '676287b8-0a3e-4ad6-b2ec-cbb818ca82e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb491723a60>]}
[0m08:31:05.903800 [info ] [MainThread]: Found 3 models, 2 sources, 600 macros
[0m08:31:05.905167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '676287b8-0a3e-4ad6-b2ec-cbb818ca82e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4c3e210d0>]}
[0m08:31:05.907909 [info ] [MainThread]: 
[0m08:31:05.909453 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m08:31:05.915630 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_northern-shield-437204-m0'
[0m08:31:05.916713 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:31:06.486270 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_northern-shield-437204-m0, now list_northern-shield-437204-m0_nyc_taxi)
[0m08:31:06.494415 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:31:07.055705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '676287b8-0a3e-4ad6-b2ec-cbb818ca82e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4cad723d0>]}
[0m08:31:07.057247 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:31:07.058630 [info ] [MainThread]: 
[0m08:31:07.068213 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_time
[0m08:31:07.069702 [info ] [Thread-1  ]: 1 of 3 START sql table model nyc_taxi.dim_time ................................. [RUN]
[0m08:31:07.071276 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_northern-shield-437204-m0_nyc_taxi, now model.nyc_taxi.dim_time)
[0m08:31:07.072345 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_time
[0m08:31:07.083653 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_time"
[0m08:31:07.090055 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_time
[0m08:31:07.111337 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m08:31:07.701579 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.dim_time"
[0m08:31:07.707476 [debug] [Thread-1  ]: On model.nyc_taxi.dim_time: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.dim_time"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`dim_time`
      
    
    

    OPTIONS()
    as (
      WITH datetime_cte AS (
    SELECT DISTINCT
        ROW_NUMBER() OVER () AS time_id,
        DATE(lpep_pickup_datetime) AS date,
        lpep_pickup_datetime AS date_part 
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata`
)
SELECT
    time_id,
    date,
    EXTRACT(YEAR FROM date_part) AS year,
    EXTRACT(MONTH FROM date_part) AS month,
    EXTRACT(DAY FROM date_part) AS day,
    EXTRACT(HOUR FROM date_part) AS hour,
    EXTRACT(MINUTE FROM date_part) AS minute,
    FORMAT_TIMESTAMP('%A', date_part) AS weekday,
    TIMESTAMP_TRUNC(date_part, HOUR) AS time
FROM datetime_cte
    );
  
[0m08:31:08.346376 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:a224163b-41c6-4572-919c-3f93edec1dd1&page=queryresults
[0m08:31:11.699846 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '676287b8-0a3e-4ad6-b2ec-cbb818ca82e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb49179f760>]}
[0m08:31:11.701519 [info ] [Thread-1  ]: 1 of 3 OK created sql table model nyc_taxi.dim_time ............................ [[32mCREATE TABLE (180.8k rows, 1.4 MiB processed)[0m in 4.63s]
[0m08:31:11.703233 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_time
[0m08:31:11.704493 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_zone
[0m08:31:11.705768 [info ] [Thread-1  ]: 2 of 3 START sql table model nyc_taxi.dim_zone ................................. [RUN]
[0m08:31:11.706933 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_time, now model.nyc_taxi.dim_zone)
[0m08:31:11.707787 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_zone
[0m08:31:11.714142 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_zone"
[0m08:31:11.719704 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_zone
[0m08:31:11.724513 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m08:31:11.265078 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.dim_zone"
[0m08:31:11.272135 [debug] [Thread-1  ]: On model.nyc_taxi.dim_zone: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.dim_zone"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`dim_zone`
      
    
    

    OPTIONS()
    as (
      SELECT
    location_id,
    borough,
    zone,
    replace(service_zone, 'Boro', 'Green') as service_zone
FROM `northern-shield-437204-m0`.`nyc_taxi`.`zone_map`
    );
  
[0m08:31:11.826028 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:e60880cb-15ac-441f-8641-cff50de36d4a&page=queryresults
[0m08:31:14.573461 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '676287b8-0a3e-4ad6-b2ec-cbb818ca82e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb491794d90>]}
[0m08:31:14.575061 [info ] [Thread-1  ]: 2 of 3 OK created sql table model nyc_taxi.dim_zone ............................ [[32mCREATE TABLE (265.0 rows, 12.1 KiB processed)[0m in 2.87s]
[0m08:31:14.576838 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_zone
[0m08:31:14.577996 [debug] [Thread-1  ]: Began running node model.nyc_taxi.fct_trips
[0m08:31:14.579154 [info ] [Thread-1  ]: 3 of 3 START sql table model nyc_taxi.fct_trips ................................ [RUN]
[0m08:31:14.580373 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_zone, now model.nyc_taxi.fct_trips)
[0m08:31:14.581306 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.fct_trips
[0m08:31:14.588827 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.fct_trips"
[0m08:31:14.593832 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.fct_trips
[0m08:31:14.598638 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.fct_trips"
[0m08:31:14.604513 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m08:31:14.608230 [debug] [Thread-1  ]: On model.nyc_taxi.fct_trips: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.fct_trips"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips`
      
    
    

    OPTIONS()
    as (
      WITH dim_time_transformed AS (
    SELECT 
        time_id,
        TIMESTAMP_TRUNC(time, HOUR) AS truncated_time
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`dim_time`
),
tripdata_cte AS (
    SELECT 
        to_hex(md5(cast(coalesce(cast(vendor_id as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(lpep_pickup_datetime as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(lpep_dropoff_datetime as string), '_dbt_utils_surrogate_key_null_') as string))) AS trip_id,
        t.vendor_id,
        t.lpep_pickup_datetime,
        t.lpep_dropoff_datetime,
        td_pickup.time_id AS pickup_time_id,
        td_dropoff.time_id AS dropoff_time_id,
        t.pu_location_id,
        t.do_location_id,
        t.passenger_count,
        t.trip_distance,
        t.fare_amount,
        t.extra,
        t.mta_tax,
        t.tip_amount,
        t.tolls_amount,
        t.ehail_fee,
        t.improvement_surcharge,
        t.total_amount,
        t.payment_type,
        t.trip_type,
        t.congestion_surcharge
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata` AS t
    LEFT JOIN dim_time_transformed AS td_pickup
        ON TIMESTAMP_TRUNC(t.lpep_pickup_datetime, HOUR) = td_pickup.truncated_time
    LEFT JOIN dim_time_transformed AS td_dropoff
        ON TIMESTAMP_TRUNC(t.lpep_dropoff_datetime, HOUR) = td_dropoff.truncated_time
    WHERE DATE(lpep_pickup_datetime) >= '2023-01-01' AND DATE(lpep_pickup_datetime) < '2023-01-31'
)

SELECT 
    trip_id,
    vendor_id,
    pickup_time_id,
    dropoff_time_id,
    pu_location_id,
    do_location_id,
    passenger_count,
    trip_distance,
    fare_amount,
    extra,
    mta_tax,
    tip_amount,
    tolls_amount,
    ehail_fee,
    improvement_surcharge,
    total_amount,
    payment_type,
    trip_type,
    congestion_surcharge
FROM tripdata_cte
    );
  
[0m08:31:15.648146 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:af0cdfff-0c5a-474e-99f0-1838ce843471&page=queryresults
[0m08:36:07.599982 [debug] [Thread-1  ]: BigQuery adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.fct_trips"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips`
      
    
    

    OPTIONS()
    as (
      WITH dim_time_transformed AS (
    SELECT 
        time_id,
        TIMESTAMP_TRUNC(time, HOUR) AS truncated_time
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`dim_time`
),
tripdata_cte AS (
    SELECT 
        to_hex(md5(cast(coalesce(cast(vendor_id as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(lpep_pickup_datetime as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(lpep_dropoff_datetime as string), '_dbt_utils_surrogate_key_null_') as string))) AS trip_id,
        t.vendor_id,
        t.lpep_pickup_datetime,
        t.lpep_dropoff_datetime,
        td_pickup.time_id AS pickup_time_id,
        td_dropoff.time_id AS dropoff_time_id,
        t.pu_location_id,
        t.do_location_id,
        t.passenger_count,
        t.trip_distance,
        t.fare_amount,
        t.extra,
        t.mta_tax,
        t.tip_amount,
        t.tolls_amount,
        t.ehail_fee,
        t.improvement_surcharge,
        t.total_amount,
        t.payment_type,
        t.trip_type,
        t.congestion_surcharge
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata` AS t
    LEFT JOIN dim_time_transformed AS td_pickup
        ON TIMESTAMP_TRUNC(t.lpep_pickup_datetime, HOUR) = td_pickup.truncated_time
    LEFT JOIN dim_time_transformed AS td_dropoff
        ON TIMESTAMP_TRUNC(t.lpep_dropoff_datetime, HOUR) = td_dropoff.truncated_time
    WHERE DATE(lpep_pickup_datetime) >= '2023-01-01' AND DATE(lpep_pickup_datetime) < '2023-01-31'
)

SELECT 
    trip_id,
    vendor_id,
    pickup_time_id,
    dropoff_time_id,
    pu_location_id,
    do_location_id,
    passenger_count,
    trip_distance,
    fare_amount,
    extra,
    mta_tax,
    tip_amount,
    tolls_amount,
    ehail_fee,
    improvement_surcharge,
    total_amount,
    payment_type,
    trip_type,
    congestion_surcharge
FROM tripdata_cte
    );
  
[0m08:36:07.601871 [debug] [Thread-1  ]: BigQuery adapter: Operation did not complete within the designated timeout of 300 seconds.
[0m08:36:07.606192 [debug] [Thread-1  ]: Runtime Error in model fct_trips (models/transform/fct_trips.sql)
  Operation did not complete within the designated timeout of 300 seconds.
[0m08:36:07.607586 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '676287b8-0a3e-4ad6-b2ec-cbb818ca82e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4c3c6a970>]}
[0m08:36:07.609340 [error] [Thread-1  ]: 3 of 3 ERROR creating sql table model nyc_taxi.fct_trips ....................... [[31mERROR[0m in 293.03s]
[0m08:36:07.611586 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.fct_trips
[0m08:36:07.614843 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:36:07.615859 [debug] [MainThread]: Connection 'model.nyc_taxi.fct_trips' was properly closed.
[0m08:36:07.616858 [info ] [MainThread]: 
[0m08:36:07.617930 [info ] [MainThread]: Finished running 3 table models in 0 hours 5 minutes and 1.71 seconds (301.71s).
[0m08:36:07.620309 [debug] [MainThread]: Command end result
[0m08:36:07.686696 [info ] [MainThread]: 
[0m08:36:07.688237 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m08:36:07.689319 [info ] [MainThread]: 
[0m08:36:07.690434 [error] [MainThread]:   Runtime Error in model fct_trips (models/transform/fct_trips.sql)
  Operation did not complete within the designated timeout of 300 seconds.
[0m08:36:07.691352 [info ] [MainThread]: 
[0m08:36:07.692361 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m08:36:07.694372 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 323.37875, "process_user_time": 5.226916, "process_kernel_time": 0.404239, "process_mem_max_rss": "235344", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m08:36:07.695770 [debug] [MainThread]: Command `dbt run` failed at 08:36:07.695589 after 323.38 seconds
[0m08:36:07.696767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4cac91640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb491880790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb49199e400>]}
[0m08:36:07.697710 [debug] [MainThread]: Flushing usage events
[0m08:42:17.944229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1b3bb7a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1b1838520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1b18384c0>]}


============================== 08:42:17.950701 | 91e4a47b-c172-4104-9332-c1b2aae9b357 ==============================
[0m08:42:17.950701 [info ] [MainThread]: Running with dbt=1.8.7
[0m08:42:17.952113 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'printer_width': '80', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'use_colors': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/include/dbt/', 'target_path': 'None', 'profiles_dir': '/opt/airflow/include/dbt/', 'empty': 'False', 'indirect_selection': 'eager', 'fail_fast': 'False', 'write_json': 'True', 'debug': 'False', 'static_parser': 'True', 'log_cache_events': 'False', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'log_path': '/opt/airflow/include/dbt/logs', 'log_format': 'default', 'introspect': 'True', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'warn_error': 'None', 'partial_parse': 'True'}
[0m08:42:20.766586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '91e4a47b-c172-4104-9332-c1b2aae9b357', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1b30eae20>]}
[0m08:42:20.831773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '91e4a47b-c172-4104-9332-c1b2aae9b357', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe17976c040>]}
[0m08:42:20.834088 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m08:42:21.050501 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m08:42:21.714523 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m08:42:21.716070 [debug] [MainThread]: Partial parsing: updated file: nyc_taxi://models/transform/fct_trips.sql
[0m08:42:22.031071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '91e4a47b-c172-4104-9332-c1b2aae9b357', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1ac930130>]}
[0m08:42:22.343776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '91e4a47b-c172-4104-9332-c1b2aae9b357', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe17976f820>]}
[0m08:42:22.345068 [info ] [MainThread]: Found 3 models, 2 sources, 600 macros
[0m08:42:22.346395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '91e4a47b-c172-4104-9332-c1b2aae9b357', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1ac9300d0>]}
[0m08:42:22.348978 [info ] [MainThread]: 
[0m08:42:22.350491 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m08:42:22.356899 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_northern-shield-437204-m0'
[0m08:42:22.358115 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:42:23.061856 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_northern-shield-437204-m0, now list_northern-shield-437204-m0_nyc_taxi)
[0m08:42:23.063335 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:42:23.678189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '91e4a47b-c172-4104-9332-c1b2aae9b357', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1b30b6dc0>]}
[0m08:42:23.679997 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:42:23.681278 [info ] [MainThread]: 
[0m08:42:23.691296 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_time
[0m08:42:23.692870 [info ] [Thread-1  ]: 1 of 3 START sql table model nyc_taxi.dim_time ................................. [RUN]
[0m08:42:23.694445 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_northern-shield-437204-m0_nyc_taxi, now model.nyc_taxi.dim_time)
[0m08:42:23.695564 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_time
[0m08:42:23.707341 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_time"
[0m08:42:23.712924 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_time
[0m08:42:23.733161 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m08:42:24.396881 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.dim_time"
[0m08:42:24.403182 [debug] [Thread-1  ]: On model.nyc_taxi.dim_time: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.dim_time"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`dim_time`
      
    
    

    OPTIONS()
    as (
      WITH datetime_cte AS (
    SELECT DISTINCT
        ROW_NUMBER() OVER () AS time_id,
        DATE(lpep_pickup_datetime) AS date,
        lpep_pickup_datetime AS date_part 
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata`
)
SELECT
    time_id,
    date,
    EXTRACT(YEAR FROM date_part) AS year,
    EXTRACT(MONTH FROM date_part) AS month,
    EXTRACT(DAY FROM date_part) AS day,
    EXTRACT(HOUR FROM date_part) AS hour,
    EXTRACT(MINUTE FROM date_part) AS minute,
    FORMAT_TIMESTAMP('%A', date_part) AS weekday,
    TIMESTAMP_TRUNC(date_part, HOUR) AS time
FROM datetime_cte
    );
  
[0m08:42:24.971206 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:3158f4a9-087f-43c0-a4d7-87c55c91e4a8&page=queryresults
[0m08:42:28.981082 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '91e4a47b-c172-4104-9332-c1b2aae9b357', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe17976cfa0>]}
[0m08:42:28.983162 [info ] [Thread-1  ]: 1 of 3 OK created sql table model nyc_taxi.dim_time ............................ [[32mCREATE TABLE (180.8k rows, 1.4 MiB processed)[0m in 5.29s]
[0m08:42:28.985013 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_time
[0m08:42:28.986306 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_zone
[0m08:42:28.987669 [info ] [Thread-1  ]: 2 of 3 START sql table model nyc_taxi.dim_zone ................................. [RUN]
[0m08:42:28.989081 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_time, now model.nyc_taxi.dim_zone)
[0m08:42:28.990062 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_zone
[0m08:42:28.994971 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_zone"
[0m08:42:29.000549 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_zone
[0m08:42:29.009429 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m08:42:29.606343 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.dim_zone"
[0m08:42:29.612276 [debug] [Thread-1  ]: On model.nyc_taxi.dim_zone: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.dim_zone"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`dim_zone`
      
    
    

    OPTIONS()
    as (
      SELECT
    location_id,
    borough,
    zone,
    replace(service_zone, 'Boro', 'Green') as service_zone
FROM `northern-shield-437204-m0`.`nyc_taxi`.`zone_map`
    );
  
[0m08:42:30.226352 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:614f6c4a-4ce1-42c9-b4b9-4b5d2dc6c30b&page=queryresults
[0m08:42:31.228244 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '91e4a47b-c172-4104-9332-c1b2aae9b357', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe17976cf40>]}
[0m08:42:31.230226 [info ] [Thread-1  ]: 2 of 3 OK created sql table model nyc_taxi.dim_zone ............................ [[32mCREATE TABLE (265.0 rows, 12.1 KiB processed)[0m in 2.24s]
[0m08:42:31.232282 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_zone
[0m08:42:31.233911 [debug] [Thread-1  ]: Began running node model.nyc_taxi.fct_trips
[0m08:42:31.235274 [info ] [Thread-1  ]: 3 of 3 START sql table model nyc_taxi.fct_trips ................................ [RUN]
[0m08:42:31.236740 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_zone, now model.nyc_taxi.fct_trips)
[0m08:42:31.237925 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.fct_trips
[0m08:42:31.247365 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.fct_trips"
[0m08:42:31.252391 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.fct_trips
[0m08:42:31.257937 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.fct_trips"
[0m08:42:31.263790 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m08:42:31.298894 [debug] [Thread-1  ]: On model.nyc_taxi.fct_trips: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.fct_trips"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips`
      
    
    

    OPTIONS()
    as (
      WITH dim_time_transformed AS (
    SELECT 
        time_id,
        TIMESTAMP_TRUNC(time, HOUR) AS truncated_time
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`dim_time`
),
tripdata_cte AS (
    SELECT 
        to_hex(md5(cast(coalesce(cast(vendor_id as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(lpep_pickup_datetime as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(lpep_dropoff_datetime as string), '_dbt_utils_surrogate_key_null_') as string))) AS trip_id,
        t.vendor_id,
        t.lpep_pickup_datetime,
        t.lpep_dropoff_datetime,
        td_pickup.time_id AS pickup_time_id,
        td_dropoff.time_id AS dropoff_time_id,
        t.pu_location_id,
        t.do_location_id,
        t.passenger_count,
        t.trip_distance,
        t.fare_amount,
        t.extra,
        t.mta_tax,
        t.tip_amount,
        t.tolls_amount,
        t.ehail_fee,
        t.improvement_surcharge,
        t.total_amount,
        t.payment_type,
        t.trip_type,
        t.congestion_surcharge
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata` AS t
    LEFT JOIN dim_time_transformed AS td_pickup
        ON TIMESTAMP_TRUNC(t.lpep_pickup_datetime, HOUR) = td_pickup.truncated_time
    LEFT JOIN dim_time_transformed AS td_dropoff
        ON TIMESTAMP_TRUNC(t.lpep_dropoff_datetime, HOUR) = td_dropoff.truncated_time
    WHERE DATE(lpep_pickup_datetime) >= '2023-01-01' 
      AND DATE(lpep_pickup_datetime) <= '2023-01-31'
)

SELECT 
    trip_id,
    vendor_id,
    pickup_time_id,
    dropoff_time_id,
    pu_location_id,
    do_location_id,
    passenger_count,
    trip_distance,
    fare_amount,
    extra,
    mta_tax,
    tip_amount,
    tolls_amount,
    ehail_fee,
    improvement_surcharge,
    total_amount,
    payment_type,
    trip_type,
    congestion_surcharge
FROM tripdata_cte
    );
  
[0m08:42:32.072046 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:02b0fb95-d4ea-45a8-887c-e9b246ecf0f3&page=queryresults
[0m08:47:15.294692 [debug] [Thread-1  ]: BigQuery adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.fct_trips"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips`
      
    
    

    OPTIONS()
    as (
      WITH dim_time_transformed AS (
    SELECT 
        time_id,
        TIMESTAMP_TRUNC(time, HOUR) AS truncated_time
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`dim_time`
),
tripdata_cte AS (
    SELECT 
        to_hex(md5(cast(coalesce(cast(vendor_id as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(lpep_pickup_datetime as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(lpep_dropoff_datetime as string), '_dbt_utils_surrogate_key_null_') as string))) AS trip_id,
        t.vendor_id,
        t.lpep_pickup_datetime,
        t.lpep_dropoff_datetime,
        td_pickup.time_id AS pickup_time_id,
        td_dropoff.time_id AS dropoff_time_id,
        t.pu_location_id,
        t.do_location_id,
        t.passenger_count,
        t.trip_distance,
        t.fare_amount,
        t.extra,
        t.mta_tax,
        t.tip_amount,
        t.tolls_amount,
        t.ehail_fee,
        t.improvement_surcharge,
        t.total_amount,
        t.payment_type,
        t.trip_type,
        t.congestion_surcharge
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata` AS t
    LEFT JOIN dim_time_transformed AS td_pickup
        ON TIMESTAMP_TRUNC(t.lpep_pickup_datetime, HOUR) = td_pickup.truncated_time
    LEFT JOIN dim_time_transformed AS td_dropoff
        ON TIMESTAMP_TRUNC(t.lpep_dropoff_datetime, HOUR) = td_dropoff.truncated_time
    WHERE DATE(lpep_pickup_datetime) >= '2023-01-01' 
      AND DATE(lpep_pickup_datetime) <= '2023-01-31'
)

SELECT 
    trip_id,
    vendor_id,
    pickup_time_id,
    dropoff_time_id,
    pu_location_id,
    do_location_id,
    passenger_count,
    trip_distance,
    fare_amount,
    extra,
    mta_tax,
    tip_amount,
    tolls_amount,
    ehail_fee,
    improvement_surcharge,
    total_amount,
    payment_type,
    trip_type,
    congestion_surcharge
FROM tripdata_cte
    );
  
[0m08:47:15.296411 [debug] [Thread-1  ]: BigQuery adapter: Operation did not complete within the designated timeout of 300 seconds.
[0m08:47:15.308236 [debug] [Thread-1  ]: Runtime Error in model fct_trips (models/transform/fct_trips.sql)
  Operation did not complete within the designated timeout of 300 seconds.
[0m08:47:15.309758 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '91e4a47b-c172-4104-9332-c1b2aae9b357', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1b251ee20>]}
[0m08:47:15.311465 [error] [Thread-1  ]: 3 of 3 ERROR creating sql table model nyc_taxi.fct_trips ....................... [[31mERROR[0m in 284.07s]
[0m08:47:15.313438 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.fct_trips
[0m08:47:15.316802 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:47:15.317849 [debug] [MainThread]: Connection 'model.nyc_taxi.fct_trips' was properly closed.
[0m08:47:15.318937 [info ] [MainThread]: 
[0m08:47:15.320065 [info ] [MainThread]: Finished running 3 table models in 0 hours 4 minutes and 52.97 seconds (292.97s).
[0m08:47:15.322421 [debug] [MainThread]: Command end result
[0m08:47:15.392880 [info ] [MainThread]: 
[0m08:47:15.394293 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m08:47:15.395420 [info ] [MainThread]: 
[0m08:47:15.396625 [error] [MainThread]:   Runtime Error in model fct_trips (models/transform/fct_trips.sql)
  Operation did not complete within the designated timeout of 300 seconds.
[0m08:47:15.397728 [info ] [MainThread]: 
[0m08:47:15.398778 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m08:47:15.400080 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 316.792, "process_user_time": 5.958811, "process_kernel_time": 1.808584, "process_mem_max_rss": "264428", "process_in_blocks": "71896", "process_out_blocks": "22192", "command_success": false}
[0m08:47:15.401456 [debug] [MainThread]: Command `dbt run` failed at 08:47:15.401283 after 316.79 seconds
[0m08:47:15.402906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1b3bb7a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe179849af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe179849ac0>]}
[0m08:47:15.403937 [debug] [MainThread]: Flushing usage events
[0m08:55:58.716841 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0651c54f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0630c3b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0630c3bb0>]}


============================== 08:55:58.723421 | fe183f23-0cd1-403d-81d2-41e0400f046f ==============================
[0m08:55:58.723421 [info ] [MainThread]: Running with dbt=1.8.7
[0m08:55:58.725165 [debug] [MainThread]: running dbt with arguments {'debug': 'False', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/include/dbt/', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True', 'printer_width': '80', 'no_print': 'None', 'profiles_dir': '/opt/airflow/include/dbt/', 'write_json': 'True', 'partial_parse': 'True', 'static_parser': 'True', 'fail_fast': 'False', 'quiet': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/include/dbt/logs', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'warn_error': 'None', 'empty': 'False', 'use_colors': 'True', 'cache_selected_only': 'False'}
[0m08:56:00.237549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fe183f23-0cd1-403d-81d2-41e0400f046f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd02ba89f40>]}
[0m08:56:00.304607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fe183f23-0cd1-403d-81d2-41e0400f046f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd02aee92e0>]}
[0m08:56:00.306852 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m08:56:00.521490 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m08:56:01.169252 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m08:56:01.170705 [debug] [MainThread]: Partial parsing: updated file: nyc_taxi://models/transform/fct_trips.sql
[0m08:56:01.504494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fe183f23-0cd1-403d-81d2-41e0400f046f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd05e09aeb0>]}
[0m08:56:01.648668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fe183f23-0cd1-403d-81d2-41e0400f046f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd05e0238b0>]}
[0m08:56:01.649990 [info ] [MainThread]: Found 3 models, 2 sources, 600 macros
[0m08:56:01.651207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fe183f23-0cd1-403d-81d2-41e0400f046f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd05e0ea3a0>]}
[0m08:56:01.653982 [info ] [MainThread]: 
[0m08:56:01.655489 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m08:56:01.661753 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_northern-shield-437204-m0'
[0m08:56:01.662996 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:56:02.349003 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_northern-shield-437204-m0, now list_northern-shield-437204-m0_nyc_taxi)
[0m08:56:02.350410 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:56:02.968247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fe183f23-0cd1-403d-81d2-41e0400f046f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd064943ca0>]}
[0m08:56:02.970084 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:56:02.971495 [info ] [MainThread]: 
[0m08:56:02.981292 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_time
[0m08:56:02.983162 [info ] [Thread-1  ]: 1 of 3 START sql table model nyc_taxi.dim_time ................................. [RUN]
[0m08:56:02.984676 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_northern-shield-437204-m0_nyc_taxi, now model.nyc_taxi.dim_time)
[0m08:56:02.985797 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_time
[0m08:56:02.997421 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_time"
[0m08:56:03.002929 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_time
[0m08:56:03.023688 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m08:56:03.736928 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.dim_time"
[0m08:56:03.742767 [debug] [Thread-1  ]: On model.nyc_taxi.dim_time: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.dim_time"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`dim_time`
      
    
    

    OPTIONS()
    as (
      WITH datetime_cte AS (
    SELECT DISTINCT
        ROW_NUMBER() OVER () AS time_id,
        DATE(lpep_pickup_datetime) AS date,
        lpep_pickup_datetime AS date_part 
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata`
)
SELECT
    time_id,
    date,
    EXTRACT(YEAR FROM date_part) AS year,
    EXTRACT(MONTH FROM date_part) AS month,
    EXTRACT(DAY FROM date_part) AS day,
    EXTRACT(HOUR FROM date_part) AS hour,
    EXTRACT(MINUTE FROM date_part) AS minute,
    FORMAT_TIMESTAMP('%A', date_part) AS weekday,
    TIMESTAMP_TRUNC(date_part, HOUR) AS time
FROM datetime_cte
    );
  
[0m08:56:04.374660 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:fb7d2dcb-e7f3-40e3-8dda-fbbd104aa65c&page=queryresults
[0m08:56:09.221734 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fe183f23-0cd1-403d-81d2-41e0400f046f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd02aec7a60>]}
[0m08:56:09.224052 [info ] [Thread-1  ]: 1 of 3 OK created sql table model nyc_taxi.dim_time ............................ [[32mCREATE TABLE (180.8k rows, 1.4 MiB processed)[0m in 6.24s]
[0m08:56:09.226089 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_time
[0m08:56:09.227443 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_zone
[0m08:56:09.228684 [info ] [Thread-1  ]: 2 of 3 START sql table model nyc_taxi.dim_zone ................................. [RUN]
[0m08:56:09.229804 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_time, now model.nyc_taxi.dim_zone)
[0m08:56:09.230720 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_zone
[0m08:56:09.235542 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_zone"
[0m08:56:09.241106 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_zone
[0m08:56:09.245374 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m08:56:09.883964 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.dim_zone"
[0m08:56:09.889828 [debug] [Thread-1  ]: On model.nyc_taxi.dim_zone: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.dim_zone"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`dim_zone`
      
    
    

    OPTIONS()
    as (
      SELECT
    location_id,
    borough,
    zone,
    replace(service_zone, 'Boro', 'Green') as service_zone
FROM `northern-shield-437204-m0`.`nyc_taxi`.`zone_map`
    );
  
[0m08:56:08.860890 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:8f21c0f1-40d4-4bd5-aa9e-5d7a17a86a16&page=queryresults
[0m08:56:11.323447 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fe183f23-0cd1-403d-81d2-41e0400f046f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd02aec7e20>]}
[0m08:56:11.325275 [info ] [Thread-1  ]: 2 of 3 OK created sql table model nyc_taxi.dim_zone ............................ [[32mCREATE TABLE (265.0 rows, 12.1 KiB processed)[0m in 2.09s]
[0m08:56:11.327452 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_zone
[0m08:56:11.328801 [debug] [Thread-1  ]: Began running node model.nyc_taxi.fct_trips
[0m08:56:11.330060 [info ] [Thread-1  ]: 3 of 3 START sql table model nyc_taxi.fct_trips ................................ [RUN]
[0m08:56:11.331585 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_zone, now model.nyc_taxi.fct_trips)
[0m08:56:11.332873 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.fct_trips
[0m08:56:11.360277 [debug] [Thread-1  ]: Compilation Error in model fct_trips (models/transform/fct_trips.sql)
  'get_payment_type_description' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m08:56:11.361490 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fe183f23-0cd1-403d-81d2-41e0400f046f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd063324af0>]}
[0m08:56:11.362655 [error] [Thread-1  ]: 3 of 3 ERROR creating sql table model nyc_taxi.fct_trips ....................... [[31mERROR[0m in 0.03s]
[0m08:56:11.363986 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.fct_trips
[0m08:56:11.366274 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:56:11.367190 [debug] [MainThread]: Connection 'model.nyc_taxi.fct_trips' was properly closed.
[0m08:56:11.368124 [info ] [MainThread]: 
[0m08:56:11.369116 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 9.71 seconds (9.71s).
[0m08:56:11.371446 [debug] [MainThread]: Command end result
[0m08:56:11.438616 [info ] [MainThread]: 
[0m08:56:11.439994 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m08:56:11.441248 [info ] [MainThread]: 
[0m08:56:11.442754 [error] [MainThread]:   Compilation Error in model fct_trips (models/transform/fct_trips.sql)
  'get_payment_type_description' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m08:56:11.444071 [info ] [MainThread]: 
[0m08:56:11.445318 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m08:56:11.446738 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 14.589464, "process_user_time": 4.813222, "process_kernel_time": 1.478076, "process_mem_max_rss": "267008", "process_in_blocks": "216", "process_out_blocks": "8", "command_success": false}
[0m08:56:11.447914 [debug] [MainThread]: Command `dbt run` failed at 08:56:11.447760 after 14.59 seconds
[0m08:56:11.448806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0651c54f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd02b1b28b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd05e411400>]}
[0m08:56:11.449705 [debug] [MainThread]: Flushing usage events
[0m08:57:05.785933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c77b74400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c75ab7ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c75ab7b20>]}


============================== 08:57:05.792455 | c21cc4d0-bac8-4fff-a7fb-ff88155ac8b0 ==============================
[0m08:57:05.792455 [info ] [MainThread]: Running with dbt=1.8.7
[0m08:57:05.794121 [debug] [MainThread]: running dbt with arguments {'quiet': 'False', 'profiles_dir': '/opt/airflow/include/dbt/', 'target_path': 'None', 'fail_fast': 'False', 'empty': 'False', 'static_parser': 'True', 'log_format': 'default', 'warn_error': 'None', 'no_print': 'None', 'use_experimental_parser': 'False', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/include/dbt/', 'indirect_selection': 'eager', 'write_json': 'True', 'version_check': 'True', 'partial_parse': 'True', 'use_colors': 'True', 'log_path': '/opt/airflow/include/dbt/logs', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True', 'printer_width': '80', 'introspect': 'True', 'debug': 'False', 'cache_selected_only': 'False'}
[0m08:57:07.194721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c21cc4d0-bac8-4fff-a7fb-ff88155ac8b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c7736ce20>]}
[0m08:57:07.261039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c21cc4d0-bac8-4fff-a7fb-ff88155ac8b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c3d96af70>]}
[0m08:57:07.262890 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m08:57:07.473754 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m08:57:08.100410 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m08:57:08.101777 [debug] [MainThread]: Partial parsing: updated file: nyc_taxi://models/transform/fct_trips.sql
[0m08:57:08.422948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c21cc4d0-bac8-4fff-a7fb-ff88155ac8b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c70afc130>]}
[0m08:57:08.562976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c21cc4d0-bac8-4fff-a7fb-ff88155ac8b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c70a00970>]}
[0m08:57:08.564417 [info ] [MainThread]: Found 3 models, 2 sources, 600 macros
[0m08:57:08.565700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c21cc4d0-bac8-4fff-a7fb-ff88155ac8b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c70b30d00>]}
[0m08:57:08.568445 [info ] [MainThread]: 
[0m08:57:08.569859 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m08:57:08.575904 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_northern-shield-437204-m0'
[0m08:57:08.576951 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:57:09.217371 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_northern-shield-437204-m0, now list_northern-shield-437204-m0_nyc_taxi)
[0m08:57:09.218793 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:57:09.847627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c21cc4d0-bac8-4fff-a7fb-ff88155ac8b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c70c47eb0>]}
[0m08:57:09.849207 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:57:09.850523 [info ] [MainThread]: 
[0m08:57:09.859900 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_time
[0m08:57:09.861412 [info ] [Thread-1  ]: 1 of 3 START sql table model nyc_taxi.dim_time ................................. [RUN]
[0m08:57:09.862953 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_northern-shield-437204-m0_nyc_taxi, now model.nyc_taxi.dim_time)
[0m08:57:09.864294 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_time
[0m08:57:09.875804 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_time"
[0m08:57:09.882171 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_time
[0m08:57:09.902419 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m08:57:10.556444 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.dim_time"
[0m08:57:10.561948 [debug] [Thread-1  ]: On model.nyc_taxi.dim_time: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.dim_time"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`dim_time`
      
    
    

    OPTIONS()
    as (
      WITH datetime_cte AS (
    SELECT DISTINCT
        ROW_NUMBER() OVER () AS time_id,
        DATE(lpep_pickup_datetime) AS date,
        lpep_pickup_datetime AS date_part 
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata`
)
SELECT
    time_id,
    date,
    EXTRACT(YEAR FROM date_part) AS year,
    EXTRACT(MONTH FROM date_part) AS month,
    EXTRACT(DAY FROM date_part) AS day,
    EXTRACT(HOUR FROM date_part) AS hour,
    EXTRACT(MINUTE FROM date_part) AS minute,
    FORMAT_TIMESTAMP('%A', date_part) AS weekday,
    TIMESTAMP_TRUNC(date_part, HOUR) AS time
FROM datetime_cte
    );
  
[0m08:57:11.128467 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:7ec8c759-d01a-40ba-8106-4b39d61a3945&page=queryresults
[0m08:57:15.624228 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c21cc4d0-bac8-4fff-a7fb-ff88155ac8b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c7847bb80>]}
[0m08:57:15.626273 [info ] [Thread-1  ]: 1 of 3 OK created sql table model nyc_taxi.dim_time ............................ [[32mCREATE TABLE (180.8k rows, 1.4 MiB processed)[0m in 5.76s]
[0m08:57:15.628325 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_time
[0m08:57:15.629721 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_zone
[0m08:57:15.630970 [info ] [Thread-1  ]: 2 of 3 START sql table model nyc_taxi.dim_zone ................................. [RUN]
[0m08:57:15.632066 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_time, now model.nyc_taxi.dim_zone)
[0m08:57:15.633052 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_zone
[0m08:57:15.638370 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_zone"
[0m08:57:15.644132 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_zone
[0m08:57:15.648529 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m08:57:16.255027 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.dim_zone"
[0m08:57:16.261594 [debug] [Thread-1  ]: On model.nyc_taxi.dim_zone: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.dim_zone"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`dim_zone`
      
    
    

    OPTIONS()
    as (
      SELECT
    location_id,
    borough,
    zone,
    replace(service_zone, 'Boro', 'Green') as service_zone
FROM `northern-shield-437204-m0`.`nyc_taxi`.`zone_map`
    );
  
[0m08:57:16.784586 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:aff059da-b885-457d-a490-61dd57585cc0&page=queryresults
[0m08:57:19.580505 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c21cc4d0-bac8-4fff-a7fb-ff88155ac8b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c3d8c6580>]}
[0m08:57:19.582266 [info ] [Thread-1  ]: 2 of 3 OK created sql table model nyc_taxi.dim_zone ............................ [[32mCREATE TABLE (265.0 rows, 12.1 KiB processed)[0m in 3.95s]
[0m08:57:19.584335 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_zone
[0m08:57:19.585799 [debug] [Thread-1  ]: Began running node model.nyc_taxi.fct_trips
[0m08:57:19.587197 [info ] [Thread-1  ]: 3 of 3 START sql table model nyc_taxi.fct_trips ................................ [RUN]
[0m08:57:19.588828 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_zone, now model.nyc_taxi.fct_trips)
[0m08:57:19.589931 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.fct_trips
[0m08:57:19.605399 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.fct_trips"
[0m08:57:19.611432 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.fct_trips
[0m08:57:19.617081 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.fct_trips"
[0m08:57:19.622085 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m08:57:19.657085 [debug] [Thread-1  ]: On model.nyc_taxi.fct_trips: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.fct_trips"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips`
      
    
    

    OPTIONS()
    as (
      with tripdata as 
(
  select *,
    row_number() over(partition by vendor_id, lpep_pickup_datetime) as rn
  from `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata`
  where vendor_id is not null 
),
dim_time_transformed AS (
  select 
    time_id,
    TIMESTAMP_TRUNC(time, HOUR) AS truncated_time
  from `northern-shield-437204-m0`.`nyc_taxi`.`dim_time`
)
select
    -- identifiers
    to_hex(md5(cast(coalesce(cast(vendorid as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(lpep_pickup_datetime as string), '_dbt_utils_surrogate_key_null_') as string))) as trip_id,
    safe_cast(vendor_id as INT64) as vendor_id,
    safe_cast(rate_code_id as INT64) as rate_code_id,
    safe_cast(pu_location_id as INT64) as pickup_locationid,
    safe_cast(do_location_id as INT64) as dropoff_locationid,

    -- timestamps
    cast(lpep_pickup_datetime as timestamp) as pickup_datetime,
    cast(lpep_dropoff_datetime as timestamp) as dropoff_datetime,

    -- trip info
    store_and_fwd_flag,
    safe_cast(passenger_count as INT64) as passenger_count,
    cast(trip_distance as numeric) as trip_distance,
    safe_cast(trip_type as INT64) as trip_type,

    -- payment info
    cast(fare_amount as numeric) as fare_amount,
    cast(extra as numeric) as extra,
    cast(mta_tax as numeric) as mta_tax,
    cast(tip_amount as numeric) as tip_amount,
    cast(tolls_amount as numeric) as tolls_amount,
    cast(ehail_fee as numeric) as ehail_fee,
    cast(improvement_surcharge as numeric) as improvement_surcharge,
    cast(total_amount as numeric) as total_amount,
    coalesce(safe_cast(payment_type as INT64), 0) as payment_type,
    -- time info
    td_pickup.time_id AS pickup_time_id,
    td_dropoff.time_id AS dropoff_time_id

from tripdata
-- Join with dim_time to get pickup_time_id and dropoff_time_id
left join dim_time_transformed AS td_pickup
    on TIMESTAMP_TRUNC(tripdata.lpep_pickup_datetime, HOUR) = td_pickup.truncated_time
left join dim_time_transformed AS td_dropoff
    on TIMESTAMP_TRUNC(tripdata.lpep_dropoff_datetime, HOUR) = td_dropoff.truncated_time

where rn = 1;
    );
  
[0m08:57:20.188125 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:b710e6f7-4bdc-47dd-bf9d-014b61de390d&page=queryresults
[0m08:57:20.189909 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected ")" but got ";" at [65:13]; reason: invalidQuery, location: query, message: Syntax error: Expected ")" but got ";" at [65:13]')
[0m08:57:21.396531 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:283445b4-ad52-432e-b961-7d715c2c71cd&page=queryresults
[0m08:57:21.398219 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:283445b4-ad52-432e-b961-7d715c2c71cd&page=queryresults
[0m08:57:21.403444 [debug] [Thread-1  ]: Database Error in model fct_trips (models/transform/fct_trips.sql)
  Syntax error: Expected ")" but got ";" at [65:13]
  compiled code at target/run/nyc_taxi/models/transform/fct_trips.sql
[0m08:57:21.404827 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c21cc4d0-bac8-4fff-a7fb-ff88155ac8b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c709b5640>]}
[0m08:57:21.406604 [error] [Thread-1  ]: 3 of 3 ERROR creating sql table model nyc_taxi.fct_trips ....................... [[31mERROR[0m in 1.82s]
[0m08:57:21.408311 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.fct_trips
[0m08:57:21.411033 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:57:21.412004 [debug] [MainThread]: Connection 'model.nyc_taxi.fct_trips' was properly closed.
[0m08:57:21.413033 [info ] [MainThread]: 
[0m08:57:21.414246 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 12.84 seconds (12.84s).
[0m08:57:21.416673 [debug] [MainThread]: Command end result
[0m08:57:21.482207 [info ] [MainThread]: 
[0m08:57:21.483741 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m08:57:21.484932 [info ] [MainThread]: 
[0m08:57:21.486135 [error] [MainThread]:   Database Error in model fct_trips (models/transform/fct_trips.sql)
  Syntax error: Expected ")" but got ";" at [65:13]
  compiled code at target/run/nyc_taxi/models/transform/fct_trips.sql
[0m08:57:21.487157 [info ] [MainThread]: 
[0m08:57:21.488358 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m08:57:21.489572 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 15.775233, "process_user_time": 4.840645, "process_kernel_time": 1.48798, "process_mem_max_rss": "269580", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m08:57:21.490912 [debug] [MainThread]: Command `dbt run` failed at 08:57:21.490746 after 15.78 seconds
[0m08:57:21.491841 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c77b74400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c760c6970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c70c8d850>]}
[0m08:57:21.492785 [debug] [MainThread]: Flushing usage events
[0m08:57:33.853980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f868ac85460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8688bc8a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8688bc8ac0>]}


============================== 08:57:33.860610 | 0b4d76ce-fd58-4d17-b3f7-4b5d126440ea ==============================
[0m08:57:33.860610 [info ] [MainThread]: Running with dbt=1.8.7
[0m08:57:33.862060 [debug] [MainThread]: running dbt with arguments {'empty': 'False', 'warn_error': 'None', 'debug': 'False', 'partial_parse': 'True', 'quiet': 'False', 'use_experimental_parser': 'False', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/include/dbt/', 'introspect': 'True', 'log_format': 'default', 'write_json': 'True', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'log_path': '/opt/airflow/include/dbt/logs', 'static_parser': 'True', 'printer_width': '80', 'cache_selected_only': 'False', 'log_cache_events': 'False', 'use_colors': 'True', 'profiles_dir': '/opt/airflow/include/dbt/', 'indirect_selection': 'eager', 'no_print': 'None', 'target_path': 'None'}
[0m08:57:33.557081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0b4d76ce-fd58-4d17-b3f7-4b5d126440ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8650a66370>]}
[0m08:57:33.626561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0b4d76ce-fd58-4d17-b3f7-4b5d126440ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8688dab8b0>]}
[0m08:57:33.628270 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m08:57:33.843855 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m08:57:34.571256 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m08:57:34.572681 [debug] [MainThread]: Partial parsing: updated file: nyc_taxi://models/transform/fct_trips.sql
[0m08:57:34.901228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0b4d76ce-fd58-4d17-b3f7-4b5d126440ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8683cf2130>]}
[0m08:57:35.046533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0b4d76ce-fd58-4d17-b3f7-4b5d126440ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8683d76250>]}
[0m08:57:35.048050 [info ] [MainThread]: Found 3 models, 2 sources, 600 macros
[0m08:57:35.049235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0b4d76ce-fd58-4d17-b3f7-4b5d126440ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8683f5ae20>]}
[0m08:57:35.052068 [info ] [MainThread]: 
[0m08:57:35.053814 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m08:57:35.060491 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_northern-shield-437204-m0'
[0m08:57:35.061630 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:57:35.654447 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_northern-shield-437204-m0, now list_northern-shield-437204-m0_nyc_taxi)
[0m08:57:35.655827 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:57:36.257990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0b4d76ce-fd58-4d17-b3f7-4b5d126440ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8688db0580>]}
[0m08:57:36.259627 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:57:36.260961 [info ] [MainThread]: 
[0m08:57:36.269055 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_time
[0m08:57:36.270375 [info ] [Thread-1  ]: 1 of 3 START sql table model nyc_taxi.dim_time ................................. [RUN]
[0m08:57:36.271890 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_northern-shield-437204-m0_nyc_taxi, now model.nyc_taxi.dim_time)
[0m08:57:36.272976 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_time
[0m08:57:36.284967 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_time"
[0m08:57:36.290403 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_time
[0m08:57:36.310148 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m08:57:36.964588 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.dim_time"
[0m08:57:36.971409 [debug] [Thread-1  ]: On model.nyc_taxi.dim_time: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.dim_time"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`dim_time`
      
    
    

    OPTIONS()
    as (
      WITH datetime_cte AS (
    SELECT DISTINCT
        ROW_NUMBER() OVER () AS time_id,
        DATE(lpep_pickup_datetime) AS date,
        lpep_pickup_datetime AS date_part 
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata`
)
SELECT
    time_id,
    date,
    EXTRACT(YEAR FROM date_part) AS year,
    EXTRACT(MONTH FROM date_part) AS month,
    EXTRACT(DAY FROM date_part) AS day,
    EXTRACT(HOUR FROM date_part) AS hour,
    EXTRACT(MINUTE FROM date_part) AS minute,
    FORMAT_TIMESTAMP('%A', date_part) AS weekday,
    TIMESTAMP_TRUNC(date_part, HOUR) AS time
FROM datetime_cte
    );
  
[0m08:57:37.544664 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:edcfc6d2-3268-4aaf-b9e8-d547514b8d2e&page=queryresults
[0m08:57:41.683716 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b4d76ce-fd58-4d17-b3f7-4b5d126440ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f868a449d30>]}
[0m08:57:41.685499 [info ] [Thread-1  ]: 1 of 3 OK created sql table model nyc_taxi.dim_time ............................ [[32mCREATE TABLE (180.8k rows, 1.4 MiB processed)[0m in 5.41s]
[0m08:57:41.687469 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_time
[0m08:57:41.688700 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_zone
[0m08:57:41.689941 [info ] [Thread-1  ]: 2 of 3 START sql table model nyc_taxi.dim_zone ................................. [RUN]
[0m08:57:41.691124 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_time, now model.nyc_taxi.dim_zone)
[0m08:57:41.692084 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_zone
[0m08:57:41.696826 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_zone"
[0m08:57:41.701905 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_zone
[0m08:57:41.706613 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m08:57:42.338775 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.dim_zone"
[0m08:57:42.346363 [debug] [Thread-1  ]: On model.nyc_taxi.dim_zone: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.dim_zone"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`dim_zone`
      
    
    

    OPTIONS()
    as (
      SELECT
    location_id,
    borough,
    zone,
    replace(service_zone, 'Boro', 'Green') as service_zone
FROM `northern-shield-437204-m0`.`nyc_taxi`.`zone_map`
    );
  
[0m08:57:42.891663 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:ab8cfc22-cf39-4d52-9c36-4808770f0c5a&page=queryresults
[0m08:57:45.635228 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b4d76ce-fd58-4d17-b3f7-4b5d126440ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8650a4a160>]}
[0m08:57:45.637042 [info ] [Thread-1  ]: 2 of 3 OK created sql table model nyc_taxi.dim_zone ............................ [[32mCREATE TABLE (265.0 rows, 12.1 KiB processed)[0m in 3.94s]
[0m08:57:45.639399 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_zone
[0m08:57:45.640668 [debug] [Thread-1  ]: Began running node model.nyc_taxi.fct_trips
[0m08:57:45.641737 [info ] [Thread-1  ]: 3 of 3 START sql table model nyc_taxi.fct_trips ................................ [RUN]
[0m08:57:45.642955 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_zone, now model.nyc_taxi.fct_trips)
[0m08:57:45.643851 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.fct_trips
[0m08:57:45.658193 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.fct_trips"
[0m08:57:45.663704 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.fct_trips
[0m08:57:45.669012 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.fct_trips"
[0m08:57:45.674652 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m08:57:45.710071 [debug] [Thread-1  ]: On model.nyc_taxi.fct_trips: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.fct_trips"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips`
      
    
    

    OPTIONS()
    as (
      with tripdata as 
(
  select *,
    row_number() over(partition by vendor_id, lpep_pickup_datetime) as rn
  from `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata`
  where vendor_id is not null 
),
dim_time_transformed AS (
  select 
    time_id,
    TIMESTAMP_TRUNC(time, HOUR) AS truncated_time
  from `northern-shield-437204-m0`.`nyc_taxi`.`dim_time`
)
select
    -- identifiers
    to_hex(md5(cast(coalesce(cast(vendorid as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(lpep_pickup_datetime as string), '_dbt_utils_surrogate_key_null_') as string))) as trip_id,
    safe_cast(vendor_id as INT64) as vendor_id,
    safe_cast(rate_code_id as INT64) as rate_code_id,
    safe_cast(pu_location_id as INT64) as pickup_locationid,
    safe_cast(do_location_id as INT64) as dropoff_locationid,

    -- timestamps
    cast(lpep_pickup_datetime as timestamp) as pickup_datetime,
    cast(lpep_dropoff_datetime as timestamp) as dropoff_datetime,

    -- trip info
    store_and_fwd_flag,
    safe_cast(passenger_count as INT64) as passenger_count,
    cast(trip_distance as numeric) as trip_distance,
    safe_cast(trip_type as INT64) as trip_type,

    -- payment info
    cast(fare_amount as numeric) as fare_amount,
    cast(extra as numeric) as extra,
    cast(mta_tax as numeric) as mta_tax,
    cast(tip_amount as numeric) as tip_amount,
    cast(tolls_amount as numeric) as tolls_amount,
    cast(ehail_fee as numeric) as ehail_fee,
    cast(improvement_surcharge as numeric) as improvement_surcharge,
    cast(total_amount as numeric) as total_amount,
    coalesce(safe_cast(payment_type as INT64), 0) as payment_type,
    -- time info
    td_pickup.time_id AS pickup_time_id,
    td_dropoff.time_id AS dropoff_time_id

from tripdata
-- Join with dim_time to get pickup_time_id and dropoff_time_id
left join dim_time_transformed AS td_pickup
    on TIMESTAMP_TRUNC(tripdata.lpep_pickup_datetime, HOUR) = td_pickup.truncated_time
left join dim_time_transformed AS td_dropoff
    on TIMESTAMP_TRUNC(tripdata.lpep_dropoff_datetime, HOUR) = td_dropoff.truncated_time

where rn = 1
    );
  
[0m08:57:46.538248 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:9b92f55b-135c-4d08-bc6f-22e7f38a62f5&page=queryresults
[0m08:57:47.140241 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: vendorid; Did you mean vendor_id? at [28:35]; reason: invalidQuery, location: query, message: Unrecognized name: vendorid; Did you mean vendor_id? at [28:35]')
[0m08:57:48.037526 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:4406d410-e0c8-48d6-8d39-6ba211e9cbc2&page=queryresults
[0m08:57:48.656324 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:4406d410-e0c8-48d6-8d39-6ba211e9cbc2&page=queryresults
[0m08:57:48.661991 [debug] [Thread-1  ]: Database Error in model fct_trips (models/transform/fct_trips.sql)
  Unrecognized name: vendorid; Did you mean vendor_id? at [28:35]
  compiled code at target/run/nyc_taxi/models/transform/fct_trips.sql
[0m08:57:48.663304 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b4d76ce-fd58-4d17-b3f7-4b5d126440ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8688db05e0>]}
[0m08:57:48.664856 [error] [Thread-1  ]: 3 of 3 ERROR creating sql table model nyc_taxi.fct_trips ....................... [[31mERROR[0m in 3.02s]
[0m08:57:48.666738 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.fct_trips
[0m08:57:48.670056 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:57:48.671744 [debug] [MainThread]: Connection 'model.nyc_taxi.fct_trips' was properly closed.
[0m08:57:48.673526 [info ] [MainThread]: 
[0m08:57:48.674931 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 13.62 seconds (13.62s).
[0m08:57:48.677976 [debug] [MainThread]: Command end result
[0m08:57:48.761429 [info ] [MainThread]: 
[0m08:57:48.763176 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m08:57:48.764657 [info ] [MainThread]: 
[0m08:57:48.766306 [error] [MainThread]:   Database Error in model fct_trips (models/transform/fct_trips.sql)
  Unrecognized name: vendorid; Did you mean vendor_id? at [28:35]
  compiled code at target/run/nyc_taxi/models/transform/fct_trips.sql
[0m08:57:48.767938 [info ] [MainThread]: 
[0m08:57:48.769504 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m08:57:48.771231 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 16.7917, "process_user_time": 4.906274, "process_kernel_time": 1.505334, "process_mem_max_rss": "267404", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m08:57:48.772520 [debug] [MainThread]: Command `dbt run` failed at 08:57:48.772375 after 16.79 seconds
[0m08:57:48.773488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f868ac85460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8683e8dfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8683e8d820>]}
[0m08:57:48.774416 [debug] [MainThread]: Flushing usage events
[0m08:58:29.414080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe41b9da430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe419920580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe419920520>]}


============================== 08:58:29.420552 | c657cd5d-e10b-4b2c-8119-c4565c26c540 ==============================
[0m08:58:29.420552 [info ] [MainThread]: Running with dbt=1.8.7
[0m08:58:29.421967 [debug] [MainThread]: running dbt with arguments {'log_path': '/opt/airflow/include/dbt/logs', 'use_experimental_parser': 'False', 'static_parser': 'True', 'profiles_dir': '/opt/airflow/include/dbt/', 'quiet': 'False', 'fail_fast': 'False', 'cache_selected_only': 'False', 'log_format': 'default', 'log_cache_events': 'False', 'use_colors': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/include/dbt/', 'debug': 'False', 'indirect_selection': 'eager', 'write_json': 'True', 'no_print': 'None', 'target_path': 'None', 'version_check': 'True', 'printer_width': '80', 'empty': 'False', 'warn_error': 'None', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:58:30.818453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c657cd5d-e10b-4b2c-8119-c4565c26c540', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe41b1d2e50>]}
[0m08:58:30.885589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c657cd5d-e10b-4b2c-8119-c4565c26c540', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe419b05850>]}
[0m08:58:30.887533 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m08:58:31.135435 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m08:58:29.991351 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m08:58:29.992653 [debug] [MainThread]: Partial parsing: updated file: nyc_taxi://models/transform/fct_trips.sql
[0m08:58:30.325351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c657cd5d-e10b-4b2c-8119-c4565c26c540', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4148fe130>]}
[0m08:58:30.467699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c657cd5d-e10b-4b2c-8119-c4565c26c540', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe414800880>]}
[0m08:58:30.469215 [info ] [MainThread]: Found 3 models, 2 sources, 600 macros
[0m08:58:30.470400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c657cd5d-e10b-4b2c-8119-c4565c26c540', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4148fff40>]}
[0m08:58:30.473301 [info ] [MainThread]: 
[0m08:58:30.474912 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m08:58:30.481316 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_northern-shield-437204-m0'
[0m08:58:30.482719 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:58:31.090902 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_northern-shield-437204-m0, now list_northern-shield-437204-m0_nyc_taxi)
[0m08:58:31.092599 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:58:31.714230 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c657cd5d-e10b-4b2c-8119-c4565c26c540', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe419b05190>]}
[0m08:58:31.716012 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:58:31.717381 [info ] [MainThread]: 
[0m08:58:31.726685 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_time
[0m08:58:31.728297 [info ] [Thread-1  ]: 1 of 3 START sql table model nyc_taxi.dim_time ................................. [RUN]
[0m08:58:31.729850 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_northern-shield-437204-m0_nyc_taxi, now model.nyc_taxi.dim_time)
[0m08:58:31.731004 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_time
[0m08:58:31.742135 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_time"
[0m08:58:31.747347 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_time
[0m08:58:31.766950 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m08:58:32.426701 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.dim_time"
[0m08:58:32.432766 [debug] [Thread-1  ]: On model.nyc_taxi.dim_time: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.dim_time"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`dim_time`
      
    
    

    OPTIONS()
    as (
      WITH datetime_cte AS (
    SELECT DISTINCT
        ROW_NUMBER() OVER () AS time_id,
        DATE(lpep_pickup_datetime) AS date,
        lpep_pickup_datetime AS date_part 
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata`
)
SELECT
    time_id,
    date,
    EXTRACT(YEAR FROM date_part) AS year,
    EXTRACT(MONTH FROM date_part) AS month,
    EXTRACT(DAY FROM date_part) AS day,
    EXTRACT(HOUR FROM date_part) AS hour,
    EXTRACT(MINUTE FROM date_part) AS minute,
    FORMAT_TIMESTAMP('%A', date_part) AS weekday,
    TIMESTAMP_TRUNC(date_part, HOUR) AS time
FROM datetime_cte
    );
  
[0m08:58:32.984082 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:bcd17e85-91af-49c5-848e-e62ac182a9ed&page=queryresults
[0m08:58:37.196149 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c657cd5d-e10b-4b2c-8119-c4565c26c540', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe414aebd90>]}
[0m08:58:37.198067 [info ] [Thread-1  ]: 1 of 3 OK created sql table model nyc_taxi.dim_time ............................ [[32mCREATE TABLE (180.8k rows, 1.4 MiB processed)[0m in 5.47s]
[0m08:58:37.199964 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_time
[0m08:58:37.201435 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_zone
[0m08:58:37.202871 [info ] [Thread-1  ]: 2 of 3 START sql table model nyc_taxi.dim_zone ................................. [RUN]
[0m08:58:37.204298 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_time, now model.nyc_taxi.dim_zone)
[0m08:58:37.205453 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_zone
[0m08:58:37.211654 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_zone"
[0m08:58:37.219518 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_zone
[0m08:58:37.224575 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m08:58:37.837127 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.dim_zone"
[0m08:58:37.843076 [debug] [Thread-1  ]: On model.nyc_taxi.dim_zone: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.dim_zone"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`dim_zone`
      
    
    

    OPTIONS()
    as (
      SELECT
    location_id,
    borough,
    zone,
    replace(service_zone, 'Boro', 'Green') as service_zone
FROM `northern-shield-437204-m0`.`nyc_taxi`.`zone_map`
    );
  
[0m08:58:38.372486 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:6dd8c514-428e-478b-b6fd-9bd5aaad18aa&page=queryresults
[0m08:58:40.770729 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c657cd5d-e10b-4b2c-8119-c4565c26c540', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3e1737580>]}
[0m08:58:40.772389 [info ] [Thread-1  ]: 2 of 3 OK created sql table model nyc_taxi.dim_zone ............................ [[32mCREATE TABLE (265.0 rows, 12.1 KiB processed)[0m in 3.57s]
[0m08:58:40.774593 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_zone
[0m08:58:40.776080 [debug] [Thread-1  ]: Began running node model.nyc_taxi.fct_trips
[0m08:58:40.777436 [info ] [Thread-1  ]: 3 of 3 START sql table model nyc_taxi.fct_trips ................................ [RUN]
[0m08:58:40.778773 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_zone, now model.nyc_taxi.fct_trips)
[0m08:58:40.779829 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.fct_trips
[0m08:58:40.799428 [debug] [Thread-1  ]: Compilation Error in model fct_trips (models/transform/fct_trips.sql)
  dbt was unable to infer all dependencies for the model "fct_trips".
  This typically happens when ref() is placed within a conditional block.
  
  To fix this, add the following hint to the top of the model "fct_trips":
  
  -- depends_on: {{ ref('dim_time') }}
[0m08:58:40.800827 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c657cd5d-e10b-4b2c-8119-c4565c26c540', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4147426d0>]}
[0m08:58:40.802187 [error] [Thread-1  ]: 3 of 3 ERROR creating sql table model nyc_taxi.fct_trips ....................... [[31mERROR[0m in 0.02s]
[0m08:58:40.803705 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.fct_trips
[0m08:58:40.805911 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:58:40.806772 [debug] [MainThread]: Connection 'model.nyc_taxi.fct_trips' was properly closed.
[0m08:58:40.807819 [info ] [MainThread]: 
[0m08:58:40.808980 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 10.33 seconds (10.33s).
[0m08:58:40.811634 [debug] [MainThread]: Command end result
[0m08:58:40.877731 [info ] [MainThread]: 
[0m08:58:40.879175 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m08:58:40.880597 [info ] [MainThread]: 
[0m08:58:40.881876 [error] [MainThread]:   Compilation Error in model fct_trips (models/transform/fct_trips.sql)
  dbt was unable to infer all dependencies for the model "fct_trips".
  This typically happens when ref() is placed within a conditional block.
  
  To fix this, add the following hint to the top of the model "fct_trips":
  
  -- depends_on: {{ ref('dim_time') }}
[0m08:58:40.882979 [info ] [MainThread]: 
[0m08:58:40.884181 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m08:58:40.885481 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 13.322511, "process_user_time": 4.807785, "process_kernel_time": 1.461189, "process_mem_max_rss": "266272", "process_in_blocks": "136", "command_success": false, "process_out_blocks": "0"}
[0m08:58:40.886705 [debug] [MainThread]: Command `dbt run` failed at 08:58:40.886556 after 13.32 seconds
[0m08:58:40.887606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe41b9da430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe41c2a0640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe41c29a7f0>]}
[0m08:58:40.888441 [debug] [MainThread]: Flushing usage events
[0m09:52:04.254757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f619d32b5e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f619b20eb80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f619b20eb20>]}


============================== 09:52:04.261881 | 660df903-7729-4743-8a88-ca45f5697708 ==============================
[0m09:52:04.261881 [info ] [MainThread]: Running with dbt=1.8.7
[0m09:52:04.263378 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/include/dbt/', 'log_path': '/opt/airflow/include/dbt/logs', 'log_format': 'default', 'profiles_dir': '/opt/airflow/include/dbt/', 'use_experimental_parser': 'False', 'fail_fast': 'False', 'quiet': 'False', 'partial_parse': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'log_cache_events': 'False', 'static_parser': 'True', 'debug': 'False', 'warn_error': 'None', 'printer_width': '80', 'version_check': 'True', 'empty': 'False', 'target_path': 'None', 'write_json': 'True', 'no_print': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True'}
[0m09:52:05.600275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '660df903-7729-4743-8a88-ca45f5697708', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6163e84fd0>]}
[0m09:52:05.665440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '660df903-7729-4743-8a88-ca45f5697708', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f619b5fdd30>]}
[0m09:52:05.667129 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m09:52:05.841012 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m09:52:06.482446 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:52:06.483756 [debug] [MainThread]: Partial parsing: updated file: nyc_taxi://models/transform/fct_trips.sql
[0m09:52:06.794732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '660df903-7729-4743-8a88-ca45f5697708', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f61964ee130>]}
[0m09:52:07.053495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '660df903-7729-4743-8a88-ca45f5697708', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6163dba610>]}
[0m09:52:07.055090 [info ] [MainThread]: Found 3 models, 2 sources, 600 macros
[0m09:52:07.056382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '660df903-7729-4743-8a88-ca45f5697708', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f61967a91c0>]}
[0m09:52:07.059289 [info ] [MainThread]: 
[0m09:52:07.061225 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m09:52:07.069217 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_northern-shield-437204-m0'
[0m09:52:07.070849 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:52:07.678283 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_northern-shield-437204-m0, now list_northern-shield-437204-m0_nyc_taxi)
[0m09:52:07.679948 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:52:08.240872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '660df903-7729-4743-8a88-ca45f5697708', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f619d6bdd60>]}
[0m09:52:08.242587 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:52:08.244076 [info ] [MainThread]: 
[0m09:52:08.253596 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_time
[0m09:52:08.255151 [info ] [Thread-1  ]: 1 of 3 START sql table model nyc_taxi.dim_time ................................. [RUN]
[0m09:52:08.256614 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_northern-shield-437204-m0_nyc_taxi, now model.nyc_taxi.dim_time)
[0m09:52:08.257834 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_time
[0m09:52:08.270180 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_time"
[0m09:52:08.275261 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_time
[0m09:52:08.295105 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m09:52:08.886252 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.dim_time"
[0m09:52:08.893333 [debug] [Thread-1  ]: On model.nyc_taxi.dim_time: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.dim_time"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`dim_time`
      
    
    

    OPTIONS()
    as (
      WITH datetime_cte AS (
    SELECT DISTINCT
        ROW_NUMBER() OVER () AS time_id,
        DATE(lpep_pickup_datetime) AS date,
        lpep_pickup_datetime AS date_part 
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata`
)
SELECT
    time_id,
    date,
    EXTRACT(YEAR FROM date_part) AS year,
    EXTRACT(MONTH FROM date_part) AS month,
    EXTRACT(DAY FROM date_part) AS day,
    EXTRACT(HOUR FROM date_part) AS hour,
    EXTRACT(MINUTE FROM date_part) AS minute,
    FORMAT_TIMESTAMP('%A', date_part) AS weekday,
    TIMESTAMP_TRUNC(date_part, HOUR) AS time
FROM datetime_cte
    );
  
[0m09:52:09.568696 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:6805dcba-a5d0-4a9f-941a-89ddc7de9976&page=queryresults
[0m09:52:13.823709 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '660df903-7729-4743-8a88-ca45f5697708', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6168bab3a0>]}
[0m09:52:13.833616 [info ] [Thread-1  ]: 1 of 3 OK created sql table model nyc_taxi.dim_time ............................ [[32mCREATE TABLE (180.8k rows, 1.4 MiB processed)[0m in 5.57s]
[0m09:52:13.840386 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_time
[0m09:52:13.841901 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_zone
[0m09:52:13.843441 [info ] [Thread-1  ]: 2 of 3 START sql table model nyc_taxi.dim_zone ................................. [RUN]
[0m09:52:13.846332 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_time, now model.nyc_taxi.dim_zone)
[0m09:52:13.849733 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_zone
[0m09:52:13.860164 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_zone"
[0m09:52:13.865282 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_zone
[0m09:52:13.869765 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m09:52:14.559162 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.dim_zone"
[0m09:52:14.564940 [debug] [Thread-1  ]: On model.nyc_taxi.dim_zone: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.dim_zone"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`dim_zone`
      
    
    

    OPTIONS()
    as (
      SELECT
    location_id,
    borough,
    zone,
    replace(service_zone, 'Boro', 'Green') as service_zone
FROM `northern-shield-437204-m0`.`nyc_taxi`.`zone_map`
    );
  
[0m09:52:15.154636 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:abf571d5-4e19-47e5-ad81-fd4a37073a30&page=queryresults
[0m09:52:17.646495 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '660df903-7729-4743-8a88-ca45f5697708', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f61966810a0>]}
[0m09:52:17.648883 [info ] [Thread-1  ]: 2 of 3 OK created sql table model nyc_taxi.dim_zone ............................ [[32mCREATE TABLE (265.0 rows, 12.1 KiB processed)[0m in 3.80s]
[0m09:52:17.651021 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_zone
[0m09:52:17.652495 [debug] [Thread-1  ]: Began running node model.nyc_taxi.fct_trips
[0m09:52:17.654062 [info ] [Thread-1  ]: 3 of 3 START sql table model nyc_taxi.fct_trips ................................ [RUN]
[0m09:52:17.655389 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_zone, now model.nyc_taxi.fct_trips)
[0m09:52:17.656528 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.fct_trips
[0m09:52:17.665331 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.fct_trips"
[0m09:52:17.670972 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.fct_trips
[0m09:52:17.676538 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.fct_trips"
[0m09:52:17.681941 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m09:52:17.685404 [debug] [Thread-1  ]: On model.nyc_taxi.fct_trips: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.fct_trips"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips`
      
    
    

    OPTIONS()
    as (
      WITH tripdata_cte AS (
    SELECT 
        to_hex(md5(cast(coalesce(cast(vendor_id as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(lpep_pickup_datetime as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(lpep_dropoff_datetime as string), '_dbt_utils_surrogate_key_null_') as string)))  AS trip_id,
        t.vendor_id,
        t.lpep_pickup_datetime,
        t.lpep_dropoff_datetime,
        td_pickup.time_id AS pickup_time_id,
        td_dropoff.time_id AS dropoff_time_id,
        t.pu_location_id,
        t.do_location_id,
        t.passenger_count,
        t.trip_distance,
        t.fare_amount,
        t.extra,
        t.mta_tax,
        t.tip_amount,
        t.tolls_amount,
        t.ehail_fee,
        t.improvement_surcharge,
        t.total_amount,
        t.payment_type,
        t.trip_type,
        t.congestion_surcharge
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata` AS t
    LEFT JOIN `northern-shield-437204-m0`.`nyc_taxi`.`dim_time` AS td_pickup
        ON TIMESTAMP_TRUNC(t.lpep_pickup_datetime, HOUR) = td_pickup.time
    LEFT JOIN `northern-shield-437204-m0`.`nyc_taxi`.`dim_time` AS td_dropoff
        ON TIMESTAMP_TRUNC(t.lpep_dropoff_datetime, HOUR) = td_dropoff.time
    WHERE DATE(lpep_pickup_datetime) >= '2023-01-01' 
      AND DATE(lpep_pickup_datetime) <= '2023-01-31'
      AND vendor_id is not null
)
SELECT 
    trip_id,
    vendor_id,
    pickup_time_id,
    dropoff_time_id,
    pu_location_id,
    do_location_id,
    passenger_count,
    trip_distance,
    fare_amount,
    extra,
    mta_tax,
    tip_amount,
    tolls_amount,
    ehail_fee,
    improvement_surcharge,
    total_amount,
    payment_type,
    trip_type,
    congestion_surcharge
FROM tripdata_cte
    );
  
[0m09:52:18.451531 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:697ad8de-9336-4bd4-8802-0271c379554b&page=queryresults
[0m09:57:01.079632 [debug] [Thread-1  ]: BigQuery adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.fct_trips"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips`
      
    
    

    OPTIONS()
    as (
      WITH tripdata_cte AS (
    SELECT 
        to_hex(md5(cast(coalesce(cast(vendor_id as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(lpep_pickup_datetime as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(lpep_dropoff_datetime as string), '_dbt_utils_surrogate_key_null_') as string)))  AS trip_id,
        t.vendor_id,
        t.lpep_pickup_datetime,
        t.lpep_dropoff_datetime,
        td_pickup.time_id AS pickup_time_id,
        td_dropoff.time_id AS dropoff_time_id,
        t.pu_location_id,
        t.do_location_id,
        t.passenger_count,
        t.trip_distance,
        t.fare_amount,
        t.extra,
        t.mta_tax,
        t.tip_amount,
        t.tolls_amount,
        t.ehail_fee,
        t.improvement_surcharge,
        t.total_amount,
        t.payment_type,
        t.trip_type,
        t.congestion_surcharge
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata` AS t
    LEFT JOIN `northern-shield-437204-m0`.`nyc_taxi`.`dim_time` AS td_pickup
        ON TIMESTAMP_TRUNC(t.lpep_pickup_datetime, HOUR) = td_pickup.time
    LEFT JOIN `northern-shield-437204-m0`.`nyc_taxi`.`dim_time` AS td_dropoff
        ON TIMESTAMP_TRUNC(t.lpep_dropoff_datetime, HOUR) = td_dropoff.time
    WHERE DATE(lpep_pickup_datetime) >= '2023-01-01' 
      AND DATE(lpep_pickup_datetime) <= '2023-01-31'
      AND vendor_id is not null
)
SELECT 
    trip_id,
    vendor_id,
    pickup_time_id,
    dropoff_time_id,
    pu_location_id,
    do_location_id,
    passenger_count,
    trip_distance,
    fare_amount,
    extra,
    mta_tax,
    tip_amount,
    tolls_amount,
    ehail_fee,
    improvement_surcharge,
    total_amount,
    payment_type,
    trip_type,
    congestion_surcharge
FROM tripdata_cte
    );
  
[0m09:57:01.085440 [debug] [Thread-1  ]: BigQuery adapter: Operation did not complete within the designated timeout of 300 seconds.
[0m09:57:01.103021 [debug] [Thread-1  ]: Runtime Error in model fct_trips (models/transform/fct_trips.sql)
  Operation did not complete within the designated timeout of 300 seconds.
[0m09:57:01.107752 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '660df903-7729-4743-8a88-ca45f5697708', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f619646bf40>]}
[0m09:57:01.113989 [error] [Thread-1  ]: 3 of 3 ERROR creating sql table model nyc_taxi.fct_trips ....................... [[31mERROR[0m in 283.45s]
[0m09:57:01.119526 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.fct_trips
[0m09:57:01.128639 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:57:01.131813 [debug] [MainThread]: Connection 'model.nyc_taxi.fct_trips' was properly closed.
[0m09:57:01.136104 [info ] [MainThread]: 
[0m09:57:01.139902 [info ] [MainThread]: Finished running 3 table models in 0 hours 4 minutes and 54.07 seconds (294.07s).
[0m09:57:01.147640 [debug] [MainThread]: Command end result
[0m09:57:01.375376 [info ] [MainThread]: 
[0m09:57:01.379035 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m09:57:01.381933 [info ] [MainThread]: 
[0m09:57:01.385940 [error] [MainThread]:   Runtime Error in model fct_trips (models/transform/fct_trips.sql)
  Operation did not complete within the designated timeout of 300 seconds.
[0m09:57:01.389329 [info ] [MainThread]: 
[0m09:57:01.393168 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m09:57:01.400254 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 316.38208, "process_user_time": 5.728873, "process_kernel_time": 0.604507, "process_mem_max_rss": "241204", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m09:57:01.405414 [debug] [MainThread]: Command `dbt run` failed at 09:57:01.404991 after 316.39 seconds
[0m09:57:01.409466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f619d32b5e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6163f57550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6168aff340>]}
[0m09:57:01.412894 [debug] [MainThread]: Flushing usage events
[0m09:58:54.627130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51c695c550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51c5bb0250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51c5579d90>]}


============================== 09:58:54.643038 | 283abdd0-10fa-4b0d-9e9e-8b160e0f845f ==============================
[0m09:58:54.643038 [info ] [MainThread]: Running with dbt=1.8.7
[0m09:58:54.647994 [debug] [MainThread]: running dbt with arguments {'quiet': 'False', 'log_path': '/opt/airflow/include/dbt/logs', 'target_path': 'None', 'send_anonymous_usage_stats': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'debug': 'False', 'log_format': 'default', 'fail_fast': 'False', 'write_json': 'True', 'indirect_selection': 'eager', 'profiles_dir': '/opt/airflow/include/dbt/', 'static_parser': 'True', 'use_colors': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/include/dbt/', 'empty': 'False', 'no_print': 'None', 'warn_error': 'None', 'cache_selected_only': 'False', 'log_cache_events': 'False', 'printer_width': '80', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'version_check': 'True', 'introspect': 'True'}
[0m09:58:57.472194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '283abdd0-10fa-4b0d-9e9e-8b160e0f845f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51c61dd5e0>]}
[0m09:58:57.638129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '283abdd0-10fa-4b0d-9e9e-8b160e0f845f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f518d44c040>]}
[0m09:58:57.641713 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m09:58:58.156986 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m09:59:01.352227 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:59:01.356383 [debug] [MainThread]: Partial parsing: updated file: nyc_taxi://models/transform/fct_trips.sql
[0m09:59:00.336995 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '283abdd0-10fa-4b0d-9e9e-8b160e0f845f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51bfaee130>]}
[0m09:59:00.976494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '283abdd0-10fa-4b0d-9e9e-8b160e0f845f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f518d4e0af0>]}
[0m09:59:00.980131 [info ] [MainThread]: Found 3 models, 2 sources, 600 macros
[0m09:59:00.983377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '283abdd0-10fa-4b0d-9e9e-8b160e0f845f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51bfaee520>]}
[0m09:59:00.990324 [info ] [MainThread]: 
[0m09:59:00.994000 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m09:59:01.012095 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_northern-shield-437204-m0'
[0m09:59:01.015912 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:59:01.734027 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_northern-shield-437204-m0, now list_northern-shield-437204-m0_nyc_taxi)
[0m09:59:01.737375 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:59:02.366114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '283abdd0-10fa-4b0d-9e9e-8b160e0f845f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51c612e4f0>]}
[0m09:59:02.370275 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:59:02.374663 [info ] [MainThread]: 
[0m09:59:02.407386 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_time
[0m09:59:02.411368 [info ] [Thread-1  ]: 1 of 3 START sql table model nyc_taxi.dim_time ................................. [RUN]
[0m09:59:02.415173 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_northern-shield-437204-m0_nyc_taxi, now model.nyc_taxi.dim_time)
[0m09:59:02.418181 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_time
[0m09:59:02.449761 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_time"
[0m09:59:02.473771 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_time
[0m09:59:02.523707 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m09:59:03.349480 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.dim_time"
[0m09:59:03.368092 [debug] [Thread-1  ]: On model.nyc_taxi.dim_time: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.dim_time"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`dim_time`
      
    
    

    OPTIONS()
    as (
      WITH datetime_cte AS (
    SELECT DISTINCT
        ROW_NUMBER() OVER () AS time_id,
        DATE(lpep_pickup_datetime) AS date,
        lpep_pickup_datetime AS date_part 
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata`
)
SELECT
    time_id,
    date,
    EXTRACT(YEAR FROM date_part) AS year,
    EXTRACT(MONTH FROM date_part) AS month,
    EXTRACT(DAY FROM date_part) AS day,
    EXTRACT(HOUR FROM date_part) AS hour,
    EXTRACT(MINUTE FROM date_part) AS minute,
    FORMAT_TIMESTAMP('%A', date_part) AS weekday,
    TIMESTAMP_TRUNC(date_part, HOUR) AS time
FROM datetime_cte
    );
  
[0m09:59:04.141796 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:6b469099-b59a-4917-aefd-43c60f4b0b2c&page=queryresults
[0m09:59:08.238951 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '283abdd0-10fa-4b0d-9e9e-8b160e0f845f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51bfad5c70>]}
[0m09:59:08.243185 [info ] [Thread-1  ]: 1 of 3 OK created sql table model nyc_taxi.dim_time ............................ [[32mCREATE TABLE (180.8k rows, 1.4 MiB processed)[0m in 5.82s]
[0m09:59:08.248323 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_time
[0m09:59:08.252218 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_zone
[0m09:59:08.255728 [info ] [Thread-1  ]: 2 of 3 START sql table model nyc_taxi.dim_zone ................................. [RUN]
[0m09:59:08.259405 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_time, now model.nyc_taxi.dim_zone)
[0m09:59:08.263249 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_zone
[0m09:59:08.282692 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_zone"
[0m09:59:08.308374 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_zone
[0m09:59:08.319791 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m09:59:09.044697 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.dim_zone"
[0m09:59:09.072696 [debug] [Thread-1  ]: On model.nyc_taxi.dim_zone: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.dim_zone"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`dim_zone`
      
    
    

    OPTIONS()
    as (
      SELECT
    location_id,
    borough,
    zone,
    replace(service_zone, 'Boro', 'Green') as service_zone
FROM `northern-shield-437204-m0`.`nyc_taxi`.`zone_map`
    );
  
[0m09:59:09.697163 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:96d0d497-418a-4454-9f3d-128be0d7fc68&page=queryresults
[0m09:59:12.128222 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '283abdd0-10fa-4b0d-9e9e-8b160e0f845f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f518e0c1250>]}
[0m09:59:12.132413 [info ] [Thread-1  ]: 2 of 3 OK created sql table model nyc_taxi.dim_zone ............................ [[32mCREATE TABLE (265.0 rows, 12.1 KiB processed)[0m in 3.87s]
[0m09:59:12.138186 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_zone
[0m09:59:12.142412 [debug] [Thread-1  ]: Began running node model.nyc_taxi.fct_trips
[0m09:59:12.146461 [info ] [Thread-1  ]: 3 of 3 START sql table model nyc_taxi.fct_trips ................................ [RUN]
[0m09:59:12.151922 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_zone, now model.nyc_taxi.fct_trips)
[0m09:59:12.156287 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.fct_trips
[0m09:59:12.179432 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.fct_trips"
[0m09:59:12.200670 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.fct_trips
[0m09:59:12.216406 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.fct_trips"
[0m09:59:12.241176 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m09:59:12.251574 [debug] [Thread-1  ]: On model.nyc_taxi.fct_trips: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.fct_trips"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips`
      
    
    

    OPTIONS()
    as (
      WITH tripdata_cte AS (
    SELECT 
        to_hex(md5(cast(coalesce(cast(vendor_id as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(lpep_pickup_datetime as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(lpep_dropoff_datetime as string), '_dbt_utils_surrogate_key_null_') as string)))  AS trip_id,
        t.vendor_id,
        t.lpep_pickup_datetime,
        t.lpep_dropoff_datetime,
        td_pickup.time_id AS pickup_time_id,
        td_dropoff.time_id AS dropoff_time_id,
        t.pu_location_id,
        t.do_location_id,
        t.passenger_count,
        t.trip_distance,
        t.fare_amount,
        t.extra,
        t.mta_tax,
        t.tip_amount,
        t.tolls_amount,
        t.ehail_fee,
        t.improvement_surcharge,
        t.total_amount,
        t.payment_type,
        t.trip_type,
        t.congestion_surcharge
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata` AS t
    LEFT JOIN `northern-shield-437204-m0`.`nyc_taxi`.`dim_time` AS td_pickup
        ON TIMESTAMP_TRUNC(t.lpep_pickup_datetime, HOUR) = td_pickup.time
    LEFT JOIN `northern-shield-437204-m0`.`nyc_taxi`.`dim_time` AS td_dropoff
        ON TIMESTAMP_TRUNC(t.lpep_dropoff_datetime, HOUR) = td_dropoff.time
    WHERE DATE(lpep_pickup_datetime) >= '2023-01-01' 
      AND DATE(lpep_pickup_datetime) <= '2023-01-31'
      AND vendor_id is not null
)
SELECT 
    trip_id,
    vendor_id,
    pickup_time_id,
    dropoff_time_id,
    pu_location_id,
    do_location_id,
    passenger_count,
    trip_distance,
    fare_amount,
    extra,
    mta_tax,
    tip_amount,
    tolls_amount,
    ehail_fee,
    improvement_surcharge,
    total_amount,
    payment_type,
    trip_type,
    congestion_surcharge
FROM tripdata_cte
LIMIT = 10000
    );
  
[0m09:59:12.899160 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:80e6f080-08ef-447d-a46e-22877c1c32d5&page=queryresults
[0m09:59:12.903752 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Unexpected "=" at [66:7]; reason: invalidQuery, location: query, message: Syntax error: Unexpected "=" at [66:7]')
[0m09:59:14.444655 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:7a283ba2-d6e9-4d20-ae67-c24f6fdd49d5&page=queryresults
[0m09:59:14.449176 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:7a283ba2-d6e9-4d20-ae67-c24f6fdd49d5&page=queryresults
[0m09:59:14.460973 [debug] [Thread-1  ]: Database Error in model fct_trips (models/transform/fct_trips.sql)
  Syntax error: Unexpected "=" at [66:7]
  compiled code at target/run/nyc_taxi/models/transform/fct_trips.sql
[0m09:59:14.464736 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '283abdd0-10fa-4b0d-9e9e-8b160e0f845f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51bfa6cfa0>]}
[0m09:59:14.469210 [error] [Thread-1  ]: 3 of 3 ERROR creating sql table model nyc_taxi.fct_trips ....................... [[31mERROR[0m in 2.31s]
[0m09:59:14.473515 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.fct_trips
[0m09:59:14.480790 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:59:14.483862 [debug] [MainThread]: Connection 'model.nyc_taxi.fct_trips' was properly closed.
[0m09:59:14.487151 [info ] [MainThread]: 
[0m09:59:14.490008 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 13.49 seconds (13.49s).
[0m09:59:14.496133 [debug] [MainThread]: Command end result
[0m09:59:14.695460 [info ] [MainThread]: 
[0m09:59:14.700142 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m09:59:14.703888 [info ] [MainThread]: 
[0m09:59:14.707990 [error] [MainThread]:   Database Error in model fct_trips (models/transform/fct_trips.sql)
  Syntax error: Unexpected "=" at [66:7]
  compiled code at target/run/nyc_taxi/models/transform/fct_trips.sql
[0m09:59:14.764385 [info ] [MainThread]: 
[0m09:59:14.793611 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m09:59:14.805599 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 22.293459, "process_user_time": 11.398463, "process_kernel_time": 0.940979, "process_mem_max_rss": "227768", "process_in_blocks": "3344", "command_success": false, "process_out_blocks": "0"}
[0m09:59:14.830053 [debug] [MainThread]: Command `dbt run` failed at 09:59:14.829054 after 22.32 seconds
[0m09:59:14.834832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51c695c550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f518d5a66a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51bfc68be0>]}
[0m09:59:14.838810 [debug] [MainThread]: Flushing usage events
[0m10:00:35.100314 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd79199d610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd78f880c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd78f880bb0>]}


============================== 10:00:35.116500 | db43a1f0-66cf-46f7-83d0-acdc21b7433c ==============================
[0m10:00:35.116500 [info ] [MainThread]: Running with dbt=1.8.7
[0m10:00:35.120093 [debug] [MainThread]: running dbt with arguments {'quiet': 'False', 'cache_selected_only': 'False', 'warn_error': 'None', 'profiles_dir': '/opt/airflow/include/dbt/', 'no_print': 'None', 'version_check': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/include/dbt/', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'log_path': '/opt/airflow/include/dbt/logs', 'fail_fast': 'False', 'empty': 'False', 'log_cache_events': 'False', 'write_json': 'True', 'target_path': 'None', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'printer_width': '80', 'introspect': 'True', 'use_colors': 'True', 'log_format': 'default', 'debug': 'False', 'static_parser': 'True', 'use_experimental_parser': 'False'}
[0m10:00:37.726841 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'db43a1f0-66cf-46f7-83d0-acdc21b7433c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd75d29c8b0>]}
[0m10:00:37.946504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'db43a1f0-66cf-46f7-83d0-acdc21b7433c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd75c518580>]}
[0m10:00:37.950748 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m10:00:38.420455 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m10:00:41.662939 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:00:41.666653 [debug] [MainThread]: Partial parsing: updated file: nyc_taxi://models/transform/fct_trips.sql
[0m10:00:42.492857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'db43a1f0-66cf-46f7-83d0-acdc21b7433c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd78aae4df0>]}
[0m10:00:43.053467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'db43a1f0-66cf-46f7-83d0-acdc21b7433c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd75d0b18e0>]}
[0m10:00:43.057453 [info ] [MainThread]: Found 3 models, 2 sources, 600 macros
[0m10:00:43.061754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'db43a1f0-66cf-46f7-83d0-acdc21b7433c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd75d17e100>]}
[0m10:00:43.068725 [info ] [MainThread]: 
[0m10:00:43.075317 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m10:00:43.092777 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_northern-shield-437204-m0'
[0m10:00:43.096167 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:00:43.790329 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_northern-shield-437204-m0, now list_northern-shield-437204-m0_nyc_taxi)
[0m10:00:43.794041 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:00:44.433652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'db43a1f0-66cf-46f7-83d0-acdc21b7433c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7905f6790>]}
[0m10:00:44.438639 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:00:44.441869 [info ] [MainThread]: 
[0m10:00:44.467709 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_time
[0m10:00:44.472374 [info ] [Thread-1  ]: 1 of 3 START sql table model nyc_taxi.dim_time ................................. [RUN]
[0m10:00:44.476666 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_northern-shield-437204-m0_nyc_taxi, now model.nyc_taxi.dim_time)
[0m10:00:44.480133 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_time
[0m10:00:44.513975 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_time"
[0m10:00:44.541274 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_time
[0m10:00:44.592599 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:00:45.410610 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.dim_time"
[0m10:00:45.431845 [debug] [Thread-1  ]: On model.nyc_taxi.dim_time: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.dim_time"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`dim_time`
      
    
    

    OPTIONS()
    as (
      WITH datetime_cte AS (
    SELECT DISTINCT
        ROW_NUMBER() OVER () AS time_id,
        DATE(lpep_pickup_datetime) AS date,
        lpep_pickup_datetime AS date_part 
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata`
)
SELECT
    time_id,
    date,
    EXTRACT(YEAR FROM date_part) AS year,
    EXTRACT(MONTH FROM date_part) AS month,
    EXTRACT(DAY FROM date_part) AS day,
    EXTRACT(HOUR FROM date_part) AS hour,
    EXTRACT(MINUTE FROM date_part) AS minute,
    FORMAT_TIMESTAMP('%A', date_part) AS weekday,
    TIMESTAMP_TRUNC(date_part, HOUR) AS time
FROM datetime_cte
    );
  
[0m10:00:46.095087 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:3b491637-8e4d-49f4-89f8-9a07d060ca7e&page=queryresults
[0m10:00:50.328074 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'db43a1f0-66cf-46f7-83d0-acdc21b7433c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd78aca8130>]}
[0m10:00:50.332590 [info ] [Thread-1  ]: 1 of 3 OK created sql table model nyc_taxi.dim_time ............................ [[32mCREATE TABLE (180.8k rows, 1.4 MiB processed)[0m in 5.85s]
[0m10:00:50.337151 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_time
[0m10:00:50.340789 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_zone
[0m10:00:50.344179 [info ] [Thread-1  ]: 2 of 3 START sql table model nyc_taxi.dim_zone ................................. [RUN]
[0m10:00:50.348683 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_time, now model.nyc_taxi.dim_zone)
[0m10:00:50.352170 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_zone
[0m10:00:50.373916 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_zone"
[0m10:00:50.398158 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_zone
[0m10:00:50.410795 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:00:51.142674 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.dim_zone"
[0m10:00:51.164532 [debug] [Thread-1  ]: On model.nyc_taxi.dim_zone: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.dim_zone"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`dim_zone`
      
    
    

    OPTIONS()
    as (
      SELECT
    location_id,
    borough,
    zone,
    replace(service_zone, 'Boro', 'Green') as service_zone
FROM `northern-shield-437204-m0`.`nyc_taxi`.`zone_map`
    );
  
[0m10:00:51.792363 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:c17c3ee6-2c97-4211-8b03-914e69ce64c8&page=queryresults
[0m10:00:54.204887 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'db43a1f0-66cf-46f7-83d0-acdc21b7433c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7905c0910>]}
[0m10:00:54.209412 [info ] [Thread-1  ]: 2 of 3 OK created sql table model nyc_taxi.dim_zone ............................ [[32mCREATE TABLE (265.0 rows, 12.1 KiB processed)[0m in 3.86s]
[0m10:00:54.214514 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_zone
[0m10:00:54.217899 [debug] [Thread-1  ]: Began running node model.nyc_taxi.fct_trips
[0m10:00:54.221806 [info ] [Thread-1  ]: 3 of 3 START sql table model nyc_taxi.fct_trips ................................ [RUN]
[0m10:00:54.227731 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_zone, now model.nyc_taxi.fct_trips)
[0m10:00:54.232103 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.fct_trips
[0m10:00:54.256722 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.fct_trips"
[0m10:00:54.277053 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.fct_trips
[0m10:00:54.291840 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.fct_trips"
[0m10:00:53.585339 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:00:53.595212 [debug] [Thread-1  ]: On model.nyc_taxi.fct_trips: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.fct_trips"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips`
      
    
    

    OPTIONS()
    as (
      WITH tripdata_cte AS (
    SELECT 
        to_hex(md5(cast(coalesce(cast(vendor_id as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(lpep_pickup_datetime as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(lpep_dropoff_datetime as string), '_dbt_utils_surrogate_key_null_') as string)))  AS trip_id,
        t.vendor_id,
        t.lpep_pickup_datetime,
        t.lpep_dropoff_datetime,
        td_pickup.time_id AS pickup_time_id,
        td_dropoff.time_id AS dropoff_time_id,
        t.pu_location_id,
        t.do_location_id,
        t.passenger_count,
        t.trip_distance,
        t.fare_amount,
        t.extra,
        t.mta_tax,
        t.tip_amount,
        t.tolls_amount,
        t.ehail_fee,
        t.improvement_surcharge,
        t.total_amount,
        t.payment_type,
        t.trip_type,
        t.congestion_surcharge
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata` AS t
    LEFT JOIN `northern-shield-437204-m0`.`nyc_taxi`.`dim_time` AS td_pickup
        ON TIMESTAMP_TRUNC(t.lpep_pickup_datetime, HOUR) = td_pickup.time
    LEFT JOIN `northern-shield-437204-m0`.`nyc_taxi`.`dim_time` AS td_dropoff
        ON TIMESTAMP_TRUNC(t.lpep_dropoff_datetime, HOUR) = td_dropoff.time
    WHERE DATE(lpep_pickup_datetime) >= '2023-01-01' 
      AND DATE(lpep_pickup_datetime) <= '2023-01-31'
      AND vendor_id is not null
)
SELECT 
    trip_id,
    vendor_id,
    pickup_time_id,
    dropoff_time_id,
    pu_location_id,
    do_location_id,
    passenger_count,
    trip_distance,
    fare_amount,
    extra,
    mta_tax,
    tip_amount,
    tolls_amount,
    ehail_fee,
    improvement_surcharge,
    total_amount,
    payment_type,
    trip_type,
    congestion_surcharge
FROM tripdata_cte
LIMIT 10000
    );
  
[0m10:00:53.303795 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:6c7d7bce-59fc-49b3-a1a4-61c41997f0cf&page=queryresults
[0m10:00:56.164328 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'db43a1f0-66cf-46f7-83d0-acdc21b7433c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd75d1ffaf0>]}
[0m10:00:56.168280 [info ] [Thread-1  ]: 3 of 3 OK created sql table model nyc_taxi.fct_trips ........................... [[32mCREATE TABLE (10.0k rows, 26.2 MiB processed)[0m in 1.94s]
[0m10:00:56.172517 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.fct_trips
[0m10:00:56.178249 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:00:56.180792 [debug] [MainThread]: Connection 'model.nyc_taxi.fct_trips' was properly closed.
[0m10:00:56.183568 [info ] [MainThread]: 
[0m10:00:56.186803 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 13.11 seconds (13.11s).
[0m10:00:56.192993 [debug] [MainThread]: Command end result
[0m10:00:56.388825 [info ] [MainThread]: 
[0m10:00:56.392643 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:00:56.396175 [info ] [MainThread]: 
[0m10:00:56.400313 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m10:00:56.406662 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 23.458923, "process_user_time": 11.078675, "process_kernel_time": 0.782254, "process_mem_max_rss": "227396", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m10:00:56.411790 [debug] [MainThread]: Command `dbt run` succeeded at 10:00:56.411169 after 23.46 seconds
[0m10:00:56.415322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd79199d610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd75c44fb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd75c44f8b0>]}
[0m10:00:56.418642 [debug] [MainThread]: Flushing usage events
[0m18:27:49.032880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53c8a135b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53c7c45460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53c6938700>]}


============================== 18:27:49.039766 | 669c76ba-2153-447d-b9a5-624392360f10 ==============================
[0m18:27:49.039766 [info ] [MainThread]: Running with dbt=1.8.7
[0m18:27:49.041167 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'target_path': 'None', 'use_colors': 'True', 'introspect': 'True', 'use_experimental_parser': 'False', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'empty': 'None', 'invocation_command': 'dbt test', 'debug': 'False', 'partial_parse': 'True', 'profiles_dir': '/opt/airflow/include/dbt', 'static_parser': 'True', 'no_print': 'None', 'cache_selected_only': 'False', 'version_check': 'True', 'indirect_selection': 'eager', 'printer_width': '80', 'warn_error': 'None', 'fail_fast': 'False', 'log_cache_events': 'False', 'quiet': 'False', 'log_path': '/opt/airflow/include/dbt/logs', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])'}
[0m18:27:49.444456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '669c76ba-2153-447d-b9a5-624392360f10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53c8294640>]}
[0m18:27:49.510060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '669c76ba-2153-447d-b9a5-624392360f10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53942a4b50>]}
[0m18:27:49.511692 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m18:27:49.704127 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m18:27:50.424999 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:27:50.426074 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:27:50.475272 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '669c76ba-2153-447d-b9a5-624392360f10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53c1ca1130>]}
[0m18:27:50.779689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '669c76ba-2153-447d-b9a5-624392360f10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53c1cf0ac0>]}
[0m18:27:50.781240 [info ] [MainThread]: Found 3 models, 2 sources, 600 macros
[0m18:27:50.782494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '669c76ba-2153-447d-b9a5-624392360f10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53c1cf0850>]}
[0m18:27:50.784917 [info ] [MainThread]: 
[0m18:27:50.786124 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m18:27:50.789490 [debug] [MainThread]: Command end result
[0m18:27:50.961841 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 3.3185055, "process_user_time": 4.785541, "process_kernel_time": 0.544695, "process_mem_max_rss": "255740", "process_in_blocks": "206104", "process_out_blocks": "568"}
[0m18:27:50.963309 [debug] [MainThread]: Command `dbt test` succeeded at 18:27:50.963119 after 3.32 seconds
[0m18:27:50.964371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53c8a135b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53c1ec5a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53c8294640>]}
[0m18:27:50.965354 [debug] [MainThread]: Flushing usage events
[0m10:22:54.219000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46c2995c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46c07a0f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46c07a0ee0>]}


============================== 10:22:54.244209 | 370b7b36-ce0f-49d5-91ac-b455a0c641d9 ==============================
[0m10:22:54.244209 [info ] [MainThread]: Running with dbt=1.8.9
[0m10:22:54.249612 [debug] [MainThread]: running dbt with arguments {'warn_error': 'None', 'partial_parse': 'True', 'fail_fast': 'False', 'printer_width': '80', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'quiet': 'False', 'use_colors': 'True', 'empty': 'False', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/include/dbt/', 'introspect': 'True', 'static_parser': 'True', 'log_path': '/opt/airflow/include/dbt/logs', 'target_path': 'None', 'no_print': 'None', 'debug': 'False', 'log_format': 'default', 'use_experimental_parser': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'profiles_dir': '/opt/airflow/include/dbt/', 'version_check': 'True', 'write_json': 'True'}
[0m10:22:58.805956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '370b7b36-ce0f-49d5-91ac-b455a0c641d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46c077aa30>]}
[0m10:22:59.003266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '370b7b36-ce0f-49d5-91ac-b455a0c641d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46c2cf5430>]}
[0m10:22:59.006968 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m10:22:59.548427 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m10:23:00.086280 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m10:23:00.091951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '370b7b36-ce0f-49d5-91ac-b455a0c641d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46c1ba80a0>]}
[0m10:23:06.716243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '370b7b36-ce0f-49d5-91ac-b455a0c641d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46b5fd9130>]}
[0m10:23:07.173344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '370b7b36-ce0f-49d5-91ac-b455a0c641d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46b5f46d30>]}
[0m10:23:07.177048 [info ] [MainThread]: Found 6 models, 2 sources, 600 macros
[0m10:23:07.179835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '370b7b36-ce0f-49d5-91ac-b455a0c641d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46b5fe88b0>]}
[0m10:23:07.186907 [info ] [MainThread]: 
[0m10:23:07.190462 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m10:23:07.207029 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_northern-shield-437204-m0'
[0m10:23:07.210780 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:23:07.220979 [debug] [ThreadPool]: BigQuery adapter: Got an error when attempting to create a bigquery client: 'Expecting value: line 1 column 1 (char 0)'
[0m10:23:07.226476 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:23:07.229708 [debug] [MainThread]: Connection 'list_northern-shield-437204-m0' was properly closed.
[0m10:23:07.232782 [info ] [MainThread]: 
[0m10:23:07.235822 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.04 seconds (0.04s).
[0m10:23:07.239605 [error] [MainThread]: Encountered an error:
Database Error
  Expecting value: line 1 column 1 (char 0)
[0m10:23:07.243922 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 15.340185, "process_in_blocks": "212792", "process_kernel_time": 1.162432, "process_mem_max_rss": "230580", "process_out_blocks": "0", "process_user_time": 15.363482}
[0m10:23:07.247841 [debug] [MainThread]: Command `dbt run` failed at 10:23:07.247385 after 15.34 seconds
[0m10:23:07.251740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46c2995c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46b5f46460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46b5f0c580>]}
[0m10:23:07.255205 [debug] [MainThread]: Flushing usage events
[0m10:23:36.498394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc19a9fc40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc1793a160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc18bfff70>]}


============================== 10:23:36.519632 | 5024ea51-df64-4e0b-ab7e-52103d82e854 ==============================
[0m10:23:36.519632 [info ] [MainThread]: Running with dbt=1.8.9
[0m10:23:36.523630 [debug] [MainThread]: running dbt with arguments {'use_experimental_parser': 'False', 'debug': 'False', 'invocation_command': 'dbt deps', 'static_parser': 'True', 'version_check': 'True', 'log_cache_events': 'False', 'log_path': '/opt/airflow/include/dbt/logs', 'use_colors': 'True', 'log_format': 'default', 'indirect_selection': 'eager', 'target_path': 'None', 'profiles_dir': '/opt/airflow/include/dbt', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'quiet': 'False', 'no_print': 'None', 'partial_parse': 'True', 'warn_error': 'None', 'write_json': 'True', 'printer_width': '80', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'introspect': 'True', 'empty': 'None'}
[0m10:23:36.866696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5024ea51-df64-4e0b-ab7e-52103d82e854', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc17941070>]}
[0m10:23:37.698576 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-c6o6euo1'
[0m10:23:37.702043 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m10:23:38.112855 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m10:23:38.116565 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m10:23:38.213510 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m10:23:38.234624 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m10:23:45.136634 [info ] [MainThread]: Installed from version 1.3.0
[0m10:23:45.141374 [info ] [MainThread]: Up to date!
[0m10:23:45.144904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '5024ea51-df64-4e0b-ab7e-52103d82e854', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc18bdb9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc178839a0>]}
[0m10:23:45.151862 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 8.885467, "process_in_blocks": "160", "process_kernel_time": 0.560855, "process_mem_max_rss": "95592", "process_out_blocks": "176", "process_user_time": 5.748772}
[0m10:23:45.156235 [debug] [MainThread]: Command `dbt deps` succeeded at 10:23:45.155430 after 8.89 seconds
[0m10:23:45.159540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc19a9fc40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc18bdb9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc177a3100>]}
[0m10:23:45.162709 [debug] [MainThread]: Flushing usage events
[0m10:25:49.555384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f5b855c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f59652f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f59652f10>]}


============================== 10:25:49.573367 | 49ef76a6-6390-409c-a6d2-f97208234e81 ==============================
[0m10:25:49.573367 [info ] [MainThread]: Running with dbt=1.8.9
[0m10:25:49.577287 [debug] [MainThread]: running dbt with arguments {'log_cache_events': 'False', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'partial_parse': 'True', 'profiles_dir': '/opt/airflow/include/dbt/', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/include/dbt/', 'log_path': '/opt/airflow/include/dbt/logs', 'empty': 'False', 'cache_selected_only': 'False', 'static_parser': 'True', 'version_check': 'True', 'target_path': 'None', 'indirect_selection': 'eager', 'quiet': 'False', 'debug': 'False', 'use_colors': 'True', 'no_print': 'None', 'log_format': 'default', 'use_experimental_parser': 'False', 'introspect': 'True', 'warn_error': 'None', 'printer_width': '80', 'fail_fast': 'False'}
[0m10:25:52.426748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '49ef76a6-6390-409c-a6d2-f97208234e81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f596376d0>]}
[0m10:25:52.588907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '49ef76a6-6390-409c-a6d2-f97208234e81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f22f3deb0>]}
[0m10:25:52.592993 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m10:25:53.119454 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m10:25:54.430363 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:25:54.433679 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:25:54.551118 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '49ef76a6-6390-409c-a6d2-f97208234e81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f54a46130>]}
[0m10:25:55.112473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '49ef76a6-6390-409c-a6d2-f97208234e81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f5a3299d0>]}
[0m10:25:55.116168 [info ] [MainThread]: Found 6 models, 2 sources, 600 macros
[0m10:25:55.120540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '49ef76a6-6390-409c-a6d2-f97208234e81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f54a9ea60>]}
[0m10:25:55.127217 [info ] [MainThread]: 
[0m10:25:55.130878 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m10:25:55.147120 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_northern-shield-437204-m0'
[0m10:25:55.150930 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:25:55.160144 [debug] [ThreadPool]: BigQuery adapter: Got an error when attempting to create a bigquery client: 'Expecting value: line 1 column 1 (char 0)'
[0m10:25:55.164885 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:25:55.169046 [debug] [MainThread]: Connection 'list_northern-shield-437204-m0' was properly closed.
[0m10:25:55.172305 [info ] [MainThread]: 
[0m10:25:55.175454 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.04 seconds (0.04s).
[0m10:25:55.183844 [error] [MainThread]: Encountered an error:
Database Error
  Expecting value: line 1 column 1 (char 0)
[0m10:25:55.188302 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 7.9013577, "process_in_blocks": "0", "process_kernel_time": 0.880128, "process_mem_max_rss": "225152", "process_out_blocks": "0", "process_user_time": 9.768455}
[0m10:25:55.192011 [debug] [MainThread]: Command `dbt run` failed at 10:25:55.191626 after 7.91 seconds
[0m10:25:55.195147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f5b855c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f59698af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f59698f70>]}
[0m10:25:55.198314 [debug] [MainThread]: Flushing usage events
[0m10:27:37.370827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1a7779d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1a69b33a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1a5587c70>]}


============================== 10:27:37.388953 | f7d83c73-ef20-452d-9829-a477485ddbaf ==============================
[0m10:27:37.388953 [info ] [MainThread]: Running with dbt=1.8.9
[0m10:27:37.394623 [debug] [MainThread]: running dbt with arguments {'indirect_selection': 'eager', 'log_format': 'default', 'log_path': '/opt/airflow/include/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'invocation_command': 'dbt debug --profiles-dir /opt/airflow/include/dbt/', 'write_json': 'True', 'introspect': 'True', 'fail_fast': 'False', 'target_path': 'None', 'partial_parse': 'True', 'version_check': 'True', 'use_experimental_parser': 'False', 'profiles_dir': '/opt/airflow/include/dbt/', 'cache_selected_only': 'False', 'log_cache_events': 'False', 'no_print': 'None', 'use_colors': 'True', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True', 'empty': 'None', 'printer_width': '80', 'static_parser': 'True'}
[0m10:27:37.420411 [info ] [MainThread]: dbt version: 1.8.9
[0m10:27:37.423513 [info ] [MainThread]: python version: 3.9.19
[0m10:27:37.426639 [info ] [MainThread]: python path: /opt/airflow/dbt_venv/bin/python
[0m10:27:37.429488 [info ] [MainThread]: os info: Linux-5.15.167.4-microsoft-standard-WSL2-x86_64-with-glibc2.36
[0m10:27:40.291011 [info ] [MainThread]: Using profiles dir at /opt/airflow/include/dbt/
[0m10:27:40.294084 [info ] [MainThread]: Using profiles.yml file at /opt/airflow/include/dbt/profiles.yml
[0m10:27:40.297112 [info ] [MainThread]: Using dbt_project.yml file at /opt/airflow/include/dbt/dbt_project.yml
[0m10:27:40.299997 [info ] [MainThread]: adapter type: bigquery
[0m10:27:40.302963 [info ] [MainThread]: adapter version: 1.8.3
[0m10:27:40.714098 [info ] [MainThread]: Configuration:
[0m10:27:40.717546 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m10:27:40.721401 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m10:27:40.724836 [info ] [MainThread]: Required dependencies:
[0m10:27:40.727998 [debug] [MainThread]: Executing "git --help"
[0m10:27:40.748927 [info ] [MainThread]:  - git [[31mERROR[0m]

[0m10:27:40.752770 [info ] [MainThread]: Connection:
[0m10:27:40.757216 [info ] [MainThread]:   method: service-account
[0m10:27:40.760032 [info ] [MainThread]:   database: northern-shield-437204-m0
[0m10:27:40.762785 [info ] [MainThread]:   execution_project: northern-shield-437204-m0
[0m10:27:40.766180 [info ] [MainThread]:   schema: nyc_taxi
[0m10:27:40.769038 [info ] [MainThread]:   location: us-central1
[0m10:27:40.772716 [info ] [MainThread]:   priority: None
[0m10:27:40.776530 [info ] [MainThread]:   maximum_bytes_billed: None
[0m10:27:40.779559 [info ] [MainThread]:   impersonate_service_account: None
[0m10:27:40.783461 [info ] [MainThread]:   job_retry_deadline_seconds: None
[0m10:27:40.786755 [info ] [MainThread]:   job_retries: 1
[0m10:27:40.789968 [info ] [MainThread]:   job_creation_timeout_seconds: None
[0m10:27:40.793701 [info ] [MainThread]:   job_execution_timeout_seconds: 300
[0m10:27:40.796968 [info ] [MainThread]:   timeout_seconds: 300
[0m10:27:40.801729 [info ] [MainThread]:   client_id: None
[0m10:27:40.804458 [info ] [MainThread]:   token_uri: None
[0m10:27:40.807345 [info ] [MainThread]:   dataproc_region: None
[0m10:27:40.810833 [info ] [MainThread]:   dataproc_cluster_name: None
[0m10:27:40.814104 [info ] [MainThread]:   gcs_bucket: None
[0m10:27:40.817364 [info ] [MainThread]:   dataproc_batch: None
[0m10:27:40.820721 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m10:27:41.183031 [debug] [MainThread]: Acquiring new bigquery connection 'debug'
[0m10:27:41.186900 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:27:41.194385 [debug] [MainThread]: BigQuery adapter: Got an error when attempting to create a bigquery client: 'Expecting value: line 1 column 1 (char 0)'
[0m10:27:41.197702 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m10:27:41.200717 [info ] [MainThread]: [31m2 checks failed:[0m
[0m10:27:41.203686 [info ] [MainThread]: Error from git --help: User does not have permissions for this command: "git"

[0m10:27:41.206839 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  Expecting value: line 1 column 1 (char 0)

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m10:27:41.211100 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 4.0986605, "process_in_blocks": "80", "process_kernel_time": 0.574144, "process_mem_max_rss": "233040", "process_out_blocks": "0", "process_user_time": 9.327502}
[0m10:27:41.215859 [debug] [MainThread]: Command `dbt debug` failed at 10:27:41.215187 after 4.10 seconds
[0m10:27:41.219321 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m10:27:41.222677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1a7779d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa16dfe1640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa16dfe1550>]}
[0m10:27:41.226144 [debug] [MainThread]: Flushing usage events
[0m15:26:14.989016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07b6104c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07b3f53e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07b3f53df0>]}


============================== 15:26:15.014776 | f6034c5f-d104-4536-9dda-6fa6c00090a8 ==============================
[0m15:26:15.014776 [info ] [MainThread]: Running with dbt=1.8.9
[0m15:26:15.018463 [debug] [MainThread]: running dbt with arguments {'indirect_selection': 'eager', 'fail_fast': 'False', 'quiet': 'False', 'log_path': '/opt/airflow/include/dbt/logs', 'debug': 'False', 'use_experimental_parser': 'False', 'warn_error': 'None', 'cache_selected_only': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'version_check': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'log_cache_events': 'False', 'use_colors': 'True', 'target_path': 'None', 'profiles_dir': '/opt/airflow/include/dbt', 'no_print': 'None', 'write_json': 'True', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt deps', 'printer_width': '80'}
[0m15:26:15.397690 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f6034c5f-d104-4536-9dda-6fa6c00090a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07b3f8a4f0>]}
[0m15:26:16.183202 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-309nhln5'
[0m15:26:16.186163 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m15:26:17.861275 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m15:26:17.864850 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m15:26:18.012971 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m15:26:18.033771 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m15:26:24.760401 [info ] [MainThread]: Installed from version 1.3.0
[0m15:26:24.763927 [info ] [MainThread]: Up to date!
[0m15:26:24.767973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'f6034c5f-d104-4536-9dda-6fa6c00090a8', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07b526b0a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07b52625b0>]}
[0m15:26:24.775070 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 10.02375, "process_in_blocks": "18472", "process_kernel_time": 0.657937, "process_mem_max_rss": "95632", "process_out_blocks": "176", "process_user_time": 5.674711}
[0m15:26:24.782194 [debug] [MainThread]: Command `dbt deps` succeeded at 15:26:24.781390 after 10.03 seconds
[0m15:26:24.787892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07b6104c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07b53053d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07b3f19b80>]}
[0m15:26:24.791757 [debug] [MainThread]: Flushing usage events
[0m15:27:00.915726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb7d200c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb7b00ff40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb7b00fee0>]}


============================== 15:27:00.934221 | f776a6d2-d09a-42c5-b6ac-877210e1fb7a ==============================
[0m15:27:00.934221 [info ] [MainThread]: Running with dbt=1.8.9
[0m15:27:00.938385 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'log_path': '/opt/airflow/include/dbt/logs', 'fail_fast': 'False', 'static_parser': 'True', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'send_anonymous_usage_stats': 'True', 'debug': 'False', 'empty': 'False', 'quiet': 'False', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/include/dbt/', 'indirect_selection': 'eager', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'partial_parse': 'True', 'log_cache_events': 'False', 'log_format': 'default', 'no_print': 'None', 'profiles_dir': '/opt/airflow/include/dbt/', 'use_experimental_parser': 'False', 'target_path': 'None', 'cache_selected_only': 'False'}
[0m15:27:04.620774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f776a6d2-d09a-42c5-b6ac-877210e1fb7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb7c9b4eb0>]}
[0m15:27:04.795446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f776a6d2-d09a-42c5-b6ac-877210e1fb7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb43b0d0d0>]}
[0m15:27:04.799339 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m15:27:05.388519 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m15:27:05.796488 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:27:05.799527 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:27:05.928844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f776a6d2-d09a-42c5-b6ac-877210e1fb7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb76447130>]}
[0m15:27:06.586351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f776a6d2-d09a-42c5-b6ac-877210e1fb7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb7b7a2490>]}
[0m15:27:06.589912 [info ] [MainThread]: Found 6 models, 2 sources, 600 macros
[0m15:27:06.593383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f776a6d2-d09a-42c5-b6ac-877210e1fb7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb7649a2b0>]}
[0m15:27:06.600915 [info ] [MainThread]: 
[0m15:27:06.604645 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:27:06.622363 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_northern-shield-437204-m0'
[0m15:27:06.626293 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:27:06.635898 [debug] [ThreadPool]: BigQuery adapter: Got an error when attempting to create a bigquery client: 'Expecting value: line 1 column 1 (char 0)'
[0m15:27:06.641647 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:27:06.645495 [debug] [MainThread]: Connection 'list_northern-shield-437204-m0' was properly closed.
[0m15:27:06.648838 [info ] [MainThread]: 
[0m15:27:06.652205 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.04 seconds (0.04s).
[0m15:27:06.659868 [error] [MainThread]: Encountered an error:
Database Error
  Expecting value: line 1 column 1 (char 0)
[0m15:27:06.664662 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 8.717416, "process_in_blocks": "115912", "process_kernel_time": 0.876719, "process_mem_max_rss": "233108", "process_out_blocks": "0", "process_user_time": 10.464068}
[0m15:27:06.669388 [debug] [MainThread]: Command `dbt run` failed at 15:27:06.668819 after 8.72 seconds
[0m15:27:06.673107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb7d200c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb7afe5280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb7afe5910>]}
[0m15:27:06.677142 [debug] [MainThread]: Flushing usage events
[0m15:27:31.939466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68fb2c4f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68f9140340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68f9140850>]}


============================== 15:27:31.958783 | 98d705fb-49e6-4ec0-bd1a-c06dd494f149 ==============================
[0m15:27:31.958783 [info ] [MainThread]: Running with dbt=1.8.9
[0m15:27:31.963109 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'target_path': 'None', 'log_cache_events': 'False', 'static_parser': 'True', 'invocation_command': 'dbt debug --profiles-dir /opt/airflow/include/dbt/', 'introspect': 'True', 'printer_width': '80', 'write_json': 'True', 'log_path': '/opt/airflow/include/dbt/logs', 'empty': 'None', 'profiles_dir': '/opt/airflow/include/dbt/', 'indirect_selection': 'eager', 'log_format': 'default', 'quiet': 'False', 'no_print': 'None', 'cache_selected_only': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'warn_error': 'None', 'debug': 'False', 'send_anonymous_usage_stats': 'True'}
[0m15:27:31.988009 [info ] [MainThread]: dbt version: 1.8.9
[0m15:27:31.991289 [info ] [MainThread]: python version: 3.9.19
[0m15:27:31.994614 [info ] [MainThread]: python path: /opt/airflow/dbt_venv/bin/python
[0m15:27:31.998063 [info ] [MainThread]: os info: Linux-5.15.167.4-microsoft-standard-WSL2-x86_64-with-glibc2.36
[0m15:27:35.145172 [info ] [MainThread]: Using profiles dir at /opt/airflow/include/dbt/
[0m15:27:35.149099 [info ] [MainThread]: Using profiles.yml file at /opt/airflow/include/dbt/profiles.yml
[0m15:27:35.152456 [info ] [MainThread]: Using dbt_project.yml file at /opt/airflow/include/dbt/dbt_project.yml
[0m15:27:35.155913 [info ] [MainThread]: adapter type: bigquery
[0m15:27:35.159308 [info ] [MainThread]: adapter version: 1.8.3
[0m15:27:35.463722 [info ] [MainThread]: Configuration:
[0m15:27:35.466929 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m15:27:35.470140 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m15:27:35.473276 [info ] [MainThread]: Required dependencies:
[0m15:27:35.476689 [debug] [MainThread]: Executing "git --help"
[0m15:27:35.522593 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m15:27:35.526833 [debug] [MainThread]: STDERR: "b''"
[0m15:27:35.530111 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m15:27:35.533465 [info ] [MainThread]: Connection:
[0m15:27:35.536966 [info ] [MainThread]:   method: service-account
[0m15:27:35.539765 [info ] [MainThread]:   database: northern-shield-437204-m0
[0m15:27:35.542956 [info ] [MainThread]:   execution_project: northern-shield-437204-m0
[0m15:27:35.545778 [info ] [MainThread]:   schema: nyc_taxi
[0m15:27:35.549068 [info ] [MainThread]:   location: us-central1
[0m15:27:35.552044 [info ] [MainThread]:   priority: None
[0m15:27:35.555276 [info ] [MainThread]:   maximum_bytes_billed: None
[0m15:27:35.558214 [info ] [MainThread]:   impersonate_service_account: None
[0m15:27:35.561251 [info ] [MainThread]:   job_retry_deadline_seconds: None
[0m15:27:35.564294 [info ] [MainThread]:   job_retries: 1
[0m15:27:35.567314 [info ] [MainThread]:   job_creation_timeout_seconds: None
[0m15:27:35.570875 [info ] [MainThread]:   job_execution_timeout_seconds: 300
[0m15:27:35.574242 [info ] [MainThread]:   timeout_seconds: 300
[0m15:27:35.577234 [info ] [MainThread]:   client_id: None
[0m15:27:35.580370 [info ] [MainThread]:   token_uri: None
[0m15:27:35.583397 [info ] [MainThread]:   dataproc_region: None
[0m15:27:35.586637 [info ] [MainThread]:   dataproc_cluster_name: None
[0m15:27:35.590270 [info ] [MainThread]:   gcs_bucket: None
[0m15:27:35.593638 [info ] [MainThread]:   dataproc_batch: None
[0m15:27:35.597594 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m15:27:35.975365 [debug] [MainThread]: Acquiring new bigquery connection 'debug'
[0m15:27:35.980059 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:27:35.989995 [debug] [MainThread]: BigQuery adapter: Got an error when attempting to create a bigquery client: 'Expecting value: line 1 column 1 (char 0)'
[0m15:27:35.993575 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m15:27:35.996304 [info ] [MainThread]: [31m1 check failed:[0m
[0m15:27:36.000722 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  Expecting value: line 1 column 1 (char 0)

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m15:27:36.005943 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 4.277078, "process_in_blocks": "1584", "process_kernel_time": 0.743786, "process_mem_max_rss": "227460", "process_out_blocks": "0", "process_user_time": 9.687593}
[0m15:27:36.010660 [debug] [MainThread]: Command `dbt debug` failed at 15:27:36.009974 after 4.28 seconds
[0m15:27:36.013783 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m15:27:36.017038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68fb2c4f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68c1bcad90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68c1bcafa0>]}
[0m15:27:36.020275 [debug] [MainThread]: Flushing usage events
[0m15:30:08.102944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f249d5c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f22821790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f23bdf4c0>]}


============================== 15:30:08.124791 | e7024c0c-a7d8-4db8-a16d-d21a606d6d4a ==============================
[0m15:30:08.124791 [info ] [MainThread]: Running with dbt=1.8.9
[0m15:30:08.131547 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'write_json': 'True', 'log_path': '/opt/airflow/include/dbt/logs', 'profiles_dir': '/opt/airflow/include/dbt/', 'partial_parse': 'True', 'log_cache_events': 'False', 'invocation_command': 'dbt debug --profiles-dir /opt/airflow/include/dbt/', 'debug': 'False', 'target_path': 'None', 'fail_fast': 'False', 'printer_width': '80', 'cache_selected_only': 'False', 'no_print': 'None', 'indirect_selection': 'eager', 'version_check': 'True', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'static_parser': 'True', 'use_experimental_parser': 'False'}
[0m15:30:08.164369 [info ] [MainThread]: dbt version: 1.8.9
[0m15:30:08.167598 [info ] [MainThread]: python version: 3.9.19
[0m15:30:08.171151 [info ] [MainThread]: python path: /opt/airflow/dbt_venv/bin/python
[0m15:30:08.174746 [info ] [MainThread]: os info: Linux-5.15.167.4-microsoft-standard-WSL2-x86_64-with-glibc2.36
[0m15:30:10.733333 [info ] [MainThread]: Using profiles dir at /opt/airflow/include/dbt/
[0m15:30:10.737314 [info ] [MainThread]: Using profiles.yml file at /opt/airflow/include/dbt/profiles.yml
[0m15:30:10.740746 [info ] [MainThread]: Using dbt_project.yml file at /opt/airflow/include/dbt/dbt_project.yml
[0m15:30:10.745176 [info ] [MainThread]: adapter type: bigquery
[0m15:30:10.749340 [info ] [MainThread]: adapter version: 1.8.3
[0m15:30:11.056485 [info ] [MainThread]: Configuration:
[0m15:30:11.059670 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m15:30:11.064078 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m15:30:11.066791 [info ] [MainThread]: Required dependencies:
[0m15:30:11.070217 [debug] [MainThread]: Executing "git --help"
[0m15:30:11.090333 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m15:30:11.094867 [debug] [MainThread]: STDERR: "b''"
[0m15:30:11.098444 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m15:30:11.102033 [info ] [MainThread]: Connection:
[0m15:30:11.105072 [info ] [MainThread]:   method: service-account
[0m15:30:11.109171 [info ] [MainThread]:   database: northern-shield-437204-m0
[0m15:30:11.112311 [info ] [MainThread]:   execution_project: northern-shield-437204-m0
[0m15:30:11.115370 [info ] [MainThread]:   schema: nyc_taxi
[0m15:30:11.118381 [info ] [MainThread]:   location: us-central1
[0m15:30:11.121379 [info ] [MainThread]:   priority: None
[0m15:30:11.124124 [info ] [MainThread]:   maximum_bytes_billed: None
[0m15:30:11.129440 [info ] [MainThread]:   impersonate_service_account: None
[0m15:30:11.132296 [info ] [MainThread]:   job_retry_deadline_seconds: None
[0m15:30:11.135197 [info ] [MainThread]:   job_retries: 1
[0m15:30:11.138477 [info ] [MainThread]:   job_creation_timeout_seconds: None
[0m15:30:11.141389 [info ] [MainThread]:   job_execution_timeout_seconds: 300
[0m15:30:11.144868 [info ] [MainThread]:   timeout_seconds: 300
[0m15:30:11.148096 [info ] [MainThread]:   client_id: None
[0m15:30:11.151453 [info ] [MainThread]:   token_uri: None
[0m15:30:11.154832 [info ] [MainThread]:   dataproc_region: None
[0m15:30:11.158073 [info ] [MainThread]:   dataproc_cluster_name: None
[0m15:30:11.161186 [info ] [MainThread]:   gcs_bucket: None
[0m15:30:11.164610 [info ] [MainThread]:   dataproc_batch: None
[0m15:30:11.168438 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m15:30:11.529119 [debug] [MainThread]: Acquiring new bigquery connection 'debug'
[0m15:30:11.533160 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:30:11.546103 [debug] [MainThread]: On debug: select 1 as id
[0m15:30:12.748748 [debug] [MainThread]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:085c46ab-501d-4efc-8e4e-84ca85d42e55&page=queryresults
[0m15:30:13.804789 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m15:30:13.809254 [info ] [MainThread]: [32mAll checks passed![0m
[0m15:30:13.814476 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 5.949673, "process_in_blocks": "2616", "process_kernel_time": 0.610195, "process_mem_max_rss": "222988", "process_out_blocks": "0", "process_user_time": 8.823622}
[0m15:30:13.818571 [debug] [MainThread]: Command `dbt debug` succeeded at 15:30:13.817959 after 5.95 seconds
[0m15:30:13.822247 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m15:30:13.826095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f249d5c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0eeb2680d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0eeb2689d0>]}
[0m15:30:13.830044 [debug] [MainThread]: Flushing usage events
[0m15:30:22.866929 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb95a575cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9597b3af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb958385d90>]}


============================== 15:30:22.884750 | 5350db65-9f6b-42c2-9989-9e75f69da76f ==============================
[0m15:30:22.884750 [info ] [MainThread]: Running with dbt=1.8.9
[0m15:30:22.889258 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'indirect_selection': 'eager', 'log_path': '/opt/airflow/include/dbt/logs', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'static_parser': 'True', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'debug': 'False', 'use_colors': 'True', 'cache_selected_only': 'False', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/include/dbt/', 'empty': 'False', 'profiles_dir': '/opt/airflow/include/dbt/', 'warn_error': 'None', 'write_json': 'True', 'no_print': 'None', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'printer_width': '80', 'quiet': 'False'}
[0m15:30:25.798380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5350db65-9f6b-42c2-9989-9e75f69da76f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb95a885ca0>]}
[0m15:30:25.964807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5350db65-9f6b-42c2-9989-9e75f69da76f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb920f49670>]}
[0m15:30:25.968592 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m15:30:26.445619 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m15:30:29.514071 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:30:29.517802 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:30:29.681741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5350db65-9f6b-42c2-9989-9e75f69da76f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb953646130>]}
[0m15:30:30.366137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5350db65-9f6b-42c2-9989-9e75f69da76f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb95a8b6490>]}
[0m15:30:30.370175 [info ] [MainThread]: Found 6 models, 2 sources, 600 macros
[0m15:30:30.374175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5350db65-9f6b-42c2-9989-9e75f69da76f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb95a8b6f10>]}
[0m15:30:30.382138 [info ] [MainThread]: 
[0m15:30:30.387270 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:30:30.413939 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_northern-shield-437204-m0'
[0m15:30:30.418257 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:30:31.174284 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_northern-shield-437204-m0, now list_northern-shield-437204-m0_nyc_taxi)
[0m15:30:31.178308 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:30:31.989864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5350db65-9f6b-42c2-9989-9e75f69da76f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb958365c70>]}
[0m15:30:31.993697 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:30:31.996907 [info ] [MainThread]: 
[0m15:30:32.024166 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_payment
[0m15:30:32.028576 [info ] [Thread-1  ]: 1 of 6 START sql table model nyc_taxi.dim_payment .............................. [RUN]
[0m15:30:32.033631 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_northern-shield-437204-m0_nyc_taxi, now model.nyc_taxi.dim_payment)
[0m15:30:32.036588 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_payment
[0m15:30:32.074006 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_payment"
[0m15:30:32.098410 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_payment
[0m15:30:32.267139 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.dim_payment"
[0m15:30:32.286457 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:30:32.298572 [debug] [Thread-1  ]: On model.nyc_taxi.dim_payment: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.dim_payment"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`dim_payment`
      
    
    

    OPTIONS()
    as (
      WITH payment_cte AS(
    payment_type AS type_id,
    CASE 
        WHEN payment_type = 1 THEN "Credit card"
        WHEN payment_type = 2 THEN "Cash"
        WHEN payment_type = 3 THEN "No charge"
        WHEN payment_type = 4 THEN "Dispute"
        WHEN payment_type = 5 THEN "Unknown"
        WHEN payment_type = 6 THEN "Voided trip"
    END AS payment_name
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata`
)
SELECT
    type_id,
    payment_name
FROM payment_cte
    );
  
[0m15:30:33.206198 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:76aa6eb6-0a83-41c0-ac8d-53c06b3e24f3&page=queryresults
[0m15:30:33.211002 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Unexpected identifier "payment_type" at [14:5]; reason: invalidQuery, location: query, message: Syntax error: Unexpected identifier "payment_type" at [14:5]')
[0m15:30:34.423769 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:d1bd23d4-1f17-47ae-9384-5f80c74d3ccb&page=queryresults
[0m15:30:34.428783 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:d1bd23d4-1f17-47ae-9384-5f80c74d3ccb&page=queryresults
[0m15:30:34.443801 [debug] [Thread-1  ]: Database Error in model dim_payment (models/transform/dim_payment.sql)
  Syntax error: Unexpected identifier "payment_type" at [14:5]
  compiled code at target/run/nyc_taxi/models/transform/dim_payment.sql
[0m15:30:34.453638 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5350db65-9f6b-42c2-9989-9e75f69da76f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb920f05d60>]}
[0m15:30:34.458002 [error] [Thread-1  ]: 1 of 6 ERROR creating sql table model nyc_taxi.dim_payment ..................... [[31mERROR[0m in 2.41s]
[0m15:30:34.465077 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_payment
[0m15:30:34.470112 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_ratecode
[0m15:30:34.475679 [info ] [Thread-1  ]: 2 of 6 START sql table model nyc_taxi.dim_ratecode ............................. [RUN]
[0m15:30:34.481887 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_payment, now model.nyc_taxi.dim_ratecode)
[0m15:30:34.485849 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_ratecode
[0m15:30:34.507081 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_ratecode"
[0m15:30:34.530829 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_ratecode
[0m15:30:34.545594 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.dim_ratecode"
[0m15:30:34.566866 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:30:34.576855 [debug] [Thread-1  ]: On model.nyc_taxi.dim_ratecode: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.dim_ratecode"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`dim_ratecode`
      
    
    

    OPTIONS()
    as (
      WITH rate_code_cte AS(
    rate_code_id AS rate_id,
    CASE 
        WHEN rate_code_id = 1 THEN "Standard rate"
        WHEN rate_code_id = 2 THEN "JFK"
        WHEN rate_code_id = 3 THEN "Newark"
        WHEN rate_code_id = 4 THEN "Nassau or Westchester"
        WHEN rate_code_id = 5 THEN "Negotiated fare"
        WHEN rate_code_id = 6 THEN "Group ride"
    END AS rate_code_name
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata`
)
SELECT
    rate_id,
    rate_code_name
FROM rate_code_cte
    );
  
[0m15:30:35.264724 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:bdbc2f2f-4a76-4400-ac3e-918d99bdb98e&page=queryresults
[0m15:30:35.271221 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Unexpected identifier "rate_code_id" at [14:5]; reason: invalidQuery, location: query, message: Syntax error: Unexpected identifier "rate_code_id" at [14:5]')
[0m15:30:35.724063 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:bb0eb3a6-a629-415a-842c-d3e431eadec5&page=queryresults
[0m15:30:35.728143 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:bb0eb3a6-a629-415a-842c-d3e431eadec5&page=queryresults
[0m15:30:35.734563 [debug] [Thread-1  ]: Database Error in model dim_ratecode (models/transform/dim_ratecode.sql)
  Syntax error: Unexpected identifier "rate_code_id" at [14:5]
  compiled code at target/run/nyc_taxi/models/transform/dim_ratecode.sql
[0m15:30:35.738496 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5350db65-9f6b-42c2-9989-9e75f69da76f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb920f8c6a0>]}
[0m15:30:35.742511 [error] [Thread-1  ]: 2 of 6 ERROR creating sql table model nyc_taxi.dim_ratecode .................... [[31mERROR[0m in 1.26s]
[0m15:30:35.747379 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_ratecode
[0m15:30:35.751579 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_time
[0m15:30:35.755673 [info ] [Thread-1  ]: 3 of 6 START sql table model nyc_taxi.dim_time ................................. [RUN]
[0m15:30:35.759435 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_ratecode, now model.nyc_taxi.dim_time)
[0m15:30:35.763186 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_time
[0m15:30:35.777231 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_time"
[0m15:30:35.800162 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_time
[0m15:30:35.815479 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.dim_time"
[0m15:30:35.840231 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:30:35.851210 [debug] [Thread-1  ]: On model.nyc_taxi.dim_time: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.dim_time"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`dim_time`
      
    
    

    OPTIONS()
    as (
      WITH datetime_cte AS (
    SELECT DISTINCT
        ROW_NUMBER() OVER () AS time_id,
        DATE(lpep_pickup_datetime) AS date,
        lpep_pickup_datetime AS date_part 
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata`
)
SELECT
    time_id,
    date,
    EXTRACT(YEAR FROM date_part) AS year,
    EXTRACT(MONTH FROM date_part) AS month,
    EXTRACT(DAY FROM date_part) AS day,
    EXTRACT(HOUR FROM date_part) AS hour,
    EXTRACT(MINUTE FROM date_part) AS minute,
    FORMAT_TIMESTAMP('%A', date_part) AS weekday,
    TIMESTAMP_TRUNC(date_part, HOUR) AS time
FROM datetime_cte
    );
  
[0m15:30:36.939509 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:4c02b484-c9d6-4c01-bb83-947c3f5ea666&page=queryresults
[0m15:30:40.744970 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5350db65-9f6b-42c2-9989-9e75f69da76f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb921cb7c70>]}
[0m15:30:40.749434 [info ] [Thread-1  ]: 3 of 6 OK created sql table model nyc_taxi.dim_time ............................ [[32mCREATE TABLE (59.3k rows, 463.5 KiB processed)[0m in 4.99s]
[0m15:30:40.754277 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_time
[0m15:30:40.758712 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_vendor
[0m15:30:40.763046 [info ] [Thread-1  ]: 4 of 6 START sql table model nyc_taxi.dim_vendor ............................... [RUN]
[0m15:30:40.767623 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_time, now model.nyc_taxi.dim_vendor)
[0m15:30:40.773697 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_vendor
[0m15:30:40.789282 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_vendor"
[0m15:30:40.819802 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_vendor
[0m15:30:40.836317 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.dim_vendor"
[0m15:30:40.860156 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:30:40.871115 [debug] [Thread-1  ]: On model.nyc_taxi.dim_vendor: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.dim_vendor"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`dim_vendor`
      
    
    

    OPTIONS()
    as (
      WITH vendor_cte AS(
    vendor_id AS id,
    CASE 
        WHEN vendor_id = 1 THEN "Creative Mobile Technologies"
        WHEN vendor_id = 2 THEN "VeriFone Inc."
    END AS vendor_name
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata`
)
SELECT
    id,
    vendor_name
FROM vendor_cte
    );
  
[0m15:30:41.538513 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:828773c0-412d-4162-a8f8-920cc462d4e8&page=queryresults
[0m15:30:41.543512 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Unexpected identifier "vendor_id" at [14:5]; reason: invalidQuery, location: query, message: Syntax error: Unexpected identifier "vendor_id" at [14:5]')
[0m15:30:42.790763 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:ce2135c6-ab72-4fd7-a99e-b19edd8afbbe&page=queryresults
[0m15:30:42.796300 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:ce2135c6-ab72-4fd7-a99e-b19edd8afbbe&page=queryresults
[0m15:30:42.803645 [debug] [Thread-1  ]: Database Error in model dim_vendor (models/transform/dim_vendor.sql)
  Syntax error: Unexpected identifier "vendor_id" at [14:5]
  compiled code at target/run/nyc_taxi/models/transform/dim_vendor.sql
[0m15:30:42.807286 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5350db65-9f6b-42c2-9989-9e75f69da76f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb95903e130>]}
[0m15:30:42.811859 [error] [Thread-1  ]: 4 of 6 ERROR creating sql table model nyc_taxi.dim_vendor ...................... [[31mERROR[0m in 2.04s]
[0m15:30:42.817051 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_vendor
[0m15:30:42.821618 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_zone
[0m15:30:42.826153 [info ] [Thread-1  ]: 5 of 6 START sql table model nyc_taxi.dim_zone ................................. [RUN]
[0m15:30:42.834511 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_vendor, now model.nyc_taxi.dim_zone)
[0m15:30:42.838308 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_zone
[0m15:30:42.854724 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_zone"
[0m15:30:42.879186 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_zone
[0m15:30:42.895716 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.dim_zone"
[0m15:30:42.921260 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:30:42.932673 [debug] [Thread-1  ]: On model.nyc_taxi.dim_zone: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.dim_zone"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`dim_zone`
      
    
    

    OPTIONS()
    as (
      SELECT
    location_id,
    borough,
    zone,
    replace(service_zone, 'Boro', 'Green') as service_zone
FROM `northern-shield-437204-m0`.`nyc_taxi`.`zone_map`
    );
  
[0m15:30:44.012275 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:a3faa20d-e3a4-4c72-a433-a3698637ea04&page=queryresults
[0m15:30:44.954982 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5350db65-9f6b-42c2-9989-9e75f69da76f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb920f05760>]}
[0m15:30:44.959579 [info ] [Thread-1  ]: 5 of 6 OK created sql table model nyc_taxi.dim_zone ............................ [[32mCREATE TABLE (265.0 rows, 12.1 KiB processed)[0m in 2.12s]
[0m15:30:44.964436 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_zone
[0m15:30:44.968417 [debug] [Thread-1  ]: Began running node model.nyc_taxi.fct_trips
[0m15:30:44.972619 [info ] [Thread-1  ]: 6 of 6 START sql table model nyc_taxi.fct_trips ................................ [RUN]
[0m15:30:44.982958 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_zone, now model.nyc_taxi.fct_trips)
[0m15:30:44.987231 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.fct_trips
[0m15:30:45.071818 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.fct_trips"
[0m15:30:45.100124 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.fct_trips
[0m15:30:45.113595 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.fct_trips"
[0m15:30:45.140145 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:30:45.153496 [debug] [Thread-1  ]: On model.nyc_taxi.fct_trips: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.fct_trips"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips`
      
    
    

    OPTIONS()
    as (
      WITH tripdata_cte AS (
    SELECT 
        to_hex(md5(cast(coalesce(cast(vendor_id as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(lpep_pickup_datetime as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(lpep_dropoff_datetime as string), '_dbt_utils_surrogate_key_null_') as string)))  AS trip_id,
        t.vendor_id,
        t.lpep_pickup_datetime,
        t.lpep_dropoff_datetime,
        td_pickup.time_id AS pickup_time_id,
        td_dropoff.time_id AS dropoff_time_id,
        t.rate_code_id,
        t.pu_location_id,
        t.do_location_id,
        t.passenger_count,
        t.trip_distance,
        t.fare_amount,
        t.extra,
        t.mta_tax,
        t.tip_amount,
        t.tolls_amount,
        t.improvement_surcharge,
        t.total_amount,
        t.payment_type,
        t.trip_type,
        t.congestion_surcharge
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata` AS t
    LEFT JOIN `northern-shield-437204-m0`.`nyc_taxi`.`dim_time` AS td_pickup
        ON TIMESTAMP_TRUNC(t.lpep_pickup_datetime, HOUR) = td_pickup.time
    LEFT JOIN `northern-shield-437204-m0`.`nyc_taxi`.`dim_time` AS td_dropoff
        ON TIMESTAMP_TRUNC(t.lpep_dropoff_datetime, HOUR) = td_dropoff.time
    WHERE vendor_id IS NOT NULL

    -- Incremental Filter
    
      AND DATE(lpep_pickup_datetime) >= '2023-01-01'
      AND DATE(lpep_pickup_datetime) <= '2023-01-31'
    
)
SELECT 
    trip_id,
    vendor_id,
    pickup_time_id,
    dropoff_time_id,
    rate_code_id,
    pu_location_id,
    do_location_id,
    passenger_count,
    trip_distance,
    fare_amount,
    extra,
    mta_tax,
    tip_amount,
    tolls_amount,
    improvement_surcharge,
    total_amount,
    payment_type,
    trip_type,
    congestion_surcharge
FROM tripdata_cte
    );
  
[0m15:30:46.204890 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:664e2900-5e64-4e4c-be7d-9910842b36d9&page=queryresults
[0m15:35:20.990452 [debug] [Thread-1  ]: BigQuery adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.fct_trips"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips`
      
    
    

    OPTIONS()
    as (
      WITH tripdata_cte AS (
    SELECT 
        to_hex(md5(cast(coalesce(cast(vendor_id as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(lpep_pickup_datetime as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(lpep_dropoff_datetime as string), '_dbt_utils_surrogate_key_null_') as string)))  AS trip_id,
        t.vendor_id,
        t.lpep_pickup_datetime,
        t.lpep_dropoff_datetime,
        td_pickup.time_id AS pickup_time_id,
        td_dropoff.time_id AS dropoff_time_id,
        t.rate_code_id,
        t.pu_location_id,
        t.do_location_id,
        t.passenger_count,
        t.trip_distance,
        t.fare_amount,
        t.extra,
        t.mta_tax,
        t.tip_amount,
        t.tolls_amount,
        t.improvement_surcharge,
        t.total_amount,
        t.payment_type,
        t.trip_type,
        t.congestion_surcharge
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata` AS t
    LEFT JOIN `northern-shield-437204-m0`.`nyc_taxi`.`dim_time` AS td_pickup
        ON TIMESTAMP_TRUNC(t.lpep_pickup_datetime, HOUR) = td_pickup.time
    LEFT JOIN `northern-shield-437204-m0`.`nyc_taxi`.`dim_time` AS td_dropoff
        ON TIMESTAMP_TRUNC(t.lpep_dropoff_datetime, HOUR) = td_dropoff.time
    WHERE vendor_id IS NOT NULL

    -- Incremental Filter
    
      AND DATE(lpep_pickup_datetime) >= '2023-01-01'
      AND DATE(lpep_pickup_datetime) <= '2023-01-31'
    
)
SELECT 
    trip_id,
    vendor_id,
    pickup_time_id,
    dropoff_time_id,
    rate_code_id,
    pu_location_id,
    do_location_id,
    passenger_count,
    trip_distance,
    fare_amount,
    extra,
    mta_tax,
    tip_amount,
    tolls_amount,
    improvement_surcharge,
    total_amount,
    payment_type,
    trip_type,
    congestion_surcharge
FROM tripdata_cte
    );
  
[0m15:35:20.995431 [debug] [Thread-1  ]: BigQuery adapter: Operation did not complete within the designated timeout of 300 seconds.
[0m15:35:21.003792 [debug] [Thread-1  ]: Runtime Error in model fct_trips (models/transform/fct_trips.sql)
  Operation did not complete within the designated timeout of 300 seconds.
[0m15:35:21.007408 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5350db65-9f6b-42c2-9989-9e75f69da76f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9583bc640>]}
[0m15:35:21.012908 [error] [Thread-1  ]: 6 of 6 ERROR creating sql table model nyc_taxi.fct_trips ....................... [[31mERROR[0m in 276.02s]
[0m15:35:21.018944 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.fct_trips
[0m15:35:21.026007 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:35:21.028735 [debug] [MainThread]: Connection 'model.nyc_taxi.fct_trips' was properly closed.
[0m15:35:21.032638 [info ] [MainThread]: 
[0m15:35:21.035835 [info ] [MainThread]: Finished running 6 table models in 0 hours 4 minutes and 50.65 seconds (290.65s).
[0m15:35:21.047055 [debug] [MainThread]: Command end result
[0m15:35:21.271150 [info ] [MainThread]: 
[0m15:35:21.274274 [info ] [MainThread]: [31mCompleted with 4 errors and 0 warnings:[0m
[0m15:35:21.277399 [info ] [MainThread]: 
[0m15:35:21.280835 [error] [MainThread]:   Database Error in model dim_payment (models/transform/dim_payment.sql)
  Syntax error: Unexpected identifier "payment_type" at [14:5]
  compiled code at target/run/nyc_taxi/models/transform/dim_payment.sql
[0m15:35:21.284215 [info ] [MainThread]: 
[0m15:35:21.288015 [error] [MainThread]:   Database Error in model dim_ratecode (models/transform/dim_ratecode.sql)
  Syntax error: Unexpected identifier "rate_code_id" at [14:5]
  compiled code at target/run/nyc_taxi/models/transform/dim_ratecode.sql
[0m15:35:21.290833 [info ] [MainThread]: 
[0m15:35:21.295176 [error] [MainThread]:   Database Error in model dim_vendor (models/transform/dim_vendor.sql)
  Syntax error: Unexpected identifier "vendor_id" at [14:5]
  compiled code at target/run/nyc_taxi/models/transform/dim_vendor.sql
[0m15:35:21.298656 [info ] [MainThread]: 
[0m15:35:21.302282 [error] [MainThread]:   Runtime Error in model fct_trips (models/transform/fct_trips.sql)
  Operation did not complete within the designated timeout of 300 seconds.
[0m15:35:21.305369 [info ] [MainThread]: 
[0m15:35:21.309220 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=4 SKIP=0 TOTAL=6
[0m15:35:21.315687 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 328.65454, "process_in_blocks": "0", "process_kernel_time": 0.837672, "process_mem_max_rss": "227184", "process_out_blocks": "0", "process_user_time": 12.012983}
[0m15:35:21.319725 [debug] [MainThread]: Command `dbt run` failed at 15:35:21.319181 after 328.66 seconds
[0m15:35:21.323374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb95a575cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb959086d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb953414940>]}
[0m15:35:21.326388 [debug] [MainThread]: Flushing usage events
[0m15:41:22.542055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc89ee1dca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc89df86400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc89cc2cd30>]}


============================== 15:41:22.565436 | bbd4f112-d810-43c0-888c-62db4500224c ==============================
[0m15:41:22.565436 [info ] [MainThread]: Running with dbt=1.8.9
[0m15:41:22.570423 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'introspect': 'True', 'cache_selected_only': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'use_colors': 'True', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'use_experimental_parser': 'False', 'log_format': 'default', 'log_path': '/opt/airflow/include/dbt/logs', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'warn_error': 'None', 'profiles_dir': '/opt/airflow/include/dbt/', 'quiet': 'False', 'debug': 'False', 'version_check': 'True', 'empty': 'False', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/include/dbt/', 'write_json': 'True', 'indirect_selection': 'eager', 'printer_width': '80'}
[0m15:41:25.891530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bbd4f112-d810-43c0-888c-62db4500224c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc89e5d0b50>]}
[0m15:41:26.104192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bbd4f112-d810-43c0-888c-62db4500224c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8657d6790>]}
[0m15:41:26.108353 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m15:41:26.640806 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m15:41:29.804761 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m15:41:29.808836 [debug] [MainThread]: Partial parsing: updated file: nyc_taxi://models/transform/dim_payment.sql
[0m15:41:29.812809 [debug] [MainThread]: Partial parsing: updated file: nyc_taxi://models/transform/dim_vendor.sql
[0m15:41:29.816320 [debug] [MainThread]: Partial parsing: updated file: nyc_taxi://models/transform/dim_ratecode.sql
[0m15:41:31.012081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bbd4f112-d810-43c0-888c-62db4500224c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc897fefd00>]}
[0m15:41:31.475587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bbd4f112-d810-43c0-888c-62db4500224c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc89818b0d0>]}
[0m15:41:31.479381 [info ] [MainThread]: Found 6 models, 2 sources, 600 macros
[0m15:41:31.482778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bbd4f112-d810-43c0-888c-62db4500224c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc89f12df10>]}
[0m15:41:31.493039 [info ] [MainThread]: 
[0m15:41:31.499463 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:41:31.524703 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_northern-shield-437204-m0'
[0m15:41:31.527694 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:41:32.689181 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_northern-shield-437204-m0, now list_northern-shield-437204-m0_nyc_taxi)
[0m15:41:32.692707 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:41:33.782609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bbd4f112-d810-43c0-888c-62db4500224c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc89f12dfa0>]}
[0m15:41:33.786600 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:41:33.790053 [info ] [MainThread]: 
[0m15:41:33.814225 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_payment
[0m15:41:33.818377 [info ] [Thread-1  ]: 1 of 6 START sql table model nyc_taxi.dim_payment .............................. [RUN]
[0m15:41:33.822518 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_northern-shield-437204-m0_nyc_taxi, now model.nyc_taxi.dim_payment)
[0m15:41:33.825830 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_payment
[0m15:41:33.860714 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_payment"
[0m15:41:33.884508 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_payment
[0m15:41:34.018246 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.dim_payment"
[0m15:41:34.044994 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:41:34.057499 [debug] [Thread-1  ]: On model.nyc_taxi.dim_payment: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.dim_payment"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`dim_payment`
      
    
    

    OPTIONS()
    as (
      WITH payment_cte AS(
    SELECT
        payment_type AS type_id,
        CASE 
            WHEN payment_type = 1 THEN "Credit card"
            WHEN payment_type = 2 THEN "Cash"
            WHEN payment_type = 3 THEN "No charge"
            WHEN payment_type = 4 THEN "Dispute"
            WHEN payment_type = 5 THEN "Unknown"
            WHEN payment_type = 6 THEN "Voided trip"
        END AS payment_name
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata`
)
SELECT
    type_id,
    payment_name
FROM payment_cte
    );
  
[0m15:41:35.078718 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:31587ad7-aaeb-4ea9-96b1-8a3e4a4f9283&page=queryresults
[0m15:41:38.305817 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bbd4f112-d810-43c0-888c-62db4500224c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc866574880>]}
[0m15:41:38.310941 [info ] [Thread-1  ]: 1 of 6 OK created sql table model nyc_taxi.dim_payment ......................... [[32mCREATE TABLE (59.3k rows, 463.5 KiB processed)[0m in 4.48s]
[0m15:41:38.316189 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_payment
[0m15:41:38.320126 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_ratecode
[0m15:41:38.324346 [info ] [Thread-1  ]: 2 of 6 START sql table model nyc_taxi.dim_ratecode ............................. [RUN]
[0m15:41:38.329614 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_payment, now model.nyc_taxi.dim_ratecode)
[0m15:41:38.333517 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_ratecode
[0m15:41:38.358259 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_ratecode"
[0m15:41:38.387012 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_ratecode
[0m15:41:38.402191 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.dim_ratecode"
[0m15:41:38.426564 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:41:38.439275 [debug] [Thread-1  ]: On model.nyc_taxi.dim_ratecode: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.dim_ratecode"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`dim_ratecode`
      
    
    

    OPTIONS()
    as (
      WITH rate_code_cte AS(
    SELECT
        rate_code_id AS rate_id,
        CASE 
            WHEN rate_code_id = 1 THEN "Standard rate"
            WHEN rate_code_id = 2 THEN "JFK"
            WHEN rate_code_id = 3 THEN "Newark"
            WHEN rate_code_id = 4 THEN "Nassau or Westchester"
            WHEN rate_code_id = 5 THEN "Negotiated fare"
            WHEN rate_code_id = 6 THEN "Group ride"
        END AS rate_code_name
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata`
)
SELECT
    rate_id,
    rate_code_name
FROM rate_code_cte
    );
  
[0m15:41:37.440749 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:cf6bfe0c-9e47-49bf-9dbf-4c7e0179f1da&page=queryresults
[0m15:41:40.603935 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bbd4f112-d810-43c0-888c-62db4500224c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8974dd7f0>]}
[0m15:41:40.608689 [info ] [Thread-1  ]: 2 of 6 OK created sql table model nyc_taxi.dim_ratecode ........................ [[32mCREATE TABLE (59.3k rows, 463.5 KiB processed)[0m in 2.27s]
[0m15:41:40.613996 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_ratecode
[0m15:41:40.618006 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_time
[0m15:41:40.621977 [info ] [Thread-1  ]: 3 of 6 START sql table model nyc_taxi.dim_time ................................. [RUN]
[0m15:41:40.626295 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_ratecode, now model.nyc_taxi.dim_time)
[0m15:41:40.630268 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_time
[0m15:41:40.647235 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_time"
[0m15:41:40.673739 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_time
[0m15:41:40.686105 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:41:41.377834 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.dim_time"
[0m15:41:41.398621 [debug] [Thread-1  ]: On model.nyc_taxi.dim_time: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.dim_time"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`dim_time`
      
    
    

    OPTIONS()
    as (
      WITH datetime_cte AS (
    SELECT DISTINCT
        ROW_NUMBER() OVER () AS time_id,
        DATE(lpep_pickup_datetime) AS date,
        lpep_pickup_datetime AS date_part 
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata`
)
SELECT
    time_id,
    date,
    EXTRACT(YEAR FROM date_part) AS year,
    EXTRACT(MONTH FROM date_part) AS month,
    EXTRACT(DAY FROM date_part) AS day,
    EXTRACT(HOUR FROM date_part) AS hour,
    EXTRACT(MINUTE FROM date_part) AS minute,
    FORMAT_TIMESTAMP('%A', date_part) AS weekday,
    TIMESTAMP_TRUNC(date_part, HOUR) AS time
FROM datetime_cte
    );
  
[0m15:41:42.159325 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:7f49f29f-febb-4c04-9d03-3ad7fc50fa52&page=queryresults
[0m15:41:45.992905 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bbd4f112-d810-43c0-888c-62db4500224c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc89f128310>]}
[0m15:41:45.997403 [info ] [Thread-1  ]: 3 of 6 OK created sql table model nyc_taxi.dim_time ............................ [[32mCREATE TABLE (59.3k rows, 463.5 KiB processed)[0m in 5.37s]
[0m15:41:46.001960 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_time
[0m15:41:46.005643 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_vendor
[0m15:41:46.010219 [info ] [Thread-1  ]: 4 of 6 START sql table model nyc_taxi.dim_vendor ............................... [RUN]
[0m15:41:46.014277 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_time, now model.nyc_taxi.dim_vendor)
[0m15:41:46.017664 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_vendor
[0m15:41:46.040227 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_vendor"
[0m15:41:46.066340 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_vendor
[0m15:41:46.084850 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.dim_vendor"
[0m15:41:46.111595 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:41:46.122771 [debug] [Thread-1  ]: On model.nyc_taxi.dim_vendor: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.dim_vendor"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`dim_vendor`
      
    
    

    OPTIONS()
    as (
      WITH vendor_cte AS(
    SELECT
        vendor_id AS id,
        CASE 
            WHEN vendor_id = 1 THEN "Creative Mobile Technologies"
            WHEN vendor_id = 2 THEN "VeriFone Inc."
        END AS vendor_name
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata`
)
SELECT
    id,
    vendor_name
FROM vendor_cte
    );
  
[0m15:41:47.241424 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:34a93472-adff-4399-b833-0e3b16b7234d&page=queryresults
[0m15:41:50.400893 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bbd4f112-d810-43c0-888c-62db4500224c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8974aed00>]}
[0m15:41:50.406082 [info ] [Thread-1  ]: 4 of 6 OK created sql table model nyc_taxi.dim_vendor .......................... [[32mCREATE TABLE (59.3k rows, 463.5 KiB processed)[0m in 4.39s]
[0m15:41:50.412652 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_vendor
[0m15:41:50.416450 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_zone
[0m15:41:50.420960 [info ] [Thread-1  ]: 5 of 6 START sql table model nyc_taxi.dim_zone ................................. [RUN]
[0m15:41:50.425523 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_vendor, now model.nyc_taxi.dim_zone)
[0m15:41:50.430406 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_zone
[0m15:41:50.445558 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_zone"
[0m15:41:50.473553 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_zone
[0m15:41:50.486624 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:41:51.335859 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.dim_zone"
[0m15:41:51.360091 [debug] [Thread-1  ]: On model.nyc_taxi.dim_zone: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.dim_zone"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`dim_zone`
      
    
    

    OPTIONS()
    as (
      SELECT
    location_id,
    borough,
    zone,
    replace(service_zone, 'Boro', 'Green') as service_zone
FROM `northern-shield-437204-m0`.`nyc_taxi`.`zone_map`
    );
  
[0m15:41:52.109873 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:9611a747-c168-40fc-8796-b9929184355b&page=queryresults
[0m15:41:55.303762 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bbd4f112-d810-43c0-888c-62db4500224c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8980b0c70>]}
[0m15:41:55.308576 [info ] [Thread-1  ]: 5 of 6 OK created sql table model nyc_taxi.dim_zone ............................ [[32mCREATE TABLE (265.0 rows, 12.1 KiB processed)[0m in 4.88s]
[0m15:41:55.314221 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_zone
[0m15:41:55.318501 [debug] [Thread-1  ]: Began running node model.nyc_taxi.fct_trips
[0m15:41:55.322787 [info ] [Thread-1  ]: 6 of 6 START sql table model nyc_taxi.fct_trips ................................ [RUN]
[0m15:41:55.327394 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_zone, now model.nyc_taxi.fct_trips)
[0m15:41:55.332397 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.fct_trips
[0m15:41:55.413861 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.fct_trips"
[0m15:41:55.440339 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.fct_trips
[0m15:41:55.457115 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.fct_trips"
[0m15:41:55.484248 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:41:55.496169 [debug] [Thread-1  ]: On model.nyc_taxi.fct_trips: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.fct_trips"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips`
      
    
    

    OPTIONS()
    as (
      WITH tripdata_cte AS (
    SELECT 
        to_hex(md5(cast(coalesce(cast(vendor_id as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(lpep_pickup_datetime as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(lpep_dropoff_datetime as string), '_dbt_utils_surrogate_key_null_') as string)))  AS trip_id,
        t.vendor_id,
        t.lpep_pickup_datetime,
        t.lpep_dropoff_datetime,
        td_pickup.time_id AS pickup_time_id,
        td_dropoff.time_id AS dropoff_time_id,
        t.rate_code_id,
        t.pu_location_id,
        t.do_location_id,
        t.passenger_count,
        t.trip_distance,
        t.fare_amount,
        t.extra,
        t.mta_tax,
        t.tip_amount,
        t.tolls_amount,
        t.improvement_surcharge,
        t.total_amount,
        t.payment_type,
        t.trip_type,
        t.congestion_surcharge
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata` AS t
    LEFT JOIN `northern-shield-437204-m0`.`nyc_taxi`.`dim_time` AS td_pickup
        ON TIMESTAMP_TRUNC(t.lpep_pickup_datetime, HOUR) = td_pickup.time
    LEFT JOIN `northern-shield-437204-m0`.`nyc_taxi`.`dim_time` AS td_dropoff
        ON TIMESTAMP_TRUNC(t.lpep_dropoff_datetime, HOUR) = td_dropoff.time
    WHERE vendor_id IS NOT NULL

    -- Incremental Filter
    
      AND DATE(lpep_pickup_datetime) >= '2023-01-01'
      AND DATE(lpep_pickup_datetime) <= '2023-01-31'
    
)
SELECT 
    trip_id,
    vendor_id,
    pickup_time_id,
    dropoff_time_id,
    rate_code_id,
    pu_location_id,
    do_location_id,
    passenger_count,
    trip_distance,
    fare_amount,
    extra,
    mta_tax,
    tip_amount,
    tolls_amount,
    improvement_surcharge,
    total_amount,
    payment_type,
    trip_type,
    congestion_surcharge
FROM tripdata_cte
    );
  
[0m15:41:56.811164 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:588c5254-9285-43ab-a6e4-a95df2a02bb3&page=queryresults
[0m15:46:34.129985 [debug] [Thread-1  ]: BigQuery adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.fct_trips"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips`
      
    
    

    OPTIONS()
    as (
      WITH tripdata_cte AS (
    SELECT 
        to_hex(md5(cast(coalesce(cast(vendor_id as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(lpep_pickup_datetime as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(lpep_dropoff_datetime as string), '_dbt_utils_surrogate_key_null_') as string)))  AS trip_id,
        t.vendor_id,
        t.lpep_pickup_datetime,
        t.lpep_dropoff_datetime,
        td_pickup.time_id AS pickup_time_id,
        td_dropoff.time_id AS dropoff_time_id,
        t.rate_code_id,
        t.pu_location_id,
        t.do_location_id,
        t.passenger_count,
        t.trip_distance,
        t.fare_amount,
        t.extra,
        t.mta_tax,
        t.tip_amount,
        t.tolls_amount,
        t.improvement_surcharge,
        t.total_amount,
        t.payment_type,
        t.trip_type,
        t.congestion_surcharge
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata` AS t
    LEFT JOIN `northern-shield-437204-m0`.`nyc_taxi`.`dim_time` AS td_pickup
        ON TIMESTAMP_TRUNC(t.lpep_pickup_datetime, HOUR) = td_pickup.time
    LEFT JOIN `northern-shield-437204-m0`.`nyc_taxi`.`dim_time` AS td_dropoff
        ON TIMESTAMP_TRUNC(t.lpep_dropoff_datetime, HOUR) = td_dropoff.time
    WHERE vendor_id IS NOT NULL

    -- Incremental Filter
    
      AND DATE(lpep_pickup_datetime) >= '2023-01-01'
      AND DATE(lpep_pickup_datetime) <= '2023-01-31'
    
)
SELECT 
    trip_id,
    vendor_id,
    pickup_time_id,
    dropoff_time_id,
    rate_code_id,
    pu_location_id,
    do_location_id,
    passenger_count,
    trip_distance,
    fare_amount,
    extra,
    mta_tax,
    tip_amount,
    tolls_amount,
    improvement_surcharge,
    total_amount,
    payment_type,
    trip_type,
    congestion_surcharge
FROM tripdata_cte
    );
  
[0m15:46:34.135173 [debug] [Thread-1  ]: BigQuery adapter: Operation did not complete within the designated timeout of 300 seconds.
[0m15:46:34.145748 [debug] [Thread-1  ]: Runtime Error in model fct_trips (models/transform/fct_trips.sql)
  Operation did not complete within the designated timeout of 300 seconds.
[0m15:46:34.149711 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bbd4f112-d810-43c0-888c-62db4500224c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc897f88370>]}
[0m15:46:34.154216 [error] [Thread-1  ]: 6 of 6 ERROR creating sql table model nyc_taxi.fct_trips ....................... [[31mERROR[0m in 278.82s]
[0m15:46:34.159389 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.fct_trips
[0m15:46:34.166779 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:46:34.169677 [debug] [MainThread]: Connection 'model.nyc_taxi.fct_trips' was properly closed.
[0m15:46:34.173185 [info ] [MainThread]: 
[0m15:46:34.176969 [info ] [MainThread]: Finished running 6 table models in 0 hours 5 minutes and 2.67 seconds (302.67s).
[0m15:46:34.186440 [debug] [MainThread]: Command end result
[0m15:46:34.397784 [info ] [MainThread]: 
[0m15:46:34.401804 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:46:34.405949 [info ] [MainThread]: 
[0m15:46:34.410026 [error] [MainThread]:   Runtime Error in model fct_trips (models/transform/fct_trips.sql)
  Operation did not complete within the designated timeout of 300 seconds.
[0m15:46:34.413056 [info ] [MainThread]: 
[0m15:46:34.416102 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m15:46:34.421567 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 342.14542, "process_in_blocks": "2256", "process_kernel_time": 0.801582, "process_mem_max_rss": "230656", "process_out_blocks": "0", "process_user_time": 12.900763}
[0m15:46:34.425868 [debug] [MainThread]: Command `dbt run` failed at 15:46:34.425407 after 342.15 seconds
[0m15:46:34.429460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc89ee1dca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc89d36ff40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc89e5d0b50>]}
[0m15:46:34.433187 [debug] [MainThread]: Flushing usage events
[0m17:53:44.500799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f9279fc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f905adee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f905ade80>]}


============================== 17:53:44.522120 | ecc91e7c-e9e4-4ae9-84b5-60eda4371c87 ==============================
[0m17:53:44.522120 [info ] [MainThread]: Running with dbt=1.8.9
[0m17:53:44.526112 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'printer_width': '80', 'profiles_dir': '/opt/airflow/include/dbt/', 'quiet': 'False', 'log_path': '/opt/airflow/include/dbt/logs', 'log_cache_events': 'False', 'version_check': 'True', 'introspect': 'True', 'use_colors': 'True', 'write_json': 'True', 'cache_selected_only': 'False', 'partial_parse': 'True', 'log_format': 'default', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'debug': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'empty': 'False', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/include/dbt/', 'warn_error': 'None', 'no_print': 'None', 'use_experimental_parser': 'False', 'target_path': 'None'}
[0m17:53:47.606901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ecc91e7c-e9e4-4ae9-84b5-60eda4371c87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f59f29f40>]}
[0m17:53:47.809968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ecc91e7c-e9e4-4ae9-84b5-60eda4371c87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f905da970>]}
[0m17:53:47.814058 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m17:53:48.280581 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m17:53:51.993863 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:53:51.997857 [debug] [MainThread]: Partial parsing: updated file: nyc_taxi://models/transform/fct_trips.sql
[0m17:53:53.067977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ecc91e7c-e9e4-4ae9-84b5-60eda4371c87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f8b717130>]}
[0m17:53:53.454303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ecc91e7c-e9e4-4ae9-84b5-60eda4371c87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f591ae940>]}
[0m17:53:53.457777 [info ] [MainThread]: Found 6 models, 2 sources, 600 macros
[0m17:53:53.463399 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ecc91e7c-e9e4-4ae9-84b5-60eda4371c87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f590f5d30>]}
[0m17:53:53.473370 [info ] [MainThread]: 
[0m17:53:53.477493 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:53:53.496211 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_northern-shield-437204-m0'
[0m17:53:53.499432 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:53:54.527366 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_northern-shield-437204-m0, now list_northern-shield-437204-m0_nyc_taxi)
[0m17:53:54.530537 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:53:55.238241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ecc91e7c-e9e4-4ae9-84b5-60eda4371c87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f92789220>]}
[0m17:53:55.242012 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:53:55.244801 [info ] [MainThread]: 
[0m17:53:55.263452 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_payment
[0m17:53:55.267438 [info ] [Thread-1  ]: 1 of 6 START sql table model nyc_taxi.dim_payment .............................. [RUN]
[0m17:53:55.281316 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_northern-shield-437204-m0_nyc_taxi, now model.nyc_taxi.dim_payment)
[0m17:53:55.285269 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_payment
[0m17:53:55.327039 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_payment"
[0m17:53:55.349377 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_payment
[0m17:53:55.473280 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.dim_payment"
[0m17:53:55.498576 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:53:55.508865 [debug] [Thread-1  ]: On model.nyc_taxi.dim_payment: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.dim_payment"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`dim_payment`
      
    
    

    OPTIONS()
    as (
      WITH payment_cte AS(
    SELECT
        payment_type AS type_id,
        CASE 
            WHEN payment_type = 1 THEN "Credit card"
            WHEN payment_type = 2 THEN "Cash"
            WHEN payment_type = 3 THEN "No charge"
            WHEN payment_type = 4 THEN "Dispute"
            WHEN payment_type = 5 THEN "Unknown"
            WHEN payment_type = 6 THEN "Voided trip"
        END AS payment_name
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata`
)
SELECT
    type_id,
    payment_name
FROM payment_cte
    );
  
[0m17:53:56.321543 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:a4454d73-753c-4380-8eff-2118e1c7a707&page=queryresults
[0m17:53:59.146838 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ecc91e7c-e9e4-4ae9-84b5-60eda4371c87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f59f2c340>]}
[0m17:53:59.151732 [info ] [Thread-1  ]: 1 of 6 OK created sql table model nyc_taxi.dim_payment ......................... [[32mCREATE TABLE (59.3k rows, 463.5 KiB processed)[0m in 3.86s]
[0m17:53:59.157419 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_payment
[0m17:53:59.162157 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_ratecode
[0m17:53:59.165904 [info ] [Thread-1  ]: 2 of 6 START sql table model nyc_taxi.dim_ratecode ............................. [RUN]
[0m17:53:59.169807 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_payment, now model.nyc_taxi.dim_ratecode)
[0m17:53:59.173382 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_ratecode
[0m17:53:59.190511 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_ratecode"
[0m17:53:59.219899 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_ratecode
[0m17:53:59.241944 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.dim_ratecode"
[0m17:53:59.259986 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:53:59.271250 [debug] [Thread-1  ]: On model.nyc_taxi.dim_ratecode: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.dim_ratecode"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`dim_ratecode`
      
    
    

    OPTIONS()
    as (
      WITH rate_code_cte AS(
    SELECT
        rate_code_id AS rate_id,
        CASE 
            WHEN rate_code_id = 1 THEN "Standard rate"
            WHEN rate_code_id = 2 THEN "JFK"
            WHEN rate_code_id = 3 THEN "Newark"
            WHEN rate_code_id = 4 THEN "Nassau or Westchester"
            WHEN rate_code_id = 5 THEN "Negotiated fare"
            WHEN rate_code_id = 6 THEN "Group ride"
        END AS rate_code_name
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata`
)
SELECT
    rate_id,
    rate_code_name
FROM rate_code_cte
    );
  
[0m17:54:00.182655 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:633ee534-30bc-4648-aeb6-c32ee95b6991&page=queryresults
[0m17:54:02.980968 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ecc91e7c-e9e4-4ae9-84b5-60eda4371c87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f8b665700>]}
[0m17:54:02.985574 [info ] [Thread-1  ]: 2 of 6 OK created sql table model nyc_taxi.dim_ratecode ........................ [[32mCREATE TABLE (59.3k rows, 463.5 KiB processed)[0m in 3.81s]
[0m17:54:02.990030 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_ratecode
[0m17:54:02.994218 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_time
[0m17:54:02.997981 [info ] [Thread-1  ]: 3 of 6 START sql table model nyc_taxi.dim_time ................................. [RUN]
[0m17:54:03.001539 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_ratecode, now model.nyc_taxi.dim_time)
[0m17:54:03.004789 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_time
[0m17:54:03.024054 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_time"
[0m17:54:03.078801 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_time
[0m17:54:03.095591 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.dim_time"
[0m17:54:03.111833 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:54:03.123103 [debug] [Thread-1  ]: On model.nyc_taxi.dim_time: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.dim_time"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`dim_time`
      
    
    

    OPTIONS()
    as (
      WITH datetime_cte AS (
    SELECT DISTINCT
        ROW_NUMBER() OVER () AS time_id,
        DATE(lpep_pickup_datetime) AS date,
        lpep_pickup_datetime AS date_part 
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata`
)
SELECT
    time_id,
    date,
    EXTRACT(YEAR FROM date_part) AS year,
    EXTRACT(MONTH FROM date_part) AS month,
    EXTRACT(DAY FROM date_part) AS day,
    EXTRACT(HOUR FROM date_part) AS hour,
    EXTRACT(MINUTE FROM date_part) AS minute,
    FORMAT_TIMESTAMP('%A', date_part) AS weekday,
    TIMESTAMP_TRUNC(date_part, HOUR) AS time
FROM datetime_cte
    );
  
[0m17:54:04.482056 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:24185ddd-bdea-41d5-a56b-27ec1c6dab98&page=queryresults
[0m17:54:08.382224 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ecc91e7c-e9e4-4ae9-84b5-60eda4371c87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f8b665880>]}
[0m17:54:08.387122 [info ] [Thread-1  ]: 3 of 6 OK created sql table model nyc_taxi.dim_time ............................ [[32mCREATE TABLE (59.3k rows, 463.5 KiB processed)[0m in 5.38s]
[0m17:54:08.394074 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_time
[0m17:54:08.398239 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_vendor
[0m17:54:08.402395 [info ] [Thread-1  ]: 4 of 6 START sql table model nyc_taxi.dim_vendor ............................... [RUN]
[0m17:54:08.406519 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_time, now model.nyc_taxi.dim_vendor)
[0m17:54:08.409130 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_vendor
[0m17:54:08.425610 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_vendor"
[0m17:54:08.448352 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_vendor
[0m17:54:08.465706 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.dim_vendor"
[0m17:54:08.488180 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:54:08.497466 [debug] [Thread-1  ]: On model.nyc_taxi.dim_vendor: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.dim_vendor"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`dim_vendor`
      
    
    

    OPTIONS()
    as (
      WITH vendor_cte AS(
    SELECT
        vendor_id AS id,
        CASE 
            WHEN vendor_id = 1 THEN "Creative Mobile Technologies"
            WHEN vendor_id = 2 THEN "VeriFone Inc."
        END AS vendor_name
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata`
)
SELECT
    id,
    vendor_name
FROM vendor_cte
    );
  
[0m17:54:09.491961 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:03a9fbfb-af54-4a4a-813c-5c7a96e2251e&page=queryresults
[0m17:54:12.140094 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ecc91e7c-e9e4-4ae9-84b5-60eda4371c87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f93326c70>]}
[0m17:54:12.144363 [info ] [Thread-1  ]: 4 of 6 OK created sql table model nyc_taxi.dim_vendor .......................... [[32mCREATE TABLE (59.3k rows, 463.5 KiB processed)[0m in 3.73s]
[0m17:54:12.151846 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_vendor
[0m17:54:12.156282 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_zone
[0m17:54:12.159685 [info ] [Thread-1  ]: 5 of 6 START sql table model nyc_taxi.dim_zone ................................. [RUN]
[0m17:54:12.164968 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_vendor, now model.nyc_taxi.dim_zone)
[0m17:54:12.168564 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_zone
[0m17:54:12.180011 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_zone"
[0m17:54:12.203566 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_zone
[0m17:54:12.219520 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.dim_zone"
[0m17:54:12.242382 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:54:12.252174 [debug] [Thread-1  ]: On model.nyc_taxi.dim_zone: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.dim_zone"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`dim_zone`
      
    
    

    OPTIONS()
    as (
      SELECT
    location_id,
    borough,
    zone,
    replace(service_zone, 'Boro', 'Green') as service_zone
FROM `northern-shield-437204-m0`.`nyc_taxi`.`zone_map`
    );
  
[0m17:54:13.347103 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:e25c92d7-26e9-40dd-bc2e-03029fa119a7&page=queryresults
[0m17:54:15.977012 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ecc91e7c-e9e4-4ae9-84b5-60eda4371c87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f59f2c340>]}
[0m17:54:15.981240 [info ] [Thread-1  ]: 5 of 6 OK created sql table model nyc_taxi.dim_zone ............................ [[32mCREATE TABLE (265.0 rows, 12.1 KiB processed)[0m in 3.81s]
[0m17:54:15.993202 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_zone
[0m17:54:15.997198 [debug] [Thread-1  ]: Began running node model.nyc_taxi.fct_trips
[0m17:54:16.001247 [info ] [Thread-1  ]: 6 of 6 START sql table model nyc_taxi.fct_trips ................................ [RUN]
[0m17:54:16.005451 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_zone, now model.nyc_taxi.fct_trips)
[0m17:54:16.009057 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.fct_trips
[0m17:54:16.042136 [debug] [Thread-1  ]: Compilation Error in model fct_trips (models/transform/fct_trips.sql)
  Required var 'start_date' not found in config:
  Vars supplied to fct_trips = {}
[0m17:54:16.046355 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ecc91e7c-e9e4-4ae9-84b5-60eda4371c87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f8b63c1f0>]}
[0m17:54:16.050447 [error] [Thread-1  ]: 6 of 6 ERROR creating sql table model nyc_taxi.fct_trips ....................... [[31mERROR[0m in 0.04s]
[0m17:54:16.055344 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.fct_trips
[0m17:54:16.062130 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:54:16.064940 [debug] [MainThread]: Connection 'model.nyc_taxi.fct_trips' was properly closed.
[0m17:54:16.068600 [info ] [MainThread]: 
[0m17:54:16.071795 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 22.59 seconds (22.59s).
[0m17:54:16.080963 [debug] [MainThread]: Command end result
[0m17:54:16.269126 [info ] [MainThread]: 
[0m17:54:16.272449 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:54:16.275456 [info ] [MainThread]: 
[0m17:54:16.278724 [error] [MainThread]:   Compilation Error in model fct_trips (models/transform/fct_trips.sql)
  Required var 'start_date' not found in config:
  Vars supplied to fct_trips = {}
[0m17:54:16.281949 [info ] [MainThread]: 
[0m17:54:16.286365 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m17:54:16.291897 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 32.050247, "process_in_blocks": "1968", "process_kernel_time": 1.23364, "process_mem_max_rss": "230124", "process_out_blocks": "0", "process_user_time": 12.367501}
[0m17:54:16.296088 [debug] [MainThread]: Command `dbt run` failed at 17:54:16.295620 after 32.05 seconds
[0m17:54:16.299127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f9279fc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f8b72ffd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f8b72fe20>]}
[0m17:54:16.302273 [debug] [MainThread]: Flushing usage events
[0m18:06:31.942105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fecbf539ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fecbe684400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fecbd336d30>]}


============================== 18:06:31.960134 | 466a3f0b-a20b-40da-bac1-e4f2f542743b ==============================
[0m18:06:31.960134 [info ] [MainThread]: Running with dbt=1.8.9
[0m18:06:31.963694 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'write_json': 'True', 'empty': 'False', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/include/dbt/', 'warn_error': 'None', 'log_format': 'default', 'cache_selected_only': 'False', 'quiet': 'False', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'log_cache_events': 'False', 'no_print': 'None', 'debug': 'False', 'use_experimental_parser': 'False', 'target_path': 'None', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'profiles_dir': '/opt/airflow/include/dbt/', 'static_parser': 'True', 'use_colors': 'True', 'log_path': '/opt/airflow/include/dbt/logs', 'indirect_selection': 'eager', 'printer_width': '80', 'fail_fast': 'False'}
[0m18:06:34.632840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '466a3f0b-a20b-40da-bac1-e4f2f542743b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec85f46d30>]}
[0m18:06:34.802869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '466a3f0b-a20b-40da-bac1-e4f2f542743b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec85ecc550>]}
[0m18:06:34.808918 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m18:06:35.275913 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m18:06:38.457136 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:06:38.460815 [debug] [MainThread]: Partial parsing: updated file: nyc_taxi://models/transform/fct_trips.sql
[0m18:06:39.366045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '466a3f0b-a20b-40da-bac1-e4f2f542743b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fecb8517130>]}
[0m18:06:39.716314 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '466a3f0b-a20b-40da-bac1-e4f2f542743b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fecb852f970>]}
[0m18:06:39.719322 [info ] [MainThread]: Found 6 models, 2 sources, 600 macros
[0m18:06:39.723462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '466a3f0b-a20b-40da-bac1-e4f2f542743b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fecb857afa0>]}
[0m18:06:39.730411 [info ] [MainThread]: 
[0m18:06:39.735280 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:06:39.754815 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_northern-shield-437204-m0'
[0m18:06:39.758333 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:06:40.567006 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_northern-shield-437204-m0, now list_northern-shield-437204-m0_nyc_taxi)
[0m18:06:40.570539 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:06:41.278045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '466a3f0b-a20b-40da-bac1-e4f2f542743b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fecbf849fa0>]}
[0m18:06:41.282327 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:06:41.285958 [info ] [MainThread]: 
[0m18:06:41.308464 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_payment
[0m18:06:41.312817 [info ] [Thread-1  ]: 1 of 6 START sql table model nyc_taxi.dim_payment .............................. [RUN]
[0m18:06:41.316137 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_northern-shield-437204-m0_nyc_taxi, now model.nyc_taxi.dim_payment)
[0m18:06:41.319444 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_payment
[0m18:06:41.347516 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_payment"
[0m18:06:41.373502 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_payment
[0m18:06:41.435269 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:06:42.118508 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.dim_payment"
[0m18:06:42.144497 [debug] [Thread-1  ]: On model.nyc_taxi.dim_payment: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.dim_payment"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`dim_payment`
      
    
    

    OPTIONS()
    as (
      WITH payment_cte AS(
    SELECT
        payment_type AS type_id,
        CASE 
            WHEN payment_type = 1 THEN "Credit card"
            WHEN payment_type = 2 THEN "Cash"
            WHEN payment_type = 3 THEN "No charge"
            WHEN payment_type = 4 THEN "Dispute"
            WHEN payment_type = 5 THEN "Unknown"
            WHEN payment_type = 6 THEN "Voided trip"
        END AS payment_name
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata`
)
SELECT
    type_id,
    payment_name
FROM payment_cte
    );
  
[0m18:06:42.790246 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:880b01b4-1af4-4116-b443-2cc22507820c&page=queryresults
[0m18:06:45.987563 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '466a3f0b-a20b-40da-bac1-e4f2f542743b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fecbf849fa0>]}
[0m18:06:45.992199 [info ] [Thread-1  ]: 1 of 6 OK created sql table model nyc_taxi.dim_payment ......................... [[32mCREATE TABLE (59.3k rows, 463.5 KiB processed)[0m in 4.67s]
[0m18:06:45.999144 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_payment
[0m18:06:46.003784 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_ratecode
[0m18:06:46.007653 [info ] [Thread-1  ]: 2 of 6 START sql table model nyc_taxi.dim_ratecode ............................. [RUN]
[0m18:06:46.012568 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_payment, now model.nyc_taxi.dim_ratecode)
[0m18:06:46.018313 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_ratecode
[0m18:06:46.031073 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_ratecode"
[0m18:06:46.055128 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_ratecode
[0m18:06:46.068699 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:06:46.748265 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.dim_ratecode"
[0m18:06:46.768258 [debug] [Thread-1  ]: On model.nyc_taxi.dim_ratecode: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.dim_ratecode"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`dim_ratecode`
      
    
    

    OPTIONS()
    as (
      WITH rate_code_cte AS(
    SELECT
        rate_code_id AS rate_id,
        CASE 
            WHEN rate_code_id = 1 THEN "Standard rate"
            WHEN rate_code_id = 2 THEN "JFK"
            WHEN rate_code_id = 3 THEN "Newark"
            WHEN rate_code_id = 4 THEN "Nassau or Westchester"
            WHEN rate_code_id = 5 THEN "Negotiated fare"
            WHEN rate_code_id = 6 THEN "Group ride"
        END AS rate_code_name
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata`
)
SELECT
    rate_id,
    rate_code_name
FROM rate_code_cte
    );
  
[0m18:06:47.352345 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:cd5c8146-06cc-4a7c-b0bd-37f5134844dd&page=queryresults
[0m18:06:50.198088 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '466a3f0b-a20b-40da-bac1-e4f2f542743b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fecb8418bb0>]}
[0m18:06:50.202509 [info ] [Thread-1  ]: 2 of 6 OK created sql table model nyc_taxi.dim_ratecode ........................ [[32mCREATE TABLE (59.3k rows, 463.5 KiB processed)[0m in 4.19s]
[0m18:06:50.207269 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_ratecode
[0m18:06:50.211351 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_time
[0m18:06:50.215163 [info ] [Thread-1  ]: 3 of 6 START sql table model nyc_taxi.dim_time ................................. [RUN]
[0m18:06:50.218789 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_ratecode, now model.nyc_taxi.dim_time)
[0m18:06:50.222304 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_time
[0m18:06:50.237588 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_time"
[0m18:06:50.272161 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_time
[0m18:06:50.289706 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:06:51.007905 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.dim_time"
[0m18:06:51.031970 [debug] [Thread-1  ]: On model.nyc_taxi.dim_time: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.dim_time"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`dim_time`
      
    
    

    OPTIONS()
    as (
      WITH datetime_cte AS (
    SELECT DISTINCT
        ROW_NUMBER() OVER () AS time_id,
        DATE(lpep_pickup_datetime) AS date,
        lpep_pickup_datetime AS date_part 
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata`
)
SELECT
    time_id,
    date,
    EXTRACT(YEAR FROM date_part) AS year,
    EXTRACT(MONTH FROM date_part) AS month,
    EXTRACT(DAY FROM date_part) AS day,
    EXTRACT(HOUR FROM date_part) AS hour,
    EXTRACT(MINUTE FROM date_part) AS minute,
    FORMAT_TIMESTAMP('%A', date_part) AS weekday,
    TIMESTAMP_TRUNC(date_part, HOUR) AS time
FROM datetime_cte
    );
  
[0m18:06:51.714800 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:e22b79c1-9a7b-4c11-bc2b-95953774aa77&page=queryresults
[0m18:06:54.949270 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '466a3f0b-a20b-40da-bac1-e4f2f542743b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fecb8418d00>]}
[0m18:06:54.954105 [info ] [Thread-1  ]: 3 of 6 OK created sql table model nyc_taxi.dim_time ............................ [[32mCREATE TABLE (59.3k rows, 463.5 KiB processed)[0m in 4.73s]
[0m18:06:54.959511 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_time
[0m18:06:54.963671 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_vendor
[0m18:06:54.967658 [info ] [Thread-1  ]: 4 of 6 START sql table model nyc_taxi.dim_vendor ............................... [RUN]
[0m18:06:54.972271 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_time, now model.nyc_taxi.dim_vendor)
[0m18:06:54.975338 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_vendor
[0m18:06:54.989899 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_vendor"
[0m18:06:55.013393 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_vendor
[0m18:06:55.025915 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:06:55.860618 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.dim_vendor"
[0m18:06:55.881761 [debug] [Thread-1  ]: On model.nyc_taxi.dim_vendor: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.dim_vendor"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`dim_vendor`
      
    
    

    OPTIONS()
    as (
      WITH vendor_cte AS(
    SELECT
        vendor_id AS id,
        CASE 
            WHEN vendor_id = 1 THEN "Creative Mobile Technologies"
            WHEN vendor_id = 2 THEN "VeriFone Inc."
        END AS vendor_name
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata`
)
SELECT
    id,
    vendor_name
FROM vendor_cte
    );
  
[0m18:06:56.945549 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:f59fdb55-4a4a-4946-9109-3dd25fc7bd1a&page=queryresults
[0m18:06:59.438863 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '466a3f0b-a20b-40da-bac1-e4f2f542743b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fecb842a520>]}
[0m18:06:59.442675 [info ] [Thread-1  ]: 4 of 6 OK created sql table model nyc_taxi.dim_vendor .......................... [[32mCREATE TABLE (59.3k rows, 463.5 KiB processed)[0m in 4.47s]
[0m18:06:59.447753 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_vendor
[0m18:06:59.451127 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_zone
[0m18:06:59.454344 [info ] [Thread-1  ]: 5 of 6 START sql table model nyc_taxi.dim_zone ................................. [RUN]
[0m18:06:59.457767 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_vendor, now model.nyc_taxi.dim_zone)
[0m18:06:59.462042 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_zone
[0m18:06:59.474429 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_zone"
[0m18:06:59.496899 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_zone
[0m18:06:59.509466 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:07:00.239705 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.dim_zone"
[0m18:07:00.260378 [debug] [Thread-1  ]: On model.nyc_taxi.dim_zone: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.dim_zone"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`dim_zone`
      
    
    

    OPTIONS()
    as (
      SELECT
    location_id,
    borough,
    zone,
    replace(service_zone, 'Boro', 'Green') as service_zone
FROM `northern-shield-437204-m0`.`nyc_taxi`.`zone_map`
    );
  
[0m18:07:00.831561 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:1c943a2e-2992-4c7d-a368-747505382a2b&page=queryresults
[0m18:07:03.837663 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '466a3f0b-a20b-40da-bac1-e4f2f542743b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fecb83be790>]}
[0m18:07:03.842921 [info ] [Thread-1  ]: 5 of 6 OK created sql table model nyc_taxi.dim_zone ............................ [[32mCREATE TABLE (265.0 rows, 12.1 KiB processed)[0m in 4.38s]
[0m18:07:03.847376 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_zone
[0m18:07:03.851038 [debug] [Thread-1  ]: Began running node model.nyc_taxi.fct_trips
[0m18:07:03.854929 [info ] [Thread-1  ]: 6 of 6 START sql table model nyc_taxi.fct_trips ................................ [RUN]
[0m18:07:03.859436 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_zone, now model.nyc_taxi.fct_trips)
[0m18:07:03.863269 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.fct_trips
[0m18:07:03.896264 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.fct_trips"
[0m18:07:03.912727 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.fct_trips
[0m18:07:03.926267 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.fct_trips"
[0m18:07:03.941365 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:07:03.950735 [debug] [Thread-1  ]: On model.nyc_taxi.fct_trips: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.fct_trips"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips`
      
    
    

    OPTIONS()
    as (
      WITH tripdata_cte AS (
    SELECT 
        to_hex(md5(cast(coalesce(cast(vendor_id as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(lpep_pickup_datetime as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(lpep_dropoff_datetime as string), '_dbt_utils_surrogate_key_null_') as string)))  AS trip_id,
        t.vendor_id,
        t.lpep_pickup_datetime,
        t.lpep_dropoff_datetime,
        td_pickup.time_id AS pickup_time_id,
        td_dropoff.time_id AS dropoff_time_id,
        t.rate_code_id,
        t.pu_location_id,
        t.do_location_id,
        t.passenger_count,
        t.trip_distance,
        t.fare_amount,
        t.extra,
        t.mta_tax,
        t.tip_amount,
        t.tolls_amount,
        t.improvement_surcharge,
        t.total_amount,
        t.payment_type,
        t.trip_type,
        t.congestion_surcharge
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata` AS t
    LEFT JOIN `northern-shield-437204-m0`.`nyc_taxi`.`dim_time` AS td_pickup
        ON TIMESTAMP_TRUNC(t.lpep_pickup_datetime, HOUR) = td_pickup.time
    LEFT JOIN `northern-shield-437204-m0`.`nyc_taxi`.`dim_time` AS td_dropoff
        ON TIMESTAMP_TRUNC(t.lpep_dropoff_datetime, HOUR) = td_dropoff.time
    WHERE vendor_id IS NOT NULL
        AND DATE(lpep_pickup_datetime) >= '2023-01-01'
        AND DATE(lpep_pickup_datetime) <= '2023-01-07'
)
SELECT 
    trip_id,
    vendor_id,
    pickup_time_id,
    dropoff_time_id,
    rate_code_id,
    pu_location_id,
    do_location_id,
    passenger_count,
    trip_distance,
    fare_amount,
    extra,
    mta_tax,
    tip_amount,
    tolls_amount,
    improvement_surcharge,
    total_amount,
    payment_type,
    trip_type,
    congestion_surcharge
FROM tripdata_cte
    );
  
[0m18:07:05.471504 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:82b81dfa-e7a8-44e7-9cc9-53914ed5b491&page=queryresults
[0m18:12:10.039085 [debug] [Thread-1  ]: BigQuery adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.fct_trips"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips`
      
    
    

    OPTIONS()
    as (
      WITH tripdata_cte AS (
    SELECT 
        to_hex(md5(cast(coalesce(cast(vendor_id as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(lpep_pickup_datetime as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(lpep_dropoff_datetime as string), '_dbt_utils_surrogate_key_null_') as string)))  AS trip_id,
        t.vendor_id,
        t.lpep_pickup_datetime,
        t.lpep_dropoff_datetime,
        td_pickup.time_id AS pickup_time_id,
        td_dropoff.time_id AS dropoff_time_id,
        t.rate_code_id,
        t.pu_location_id,
        t.do_location_id,
        t.passenger_count,
        t.trip_distance,
        t.fare_amount,
        t.extra,
        t.mta_tax,
        t.tip_amount,
        t.tolls_amount,
        t.improvement_surcharge,
        t.total_amount,
        t.payment_type,
        t.trip_type,
        t.congestion_surcharge
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata` AS t
    LEFT JOIN `northern-shield-437204-m0`.`nyc_taxi`.`dim_time` AS td_pickup
        ON TIMESTAMP_TRUNC(t.lpep_pickup_datetime, HOUR) = td_pickup.time
    LEFT JOIN `northern-shield-437204-m0`.`nyc_taxi`.`dim_time` AS td_dropoff
        ON TIMESTAMP_TRUNC(t.lpep_dropoff_datetime, HOUR) = td_dropoff.time
    WHERE vendor_id IS NOT NULL
        AND DATE(lpep_pickup_datetime) >= '2023-01-01'
        AND DATE(lpep_pickup_datetime) <= '2023-01-07'
)
SELECT 
    trip_id,
    vendor_id,
    pickup_time_id,
    dropoff_time_id,
    rate_code_id,
    pu_location_id,
    do_location_id,
    passenger_count,
    trip_distance,
    fare_amount,
    extra,
    mta_tax,
    tip_amount,
    tolls_amount,
    improvement_surcharge,
    total_amount,
    payment_type,
    trip_type,
    congestion_surcharge
FROM tripdata_cte
    );
  
[0m18:12:10.044377 [debug] [Thread-1  ]: BigQuery adapter: Operation did not complete within the designated timeout of 300 seconds.
[0m18:12:10.058071 [debug] [Thread-1  ]: Runtime Error in model fct_trips (models/transform/fct_trips.sql)
  Operation did not complete within the designated timeout of 300 seconds.
[0m18:12:10.061945 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '466a3f0b-a20b-40da-bac1-e4f2f542743b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fecb8436af0>]}
[0m18:12:10.066804 [error] [Thread-1  ]: 6 of 6 ERROR creating sql table model nyc_taxi.fct_trips ....................... [[31mERROR[0m in 306.20s]
[0m18:12:10.071680 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.fct_trips
[0m18:12:10.078833 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:12:10.081714 [debug] [MainThread]: Connection 'model.nyc_taxi.fct_trips' was properly closed.
[0m18:12:10.084979 [info ] [MainThread]: 
[0m18:12:10.088912 [info ] [MainThread]: Finished running 6 table models in 0 hours 5 minutes and 30.35 seconds (330.35s).
[0m18:12:10.098408 [debug] [MainThread]: Command end result
[0m18:12:10.305179 [info ] [MainThread]: 
[0m18:12:10.309116 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:12:10.312099 [info ] [MainThread]: 
[0m18:12:10.315501 [error] [MainThread]:   Runtime Error in model fct_trips (models/transform/fct_trips.sql)
  Operation did not complete within the designated timeout of 300 seconds.
[0m18:12:10.318955 [info ] [MainThread]: 
[0m18:12:10.323091 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m18:12:10.330069 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 339.82706, "process_in_blocks": "8", "process_kernel_time": 0.716853, "process_mem_max_rss": "232532", "process_out_blocks": "0", "process_user_time": 13.108173}
[0m18:12:10.334395 [debug] [MainThread]: Command `dbt run` failed at 18:12:10.333977 after 339.83 seconds
[0m18:12:10.337887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fecbf539ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec85f46d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fecbda654f0>]}
[0m18:12:10.340986 [debug] [MainThread]: Flushing usage events
[0m18:21:09.608234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55700c8c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f556ded8e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f556ded8df0>]}


============================== 18:21:09.636829 | acc78a3e-4d08-402b-824c-2e7c6049ab95 ==============================
[0m18:21:09.636829 [info ] [MainThread]: Running with dbt=1.8.9
[0m18:21:09.641386 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'fail_fast': 'False', 'log_path': '/opt/airflow/include/dbt/logs', 'log_cache_events': 'False', 'introspect': 'True', 'quiet': 'False', 'profiles_dir': '/opt/airflow/include/dbt/', 'log_format': 'default', 'warn_error': 'None', 'indirect_selection': 'eager', 'use_colors': 'True', 'target_path': 'None', 'empty': 'False', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'no_print': 'None', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/include/dbt/', 'static_parser': 'True', 'version_check': 'True', 'printer_width': '80', 'write_json': 'True', 'partial_parse': 'True', 'debug': 'False'}
[0m18:21:12.423625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'acc78a3e-4d08-402b-824c-2e7c6049ab95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f556f87cd60>]}
[0m18:21:12.592319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'acc78a3e-4d08-402b-824c-2e7c6049ab95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5536a5c190>]}
[0m18:21:12.596121 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m18:21:13.040468 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m18:21:16.179085 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:21:16.182800 [debug] [MainThread]: Partial parsing: updated file: nyc_taxi://models/transform/fct_trips.sql
[0m18:21:17.088677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'acc78a3e-4d08-402b-824c-2e7c6049ab95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5569112eb0>]}
[0m18:21:17.444155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'acc78a3e-4d08-402b-824c-2e7c6049ab95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5569130460>]}
[0m18:21:17.448503 [info ] [MainThread]: Found 6 models, 2 sources, 600 macros
[0m18:21:17.452707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'acc78a3e-4d08-402b-824c-2e7c6049ab95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55691065b0>]}
[0m18:21:17.459745 [info ] [MainThread]: 
[0m18:21:17.463801 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:21:17.487077 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_northern-shield-437204-m0'
[0m18:21:17.490493 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:21:18.418022 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_northern-shield-437204-m0, now list_northern-shield-437204-m0_nyc_taxi)
[0m18:21:18.421971 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:21:19.217705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'acc78a3e-4d08-402b-824c-2e7c6049ab95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5570390d00>]}
[0m18:21:19.221830 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:21:19.225805 [info ] [MainThread]: 
[0m18:21:19.246246 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_payment
[0m18:21:19.250441 [info ] [Thread-1  ]: 1 of 6 START sql table model nyc_taxi.dim_payment .............................. [RUN]
[0m18:21:19.254464 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_northern-shield-437204-m0_nyc_taxi, now model.nyc_taxi.dim_payment)
[0m18:21:19.257615 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_payment
[0m18:21:19.288526 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_payment"
[0m18:21:19.313145 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_payment
[0m18:21:19.371747 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:21:20.212539 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.dim_payment"
[0m18:21:20.233596 [debug] [Thread-1  ]: On model.nyc_taxi.dim_payment: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.dim_payment"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`dim_payment`
      
    
    

    OPTIONS()
    as (
      WITH payment_cte AS(
    SELECT
        payment_type AS type_id,
        CASE 
            WHEN payment_type = 1 THEN "Credit card"
            WHEN payment_type = 2 THEN "Cash"
            WHEN payment_type = 3 THEN "No charge"
            WHEN payment_type = 4 THEN "Dispute"
            WHEN payment_type = 5 THEN "Unknown"
            WHEN payment_type = 6 THEN "Voided trip"
        END AS payment_name
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata`
)
SELECT
    type_id,
    payment_name
FROM payment_cte
    );
  
[0m18:21:21.141178 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:76621814-5f5c-4f6d-985b-5c27a17907d1&page=queryresults
[0m18:21:23.675251 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'acc78a3e-4d08-402b-824c-2e7c6049ab95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5537824940>]}
[0m18:21:23.679921 [info ] [Thread-1  ]: 1 of 6 OK created sql table model nyc_taxi.dim_payment ......................... [[32mCREATE TABLE (59.3k rows, 463.5 KiB processed)[0m in 4.42s]
[0m18:21:23.684422 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_payment
[0m18:21:23.688569 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_ratecode
[0m18:21:23.692107 [info ] [Thread-1  ]: 2 of 6 START sql table model nyc_taxi.dim_ratecode ............................. [RUN]
[0m18:21:23.695491 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_payment, now model.nyc_taxi.dim_ratecode)
[0m18:21:23.698649 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_ratecode
[0m18:21:23.710387 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_ratecode"
[0m18:21:23.731768 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_ratecode
[0m18:21:23.743965 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:21:24.408181 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.dim_ratecode"
[0m18:21:24.424625 [debug] [Thread-1  ]: On model.nyc_taxi.dim_ratecode: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.dim_ratecode"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`dim_ratecode`
      
    
    

    OPTIONS()
    as (
      WITH rate_code_cte AS(
    SELECT
        rate_code_id AS rate_id,
        CASE 
            WHEN rate_code_id = 1 THEN "Standard rate"
            WHEN rate_code_id = 2 THEN "JFK"
            WHEN rate_code_id = 3 THEN "Newark"
            WHEN rate_code_id = 4 THEN "Nassau or Westchester"
            WHEN rate_code_id = 5 THEN "Negotiated fare"
            WHEN rate_code_id = 6 THEN "Group ride"
        END AS rate_code_name
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata`
)
SELECT
    rate_id,
    rate_code_name
FROM rate_code_cte
    );
  
[0m18:21:25.000566 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:0e082f81-85a7-46d2-97a7-4f841764e9ef&page=queryresults
[0m18:21:27.493643 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'acc78a3e-4d08-402b-824c-2e7c6049ab95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55690677c0>]}
[0m18:21:27.498103 [info ] [Thread-1  ]: 2 of 6 OK created sql table model nyc_taxi.dim_ratecode ........................ [[32mCREATE TABLE (59.3k rows, 463.5 KiB processed)[0m in 3.80s]
[0m18:21:27.502913 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_ratecode
[0m18:21:27.507156 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_time
[0m18:21:27.511197 [info ] [Thread-1  ]: 3 of 6 START sql table model nyc_taxi.dim_time ................................. [RUN]
[0m18:21:27.514770 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_ratecode, now model.nyc_taxi.dim_time)
[0m18:21:27.517780 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_time
[0m18:21:27.530610 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_time"
[0m18:21:27.552706 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_time
[0m18:21:27.570211 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:21:28.232221 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.dim_time"
[0m18:21:28.252867 [debug] [Thread-1  ]: On model.nyc_taxi.dim_time: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.dim_time"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`dim_time`
      
    
    

    OPTIONS()
    as (
      WITH datetime_cte AS (
    SELECT DISTINCT
        ROW_NUMBER() OVER () AS time_id,
        DATE(lpep_pickup_datetime) AS date,
        lpep_pickup_datetime AS date_part 
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata`
)
SELECT
    time_id,
    date,
    EXTRACT(YEAR FROM date_part) AS year,
    EXTRACT(MONTH FROM date_part) AS month,
    EXTRACT(DAY FROM date_part) AS day,
    EXTRACT(HOUR FROM date_part) AS hour,
    EXTRACT(MINUTE FROM date_part) AS minute,
    FORMAT_TIMESTAMP('%A', date_part) AS weekday,
    TIMESTAMP_TRUNC(date_part, HOUR) AS time
FROM datetime_cte
    );
  
[0m18:21:28.986684 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:254253f9-6132-4564-acb6-c483b56b8040&page=queryresults
[0m18:21:32.205841 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'acc78a3e-4d08-402b-824c-2e7c6049ab95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5569067910>]}
[0m18:21:32.210296 [info ] [Thread-1  ]: 3 of 6 OK created sql table model nyc_taxi.dim_time ............................ [[32mCREATE TABLE (59.3k rows, 463.5 KiB processed)[0m in 4.69s]
[0m18:21:32.215438 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_time
[0m18:21:32.218867 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_vendor
[0m18:21:32.222952 [info ] [Thread-1  ]: 4 of 6 START sql table model nyc_taxi.dim_vendor ............................... [RUN]
[0m18:21:32.226736 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_time, now model.nyc_taxi.dim_vendor)
[0m18:21:32.230011 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_vendor
[0m18:21:32.244521 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_vendor"
[0m18:21:32.268666 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_vendor
[0m18:21:32.282742 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:21:32.946781 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.dim_vendor"
[0m18:21:32.968289 [debug] [Thread-1  ]: On model.nyc_taxi.dim_vendor: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.dim_vendor"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`dim_vendor`
      
    
    

    OPTIONS()
    as (
      WITH vendor_cte AS(
    SELECT
        vendor_id AS id,
        CASE 
            WHEN vendor_id = 1 THEN "Creative Mobile Technologies"
            WHEN vendor_id = 2 THEN "VeriFone Inc."
        END AS vendor_name
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata`
)
SELECT
    id,
    vendor_name
FROM vendor_cte
    );
  
[0m18:21:33.612320 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:4d723969-8a8c-4a78-ba33-d87dd409bd95&page=queryresults
[0m18:21:36.144378 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'acc78a3e-4d08-402b-824c-2e7c6049ab95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5568f82fd0>]}
[0m18:21:36.149306 [info ] [Thread-1  ]: 4 of 6 OK created sql table model nyc_taxi.dim_vendor .......................... [[32mCREATE TABLE (59.3k rows, 463.5 KiB processed)[0m in 3.92s]
[0m18:21:36.156663 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_vendor
[0m18:21:36.160844 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_zone
[0m18:21:36.164001 [info ] [Thread-1  ]: 5 of 6 START sql table model nyc_taxi.dim_zone ................................. [RUN]
[0m18:21:36.167538 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_vendor, now model.nyc_taxi.dim_zone)
[0m18:21:36.171104 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_zone
[0m18:21:36.185987 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_zone"
[0m18:21:36.204467 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_zone
[0m18:21:36.215812 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:21:36.915994 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.dim_zone"
[0m18:21:36.938062 [debug] [Thread-1  ]: On model.nyc_taxi.dim_zone: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.dim_zone"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`dim_zone`
      
    
    

    OPTIONS()
    as (
      SELECT
    location_id,
    borough,
    zone,
    replace(service_zone, 'Boro', 'Green') as service_zone
FROM `northern-shield-437204-m0`.`nyc_taxi`.`zone_map`
    );
  
[0m18:21:37.636817 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:97218ee5-efb6-4857-ac40-7601a6918b1b&page=queryresults
[0m18:21:40.299648 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'acc78a3e-4d08-402b-824c-2e7c6049ab95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5568f82fd0>]}
[0m18:21:40.303762 [info ] [Thread-1  ]: 5 of 6 OK created sql table model nyc_taxi.dim_zone ............................ [[32mCREATE TABLE (265.0 rows, 12.1 KiB processed)[0m in 4.13s]
[0m18:21:40.308129 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_zone
[0m18:21:40.311476 [debug] [Thread-1  ]: Began running node model.nyc_taxi.fct_trips
[0m18:21:40.315149 [info ] [Thread-1  ]: 6 of 6 START sql table model nyc_taxi.fct_trips ................................ [RUN]
[0m18:21:40.318319 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_zone, now model.nyc_taxi.fct_trips)
[0m18:21:40.321787 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.fct_trips
[0m18:21:40.345457 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.fct_trips"
[0m18:21:40.361332 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.fct_trips
[0m18:21:40.372737 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:21:41.106516 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.fct_trips"
[0m18:21:41.125754 [debug] [Thread-1  ]: On model.nyc_taxi.fct_trips: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.fct_trips"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips`
      
    
    

    OPTIONS()
    as (
      WITH tripdata_cte AS (
    SELECT 
        to_hex(md5(cast(coalesce(cast(vendor_id as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(lpep_pickup_datetime as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(lpep_dropoff_datetime as string), '_dbt_utils_surrogate_key_null_') as string)))  AS trip_id,
        t.vendor_id,
        t.lpep_pickup_datetime,
        t.lpep_dropoff_datetime,
        td_pickup.time_id AS pickup_time_id,
        td_dropoff.time_id AS dropoff_time_id,
        t.rate_code_id,
        t.pu_location_id,
        t.do_location_id,
        t.passenger_count,
        t.trip_distance,
        t.fare_amount,
        t.extra,
        t.mta_tax,
        t.tip_amount,
        t.tolls_amount,
        t.improvement_surcharge,
        t.total_amount,
        t.payment_type,
        t.trip_type,
        t.congestion_surcharge
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata` AS t
    LEFT JOIN `northern-shield-437204-m0`.`nyc_taxi`.`dim_time` AS td_pickup
        ON TIMESTAMP_TRUNC(t.lpep_pickup_datetime, HOUR) = td_pickup.time
    LEFT JOIN `northern-shield-437204-m0`.`nyc_taxi`.`dim_time` AS td_dropoff
        ON TIMESTAMP_TRUNC(t.lpep_dropoff_datetime, HOUR) = td_dropoff.time
    WHERE vendor_id IS NOT NULL
        AND DATE(t.lpep_pickup_datetime) >= '2023-01-01'
        AND DATE(t.lpep_pickup_datetime) <= '2023-01-07'
)
SELECT 
    trip_id,
    vendor_id,
    pickup_time_id,
    dropoff_time_id,
    rate_code_id,
    pu_location_id,
    do_location_id,
    passenger_count,
    trip_distance,
    fare_amount,
    extra,
    mta_tax,
    tip_amount,
    tolls_amount,
    improvement_surcharge,
    total_amount,
    payment_type,
    trip_type,
    congestion_surcharge
FROM tripdata_cte
    );
  
[0m18:21:41.712232 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:6203c20b-7a4f-4cdf-83c6-0d2201a411da&page=queryresults
[0m18:26:47.037169 [debug] [Thread-1  ]: BigQuery adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.fct_trips"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips`
      
    
    

    OPTIONS()
    as (
      WITH tripdata_cte AS (
    SELECT 
        to_hex(md5(cast(coalesce(cast(vendor_id as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(lpep_pickup_datetime as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(lpep_dropoff_datetime as string), '_dbt_utils_surrogate_key_null_') as string)))  AS trip_id,
        t.vendor_id,
        t.lpep_pickup_datetime,
        t.lpep_dropoff_datetime,
        td_pickup.time_id AS pickup_time_id,
        td_dropoff.time_id AS dropoff_time_id,
        t.rate_code_id,
        t.pu_location_id,
        t.do_location_id,
        t.passenger_count,
        t.trip_distance,
        t.fare_amount,
        t.extra,
        t.mta_tax,
        t.tip_amount,
        t.tolls_amount,
        t.improvement_surcharge,
        t.total_amount,
        t.payment_type,
        t.trip_type,
        t.congestion_surcharge
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata` AS t
    LEFT JOIN `northern-shield-437204-m0`.`nyc_taxi`.`dim_time` AS td_pickup
        ON TIMESTAMP_TRUNC(t.lpep_pickup_datetime, HOUR) = td_pickup.time
    LEFT JOIN `northern-shield-437204-m0`.`nyc_taxi`.`dim_time` AS td_dropoff
        ON TIMESTAMP_TRUNC(t.lpep_dropoff_datetime, HOUR) = td_dropoff.time
    WHERE vendor_id IS NOT NULL
        AND DATE(t.lpep_pickup_datetime) >= '2023-01-01'
        AND DATE(t.lpep_pickup_datetime) <= '2023-01-07'
)
SELECT 
    trip_id,
    vendor_id,
    pickup_time_id,
    dropoff_time_id,
    rate_code_id,
    pu_location_id,
    do_location_id,
    passenger_count,
    trip_distance,
    fare_amount,
    extra,
    mta_tax,
    tip_amount,
    tolls_amount,
    improvement_surcharge,
    total_amount,
    payment_type,
    trip_type,
    congestion_surcharge
FROM tripdata_cte
    );
  
[0m18:26:47.042210 [debug] [Thread-1  ]: BigQuery adapter: Operation did not complete within the designated timeout of 300 seconds.
[0m18:26:47.052280 [debug] [Thread-1  ]: Runtime Error in model fct_trips (models/transform/fct_trips.sql)
  Operation did not complete within the designated timeout of 300 seconds.
[0m18:26:47.056004 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'acc78a3e-4d08-402b-824c-2e7c6049ab95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5568ffa850>]}
[0m18:26:47.060611 [error] [Thread-1  ]: 6 of 6 ERROR creating sql table model nyc_taxi.fct_trips ....................... [[31mERROR[0m in 306.74s]
[0m18:26:47.065724 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.fct_trips
[0m18:26:47.074348 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:26:47.077670 [debug] [MainThread]: Connection 'model.nyc_taxi.fct_trips' was properly closed.
[0m18:26:47.081311 [info ] [MainThread]: 
[0m18:26:47.088302 [info ] [MainThread]: Finished running 6 table models in 0 hours 5 minutes and 29.62 seconds (329.62s).
[0m18:26:47.101813 [debug] [MainThread]: Command end result
[0m18:26:47.307077 [info ] [MainThread]: 
[0m18:26:47.311469 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:26:47.314518 [info ] [MainThread]: 
[0m18:26:47.318729 [error] [MainThread]:   Runtime Error in model fct_trips (models/transform/fct_trips.sql)
  Operation did not complete within the designated timeout of 300 seconds.
[0m18:26:47.323494 [info ] [MainThread]: 
[0m18:26:47.328896 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m18:26:47.335742 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 339.03674, "process_in_blocks": "1144", "process_kernel_time": 0.874625, "process_mem_max_rss": "230196", "process_out_blocks": "0", "process_user_time": 12.244753}
[0m18:26:47.339337 [debug] [MainThread]: Command `dbt run` failed at 18:26:47.338966 after 339.04 seconds
[0m18:26:47.343367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55700c8c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f556938e070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f556f87cd60>]}
[0m18:26:47.346756 [debug] [MainThread]: Flushing usage events
[0m18:36:53.284120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb78eb7eca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb78c980f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb78c980f10>]}


============================== 18:36:53.307201 | 91454f1b-1650-4ca8-86e3-373b322dae6a ==============================
[0m18:36:53.307201 [info ] [MainThread]: Running with dbt=1.8.9
[0m18:36:53.310786 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'empty': 'False', 'printer_width': '80', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'write_json': 'True', 'version_check': 'True', 'partial_parse': 'True', 'no_print': 'None', 'quiet': 'False', 'log_path': '/opt/airflow/include/dbt/logs', 'cache_selected_only': 'False', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/include/dbt/', 'log_format': 'default', 'warn_error': 'None', 'use_colors': 'True', 'profiles_dir': '/opt/airflow/include/dbt/', 'use_experimental_parser': 'False', 'debug': 'False', 'log_cache_events': 'False'}
[0m18:36:56.163426 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '91454f1b-1650-4ca8-86e3-373b322dae6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb78ee2ef70>]}
[0m18:36:56.331344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '91454f1b-1650-4ca8-86e3-373b322dae6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb755526d00>]}
[0m18:36:56.335200 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m18:36:56.801312 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m18:36:59.955328 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:36:59.959083 [debug] [MainThread]: Partial parsing: updated file: nyc_taxi://models/transform/fct_trips.sql
[0m18:37:00.857444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '91454f1b-1650-4ca8-86e3-373b322dae6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb787b12eb0>]}
[0m18:37:01.271641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '91454f1b-1650-4ca8-86e3-373b322dae6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb787b31df0>]}
[0m18:37:01.276538 [info ] [MainThread]: Found 6 models, 2 sources, 600 macros
[0m18:37:01.279783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '91454f1b-1650-4ca8-86e3-373b322dae6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb787b7a3a0>]}
[0m18:37:01.286674 [info ] [MainThread]: 
[0m18:37:01.291764 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:37:01.314137 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_northern-shield-437204-m0'
[0m18:37:01.316864 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:37:02.059205 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_northern-shield-437204-m0, now list_northern-shield-437204-m0_nyc_taxi)
[0m18:37:02.062711 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:37:02.726272 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '91454f1b-1650-4ca8-86e3-373b322dae6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb78dead8e0>]}
[0m18:37:02.730591 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:37:02.746486 [info ] [MainThread]: 
[0m18:37:02.769413 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_payment
[0m18:37:02.773661 [info ] [Thread-1  ]: 1 of 6 START sql table model nyc_taxi.dim_payment .............................. [RUN]
[0m18:37:02.777448 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_northern-shield-437204-m0_nyc_taxi, now model.nyc_taxi.dim_payment)
[0m18:37:02.780762 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_payment
[0m18:37:02.814436 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_payment"
[0m18:37:02.838072 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_payment
[0m18:37:02.893954 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:37:03.701607 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.dim_payment"
[0m18:37:03.724971 [debug] [Thread-1  ]: On model.nyc_taxi.dim_payment: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.dim_payment"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`dim_payment`
      
    
    

    OPTIONS()
    as (
      WITH payment_cte AS(
    SELECT
        payment_type AS type_id,
        CASE 
            WHEN payment_type = 1 THEN "Credit card"
            WHEN payment_type = 2 THEN "Cash"
            WHEN payment_type = 3 THEN "No charge"
            WHEN payment_type = 4 THEN "Dispute"
            WHEN payment_type = 5 THEN "Unknown"
            WHEN payment_type = 6 THEN "Voided trip"
        END AS payment_name
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata`
)
SELECT
    type_id,
    payment_name
FROM payment_cte
    );
  
[0m18:37:04.340924 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:373e274b-1a98-403f-a65f-b5ff8673e5a4&page=queryresults
[0m18:37:07.337985 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '91454f1b-1650-4ca8-86e3-373b322dae6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7562d88e0>]}
[0m18:37:07.342737 [info ] [Thread-1  ]: 1 of 6 OK created sql table model nyc_taxi.dim_payment ......................... [[32mCREATE TABLE (59.3k rows, 463.5 KiB processed)[0m in 4.56s]
[0m18:37:07.347062 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_payment
[0m18:37:07.350975 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_ratecode
[0m18:37:07.355129 [info ] [Thread-1  ]: 2 of 6 START sql table model nyc_taxi.dim_ratecode ............................. [RUN]
[0m18:37:07.359959 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_payment, now model.nyc_taxi.dim_ratecode)
[0m18:37:07.363281 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_ratecode
[0m18:37:07.376449 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_ratecode"
[0m18:37:07.400354 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_ratecode
[0m18:37:07.411964 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:37:08.083270 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.dim_ratecode"
[0m18:37:08.103843 [debug] [Thread-1  ]: On model.nyc_taxi.dim_ratecode: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.dim_ratecode"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`dim_ratecode`
      
    
    

    OPTIONS()
    as (
      WITH rate_code_cte AS(
    SELECT
        rate_code_id AS rate_id,
        CASE 
            WHEN rate_code_id = 1 THEN "Standard rate"
            WHEN rate_code_id = 2 THEN "JFK"
            WHEN rate_code_id = 3 THEN "Newark"
            WHEN rate_code_id = 4 THEN "Nassau or Westchester"
            WHEN rate_code_id = 5 THEN "Negotiated fare"
            WHEN rate_code_id = 6 THEN "Group ride"
        END AS rate_code_name
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata`
)
SELECT
    rate_id,
    rate_code_name
FROM rate_code_cte
    );
  
[0m18:37:08.702661 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:f2f3fdf1-bce3-426b-bf1b-7e37203bbb06&page=queryresults
[0m18:37:11.497047 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '91454f1b-1650-4ca8-86e3-373b322dae6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb787a73ee0>]}
[0m18:37:11.500985 [info ] [Thread-1  ]: 2 of 6 OK created sql table model nyc_taxi.dim_ratecode ........................ [[32mCREATE TABLE (59.3k rows, 463.5 KiB processed)[0m in 4.14s]
[0m18:37:11.505968 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_ratecode
[0m18:37:11.509314 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_time
[0m18:37:11.512989 [info ] [Thread-1  ]: 3 of 6 START sql table model nyc_taxi.dim_time ................................. [RUN]
[0m18:37:11.516505 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_ratecode, now model.nyc_taxi.dim_time)
[0m18:37:11.519602 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_time
[0m18:37:11.531070 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_time"
[0m18:37:11.554011 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_time
[0m18:37:11.569129 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:37:12.186835 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.dim_time"
[0m18:37:12.210985 [debug] [Thread-1  ]: On model.nyc_taxi.dim_time: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.dim_time"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`dim_time`
      
    
    

    OPTIONS()
    as (
      WITH datetime_cte AS (
    SELECT DISTINCT
        ROW_NUMBER() OVER () AS time_id,
        DATE(lpep_pickup_datetime) AS date,
        lpep_pickup_datetime AS date_part 
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata`
)
SELECT
    time_id,
    date,
    EXTRACT(YEAR FROM date_part) AS year,
    EXTRACT(MONTH FROM date_part) AS month,
    EXTRACT(DAY FROM date_part) AS day,
    EXTRACT(HOUR FROM date_part) AS hour,
    EXTRACT(MINUTE FROM date_part) AS minute,
    FORMAT_TIMESTAMP('%A', date_part) AS weekday,
    TIMESTAMP_TRUNC(date_part, HOUR) AS time
FROM datetime_cte
    );
  
[0m18:37:12.903665 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:fe081740-4c1c-4dec-8a9a-e4d1d421de2b&page=queryresults
[0m18:37:16.125228 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '91454f1b-1650-4ca8-86e3-373b322dae6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7562d88e0>]}
[0m18:37:16.129420 [info ] [Thread-1  ]: 3 of 6 OK created sql table model nyc_taxi.dim_time ............................ [[32mCREATE TABLE (59.3k rows, 463.5 KiB processed)[0m in 4.61s]
[0m18:37:16.134309 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_time
[0m18:37:16.138364 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_vendor
[0m18:37:16.142314 [info ] [Thread-1  ]: 4 of 6 START sql table model nyc_taxi.dim_vendor ............................... [RUN]
[0m18:37:16.145451 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_time, now model.nyc_taxi.dim_vendor)
[0m18:37:16.148263 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_vendor
[0m18:37:16.160778 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_vendor"
[0m18:37:16.183386 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_vendor
[0m18:37:16.194507 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:37:16.952910 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.dim_vendor"
[0m18:37:16.978222 [debug] [Thread-1  ]: On model.nyc_taxi.dim_vendor: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.dim_vendor"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`dim_vendor`
      
    
    

    OPTIONS()
    as (
      WITH vendor_cte AS(
    SELECT
        vendor_id AS id,
        CASE 
            WHEN vendor_id = 1 THEN "Creative Mobile Technologies"
            WHEN vendor_id = 2 THEN "VeriFone Inc."
        END AS vendor_name
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata`
)
SELECT
    id,
    vendor_name
FROM vendor_cte
    );
  
[0m18:37:17.490069 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:dc9dba90-56e1-4149-9a9b-2e665584c61a&page=queryresults
[0m18:37:20.195364 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '91454f1b-1650-4ca8-86e3-373b322dae6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb787981ac0>]}
[0m18:37:20.199301 [info ] [Thread-1  ]: 4 of 6 OK created sql table model nyc_taxi.dim_vendor .......................... [[32mCREATE TABLE (59.3k rows, 463.5 KiB processed)[0m in 4.05s]
[0m18:37:20.205123 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_vendor
[0m18:37:20.208975 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_zone
[0m18:37:20.213018 [info ] [Thread-1  ]: 5 of 6 START sql table model nyc_taxi.dim_zone ................................. [RUN]
[0m18:37:20.223552 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_vendor, now model.nyc_taxi.dim_zone)
[0m18:37:20.227813 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_zone
[0m18:37:20.242797 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_zone"
[0m18:37:20.265813 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_zone
[0m18:37:20.278111 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:37:20.990500 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.dim_zone"
[0m18:37:21.009195 [debug] [Thread-1  ]: On model.nyc_taxi.dim_zone: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.dim_zone"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`dim_zone`
      
    
    

    OPTIONS()
    as (
      SELECT
    location_id,
    borough,
    zone,
    replace(service_zone, 'Boro', 'Green') as service_zone
FROM `northern-shield-437204-m0`.`nyc_taxi`.`zone_map`
    );
  
[0m18:37:21.674936 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:e7ee4a02-f7e7-47f4-98e6-636994cc33d7&page=queryresults
[0m18:37:24.176877 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '91454f1b-1650-4ca8-86e3-373b322dae6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb787981ac0>]}
[0m18:37:24.180709 [info ] [Thread-1  ]: 5 of 6 OK created sql table model nyc_taxi.dim_zone ............................ [[32mCREATE TABLE (265.0 rows, 12.1 KiB processed)[0m in 3.95s]
[0m18:37:24.185010 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_zone
[0m18:37:24.189110 [debug] [Thread-1  ]: Began running node model.nyc_taxi.fct_trips
[0m18:37:24.192494 [info ] [Thread-1  ]: 6 of 6 START sql table model nyc_taxi.fct_trips ................................ [RUN]
[0m18:37:24.195737 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_zone, now model.nyc_taxi.fct_trips)
[0m18:37:24.200626 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.fct_trips
[0m18:37:24.219314 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.fct_trips"
[0m18:37:24.237949 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.fct_trips
[0m18:37:24.250842 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:37:24.878533 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.fct_trips"
[0m18:37:24.899320 [debug] [Thread-1  ]: On model.nyc_taxi.fct_trips: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.fct_trips"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips`
      
    
    

    OPTIONS()
    as (
      WITH tripdata_cte AS (
    SELECT 
        to_hex(md5(cast(coalesce(cast(vendor_id as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(lpep_pickup_datetime as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(lpep_dropoff_datetime as string), '_dbt_utils_surrogate_key_null_') as string)))  AS trip_id,
        t.vendor_id,
        t.lpep_pickup_datetime,
        t.lpep_dropoff_datetime,
        td_pickup.time_id AS pickup_time_id,
        td_dropoff.time_id AS dropoff_time_id,
        t.rate_code_id,
        t.pu_location_id,
        t.do_location_id,
        t.passenger_count,
        t.trip_distance,
        t.fare_amount,
        t.extra,
        t.mta_tax,
        t.tip_amount,
        t.tolls_amount,
        t.improvement_surcharge,
        t.total_amount,
        t.payment_type,
        t.trip_type,
        t.congestion_surcharge
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata` AS t
    LEFT JOIN `northern-shield-437204-m0`.`nyc_taxi`.`dim_time` AS td_pickup
        ON TIMESTAMP_TRUNC(t.lpep_pickup_datetime, HOUR) = td_pickup.time
    LEFT JOIN `northern-shield-437204-m0`.`nyc_taxi`.`dim_time` AS td_dropoff
        ON TIMESTAMP_TRUNC(t.lpep_dropoff_datetime, HOUR) = td_dropoff.time
    WHERE vendor_id IS NOT NULL
)
SELECT 
    trip_id,
    vendor_id,
    pickup_time_id,
    dropoff_time_id,
    rate_code_id,
    pu_location_id,
    do_location_id,
    passenger_count,
    trip_distance,
    fare_amount,
    extra,
    mta_tax,
    tip_amount,
    tolls_amount,
    improvement_surcharge,
    total_amount,
    payment_type,
    trip_type,
    congestion_surcharge
FROM tripdata_cte
WHERE DATE(t.lpep_pickup_datetime) >= '2023-01-01'
    AND DATE(t.lpep_pickup_datetime) <= '2023-01-07'
    );
  
[0m18:37:25.571448 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:f50033d7-9573-4576-b13a-38ef107b7c07&page=queryresults
[0m18:37:25.900495 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: t at [64:12]; reason: invalidQuery, location: query, message: Unrecognized name: t at [64:12]')
[0m18:37:27.178535 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:64cadd04-cb6f-4850-87cf-8fe7bbf62981&page=queryresults
[0m18:37:27.514621 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:64cadd04-cb6f-4850-87cf-8fe7bbf62981&page=queryresults
[0m18:37:27.525750 [debug] [Thread-1  ]: Database Error in model fct_trips (models/transform/fct_trips.sql)
  Unrecognized name: t at [64:12]
  compiled code at target/run/nyc_taxi/models/transform/fct_trips.sql
[0m18:37:27.529727 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '91454f1b-1650-4ca8-86e3-373b322dae6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb787a5ca30>]}
[0m18:37:27.533746 [error] [Thread-1  ]: 6 of 6 ERROR creating sql table model nyc_taxi.fct_trips ....................... [[31mERROR[0m in 3.33s]
[0m18:37:27.539444 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.fct_trips
[0m18:37:27.546597 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:37:27.549980 [debug] [MainThread]: Connection 'model.nyc_taxi.fct_trips' was properly closed.
[0m18:37:27.553307 [info ] [MainThread]: 
[0m18:37:27.556846 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 26.26 seconds (26.26s).
[0m18:37:27.566014 [debug] [MainThread]: Command end result
[0m18:37:27.746882 [info ] [MainThread]: 
[0m18:37:27.750596 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:37:27.753781 [info ] [MainThread]: 
[0m18:37:27.757686 [error] [MainThread]:   Database Error in model fct_trips (models/transform/fct_trips.sql)
  Unrecognized name: t at [64:12]
  compiled code at target/run/nyc_taxi/models/transform/fct_trips.sql
[0m18:37:27.763100 [info ] [MainThread]: 
[0m18:37:27.769256 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m18:37:27.774431 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 34.832977, "process_in_blocks": "336", "process_kernel_time": 0.888927, "process_mem_max_rss": "235276", "process_out_blocks": "0", "process_user_time": 12.232855}
[0m18:37:27.778080 [debug] [MainThread]: Command `dbt run` failed at 18:37:27.777704 after 34.84 seconds
[0m18:37:27.781459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb78eb7eca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb787c6baf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb78d0a94f0>]}
[0m18:37:27.784603 [debug] [MainThread]: Flushing usage events
[0m19:45:53.670490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7272978ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7270782e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7270782df0>]}


============================== 19:45:53.677772 | c4411a96-a8a4-4cc6-92bf-ab6b5769115e ==============================
[0m19:45:53.677772 [info ] [MainThread]: Running with dbt=1.8.9
[0m19:45:53.679239 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt debug --profiles-dir /opt/airflow/include/dbt/', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'no_print': 'None', 'profiles_dir': '/opt/airflow/include/dbt/', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'log_format': 'default', 'log_cache_events': 'False', 'log_path': '/opt/airflow/include/dbt/logs', 'use_colors': 'True', 'indirect_selection': 'eager', 'quiet': 'False', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'fail_fast': 'False', 'cache_selected_only': 'False', 'debug': 'False', 'printer_width': '80', 'warn_error': 'None', 'empty': 'None', 'use_experimental_parser': 'False', 'partial_parse': 'True'}
[0m19:45:53.689791 [info ] [MainThread]: dbt version: 1.8.9
[0m19:45:53.690822 [info ] [MainThread]: python version: 3.9.19
[0m19:45:53.691923 [info ] [MainThread]: python path: /opt/airflow/dbt_venv/bin/python
[0m19:45:53.692864 [info ] [MainThread]: os info: Linux-5.15.167.4-microsoft-standard-WSL2-x86_64-with-glibc2.36
[0m19:45:54.936021 [info ] [MainThread]: Using profiles dir at /opt/airflow/include/dbt/
[0m19:45:54.937417 [info ] [MainThread]: Using profiles.yml file at /opt/airflow/include/dbt/profiles.yml
[0m19:45:54.938460 [info ] [MainThread]: Using dbt_project.yml file at /opt/airflow/include/dbt/dbt_project.yml
[0m19:45:54.939487 [info ] [MainThread]: adapter type: bigquery
[0m19:45:54.940398 [info ] [MainThread]: adapter version: 1.8.3
[0m19:45:55.049105 [info ] [MainThread]: Configuration:
[0m19:45:55.051084 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m19:45:55.052309 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m19:45:55.053415 [info ] [MainThread]: Required dependencies:
[0m19:45:55.054521 [debug] [MainThread]: Executing "git --help"
[0m19:45:55.071121 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m19:45:55.073141 [debug] [MainThread]: STDERR: "b''"
[0m19:45:55.074232 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m19:45:55.075325 [info ] [MainThread]: Connection:
[0m19:45:55.076303 [info ] [MainThread]:   method: service-account
[0m19:45:55.077170 [info ] [MainThread]:   database: northern-shield-437204-m0
[0m19:45:55.078157 [info ] [MainThread]:   execution_project: northern-shield-437204-m0
[0m19:45:55.079047 [info ] [MainThread]:   schema: nyc_taxi
[0m19:45:55.079939 [info ] [MainThread]:   location: us-central1
[0m19:45:55.080801 [info ] [MainThread]:   priority: None
[0m19:45:55.081661 [info ] [MainThread]:   maximum_bytes_billed: None
[0m19:45:55.082506 [info ] [MainThread]:   impersonate_service_account: None
[0m19:45:55.083348 [info ] [MainThread]:   job_retry_deadline_seconds: None
[0m19:45:55.084244 [info ] [MainThread]:   job_retries: 1
[0m19:45:55.085131 [info ] [MainThread]:   job_creation_timeout_seconds: None
[0m19:45:55.085949 [info ] [MainThread]:   job_execution_timeout_seconds: 300
[0m19:45:55.086749 [info ] [MainThread]:   timeout_seconds: 300
[0m19:45:55.087558 [info ] [MainThread]:   client_id: None
[0m19:45:55.088372 [info ] [MainThread]:   token_uri: None
[0m19:45:55.089244 [info ] [MainThread]:   dataproc_region: None
[0m19:45:55.090293 [info ] [MainThread]:   dataproc_cluster_name: None
[0m19:45:55.091282 [info ] [MainThread]:   gcs_bucket: None
[0m19:45:55.092211 [info ] [MainThread]:   dataproc_batch: None
[0m19:45:55.093440 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m19:45:55.230823 [debug] [MainThread]: Acquiring new bigquery connection 'debug'
[0m19:45:55.232224 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:45:55.235598 [debug] [MainThread]: On debug: select 1 as id
[0m19:45:55.913055 [debug] [MainThread]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:074729ca-f4e5-4d90-8447-1b38edcd9b60&page=queryresults
[0m19:45:56.664202 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m19:45:56.665834 [info ] [MainThread]: [32mAll checks passed![0m
[0m19:45:56.667901 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 3.0659254, "process_in_blocks": "4872", "process_kernel_time": 0.338443, "process_mem_max_rss": "246968", "process_out_blocks": "0", "process_user_time": 4.428769}
[0m19:45:56.669374 [debug] [MainThread]: Command `dbt debug` succeeded at 19:45:56.669175 after 3.07 seconds
[0m19:45:56.670476 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m19:45:56.671656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7272978ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7273545c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7239312550>]}
[0m19:45:56.672969 [debug] [MainThread]: Flushing usage events
[0m19:47:11.920150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27bf6abca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27bd4adf70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27bd4adf10>]}


============================== 19:47:11.928398 | 08aff747-a998-48a5-a03b-84c6cfd459f3 ==============================
[0m19:47:11.928398 [info ] [MainThread]: Running with dbt=1.8.9
[0m19:47:11.929922 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'log_path': '/opt/airflow/include/dbt/logs', 'no_print': 'None', 'static_parser': 'True', 'introspect': 'True', 'empty': 'False', 'debug': 'False', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/include/dbt/', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'profiles_dir': '/opt/airflow/include/dbt/', 'warn_error': 'None', 'partial_parse': 'True', 'fail_fast': 'False', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'use_experimental_parser': 'False', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'target_path': 'None', 'quiet': 'False', 'write_json': 'True', 'printer_width': '80'}
[0m19:47:13.089303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '08aff747-a998-48a5-a03b-84c6cfd459f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27bee5eb50>]}
[0m19:47:13.154165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '08aff747-a998-48a5-a03b-84c6cfd459f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27bf9fe370>]}
[0m19:47:13.156178 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m19:47:13.335292 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m19:47:14.023636 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 5 files changed.
[0m19:47:14.025094 [debug] [MainThread]: Partial parsing: updated file: nyc_taxi://models/transform/dim_time.sql
[0m19:47:14.026339 [debug] [MainThread]: Partial parsing: updated file: nyc_taxi://models/transform/dim_ratecode.sql
[0m19:47:14.027387 [debug] [MainThread]: Partial parsing: updated file: nyc_taxi://models/transform/dim_payment.sql
[0m19:47:14.028324 [debug] [MainThread]: Partial parsing: updated file: nyc_taxi://models/transform/fct_trips.sql
[0m19:47:14.029415 [debug] [MainThread]: Partial parsing: updated file: nyc_taxi://models/transform/dim_vendor.sql
[0m19:47:14.476491 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '08aff747-a998-48a5-a03b-84c6cfd459f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27b7d0b130>]}
[0m19:47:14.621745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '08aff747-a998-48a5-a03b-84c6cfd459f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27b7d2acd0>]}
[0m19:47:14.623143 [info ] [MainThread]: Found 6 models, 2 sources, 600 macros
[0m19:47:14.624532 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '08aff747-a998-48a5-a03b-84c6cfd459f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27b7d3e3d0>]}
[0m19:47:14.627582 [info ] [MainThread]: 
[0m19:47:14.629170 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:47:14.636497 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_northern-shield-437204-m0'
[0m19:47:14.637807 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:47:15.343970 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_northern-shield-437204-m0, now list_northern-shield-437204-m0_nyc_taxi)
[0m19:47:15.345216 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:47:15.944033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '08aff747-a998-48a5-a03b-84c6cfd459f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2785fdf970>]}
[0m19:47:15.945325 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:47:15.946481 [info ] [MainThread]: 
[0m19:47:15.954101 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_payment
[0m19:47:15.955439 [info ] [Thread-1  ]: 1 of 6 START sql table model nyc_taxi.dim_payment .............................. [RUN]
[0m19:47:15.956852 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_northern-shield-437204-m0_nyc_taxi, now model.nyc_taxi.dim_payment)
[0m19:47:15.958173 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_payment
[0m19:47:15.969784 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_payment"
[0m19:47:15.974705 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_payment
[0m19:47:16.025814 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.dim_payment"
[0m19:47:16.030892 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:47:16.034415 [debug] [Thread-1  ]: On model.nyc_taxi.dim_payment: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.dim_payment"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`dim_payment`
      
    
    

    OPTIONS()
    as (
      WITH payment_cte AS(
    SELECT DISTINCT
        payment_type AS type_id,
        CASE 
            WHEN payment_type = 1 THEN "Credit card"
            WHEN payment_type = 2 THEN "Cash"
            WHEN payment_type = 3 THEN "No charge"
            WHEN payment_type = 4 THEN "Dispute"
            WHEN payment_type = 5 THEN "Unknown"
            WHEN payment_type = 6 THEN "Voided trip"
        END AS payment_name
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata`
)
SELECT
    type_id,
    payment_name
FROM payment_cte
    );
  
[0m19:47:16.909161 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:56d9be20-ab37-45fe-8358-1b2152a66992&page=queryresults
[0m19:47:19.032893 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '08aff747-a998-48a5-a03b-84c6cfd459f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27b7cb0dc0>]}
[0m19:47:19.034851 [info ] [Thread-1  ]: 1 of 6 OK created sql table model nyc_taxi.dim_payment ......................... [[32mCREATE TABLE (4.0 rows, 463.5 KiB processed)[0m in 3.08s]
[0m19:47:19.036817 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_payment
[0m19:47:19.038439 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_ratecode
[0m19:47:19.039966 [info ] [Thread-1  ]: 2 of 6 START sql table model nyc_taxi.dim_ratecode ............................. [RUN]
[0m19:47:19.041235 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_payment, now model.nyc_taxi.dim_ratecode)
[0m19:47:19.042191 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_ratecode
[0m19:47:19.046981 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_ratecode"
[0m19:47:19.051892 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_ratecode
[0m19:47:19.057433 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.dim_ratecode"
[0m19:47:19.062658 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:47:19.066081 [debug] [Thread-1  ]: On model.nyc_taxi.dim_ratecode: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.dim_ratecode"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`dim_ratecode`
      
    
    

    OPTIONS()
    as (
      WITH rate_code_cte AS(
    SELECT DISTINCT
        rate_code_id AS rate_id,
        CASE 
            WHEN rate_code_id = 1 THEN "Standard rate"
            WHEN rate_code_id = 2 THEN "JFK"
            WHEN rate_code_id = 3 THEN "Newark"
            WHEN rate_code_id = 4 THEN "Nassau or Westchester"
            WHEN rate_code_id = 5 THEN "Negotiated fare"
            WHEN rate_code_id = 6 THEN "Group ride"
        ELSE "Unknown"
        END AS rate_code_name
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata`
)
SELECT
    rate_id,
    rate_code_name
FROM rate_code_cte
    );
  
[0m19:47:19.785934 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:b2af25f1-bd03-444b-b57c-dda954ded514&page=queryresults
[0m19:47:22.567569 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '08aff747-a998-48a5-a03b-84c6cfd459f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27b7c4f8b0>]}
[0m19:47:22.569412 [info ] [Thread-1  ]: 2 of 6 OK created sql table model nyc_taxi.dim_ratecode ........................ [[32mCREATE TABLE (6.0 rows, 463.5 KiB processed)[0m in 3.53s]
[0m19:47:22.571454 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_ratecode
[0m19:47:22.573083 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_time
[0m19:47:22.574514 [info ] [Thread-1  ]: 3 of 6 START sql table model nyc_taxi.dim_time ................................. [RUN]
[0m19:47:22.576078 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_ratecode, now model.nyc_taxi.dim_time)
[0m19:47:22.577581 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_time
[0m19:47:22.585617 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_time"
[0m19:47:22.590520 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_time
[0m19:47:22.595812 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.dim_time"
[0m19:47:22.601185 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:47:22.604311 [debug] [Thread-1  ]: On model.nyc_taxi.dim_time: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.dim_time"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`dim_time`
      
    
    

    OPTIONS()
    as (
      WITH datetime_cte AS (
    SELECT DISTINCT
        lpep_pickup_datetime AS datetime_value
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata`
    UNION
    SELECT DISTINCT
        lpep_dropoff_datetime AS datetime_value
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata`
)
SELECT DISTINCT
    ROW_NUMBER() OVER (ORDER BY datetime_value) AS time_id,
    DATE(datetime_value) AS date,
    datetime_value AS date_part,
    EXTRACT(YEAR FROM datetime_value) AS year,
    EXTRACT(MONTH FROM datetime_value) AS month,
    EXTRACT(DAY FROM datetime_value) AS day,
    EXTRACT(HOUR FROM datetime_value) AS hour,
    EXTRACT(MINUTE FROM datetime_value) AS minute,
    FORMAT_TIMESTAMP('%A', datetime_value) AS weekday,
    TIMESTAMP_TRUNC(datetime_value, HOUR) AS time
FROM datetime_cte
    );
  
[0m19:47:23.165417 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:cb66354a-e87c-4c45-9aca-e19f80e3972c&page=queryresults
[0m19:47:23.167031 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected keyword ALL or keyword DISTINCT but got keyword SELECT at [18:5]; reason: invalidQuery, location: query, message: Syntax error: Expected keyword ALL or keyword DISTINCT but got keyword SELECT at [18:5]')
[0m19:47:23.824792 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:99e8db2b-d30f-4d71-bc15-f1a63ed7a4df&page=queryresults
[0m19:47:23.826606 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:99e8db2b-d30f-4d71-bc15-f1a63ed7a4df&page=queryresults
[0m19:47:23.840013 [debug] [Thread-1  ]: Database Error in model dim_time (models/transform/dim_time.sql)
  Syntax error: Expected keyword ALL or keyword DISTINCT but got keyword SELECT at [18:5]
  compiled code at target/run/nyc_taxi/models/transform/dim_time.sql
[0m19:47:23.841374 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '08aff747-a998-48a5-a03b-84c6cfd459f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27b7c62520>]}
[0m19:47:23.842780 [error] [Thread-1  ]: 3 of 6 ERROR creating sql table model nyc_taxi.dim_time ........................ [[31mERROR[0m in 1.27s]
[0m19:47:23.844584 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_time
[0m19:47:23.846659 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_vendor
[0m19:47:23.848588 [info ] [Thread-1  ]: 4 of 6 START sql table model nyc_taxi.dim_vendor ............................... [RUN]
[0m19:47:23.849959 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_time, now model.nyc_taxi.dim_vendor)
[0m19:47:23.851086 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_vendor
[0m19:47:23.856445 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_vendor"
[0m19:47:23.861293 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_vendor
[0m19:47:23.866468 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.dim_vendor"
[0m19:47:23.871429 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:47:23.875183 [debug] [Thread-1  ]: On model.nyc_taxi.dim_vendor: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.dim_vendor"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`dim_vendor`
      
    
    

    OPTIONS()
    as (
      WITH vendor_cte AS(
    SELECT DISTINCT
        vendor_id AS id,
        CASE 
            WHEN vendor_id = 1 THEN "Creative Mobile Technologies"
            WHEN vendor_id = 2 THEN "VeriFone Inc."
        END AS vendor_name
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata`
)
SELECT
    id,
    vendor_name
FROM vendor_cte
    );
  
[0m19:47:25.852588 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:7a7eff4c-f17c-481e-822d-f433baf70f4f&page=queryresults
[0m19:47:30.974100 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '08aff747-a998-48a5-a03b-84c6cfd459f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27b55f75e0>]}
[0m19:47:30.976231 [info ] [Thread-1  ]: 4 of 6 OK created sql table model nyc_taxi.dim_vendor .......................... [[32mCREATE TABLE (2.0 rows, 463.5 KiB processed)[0m in 7.12s]
[0m19:47:30.978434 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_vendor
[0m19:47:30.980047 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_zone
[0m19:47:30.981474 [info ] [Thread-1  ]: 5 of 6 START sql table model nyc_taxi.dim_zone ................................. [RUN]
[0m19:47:30.982915 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_vendor, now model.nyc_taxi.dim_zone)
[0m19:47:30.984152 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_zone
[0m19:47:30.989207 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_zone"
[0m19:47:30.994550 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_zone
[0m19:47:31.002282 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.dim_zone"
[0m19:47:31.007501 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:47:31.011772 [debug] [Thread-1  ]: On model.nyc_taxi.dim_zone: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.dim_zone"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`dim_zone`
      
    
    

    OPTIONS()
    as (
      SELECT
    location_id,
    borough,
    zone,
    replace(service_zone, 'Boro', 'Green') as service_zone
FROM `northern-shield-437204-m0`.`nyc_taxi`.`zone_map`
    );
  
[0m19:47:32.416594 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:1a7c76c9-a0a1-47b3-9f31-49c4e8ef4c6d&page=queryresults
[0m19:47:35.144962 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '08aff747-a998-48a5-a03b-84c6cfd459f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27b54a7a30>]}
[0m19:47:35.146868 [info ] [Thread-1  ]: 5 of 6 OK created sql table model nyc_taxi.dim_zone ............................ [[32mCREATE TABLE (265.0 rows, 12.1 KiB processed)[0m in 4.16s]
[0m19:47:35.148450 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_zone
[0m19:47:35.150038 [debug] [Thread-1  ]: Began running node model.nyc_taxi.fct_trips
[0m19:47:35.151158 [info ] [Thread-1  ]: 6 of 6 SKIP relation nyc_taxi.fct_trips ........................................ [[33mSKIP[0m]
[0m19:47:35.152327 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.fct_trips
[0m19:47:35.154365 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:47:35.155202 [debug] [MainThread]: Connection 'model.nyc_taxi.dim_zone' was properly closed.
[0m19:47:35.156237 [info ] [MainThread]: 
[0m19:47:35.157209 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 20.53 seconds (20.53s).
[0m19:47:35.159930 [debug] [MainThread]: Command end result
[0m19:47:35.225268 [info ] [MainThread]: 
[0m19:47:35.232239 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m19:47:35.233563 [info ] [MainThread]: 
[0m19:47:35.234858 [error] [MainThread]:   Database Error in model dim_time (models/transform/dim_time.sql)
  Syntax error: Expected keyword ALL or keyword DISTINCT but got keyword SELECT at [18:5]
  compiled code at target/run/nyc_taxi/models/transform/dim_time.sql
[0m19:47:35.235928 [info ] [MainThread]: 
[0m19:47:35.236973 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=1 TOTAL=6
[0m19:47:35.238616 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 24.0434, "process_in_blocks": "280", "process_kernel_time": 0.308979, "process_mem_max_rss": "245452", "process_out_blocks": "0", "process_user_time": 5.609912}
[0m19:47:35.239808 [debug] [MainThread]: Command `dbt run` failed at 19:47:35.239648 after 24.04 seconds
[0m19:47:35.240744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27bf6abca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27bf9fe370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27b8992880>]}
[0m19:47:35.241600 [debug] [MainThread]: Flushing usage events
[0m19:55:07.308394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6709224c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67083902e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6707033d00>]}


============================== 19:55:07.316471 | 6a337547-e863-440e-9159-1fbc9e79fc8f ==============================
[0m19:55:07.316471 [info ] [MainThread]: Running with dbt=1.8.9
[0m19:55:07.318001 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'cache_selected_only': 'False', 'printer_width': '80', 'fail_fast': 'False', 'target_path': 'None', 'quiet': 'False', 'indirect_selection': 'eager', 'write_json': 'True', 'use_experimental_parser': 'False', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'log_path': '/opt/airflow/include/dbt/logs', 'warn_error': 'None', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/include/dbt/', 'empty': 'False', 'profiles_dir': '/opt/airflow/include/dbt/', 'log_format': 'default', 'no_print': 'None', 'use_colors': 'True', 'introspect': 'True', 'debug': 'False'}
[0m19:55:08.506035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6a337547-e863-440e-9159-1fbc9e79fc8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f670b0b6790>]}
[0m19:55:08.568719 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6a337547-e863-440e-9159-1fbc9e79fc8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66cfb93af0>]}
[0m19:55:08.570515 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m19:55:08.730835 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m19:55:09.367118 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:55:09.368571 [debug] [MainThread]: Partial parsing: updated file: nyc_taxi://models/transform/dim_time.sql
[0m19:55:09.758471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6a337547-e863-440e-9159-1fbc9e79fc8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66cfb3d310>]}
[0m19:55:09.892084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6a337547-e863-440e-9159-1fbc9e79fc8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66d4801130>]}
[0m19:55:09.893384 [info ] [MainThread]: Found 6 models, 2 sources, 600 macros
[0m19:55:09.894688 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6a337547-e863-440e-9159-1fbc9e79fc8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66cfc7e8b0>]}
[0m19:55:09.897395 [info ] [MainThread]: 
[0m19:55:09.898909 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:55:09.905456 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_northern-shield-437204-m0'
[0m19:55:09.906574 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:55:10.527539 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_northern-shield-437204-m0, now list_northern-shield-437204-m0_nyc_taxi)
[0m19:55:10.528857 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:55:11.066361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6a337547-e863-440e-9159-1fbc9e79fc8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66cfd1c3d0>]}
[0m19:55:11.067992 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:55:11.069229 [info ] [MainThread]: 
[0m19:55:11.078841 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_payment
[0m19:55:11.080275 [info ] [Thread-1  ]: 1 of 6 START sql table model nyc_taxi.dim_payment .............................. [RUN]
[0m19:55:11.081441 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_northern-shield-437204-m0_nyc_taxi, now model.nyc_taxi.dim_payment)
[0m19:55:11.082326 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_payment
[0m19:55:11.092829 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_payment"
[0m19:55:11.097658 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_payment
[0m19:55:11.117025 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:55:11.767171 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.dim_payment"
[0m19:55:11.772390 [debug] [Thread-1  ]: On model.nyc_taxi.dim_payment: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.dim_payment"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`dim_payment`
      
    
    

    OPTIONS()
    as (
      WITH payment_cte AS(
    SELECT DISTINCT
        payment_type AS type_id,
        CASE 
            WHEN payment_type = 1 THEN "Credit card"
            WHEN payment_type = 2 THEN "Cash"
            WHEN payment_type = 3 THEN "No charge"
            WHEN payment_type = 4 THEN "Dispute"
            WHEN payment_type = 5 THEN "Unknown"
            WHEN payment_type = 6 THEN "Voided trip"
        END AS payment_name
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata`
)
SELECT
    type_id,
    payment_name
FROM payment_cte
    );
  
[0m19:55:12.337529 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:16a73985-c231-41d7-9a63-80f7a5f00056&page=queryresults
[0m19:55:15.100473 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6a337547-e863-440e-9159-1fbc9e79fc8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66d4980790>]}
[0m19:55:15.102445 [info ] [Thread-1  ]: 1 of 6 OK created sql table model nyc_taxi.dim_payment ......................... [[32mCREATE TABLE (4.0 rows, 463.5 KiB processed)[0m in 4.02s]
[0m19:55:15.104299 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_payment
[0m19:55:15.105560 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_ratecode
[0m19:55:15.106680 [info ] [Thread-1  ]: 2 of 6 START sql table model nyc_taxi.dim_ratecode ............................. [RUN]
[0m19:55:15.107868 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_payment, now model.nyc_taxi.dim_ratecode)
[0m19:55:15.108830 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_ratecode
[0m19:55:15.113283 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_ratecode"
[0m19:55:15.118404 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_ratecode
[0m19:55:15.122495 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:55:15.705705 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.dim_ratecode"
[0m19:55:15.712735 [debug] [Thread-1  ]: On model.nyc_taxi.dim_ratecode: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.dim_ratecode"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`dim_ratecode`
      
    
    

    OPTIONS()
    as (
      WITH rate_code_cte AS(
    SELECT DISTINCT
        rate_code_id AS rate_id,
        CASE 
            WHEN rate_code_id = 1 THEN "Standard rate"
            WHEN rate_code_id = 2 THEN "JFK"
            WHEN rate_code_id = 3 THEN "Newark"
            WHEN rate_code_id = 4 THEN "Nassau or Westchester"
            WHEN rate_code_id = 5 THEN "Negotiated fare"
            WHEN rate_code_id = 6 THEN "Group ride"
        ELSE "Unknown"
        END AS rate_code_name
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata`
)
SELECT
    rate_id,
    rate_code_name
FROM rate_code_cte
    );
  
[0m19:55:16.314366 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:6cd372d1-ca22-4561-8018-24b0a1f3ec13&page=queryresults
[0m19:55:18.734927 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6a337547-e863-440e-9159-1fbc9e79fc8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67002b1970>]}
[0m19:55:18.736944 [info ] [Thread-1  ]: 2 of 6 OK created sql table model nyc_taxi.dim_ratecode ........................ [[32mCREATE TABLE (6.0 rows, 463.5 KiB processed)[0m in 3.63s]
[0m19:55:18.738915 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_ratecode
[0m19:55:18.740409 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_time
[0m19:55:18.741725 [info ] [Thread-1  ]: 3 of 6 START sql table model nyc_taxi.dim_time ................................. [RUN]
[0m19:55:18.743221 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_ratecode, now model.nyc_taxi.dim_time)
[0m19:55:18.744482 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_time
[0m19:55:18.750083 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_time"
[0m19:55:18.755026 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_time
[0m19:55:18.759768 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.dim_time"
[0m19:55:18.765283 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:55:18.769117 [debug] [Thread-1  ]: On model.nyc_taxi.dim_time: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.dim_time"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`dim_time`
      
    
    

    OPTIONS()
    as (
      WITH datetime_cte AS (
    SELECT DISTINCT
        lpep_pickup_datetime AS datetime_value
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata`
    UNION ALL
    SELECT DISTINCT
        lpep_dropoff_datetime AS datetime_value
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata`
)
SELECT DISTINCT
    ROW_NUMBER() OVER (ORDER BY datetime_value) AS time_id,
    DATE(datetime_value) AS date,
    datetime_value AS date_part,
    EXTRACT(YEAR FROM datetime_value) AS year,
    EXTRACT(MONTH FROM datetime_value) AS month,
    EXTRACT(DAY FROM datetime_value) AS day,
    EXTRACT(HOUR FROM datetime_value) AS hour,
    EXTRACT(MINUTE FROM datetime_value) AS minute,
    FORMAT_TIMESTAMP('%A', datetime_value) AS weekday,
    TIMESTAMP_TRUNC(datetime_value, HOUR) AS time
FROM datetime_cte
    );
  
[0m19:55:19.514710 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:84a6e640-8ea5-4c36-a099-9893d09df6ba&page=queryresults
[0m19:55:23.393390 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6a337547-e863-440e-9159-1fbc9e79fc8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66d4980790>]}
[0m19:55:23.395371 [info ] [Thread-1  ]: 3 of 6 OK created sql table model nyc_taxi.dim_time ............................ [[32mCREATE TABLE (116.8k rows, 927.0 KiB processed)[0m in 4.65s]
[0m19:55:23.397455 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_time
[0m19:55:23.398915 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_vendor
[0m19:55:23.400417 [info ] [Thread-1  ]: 4 of 6 START sql table model nyc_taxi.dim_vendor ............................... [RUN]
[0m19:55:23.401765 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_time, now model.nyc_taxi.dim_vendor)
[0m19:55:23.403111 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_vendor
[0m19:55:23.411529 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_vendor"
[0m19:55:23.416738 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_vendor
[0m19:55:23.421032 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:55:23.967740 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.dim_vendor"
[0m19:55:23.974790 [debug] [Thread-1  ]: On model.nyc_taxi.dim_vendor: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.dim_vendor"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`dim_vendor`
      
    
    

    OPTIONS()
    as (
      WITH vendor_cte AS(
    SELECT DISTINCT
        vendor_id AS id,
        CASE 
            WHEN vendor_id = 1 THEN "Creative Mobile Technologies"
            WHEN vendor_id = 2 THEN "VeriFone Inc."
        END AS vendor_name
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata`
)
SELECT
    id,
    vendor_name
FROM vendor_cte
    );
  
[0m19:55:24.535086 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:5e630804-46ea-4009-a643-e08527bca1b9&page=queryresults
[0m19:55:26.991444 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6a337547-e863-440e-9159-1fbc9e79fc8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67002513d0>]}
[0m19:55:26.993378 [info ] [Thread-1  ]: 4 of 6 OK created sql table model nyc_taxi.dim_vendor .......................... [[32mCREATE TABLE (2.0 rows, 463.5 KiB processed)[0m in 3.59s]
[0m19:55:26.995397 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_vendor
[0m19:55:26.996921 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_zone
[0m19:55:26.998299 [info ] [Thread-1  ]: 5 of 6 START sql table model nyc_taxi.dim_zone ................................. [RUN]
[0m19:55:26.999598 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_vendor, now model.nyc_taxi.dim_zone)
[0m19:55:27.000697 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_zone
[0m19:55:27.006127 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_zone"
[0m19:55:27.011522 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_zone
[0m19:55:27.015657 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:55:27.553237 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.dim_zone"
[0m19:55:27.559833 [debug] [Thread-1  ]: On model.nyc_taxi.dim_zone: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.dim_zone"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`dim_zone`
      
    
    

    OPTIONS()
    as (
      SELECT
    location_id,
    borough,
    zone,
    replace(service_zone, 'Boro', 'Green') as service_zone
FROM `northern-shield-437204-m0`.`nyc_taxi`.`zone_map`
    );
  
[0m19:55:28.135596 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:c9e0bc67-5b31-47b3-902a-6738b72e3524&page=queryresults
[0m19:55:30.839059 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6a337547-e863-440e-9159-1fbc9e79fc8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66fea0cee0>]}
[0m19:55:30.840725 [info ] [Thread-1  ]: 5 of 6 OK created sql table model nyc_taxi.dim_zone ............................ [[32mCREATE TABLE (265.0 rows, 12.1 KiB processed)[0m in 3.84s]
[0m19:55:30.842456 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_zone
[0m19:55:30.843817 [debug] [Thread-1  ]: Began running node model.nyc_taxi.fct_trips
[0m19:55:30.845043 [info ] [Thread-1  ]: 6 of 6 START sql table model nyc_taxi.fct_trips ................................ [RUN]
[0m19:55:30.846171 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_zone, now model.nyc_taxi.fct_trips)
[0m19:55:30.847201 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.fct_trips
[0m19:55:30.870395 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.fct_trips"
[0m19:55:30.875596 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.fct_trips
[0m19:55:30.881330 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.fct_trips"
[0m19:55:30.886688 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:55:30.890206 [debug] [Thread-1  ]: On model.nyc_taxi.fct_trips: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.fct_trips"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips`
      
    
    

    OPTIONS()
    as (
      WITH tripdata_cte AS (
    SELECT 
        to_hex(md5(cast(coalesce(cast(vendor_id as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(lpep_pickup_datetime as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(lpep_dropoff_datetime as string), '_dbt_utils_surrogate_key_null_') as string)))  AS trip_id,
        t.vendor_id,
        t.lpep_pickup_datetime,
        t.lpep_dropoff_datetime,
        td_pickup.time_id AS pickup_time_id,
        td_dropoff.time_id AS dropoff_time_id,
        t.rate_code_id,
        t.pu_location_id,
        t.do_location_id,
        t.passenger_count,
        t.trip_distance,
        t.fare_amount,
        t.extra,
        t.mta_tax,
        t.tip_amount,
        t.tolls_amount,
        t.improvement_surcharge,
        t.total_amount,
        t.payment_type,
        t.trip_type,
        t.congestion_surcharge
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata` AS t
    LEFT JOIN `northern-shield-437204-m0`.`nyc_taxi`.`dim_time` AS td_pickup
        ON TIMESTAMP_TRUNC(t.lpep_pickup_datetime, HOUR) = td_pickup.time
    LEFT JOIN `northern-shield-437204-m0`.`nyc_taxi`.`dim_time` AS td_dropoff
        ON TIMESTAMP_TRUNC(t.lpep_dropoff_datetime, HOUR) = td_dropoff.time
    WHERE vendor_id IS NOT NULL
        AND DATE(t.lpep_pickup_datetime) >= '2023-01-01'
        AND DATE(t.lpep_pickup_datetime) <= '2023-01-07'
)
SELECT 
    trip_id,
    vendor_id,
    pickup_time_id,
    dropoff_time_id,
    rate_code_id,
    pu_location_id,
    do_location_id,
    passenger_count,
    trip_distance,
    fare_amount,
    extra,
    mta_tax,
    tip_amount,
    tolls_amount,
    improvement_surcharge,
    total_amount,
    payment_type,
    trip_type,
    congestion_surcharge
FROM tripdata_cte
    );
  
[0m19:55:31.952547 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:8ad4c6e1-b222-4e16-b230-4ad610db6461&page=queryresults
[0m20:00:34.417503 [debug] [Thread-1  ]: BigQuery adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.fct_trips"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips`
      
    
    

    OPTIONS()
    as (
      WITH tripdata_cte AS (
    SELECT 
        to_hex(md5(cast(coalesce(cast(vendor_id as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(lpep_pickup_datetime as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(lpep_dropoff_datetime as string), '_dbt_utils_surrogate_key_null_') as string)))  AS trip_id,
        t.vendor_id,
        t.lpep_pickup_datetime,
        t.lpep_dropoff_datetime,
        td_pickup.time_id AS pickup_time_id,
        td_dropoff.time_id AS dropoff_time_id,
        t.rate_code_id,
        t.pu_location_id,
        t.do_location_id,
        t.passenger_count,
        t.trip_distance,
        t.fare_amount,
        t.extra,
        t.mta_tax,
        t.tip_amount,
        t.tolls_amount,
        t.improvement_surcharge,
        t.total_amount,
        t.payment_type,
        t.trip_type,
        t.congestion_surcharge
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata` AS t
    LEFT JOIN `northern-shield-437204-m0`.`nyc_taxi`.`dim_time` AS td_pickup
        ON TIMESTAMP_TRUNC(t.lpep_pickup_datetime, HOUR) = td_pickup.time
    LEFT JOIN `northern-shield-437204-m0`.`nyc_taxi`.`dim_time` AS td_dropoff
        ON TIMESTAMP_TRUNC(t.lpep_dropoff_datetime, HOUR) = td_dropoff.time
    WHERE vendor_id IS NOT NULL
        AND DATE(t.lpep_pickup_datetime) >= '2023-01-01'
        AND DATE(t.lpep_pickup_datetime) <= '2023-01-07'
)
SELECT 
    trip_id,
    vendor_id,
    pickup_time_id,
    dropoff_time_id,
    rate_code_id,
    pu_location_id,
    do_location_id,
    passenger_count,
    trip_distance,
    fare_amount,
    extra,
    mta_tax,
    tip_amount,
    tolls_amount,
    improvement_surcharge,
    total_amount,
    payment_type,
    trip_type,
    congestion_surcharge
FROM tripdata_cte
    );
  
[0m20:00:34.419309 [debug] [Thread-1  ]: BigQuery adapter: Operation did not complete within the designated timeout of 300 seconds.
[0m20:00:34.423819 [debug] [Thread-1  ]: Runtime Error in model fct_trips (models/transform/fct_trips.sql)
  Operation did not complete within the designated timeout of 300 seconds.
[0m20:00:34.425532 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6a337547-e863-440e-9159-1fbc9e79fc8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67076ffc40>]}
[0m20:00:34.427567 [error] [Thread-1  ]: 6 of 6 ERROR creating sql table model nyc_taxi.fct_trips ....................... [[31mERROR[0m in 303.58s]
[0m20:00:34.429414 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.fct_trips
[0m20:00:34.432722 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:00:34.433656 [debug] [MainThread]: Connection 'model.nyc_taxi.fct_trips' was properly closed.
[0m20:00:34.434742 [info ] [MainThread]: 
[0m20:00:34.436022 [info ] [MainThread]: Finished running 6 table models in 0 hours 5 minutes and 24.54 seconds (324.54s).
[0m20:00:34.439781 [debug] [MainThread]: Command end result
[0m20:00:34.512162 [info ] [MainThread]: 
[0m20:00:34.513733 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m20:00:34.514798 [info ] [MainThread]: 
[0m20:00:34.515996 [error] [MainThread]:   Runtime Error in model fct_trips (models/transform/fct_trips.sql)
  Operation did not complete within the designated timeout of 300 seconds.
[0m20:00:34.517043 [info ] [MainThread]: 
[0m20:00:34.518139 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m20:00:34.520511 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 335.0918, "process_in_blocks": "0", "process_kernel_time": 0.276955, "process_mem_max_rss": "230428", "process_out_blocks": "0", "process_user_time": 5.806522}
[0m20:00:34.522011 [debug] [MainThread]: Command `dbt run` failed at 20:00:34.521806 after 335.09 seconds
[0m20:00:34.523202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6709224c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f670881e3a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67002b0a60>]}
[0m20:00:34.524285 [debug] [MainThread]: Flushing usage events
[0m20:15:04.341122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe87bcdcc70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe879adee50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe879adedf0>]}


============================== 20:15:04.358117 | 99f7b0c0-0ec9-484b-8543-b362a846f1b9 ==============================
[0m20:15:04.358117 [info ] [MainThread]: Running with dbt=1.8.9
[0m20:15:04.361987 [debug] [MainThread]: running dbt with arguments {'use_experimental_parser': 'False', 'introspect': 'True', 'target_path': 'None', 'empty': 'False', 'debug': 'False', 'log_path': '/opt/airflow/include/dbt/logs', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/include/dbt/', 'use_colors': 'True', 'warn_error': 'None', 'partial_parse': 'True', 'printer_width': '80', 'log_cache_events': 'False', 'version_check': 'True', 'send_anonymous_usage_stats': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/include/dbt/', 'indirect_selection': 'eager', 'log_format': 'default', 'cache_selected_only': 'False', 'static_parser': 'True', 'write_json': 'True', 'quiet': 'False', 'no_print': 'None'}
[0m20:15:06.732723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '99f7b0c0-0ec9-484b-8543-b362a846f1b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe84346e580>]}
[0m20:15:06.923118 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '99f7b0c0-0ec9-484b-8543-b362a846f1b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe879b15220>]}
[0m20:15:06.926760 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m20:15:07.374211 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m20:15:10.257913 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:15:10.261738 [debug] [MainThread]: Partial parsing: updated file: nyc_taxi://models/transform/fct_trips.sql
[0m20:15:11.322137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '99f7b0c0-0ec9-484b-8543-b362a846f1b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe874d12df0>]}
[0m20:15:11.807801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '99f7b0c0-0ec9-484b-8543-b362a846f1b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe874d30d30>]}
[0m20:15:11.811524 [info ] [MainThread]: Found 6 models, 2 sources, 600 macros
[0m20:15:11.814858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '99f7b0c0-0ec9-484b-8543-b362a846f1b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe874d7aa90>]}
[0m20:15:11.822430 [info ] [MainThread]: 
[0m20:15:11.826034 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m20:15:11.841785 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_northern-shield-437204-m0'
[0m20:15:11.844390 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:15:12.856419 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_northern-shield-437204-m0, now list_northern-shield-437204-m0_nyc_taxi)
[0m20:15:12.859818 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:15:14.189978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '99f7b0c0-0ec9-484b-8543-b362a846f1b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe84259d820>]}
[0m20:15:14.194190 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:15:14.196729 [info ] [MainThread]: 
[0m20:15:14.216172 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_payment
[0m20:15:14.219977 [info ] [Thread-1  ]: 1 of 6 START sql table model nyc_taxi.dim_payment .............................. [RUN]
[0m20:15:14.223393 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_northern-shield-437204-m0_nyc_taxi, now model.nyc_taxi.dim_payment)
[0m20:15:14.227008 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_payment
[0m20:15:14.257077 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_payment"
[0m20:15:14.277978 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_payment
[0m20:15:14.336845 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:15:15.286628 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.dim_payment"
[0m20:15:15.309043 [debug] [Thread-1  ]: On model.nyc_taxi.dim_payment: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.dim_payment"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`dim_payment`
      
    
    

    OPTIONS()
    as (
      WITH payment_cte AS(
    SELECT DISTINCT
        payment_type AS type_id,
        CASE 
            WHEN payment_type = 1 THEN "Credit card"
            WHEN payment_type = 2 THEN "Cash"
            WHEN payment_type = 3 THEN "No charge"
            WHEN payment_type = 4 THEN "Dispute"
            WHEN payment_type = 5 THEN "Unknown"
            WHEN payment_type = 6 THEN "Voided trip"
        END AS payment_name
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata`
)
SELECT
    type_id,
    payment_name
FROM payment_cte
    );
  
[0m20:15:16.035363 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:00733f8e-f488-4686-9c78-6a050ba8ae36&page=queryresults
[0m20:15:18.626438 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '99f7b0c0-0ec9-484b-8543-b362a846f1b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe843479670>]}
[0m20:15:18.632381 [info ] [Thread-1  ]: 1 of 6 OK created sql table model nyc_taxi.dim_payment ......................... [[32mCREATE TABLE (4.0 rows, 463.5 KiB processed)[0m in 4.40s]
[0m20:15:18.638343 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_payment
[0m20:15:18.664487 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_ratecode
[0m20:15:18.668319 [info ] [Thread-1  ]: 2 of 6 START sql table model nyc_taxi.dim_ratecode ............................. [RUN]
[0m20:15:18.679512 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_payment, now model.nyc_taxi.dim_ratecode)
[0m20:15:18.683640 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_ratecode
[0m20:15:18.702745 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_ratecode"
[0m20:15:18.729260 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_ratecode
[0m20:15:18.739598 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:15:19.373089 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.dim_ratecode"
[0m20:15:19.392597 [debug] [Thread-1  ]: On model.nyc_taxi.dim_ratecode: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.dim_ratecode"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`dim_ratecode`
      
    
    

    OPTIONS()
    as (
      WITH rate_code_cte AS(
    SELECT DISTINCT
        rate_code_id AS rate_id,
        CASE 
            WHEN rate_code_id = 1 THEN "Standard rate"
            WHEN rate_code_id = 2 THEN "JFK"
            WHEN rate_code_id = 3 THEN "Newark"
            WHEN rate_code_id = 4 THEN "Nassau or Westchester"
            WHEN rate_code_id = 5 THEN "Negotiated fare"
            WHEN rate_code_id = 6 THEN "Group ride"
        ELSE "Unknown"
        END AS rate_code_name
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata`
)
SELECT
    rate_id,
    rate_code_name
FROM rate_code_cte
    );
  
[0m20:15:19.955229 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:44849ee2-6553-410f-9059-827983a74d23&page=queryresults
[0m20:15:22.927881 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '99f7b0c0-0ec9-484b-8543-b362a846f1b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe874c73f10>]}
[0m20:15:22.932194 [info ] [Thread-1  ]: 2 of 6 OK created sql table model nyc_taxi.dim_ratecode ........................ [[32mCREATE TABLE (6.0 rows, 463.5 KiB processed)[0m in 4.25s]
[0m20:15:22.936460 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_ratecode
[0m20:15:22.941005 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_time
[0m20:15:22.944496 [info ] [Thread-1  ]: 3 of 6 START sql table model nyc_taxi.dim_time ................................. [RUN]
[0m20:15:22.947811 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_ratecode, now model.nyc_taxi.dim_time)
[0m20:15:22.950951 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_time
[0m20:15:22.965179 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_time"
[0m20:15:22.989071 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_time
[0m20:15:23.006065 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:15:23.763922 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.dim_time"
[0m20:15:23.789629 [debug] [Thread-1  ]: On model.nyc_taxi.dim_time: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.dim_time"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`dim_time`
      
    
    

    OPTIONS()
    as (
      WITH datetime_cte AS (
    SELECT DISTINCT
        lpep_pickup_datetime AS datetime_value
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata`
    UNION ALL
    SELECT DISTINCT
        lpep_dropoff_datetime AS datetime_value
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata`
)
SELECT DISTINCT
    ROW_NUMBER() OVER (ORDER BY datetime_value) AS time_id,
    DATE(datetime_value) AS date,
    datetime_value AS date_part,
    EXTRACT(YEAR FROM datetime_value) AS year,
    EXTRACT(MONTH FROM datetime_value) AS month,
    EXTRACT(DAY FROM datetime_value) AS day,
    EXTRACT(HOUR FROM datetime_value) AS hour,
    EXTRACT(MINUTE FROM datetime_value) AS minute,
    FORMAT_TIMESTAMP('%A', datetime_value) AS weekday,
    TIMESTAMP_TRUNC(datetime_value, HOUR) AS time
FROM datetime_cte
    );
  
[0m20:15:24.486299 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:401adc85-3630-47f5-8a4c-5c58ddcd9382&page=queryresults
[0m20:15:28.514446 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '99f7b0c0-0ec9-484b-8543-b362a846f1b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe874c73f10>]}
[0m20:15:28.519726 [info ] [Thread-1  ]: 3 of 6 OK created sql table model nyc_taxi.dim_time ............................ [[32mCREATE TABLE (116.8k rows, 927.0 KiB processed)[0m in 5.57s]
[0m20:15:28.524098 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_time
[0m20:15:28.527513 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_vendor
[0m20:15:28.531356 [info ] [Thread-1  ]: 4 of 6 START sql table model nyc_taxi.dim_vendor ............................... [RUN]
[0m20:15:28.535492 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_time, now model.nyc_taxi.dim_vendor)
[0m20:15:28.539089 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_vendor
[0m20:15:28.552073 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_vendor"
[0m20:15:28.575850 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_vendor
[0m20:15:28.587567 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:15:29.338131 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.dim_vendor"
[0m20:15:29.361777 [debug] [Thread-1  ]: On model.nyc_taxi.dim_vendor: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.dim_vendor"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`dim_vendor`
      
    
    

    OPTIONS()
    as (
      WITH vendor_cte AS(
    SELECT DISTINCT
        vendor_id AS id,
        CASE 
            WHEN vendor_id = 1 THEN "Creative Mobile Technologies"
            WHEN vendor_id = 2 THEN "VeriFone Inc."
        END AS vendor_name
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata`
)
SELECT
    id,
    vendor_name
FROM vendor_cte
    );
  
[0m20:15:30.058117 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:3029f4ec-40e6-49a0-8331-8db4d4c877eb&page=queryresults
[0m20:15:32.930790 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '99f7b0c0-0ec9-484b-8543-b362a846f1b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe874c73f10>]}
[0m20:15:32.935347 [info ] [Thread-1  ]: 4 of 6 OK created sql table model nyc_taxi.dim_vendor .......................... [[32mCREATE TABLE (2.0 rows, 463.5 KiB processed)[0m in 4.40s]
[0m20:15:32.941079 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_vendor
[0m20:15:32.946151 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_zone
[0m20:15:32.950034 [info ] [Thread-1  ]: 5 of 6 START sql table model nyc_taxi.dim_zone ................................. [RUN]
[0m20:15:32.953744 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_vendor, now model.nyc_taxi.dim_zone)
[0m20:15:32.956814 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_zone
[0m20:15:32.968184 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_zone"
[0m20:15:32.992267 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_zone
[0m20:15:33.004905 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:15:33.668429 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.dim_zone"
[0m20:15:33.690181 [debug] [Thread-1  ]: On model.nyc_taxi.dim_zone: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.dim_zone"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`dim_zone`
      
    
    

    OPTIONS()
    as (
      SELECT
    location_id,
    borough,
    zone,
    replace(service_zone, 'Boro', 'Green') as service_zone
FROM `northern-shield-437204-m0`.`nyc_taxi`.`zone_map`
    );
  
[0m20:15:34.255066 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:ea71885b-dead-4942-a694-65f5ea542607&page=queryresults
[0m20:15:35.974159 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '99f7b0c0-0ec9-484b-8543-b362a846f1b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe874c73f10>]}
[0m20:15:35.979375 [info ] [Thread-1  ]: 5 of 6 OK created sql table model nyc_taxi.dim_zone ............................ [[32mCREATE TABLE (265.0 rows, 12.1 KiB processed)[0m in 3.02s]
[0m20:15:35.984260 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_zone
[0m20:15:35.989568 [debug] [Thread-1  ]: Began running node model.nyc_taxi.fct_trips
[0m20:15:35.993806 [info ] [Thread-1  ]: 6 of 6 START sql table model nyc_taxi.fct_trips ................................ [RUN]
[0m20:15:35.999468 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_zone, now model.nyc_taxi.fct_trips)
[0m20:15:36.004676 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.fct_trips
[0m20:15:36.043583 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.fct_trips"
[0m20:15:36.066309 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.fct_trips
[0m20:15:36.083267 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.fct_trips"
[0m20:15:36.100732 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:15:36.110869 [debug] [Thread-1  ]: On model.nyc_taxi.fct_trips: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.fct_trips"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips`
      
    
    

    OPTIONS()
    as (
      WITH tripdata_cte AS (
    SELECT 
        to_hex(md5(cast(coalesce(cast(vendor_id as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(lpep_pickup_datetime as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(lpep_dropoff_datetime as string), '_dbt_utils_surrogate_key_null_') as string)))  AS trip_id,
        t.vendor_id,
        t.lpep_pickup_datetime,
        t.lpep_dropoff_datetime,
        td_pickup.time_id AS pickup_time_id,
        td_dropoff.time_id AS dropoff_time_id,
        t.rate_code_id,
        t.pu_location_id,
        t.do_location_id,
        t.passenger_count,
        t.trip_distance,
        t.fare_amount,
        t.extra,
        t.mta_tax,
        t.tip_amount,
        t.tolls_amount,
        t.improvement_surcharge,
        t.total_amount,
        t.payment_type,
        t.trip_type,
        t.congestion_surcharge
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata` AS t
    LEFT JOIN `northern-shield-437204-m0`.`nyc_taxi`.`dim_time` AS td_pickup
        ON TIMESTAMP_TRUNC(t.lpep_pickup_datetime, HOUR) = td_pickup.time
    LEFT JOIN `northern-shield-437204-m0`.`nyc_taxi`.`dim_time` AS td_dropoff
        ON TIMESTAMP_TRUNC(t.lpep_dropoff_datetime, HOUR) = td_dropoff.time
    WHERE vendor_id IS NOT NULL
        AND DATE(t.lpep_pickup_datetime) >= '2023-01-01'
        AND DATE(t.lpep_pickup_datetime) <= '2023-01-02'
)
SELECT 
    trip_id,
    vendor_id,
    pickup_time_id,
    dropoff_time_id,
    rate_code_id,
    pu_location_id,
    do_location_id,
    passenger_count,
    trip_distance,
    fare_amount,
    extra,
    mta_tax,
    tip_amount,
    tolls_amount,
    improvement_surcharge,
    total_amount,
    payment_type,
    trip_type,
    congestion_surcharge
FROM tripdata_cte
    );
  
[0m20:15:36.994415 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:719e461a-d68b-4b2f-9d31-965708d45ce9&page=queryresults
[0m20:17:27.031723 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '99f7b0c0-0ec9-484b-8543-b362a846f1b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe874b44070>]}
[0m20:17:27.037525 [info ] [Thread-1  ]: 6 of 6 OK created sql table model nyc_taxi.fct_trips ........................... [[32mCREATE TABLE (59.8m rows, 9.9 MiB processed)[0m in 111.03s]
[0m20:17:27.044887 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.fct_trips
[0m20:17:27.051842 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:17:27.054520 [debug] [MainThread]: Connection 'model.nyc_taxi.fct_trips' was properly closed.
[0m20:17:27.058091 [info ] [MainThread]: 
[0m20:17:27.062053 [info ] [MainThread]: Finished running 6 table models in 0 hours 2 minutes and 15.23 seconds (135.23s).
[0m20:17:27.095972 [debug] [MainThread]: Command end result
[0m20:17:27.307535 [info ] [MainThread]: 
[0m20:17:27.311111 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:17:27.314298 [info ] [MainThread]: 
[0m20:17:27.317500 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m20:17:27.324637 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 147.18752, "process_in_blocks": "816", "process_kernel_time": 0.879798, "process_mem_max_rss": "229924", "process_out_blocks": "0", "process_user_time": 12.741905}
[0m20:17:27.329276 [debug] [MainThread]: Command `dbt run` succeeded at 20:17:27.328641 after 147.19 seconds
[0m20:17:27.333255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe87bcdcc70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe874f911c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe874f912e0>]}
[0m20:17:27.336682 [debug] [MainThread]: Flushing usage events
[0m21:05:10.992410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa193c03c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa191a05e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa191a05df0>]}


============================== 21:05:11.011486 | ebb3ea58-d5c7-4796-b551-627c5b39b9fa ==============================
[0m21:05:11.011486 [info ] [MainThread]: Running with dbt=1.8.9
[0m21:05:11.015350 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/include/dbt/', 'log_cache_events': 'False', 'empty': 'False', 'quiet': 'False', 'use_colors': 'True', 'partial_parse': 'True', 'warn_error': 'None', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'log_path': '/opt/airflow/include/dbt/logs', 'static_parser': 'True', 'printer_width': '80', 'send_anonymous_usage_stats': 'True', 'debug': 'False', 'version_check': 'True', 'target_path': 'None', 'profiles_dir': '/opt/airflow/include/dbt/', 'log_format': 'default', 'fail_fast': 'False', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'introspect': 'True', 'write_json': 'True'}
[0m21:05:14.263520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ebb3ea58-d5c7-4796-b551-627c5b39b9fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1933b6d60>]}
[0m21:05:14.453216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ebb3ea58-d5c7-4796-b551-627c5b39b9fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa15a533ac0>]}
[0m21:05:14.457489 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m21:05:14.973598 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m21:05:17.960862 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:05:17.964678 [debug] [MainThread]: Partial parsing: updated file: nyc_taxi://models/transform/fct_trips.sql
[0m21:05:18.991624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ebb3ea58-d5c7-4796-b551-627c5b39b9fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa18cd16130>]}
[0m21:05:19.404045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ebb3ea58-d5c7-4796-b551-627c5b39b9fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa18cd29220>]}
[0m21:05:19.408148 [info ] [MainThread]: Found 6 models, 2 sources, 600 macros
[0m21:05:19.413448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ebb3ea58-d5c7-4796-b551-627c5b39b9fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa18cd06dc0>]}
[0m21:05:19.420370 [info ] [MainThread]: 
[0m21:05:19.426769 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m21:05:19.446656 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_northern-shield-437204-m0'
[0m21:05:19.449563 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:05:20.133223 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_northern-shield-437204-m0, now list_northern-shield-437204-m0_nyc_taxi)
[0m21:05:20.136874 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:05:20.786432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ebb3ea58-d5c7-4796-b551-627c5b39b9fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa193ecad00>]}
[0m21:05:20.789978 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:05:20.793950 [info ] [MainThread]: 
[0m21:05:20.818503 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_payment
[0m21:05:20.822285 [info ] [Thread-1  ]: 1 of 6 START sql table model nyc_taxi.dim_payment .............................. [RUN]
[0m21:05:20.826402 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_northern-shield-437204-m0_nyc_taxi, now model.nyc_taxi.dim_payment)
[0m21:05:20.829575 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_payment
[0m21:05:20.861754 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_payment"
[0m21:05:20.882171 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_payment
[0m21:05:20.956484 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:05:21.680001 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.dim_payment"
[0m21:05:21.702667 [debug] [Thread-1  ]: On model.nyc_taxi.dim_payment: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.dim_payment"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`dim_payment`
      
    
    

    OPTIONS()
    as (
      WITH payment_cte AS(
    SELECT DISTINCT
        payment_type AS type_id,
        CASE 
            WHEN payment_type = 1 THEN "Credit card"
            WHEN payment_type = 2 THEN "Cash"
            WHEN payment_type = 3 THEN "No charge"
            WHEN payment_type = 4 THEN "Dispute"
            WHEN payment_type = 5 THEN "Unknown"
            WHEN payment_type = 6 THEN "Voided trip"
        END AS payment_name
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata`
)
SELECT
    type_id,
    payment_name
FROM payment_cte
    );
  
[0m21:05:22.478871 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:d66fb50b-fc00-4566-8393-2a824e6ffa5c&page=queryresults
[0m21:05:25.773957 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ebb3ea58-d5c7-4796-b551-627c5b39b9fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa15b354790>]}
[0m21:05:25.780346 [info ] [Thread-1  ]: 1 of 6 OK created sql table model nyc_taxi.dim_payment ......................... [[32mCREATE TABLE (4.0 rows, 463.5 KiB processed)[0m in 4.94s]
[0m21:05:25.788295 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_payment
[0m21:05:25.794189 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_ratecode
[0m21:05:25.798801 [info ] [Thread-1  ]: 2 of 6 START sql table model nyc_taxi.dim_ratecode ............................. [RUN]
[0m21:05:25.805942 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_payment, now model.nyc_taxi.dim_ratecode)
[0m21:05:25.809268 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_ratecode
[0m21:05:25.825594 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_ratecode"
[0m21:05:25.847687 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_ratecode
[0m21:05:25.858661 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:05:26.526427 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.dim_ratecode"
[0m21:05:26.548590 [debug] [Thread-1  ]: On model.nyc_taxi.dim_ratecode: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.dim_ratecode"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`dim_ratecode`
      
    
    

    OPTIONS()
    as (
      WITH rate_code_cte AS(
    SELECT DISTINCT
        rate_code_id AS rate_id,
        CASE 
            WHEN rate_code_id = 1 THEN "Standard rate"
            WHEN rate_code_id = 2 THEN "JFK"
            WHEN rate_code_id = 3 THEN "Newark"
            WHEN rate_code_id = 4 THEN "Nassau or Westchester"
            WHEN rate_code_id = 5 THEN "Negotiated fare"
            WHEN rate_code_id = 6 THEN "Group ride"
        ELSE "Unknown"
        END AS rate_code_name
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata`
)
SELECT
    rate_id,
    rate_code_name
FROM rate_code_cte
    );
  
[0m21:05:26.702076 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:e5cf190d-9f1a-41e0-96c8-6aee61ed0a8a&page=queryresults
[0m21:05:29.227752 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ebb3ea58-d5c7-4796-b551-627c5b39b9fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa15b306430>]}
[0m21:05:29.232670 [info ] [Thread-1  ]: 2 of 6 OK created sql table model nyc_taxi.dim_ratecode ........................ [[32mCREATE TABLE (6.0 rows, 463.5 KiB processed)[0m in 3.42s]
[0m21:05:29.257504 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_ratecode
[0m21:05:29.262354 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_time
[0m21:05:29.266500 [info ] [Thread-1  ]: 3 of 6 START sql table model nyc_taxi.dim_time ................................. [RUN]
[0m21:05:29.270373 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_ratecode, now model.nyc_taxi.dim_time)
[0m21:05:29.273277 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_time
[0m21:05:29.287861 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_time"
[0m21:05:29.310125 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_time
[0m21:05:29.327573 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:05:30.046991 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.dim_time"
[0m21:05:30.067812 [debug] [Thread-1  ]: On model.nyc_taxi.dim_time: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.dim_time"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`dim_time`
      
    
    

    OPTIONS()
    as (
      WITH datetime_cte AS (
    SELECT DISTINCT
        lpep_pickup_datetime AS datetime_value
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata`
    UNION ALL
    SELECT DISTINCT
        lpep_dropoff_datetime AS datetime_value
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata`
)
SELECT DISTINCT
    ROW_NUMBER() OVER (ORDER BY datetime_value) AS time_id,
    DATE(datetime_value) AS date,
    datetime_value AS date_part,
    EXTRACT(YEAR FROM datetime_value) AS year,
    EXTRACT(MONTH FROM datetime_value) AS month,
    EXTRACT(DAY FROM datetime_value) AS day,
    EXTRACT(HOUR FROM datetime_value) AS hour,
    EXTRACT(MINUTE FROM datetime_value) AS minute,
    FORMAT_TIMESTAMP('%A', datetime_value) AS weekday,
    TIMESTAMP_TRUNC(datetime_value, HOUR) AS time
FROM datetime_cte
    );
  
[0m21:05:30.662746 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:df9ed8fa-1ebc-42b4-93da-0df385ac3122&page=queryresults
[0m21:05:35.390105 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ebb3ea58-d5c7-4796-b551-627c5b39b9fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa15b306430>]}
[0m21:05:35.395126 [info ] [Thread-1  ]: 3 of 6 OK created sql table model nyc_taxi.dim_time ............................ [[32mCREATE TABLE (116.8k rows, 927.0 KiB processed)[0m in 6.12s]
[0m21:05:35.402703 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_time
[0m21:05:35.406983 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_vendor
[0m21:05:35.410893 [info ] [Thread-1  ]: 4 of 6 START sql table model nyc_taxi.dim_vendor ............................... [RUN]
[0m21:05:35.417773 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_time, now model.nyc_taxi.dim_vendor)
[0m21:05:35.422354 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_vendor
[0m21:05:35.440877 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_vendor"
[0m21:05:35.461730 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_vendor
[0m21:05:35.474823 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:05:36.207694 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.dim_vendor"
[0m21:05:36.229773 [debug] [Thread-1  ]: On model.nyc_taxi.dim_vendor: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.dim_vendor"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`dim_vendor`
      
    
    

    OPTIONS()
    as (
      WITH vendor_cte AS(
    SELECT DISTINCT
        vendor_id AS id,
        CASE 
            WHEN vendor_id = 1 THEN "Creative Mobile Technologies"
            WHEN vendor_id = 2 THEN "VeriFone Inc."
        END AS vendor_name
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata`
)
SELECT
    id,
    vendor_name
FROM vendor_cte
    );
  
[0m21:05:36.921276 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:3a886321-1907-4e82-b195-ccf035446371&page=queryresults
[0m21:05:40.149066 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ebb3ea58-d5c7-4796-b551-627c5b39b9fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa193206dc0>]}
[0m21:05:40.153580 [info ] [Thread-1  ]: 4 of 6 OK created sql table model nyc_taxi.dim_vendor .......................... [[32mCREATE TABLE (2.0 rows, 463.5 KiB processed)[0m in 4.73s]
[0m21:05:40.158660 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_vendor
[0m21:05:40.162141 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_zone
[0m21:05:40.165655 [info ] [Thread-1  ]: 5 of 6 START sql table model nyc_taxi.dim_zone ................................. [RUN]
[0m21:05:40.169416 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_vendor, now model.nyc_taxi.dim_zone)
[0m21:05:40.172770 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_zone
[0m21:05:40.186761 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_zone"
[0m21:05:40.211692 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_zone
[0m21:05:40.223981 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:05:41.022435 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.dim_zone"
[0m21:05:41.049669 [debug] [Thread-1  ]: On model.nyc_taxi.dim_zone: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.dim_zone"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`dim_zone`
      
    
    

    OPTIONS()
    as (
      SELECT
    location_id,
    borough,
    zone,
    replace(service_zone, 'Boro', 'Green') as service_zone
FROM `northern-shield-437204-m0`.`nyc_taxi`.`zone_map`
    );
  
[0m21:05:41.668183 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:64fda2d6-21c2-40e4-bff9-9a4baa870c92&page=queryresults
[0m21:05:44.297316 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ebb3ea58-d5c7-4796-b551-627c5b39b9fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa18cb48f40>]}
[0m21:05:44.301861 [info ] [Thread-1  ]: 5 of 6 OK created sql table model nyc_taxi.dim_zone ............................ [[32mCREATE TABLE (265.0 rows, 12.1 KiB processed)[0m in 4.13s]
[0m21:05:44.306619 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_zone
[0m21:05:44.310838 [debug] [Thread-1  ]: Began running node model.nyc_taxi.fct_trips
[0m21:05:44.314489 [info ] [Thread-1  ]: 6 of 6 START sql table model nyc_taxi.fct_trips ................................ [RUN]
[0m21:05:44.318202 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_zone, now model.nyc_taxi.fct_trips)
[0m21:05:44.322259 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.fct_trips
[0m21:05:44.347327 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.fct_trips"
[0m21:05:44.372395 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.fct_trips
[0m21:05:44.384314 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:05:45.119604 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.fct_trips"
[0m21:05:45.140266 [debug] [Thread-1  ]: On model.nyc_taxi.fct_trips: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.fct_trips"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips`
      
    
    

    OPTIONS()
    as (
      WITH tripdata_cte AS (
    SELECT 
        to_hex(md5(cast(coalesce(cast(vendor_id as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(lpep_pickup_datetime as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(lpep_dropoff_datetime as string), '_dbt_utils_surrogate_key_null_') as string)))  AS trip_id,
        t.vendor_id,
        t.lpep_pickup_datetime,
        t.lpep_dropoff_datetime,
        td_pickup.time_id AS pickup_time_id,
        td_dropoff.time_id AS dropoff_time_id,
        t.rate_code_id,
        t.pu_location_id,
        t.do_location_id,
        t.passenger_count,
        t.trip_distance,
        t.fare_amount,
        t.extra,
        t.mta_tax,
        t.tip_amount,
        t.tolls_amount,
        t.improvement_surcharge,
        t.total_amount,
        t.payment_type,
        t.trip_type,
        t.congestion_surcharge
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata` AS t
    LEFT JOIN `northern-shield-437204-m0`.`nyc_taxi`.`dim_time` AS td_pickup
        ON TIMESTAMP_TRUNC(t.lpep_pickup_datetime, HOUR) = td_pickup.time
    LEFT JOIN `northern-shield-437204-m0`.`nyc_taxi`.`dim_time` AS td_dropoff
        ON TIMESTAMP_TRUNC(t.lpep_dropoff_datetime, HOUR) = td_dropoff.time
    WHERE vendor_id IS NOT NULL

    -- Incremental Filter
    
      AND DATE(lpep_pickup_datetime) >= '2023-01-01'
      AND DATE(lpep_pickup_datetime) <= '2023-01-02'
    
)
SELECT 
    trip_id,
    vendor_id,
    pickup_time_id,
    dropoff_time_id,
    rate_code_id,
    pu_location_id,
    do_location_id,
    passenger_count,
    trip_distance,
    fare_amount,
    extra,
    mta_tax,
    tip_amount,
    tolls_amount,
    improvement_surcharge,
    total_amount,
    payment_type,
    trip_type,
    congestion_surcharge
FROM tripdata_cte
    );
  
[0m21:05:45.842230 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:c0cd41d2-ac31-4732-b552-daa16b5c742a&page=queryresults
[0m21:07:30.175269 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ebb3ea58-d5c7-4796-b551-627c5b39b9fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa18cb48430>]}
[0m21:07:30.179710 [info ] [Thread-1  ]: 6 of 6 OK created sql table model nyc_taxi.fct_trips ........................... [[32mCREATE TABLE (59.8m rows, 9.9 MiB processed)[0m in 105.86s]
[0m21:07:30.186708 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.fct_trips
[0m21:07:30.194097 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:07:30.197428 [debug] [MainThread]: Connection 'model.nyc_taxi.fct_trips' was properly closed.
[0m21:07:30.201066 [info ] [MainThread]: 
[0m21:07:30.204701 [info ] [MainThread]: Finished running 6 table models in 0 hours 2 minutes and 10.77 seconds (130.77s).
[0m21:07:30.221032 [debug] [MainThread]: Command end result
[0m21:07:30.425734 [info ] [MainThread]: 
[0m21:07:30.429286 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:07:30.432463 [info ] [MainThread]: 
[0m21:07:30.435612 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m21:07:30.441307 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 144.63017, "process_in_blocks": "0", "process_kernel_time": 1.119664, "process_mem_max_rss": "229624", "process_out_blocks": "0", "process_user_time": 12.499708}
[0m21:07:30.446244 [debug] [MainThread]: Command `dbt run` succeeded at 21:07:30.445328 after 144.64 seconds
[0m21:07:30.449269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa193c03c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa18cc763d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa15a46ba90>]}
[0m21:07:30.452714 [debug] [MainThread]: Flushing usage events
[0m13:22:41.254530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8f35efcd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8f1440f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8f1440eb0>]}


============================== 13:22:41.275749 | fb65c43b-7090-4811-b703-f8b86d3d06ef ==============================
[0m13:22:41.275749 [info ] [MainThread]: Running with dbt=1.8.9
[0m13:22:41.281005 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'no_print': 'None', 'printer_width': '80', 'debug': 'False', 'fail_fast': 'False', 'write_json': 'True', 'empty': 'False', 'static_parser': 'True', 'introspect': 'True', 'profiles_dir': '/opt/airflow/include/dbt', 'invocation_command': 'dbt run --select fct_trips --vars {"start_date": "2023-01-03", "end_date": "2023-01-03"}', 'log_cache_events': 'False', 'quiet': 'False', 'indirect_selection': 'eager', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True', 'log_path': '/opt/airflow/include/dbt/logs', 'log_format': 'default', 'use_experimental_parser': 'False', 'target_path': 'None', 'version_check': 'True', 'cache_selected_only': 'False', 'partial_parse': 'True', 'warn_error': 'None'}
[0m13:22:46.125229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fb65c43b-7090-4811-b703-f8b86d3d06ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8f1420310>]}
[0m13:22:46.311699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fb65c43b-7090-4811-b703-f8b86d3d06ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8bac73ca0>]}
[0m13:22:46.315996 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m13:22:46.906552 [debug] [MainThread]: checksum: c9ded4962a3530b23a7dcd70a9ca1bb85cc0d77930e7621bc21553b434c33aaf, vars: {'end_date': '2023-01-03', 'start_date': '2023-01-03'}, profile: , target: , version: 1.8.9
[0m13:22:47.302525 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m13:22:47.305909 [debug] [MainThread]: previous checksum: c9ded4962a3530b23a7dcd70a9ca1bb85cc0d77930e7621bc21553b434c33aaf, current checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1
[0m13:22:47.309142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'fb65c43b-7090-4811-b703-f8b86d3d06ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8f27bf670>]}
[0m13:22:55.289819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fb65c43b-7090-4811-b703-f8b86d3d06ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8e6d17130>]}
[0m13:22:55.819368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fb65c43b-7090-4811-b703-f8b86d3d06ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8e6c5d6a0>]}
[0m13:22:55.822159 [info ] [MainThread]: Found 6 models, 2 sources, 600 macros
[0m13:22:55.824695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fb65c43b-7090-4811-b703-f8b86d3d06ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8e6d26400>]}
[0m13:22:55.829819 [info ] [MainThread]: 
[0m13:22:55.833439 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:22:55.838924 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_northern-shield-437204-m0'
[0m13:22:55.841947 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:22:57.843003 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_northern-shield-437204-m0, now list_northern-shield-437204-m0_nyc_taxi)
[0m13:22:57.847072 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:22:58.640025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fb65c43b-7090-4811-b703-f8b86d3d06ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8e6d26400>]}
[0m13:22:58.643683 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:22:58.648231 [info ] [MainThread]: 
[0m13:22:58.672313 [debug] [Thread-1  ]: Began running node model.nyc_taxi.fct_trips
[0m13:22:58.676055 [info ] [Thread-1  ]: 1 of 1 START sql table model nyc_taxi.fct_trips ................................ [RUN]
[0m13:22:58.679715 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_northern-shield-437204-m0_nyc_taxi, now model.nyc_taxi.fct_trips)
[0m13:22:58.682555 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.fct_trips
[0m13:22:58.729845 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.fct_trips"
[0m13:22:58.758484 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.fct_trips
[0m13:22:58.807999 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:23:00.215499 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.fct_trips"
[0m13:23:00.251593 [debug] [Thread-1  ]: On model.nyc_taxi.fct_trips: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.fct_trips"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips`
      
    
    

    OPTIONS()
    as (
      WITH tripdata_cte AS (
    SELECT 
        to_hex(md5(cast(coalesce(cast(vendor_id as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(lpep_pickup_datetime as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(lpep_dropoff_datetime as string), '_dbt_utils_surrogate_key_null_') as string)))  AS trip_id,
        t.vendor_id,
        t.lpep_pickup_datetime,
        t.lpep_dropoff_datetime,
        td_pickup.time_id AS pickup_time_id,
        td_dropoff.time_id AS dropoff_time_id,
        t.rate_code_id,
        t.pu_location_id,
        t.do_location_id,
        t.passenger_count,
        t.trip_distance,
        t.fare_amount,
        t.extra,
        t.mta_tax,
        t.tip_amount,
        t.tolls_amount,
        t.improvement_surcharge,
        t.total_amount,
        t.payment_type,
        t.trip_type,
        t.congestion_surcharge
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata` AS t
    LEFT JOIN `northern-shield-437204-m0`.`nyc_taxi`.`dim_time` AS td_pickup
        ON TIMESTAMP_TRUNC(t.lpep_pickup_datetime, HOUR) = td_pickup.time
    LEFT JOIN `northern-shield-437204-m0`.`nyc_taxi`.`dim_time` AS td_dropoff
        ON TIMESTAMP_TRUNC(t.lpep_dropoff_datetime, HOUR) = td_dropoff.time
    WHERE vendor_id IS NOT NULL

    -- Incremental Filter
    
      AND DATE(lpep_pickup_datetime) >= '2023-01-03'
      AND DATE(lpep_pickup_datetime) <= '2023-01-03'
    
)
SELECT 
    trip_id,
    vendor_id,
    pickup_time_id,
    dropoff_time_id,
    rate_code_id,
    pu_location_id,
    do_location_id,
    passenger_count,
    trip_distance,
    fare_amount,
    extra,
    mta_tax,
    tip_amount,
    tolls_amount,
    improvement_surcharge,
    total_amount,
    payment_type,
    trip_type,
    congestion_surcharge
FROM tripdata_cte
    );
  
[0m13:23:00.986415 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:33dc1069-6169-4767-a308-8ad6283ea321&page=queryresults
[0m13:25:39.005161 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fb65c43b-7090-4811-b703-f8b86d3d06ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8f3880670>]}
[0m13:25:39.010750 [info ] [Thread-1  ]: 1 of 1 OK created sql table model nyc_taxi.fct_trips ........................... [[32mCREATE TABLE (93.0m rows, 9.9 MiB processed)[0m in 160.32s]
[0m13:25:39.015455 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.fct_trips
[0m13:25:39.022644 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:25:39.025853 [debug] [MainThread]: Connection 'model.nyc_taxi.fct_trips' was properly closed.
[0m13:25:39.028914 [info ] [MainThread]: 
[0m13:25:39.032300 [info ] [MainThread]: Finished running 1 table model in 0 hours 2 minutes and 43.20 seconds (163.20s).
[0m13:25:39.037284 [debug] [MainThread]: Command end result
[0m13:25:39.260899 [info ] [MainThread]: 
[0m13:25:39.265772 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:25:39.269229 [info ] [MainThread]: 
[0m13:25:39.272761 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:25:39.277903 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 184.83926, "process_in_blocks": "212968", "process_kernel_time": 1.871859, "process_mem_max_rss": "233140", "process_out_blocks": "0", "process_user_time": 16.369019}
[0m13:25:39.283354 [debug] [MainThread]: Command `dbt run` succeeded at 13:25:39.282112 after 184.84 seconds
[0m13:25:39.287600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8f35efcd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8bac73ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8f1b929a0>]}
[0m13:25:39.291028 [debug] [MainThread]: Flushing usage events
[0m16:04:00.519491 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c94823c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c92672e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c92672e20>]}


============================== 16:04:00.539558 | 9fe82ab3-ccf3-469c-9604-5e6a40b4f113 ==============================
[0m16:04:00.539558 [info ] [MainThread]: Running with dbt=1.8.9
[0m16:04:00.543335 [debug] [MainThread]: running dbt with arguments {'debug': 'False', 'invocation_command': 'dbt run --select fct_trips --vars {"start_date": "2023-01-01", "end_date": "2023-01-31"}', 'version_check': 'True', 'introspect': 'True', 'fail_fast': 'False', 'write_json': 'True', 'partial_parse': 'True', 'profiles_dir': '/opt/airflow/include/dbt', 'use_colors': 'True', 'target_path': 'None', 'warn_error': 'None', 'use_experimental_parser': 'False', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'log_path': '/opt/airflow/include/dbt/logs', 'static_parser': 'True', 'empty': 'False', 'printer_width': '80', 'log_format': 'default', 'indirect_selection': 'eager', 'log_cache_events': 'False'}
[0m16:04:04.623984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9fe82ab3-ccf3-469c-9604-5e6a40b4f113', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c5b235f10>]}
[0m16:04:04.813807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9fe82ab3-ccf3-469c-9604-5e6a40b4f113', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c92dd1070>]}
[0m16:04:04.818345 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m16:04:05.328985 [debug] [MainThread]: checksum: 2944ea4cf69a4d661e9a2d28705b06765f154182f2288118aaca2efd2a1ed3ec, vars: {'end_date': '2023-01-31', 'start_date': '2023-01-01'}, profile: , target: , version: 1.8.9
[0m16:04:05.721853 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m16:04:05.725397 [debug] [MainThread]: previous checksum: 2944ea4cf69a4d661e9a2d28705b06765f154182f2288118aaca2efd2a1ed3ec, current checksum: c9ded4962a3530b23a7dcd70a9ca1bb85cc0d77930e7621bc21553b434c33aaf
[0m16:04:05.729112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '9fe82ab3-ccf3-469c-9604-5e6a40b4f113', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c93326b80>]}
[0m16:04:14.510091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9fe82ab3-ccf3-469c-9604-5e6a40b4f113', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c87f5f130>]}
[0m16:04:14.937003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9fe82ab3-ccf3-469c-9604-5e6a40b4f113', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c87f7f220>]}
[0m16:04:14.940170 [info ] [MainThread]: Found 5 models, 2 sources, 600 macros
[0m16:04:14.945102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9fe82ab3-ccf3-469c-9604-5e6a40b4f113', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c87ff57f0>]}
[0m16:04:14.950262 [info ] [MainThread]: 
[0m16:04:14.954037 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:04:14.959822 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_northern-shield-437204-m0'
[0m16:04:14.963092 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:04:15.993187 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_northern-shield-437204-m0, now list_northern-shield-437204-m0_nyc_taxi)
[0m16:04:15.996986 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:04:16.818893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9fe82ab3-ccf3-469c-9604-5e6a40b4f113', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c87ff57f0>]}
[0m16:04:16.822896 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:04:16.826126 [info ] [MainThread]: 
[0m16:04:16.850533 [debug] [Thread-1  ]: Began running node model.nyc_taxi.fct_trips
[0m16:04:16.857278 [info ] [Thread-1  ]: 1 of 1 START sql table model nyc_taxi.fct_trips ................................ [RUN]
[0m16:04:16.862185 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_northern-shield-437204-m0_nyc_taxi, now model.nyc_taxi.fct_trips)
[0m16:04:16.865412 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.fct_trips
[0m16:04:16.915245 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.fct_trips"
[0m16:04:16.933462 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.fct_trips
[0m16:04:17.064182 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.fct_trips"
[0m16:04:17.088122 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:04:17.098821 [debug] [Thread-1  ]: On model.nyc_taxi.fct_trips: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.fct_trips"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips`
      
    
    

    OPTIONS()
    as (
      WITH tripdata_cte AS (
    SELECT 
        to_hex(md5(cast(coalesce(cast(vendor_id as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(lpep_pickup_datetime as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(lpep_dropoff_datetime as string), '_dbt_utils_surrogate_key_null_') as string)))  AS trip_id,
        t.vendor_id,
        t.lpep_pickup_datetime,
        t.lpep_dropoff_datetime,
        t.rate_code_id,
        t.pu_location_id,
        t.do_location_id,
        t.passenger_count,
        t.trip_distance,
        t.fare_amount,
        t.extra,
        t.mta_tax,
        t.tip_amount,
        t.tolls_amount,
        t.improvement_surcharge,
        t.total_amount,
        t.payment_type,
        t.trip_type,
        t.congestion_surcharge
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata` AS t
    WHERE vendor_id IS NOT NULL

    -- Incremental Filter
    
      AND DATE(lpep_pickup_datetime) >= '2023-01-01'
      AND DATE(lpep_pickup_datetime) <= '2023-01-31'
    
)
SELECT 
    trip_id,
    vendor_id,
    pickup_time,
    dropoff_time,
    rate_code_id,
    pu_location_id,
    do_location_id,
    passenger_count,
    trip_distance,
    fare_amount,
    extra,
    mta_tax,
    tip_amount,
    tolls_amount,
    improvement_surcharge,
    total_amount,
    payment_type,
    trip_type,
    congestion_surcharge
FROM tripdata_cte
    );
  
[0m16:04:18.293748 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:e11d0b9b-309c-4d06-93a6-53b2b37c59a9&page=queryresults
[0m16:04:18.662119 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: pickup_time at [46:5]; reason: invalidQuery, location: query, message: Unrecognized name: pickup_time at [46:5]')
[0m16:04:20.065184 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:fb426aaa-9c0f-40a7-ac1d-be6b3e9d2df7&page=queryresults
[0m16:04:20.444165 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:fb426aaa-9c0f-40a7-ac1d-be6b3e9d2df7&page=queryresults
[0m16:04:20.470021 [debug] [Thread-1  ]: Database Error in model fct_trips (models/transform/fct_trips.sql)
  Unrecognized name: pickup_time at [46:5]
  compiled code at target/run/nyc_taxi/models/transform/fct_trips.sql
[0m16:04:20.478082 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9fe82ab3-ccf3-469c-9604-5e6a40b4f113', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c8db28880>]}
[0m16:04:20.482978 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model nyc_taxi.fct_trips ....................... [[31mERROR[0m in 3.61s]
[0m16:04:20.486964 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.fct_trips
[0m16:04:20.493413 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:04:20.496727 [debug] [MainThread]: Connection 'model.nyc_taxi.fct_trips' was properly closed.
[0m16:04:20.499783 [info ] [MainThread]: 
[0m16:04:20.502706 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.55 seconds (5.55s).
[0m16:04:20.507634 [debug] [MainThread]: Command end result
[0m16:04:20.708860 [info ] [MainThread]: 
[0m16:04:20.712630 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:04:20.716256 [info ] [MainThread]: 
[0m16:04:20.720065 [error] [MainThread]:   Database Error in model fct_trips (models/transform/fct_trips.sql)
  Unrecognized name: pickup_time at [46:5]
  compiled code at target/run/nyc_taxi/models/transform/fct_trips.sql
[0m16:04:20.723876 [info ] [MainThread]: 
[0m16:04:20.726991 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:04:20.731671 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 20.489635, "process_in_blocks": "117496", "process_kernel_time": 1.15037, "process_mem_max_rss": "232636", "process_out_blocks": "0", "process_user_time": 15.539585}
[0m16:04:20.735958 [debug] [MainThread]: Command `dbt run` failed at 16:04:20.735354 after 20.49 seconds
[0m16:04:20.738989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c94823c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c92d6ad90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c5b235f10>]}
[0m16:04:20.742354 [debug] [MainThread]: Flushing usage events
[0m16:25:17.350441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f712d68dc70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f712b48ff70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f712b48ff10>]}


============================== 16:25:17.379443 | 81e639c6-e87b-4e90-8176-eaed7271abfb ==============================
[0m16:25:17.379443 [info ] [MainThread]: Running with dbt=1.8.9
[0m16:25:17.383994 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'empty': 'False', 'indirect_selection': 'eager', 'write_json': 'True', 'use_colors': 'True', 'log_path': '/opt/airflow/include/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'static_parser': 'True', 'target_path': 'None', 'debug': 'False', 'version_check': 'True', 'cache_selected_only': 'False', 'quiet': 'False', 'profiles_dir': '/opt/airflow/include/dbt/', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'printer_width': '80', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/include/dbt/'}
[0m16:25:20.608190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '81e639c6-e87b-4e90-8176-eaed7271abfb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f712d99e400>]}
[0m16:25:20.781534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '81e639c6-e87b-4e90-8176-eaed7271abfb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70f3f87fd0>]}
[0m16:25:20.785639 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m16:25:21.288709 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m16:25:21.639052 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m16:25:21.643152 [debug] [MainThread]: previous checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, current checksum: 2944ea4cf69a4d661e9a2d28705b06765f154182f2288118aaca2efd2a1ed3ec
[0m16:25:21.646494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '81e639c6-e87b-4e90-8176-eaed7271abfb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f712c8d4d90>]}
[0m16:25:29.456733 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '81e639c6-e87b-4e90-8176-eaed7271abfb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7120df9130>]}
[0m16:25:29.849276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '81e639c6-e87b-4e90-8176-eaed7271abfb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7120d9adc0>]}
[0m16:25:29.853232 [info ] [MainThread]: Found 5 models, 2 sources, 600 macros
[0m16:25:29.859920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '81e639c6-e87b-4e90-8176-eaed7271abfb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f712345f130>]}
[0m16:25:29.867175 [info ] [MainThread]: 
[0m16:25:29.871851 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:25:29.890853 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_northern-shield-437204-m0'
[0m16:25:29.894026 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:25:30.663506 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_northern-shield-437204-m0, now list_northern-shield-437204-m0_nyc_taxi)
[0m16:25:30.667483 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:25:31.419429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '81e639c6-e87b-4e90-8176-eaed7271abfb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7120d97820>]}
[0m16:25:31.423305 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:25:31.426342 [info ] [MainThread]: 
[0m16:25:31.447265 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_payment
[0m16:25:31.451928 [info ] [Thread-1  ]: 1 of 5 START sql table model nyc_taxi.dim_payment .............................. [RUN]
[0m16:25:31.455535 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_northern-shield-437204-m0_nyc_taxi, now model.nyc_taxi.dim_payment)
[0m16:25:31.459603 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_payment
[0m16:25:31.496238 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_payment"
[0m16:25:31.528609 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_payment
[0m16:25:31.582707 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:25:32.368871 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.dim_payment"
[0m16:25:32.395065 [debug] [Thread-1  ]: On model.nyc_taxi.dim_payment: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.dim_payment"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`dim_payment`
      
    
    

    OPTIONS()
    as (
      WITH payment_cte AS(
    SELECT DISTINCT
        payment_type AS type_id,
        CASE 
            WHEN payment_type = 1 THEN "Credit card"
            WHEN payment_type = 2 THEN "Cash"
            WHEN payment_type = 3 THEN "No charge"
            WHEN payment_type = 4 THEN "Dispute"
            WHEN payment_type = 5 THEN "Unknown"
            WHEN payment_type = 6 THEN "Voided trip"
        END AS payment_name
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata`
)
SELECT
    type_id,
    payment_name
FROM payment_cte
    );
  
[0m16:25:33.129000 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:6d16686f-61a4-4d74-8244-f5de4fc609de&page=queryresults
[0m16:25:36.060912 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81e639c6-e87b-4e90-8176-eaed7271abfb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70f8e22460>]}
[0m16:25:36.066289 [info ] [Thread-1  ]: 1 of 5 OK created sql table model nyc_taxi.dim_payment ......................... [[32mCREATE TABLE (4.0 rows, 463.5 KiB processed)[0m in 4.60s]
[0m16:25:36.071591 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_payment
[0m16:25:36.076622 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_ratecode
[0m16:25:36.080889 [info ] [Thread-1  ]: 2 of 5 START sql table model nyc_taxi.dim_ratecode ............................. [RUN]
[0m16:25:36.085432 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_payment, now model.nyc_taxi.dim_ratecode)
[0m16:25:36.089836 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_ratecode
[0m16:25:36.104784 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_ratecode"
[0m16:25:36.136302 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_ratecode
[0m16:25:36.149914 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:25:36.842168 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.dim_ratecode"
[0m16:25:36.871100 [debug] [Thread-1  ]: On model.nyc_taxi.dim_ratecode: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.dim_ratecode"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`dim_ratecode`
      
    
    

    OPTIONS()
    as (
      WITH rate_code_cte AS(
    SELECT DISTINCT
        rate_code_id AS rate_id,
        CASE 
            WHEN rate_code_id = 1 THEN "Standard rate"
            WHEN rate_code_id = 2 THEN "JFK"
            WHEN rate_code_id = 3 THEN "Newark"
            WHEN rate_code_id = 4 THEN "Nassau or Westchester"
            WHEN rate_code_id = 5 THEN "Negotiated fare"
            WHEN rate_code_id = 6 THEN "Group ride"
        ELSE "Unknown"
        END AS rate_code_name
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata`
)
SELECT
    rate_id,
    rate_code_name
FROM rate_code_cte
    );
  
[0m16:25:37.480076 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:4260b048-c2b1-4637-9a2f-0ce4d7d8122b&page=queryresults
[0m16:25:40.156533 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81e639c6-e87b-4e90-8176-eaed7271abfb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f711bb9bd00>]}
[0m16:25:40.161204 [info ] [Thread-1  ]: 2 of 5 OK created sql table model nyc_taxi.dim_ratecode ........................ [[32mCREATE TABLE (6.0 rows, 463.5 KiB processed)[0m in 4.07s]
[0m16:25:40.166417 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_ratecode
[0m16:25:40.170761 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_vendor
[0m16:25:40.174435 [info ] [Thread-1  ]: 3 of 5 START sql table model nyc_taxi.dim_vendor ............................... [RUN]
[0m16:25:40.178025 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_ratecode, now model.nyc_taxi.dim_vendor)
[0m16:25:40.181793 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_vendor
[0m16:25:40.196853 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_vendor"
[0m16:25:40.224633 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_vendor
[0m16:25:40.239016 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:25:40.909000 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.dim_vendor"
[0m16:25:40.942805 [debug] [Thread-1  ]: On model.nyc_taxi.dim_vendor: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.dim_vendor"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`dim_vendor`
      
    
    

    OPTIONS()
    as (
      WITH vendor_cte AS(
    SELECT DISTINCT
        vendor_id AS id,
        CASE 
            WHEN vendor_id = 1 THEN "Creative Mobile Technologies"
            WHEN vendor_id = 2 THEN "VeriFone Inc."
        END AS vendor_name
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata`
)
SELECT
    id,
    vendor_name
FROM vendor_cte
    );
  
[0m16:25:41.603935 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:b221e47f-bd29-4c33-9933-4fad013bd18f&page=queryresults
[0m16:25:43.924309 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81e639c6-e87b-4e90-8176-eaed7271abfb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f711bba4d00>]}
[0m16:25:43.929152 [info ] [Thread-1  ]: 3 of 5 OK created sql table model nyc_taxi.dim_vendor .......................... [[32mCREATE TABLE (2.0 rows, 463.5 KiB processed)[0m in 3.75s]
[0m16:25:43.936248 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_vendor
[0m16:25:43.941240 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_zone
[0m16:25:43.946577 [info ] [Thread-1  ]: 4 of 5 START sql table model nyc_taxi.dim_zone ................................. [RUN]
[0m16:25:43.951675 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_vendor, now model.nyc_taxi.dim_zone)
[0m16:25:43.958944 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_zone
[0m16:25:43.974426 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_zone"
[0m16:25:44.003003 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_zone
[0m16:25:44.015219 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:25:43.072438 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.dim_zone"
[0m16:25:43.098148 [debug] [Thread-1  ]: On model.nyc_taxi.dim_zone: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.dim_zone"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`dim_zone`
      
    
    

    OPTIONS()
    as (
      SELECT
    location_id,
    borough,
    zone,
    replace(service_zone, 'Boro', 'Green') as service_zone
FROM `northern-shield-437204-m0`.`nyc_taxi`.`zone_map`
    );
  
[0m16:25:43.816581 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:fdb03abc-db6e-4f4c-87d3-a26a21836e26&page=queryresults
[0m16:25:46.437884 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81e639c6-e87b-4e90-8176-eaed7271abfb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7120c41520>]}
[0m16:25:46.442315 [info ] [Thread-1  ]: 4 of 5 OK created sql table model nyc_taxi.dim_zone ............................ [[32mCREATE TABLE (530.0 rows, 24.2 KiB processed)[0m in 2.49s]
[0m16:25:46.448359 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_zone
[0m16:25:46.453965 [debug] [Thread-1  ]: Began running node model.nyc_taxi.fct_trips
[0m16:25:46.457811 [info ] [Thread-1  ]: 5 of 5 START sql table model nyc_taxi.fct_trips ................................ [RUN]
[0m16:25:46.461989 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_zone, now model.nyc_taxi.fct_trips)
[0m16:25:46.465755 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.fct_trips
[0m16:25:46.496603 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.fct_trips"
[0m16:25:46.519966 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.fct_trips
[0m16:25:46.533339 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.fct_trips"
[0m16:25:46.556981 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:25:46.567641 [debug] [Thread-1  ]: On model.nyc_taxi.fct_trips: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.fct_trips"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips`
      
    
    

    OPTIONS()
    as (
      WITH tripdata_cte AS (
    SELECT 
        to_hex(md5(cast(coalesce(cast(vendor_id as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(lpep_pickup_datetime as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(lpep_dropoff_datetime as string), '_dbt_utils_surrogate_key_null_') as string)))  AS trip_id,
        t.vendor_id,
        t.lpep_pickup_datetime,
        t.lpep_dropoff_datetime,
        t.rate_code_id,
        t.pu_location_id,
        t.do_location_id,
        t.passenger_count,
        t.trip_distance,
        t.fare_amount,
        t.extra,
        t.mta_tax,
        t.tip_amount,
        t.tolls_amount,
        t.improvement_surcharge,
        t.total_amount,
        t.payment_type,
        t.trip_type,
        t.congestion_surcharge
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata` AS t
    WHERE vendor_id IS NOT NULL
)
SELECT 
    trip_id,
    vendor_id,
    pickup_time,
    dropoff_time,
    rate_code_id,
    pu_location_id,
    do_location_id,
    passenger_count,
    trip_distance,
    fare_amount,
    extra,
    mta_tax,
    tip_amount,
    tolls_amount,
    improvement_surcharge,
    total_amount,
    payment_type,
    trip_type,
    congestion_surcharge
FROM tripdata_cte
    );
  
[0m16:25:47.428606 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:a6a572dc-1a3a-4412-9354-1a9d00e938e9&page=queryresults
[0m16:25:47.811767 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: pickup_time at [40:5]; reason: invalidQuery, location: query, message: Unrecognized name: pickup_time at [40:5]')
[0m16:25:48.850945 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:d99caeec-6d6a-49e5-bba3-670168c84286&page=queryresults
[0m16:25:49.219994 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:d99caeec-6d6a-49e5-bba3-670168c84286&page=queryresults
[0m16:25:49.230770 [debug] [Thread-1  ]: Database Error in model fct_trips (models/transform/fct_trips.sql)
  Unrecognized name: pickup_time at [40:5]
  compiled code at target/run/nyc_taxi/models/transform/fct_trips.sql
[0m16:25:49.234315 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81e639c6-e87b-4e90-8176-eaed7271abfb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f711c3c77c0>]}
[0m16:25:49.238867 [error] [Thread-1  ]: 5 of 5 ERROR creating sql table model nyc_taxi.fct_trips ....................... [[31mERROR[0m in 2.77s]
[0m16:25:49.244134 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.fct_trips
[0m16:25:49.251296 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:25:49.254898 [debug] [MainThread]: Connection 'model.nyc_taxi.fct_trips' was properly closed.
[0m16:25:49.258516 [info ] [MainThread]: 
[0m16:25:49.262070 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 19.39 seconds (19.39s).
[0m16:25:49.271999 [debug] [MainThread]: Command end result
[0m16:25:49.482504 [info ] [MainThread]: 
[0m16:25:49.485843 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:25:49.489352 [info ] [MainThread]: 
[0m16:25:49.493356 [error] [MainThread]:   Database Error in model fct_trips (models/transform/fct_trips.sql)
  Unrecognized name: pickup_time at [40:5]
  compiled code at target/run/nyc_taxi/models/transform/fct_trips.sql
[0m16:25:49.497599 [info ] [MainThread]: 
[0m16:25:49.501132 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m16:25:49.506092 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 34.07867, "process_in_blocks": "200", "process_kernel_time": 1.221225, "process_mem_max_rss": "233224", "process_out_blocks": "0", "process_user_time": 16.429293}
[0m16:25:49.510240 [debug] [MainThread]: Command `dbt run` failed at 16:25:49.509702 after 34.08 seconds
[0m16:25:49.513893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f712d68dc70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f712cca8bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7120d9f190>]}
[0m16:25:49.517592 [debug] [MainThread]: Flushing usage events
[0m16:26:18.680000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a03935c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a0174c280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a02b54970>]}


============================== 16:26:18.698793 | 28a4ba2f-4743-4815-b975-d238389b3907 ==============================
[0m16:26:18.698793 [info ] [MainThread]: Running with dbt=1.8.9
[0m16:26:18.703576 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'use_experimental_parser': 'False', 'cache_selected_only': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/include/dbt/logs', 'introspect': 'True', 'printer_width': '80', 'send_anonymous_usage_stats': 'True', 'no_print': 'None', 'quiet': 'False', 'partial_parse': 'True', 'use_colors': 'True', 'static_parser': 'True', 'empty': 'False', 'debug': 'False', 'version_check': 'True', 'profiles_dir': '/opt/airflow/include/dbt/', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'write_json': 'True', 'warn_error': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/include/dbt/', 'target_path': 'None'}
[0m16:26:21.729988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '28a4ba2f-4743-4815-b975-d238389b3907', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a01ed4100>]}
[0m16:26:21.902960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '28a4ba2f-4743-4815-b975-d238389b3907', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f59ca2fee50>]}
[0m16:26:21.906913 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m16:26:22.407086 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m16:26:25.602205 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:26:25.606170 [debug] [MainThread]: Partial parsing: updated file: nyc_taxi://models/transform/fct_trips.sql
[0m16:26:26.753433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '28a4ba2f-4743-4815-b975-d238389b3907', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f59fc96c130>]}
[0m16:26:27.181072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '28a4ba2f-4743-4815-b975-d238389b3907', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f59fca70520>]}
[0m16:26:27.185197 [info ] [MainThread]: Found 5 models, 2 sources, 600 macros
[0m16:26:27.189645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '28a4ba2f-4743-4815-b975-d238389b3907', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f59fc974cd0>]}
[0m16:26:27.197444 [info ] [MainThread]: 
[0m16:26:27.201838 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:26:27.222213 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_northern-shield-437204-m0'
[0m16:26:27.225320 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:26:28.024850 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_northern-shield-437204-m0, now list_northern-shield-437204-m0_nyc_taxi)
[0m16:26:28.028581 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:26:28.769962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '28a4ba2f-4743-4815-b975-d238389b3907', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a03920220>]}
[0m16:26:28.773764 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:26:28.777093 [info ] [MainThread]: 
[0m16:26:28.800698 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_payment
[0m16:26:28.805807 [info ] [Thread-1  ]: 1 of 5 START sql table model nyc_taxi.dim_payment .............................. [RUN]
[0m16:26:28.810604 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_northern-shield-437204-m0_nyc_taxi, now model.nyc_taxi.dim_payment)
[0m16:26:28.814314 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_payment
[0m16:26:28.846013 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_payment"
[0m16:26:28.866905 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_payment
[0m16:26:28.927684 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:26:29.678018 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.dim_payment"
[0m16:26:29.699087 [debug] [Thread-1  ]: On model.nyc_taxi.dim_payment: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.dim_payment"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`dim_payment`
      
    
    

    OPTIONS()
    as (
      WITH payment_cte AS(
    SELECT DISTINCT
        payment_type AS type_id,
        CASE 
            WHEN payment_type = 1 THEN "Credit card"
            WHEN payment_type = 2 THEN "Cash"
            WHEN payment_type = 3 THEN "No charge"
            WHEN payment_type = 4 THEN "Dispute"
            WHEN payment_type = 5 THEN "Unknown"
            WHEN payment_type = 6 THEN "Voided trip"
        END AS payment_name
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata`
)
SELECT
    type_id,
    payment_name
FROM payment_cte
    );
  
[0m16:26:30.473902 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:f9dbf885-3e2e-4bf6-ac1b-1812483c5cbf&page=queryresults
[0m16:26:33.089449 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '28a4ba2f-4743-4815-b975-d238389b3907', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f59cb091970>]}
[0m16:26:33.094295 [info ] [Thread-1  ]: 1 of 5 OK created sql table model nyc_taxi.dim_payment ......................... [[32mCREATE TABLE (4.0 rows, 463.5 KiB processed)[0m in 4.28s]
[0m16:26:33.099256 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_payment
[0m16:26:33.104590 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_ratecode
[0m16:26:33.110283 [info ] [Thread-1  ]: 2 of 5 START sql table model nyc_taxi.dim_ratecode ............................. [RUN]
[0m16:26:33.116032 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_payment, now model.nyc_taxi.dim_ratecode)
[0m16:26:33.119235 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_ratecode
[0m16:26:33.134360 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_ratecode"
[0m16:26:33.156117 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_ratecode
[0m16:26:33.171390 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:26:33.857910 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.dim_ratecode"
[0m16:26:33.878267 [debug] [Thread-1  ]: On model.nyc_taxi.dim_ratecode: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.dim_ratecode"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`dim_ratecode`
      
    
    

    OPTIONS()
    as (
      WITH rate_code_cte AS(
    SELECT DISTINCT
        rate_code_id AS rate_id,
        CASE 
            WHEN rate_code_id = 1 THEN "Standard rate"
            WHEN rate_code_id = 2 THEN "JFK"
            WHEN rate_code_id = 3 THEN "Newark"
            WHEN rate_code_id = 4 THEN "Nassau or Westchester"
            WHEN rate_code_id = 5 THEN "Negotiated fare"
            WHEN rate_code_id = 6 THEN "Group ride"
        ELSE "Unknown"
        END AS rate_code_name
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata`
)
SELECT
    rate_id,
    rate_code_name
FROM rate_code_cte
    );
  
[0m16:26:34.595279 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:edb69828-277c-4024-8fa5-be6bc004561d&page=queryresults
[0m16:26:37.475415 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '28a4ba2f-4743-4815-b975-d238389b3907', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f59fc85eac0>]}
[0m16:26:37.480261 [info ] [Thread-1  ]: 2 of 5 OK created sql table model nyc_taxi.dim_ratecode ........................ [[32mCREATE TABLE (6.0 rows, 463.5 KiB processed)[0m in 4.36s]
[0m16:26:37.485126 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_ratecode
[0m16:26:37.489715 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_vendor
[0m16:26:37.493720 [info ] [Thread-1  ]: 3 of 5 START sql table model nyc_taxi.dim_vendor ............................... [RUN]
[0m16:26:37.498802 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_ratecode, now model.nyc_taxi.dim_vendor)
[0m16:26:37.502600 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_vendor
[0m16:26:37.517065 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_vendor"
[0m16:26:37.540665 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_vendor
[0m16:26:37.560155 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:26:38.314972 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.dim_vendor"
[0m16:26:38.337883 [debug] [Thread-1  ]: On model.nyc_taxi.dim_vendor: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.dim_vendor"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`dim_vendor`
      
    
    

    OPTIONS()
    as (
      WITH vendor_cte AS(
    SELECT DISTINCT
        vendor_id AS id,
        CASE 
            WHEN vendor_id = 1 THEN "Creative Mobile Technologies"
            WHEN vendor_id = 2 THEN "VeriFone Inc."
        END AS vendor_name
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata`
)
SELECT
    id,
    vendor_name
FROM vendor_cte
    );
  
[0m16:26:38.962451 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:6981c6b9-924c-46b4-a37a-05cd7deac91a&page=queryresults
[0m16:26:40.212939 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '28a4ba2f-4743-4815-b975-d238389b3907', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f59fc85eb80>]}
[0m16:26:40.217651 [info ] [Thread-1  ]: 3 of 5 OK created sql table model nyc_taxi.dim_vendor .......................... [[32mCREATE TABLE (2.0 rows, 463.5 KiB processed)[0m in 2.71s]
[0m16:26:40.223105 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_vendor
[0m16:26:40.227539 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_zone
[0m16:26:40.236752 [info ] [Thread-1  ]: 4 of 5 START sql table model nyc_taxi.dim_zone ................................. [RUN]
[0m16:26:40.241444 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_vendor, now model.nyc_taxi.dim_zone)
[0m16:26:40.246130 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_zone
[0m16:26:40.261537 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_zone"
[0m16:26:40.289331 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_zone
[0m16:26:40.302481 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:26:40.971532 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.dim_zone"
[0m16:26:40.992423 [debug] [Thread-1  ]: On model.nyc_taxi.dim_zone: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.dim_zone"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`dim_zone`
      
    
    

    OPTIONS()
    as (
      SELECT
    location_id,
    borough,
    zone,
    replace(service_zone, 'Boro', 'Green') as service_zone
FROM `northern-shield-437204-m0`.`nyc_taxi`.`zone_map`
    );
  
[0m16:26:41.558586 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:bb322046-bdcc-4fdc-8d6b-a1566445d540&page=queryresults
[0m16:26:44.238908 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '28a4ba2f-4743-4815-b975-d238389b3907', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f59fc80f130>]}
[0m16:26:44.243097 [info ] [Thread-1  ]: 4 of 5 OK created sql table model nyc_taxi.dim_zone ............................ [[32mCREATE TABLE (530.0 rows, 24.2 KiB processed)[0m in 4.00s]
[0m16:26:44.248481 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_zone
[0m16:26:44.252795 [debug] [Thread-1  ]: Began running node model.nyc_taxi.fct_trips
[0m16:26:44.256984 [info ] [Thread-1  ]: 5 of 5 START sql table model nyc_taxi.fct_trips ................................ [RUN]
[0m16:26:44.260599 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_zone, now model.nyc_taxi.fct_trips)
[0m16:26:44.264044 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.fct_trips
[0m16:26:44.285338 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.fct_trips"
[0m16:26:44.310779 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.fct_trips
[0m16:26:44.324583 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.fct_trips"
[0m16:26:44.350576 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:26:44.362366 [debug] [Thread-1  ]: On model.nyc_taxi.fct_trips: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.fct_trips"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips`
      
    
    

    OPTIONS()
    as (
      WITH tripdata_cte AS (
    SELECT 
        to_hex(md5(cast(coalesce(cast(vendor_id as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(lpep_pickup_datetime as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(lpep_dropoff_datetime as string), '_dbt_utils_surrogate_key_null_') as string)))  AS trip_id,
        t.vendor_id,
        t.lpep_pickup_datetime AS pickup_time,
        t.lpep_dropoff_datetime AS dropoff_time,
        t.rate_code_id,
        t.pu_location_id,
        t.do_location_id,
        t.passenger_count,
        t.trip_distance,
        t.fare_amount,
        t.extra,
        t.mta_tax,
        t.tip_amount,
        t.tolls_amount,
        t.improvement_surcharge,
        t.total_amount,
        t.payment_type,
        t.trip_type,
        t.congestion_surcharge
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata` AS t
    WHERE vendor_id IS NOT NULL
)
SELECT 
    trip_id,
    vendor_id,
    pickup_time,
    dropoff_time,
    rate_code_id,
    pu_location_id,
    do_location_id,
    passenger_count,
    trip_distance,
    fare_amount,
    extra,
    mta_tax,
    tip_amount,
    tolls_amount,
    improvement_surcharge,
    total_amount,
    payment_type,
    trip_type,
    congestion_surcharge
FROM tripdata_cte
    );
  
[0m16:26:45.186148 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:6e252ad7-fb4b-47aa-a229-54c12176a535&page=queryresults
[0m16:26:49.281071 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '28a4ba2f-4743-4815-b975-d238389b3907', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f59fc7b0490>]}
[0m16:26:49.286118 [info ] [Thread-1  ]: 5 of 5 OK created sql table model nyc_taxi.fct_trips ........................... [[32mCREATE TABLE (59.3k rows, 8.1 MiB processed)[0m in 5.02s]
[0m16:26:49.290994 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.fct_trips
[0m16:26:49.297956 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:26:49.301024 [debug] [MainThread]: Connection 'model.nyc_taxi.fct_trips' was properly closed.
[0m16:26:49.304733 [info ] [MainThread]: 
[0m16:26:49.310210 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 22.10 seconds (22.10s).
[0m16:26:49.323390 [debug] [MainThread]: Command end result
[0m16:26:49.524757 [info ] [MainThread]: 
[0m16:26:49.529124 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:26:49.532529 [info ] [MainThread]: 
[0m16:26:49.536228 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m16:26:49.543264 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 32.685535, "process_in_blocks": "0", "process_kernel_time": 0.978681, "process_mem_max_rss": "230920", "process_out_blocks": "0", "process_user_time": 12.286815}
[0m16:26:49.548235 [debug] [MainThread]: Command `dbt run` succeeded at 16:26:49.547673 after 32.69 seconds
[0m16:26:49.552191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a03935c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f59ca2fee50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a01e350a0>]}
[0m16:26:49.555567 [debug] [MainThread]: Flushing usage events
[0m16:30:32.937982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b852fac70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b830fbf70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b830fbf10>]}


============================== 16:30:32.957028 | 2bb79d87-be41-44dc-875d-4d2d571a41d4 ==============================
[0m16:30:32.957028 [info ] [MainThread]: Running with dbt=1.8.9
[0m16:30:32.960880 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'partial_parse': 'True', 'invocation_command': 'dbt test --profiles-dir /opt/airflow/include/dbt/', 'use_colors': 'True', 'version_check': 'True', 'send_anonymous_usage_stats': 'True', 'debug': 'False', 'log_path': '/opt/airflow/include/dbt/logs', 'log_cache_events': 'False', 'warn_error': 'None', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'profiles_dir': '/opt/airflow/include/dbt/', 'cache_selected_only': 'False', 'no_print': 'None', 'empty': 'None', 'write_json': 'True', 'quiet': 'False', 'printer_width': '80', 'introspect': 'True', 'static_parser': 'True', 'fail_fast': 'False'}
[0m16:30:36.007300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2bb79d87-be41-44dc-875d-4d2d571a41d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b83126760>]}
[0m16:30:36.197928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2bb79d87-be41-44dc-875d-4d2d571a41d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b50970c70>]}
[0m16:30:36.202270 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m16:30:36.713384 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m16:30:40.082673 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:30:40.086317 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:30:40.217486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2bb79d87-be41-44dc-875d-4d2d571a41d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b7e447130>]}
[0m16:30:40.931986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2bb79d87-be41-44dc-875d-4d2d571a41d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b7e59b1c0>]}
[0m16:30:40.936121 [info ] [MainThread]: Found 5 models, 2 sources, 600 macros
[0m16:30:40.939660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2bb79d87-be41-44dc-875d-4d2d571a41d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b7e009250>]}
[0m16:30:40.945294 [info ] [MainThread]: 
[0m16:30:40.948158 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m16:30:40.957018 [debug] [MainThread]: Command end result
[0m16:30:41.373171 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 8.657227, "process_in_blocks": "2352", "process_kernel_time": 1.041258, "process_mem_max_rss": "257496", "process_out_blocks": "568", "process_user_time": 10.540287}
[0m16:30:41.377219 [debug] [MainThread]: Command `dbt test` succeeded at 16:30:41.376649 after 8.66 seconds
[0m16:30:41.380516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b852fac70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b7e0f8e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b83126b80>]}
[0m16:30:41.384196 [debug] [MainThread]: Flushing usage events
[0m16:39:54.430074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fc85e8ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fc784efd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fc63f6d60>]}


============================== 16:39:54.438496 | 8b99ea30-1e8e-4936-83d0-839712795f00 ==============================
[0m16:39:54.438496 [info ] [MainThread]: Running with dbt=1.8.9
[0m16:39:54.440512 [debug] [MainThread]: running dbt with arguments {'log_cache_events': 'False', 'use_colors': 'True', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'fail_fast': 'False', 'write_json': 'True', 'profiles_dir': '/opt/airflow/include/dbt', 'use_experimental_parser': 'False', 'introspect': 'True', 'log_path': '/opt/airflow/include/dbt/logs', 'no_print': 'None', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'log_format': 'default', 'printer_width': '80', 'warn_error': 'None', 'empty': 'False', 'indirect_selection': 'eager', 'cache_selected_only': 'False', 'quiet': 'False', 'invocation_command': 'dbt run --select dim_zone', 'debug': 'False', 'target_path': 'None', 'version_check': 'True'}
[0m16:39:55.631354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8b99ea30-1e8e-4936-83d0-839712795f00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f8eff65e0>]}
[0m16:39:55.696793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8b99ea30-1e8e-4936-83d0-839712795f00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f8ef0f910>]}
[0m16:39:55.699102 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m16:39:55.872025 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m16:39:56.560988 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m16:39:56.562728 [debug] [MainThread]: Partial parsing: added file: nyc_taxi://models/tests/schema.yml
[0m16:39:56.563876 [debug] [MainThread]: Partial parsing: updated file: nyc_taxi://models/transform/dim_zone.sql
[0m16:39:56.947224 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m16:39:56.949014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '8b99ea30-1e8e-4936-83d0-839712795f00', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f8efb7040>]}
[0m16:39:56.966418 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'dim_time' in the 'models' section of file 'models/tests/schema.yml'
[0m16:39:56.984433 [error] [MainThread]: Encountered an error:
Parsing Error
  Invalid models config given in models/tests/schema.yml @ models: {'name': 'fct_trips', 'description': 'Fact Table of tripdata', 'columns': [{'name': 'trip_id', 'description': 'The primary key for this table', 'tests': ['unique']}, {'name': 'vendor_id', 'description': 'A code indicating the TPEP provider that provided the record', 'tests': ['not_null']}, {'name': 'pickup_time_id', 'description': 'id to get pickup time from dim_time', 'tests': ['not_null']}, {'name': 'dropoff_time_id', 'description': 'id to get dropoff time from dim_time', 'tests': ['not_null']}, {'name': 'rate_code_id', 'description': 'The final rate code in effect at the end of the trip', 'tests': ['not_null']}, {'name': 'pu_location_id', 'description': 'The pickup location', 'tests': ['not_null']}, {'name': 'do_location_id', 'description': 'The droppof location', 'tests': ['not_null']}, {'name': 'passenger_count', 'description': 'Customer count', 'tests': ['not_null']}, {'name': 'trip_distance', 'description': 'trip distance', 'tests': ['not_null']}, {'name': 'fare_amount', 'description': 'The time-and-distance fare calculated by the meter.', 'tests': [{'conditional_values': {'condition': 'fare_amount >= 0'}}]}, {'name': 'extra', 'description': 'Miscellaneous extras and surcharges. Currently, this only includes. the $0.50 and $1 rush hour and overnight charges', 'tests': ['not_null']}, {'name': 'mta_tax', 'description': '0.50 MTA tax that is automatically triggered based on the metered rate in use', 'tests': [{'conditional_values': {'condition': 'mta_tax >= 0'}}]}, {'name': 'tip_amount', 'description': 'Tip amount  This field is automatically populated for credit card tips.Cash tips are not included', 'tests': [{'conditional_values': {'condition': 'tip_amount >= 0'}}]}, {'name': 'tolls_amount', 'description': 'Total amount of all tolls paid in trip', 'tests': [{'conditional_values': {'condition': 'tolls_amount >= 0'}}]}, {'name': 'improvement_surcharge', 'description': '0.30 improvement surcharge assessed trips at the flag drop. the improvement surcharge began being levied in 2015', 'tests': ['not_null']}, {'name': 'total_amount', 'description': 'The total amount charged to passengers. Does not include cash tips.', 'tests': [{'conditional_values': {'condition': 'total_amount >= 0'}}]}, {'name': 'payment_type', 'description': 'A numeric code signifying how the passenger paid for the trip', 'tests': ['not_null']}, {'name': 'trip_type', 'description': 'Year of pickup', 'tests': [None]}, {'name': 'congestion_surcharge', 'description': 'An additional charge for trips taken during high traffic congestion times', 'tests': [None]}], 'original_file_path': 'models/tests/schema.yml', 'yaml_key': 'models', 'package_name': 'nyc_taxi'} - at path ['columns'][17]['tests'][0]: None is not valid under any of the given schemas
[0m16:39:56.987095 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.6289606, "process_in_blocks": "0", "process_kernel_time": 0.292398, "process_mem_max_rss": "232396", "process_out_blocks": "0", "process_user_time": 4.838726}
[0m16:39:56.988487 [debug] [MainThread]: Command `dbt run` failed at 16:39:56.988321 after 2.63 seconds
[0m16:39:56.989455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fc85e8ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f8eee38b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fc17ed070>]}
[0m16:39:56.990376 [debug] [MainThread]: Flushing usage events
[0m16:41:01.930701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74d3d29cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74d2f67af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74d1b34d90>]}


============================== 16:41:01.938641 | acb2687d-ff41-41a4-ae1e-1c43eacaf8a9 ==============================
[0m16:41:01.938641 [info ] [MainThread]: Running with dbt=1.8.9
[0m16:41:01.940346 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'use_experimental_parser': 'False', 'warn_error': 'None', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/include/dbt/', 'profiles_dir': '/opt/airflow/include/dbt/', 'debug': 'False', 'partial_parse': 'True', 'log_format': 'default', 'quiet': 'False', 'version_check': 'True', 'no_print': 'None', 'introspect': 'True', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'log_cache_events': 'False', 'log_path': '/opt/airflow/include/dbt/logs', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'use_colors': 'True', 'cache_selected_only': 'False', 'indirect_selection': 'eager', 'fail_fast': 'False', 'printer_width': '80'}
[0m16:41:03.143620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'acb2687d-ff41-41a4-ae1e-1c43eacaf8a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74d34dc100>]}
[0m16:41:03.209952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'acb2687d-ff41-41a4-ae1e-1c43eacaf8a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f749a6e9130>]}
[0m16:41:03.211721 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m16:41:03.397574 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m16:41:04.075756 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m16:41:04.077583 [debug] [MainThread]: Partial parsing: added file: nyc_taxi://models/tests/schema.yml
[0m16:41:04.078650 [debug] [MainThread]: Partial parsing: updated file: nyc_taxi://models/transform/dim_zone.sql
[0m16:41:04.463008 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m16:41:04.464900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'acb2687d-ff41-41a4-ae1e-1c43eacaf8a9', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74cce5ce20>]}
[0m16:41:04.481889 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'dim_time' in the 'models' section of file 'models/tests/schema.yml'
[0m16:41:04.500803 [error] [MainThread]: Encountered an error:
Parsing Error
  Invalid models config given in models/tests/schema.yml @ models: {'name': 'fct_trips', 'description': 'Fact Table of tripdata', 'columns': [{'name': 'trip_id', 'description': 'The primary key for this table', 'tests': ['unique']}, {'name': 'vendor_id', 'description': 'A code indicating the TPEP provider that provided the record', 'tests': ['not_null']}, {'name': 'pickup_time_id', 'description': 'id to get pickup time from dim_time', 'tests': ['not_null']}, {'name': 'dropoff_time_id', 'description': 'id to get dropoff time from dim_time', 'tests': ['not_null']}, {'name': 'rate_code_id', 'description': 'The final rate code in effect at the end of the trip', 'tests': ['not_null']}, {'name': 'pu_location_id', 'description': 'The pickup location', 'tests': ['not_null']}, {'name': 'do_location_id', 'description': 'The droppof location', 'tests': ['not_null']}, {'name': 'passenger_count', 'description': 'Customer count', 'tests': ['not_null']}, {'name': 'trip_distance', 'description': 'trip distance', 'tests': ['not_null']}, {'name': 'fare_amount', 'description': 'The time-and-distance fare calculated by the meter.', 'tests': [{'conditional_values': {'condition': 'fare_amount >= 0'}}]}, {'name': 'extra', 'description': 'Miscellaneous extras and surcharges. Currently, this only includes. the $0.50 and $1 rush hour and overnight charges', 'tests': ['not_null']}, {'name': 'mta_tax', 'description': '0.50 MTA tax that is automatically triggered based on the metered rate in use', 'tests': [{'conditional_values': {'condition': 'mta_tax >= 0'}}]}, {'name': 'tip_amount', 'description': 'Tip amount  This field is automatically populated for credit card tips.Cash tips are not included', 'tests': [{'conditional_values': {'condition': 'tip_amount >= 0'}}]}, {'name': 'tolls_amount', 'description': 'Total amount of all tolls paid in trip', 'tests': [{'conditional_values': {'condition': 'tolls_amount >= 0'}}]}, {'name': 'improvement_surcharge', 'description': '0.30 improvement surcharge assessed trips at the flag drop. the improvement surcharge began being levied in 2015', 'tests': ['not_null']}, {'name': 'total_amount', 'description': 'The total amount charged to passengers. Does not include cash tips.', 'tests': [{'conditional_values': {'condition': 'total_amount >= 0'}}]}, {'name': 'payment_type', 'description': 'A numeric code signifying how the passenger paid for the trip', 'tests': ['not_null']}, {'name': 'trip_type', 'description': 'Year of pickup', 'tests': [None]}, {'name': 'congestion_surcharge', 'description': 'An additional charge for trips taken during high traffic congestion times', 'tests': [None]}], 'original_file_path': 'models/tests/schema.yml', 'yaml_key': 'models', 'package_name': 'nyc_taxi'} - at path ['columns'][17]['tests'][0]: None is not valid under any of the given schemas
[0m16:41:04.503397 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.6446145, "process_in_blocks": "0", "process_kernel_time": 0.375439, "process_mem_max_rss": "246640", "process_out_blocks": "0", "process_user_time": 4.768083}
[0m16:41:04.505182 [debug] [MainThread]: Command `dbt run` failed at 16:41:04.504874 after 2.65 seconds
[0m16:41:04.506408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74d3d29cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74cc321250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f749a57f430>]}
[0m16:41:04.507501 [debug] [MainThread]: Flushing usage events
[0m16:41:31.343249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb22f53fc70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb22d340ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb22d340e80>]}


============================== 16:41:31.351065 | cba450ca-fa75-486f-8edd-4e9011828847 ==============================
[0m16:41:31.351065 [info ] [MainThread]: Running with dbt=1.8.9
[0m16:41:31.352416 [debug] [MainThread]: running dbt with arguments {'profiles_dir': '/opt/airflow/include/dbt/', 'fail_fast': 'False', 'target_path': 'None', 'log_cache_events': 'False', 'cache_selected_only': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'log_format': 'default', 'quiet': 'False', 'empty': 'False', 'write_json': 'True', 'warn_error': 'None', 'introspect': 'True', 'debug': 'False', 'use_colors': 'True', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'printer_width': '80', 'indirect_selection': 'eager', 'version_check': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'log_path': '/opt/airflow/include/dbt/logs', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/include/dbt/'}
[0m16:41:32.539898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cba450ca-fa75-486f-8edd-4e9011828847', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb22ecf2eb0>]}
[0m16:41:32.604823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cba450ca-fa75-486f-8edd-4e9011828847', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1f5f4f400>]}
[0m16:41:32.606456 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m16:41:32.777413 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m16:41:33.437326 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:41:33.438702 [debug] [MainThread]: Partial parsing: updated file: nyc_taxi://models/transform/dim_zone.sql
[0m16:41:33.856952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cba450ca-fa75-486f-8edd-4e9011828847', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1f5d9a5b0>]}
[0m16:41:33.999983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cba450ca-fa75-486f-8edd-4e9011828847', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb22f89faf0>]}
[0m16:41:34.001422 [info ] [MainThread]: Found 5 models, 2 sources, 600 macros
[0m16:41:34.002745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cba450ca-fa75-486f-8edd-4e9011828847', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2287f3520>]}
[0m16:41:34.005754 [info ] [MainThread]: 
[0m16:41:34.007406 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:41:34.013822 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_northern-shield-437204-m0'
[0m16:41:34.014915 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:41:35.854461 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_northern-shield-437204-m0, now list_northern-shield-437204-m0_nyc_taxi)
[0m16:41:35.856125 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:41:36.490990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cba450ca-fa75-486f-8edd-4e9011828847', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb22eb49ca0>]}
[0m16:41:36.492883 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:41:36.494306 [info ] [MainThread]: 
[0m16:41:36.505026 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_payment
[0m16:41:36.506848 [info ] [Thread-1  ]: 1 of 5 START sql table model nyc_taxi.dim_payment .............................. [RUN]
[0m16:41:36.508573 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_northern-shield-437204-m0_nyc_taxi, now model.nyc_taxi.dim_payment)
[0m16:41:36.509833 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_payment
[0m16:41:36.522064 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_payment"
[0m16:41:36.527993 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_payment
[0m16:41:36.548686 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:41:37.196449 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.dim_payment"
[0m16:41:37.202751 [debug] [Thread-1  ]: On model.nyc_taxi.dim_payment: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.dim_payment"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`dim_payment`
      
    
    

    OPTIONS()
    as (
      WITH payment_cte AS(
    SELECT DISTINCT
        payment_type AS type_id,
        CASE 
            WHEN payment_type = 1 THEN "Credit card"
            WHEN payment_type = 2 THEN "Cash"
            WHEN payment_type = 3 THEN "No charge"
            WHEN payment_type = 4 THEN "Dispute"
            WHEN payment_type = 5 THEN "Unknown"
            WHEN payment_type = 6 THEN "Voided trip"
        END AS payment_name
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata`
)
SELECT
    type_id,
    payment_name
FROM payment_cte
    );
  
[0m16:41:37.884702 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:1b1789f5-735d-40ee-be15-772537db4626&page=queryresults
[0m16:41:40.474673 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cba450ca-fa75-486f-8edd-4e9011828847', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1f6cd13d0>]}
[0m16:41:40.476883 [info ] [Thread-1  ]: 1 of 5 OK created sql table model nyc_taxi.dim_payment ......................... [[32mCREATE TABLE (4.0 rows, 463.5 KiB processed)[0m in 3.97s]
[0m16:41:40.479012 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_payment
[0m16:41:40.480486 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_ratecode
[0m16:41:40.481872 [info ] [Thread-1  ]: 2 of 5 START sql table model nyc_taxi.dim_ratecode ............................. [RUN]
[0m16:41:40.483240 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_payment, now model.nyc_taxi.dim_ratecode)
[0m16:41:40.484312 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_ratecode
[0m16:41:40.489352 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_ratecode"
[0m16:41:40.494322 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_ratecode
[0m16:41:40.498891 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:41:41.128008 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.dim_ratecode"
[0m16:41:41.135575 [debug] [Thread-1  ]: On model.nyc_taxi.dim_ratecode: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.dim_ratecode"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`dim_ratecode`
      
    
    

    OPTIONS()
    as (
      WITH rate_code_cte AS(
    SELECT DISTINCT
        rate_code_id AS rate_id,
        CASE 
            WHEN rate_code_id = 1 THEN "Standard rate"
            WHEN rate_code_id = 2 THEN "JFK"
            WHEN rate_code_id = 3 THEN "Newark"
            WHEN rate_code_id = 4 THEN "Nassau or Westchester"
            WHEN rate_code_id = 5 THEN "Negotiated fare"
            WHEN rate_code_id = 6 THEN "Group ride"
        ELSE "Unknown"
        END AS rate_code_name
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata`
)
SELECT
    rate_id,
    rate_code_name
FROM rate_code_cte
    );
  
[0m16:41:41.823217 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:8dda850f-dc05-4831-96fb-168f363924ab&page=queryresults
[0m16:41:45.948372 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cba450ca-fa75-486f-8edd-4e9011828847', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb227ab7070>]}
[0m16:41:45.950331 [info ] [Thread-1  ]: 2 of 5 OK created sql table model nyc_taxi.dim_ratecode ........................ [[32mCREATE TABLE (6.0 rows, 463.5 KiB processed)[0m in 5.47s]
[0m16:41:45.952600 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_ratecode
[0m16:41:45.954195 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_vendor
[0m16:41:45.955680 [info ] [Thread-1  ]: 3 of 5 START sql table model nyc_taxi.dim_vendor ............................... [RUN]
[0m16:41:45.957319 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_ratecode, now model.nyc_taxi.dim_vendor)
[0m16:41:45.958827 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_vendor
[0m16:41:45.964798 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_vendor"
[0m16:41:45.970616 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_vendor
[0m16:41:45.975610 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:41:46.585536 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.dim_vendor"
[0m16:41:46.593170 [debug] [Thread-1  ]: On model.nyc_taxi.dim_vendor: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.dim_vendor"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`dim_vendor`
      
    
    

    OPTIONS()
    as (
      WITH vendor_cte AS(
    SELECT DISTINCT
        vendor_id AS id,
        CASE 
            WHEN vendor_id = 1 THEN "Creative Mobile Technologies"
            WHEN vendor_id = 2 THEN "VeriFone Inc."
        END AS vendor_name
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata`
)
SELECT
    id,
    vendor_name
FROM vendor_cte
    );
  
[0m16:41:47.189112 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:9811390d-344c-40b2-b6ba-4f28117c5a13&page=queryresults
[0m16:41:48.073344 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cba450ca-fa75-486f-8edd-4e9011828847', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb227a8cb50>]}
[0m16:41:48.074896 [info ] [Thread-1  ]: 3 of 5 OK created sql table model nyc_taxi.dim_vendor .......................... [[32mCREATE TABLE (2.0 rows, 463.5 KiB processed)[0m in 2.12s]
[0m16:41:48.076712 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_vendor
[0m16:41:48.078034 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_zone
[0m16:41:48.079330 [info ] [Thread-1  ]: 4 of 5 START sql table model nyc_taxi.dim_zone ................................. [RUN]
[0m16:41:48.080856 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_vendor, now model.nyc_taxi.dim_zone)
[0m16:41:48.081993 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_zone
[0m16:41:48.089789 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_zone"
[0m16:41:48.095248 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_zone
[0m16:41:48.101671 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.dim_zone"
[0m16:41:48.107323 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:41:48.111555 [debug] [Thread-1  ]: On model.nyc_taxi.dim_zone: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.dim_zone"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`dim_zone`
      
    
    

    OPTIONS()
    as (
      SELECT
    location_id,
    borough,
    zone,
    replace(service_zone, 'Boro', 'Green') as service_zone
FROM `northern-shield-437204-m0`.`nyc_taxi`.`zone_map`
WHERE borough = 'Unkown' or borough is null
    );
  
[0m16:41:48.982238 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:b0049be0-f4e4-4907-9197-f26b74c1d8a3&page=queryresults
[0m16:41:51.489228 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cba450ca-fa75-486f-8edd-4e9011828847', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb228584ee0>]}
[0m16:41:51.491095 [info ] [Thread-1  ]: 4 of 5 OK created sql table model nyc_taxi.dim_zone ............................ [[32mCREATE TABLE (2.0 rows, 24.2 KiB processed)[0m in 3.41s]
[0m16:41:51.493238 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_zone
[0m16:41:51.494749 [debug] [Thread-1  ]: Began running node model.nyc_taxi.fct_trips
[0m16:41:51.496094 [info ] [Thread-1  ]: 5 of 5 START sql table model nyc_taxi.fct_trips ................................ [RUN]
[0m16:41:51.497424 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_zone, now model.nyc_taxi.fct_trips)
[0m16:41:51.498669 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.fct_trips
[0m16:41:51.521763 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.fct_trips"
[0m16:41:51.528857 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.fct_trips
[0m16:41:51.533804 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:41:52.144687 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.fct_trips"
[0m16:41:52.151013 [debug] [Thread-1  ]: On model.nyc_taxi.fct_trips: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.fct_trips"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips`
      
    
    

    OPTIONS()
    as (
      WITH tripdata_cte AS (
    SELECT 
        to_hex(md5(cast(coalesce(cast(vendor_id as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(lpep_pickup_datetime as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(lpep_dropoff_datetime as string), '_dbt_utils_surrogate_key_null_') as string)))  AS trip_id,
        t.vendor_id,
        t.lpep_pickup_datetime AS pickup_time,
        t.lpep_dropoff_datetime AS dropoff_time,
        t.rate_code_id,
        t.pu_location_id,
        t.do_location_id,
        t.passenger_count,
        t.trip_distance,
        t.fare_amount,
        t.extra,
        t.mta_tax,
        t.tip_amount,
        t.tolls_amount,
        t.improvement_surcharge,
        t.total_amount,
        t.payment_type,
        t.trip_type,
        t.congestion_surcharge
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata` AS t
    WHERE vendor_id IS NOT NULL
)
SELECT 
    trip_id,
    vendor_id,
    pickup_time,
    dropoff_time,
    rate_code_id,
    pu_location_id,
    do_location_id,
    passenger_count,
    trip_distance,
    fare_amount,
    extra,
    mta_tax,
    tip_amount,
    tolls_amount,
    improvement_surcharge,
    total_amount,
    payment_type,
    trip_type,
    congestion_surcharge
FROM tripdata_cte
    );
  
[0m16:41:52.698168 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:afaf71e7-4dfe-40cf-8af9-1766986655ce&page=queryresults
[0m16:41:56.745080 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cba450ca-fa75-486f-8edd-4e9011828847', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2286a9be0>]}
[0m16:41:56.746933 [info ] [Thread-1  ]: 5 of 5 OK created sql table model nyc_taxi.fct_trips ........................... [[32mCREATE TABLE (59.3k rows, 8.1 MiB processed)[0m in 5.25s]
[0m16:41:56.748640 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.fct_trips
[0m16:41:56.751336 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:41:56.752558 [debug] [MainThread]: Connection 'model.nyc_taxi.fct_trips' was properly closed.
[0m16:41:56.753649 [info ] [MainThread]: 
[0m16:41:56.754762 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 22.75 seconds (22.75s).
[0m16:41:56.758067 [debug] [MainThread]: Command end result
[0m16:41:56.828896 [info ] [MainThread]: 
[0m16:41:56.830876 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:41:56.832121 [info ] [MainThread]: 
[0m16:41:56.833262 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m16:41:56.835157 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 27.22961, "process_in_blocks": "0", "process_kernel_time": 0.332352, "process_mem_max_rss": "247008", "process_out_blocks": "0", "process_user_time": 5.507551}
[0m16:41:56.836641 [debug] [MainThread]: Command `dbt run` succeeded at 16:41:56.836414 after 27.23 seconds
[0m16:41:56.837781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb22f53fc70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb22ecf2eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb22eb17e80>]}
[0m16:41:56.838833 [debug] [MainThread]: Flushing usage events
[0m16:54:14.732435 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdee55f9ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdee33fad90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdee33fad30>]}


============================== 16:54:14.740883 | 8ea1adcf-067b-4e46-9f6d-56f07fe450a1 ==============================
[0m16:54:14.740883 [info ] [MainThread]: Running with dbt=1.8.9
[0m16:54:14.742346 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'send_anonymous_usage_stats': 'True', 'no_print': 'None', 'target_path': 'None', 'static_parser': 'True', 'log_path': '/opt/airflow/include/dbt/logs', 'debug': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'printer_width': '80', 'partial_parse': 'True', 'log_format': 'default', 'empty': 'None', 'write_json': 'True', 'warn_error': 'None', 'cache_selected_only': 'False', 'introspect': 'True', 'use_experimental_parser': 'False', 'profiles_dir': '/opt/airflow/include/dbt/', 'version_check': 'True', 'quiet': 'False', 'fail_fast': 'False', 'invocation_command': 'dbt test --profiles-dir /opt/airflow/include/dbt/'}
[0m16:54:15.962881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8ea1adcf-067b-4e46-9f6d-56f07fe450a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdee343beb0>]}
[0m16:54:16.028109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8ea1adcf-067b-4e46-9f6d-56f07fe450a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdee3b6a370>]}
[0m16:54:16.030293 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m16:54:16.203279 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m16:54:16.876964 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m16:54:16.878559 [debug] [MainThread]: Partial parsing: added file: nyc_taxi://models/tests/schema.yml
[0m16:54:16.956237 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m16:54:16.958085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '8ea1adcf-067b-4e46-9f6d-56f07fe450a1', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdeabf1b760>]}
[0m16:54:17.112559 [error] [MainThread]: Encountered an error:
Parsing Error
  Invalid models config given in models/tests/schema.yml @ models: {'name': 'fct_trips', 'description': 'Fact Table of tripdata', 'columns': [{'name': 'trip_id', 'description': 'The primary key for this table', 'tests': ['unique']}, {'name': 'vendor_id', 'description': 'A code indicating the TPEP provider that provided the record', 'tests': ['not_null']}, {'name': 'pickup_time', 'description': 'pickup time', 'tests': ['not_null']}, {'name': 'dropoff_time', 'description': 'dropoff time', 'tests': ['not_null']}, {'name': 'rate_code_id', 'description': 'The final rate code in effect at the end of the trip', 'tests': ['not_null']}, {'name': 'pu_location_id', 'description': 'The pickup location', 'tests': ['not_null']}, {'name': 'do_location_id', 'description': 'The droppof location', 'tests': ['not_null']}, {'name': 'passenger_count', 'description': 'Customer count', 'tests': ['not_null']}, {'name': 'trip_distance', 'description': 'trip distance', 'tests': ['not_null']}, {'name': 'fare_amount', 'description': 'The time-and-distance fare calculated by the meter.', 'tests': [{'conditional_values': {'condition': 'fare_amount >= 0'}}]}, {'name': 'extra', 'description': 'Miscellaneous extras and surcharges. Currently, this only includes. the $0.50 and $1 rush hour and overnight charges', 'tests': ['not_null']}, {'name': 'mta_tax', 'description': '0.50 MTA tax that is automatically triggered based on the metered rate in use', 'tests': [{'conditional_values': {'condition': 'mta_tax >= 0'}}]}, {'name': 'tip_amount', 'description': 'Tip amount  This field is automatically populated for credit card tips.Cash tips are not included', 'tests': [{'conditional_values': {'condition': 'tip_amount >= 0'}}]}, {'name': 'tolls_amount', 'description': 'Total amount of all tolls paid in trip', 'tests': [{'conditional_values': {'condition': 'tolls_amount >= 0'}}]}, {'name': 'improvement_surcharge', 'description': '0.30 improvement surcharge assessed trips at the flag drop. the improvement surcharge began being levied in 2015', 'tests': ['not_null']}, {'name': 'total_amount', 'description': 'The total amount charged to passengers. Does not include cash tips.', 'tests': [{'conditional_values': {'condition': 'total_amount >= 0'}}]}, {'name': 'payment_type', 'description': 'A numeric code signifying how the passenger paid for the trip', 'tests': ['not_null']}, {'name': 'trip_type', 'description': 'Year of pickup', 'tests': [None]}, {'name': 'congestion_surcharge', 'description': 'An additional charge for trips taken during high traffic congestion times'}], 'original_file_path': 'models/tests/schema.yml', 'yaml_key': 'models', 'package_name': 'nyc_taxi'} - at path ['columns'][17]['tests'][0]: None is not valid under any of the given schemas
[0m16:54:17.115207 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 2.456244, "process_in_blocks": "2432", "process_kernel_time": 0.309998, "process_mem_max_rss": "244912", "process_out_blocks": "0", "process_user_time": 4.649979}
[0m16:54:17.116616 [debug] [MainThread]: Command `dbt test` failed at 16:54:17.116449 after 2.46 seconds
[0m16:54:17.117550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdee55f9ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdeb01208e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdee34719d0>]}
[0m16:54:17.118431 [debug] [MainThread]: Flushing usage events
[0m16:59:02.968868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36249a5c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36227b4eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36227b4e50>]}


============================== 16:59:02.977035 | 6c44059c-35d0-4a97-8bda-7ad6569a4d9d ==============================
[0m16:59:02.977035 [info ] [MainThread]: Running with dbt=1.8.9
[0m16:59:02.978795 [debug] [MainThread]: running dbt with arguments {'send_anonymous_usage_stats': 'True', 'introspect': 'True', 'no_print': 'None', 'cache_selected_only': 'False', 'version_check': 'True', 'quiet': 'False', 'target_path': 'None', 'empty': 'None', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'warn_error': 'None', 'invocation_command': 'dbt test --profiles-dir /opt/airflow/include/dbt/', 'static_parser': 'True', 'use_experimental_parser': 'False', 'printer_width': '80', 'use_colors': 'True', 'debug': 'False', 'write_json': 'True', 'indirect_selection': 'eager', 'log_format': 'default', 'fail_fast': 'False', 'partial_parse': 'True', 'profiles_dir': '/opt/airflow/include/dbt/', 'log_path': '/opt/airflow/include/dbt/logs'}
[0m16:59:04.173200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6c44059c-35d0-4a97-8bda-7ad6569a4d9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35f0023ca0>]}
[0m16:59:04.239538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6c44059c-35d0-4a97-8bda-7ad6569a4d9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36227ca2b0>]}
[0m16:59:04.241721 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m16:59:04.411913 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m16:59:05.082773 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m16:59:05.084552 [debug] [MainThread]: Partial parsing: added file: nyc_taxi://models/tests/schema.yml
[0m16:59:05.159594 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m16:59:05.161591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '6c44059c-35d0-4a97-8bda-7ad6569a4d9d', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35eb378ac0>]}
[0m16:59:05.679510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6c44059c-35d0-4a97-8bda-7ad6569a4d9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f361d89cdf0>]}
[0m16:59:05.871240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6c44059c-35d0-4a97-8bda-7ad6569a4d9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f361d6ece20>]}
[0m16:59:05.872547 [info ] [MainThread]: Found 5 models, 28 data tests, 2 sources, 600 macros
[0m16:59:05.873745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6c44059c-35d0-4a97-8bda-7ad6569a4d9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f361d8a34f0>]}
[0m16:59:05.877978 [info ] [MainThread]: 
[0m16:59:05.879465 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:59:05.886543 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_northern-shield-437204-m0_nyc_taxi'
[0m16:59:05.887911 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:59:06.686256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6c44059c-35d0-4a97-8bda-7ad6569a4d9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f361d6ec6d0>]}
[0m16:59:06.688065 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:59:06.689552 [info ] [MainThread]: 
[0m16:59:06.699720 [debug] [Thread-1  ]: Began running node test.nyc_taxi.accepted_values_dim_payment_payment_name__Credit_card__Cash__No_charge__Dispute__Unknown__Voided_trip.58d00ef9f4
[0m16:59:06.700898 [info ] [Thread-1  ]: 1 of 28 START test accepted_values_dim_payment_payment_name__Credit_card__Cash__No_charge__Dispute__Unknown__Voided_trip  [RUN]
[0m16:59:06.702099 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_northern-shield-437204-m0_nyc_taxi, now test.nyc_taxi.accepted_values_dim_payment_payment_name__Credit_card__Cash__No_charge__Dispute__Unknown__Voided_trip.58d00ef9f4)
[0m16:59:06.703144 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.accepted_values_dim_payment_payment_name__Credit_card__Cash__No_charge__Dispute__Unknown__Voided_trip.58d00ef9f4
[0m16:59:06.716170 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.accepted_values_dim_payment_payment_name__Credit_card__Cash__No_charge__Dispute__Unknown__Voided_trip.58d00ef9f4"
[0m16:59:06.734553 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.accepted_values_dim_payment_payment_name__Credit_card__Cash__No_charge__Dispute__Unknown__Voided_trip.58d00ef9f4
[0m16:59:06.765485 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.accepted_values_dim_payment_payment_name__Credit_card__Cash__No_charge__Dispute__Unknown__Voided_trip.58d00ef9f4"
[0m16:59:06.777606 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:59:06.781181 [debug] [Thread-1  ]: On test.nyc_taxi.accepted_values_dim_payment_payment_name__Credit_card__Cash__No_charge__Dispute__Unknown__Voided_trip.58d00ef9f4: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.accepted_values_dim_payment_payment_name__Credit_card__Cash__No_charge__Dispute__Unknown__Voided_trip.58d00ef9f4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        payment_name as value_field,
        count(*) as n_records

    from `northern-shield-437204-m0`.`nyc_taxi`.`dim_payment`
    group by payment_name

)

select *
from all_values
where value_field not in (
    'Credit card','Cash','No charge','Dispute','Unknown','Voided trip'
)



      
    ) dbt_internal_test
[0m16:59:07.851187 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:bed90c11-8471-4c49-a5c8-ccab719fbd03&page=queryresults
[0m16:59:09.068618 [info ] [Thread-1  ]: 1 of 28 PASS accepted_values_dim_payment_payment_name__Credit_card__Cash__No_charge__Dispute__Unknown__Voided_trip  [[32mPASS[0m in 2.37s]
[0m16:59:09.070937 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.accepted_values_dim_payment_payment_name__Credit_card__Cash__No_charge__Dispute__Unknown__Voided_trip.58d00ef9f4
[0m16:59:09.072263 [debug] [Thread-1  ]: Began running node test.nyc_taxi.accepted_values_dim_ratecode_rate_code_name__Standard_rate__JFK__Newark__Nassau_or_Westchester__Negotiated_fare__Group_ride.cd37f9dde4
[0m16:59:09.073455 [info ] [Thread-1  ]: 2 of 28 START test accepted_values_dim_ratecode_rate_code_name__Standard_rate__JFK__Newark__Nassau_or_Westchester__Negotiated_fare__Group_ride  [RUN]
[0m16:59:09.074721 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.accepted_values_dim_payment_payment_name__Credit_card__Cash__No_charge__Dispute__Unknown__Voided_trip.58d00ef9f4, now test.nyc_taxi.accepted_values_dim_ratecode_rate_code_name__Standard_rate__JFK__Newark__Nassau_or_Westchester__Negotiated_fare__Group_ride.cd37f9dde4)
[0m16:59:09.075816 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.accepted_values_dim_ratecode_rate_code_name__Standard_rate__JFK__Newark__Nassau_or_Westchester__Negotiated_fare__Group_ride.cd37f9dde4
[0m16:59:09.082869 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.accepted_values_dim_ratecode_rate_code_name__Standard_rate__JFK__Newark__Nassau_or_Westchester__Negotiated_fare__Group_ride.cd37f9dde4"
[0m16:59:09.089707 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.accepted_values_dim_ratecode_rate_code_name__Standard_rate__JFK__Newark__Nassau_or_Westchester__Negotiated_fare__Group_ride.cd37f9dde4
[0m16:59:09.096171 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.accepted_values_dim_ratecode_rate_code_name__Standard_rate__JFK__Newark__Nassau_or_Westchester__Negotiated_fare__Group_ride.cd37f9dde4"
[0m16:59:09.103179 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:59:09.107663 [debug] [Thread-1  ]: On test.nyc_taxi.accepted_values_dim_ratecode_rate_code_name__Standard_rate__JFK__Newark__Nassau_or_Westchester__Negotiated_fare__Group_ride.cd37f9dde4: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.accepted_values_dim_ratecode_rate_code_name__Standard_rate__JFK__Newark__Nassau_or_Westchester__Negotiated_fare__Group_ride.cd37f9dde4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        rate_code_name as value_field,
        count(*) as n_records

    from `northern-shield-437204-m0`.`nyc_taxi`.`dim_ratecode`
    group by rate_code_name

)

select *
from all_values
where value_field not in (
    'Standard rate','JFK','Newark','Nassau or Westchester','Negotiated fare','Group ride'
)



      
    ) dbt_internal_test
[0m16:59:10.166323 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:16636111-1bc2-48f3-8dc4-6beaa25981b4&page=queryresults
[0m16:59:11.394425 [error] [Thread-1  ]: 2 of 28 FAIL 1 accepted_values_dim_ratecode_rate_code_name__Standard_rate__JFK__Newark__Nassau_or_Westchester__Negotiated_fare__Group_ride  [[31mFAIL 1[0m in 2.32s]
[0m16:59:11.396816 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.accepted_values_dim_ratecode_rate_code_name__Standard_rate__JFK__Newark__Nassau_or_Westchester__Negotiated_fare__Group_ride.cd37f9dde4
[0m16:59:11.398303 [debug] [Thread-1  ]: Began running node test.nyc_taxi.accepted_values_dim_vendor_vendor_name__Creative_Mobile_Technologies__VeriFone_Inc_.7481cecf07
[0m16:59:11.399582 [info ] [Thread-1  ]: 3 of 28 START test accepted_values_dim_vendor_vendor_name__Creative_Mobile_Technologies__VeriFone_Inc_  [RUN]
[0m16:59:11.400927 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.accepted_values_dim_ratecode_rate_code_name__Standard_rate__JFK__Newark__Nassau_or_Westchester__Negotiated_fare__Group_ride.cd37f9dde4, now test.nyc_taxi.accepted_values_dim_vendor_vendor_name__Creative_Mobile_Technologies__VeriFone_Inc_.7481cecf07)
[0m16:59:11.402155 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.accepted_values_dim_vendor_vendor_name__Creative_Mobile_Technologies__VeriFone_Inc_.7481cecf07
[0m16:59:11.409678 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.accepted_values_dim_vendor_vendor_name__Creative_Mobile_Technologies__VeriFone_Inc_.7481cecf07"
[0m16:59:11.420518 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.accepted_values_dim_vendor_vendor_name__Creative_Mobile_Technologies__VeriFone_Inc_.7481cecf07
[0m16:59:11.426498 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.accepted_values_dim_vendor_vendor_name__Creative_Mobile_Technologies__VeriFone_Inc_.7481cecf07"
[0m16:59:11.434575 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:59:11.439126 [debug] [Thread-1  ]: On test.nyc_taxi.accepted_values_dim_vendor_vendor_name__Creative_Mobile_Technologies__VeriFone_Inc_.7481cecf07: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.accepted_values_dim_vendor_vendor_name__Creative_Mobile_Technologies__VeriFone_Inc_.7481cecf07"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        vendor_name as value_field,
        count(*) as n_records

    from `northern-shield-437204-m0`.`nyc_taxi`.`dim_vendor`
    group by vendor_name

)

select *
from all_values
where value_field not in (
    'Creative Mobile Technologies','VeriFone Inc.'
)



      
    ) dbt_internal_test
[0m16:59:12.572596 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:32845f0c-79f0-4201-a126-e8ae2f65d1ca&page=queryresults
[0m16:59:13.801787 [info ] [Thread-1  ]: 3 of 28 PASS accepted_values_dim_vendor_vendor_name__Creative_Mobile_Technologies__VeriFone_Inc_  [[32mPASS[0m in 2.40s]
[0m16:59:13.803943 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.accepted_values_dim_vendor_vendor_name__Creative_Mobile_Technologies__VeriFone_Inc_.7481cecf07
[0m16:59:13.805317 [debug] [Thread-1  ]: Began running node test.nyc_taxi.conditional_values_fct_trips_fare_amount__fare_amount_0.601dd94b78
[0m16:59:13.806277 [info ] [Thread-1  ]: 4 of 28 START test conditional_values_fct_trips_fare_amount__fare_amount_0 ..... [RUN]
[0m16:59:13.807401 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.accepted_values_dim_vendor_vendor_name__Creative_Mobile_Technologies__VeriFone_Inc_.7481cecf07, now test.nyc_taxi.conditional_values_fct_trips_fare_amount__fare_amount_0.601dd94b78)
[0m16:59:13.808344 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.conditional_values_fct_trips_fare_amount__fare_amount_0.601dd94b78
[0m16:59:13.826394 [debug] [Thread-1  ]: Compilation Error in test conditional_values_fct_trips_fare_amount__fare_amount_0 (models/tests/schema.yml)
  'test_conditional_values' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m16:59:13.827810 [error] [Thread-1  ]: 4 of 28 ERROR conditional_values_fct_trips_fare_amount__fare_amount_0 .......... [[31mERROR[0m in 0.02s]
[0m16:59:13.829234 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.conditional_values_fct_trips_fare_amount__fare_amount_0.601dd94b78
[0m16:59:13.830351 [debug] [Thread-1  ]: Began running node test.nyc_taxi.conditional_values_fct_trips_mta_tax__mta_tax_0.30d75bfd69
[0m16:59:13.831501 [info ] [Thread-1  ]: 5 of 28 START test conditional_values_fct_trips_mta_tax__mta_tax_0 ............. [RUN]
[0m16:59:13.832723 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.conditional_values_fct_trips_fare_amount__fare_amount_0.601dd94b78, now test.nyc_taxi.conditional_values_fct_trips_mta_tax__mta_tax_0.30d75bfd69)
[0m16:59:13.833879 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.conditional_values_fct_trips_mta_tax__mta_tax_0.30d75bfd69
[0m16:59:13.841492 [debug] [Thread-1  ]: Compilation Error in test conditional_values_fct_trips_mta_tax__mta_tax_0 (models/tests/schema.yml)
  'test_conditional_values' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m16:59:13.843082 [error] [Thread-1  ]: 5 of 28 ERROR conditional_values_fct_trips_mta_tax__mta_tax_0 .................. [[31mERROR[0m in 0.01s]
[0m16:59:13.844606 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.conditional_values_fct_trips_mta_tax__mta_tax_0.30d75bfd69
[0m16:59:13.845773 [debug] [Thread-1  ]: Began running node test.nyc_taxi.conditional_values_fct_trips_tip_amount__tip_amount_0.23d91eab9c
[0m16:59:13.846829 [info ] [Thread-1  ]: 6 of 28 START test conditional_values_fct_trips_tip_amount__tip_amount_0 ....... [RUN]
[0m16:59:13.847932 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.conditional_values_fct_trips_mta_tax__mta_tax_0.30d75bfd69, now test.nyc_taxi.conditional_values_fct_trips_tip_amount__tip_amount_0.23d91eab9c)
[0m16:59:13.848914 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.conditional_values_fct_trips_tip_amount__tip_amount_0.23d91eab9c
[0m16:59:13.859210 [debug] [Thread-1  ]: Compilation Error in test conditional_values_fct_trips_tip_amount__tip_amount_0 (models/tests/schema.yml)
  'test_conditional_values' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m16:59:13.860899 [error] [Thread-1  ]: 6 of 28 ERROR conditional_values_fct_trips_tip_amount__tip_amount_0 ............ [[31mERROR[0m in 0.01s]
[0m16:59:13.862610 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.conditional_values_fct_trips_tip_amount__tip_amount_0.23d91eab9c
[0m16:59:13.863962 [debug] [Thread-1  ]: Began running node test.nyc_taxi.conditional_values_fct_trips_tolls_amount__tolls_amount_0.442a450561
[0m16:59:13.865182 [info ] [Thread-1  ]: 7 of 28 START test conditional_values_fct_trips_tolls_amount__tolls_amount_0 ... [RUN]
[0m16:59:13.866395 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.conditional_values_fct_trips_tip_amount__tip_amount_0.23d91eab9c, now test.nyc_taxi.conditional_values_fct_trips_tolls_amount__tolls_amount_0.442a450561)
[0m16:59:13.867389 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.conditional_values_fct_trips_tolls_amount__tolls_amount_0.442a450561
[0m16:59:13.874765 [debug] [Thread-1  ]: Compilation Error in test conditional_values_fct_trips_tolls_amount__tolls_amount_0 (models/tests/schema.yml)
  'test_conditional_values' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m16:59:13.876469 [error] [Thread-1  ]: 7 of 28 ERROR conditional_values_fct_trips_tolls_amount__tolls_amount_0 ........ [[31mERROR[0m in 0.01s]
[0m16:59:13.878131 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.conditional_values_fct_trips_tolls_amount__tolls_amount_0.442a450561
[0m16:59:13.879414 [debug] [Thread-1  ]: Began running node test.nyc_taxi.conditional_values_fct_trips_total_amount__total_amount_0.1651aaaa37
[0m16:59:13.880653 [info ] [Thread-1  ]: 8 of 28 START test conditional_values_fct_trips_total_amount__total_amount_0 ... [RUN]
[0m16:59:13.881767 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.conditional_values_fct_trips_tolls_amount__tolls_amount_0.442a450561, now test.nyc_taxi.conditional_values_fct_trips_total_amount__total_amount_0.1651aaaa37)
[0m16:59:13.882720 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.conditional_values_fct_trips_total_amount__total_amount_0.1651aaaa37
[0m16:59:13.889703 [debug] [Thread-1  ]: Compilation Error in test conditional_values_fct_trips_total_amount__total_amount_0 (models/tests/schema.yml)
  'test_conditional_values' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m16:59:13.891256 [error] [Thread-1  ]: 8 of 28 ERROR conditional_values_fct_trips_total_amount__total_amount_0 ........ [[31mERROR[0m in 0.01s]
[0m16:59:13.893289 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.conditional_values_fct_trips_total_amount__total_amount_0.1651aaaa37
[0m16:59:13.894931 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_dim_payment_type_id.96dfa722aa
[0m16:59:13.896161 [info ] [Thread-1  ]: 9 of 28 START test not_null_dim_payment_type_id ................................ [RUN]
[0m16:59:13.897628 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.conditional_values_fct_trips_total_amount__total_amount_0.1651aaaa37, now test.nyc_taxi.not_null_dim_payment_type_id.96dfa722aa)
[0m16:59:13.898720 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_dim_payment_type_id.96dfa722aa
[0m16:59:13.909627 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_dim_payment_type_id.96dfa722aa"
[0m16:59:13.917638 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_dim_payment_type_id.96dfa722aa
[0m16:59:13.923018 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_dim_payment_type_id.96dfa722aa"
[0m16:59:13.930638 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:59:13.934615 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_dim_payment_type_id.96dfa722aa: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_dim_payment_type_id.96dfa722aa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select type_id
from `northern-shield-437204-m0`.`nyc_taxi`.`dim_payment`
where type_id is null



      
    ) dbt_internal_test
[0m16:59:14.973610 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:b771607c-15fe-43d3-ad53-3b605cd29c06&page=queryresults
[0m16:59:16.188702 [info ] [Thread-1  ]: 9 of 28 PASS not_null_dim_payment_type_id ...................................... [[32mPASS[0m in 2.29s]
[0m16:59:16.190923 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_dim_payment_type_id.96dfa722aa
[0m16:59:16.192303 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_dim_zone_borough.1ed2272c52
[0m16:59:16.193571 [info ] [Thread-1  ]: 10 of 28 START test not_null_dim_zone_borough .................................. [RUN]
[0m16:59:16.195171 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_dim_payment_type_id.96dfa722aa, now test.nyc_taxi.not_null_dim_zone_borough.1ed2272c52)
[0m16:59:16.196527 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_dim_zone_borough.1ed2272c52
[0m16:59:16.205745 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_dim_zone_borough.1ed2272c52"
[0m16:59:16.212587 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_dim_zone_borough.1ed2272c52
[0m16:59:16.217738 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_dim_zone_borough.1ed2272c52"
[0m16:59:16.223858 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:59:16.228349 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_dim_zone_borough.1ed2272c52: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_dim_zone_borough.1ed2272c52"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select borough
from `northern-shield-437204-m0`.`nyc_taxi`.`dim_zone`
where borough is null



      
    ) dbt_internal_test
[0m16:59:15.444273 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:487b129a-f54d-4f76-8d4d-b44154a2e2a8&page=queryresults
[0m16:59:17.320065 [error] [Thread-1  ]: 10 of 28 FAIL 2 not_null_dim_zone_borough ...................................... [[31mFAIL 2[0m in 1.12s]
[0m16:59:17.322529 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_dim_zone_borough.1ed2272c52
[0m16:59:17.324068 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_dim_zone_service_zone.2007f611c5
[0m16:59:17.325185 [info ] [Thread-1  ]: 11 of 28 START test not_null_dim_zone_service_zone ............................. [RUN]
[0m16:59:17.326541 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_dim_zone_borough.1ed2272c52, now test.nyc_taxi.not_null_dim_zone_service_zone.2007f611c5)
[0m16:59:17.327573 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_dim_zone_service_zone.2007f611c5
[0m16:59:17.333906 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_dim_zone_service_zone.2007f611c5"
[0m16:59:17.346782 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_dim_zone_service_zone.2007f611c5
[0m16:59:17.352012 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_dim_zone_service_zone.2007f611c5"
[0m16:59:17.357842 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:59:17.361236 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_dim_zone_service_zone.2007f611c5: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_dim_zone_service_zone.2007f611c5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select service_zone
from `northern-shield-437204-m0`.`nyc_taxi`.`dim_zone`
where service_zone is null



      
    ) dbt_internal_test
[0m16:59:18.239082 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:19c447ed-b0a2-4c43-8f5c-7683ef9fd25d&page=queryresults
[0m16:59:19.413510 [error] [Thread-1  ]: 11 of 28 FAIL 2 not_null_dim_zone_service_zone ................................. [[31mFAIL 2[0m in 2.09s]
[0m16:59:19.415905 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_dim_zone_service_zone.2007f611c5
[0m16:59:19.417784 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_dim_zone_zone.a1c4a4c37a
[0m16:59:19.419359 [info ] [Thread-1  ]: 12 of 28 START test not_null_dim_zone_zone ..................................... [RUN]
[0m16:59:19.421010 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_dim_zone_service_zone.2007f611c5, now test.nyc_taxi.not_null_dim_zone_zone.a1c4a4c37a)
[0m16:59:19.422377 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_dim_zone_zone.a1c4a4c37a
[0m16:59:19.431184 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_dim_zone_zone.a1c4a4c37a"
[0m16:59:19.437797 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_dim_zone_zone.a1c4a4c37a
[0m16:59:19.445056 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_dim_zone_zone.a1c4a4c37a"
[0m16:59:19.450817 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:59:19.455280 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_dim_zone_zone.a1c4a4c37a: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_dim_zone_zone.a1c4a4c37a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select zone
from `northern-shield-437204-m0`.`nyc_taxi`.`dim_zone`
where zone is null



      
    ) dbt_internal_test
[0m16:59:20.327893 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:570a037d-14d9-4f9b-8ffc-645ec6c0e0a5&page=queryresults
[0m16:59:21.457160 [info ] [Thread-1  ]: 12 of 28 PASS not_null_dim_zone_zone ........................................... [[32mPASS[0m in 2.04s]
[0m16:59:21.459452 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_dim_zone_zone.a1c4a4c37a
[0m16:59:21.461260 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_do_location_id.6acdd302a6
[0m16:59:21.462580 [info ] [Thread-1  ]: 13 of 28 START test not_null_fct_trips_do_location_id .......................... [RUN]
[0m16:59:21.464195 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_dim_zone_zone.a1c4a4c37a, now test.nyc_taxi.not_null_fct_trips_do_location_id.6acdd302a6)
[0m16:59:21.465554 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_do_location_id.6acdd302a6
[0m16:59:21.473582 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_do_location_id.6acdd302a6"
[0m16:59:21.480183 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_do_location_id.6acdd302a6
[0m16:59:21.485250 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_fct_trips_do_location_id.6acdd302a6"
[0m16:59:21.491526 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:59:21.494953 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_fct_trips_do_location_id.6acdd302a6: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_fct_trips_do_location_id.6acdd302a6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select do_location_id
from `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips`
where do_location_id is null



      
    ) dbt_internal_test
[0m16:59:22.409532 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:5fb44727-1d07-4a52-b110-39f93f6d77dc&page=queryresults
[0m16:59:23.612909 [info ] [Thread-1  ]: 13 of 28 PASS not_null_fct_trips_do_location_id ................................ [[32mPASS[0m in 2.15s]
[0m16:59:23.615466 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_do_location_id.6acdd302a6
[0m16:59:23.617383 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_dropoff_time.04b71dc609
[0m16:59:23.618630 [info ] [Thread-1  ]: 14 of 28 START test not_null_fct_trips_dropoff_time ............................ [RUN]
[0m16:59:23.620075 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_do_location_id.6acdd302a6, now test.nyc_taxi.not_null_fct_trips_dropoff_time.04b71dc609)
[0m16:59:23.621396 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_dropoff_time.04b71dc609
[0m16:59:23.629464 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_dropoff_time.04b71dc609"
[0m16:59:23.634798 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_dropoff_time.04b71dc609
[0m16:59:23.639196 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_fct_trips_dropoff_time.04b71dc609"
[0m16:59:23.645593 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:59:23.649446 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_fct_trips_dropoff_time.04b71dc609: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_fct_trips_dropoff_time.04b71dc609"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select dropoff_time
from `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips`
where dropoff_time is null



      
    ) dbt_internal_test
[0m16:59:24.647447 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:5caeb41b-c19e-4e85-87dc-dd0c2b81a8a6&page=queryresults
[0m16:59:25.817678 [info ] [Thread-1  ]: 14 of 28 PASS not_null_fct_trips_dropoff_time .................................. [[32mPASS[0m in 2.20s]
[0m16:59:25.820027 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_dropoff_time.04b71dc609
[0m16:59:25.824187 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_extra.1801055bb3
[0m16:59:25.825472 [info ] [Thread-1  ]: 15 of 28 START test not_null_fct_trips_extra ................................... [RUN]
[0m16:59:25.827090 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_dropoff_time.04b71dc609, now test.nyc_taxi.not_null_fct_trips_extra.1801055bb3)
[0m16:59:25.828428 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_extra.1801055bb3
[0m16:59:25.836073 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_extra.1801055bb3"
[0m16:59:25.842394 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_extra.1801055bb3
[0m16:59:25.846850 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_fct_trips_extra.1801055bb3"
[0m16:59:25.854026 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:59:25.857745 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_fct_trips_extra.1801055bb3: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_fct_trips_extra.1801055bb3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select extra
from `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips`
where extra is null



      
    ) dbt_internal_test
[0m16:59:26.753758 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:ac5e2a10-7116-4b86-a919-8a24299fc90d&page=queryresults
[0m16:59:27.937341 [info ] [Thread-1  ]: 15 of 28 PASS not_null_fct_trips_extra ......................................... [[32mPASS[0m in 2.11s]
[0m16:59:27.939709 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_extra.1801055bb3
[0m16:59:27.941374 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_improvement_surcharge.4cf28d1443
[0m16:59:27.942679 [info ] [Thread-1  ]: 16 of 28 START test not_null_fct_trips_improvement_surcharge ................... [RUN]
[0m16:59:27.944140 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_extra.1801055bb3, now test.nyc_taxi.not_null_fct_trips_improvement_surcharge.4cf28d1443)
[0m16:59:27.945514 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_improvement_surcharge.4cf28d1443
[0m16:59:27.953349 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_improvement_surcharge.4cf28d1443"
[0m16:59:27.958984 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_improvement_surcharge.4cf28d1443
[0m16:59:27.963322 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_fct_trips_improvement_surcharge.4cf28d1443"
[0m16:59:27.970001 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:59:27.973548 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_fct_trips_improvement_surcharge.4cf28d1443: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_fct_trips_improvement_surcharge.4cf28d1443"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select improvement_surcharge
from `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips`
where improvement_surcharge is null



      
    ) dbt_internal_test
[0m16:59:28.936494 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:0260770d-fcab-4122-8bea-af13f94ee46d&page=queryresults
[0m16:59:30.134303 [info ] [Thread-1  ]: 16 of 28 PASS not_null_fct_trips_improvement_surcharge ......................... [[32mPASS[0m in 2.19s]
[0m16:59:30.136670 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_improvement_surcharge.4cf28d1443
[0m16:59:30.138447 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_passenger_count.b1370cab1c
[0m16:59:30.139835 [info ] [Thread-1  ]: 17 of 28 START test not_null_fct_trips_passenger_count ......................... [RUN]
[0m16:59:30.141291 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_improvement_surcharge.4cf28d1443, now test.nyc_taxi.not_null_fct_trips_passenger_count.b1370cab1c)
[0m16:59:30.142658 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_passenger_count.b1370cab1c
[0m16:59:30.152662 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_passenger_count.b1370cab1c"
[0m16:59:30.165646 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_passenger_count.b1370cab1c
[0m16:59:30.170404 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_fct_trips_passenger_count.b1370cab1c"
[0m16:59:30.177568 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:59:30.181783 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_fct_trips_passenger_count.b1370cab1c: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_fct_trips_passenger_count.b1370cab1c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select passenger_count
from `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips`
where passenger_count is null



      
    ) dbt_internal_test
[0m16:59:31.080542 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:28fec041-aa6d-4df0-808b-14ea8d6c0ab2&page=queryresults
[0m16:59:32.201583 [info ] [Thread-1  ]: 17 of 28 PASS not_null_fct_trips_passenger_count ............................... [[32mPASS[0m in 2.06s]
[0m16:59:32.203897 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_passenger_count.b1370cab1c
[0m16:59:32.205463 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_payment_type.93889b679a
[0m16:59:32.206773 [info ] [Thread-1  ]: 18 of 28 START test not_null_fct_trips_payment_type ............................ [RUN]
[0m16:59:32.208411 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_passenger_count.b1370cab1c, now test.nyc_taxi.not_null_fct_trips_payment_type.93889b679a)
[0m16:59:32.209713 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_payment_type.93889b679a
[0m16:59:32.218062 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_payment_type.93889b679a"
[0m16:59:32.223684 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_payment_type.93889b679a
[0m16:59:32.228236 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_fct_trips_payment_type.93889b679a"
[0m16:59:32.234393 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:59:32.237600 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_fct_trips_payment_type.93889b679a: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_fct_trips_payment_type.93889b679a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select payment_type
from `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips`
where payment_type is null



      
    ) dbt_internal_test
[0m16:59:33.110326 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:8fac1119-2107-4960-9e78-084a40970798&page=queryresults
[0m16:59:34.250766 [info ] [Thread-1  ]: 18 of 28 PASS not_null_fct_trips_payment_type .................................. [[32mPASS[0m in 2.04s]
[0m16:59:34.253319 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_payment_type.93889b679a
[0m16:59:34.254944 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_pickup_time.693af2bf31
[0m16:59:34.256409 [info ] [Thread-1  ]: 19 of 28 START test not_null_fct_trips_pickup_time ............................. [RUN]
[0m16:59:34.257824 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_payment_type.93889b679a, now test.nyc_taxi.not_null_fct_trips_pickup_time.693af2bf31)
[0m16:59:34.259189 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_pickup_time.693af2bf31
[0m16:59:34.267298 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_pickup_time.693af2bf31"
[0m16:59:34.273801 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_pickup_time.693af2bf31
[0m16:59:34.278511 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_fct_trips_pickup_time.693af2bf31"
[0m16:59:34.285276 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:59:34.289112 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_fct_trips_pickup_time.693af2bf31: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_fct_trips_pickup_time.693af2bf31"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select pickup_time
from `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips`
where pickup_time is null



      
    ) dbt_internal_test
[0m16:59:35.206146 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:4d8872b2-26c6-4169-bc44-44eb421291a6&page=queryresults
[0m16:59:36.343468 [info ] [Thread-1  ]: 19 of 28 PASS not_null_fct_trips_pickup_time ................................... [[32mPASS[0m in 2.09s]
[0m16:59:36.345715 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_pickup_time.693af2bf31
[0m16:59:36.347365 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_pu_location_id.b0dc8dd185
[0m16:59:36.348639 [info ] [Thread-1  ]: 20 of 28 START test not_null_fct_trips_pu_location_id .......................... [RUN]
[0m16:59:36.350029 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_pickup_time.693af2bf31, now test.nyc_taxi.not_null_fct_trips_pu_location_id.b0dc8dd185)
[0m16:59:36.351330 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_pu_location_id.b0dc8dd185
[0m16:59:36.358902 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_pu_location_id.b0dc8dd185"
[0m16:59:36.366491 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_pu_location_id.b0dc8dd185
[0m16:59:36.371378 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_fct_trips_pu_location_id.b0dc8dd185"
[0m16:59:36.377656 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:59:36.381173 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_fct_trips_pu_location_id.b0dc8dd185: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_fct_trips_pu_location_id.b0dc8dd185"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select pu_location_id
from `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips`
where pu_location_id is null



      
    ) dbt_internal_test
[0m16:59:37.242775 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:60c1aae8-abea-4f20-9475-f9c1218c48e2&page=queryresults
[0m16:59:38.395611 [info ] [Thread-1  ]: 20 of 28 PASS not_null_fct_trips_pu_location_id ................................ [[32mPASS[0m in 2.05s]
[0m16:59:38.397964 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_pu_location_id.b0dc8dd185
[0m16:59:38.400000 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_rate_code_id.ba0047eaae
[0m16:59:38.401243 [info ] [Thread-1  ]: 21 of 28 START test not_null_fct_trips_rate_code_id ............................ [RUN]
[0m16:59:38.402425 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_pu_location_id.b0dc8dd185, now test.nyc_taxi.not_null_fct_trips_rate_code_id.ba0047eaae)
[0m16:59:38.403494 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_rate_code_id.ba0047eaae
[0m16:59:38.410488 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_rate_code_id.ba0047eaae"
[0m16:59:38.416773 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_rate_code_id.ba0047eaae
[0m16:59:38.421504 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_fct_trips_rate_code_id.ba0047eaae"
[0m16:59:38.428082 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:59:38.432509 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_fct_trips_rate_code_id.ba0047eaae: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_fct_trips_rate_code_id.ba0047eaae"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select rate_code_id
from `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips`
where rate_code_id is null



      
    ) dbt_internal_test
[0m16:59:39.425903 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:c07883a9-3bee-4c75-a242-c6f6403dc104&page=queryresults
[0m16:59:40.634469 [info ] [Thread-1  ]: 21 of 28 PASS not_null_fct_trips_rate_code_id .................................. [[32mPASS[0m in 2.23s]
[0m16:59:40.636831 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_rate_code_id.ba0047eaae
[0m16:59:40.638317 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_trip_distance.19cd17f1df
[0m16:59:40.639462 [info ] [Thread-1  ]: 22 of 28 START test not_null_fct_trips_trip_distance ........................... [RUN]
[0m16:59:40.640922 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_rate_code_id.ba0047eaae, now test.nyc_taxi.not_null_fct_trips_trip_distance.19cd17f1df)
[0m16:59:40.641962 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_trip_distance.19cd17f1df
[0m16:59:40.651123 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_trip_distance.19cd17f1df"
[0m16:59:40.657902 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_trip_distance.19cd17f1df
[0m16:59:40.662926 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_fct_trips_trip_distance.19cd17f1df"
[0m16:59:40.675729 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:59:40.681007 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_fct_trips_trip_distance.19cd17f1df: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_fct_trips_trip_distance.19cd17f1df"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select trip_distance
from `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips`
where trip_distance is null



      
    ) dbt_internal_test
[0m16:59:41.752486 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:cfa44376-cc28-4d44-857d-e9871265e2ce&page=queryresults
[0m16:59:42.972225 [info ] [Thread-1  ]: 22 of 28 PASS not_null_fct_trips_trip_distance ................................. [[32mPASS[0m in 2.33s]
[0m16:59:42.974268 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_trip_distance.19cd17f1df
[0m16:59:42.975567 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_vendor_id.b9b2f380bb
[0m16:59:42.976630 [info ] [Thread-1  ]: 23 of 28 START test not_null_fct_trips_vendor_id ............................... [RUN]
[0m16:59:42.977989 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_trip_distance.19cd17f1df, now test.nyc_taxi.not_null_fct_trips_vendor_id.b9b2f380bb)
[0m16:59:42.979127 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_vendor_id.b9b2f380bb
[0m16:59:42.986399 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_vendor_id.b9b2f380bb"
[0m16:59:42.992166 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_vendor_id.b9b2f380bb
[0m16:59:42.997303 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_fct_trips_vendor_id.b9b2f380bb"
[0m16:59:43.003827 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:59:43.008044 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_fct_trips_vendor_id.b9b2f380bb: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_fct_trips_vendor_id.b9b2f380bb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select vendor_id
from `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips`
where vendor_id is null



      
    ) dbt_internal_test
[0m16:59:44.214721 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:27007acf-772e-49b7-92b5-360177ab2d0a&page=queryresults
[0m16:59:43.691381 [info ] [Thread-1  ]: 23 of 28 PASS not_null_fct_trips_vendor_id ..................................... [[32mPASS[0m in 0.71s]
[0m16:59:43.693739 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_vendor_id.b9b2f380bb
[0m16:59:43.695346 [debug] [Thread-1  ]: Began running node test.nyc_taxi.unique_dim_payment_type_id.dea55de04e
[0m16:59:43.696793 [info ] [Thread-1  ]: 24 of 28 START test unique_dim_payment_type_id ................................. [RUN]
[0m16:59:43.698446 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_vendor_id.b9b2f380bb, now test.nyc_taxi.unique_dim_payment_type_id.dea55de04e)
[0m16:59:43.699607 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.unique_dim_payment_type_id.dea55de04e
[0m16:59:43.709719 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.unique_dim_payment_type_id.dea55de04e"
[0m16:59:43.716475 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.unique_dim_payment_type_id.dea55de04e
[0m16:59:43.721217 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.unique_dim_payment_type_id.dea55de04e"
[0m16:59:43.734281 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:59:43.738009 [debug] [Thread-1  ]: On test.nyc_taxi.unique_dim_payment_type_id.dea55de04e: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.unique_dim_payment_type_id.dea55de04e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select type_id as unique_field
  from `northern-shield-437204-m0`.`nyc_taxi`.`dim_payment`
  where type_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m16:59:44.750852 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:6edd39ce-0ad7-4946-be31-657f5f811425&page=queryresults
[0m16:59:45.870855 [info ] [Thread-1  ]: 24 of 28 PASS unique_dim_payment_type_id ....................................... [[32mPASS[0m in 2.17s]
[0m16:59:45.873042 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.unique_dim_payment_type_id.dea55de04e
[0m16:59:45.874495 [debug] [Thread-1  ]: Began running node test.nyc_taxi.unique_dim_ratecode_rate_id.75ae8e4885
[0m16:59:45.875643 [info ] [Thread-1  ]: 25 of 28 START test unique_dim_ratecode_rate_id ................................ [RUN]
[0m16:59:45.877056 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.unique_dim_payment_type_id.dea55de04e, now test.nyc_taxi.unique_dim_ratecode_rate_id.75ae8e4885)
[0m16:59:45.878171 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.unique_dim_ratecode_rate_id.75ae8e4885
[0m16:59:45.884948 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.unique_dim_ratecode_rate_id.75ae8e4885"
[0m16:59:45.890712 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.unique_dim_ratecode_rate_id.75ae8e4885
[0m16:59:45.895779 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.unique_dim_ratecode_rate_id.75ae8e4885"
[0m16:59:45.901876 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:59:45.905773 [debug] [Thread-1  ]: On test.nyc_taxi.unique_dim_ratecode_rate_id.75ae8e4885: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.unique_dim_ratecode_rate_id.75ae8e4885"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select rate_id as unique_field
  from `northern-shield-437204-m0`.`nyc_taxi`.`dim_ratecode`
  where rate_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m16:59:46.821482 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:cd98b551-afb3-4bdb-8e01-87ddd10c5fa6&page=queryresults
[0m16:59:47.921710 [info ] [Thread-1  ]: 25 of 28 PASS unique_dim_ratecode_rate_id ...................................... [[32mPASS[0m in 2.04s]
[0m16:59:47.923972 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.unique_dim_ratecode_rate_id.75ae8e4885
[0m16:59:47.925462 [debug] [Thread-1  ]: Began running node test.nyc_taxi.unique_dim_vendor_id.03fad38d04
[0m16:59:47.926532 [info ] [Thread-1  ]: 26 of 28 START test unique_dim_vendor_id ....................................... [RUN]
[0m16:59:47.927800 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.unique_dim_ratecode_rate_id.75ae8e4885, now test.nyc_taxi.unique_dim_vendor_id.03fad38d04)
[0m16:59:47.928849 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.unique_dim_vendor_id.03fad38d04
[0m16:59:47.935415 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.unique_dim_vendor_id.03fad38d04"
[0m16:59:47.941472 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.unique_dim_vendor_id.03fad38d04
[0m16:59:47.947365 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.unique_dim_vendor_id.03fad38d04"
[0m16:59:47.959543 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:59:47.963359 [debug] [Thread-1  ]: On test.nyc_taxi.unique_dim_vendor_id.03fad38d04: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.unique_dim_vendor_id.03fad38d04"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select id as unique_field
  from `northern-shield-437204-m0`.`nyc_taxi`.`dim_vendor`
  where id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m16:59:48.937531 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:939f4e3c-173c-4b7c-8fe7-96509127be15&page=queryresults
[0m16:59:50.115948 [info ] [Thread-1  ]: 26 of 28 PASS unique_dim_vendor_id ............................................. [[32mPASS[0m in 2.19s]
[0m16:59:50.118336 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.unique_dim_vendor_id.03fad38d04
[0m16:59:50.119932 [debug] [Thread-1  ]: Began running node test.nyc_taxi.unique_dim_zone_location_id.7702f92424
[0m16:59:50.121107 [info ] [Thread-1  ]: 27 of 28 START test unique_dim_zone_location_id ................................ [RUN]
[0m16:59:50.122650 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.unique_dim_vendor_id.03fad38d04, now test.nyc_taxi.unique_dim_zone_location_id.7702f92424)
[0m16:59:50.123939 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.unique_dim_zone_location_id.7702f92424
[0m16:59:50.133254 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.unique_dim_zone_location_id.7702f92424"
[0m16:59:50.145766 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.unique_dim_zone_location_id.7702f92424
[0m16:59:50.151048 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.unique_dim_zone_location_id.7702f92424"
[0m16:59:50.156445 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:59:50.160119 [debug] [Thread-1  ]: On test.nyc_taxi.unique_dim_zone_location_id.7702f92424: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.unique_dim_zone_location_id.7702f92424"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select location_id as unique_field
  from `northern-shield-437204-m0`.`nyc_taxi`.`dim_zone`
  where location_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m16:59:51.528069 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:16918e87-f5ff-4b6f-8557-764613597224&page=queryresults
[0m16:59:52.664814 [error] [Thread-1  ]: 27 of 28 FAIL 1 unique_dim_zone_location_id .................................... [[31mFAIL 1[0m in 2.54s]
[0m16:59:52.667096 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.unique_dim_zone_location_id.7702f92424
[0m16:59:52.668512 [debug] [Thread-1  ]: Began running node test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab
[0m16:59:52.669605 [info ] [Thread-1  ]: 28 of 28 START test unique_fct_trips_trip_id ................................... [RUN]
[0m16:59:52.670776 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.unique_dim_zone_location_id.7702f92424, now test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab)
[0m16:59:52.671738 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab
[0m16:59:52.679046 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab"
[0m16:59:52.685614 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab
[0m16:59:52.690580 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab"
[0m16:59:52.696526 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:59:52.699984 [debug] [Thread-1  ]: On test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select trip_id as unique_field
  from `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips`
  where trip_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m16:59:53.775169 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:57cf8c73-e1e3-426c-81ee-3931ebf639f4&page=queryresults
[0m16:59:54.923173 [info ] [Thread-1  ]: 28 of 28 PASS unique_fct_trips_trip_id ......................................... [[32mPASS[0m in 2.25s]
[0m16:59:54.925474 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab
[0m16:59:54.928642 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:59:54.929711 [debug] [MainThread]: Connection 'test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab' was properly closed.
[0m16:59:54.930901 [info ] [MainThread]: 
[0m16:59:54.932209 [info ] [MainThread]: Finished running 28 data tests in 0 hours 0 minutes and 49.05 seconds (49.05s).
[0m16:59:54.943362 [debug] [MainThread]: Command end result
[0m16:59:55.023265 [info ] [MainThread]: 
[0m16:59:55.024841 [info ] [MainThread]: [31mCompleted with 9 errors and 0 warnings:[0m
[0m16:59:55.025982 [info ] [MainThread]: 
[0m16:59:55.027231 [error] [MainThread]: [31mFailure in test accepted_values_dim_ratecode_rate_code_name__Standard_rate__JFK__Newark__Nassau_or_Westchester__Negotiated_fare__Group_ride (models/tests/schema.yml)[0m
[0m16:59:55.028405 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m16:59:55.029576 [info ] [MainThread]: 
[0m16:59:55.030717 [info ] [MainThread]:   compiled code at target/compiled/nyc_taxi/models/tests/schema.yml/accepted_values_dim_ratecode_7d19c2e014954582ac1e6dfdf64a978d.sql
[0m16:59:55.031818 [info ] [MainThread]: 
[0m16:59:55.032940 [error] [MainThread]:   Compilation Error in test conditional_values_fct_trips_fare_amount__fare_amount_0 (models/tests/schema.yml)
  'test_conditional_values' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m16:59:55.033914 [info ] [MainThread]: 
[0m16:59:55.035086 [error] [MainThread]:   Compilation Error in test conditional_values_fct_trips_mta_tax__mta_tax_0 (models/tests/schema.yml)
  'test_conditional_values' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m16:59:55.036017 [info ] [MainThread]: 
[0m16:59:55.037187 [error] [MainThread]:   Compilation Error in test conditional_values_fct_trips_tip_amount__tip_amount_0 (models/tests/schema.yml)
  'test_conditional_values' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m16:59:55.038249 [info ] [MainThread]: 
[0m16:59:55.039361 [error] [MainThread]:   Compilation Error in test conditional_values_fct_trips_tolls_amount__tolls_amount_0 (models/tests/schema.yml)
  'test_conditional_values' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m16:59:55.040488 [info ] [MainThread]: 
[0m16:59:55.041775 [error] [MainThread]:   Compilation Error in test conditional_values_fct_trips_total_amount__total_amount_0 (models/tests/schema.yml)
  'test_conditional_values' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m16:59:55.042761 [info ] [MainThread]: 
[0m16:59:55.043922 [error] [MainThread]: [31mFailure in test not_null_dim_zone_borough (models/tests/schema.yml)[0m
[0m16:59:55.045069 [error] [MainThread]:   Got 2 results, configured to fail if != 0
[0m16:59:55.046029 [info ] [MainThread]: 
[0m16:59:55.047062 [info ] [MainThread]:   compiled code at target/compiled/nyc_taxi/models/tests/schema.yml/not_null_dim_zone_borough.sql
[0m16:59:55.048009 [info ] [MainThread]: 
[0m16:59:55.049160 [error] [MainThread]: [31mFailure in test not_null_dim_zone_service_zone (models/tests/schema.yml)[0m
[0m16:59:55.050250 [error] [MainThread]:   Got 2 results, configured to fail if != 0
[0m16:59:55.051210 [info ] [MainThread]: 
[0m16:59:55.052243 [info ] [MainThread]:   compiled code at target/compiled/nyc_taxi/models/tests/schema.yml/not_null_dim_zone_service_zone.sql
[0m16:59:55.053179 [info ] [MainThread]: 
[0m16:59:55.054435 [error] [MainThread]: [31mFailure in test unique_dim_zone_location_id (models/tests/schema.yml)[0m
[0m16:59:55.055628 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m16:59:55.056653 [info ] [MainThread]: 
[0m16:59:55.057780 [info ] [MainThread]:   compiled code at target/compiled/nyc_taxi/models/tests/schema.yml/unique_dim_zone_location_id.sql
[0m16:59:55.059118 [info ] [MainThread]: 
[0m16:59:55.060262 [info ] [MainThread]: Done. PASS=19 WARN=0 ERROR=9 SKIP=0 TOTAL=28
[0m16:59:55.062172 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 55.59533, "process_in_blocks": "200", "process_kernel_time": 0.419823, "process_mem_max_rss": "244528", "process_out_blocks": "0", "process_user_time": 6.847783}
[0m16:59:55.063416 [debug] [MainThread]: Command `dbt test` failed at 16:59:55.063255 after 55.60 seconds
[0m16:59:55.064525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36249a5c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3623fc7c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3622eebd90>]}
[0m16:59:55.065420 [debug] [MainThread]: Flushing usage events
[0m17:01:32.695972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe40cb0bc40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe40bc8beb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe40a99fd90>]}


============================== 17:01:32.703617 | 7d50c03c-9007-424a-8294-3203be4dc487 ==============================
[0m17:01:32.703617 [info ] [MainThread]: Running with dbt=1.8.9
[0m17:01:32.705347 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'introspect': 'True', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'log_path': '/opt/airflow/include/dbt/logs', 'quiet': 'False', 'no_print': 'None', 'debug': 'False', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/include/dbt/', 'profiles_dir': '/opt/airflow/include/dbt/', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'empty': 'False', 'write_json': 'True', 'use_colors': 'True', 'log_format': 'default', 'partial_parse': 'True', 'version_check': 'True', 'indirect_selection': 'eager', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'printer_width': '80', 'log_cache_events': 'False'}
[0m17:01:33.905247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7d50c03c-9007-424a-8294-3203be4dc487', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe40a8f07c0>]}
[0m17:01:33.971110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7d50c03c-9007-424a-8294-3203be4dc487', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3d340c7c0>]}
[0m17:01:33.972699 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m17:01:34.144079 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m17:01:34.893181 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:01:34.894805 [debug] [MainThread]: Partial parsing: updated file: nyc_taxi://models/transform/dim_zone.sql
[0m17:01:35.295995 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m17:01:35.297693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '7d50c03c-9007-424a-8294-3203be4dc487', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe405be67c0>]}
[0m17:01:35.535213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7d50c03c-9007-424a-8294-3203be4dc487', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4029b9130>]}
[0m17:01:35.706380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7d50c03c-9007-424a-8294-3203be4dc487', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe405c6fc70>]}
[0m17:01:35.707992 [info ] [MainThread]: Found 5 models, 28 data tests, 2 sources, 600 macros
[0m17:01:35.709250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7d50c03c-9007-424a-8294-3203be4dc487', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4029b83d0>]}
[0m17:01:35.712656 [info ] [MainThread]: 
[0m17:01:35.714233 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:01:35.721105 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_northern-shield-437204-m0'
[0m17:01:35.722850 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:01:37.442775 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_northern-shield-437204-m0, now list_northern-shield-437204-m0_nyc_taxi)
[0m17:01:37.444350 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:01:36.338472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7d50c03c-9007-424a-8294-3203be4dc487', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe40caf62b0>]}
[0m17:01:36.339839 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:01:36.340880 [info ] [MainThread]: 
[0m17:01:36.350390 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_payment
[0m17:01:36.353144 [info ] [Thread-1  ]: 1 of 5 START sql table model nyc_taxi.dim_payment .............................. [RUN]
[0m17:01:36.354475 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_northern-shield-437204-m0_nyc_taxi, now model.nyc_taxi.dim_payment)
[0m17:01:36.355743 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_payment
[0m17:01:36.367512 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_payment"
[0m17:01:36.372601 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_payment
[0m17:01:36.392079 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:01:37.044649 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.dim_payment"
[0m17:01:37.050350 [debug] [Thread-1  ]: On model.nyc_taxi.dim_payment: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.dim_payment"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`dim_payment`
      
    
    

    OPTIONS()
    as (
      WITH payment_cte AS(
    SELECT DISTINCT
        payment_type AS type_id,
        CASE 
            WHEN payment_type = 1 THEN "Credit card"
            WHEN payment_type = 2 THEN "Cash"
            WHEN payment_type = 3 THEN "No charge"
            WHEN payment_type = 4 THEN "Dispute"
            WHEN payment_type = 5 THEN "Unknown"
            WHEN payment_type = 6 THEN "Voided trip"
        END AS payment_name
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata`
)
SELECT
    type_id,
    payment_name
FROM payment_cte
    );
  
[0m17:01:37.634604 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:75ab5423-895c-4e39-bd92-1aa47e7222cb&page=queryresults
[0m17:01:40.518252 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7d50c03c-9007-424a-8294-3203be4dc487', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe40caf62b0>]}
[0m17:01:40.520156 [info ] [Thread-1  ]: 1 of 5 OK created sql table model nyc_taxi.dim_payment ......................... [[32mCREATE TABLE (4.0 rows, 463.5 KiB processed)[0m in 4.16s]
[0m17:01:40.522043 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_payment
[0m17:01:40.523448 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_ratecode
[0m17:01:40.524773 [info ] [Thread-1  ]: 2 of 5 START sql table model nyc_taxi.dim_ratecode ............................. [RUN]
[0m17:01:40.525993 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_payment, now model.nyc_taxi.dim_ratecode)
[0m17:01:40.527063 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_ratecode
[0m17:01:40.531923 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_ratecode"
[0m17:01:40.536886 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_ratecode
[0m17:01:40.541366 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:01:41.173175 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.dim_ratecode"
[0m17:01:41.179344 [debug] [Thread-1  ]: On model.nyc_taxi.dim_ratecode: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.dim_ratecode"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`dim_ratecode`
      
    
    

    OPTIONS()
    as (
      WITH rate_code_cte AS(
    SELECT DISTINCT
        rate_code_id AS rate_id,
        CASE 
            WHEN rate_code_id = 1 THEN "Standard rate"
            WHEN rate_code_id = 2 THEN "JFK"
            WHEN rate_code_id = 3 THEN "Newark"
            WHEN rate_code_id = 4 THEN "Nassau or Westchester"
            WHEN rate_code_id = 5 THEN "Negotiated fare"
            WHEN rate_code_id = 6 THEN "Group ride"
        ELSE "Unknown"
        END AS rate_code_name
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata`
)
SELECT
    rate_id,
    rate_code_name
FROM rate_code_cte
    );
  
[0m17:01:41.842342 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:19a40631-5705-470b-9e8c-f709435a4b35&page=queryresults
[0m17:01:44.418161 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7d50c03c-9007-424a-8294-3203be4dc487', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe40014ed60>]}
[0m17:01:44.419991 [info ] [Thread-1  ]: 2 of 5 OK created sql table model nyc_taxi.dim_ratecode ........................ [[32mCREATE TABLE (6.0 rows, 463.5 KiB processed)[0m in 3.89s]
[0m17:01:44.422306 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_ratecode
[0m17:01:44.424208 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_vendor
[0m17:01:44.425842 [info ] [Thread-1  ]: 3 of 5 START sql table model nyc_taxi.dim_vendor ............................... [RUN]
[0m17:01:44.427594 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_ratecode, now model.nyc_taxi.dim_vendor)
[0m17:01:44.429263 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_vendor
[0m17:01:44.435739 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_vendor"
[0m17:01:44.444480 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_vendor
[0m17:01:44.449923 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:01:45.068376 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.dim_vendor"
[0m17:01:45.076150 [debug] [Thread-1  ]: On model.nyc_taxi.dim_vendor: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.dim_vendor"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`dim_vendor`
      
    
    

    OPTIONS()
    as (
      WITH vendor_cte AS(
    SELECT DISTINCT
        vendor_id AS id,
        CASE 
            WHEN vendor_id = 1 THEN "Creative Mobile Technologies"
            WHEN vendor_id = 2 THEN "VeriFone Inc."
        END AS vendor_name
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata`
)
SELECT
    id,
    vendor_name
FROM vendor_cte
    );
  
[0m17:01:45.859048 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:9816db25-73f6-46bb-924a-f80094ce8814&page=queryresults
[0m17:01:48.436318 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7d50c03c-9007-424a-8294-3203be4dc487', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4028665b0>]}
[0m17:01:48.438155 [info ] [Thread-1  ]: 3 of 5 OK created sql table model nyc_taxi.dim_vendor .......................... [[32mCREATE TABLE (2.0 rows, 463.5 KiB processed)[0m in 4.01s]
[0m17:01:48.440462 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_vendor
[0m17:01:48.441995 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_zone
[0m17:01:48.443339 [info ] [Thread-1  ]: 4 of 5 START sql table model nyc_taxi.dim_zone ................................. [RUN]
[0m17:01:48.444518 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_vendor, now model.nyc_taxi.dim_zone)
[0m17:01:48.445504 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_zone
[0m17:01:48.450282 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_zone"
[0m17:01:48.456540 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_zone
[0m17:01:48.461089 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:01:49.078872 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.dim_zone"
[0m17:01:49.084174 [debug] [Thread-1  ]: On model.nyc_taxi.dim_zone: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.dim_zone"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`dim_zone`
      
    
    

    OPTIONS()
    as (
      SELECT
    location_id,
    borough,
    zone,
    replace(service_zone, 'Boro', 'Green') as service_zone
FROM `northern-shield-437204-m0`.`nyc_taxi`.`zone_map`
WHERE borough != 'Unkown' or borough is not null
    );
  
[0m17:01:49.822049 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:c38a82dd-4f07-4abe-b804-dbb382eeb4bc&page=queryresults
[0m17:01:52.679663 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7d50c03c-9007-424a-8294-3203be4dc487', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe40284cee0>]}
[0m17:01:52.681372 [info ] [Thread-1  ]: 4 of 5 OK created sql table model nyc_taxi.dim_zone ............................ [[32mCREATE TABLE (528.0 rows, 24.2 KiB processed)[0m in 4.24s]
[0m17:01:52.683775 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_zone
[0m17:01:52.685334 [debug] [Thread-1  ]: Began running node model.nyc_taxi.fct_trips
[0m17:01:52.686567 [info ] [Thread-1  ]: 5 of 5 START sql table model nyc_taxi.fct_trips ................................ [RUN]
[0m17:01:52.687902 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_zone, now model.nyc_taxi.fct_trips)
[0m17:01:52.689154 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.fct_trips
[0m17:01:52.713636 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.fct_trips"
[0m17:01:52.718873 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.fct_trips
[0m17:01:52.725084 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:01:53.361800 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.fct_trips"
[0m17:01:53.369320 [debug] [Thread-1  ]: On model.nyc_taxi.fct_trips: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.fct_trips"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips`
      
    
    

    OPTIONS()
    as (
      WITH tripdata_cte AS (
    SELECT 
        to_hex(md5(cast(coalesce(cast(vendor_id as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(lpep_pickup_datetime as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(lpep_dropoff_datetime as string), '_dbt_utils_surrogate_key_null_') as string)))  AS trip_id,
        t.vendor_id,
        t.lpep_pickup_datetime AS pickup_time,
        t.lpep_dropoff_datetime AS dropoff_time,
        t.rate_code_id,
        t.pu_location_id,
        t.do_location_id,
        t.passenger_count,
        t.trip_distance,
        t.fare_amount,
        t.extra,
        t.mta_tax,
        t.tip_amount,
        t.tolls_amount,
        t.improvement_surcharge,
        t.total_amount,
        t.payment_type,
        t.trip_type,
        t.congestion_surcharge
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata` AS t
    WHERE vendor_id IS NOT NULL
)
SELECT 
    trip_id,
    vendor_id,
    pickup_time,
    dropoff_time,
    rate_code_id,
    pu_location_id,
    do_location_id,
    passenger_count,
    trip_distance,
    fare_amount,
    extra,
    mta_tax,
    tip_amount,
    tolls_amount,
    improvement_surcharge,
    total_amount,
    payment_type,
    trip_type,
    congestion_surcharge
FROM tripdata_cte
    );
  
[0m17:01:53.914560 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:e4f5122d-1e2b-4353-a769-5fd1f2f2c3ca&page=queryresults
[0m17:01:57.371808 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7d50c03c-9007-424a-8294-3203be4dc487', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe40b641d90>]}
[0m17:01:57.373805 [info ] [Thread-1  ]: 5 of 5 OK created sql table model nyc_taxi.fct_trips ........................... [[32mCREATE TABLE (59.3k rows, 8.1 MiB processed)[0m in 4.68s]
[0m17:01:57.376039 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.fct_trips
[0m17:01:57.378607 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:01:57.379616 [debug] [MainThread]: Connection 'model.nyc_taxi.fct_trips' was properly closed.
[0m17:01:57.380573 [info ] [MainThread]: 
[0m17:01:57.381703 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 21.67 seconds (21.67s).
[0m17:01:57.385222 [debug] [MainThread]: Command end result
[0m17:01:57.461548 [info ] [MainThread]: 
[0m17:01:57.462952 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:01:57.464036 [info ] [MainThread]: 
[0m17:01:57.465190 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m17:01:57.466854 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 26.566074, "process_in_blocks": "0", "process_kernel_time": 0.386288, "process_mem_max_rss": "244792", "process_out_blocks": "0", "process_user_time": 5.737795}
[0m17:01:57.468233 [debug] [MainThread]: Command `dbt run` succeeded at 17:01:57.468032 after 26.57 seconds
[0m17:01:57.469345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe40cb0bc40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe40a8f07c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe405089e50>]}
[0m17:01:57.470386 [debug] [MainThread]: Flushing usage events
[0m17:04:28.342707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c7cf67c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c7d2a24f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c7c0d13a0>]}


============================== 17:04:28.350586 | e7f2f7c2-87d0-4e00-9ebc-2d586fe19968 ==============================
[0m17:04:28.350586 [info ] [MainThread]: Running with dbt=1.8.9
[0m17:04:28.352032 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run --profiles-dir /opt/airflow/include/dbt/', 'introspect': 'True', 'indirect_selection': 'eager', 'profiles_dir': '/opt/airflow/include/dbt/', 'use_colors': 'True', 'log_cache_events': 'False', 'printer_width': '80', 'log_path': '/opt/airflow/include/dbt/logs', 'partial_parse': 'True', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'version_check': 'True', 'warn_error': 'None', 'write_json': 'True', 'quiet': 'False', 'static_parser': 'True', 'log_format': 'default', 'empty': 'False', 'debug': 'False', 'target_path': 'None', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True', 'no_print': 'None', 'use_experimental_parser': 'False'}
[0m17:04:29.572775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e7f2f7c2-87d0-4e00-9ebc-2d586fe19968', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c48632820>]}
[0m17:04:29.638785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e7f2f7c2-87d0-4e00-9ebc-2d586fe19968', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c43890310>]}
[0m17:04:29.640517 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m17:04:29.816503 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m17:04:30.528315 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:04:30.529959 [debug] [MainThread]: Partial parsing: updated file: nyc_taxi://models/transform/dim_zone.sql
[0m17:04:30.930983 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m17:04:30.932722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'e7f2f7c2-87d0-4e00-9ebc-2d586fe19968', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c7603aee0>]}
[0m17:04:31.177796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e7f2f7c2-87d0-4e00-9ebc-2d586fe19968', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c72dbf130>]}
[0m17:04:31.353951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e7f2f7c2-87d0-4e00-9ebc-2d586fe19968', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c72db8e80>]}
[0m17:04:31.355315 [info ] [MainThread]: Found 5 models, 28 data tests, 2 sources, 600 macros
[0m17:04:31.356491 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e7f2f7c2-87d0-4e00-9ebc-2d586fe19968', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c72d58430>]}
[0m17:04:31.359659 [info ] [MainThread]: 
[0m17:04:31.361199 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:04:31.368052 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_northern-shield-437204-m0'
[0m17:04:31.369291 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:04:32.227291 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_northern-shield-437204-m0, now list_northern-shield-437204-m0_nyc_taxi)
[0m17:04:32.228623 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:04:34.024568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e7f2f7c2-87d0-4e00-9ebc-2d586fe19968', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c7c54a8b0>]}
[0m17:04:34.026069 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:04:34.027263 [info ] [MainThread]: 
[0m17:04:34.035894 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_payment
[0m17:04:34.037573 [info ] [Thread-1  ]: 1 of 5 START sql table model nyc_taxi.dim_payment .............................. [RUN]
[0m17:04:34.039218 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_northern-shield-437204-m0_nyc_taxi, now model.nyc_taxi.dim_payment)
[0m17:04:34.042316 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_payment
[0m17:04:34.054325 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_payment"
[0m17:04:34.060082 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_payment
[0m17:04:34.115199 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.dim_payment"
[0m17:04:34.121639 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:04:34.125632 [debug] [Thread-1  ]: On model.nyc_taxi.dim_payment: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.dim_payment"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`dim_payment`
      
    
    

    OPTIONS()
    as (
      WITH payment_cte AS(
    SELECT DISTINCT
        payment_type AS type_id,
        CASE 
            WHEN payment_type = 1 THEN "Credit card"
            WHEN payment_type = 2 THEN "Cash"
            WHEN payment_type = 3 THEN "No charge"
            WHEN payment_type = 4 THEN "Dispute"
            WHEN payment_type = 5 THEN "Unknown"
            WHEN payment_type = 6 THEN "Voided trip"
        END AS payment_name
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata`
)
SELECT
    type_id,
    payment_name
FROM payment_cte
    );
  
[0m17:04:34.962316 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:ebe1b4d1-f64b-45a0-8a37-d6679211ab1a&page=queryresults
[0m17:04:38.076252 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e7f2f7c2-87d0-4e00-9ebc-2d586fe19968', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c72cae1f0>]}
[0m17:04:38.078032 [info ] [Thread-1  ]: 1 of 5 OK created sql table model nyc_taxi.dim_payment ......................... [[32mCREATE TABLE (4.0 rows, 463.5 KiB processed)[0m in 4.04s]
[0m17:04:38.080093 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_payment
[0m17:04:38.081495 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_ratecode
[0m17:04:38.082767 [info ] [Thread-1  ]: 2 of 5 START sql table model nyc_taxi.dim_ratecode ............................. [RUN]
[0m17:04:38.084106 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_payment, now model.nyc_taxi.dim_ratecode)
[0m17:04:38.085301 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_ratecode
[0m17:04:38.090367 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_ratecode"
[0m17:04:38.096790 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_ratecode
[0m17:04:38.102806 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.dim_ratecode"
[0m17:04:38.109552 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:04:38.113305 [debug] [Thread-1  ]: On model.nyc_taxi.dim_ratecode: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.dim_ratecode"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`dim_ratecode`
      
    
    

    OPTIONS()
    as (
      WITH rate_code_cte AS(
    SELECT DISTINCT
        rate_code_id AS rate_id,
        CASE 
            WHEN rate_code_id = 1 THEN "Standard rate"
            WHEN rate_code_id = 2 THEN "JFK"
            WHEN rate_code_id = 3 THEN "Newark"
            WHEN rate_code_id = 4 THEN "Nassau or Westchester"
            WHEN rate_code_id = 5 THEN "Negotiated fare"
            WHEN rate_code_id = 6 THEN "Group ride"
        ELSE "Unknown"
        END AS rate_code_name
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata`
)
SELECT
    rate_id,
    rate_code_name
FROM rate_code_cte
    );
  
[0m17:04:38.869324 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:087b3186-f669-4024-a6b5-b96cedcc053c&page=queryresults
[0m17:04:41.475989 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e7f2f7c2-87d0-4e00-9ebc-2d586fe19968', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c72c635b0>]}
[0m17:04:41.477679 [info ] [Thread-1  ]: 2 of 5 OK created sql table model nyc_taxi.dim_ratecode ........................ [[32mCREATE TABLE (6.0 rows, 463.5 KiB processed)[0m in 3.39s]
[0m17:04:41.479510 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_ratecode
[0m17:04:41.480806 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_vendor
[0m17:04:41.482038 [info ] [Thread-1  ]: 3 of 5 START sql table model nyc_taxi.dim_vendor ............................... [RUN]
[0m17:04:41.483493 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_ratecode, now model.nyc_taxi.dim_vendor)
[0m17:04:41.484788 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_vendor
[0m17:04:41.489857 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_vendor"
[0m17:04:41.494821 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_vendor
[0m17:04:41.500697 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.dim_vendor"
[0m17:04:41.506917 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:04:41.510700 [debug] [Thread-1  ]: On model.nyc_taxi.dim_vendor: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.dim_vendor"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`dim_vendor`
      
    
    

    OPTIONS()
    as (
      WITH vendor_cte AS(
    SELECT DISTINCT
        vendor_id AS id,
        CASE 
            WHEN vendor_id = 1 THEN "Creative Mobile Technologies"
            WHEN vendor_id = 2 THEN "VeriFone Inc."
        END AS vendor_name
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata`
)
SELECT
    id,
    vendor_name
FROM vendor_cte
    );
  
[0m17:04:42.337920 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:44214220-289d-4c91-a85d-a66e3035c4fe&page=queryresults
[0m17:04:45.498180 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e7f2f7c2-87d0-4e00-9ebc-2d586fe19968', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c705d6100>]}
[0m17:04:45.500215 [info ] [Thread-1  ]: 3 of 5 OK created sql table model nyc_taxi.dim_vendor .......................... [[32mCREATE TABLE (2.0 rows, 463.5 KiB processed)[0m in 4.01s]
[0m17:04:45.502343 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_vendor
[0m17:04:45.503984 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_zone
[0m17:04:45.505432 [info ] [Thread-1  ]: 4 of 5 START sql table model nyc_taxi.dim_zone ................................. [RUN]
[0m17:04:45.506938 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_vendor, now model.nyc_taxi.dim_zone)
[0m17:04:45.508206 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_zone
[0m17:04:45.513624 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_zone"
[0m17:04:45.518487 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_zone
[0m17:04:45.524013 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.dim_zone"
[0m17:04:45.529799 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:04:45.533760 [debug] [Thread-1  ]: On model.nyc_taxi.dim_zone: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.dim_zone"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`dim_zone`
      
    
    

    OPTIONS()
    as (
      SELECT DISTINCT
    location_id,
    borough,
    zone,
    replace(service_zone, 'Boro', 'Green') as service_zone
FROM `northern-shield-437204-m0`.`nyc_taxi`.`zone_map`
WHERE borough != 'Unkown' or borough is not null
    );
  
[0m17:04:46.352580 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:4f106b76-3348-467c-85de-836105b0497c&page=queryresults
[0m17:04:49.615087 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e7f2f7c2-87d0-4e00-9ebc-2d586fe19968', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c7053d160>]}
[0m17:04:49.616998 [info ] [Thread-1  ]: 4 of 5 OK created sql table model nyc_taxi.dim_zone ............................ [[32mCREATE TABLE (264.0 rows, 24.2 KiB processed)[0m in 4.11s]
[0m17:04:49.619257 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_zone
[0m17:04:49.620788 [debug] [Thread-1  ]: Began running node model.nyc_taxi.fct_trips
[0m17:04:49.622153 [info ] [Thread-1  ]: 5 of 5 START sql table model nyc_taxi.fct_trips ................................ [RUN]
[0m17:04:49.623499 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_zone, now model.nyc_taxi.fct_trips)
[0m17:04:49.624813 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.fct_trips
[0m17:04:49.648885 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.fct_trips"
[0m17:04:49.655396 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.fct_trips
[0m17:04:49.660844 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:04:50.261957 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.fct_trips"
[0m17:04:50.269153 [debug] [Thread-1  ]: On model.nyc_taxi.fct_trips: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.fct_trips"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips`
      
    
    

    OPTIONS()
    as (
      WITH tripdata_cte AS (
    SELECT 
        to_hex(md5(cast(coalesce(cast(vendor_id as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(lpep_pickup_datetime as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(lpep_dropoff_datetime as string), '_dbt_utils_surrogate_key_null_') as string)))  AS trip_id,
        t.vendor_id,
        t.lpep_pickup_datetime AS pickup_time,
        t.lpep_dropoff_datetime AS dropoff_time,
        t.rate_code_id,
        t.pu_location_id,
        t.do_location_id,
        t.passenger_count,
        t.trip_distance,
        t.fare_amount,
        t.extra,
        t.mta_tax,
        t.tip_amount,
        t.tolls_amount,
        t.improvement_surcharge,
        t.total_amount,
        t.payment_type,
        t.trip_type,
        t.congestion_surcharge
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata` AS t
    WHERE vendor_id IS NOT NULL
)
SELECT 
    trip_id,
    vendor_id,
    pickup_time,
    dropoff_time,
    rate_code_id,
    pu_location_id,
    do_location_id,
    passenger_count,
    trip_distance,
    fare_amount,
    extra,
    mta_tax,
    tip_amount,
    tolls_amount,
    improvement_surcharge,
    total_amount,
    payment_type,
    trip_type,
    congestion_surcharge
FROM tripdata_cte
    );
  
[0m17:04:50.858179 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:289c417c-5427-4b9e-88d7-247ee500a65f&page=queryresults
[0m17:04:55.240895 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e7f2f7c2-87d0-4e00-9ebc-2d586fe19968', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c70544310>]}
[0m17:04:55.243224 [info ] [Thread-1  ]: 5 of 5 OK created sql table model nyc_taxi.fct_trips ........................... [[32mCREATE TABLE (59.3k rows, 8.1 MiB processed)[0m in 5.62s]
[0m17:04:55.245490 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.fct_trips
[0m17:04:55.248353 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:04:55.249282 [debug] [MainThread]: Connection 'model.nyc_taxi.fct_trips' was properly closed.
[0m17:04:55.250349 [info ] [MainThread]: 
[0m17:04:55.251838 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 23.89 seconds (23.89s).
[0m17:04:55.255069 [debug] [MainThread]: Command end result
[0m17:04:54.297829 [info ] [MainThread]: 
[0m17:04:54.299163 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:04:54.300307 [info ] [MainThread]: 
[0m17:04:54.301394 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m17:04:54.303250 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 27.768806, "process_in_blocks": "0", "process_kernel_time": 0.295995, "process_mem_max_rss": "242556", "process_out_blocks": "0", "process_user_time": 5.891274}
[0m17:04:54.304715 [debug] [MainThread]: Command `dbt run` succeeded at 17:04:54.304490 after 27.77 seconds
[0m17:04:54.305812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c7cf67c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c48632820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c43890310>]}
[0m17:04:54.306894 [debug] [MainThread]: Flushing usage events
[0m17:21:41.464519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6feea5c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6ff1e0790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6ff1e0580>]}


============================== 17:21:41.472816 | f4702a84-9c13-4bb5-900c-744321d9bfe3 ==============================
[0m17:21:41.472816 [info ] [MainThread]: Running with dbt=1.8.9
[0m17:21:41.474376 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt test --profiles-dir /opt/airflow/include/dbt/', 'fail_fast': 'False', 'printer_width': '80', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'cache_selected_only': 'False', 'write_json': 'True', 'introspect': 'True', 'indirect_selection': 'eager', 'log_format': 'default', 'no_print': 'None', 'profiles_dir': '/opt/airflow/include/dbt/', 'log_cache_events': 'False', 'target_path': 'None', 'empty': 'None', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'quiet': 'False', 'use_experimental_parser': 'False', 'use_colors': 'True', 'version_check': 'True', 'log_path': '/opt/airflow/include/dbt/logs', 'debug': 'False', 'static_parser': 'True'}
[0m17:21:42.676469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f4702a84-9c13-4bb5-900c-744321d9bfe3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6fccdd9a0>]}
[0m17:21:42.742807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f4702a84-9c13-4bb5-900c-744321d9bfe3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6c583afd0>]}
[0m17:21:42.744503 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m17:21:42.916635 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m17:21:43.650471 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:21:43.652708 [debug] [MainThread]: Partial parsing: updated file: nyc_taxi://models/tests/schema.yml
[0m17:21:44.082297 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m17:21:44.084110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'f4702a84-9c13-4bb5-900c-744321d9bfe3', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6f752b760>]}
[0m17:21:44.447883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f4702a84-9c13-4bb5-900c-744321d9bfe3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6f4d9cdc0>]}
[0m17:21:44.639524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f4702a84-9c13-4bb5-900c-744321d9bfe3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6f2530040>]}
[0m17:21:44.641119 [info ] [MainThread]: Found 5 models, 28 data tests, 2 sources, 600 macros
[0m17:21:44.642708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f4702a84-9c13-4bb5-900c-744321d9bfe3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6f4d9c2e0>]}
[0m17:21:44.647770 [info ] [MainThread]: 
[0m17:21:44.649625 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:21:44.657544 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_northern-shield-437204-m0_nyc_taxi'
[0m17:21:44.659048 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:21:46.505321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f4702a84-9c13-4bb5-900c-744321d9bfe3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6fee8f2b0>]}
[0m17:21:46.506725 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:21:46.507832 [info ] [MainThread]: 
[0m17:21:46.518716 [debug] [Thread-1  ]: Began running node test.nyc_taxi.accepted_values_dim_payment_payment_name__Credit_card__Cash__No_charge__Dispute__Unknown__Voided_trip.58d00ef9f4
[0m17:21:46.520211 [info ] [Thread-1  ]: 1 of 28 START test accepted_values_dim_payment_payment_name__Credit_card__Cash__No_charge__Dispute__Unknown__Voided_trip  [RUN]
[0m17:21:46.521489 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_northern-shield-437204-m0_nyc_taxi, now test.nyc_taxi.accepted_values_dim_payment_payment_name__Credit_card__Cash__No_charge__Dispute__Unknown__Voided_trip.58d00ef9f4)
[0m17:21:46.522622 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.accepted_values_dim_payment_payment_name__Credit_card__Cash__No_charge__Dispute__Unknown__Voided_trip.58d00ef9f4
[0m17:21:46.539042 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.accepted_values_dim_payment_payment_name__Credit_card__Cash__No_charge__Dispute__Unknown__Voided_trip.58d00ef9f4"
[0m17:21:46.545868 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.accepted_values_dim_payment_payment_name__Credit_card__Cash__No_charge__Dispute__Unknown__Voided_trip.58d00ef9f4
[0m17:21:46.575390 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.accepted_values_dim_payment_payment_name__Credit_card__Cash__No_charge__Dispute__Unknown__Voided_trip.58d00ef9f4"
[0m17:21:46.583850 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:21:46.587704 [debug] [Thread-1  ]: On test.nyc_taxi.accepted_values_dim_payment_payment_name__Credit_card__Cash__No_charge__Dispute__Unknown__Voided_trip.58d00ef9f4: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.accepted_values_dim_payment_payment_name__Credit_card__Cash__No_charge__Dispute__Unknown__Voided_trip.58d00ef9f4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        payment_name as value_field,
        count(*) as n_records

    from `northern-shield-437204-m0`.`nyc_taxi`.`dim_payment`
    group by payment_name

)

select *
from all_values
where value_field not in (
    'Credit card','Cash','No charge','Dispute','Unknown','Voided trip'
)



      
    ) dbt_internal_test
[0m17:21:47.658962 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:cfed24e7-e495-4014-8145-7fe5310223ea&page=queryresults
[0m17:21:48.924150 [info ] [Thread-1  ]: 1 of 28 PASS accepted_values_dim_payment_payment_name__Credit_card__Cash__No_charge__Dispute__Unknown__Voided_trip  [[32mPASS[0m in 2.40s]
[0m17:21:48.926110 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.accepted_values_dim_payment_payment_name__Credit_card__Cash__No_charge__Dispute__Unknown__Voided_trip.58d00ef9f4
[0m17:21:48.927643 [debug] [Thread-1  ]: Began running node test.nyc_taxi.accepted_values_dim_ratecode_rate_code_name__Standard_rate__JFK__Newark__Nassau_or_Westchester__Negotiated_fare__Group_ride__Unknown.57ee02019f
[0m17:21:48.928754 [info ] [Thread-1  ]: 2 of 28 START test accepted_values_dim_ratecode_rate_code_name__Standard_rate__JFK__Newark__Nassau_or_Westchester__Negotiated_fare__Group_ride__Unknown  [RUN]
[0m17:21:48.929981 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.accepted_values_dim_payment_payment_name__Credit_card__Cash__No_charge__Dispute__Unknown__Voided_trip.58d00ef9f4, now test.nyc_taxi.accepted_values_dim_ratecode_rate_code_name__Standard_rate__JFK__Newark__Nassau_or_Westchester__Negotiated_fare__Group_ride__Unknown.57ee02019f)
[0m17:21:48.931020 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.accepted_values_dim_ratecode_rate_code_name__Standard_rate__JFK__Newark__Nassau_or_Westchester__Negotiated_fare__Group_ride__Unknown.57ee02019f
[0m17:21:48.937762 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.accepted_values_dim_ratecode_rate_code_name__Standard_rate__JFK__Newark__Nassau_or_Westchester__Negotiated_fare__Group_ride__Unknown.57ee02019f"
[0m17:21:48.943444 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.accepted_values_dim_ratecode_rate_code_name__Standard_rate__JFK__Newark__Nassau_or_Westchester__Negotiated_fare__Group_ride__Unknown.57ee02019f
[0m17:21:48.947912 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.accepted_values_dim_ratecode_rate_code_name__Standard_rate__JFK__Newark__Nassau_or_Westchester__Negotiated_fare__Group_ride__Unknown.57ee02019f"
[0m17:21:48.954481 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:21:48.958514 [debug] [Thread-1  ]: On test.nyc_taxi.accepted_values_dim_ratecode_rate_code_name__Standard_rate__JFK__Newark__Nassau_or_Westchester__Negotiated_fare__Group_ride__Unknown.57ee02019f: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.accepted_values_dim_ratecode_rate_code_name__Standard_rate__JFK__Newark__Nassau_or_Westchester__Negotiated_fare__Group_ride__Unknown.57ee02019f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        rate_code_name as value_field,
        count(*) as n_records

    from `northern-shield-437204-m0`.`nyc_taxi`.`dim_ratecode`
    group by rate_code_name

)

select *
from all_values
where value_field not in (
    'Standard rate','JFK','Newark','Nassau or Westchester','Negotiated fare','Group ride','Unknown'
)



      
    ) dbt_internal_test
[0m17:21:49.979361 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:fe00b53b-c6b6-4cdb-9216-2f6d7559217d&page=queryresults
[0m17:21:51.200360 [info ] [Thread-1  ]: 2 of 28 PASS accepted_values_dim_ratecode_rate_code_name__Standard_rate__JFK__Newark__Nassau_or_Westchester__Negotiated_fare__Group_ride__Unknown  [[32mPASS[0m in 2.27s]
[0m17:21:51.202841 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.accepted_values_dim_ratecode_rate_code_name__Standard_rate__JFK__Newark__Nassau_or_Westchester__Negotiated_fare__Group_ride__Unknown.57ee02019f
[0m17:21:51.204490 [debug] [Thread-1  ]: Began running node test.nyc_taxi.accepted_values_dim_vendor_vendor_name__Creative_Mobile_Technologies__VeriFone_Inc_.7481cecf07
[0m17:21:51.205810 [info ] [Thread-1  ]: 3 of 28 START test accepted_values_dim_vendor_vendor_name__Creative_Mobile_Technologies__VeriFone_Inc_  [RUN]
[0m17:21:51.207320 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.accepted_values_dim_ratecode_rate_code_name__Standard_rate__JFK__Newark__Nassau_or_Westchester__Negotiated_fare__Group_ride__Unknown.57ee02019f, now test.nyc_taxi.accepted_values_dim_vendor_vendor_name__Creative_Mobile_Technologies__VeriFone_Inc_.7481cecf07)
[0m17:21:51.208547 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.accepted_values_dim_vendor_vendor_name__Creative_Mobile_Technologies__VeriFone_Inc_.7481cecf07
[0m17:21:51.217637 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.accepted_values_dim_vendor_vendor_name__Creative_Mobile_Technologies__VeriFone_Inc_.7481cecf07"
[0m17:21:51.223374 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.accepted_values_dim_vendor_vendor_name__Creative_Mobile_Technologies__VeriFone_Inc_.7481cecf07
[0m17:21:51.228041 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.accepted_values_dim_vendor_vendor_name__Creative_Mobile_Technologies__VeriFone_Inc_.7481cecf07"
[0m17:21:51.233976 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:21:51.237339 [debug] [Thread-1  ]: On test.nyc_taxi.accepted_values_dim_vendor_vendor_name__Creative_Mobile_Technologies__VeriFone_Inc_.7481cecf07: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.accepted_values_dim_vendor_vendor_name__Creative_Mobile_Technologies__VeriFone_Inc_.7481cecf07"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        vendor_name as value_field,
        count(*) as n_records

    from `northern-shield-437204-m0`.`nyc_taxi`.`dim_vendor`
    group by vendor_name

)

select *
from all_values
where value_field not in (
    'Creative Mobile Technologies','VeriFone Inc.'
)



      
    ) dbt_internal_test
[0m17:21:52.288991 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:5c9800a5-3701-4f62-aac5-2820e472eb76&page=queryresults
[0m17:21:51.691890 [info ] [Thread-1  ]: 3 of 28 PASS accepted_values_dim_vendor_vendor_name__Creative_Mobile_Technologies__VeriFone_Inc_  [[32mPASS[0m in 0.48s]
[0m17:21:51.694129 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.accepted_values_dim_vendor_vendor_name__Creative_Mobile_Technologies__VeriFone_Inc_.7481cecf07
[0m17:21:51.698073 [debug] [Thread-1  ]: Began running node test.nyc_taxi.conditional_values_fct_trips_fare_amount__test_fare_amount_positive.42cfe6599e
[0m17:21:51.699505 [info ] [Thread-1  ]: 4 of 28 START test conditional_values_fct_trips_fare_amount__test_fare_amount_positive  [RUN]
[0m17:21:51.701144 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.accepted_values_dim_vendor_vendor_name__Creative_Mobile_Technologies__VeriFone_Inc_.7481cecf07, now test.nyc_taxi.conditional_values_fct_trips_fare_amount__test_fare_amount_positive.42cfe6599e)
[0m17:21:51.702463 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.conditional_values_fct_trips_fare_amount__test_fare_amount_positive.42cfe6599e
[0m17:21:51.711569 [debug] [Thread-1  ]: Compilation Error in test conditional_values_fct_trips_fare_amount__test_fare_amount_positive (models/tests/schema.yml)
  'test_conditional_values' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m17:21:51.712810 [error] [Thread-1  ]: 4 of 28 ERROR conditional_values_fct_trips_fare_amount__test_fare_amount_positive  [[31mERROR[0m in 0.01s]
[0m17:21:51.714296 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.conditional_values_fct_trips_fare_amount__test_fare_amount_positive.42cfe6599e
[0m17:21:51.715401 [debug] [Thread-1  ]: Began running node test.nyc_taxi.conditional_values_fct_trips_mta_tax__test_mta_tax_positive.21bb3dd018
[0m17:21:51.716613 [info ] [Thread-1  ]: 5 of 28 START test conditional_values_fct_trips_mta_tax__test_mta_tax_positive . [RUN]
[0m17:21:51.717915 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.conditional_values_fct_trips_fare_amount__test_fare_amount_positive.42cfe6599e, now test.nyc_taxi.conditional_values_fct_trips_mta_tax__test_mta_tax_positive.21bb3dd018)
[0m17:21:51.718962 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.conditional_values_fct_trips_mta_tax__test_mta_tax_positive.21bb3dd018
[0m17:21:51.725915 [debug] [Thread-1  ]: Compilation Error in test conditional_values_fct_trips_mta_tax__test_mta_tax_positive (models/tests/schema.yml)
  'test_conditional_values' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m17:21:51.727116 [error] [Thread-1  ]: 5 of 28 ERROR conditional_values_fct_trips_mta_tax__test_mta_tax_positive ...... [[31mERROR[0m in 0.01s]
[0m17:21:51.728753 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.conditional_values_fct_trips_mta_tax__test_mta_tax_positive.21bb3dd018
[0m17:21:51.730286 [debug] [Thread-1  ]: Began running node test.nyc_taxi.conditional_values_fct_trips_tip_amount__test_tip_amount_positive.cc3a05edfa
[0m17:21:51.731511 [info ] [Thread-1  ]: 6 of 28 START test conditional_values_fct_trips_tip_amount__test_tip_amount_positive  [RUN]
[0m17:21:51.732921 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.conditional_values_fct_trips_mta_tax__test_mta_tax_positive.21bb3dd018, now test.nyc_taxi.conditional_values_fct_trips_tip_amount__test_tip_amount_positive.cc3a05edfa)
[0m17:21:51.734297 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.conditional_values_fct_trips_tip_amount__test_tip_amount_positive.cc3a05edfa
[0m17:21:51.742266 [debug] [Thread-1  ]: Compilation Error in test conditional_values_fct_trips_tip_amount__test_tip_amount_positive (models/tests/schema.yml)
  'test_conditional_values' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m17:21:51.743734 [error] [Thread-1  ]: 6 of 28 ERROR conditional_values_fct_trips_tip_amount__test_tip_amount_positive  [[31mERROR[0m in 0.01s]
[0m17:21:51.745220 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.conditional_values_fct_trips_tip_amount__test_tip_amount_positive.cc3a05edfa
[0m17:21:51.746412 [debug] [Thread-1  ]: Began running node test.nyc_taxi.conditional_values_fct_trips_tolls_amount__test_tolls_amount_positive.b5e4e898c5
[0m17:21:51.747541 [info ] [Thread-1  ]: 7 of 28 START test conditional_values_fct_trips_tolls_amount__test_tolls_amount_positive  [RUN]
[0m17:21:51.748826 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.conditional_values_fct_trips_tip_amount__test_tip_amount_positive.cc3a05edfa, now test.nyc_taxi.conditional_values_fct_trips_tolls_amount__test_tolls_amount_positive.b5e4e898c5)
[0m17:21:51.749778 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.conditional_values_fct_trips_tolls_amount__test_tolls_amount_positive.b5e4e898c5
[0m17:21:51.757633 [debug] [Thread-1  ]: Compilation Error in test conditional_values_fct_trips_tolls_amount__test_tolls_amount_positive (models/tests/schema.yml)
  'test_conditional_values' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m17:21:51.759171 [error] [Thread-1  ]: 7 of 28 ERROR conditional_values_fct_trips_tolls_amount__test_tolls_amount_positive  [[31mERROR[0m in 0.01s]
[0m17:21:51.760603 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.conditional_values_fct_trips_tolls_amount__test_tolls_amount_positive.b5e4e898c5
[0m17:21:51.761750 [debug] [Thread-1  ]: Began running node test.nyc_taxi.conditional_values_fct_trips_total_amount__test_total_amount_positive.1bd69ecc4e
[0m17:21:51.762807 [info ] [Thread-1  ]: 8 of 28 START test conditional_values_fct_trips_total_amount__test_total_amount_positive  [RUN]
[0m17:21:51.764054 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.conditional_values_fct_trips_tolls_amount__test_tolls_amount_positive.b5e4e898c5, now test.nyc_taxi.conditional_values_fct_trips_total_amount__test_total_amount_positive.1bd69ecc4e)
[0m17:21:51.765140 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.conditional_values_fct_trips_total_amount__test_total_amount_positive.1bd69ecc4e
[0m17:21:51.772131 [debug] [Thread-1  ]: Compilation Error in test conditional_values_fct_trips_total_amount__test_total_amount_positive (models/tests/schema.yml)
  'test_conditional_values' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m17:21:51.773715 [error] [Thread-1  ]: 8 of 28 ERROR conditional_values_fct_trips_total_amount__test_total_amount_positive  [[31mERROR[0m in 0.01s]
[0m17:21:51.775683 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.conditional_values_fct_trips_total_amount__test_total_amount_positive.1bd69ecc4e
[0m17:21:51.777318 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_dim_payment_type_id.96dfa722aa
[0m17:21:51.778548 [info ] [Thread-1  ]: 9 of 28 START test not_null_dim_payment_type_id ................................ [RUN]
[0m17:21:51.779765 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.conditional_values_fct_trips_total_amount__test_total_amount_positive.1bd69ecc4e, now test.nyc_taxi.not_null_dim_payment_type_id.96dfa722aa)
[0m17:21:51.780903 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_dim_payment_type_id.96dfa722aa
[0m17:21:51.792599 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_dim_payment_type_id.96dfa722aa"
[0m17:21:51.798387 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_dim_payment_type_id.96dfa722aa
[0m17:21:51.803068 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_dim_payment_type_id.96dfa722aa"
[0m17:21:51.809402 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:21:51.813130 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_dim_payment_type_id.96dfa722aa: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_dim_payment_type_id.96dfa722aa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select type_id
from `northern-shield-437204-m0`.`nyc_taxi`.`dim_payment`
where type_id is null



      
    ) dbt_internal_test
[0m17:21:52.722816 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:ccd4b165-4adf-4b3b-a6ca-1803a2cc8c32&page=queryresults
[0m17:21:53.895613 [info ] [Thread-1  ]: 9 of 28 PASS not_null_dim_payment_type_id ...................................... [[32mPASS[0m in 2.12s]
[0m17:21:53.897935 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_dim_payment_type_id.96dfa722aa
[0m17:21:53.899681 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_dim_zone_borough.1ed2272c52
[0m17:21:53.901009 [info ] [Thread-1  ]: 10 of 28 START test not_null_dim_zone_borough .................................. [RUN]
[0m17:21:53.902518 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_dim_payment_type_id.96dfa722aa, now test.nyc_taxi.not_null_dim_zone_borough.1ed2272c52)
[0m17:21:53.903987 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_dim_zone_borough.1ed2272c52
[0m17:21:53.911901 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_dim_zone_borough.1ed2272c52"
[0m17:21:53.918838 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_dim_zone_borough.1ed2272c52
[0m17:21:53.923489 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_dim_zone_borough.1ed2272c52"
[0m17:21:53.928814 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:21:53.933338 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_dim_zone_borough.1ed2272c52: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_dim_zone_borough.1ed2272c52"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select borough
from `northern-shield-437204-m0`.`nyc_taxi`.`dim_zone`
where borough is null



      
    ) dbt_internal_test
[0m17:21:54.832981 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:b4b7efe1-f582-43cc-a60c-8497a47dc20e&page=queryresults
[0m17:21:56.778841 [info ] [Thread-1  ]: 10 of 28 PASS not_null_dim_zone_borough ........................................ [[32mPASS[0m in 2.88s]
[0m17:21:56.780874 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_dim_zone_borough.1ed2272c52
[0m17:21:56.782466 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_dim_zone_service_zone.2007f611c5
[0m17:21:56.783647 [info ] [Thread-1  ]: 11 of 28 START test not_null_dim_zone_service_zone ............................. [RUN]
[0m17:21:56.784857 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_dim_zone_borough.1ed2272c52, now test.nyc_taxi.not_null_dim_zone_service_zone.2007f611c5)
[0m17:21:56.786005 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_dim_zone_service_zone.2007f611c5
[0m17:21:56.792411 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_dim_zone_service_zone.2007f611c5"
[0m17:21:56.799461 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_dim_zone_service_zone.2007f611c5
[0m17:21:56.806695 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_dim_zone_service_zone.2007f611c5"
[0m17:21:56.812783 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:21:56.816578 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_dim_zone_service_zone.2007f611c5: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_dim_zone_service_zone.2007f611c5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select service_zone
from `northern-shield-437204-m0`.`nyc_taxi`.`dim_zone`
where service_zone is null



      
    ) dbt_internal_test
[0m17:21:57.751420 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:d0ffe3c3-b34e-4fb4-8a75-723bb125b48b&page=queryresults
[0m17:21:58.894379 [error] [Thread-1  ]: 11 of 28 FAIL 1 not_null_dim_zone_service_zone ................................. [[31mFAIL 1[0m in 2.11s]
[0m17:21:58.896933 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_dim_zone_service_zone.2007f611c5
[0m17:21:58.898728 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_dim_zone_zone.a1c4a4c37a
[0m17:21:58.900152 [info ] [Thread-1  ]: 12 of 28 START test not_null_dim_zone_zone ..................................... [RUN]
[0m17:21:58.901549 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_dim_zone_service_zone.2007f611c5, now test.nyc_taxi.not_null_dim_zone_zone.a1c4a4c37a)
[0m17:21:58.902851 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_dim_zone_zone.a1c4a4c37a
[0m17:21:58.910594 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_dim_zone_zone.a1c4a4c37a"
[0m17:21:58.916354 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_dim_zone_zone.a1c4a4c37a
[0m17:21:58.920670 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_dim_zone_zone.a1c4a4c37a"
[0m17:21:58.926184 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:21:58.929421 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_dim_zone_zone.a1c4a4c37a: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_dim_zone_zone.a1c4a4c37a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select zone
from `northern-shield-437204-m0`.`nyc_taxi`.`dim_zone`
where zone is null



      
    ) dbt_internal_test
[0m17:22:00.007704 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:604457bb-9d4f-4de1-9789-2bdc1e9adb99&page=queryresults
[0m17:22:01.210918 [error] [Thread-1  ]: 12 of 28 FAIL 1 not_null_dim_zone_zone ......................................... [[31mFAIL 1[0m in 2.31s]
[0m17:22:01.213423 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_dim_zone_zone.a1c4a4c37a
[0m17:22:01.215373 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_do_location_id.6acdd302a6
[0m17:22:01.216780 [info ] [Thread-1  ]: 13 of 28 START test not_null_fct_trips_do_location_id .......................... [RUN]
[0m17:22:01.218246 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_dim_zone_zone.a1c4a4c37a, now test.nyc_taxi.not_null_fct_trips_do_location_id.6acdd302a6)
[0m17:22:01.219558 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_do_location_id.6acdd302a6
[0m17:22:01.227591 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_do_location_id.6acdd302a6"
[0m17:22:01.233184 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_do_location_id.6acdd302a6
[0m17:22:01.237567 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_fct_trips_do_location_id.6acdd302a6"
[0m17:22:01.243902 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:22:01.247596 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_fct_trips_do_location_id.6acdd302a6: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_fct_trips_do_location_id.6acdd302a6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select do_location_id
from `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips`
where do_location_id is null



      
    ) dbt_internal_test
[0m17:22:02.247902 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:897f85a3-121c-482e-ab33-e4d31ed5f2d6&page=queryresults
[0m17:22:03.493113 [info ] [Thread-1  ]: 13 of 28 PASS not_null_fct_trips_do_location_id ................................ [[32mPASS[0m in 2.27s]
[0m17:22:03.495780 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_do_location_id.6acdd302a6
[0m17:22:03.499882 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_dropoff_time.04b71dc609
[0m17:22:03.501354 [info ] [Thread-1  ]: 14 of 28 START test not_null_fct_trips_dropoff_time ............................ [RUN]
[0m17:22:03.502781 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_do_location_id.6acdd302a6, now test.nyc_taxi.not_null_fct_trips_dropoff_time.04b71dc609)
[0m17:22:03.504088 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_dropoff_time.04b71dc609
[0m17:22:03.511129 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_dropoff_time.04b71dc609"
[0m17:22:03.517212 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_dropoff_time.04b71dc609
[0m17:22:03.521957 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_fct_trips_dropoff_time.04b71dc609"
[0m17:22:03.528392 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:22:03.532706 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_fct_trips_dropoff_time.04b71dc609: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_fct_trips_dropoff_time.04b71dc609"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select dropoff_time
from `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips`
where dropoff_time is null



      
    ) dbt_internal_test
[0m17:22:04.422913 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:f9844dc9-1484-4adb-9058-199e817720b6&page=queryresults
[0m17:22:05.592148 [info ] [Thread-1  ]: 14 of 28 PASS not_null_fct_trips_dropoff_time .................................. [[32mPASS[0m in 2.09s]
[0m17:22:05.594520 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_dropoff_time.04b71dc609
[0m17:22:05.596260 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_extra.1801055bb3
[0m17:22:05.597640 [info ] [Thread-1  ]: 15 of 28 START test not_null_fct_trips_extra ................................... [RUN]
[0m17:22:05.599184 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_dropoff_time.04b71dc609, now test.nyc_taxi.not_null_fct_trips_extra.1801055bb3)
[0m17:22:05.600509 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_extra.1801055bb3
[0m17:22:05.608800 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_extra.1801055bb3"
[0m17:22:05.614513 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_extra.1801055bb3
[0m17:22:05.618810 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_fct_trips_extra.1801055bb3"
[0m17:22:05.625319 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:22:05.629162 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_fct_trips_extra.1801055bb3: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_fct_trips_extra.1801055bb3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select extra
from `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips`
where extra is null



      
    ) dbt_internal_test
[0m17:22:06.535548 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:6c405e84-6e90-43fc-829b-b5059224d5f4&page=queryresults
[0m17:22:07.699310 [info ] [Thread-1  ]: 15 of 28 PASS not_null_fct_trips_extra ......................................... [[32mPASS[0m in 2.10s]
[0m17:22:07.701946 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_extra.1801055bb3
[0m17:22:07.703776 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_improvement_surcharge.4cf28d1443
[0m17:22:07.705139 [info ] [Thread-1  ]: 16 of 28 START test not_null_fct_trips_improvement_surcharge ................... [RUN]
[0m17:22:07.706576 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_extra.1801055bb3, now test.nyc_taxi.not_null_fct_trips_improvement_surcharge.4cf28d1443)
[0m17:22:07.707793 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_improvement_surcharge.4cf28d1443
[0m17:22:07.718221 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_improvement_surcharge.4cf28d1443"
[0m17:22:07.724073 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_improvement_surcharge.4cf28d1443
[0m17:22:07.728598 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_fct_trips_improvement_surcharge.4cf28d1443"
[0m17:22:07.735061 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:22:07.738922 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_fct_trips_improvement_surcharge.4cf28d1443: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_fct_trips_improvement_surcharge.4cf28d1443"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select improvement_surcharge
from `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips`
where improvement_surcharge is null



      
    ) dbt_internal_test
[0m17:22:08.617858 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:25e87665-3622-41d4-9c6e-e256fc0b64c7&page=queryresults
[0m17:22:09.861576 [info ] [Thread-1  ]: 16 of 28 PASS not_null_fct_trips_improvement_surcharge ......................... [[32mPASS[0m in 2.15s]
[0m17:22:09.863881 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_improvement_surcharge.4cf28d1443
[0m17:22:09.865491 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_passenger_count.b1370cab1c
[0m17:22:09.866828 [info ] [Thread-1  ]: 17 of 28 START test not_null_fct_trips_passenger_count ......................... [RUN]
[0m17:22:09.868345 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_improvement_surcharge.4cf28d1443, now test.nyc_taxi.not_null_fct_trips_passenger_count.b1370cab1c)
[0m17:22:09.869618 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_passenger_count.b1370cab1c
[0m17:22:09.878040 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_passenger_count.b1370cab1c"
[0m17:22:09.883818 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_passenger_count.b1370cab1c
[0m17:22:09.888396 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_fct_trips_passenger_count.b1370cab1c"
[0m17:22:09.894127 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:22:09.898340 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_fct_trips_passenger_count.b1370cab1c: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_fct_trips_passenger_count.b1370cab1c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select passenger_count
from `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips`
where passenger_count is null



      
    ) dbt_internal_test
[0m17:22:10.808667 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:fa0c9fd6-9fe8-41ff-8aa8-7c08d2cbfc20&page=queryresults
[0m17:22:11.999943 [info ] [Thread-1  ]: 17 of 28 PASS not_null_fct_trips_passenger_count ............................... [[32mPASS[0m in 2.13s]
[0m17:22:12.002027 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_passenger_count.b1370cab1c
[0m17:22:12.003612 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_payment_type.93889b679a
[0m17:22:12.004857 [info ] [Thread-1  ]: 18 of 28 START test not_null_fct_trips_payment_type ............................ [RUN]
[0m17:22:12.006158 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_passenger_count.b1370cab1c, now test.nyc_taxi.not_null_fct_trips_payment_type.93889b679a)
[0m17:22:12.007274 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_payment_type.93889b679a
[0m17:22:12.014044 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_payment_type.93889b679a"
[0m17:22:12.019996 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_payment_type.93889b679a
[0m17:22:12.025438 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_fct_trips_payment_type.93889b679a"
[0m17:22:12.031238 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:22:12.034797 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_fct_trips_payment_type.93889b679a: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_fct_trips_payment_type.93889b679a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select payment_type
from `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips`
where payment_type is null



      
    ) dbt_internal_test
[0m17:22:12.902510 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:d20d7f3f-05ea-49f4-b171-46f4f1228c2d&page=queryresults
[0m17:22:14.063747 [info ] [Thread-1  ]: 18 of 28 PASS not_null_fct_trips_payment_type .................................. [[32mPASS[0m in 2.06s]
[0m17:22:14.066084 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_payment_type.93889b679a
[0m17:22:14.070179 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_pickup_time.693af2bf31
[0m17:22:14.071537 [info ] [Thread-1  ]: 19 of 28 START test not_null_fct_trips_pickup_time ............................. [RUN]
[0m17:22:14.073173 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_payment_type.93889b679a, now test.nyc_taxi.not_null_fct_trips_pickup_time.693af2bf31)
[0m17:22:14.074645 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_pickup_time.693af2bf31
[0m17:22:14.082251 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_pickup_time.693af2bf31"
[0m17:22:14.087840 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_pickup_time.693af2bf31
[0m17:22:14.092290 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_fct_trips_pickup_time.693af2bf31"
[0m17:22:14.099745 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:22:14.103499 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_fct_trips_pickup_time.693af2bf31: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_fct_trips_pickup_time.693af2bf31"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select pickup_time
from `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips`
where pickup_time is null



      
    ) dbt_internal_test
[0m17:22:14.977755 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:2d8e5816-2cac-497f-8325-a481c198cca7&page=queryresults
[0m17:22:16.171858 [info ] [Thread-1  ]: 19 of 28 PASS not_null_fct_trips_pickup_time ................................... [[32mPASS[0m in 2.10s]
[0m17:22:16.174154 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_pickup_time.693af2bf31
[0m17:22:16.175727 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_pu_location_id.b0dc8dd185
[0m17:22:16.176846 [info ] [Thread-1  ]: 20 of 28 START test not_null_fct_trips_pu_location_id .......................... [RUN]
[0m17:22:16.178166 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_pickup_time.693af2bf31, now test.nyc_taxi.not_null_fct_trips_pu_location_id.b0dc8dd185)
[0m17:22:16.179359 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_pu_location_id.b0dc8dd185
[0m17:22:16.187347 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_pu_location_id.b0dc8dd185"
[0m17:22:16.193402 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_pu_location_id.b0dc8dd185
[0m17:22:16.198171 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_fct_trips_pu_location_id.b0dc8dd185"
[0m17:22:16.204664 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:22:16.208724 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_fct_trips_pu_location_id.b0dc8dd185: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_fct_trips_pu_location_id.b0dc8dd185"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select pu_location_id
from `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips`
where pu_location_id is null



      
    ) dbt_internal_test
[0m17:22:17.135534 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:97c87349-ec97-4b41-8330-bf98154066ba&page=queryresults
[0m17:22:18.281057 [info ] [Thread-1  ]: 20 of 28 PASS not_null_fct_trips_pu_location_id ................................ [[32mPASS[0m in 2.10s]
[0m17:22:18.283429 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_pu_location_id.b0dc8dd185
[0m17:22:18.285183 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_rate_code_id.ba0047eaae
[0m17:22:18.286374 [info ] [Thread-1  ]: 21 of 28 START test not_null_fct_trips_rate_code_id ............................ [RUN]
[0m17:22:18.287783 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_pu_location_id.b0dc8dd185, now test.nyc_taxi.not_null_fct_trips_rate_code_id.ba0047eaae)
[0m17:22:18.289055 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_rate_code_id.ba0047eaae
[0m17:22:18.298925 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_rate_code_id.ba0047eaae"
[0m17:22:18.304928 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_rate_code_id.ba0047eaae
[0m17:22:18.310262 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_fct_trips_rate_code_id.ba0047eaae"
[0m17:22:18.316972 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:22:18.320410 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_fct_trips_rate_code_id.ba0047eaae: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_fct_trips_rate_code_id.ba0047eaae"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select rate_code_id
from `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips`
where rate_code_id is null



      
    ) dbt_internal_test
[0m17:22:19.132106 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:471b1592-7db0-4170-8a26-0b016389e583&page=queryresults
[0m17:22:20.291941 [info ] [Thread-1  ]: 21 of 28 PASS not_null_fct_trips_rate_code_id .................................. [[32mPASS[0m in 2.00s]
[0m17:22:20.294329 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_rate_code_id.ba0047eaae
[0m17:22:20.295859 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_trip_distance.19cd17f1df
[0m17:22:20.297163 [info ] [Thread-1  ]: 22 of 28 START test not_null_fct_trips_trip_distance ........................... [RUN]
[0m17:22:20.298577 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_rate_code_id.ba0047eaae, now test.nyc_taxi.not_null_fct_trips_trip_distance.19cd17f1df)
[0m17:22:20.299725 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_trip_distance.19cd17f1df
[0m17:22:20.311065 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_trip_distance.19cd17f1df"
[0m17:22:20.318501 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_trip_distance.19cd17f1df
[0m17:22:20.323492 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_fct_trips_trip_distance.19cd17f1df"
[0m17:22:20.330968 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:22:20.335394 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_fct_trips_trip_distance.19cd17f1df: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_fct_trips_trip_distance.19cd17f1df"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select trip_distance
from `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips`
where trip_distance is null



      
    ) dbt_internal_test
[0m17:22:21.246852 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:b0151e62-a640-4c84-be00-91951a151714&page=queryresults
[0m17:22:20.542191 [info ] [Thread-1  ]: 22 of 28 PASS not_null_fct_trips_trip_distance ................................. [[32mPASS[0m in 0.24s]
[0m17:22:20.544511 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_trip_distance.19cd17f1df
[0m17:22:20.546103 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_vendor_id.b9b2f380bb
[0m17:22:20.547530 [info ] [Thread-1  ]: 23 of 28 START test not_null_fct_trips_vendor_id ............................... [RUN]
[0m17:22:20.549106 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_trip_distance.19cd17f1df, now test.nyc_taxi.not_null_fct_trips_vendor_id.b9b2f380bb)
[0m17:22:20.550410 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_vendor_id.b9b2f380bb
[0m17:22:20.558275 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_vendor_id.b9b2f380bb"
[0m17:22:20.563516 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_vendor_id.b9b2f380bb
[0m17:22:20.567909 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_fct_trips_vendor_id.b9b2f380bb"
[0m17:22:20.574101 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:22:20.577329 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_fct_trips_vendor_id.b9b2f380bb: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_fct_trips_vendor_id.b9b2f380bb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select vendor_id
from `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips`
where vendor_id is null



      
    ) dbt_internal_test
[0m17:22:21.479824 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:4f32b654-bcdc-469e-a243-ef6922c7f80b&page=queryresults
[0m17:22:22.622294 [info ] [Thread-1  ]: 23 of 28 PASS not_null_fct_trips_vendor_id ..................................... [[32mPASS[0m in 2.07s]
[0m17:22:22.624657 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_vendor_id.b9b2f380bb
[0m17:22:22.628332 [debug] [Thread-1  ]: Began running node test.nyc_taxi.unique_dim_payment_type_id.dea55de04e
[0m17:22:22.629346 [info ] [Thread-1  ]: 24 of 28 START test unique_dim_payment_type_id ................................. [RUN]
[0m17:22:22.630530 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_vendor_id.b9b2f380bb, now test.nyc_taxi.unique_dim_payment_type_id.dea55de04e)
[0m17:22:22.631681 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.unique_dim_payment_type_id.dea55de04e
[0m17:22:22.641166 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.unique_dim_payment_type_id.dea55de04e"
[0m17:22:22.647484 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.unique_dim_payment_type_id.dea55de04e
[0m17:22:22.652101 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.unique_dim_payment_type_id.dea55de04e"
[0m17:22:22.657613 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:22:22.661681 [debug] [Thread-1  ]: On test.nyc_taxi.unique_dim_payment_type_id.dea55de04e: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.unique_dim_payment_type_id.dea55de04e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select type_id as unique_field
  from `northern-shield-437204-m0`.`nyc_taxi`.`dim_payment`
  where type_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m17:22:23.576380 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:072ca67d-a94c-4330-a3dc-16bd244d9827&page=queryresults
[0m17:22:24.674893 [info ] [Thread-1  ]: 24 of 28 PASS unique_dim_payment_type_id ....................................... [[32mPASS[0m in 2.04s]
[0m17:22:24.677195 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.unique_dim_payment_type_id.dea55de04e
[0m17:22:24.678938 [debug] [Thread-1  ]: Began running node test.nyc_taxi.unique_dim_ratecode_rate_id.75ae8e4885
[0m17:22:24.680404 [info ] [Thread-1  ]: 25 of 28 START test unique_dim_ratecode_rate_id ................................ [RUN]
[0m17:22:24.682075 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.unique_dim_payment_type_id.dea55de04e, now test.nyc_taxi.unique_dim_ratecode_rate_id.75ae8e4885)
[0m17:22:24.683463 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.unique_dim_ratecode_rate_id.75ae8e4885
[0m17:22:24.691039 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.unique_dim_ratecode_rate_id.75ae8e4885"
[0m17:22:24.696895 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.unique_dim_ratecode_rate_id.75ae8e4885
[0m17:22:24.701937 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.unique_dim_ratecode_rate_id.75ae8e4885"
[0m17:22:24.707599 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:22:24.711078 [debug] [Thread-1  ]: On test.nyc_taxi.unique_dim_ratecode_rate_id.75ae8e4885: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.unique_dim_ratecode_rate_id.75ae8e4885"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select rate_id as unique_field
  from `northern-shield-437204-m0`.`nyc_taxi`.`dim_ratecode`
  where rate_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m17:22:25.610119 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:4af7437e-99c9-4b97-9dfb-883be000d5af&page=queryresults
[0m17:22:26.717781 [info ] [Thread-1  ]: 25 of 28 PASS unique_dim_ratecode_rate_id ...................................... [[32mPASS[0m in 2.04s]
[0m17:22:26.720470 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.unique_dim_ratecode_rate_id.75ae8e4885
[0m17:22:26.723181 [debug] [Thread-1  ]: Began running node test.nyc_taxi.unique_dim_vendor_id.03fad38d04
[0m17:22:26.724618 [info ] [Thread-1  ]: 26 of 28 START test unique_dim_vendor_id ....................................... [RUN]
[0m17:22:26.726132 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.unique_dim_ratecode_rate_id.75ae8e4885, now test.nyc_taxi.unique_dim_vendor_id.03fad38d04)
[0m17:22:26.727854 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.unique_dim_vendor_id.03fad38d04
[0m17:22:26.738196 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.unique_dim_vendor_id.03fad38d04"
[0m17:22:26.745936 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.unique_dim_vendor_id.03fad38d04
[0m17:22:26.752664 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.unique_dim_vendor_id.03fad38d04"
[0m17:22:26.760327 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:22:26.765089 [debug] [Thread-1  ]: On test.nyc_taxi.unique_dim_vendor_id.03fad38d04: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.unique_dim_vendor_id.03fad38d04"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select id as unique_field
  from `northern-shield-437204-m0`.`nyc_taxi`.`dim_vendor`
  where id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m17:22:27.659620 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:dc6b0d77-424f-4287-b486-d09d3cf72ebb&page=queryresults
[0m17:22:28.789960 [info ] [Thread-1  ]: 26 of 28 PASS unique_dim_vendor_id ............................................. [[32mPASS[0m in 2.06s]
[0m17:22:28.792095 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.unique_dim_vendor_id.03fad38d04
[0m17:22:28.793639 [debug] [Thread-1  ]: Began running node test.nyc_taxi.unique_dim_zone_location_id.7702f92424
[0m17:22:28.794882 [info ] [Thread-1  ]: 27 of 28 START test unique_dim_zone_location_id ................................ [RUN]
[0m17:22:28.796164 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.unique_dim_vendor_id.03fad38d04, now test.nyc_taxi.unique_dim_zone_location_id.7702f92424)
[0m17:22:28.797348 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.unique_dim_zone_location_id.7702f92424
[0m17:22:28.805162 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.unique_dim_zone_location_id.7702f92424"
[0m17:22:28.812894 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.unique_dim_zone_location_id.7702f92424
[0m17:22:28.818168 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.unique_dim_zone_location_id.7702f92424"
[0m17:22:28.825229 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:22:28.829431 [debug] [Thread-1  ]: On test.nyc_taxi.unique_dim_zone_location_id.7702f92424: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.unique_dim_zone_location_id.7702f92424"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select location_id as unique_field
  from `northern-shield-437204-m0`.`nyc_taxi`.`dim_zone`
  where location_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m17:22:29.758928 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:4cae4049-8781-4f45-a248-9da24a622409&page=queryresults
[0m17:22:30.952472 [info ] [Thread-1  ]: 27 of 28 PASS unique_dim_zone_location_id ...................................... [[32mPASS[0m in 2.16s]
[0m17:22:30.954545 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.unique_dim_zone_location_id.7702f92424
[0m17:22:30.955886 [debug] [Thread-1  ]: Began running node test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab
[0m17:22:30.957099 [info ] [Thread-1  ]: 28 of 28 START test unique_fct_trips_trip_id ................................... [RUN]
[0m17:22:30.958400 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.unique_dim_zone_location_id.7702f92424, now test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab)
[0m17:22:30.959565 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab
[0m17:22:30.966179 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab"
[0m17:22:30.972595 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab
[0m17:22:30.978193 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab"
[0m17:22:30.984411 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:22:30.988121 [debug] [Thread-1  ]: On test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select trip_id as unique_field
  from `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips`
  where trip_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m17:22:31.991336 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:b8dc51ab-7dbf-480e-b72d-90bc86e3950e&page=queryresults
[0m17:22:33.132922 [info ] [Thread-1  ]: 28 of 28 PASS unique_fct_trips_trip_id ......................................... [[32mPASS[0m in 2.17s]
[0m17:22:33.135395 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab
[0m17:22:33.141301 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:22:33.142325 [debug] [MainThread]: Connection 'test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab' was properly closed.
[0m17:22:33.143436 [info ] [MainThread]: 
[0m17:22:33.144812 [info ] [MainThread]: Finished running 28 data tests in 0 hours 0 minutes and 48.49 seconds (48.49s).
[0m17:22:33.155317 [debug] [MainThread]: Command end result
[0m17:22:33.243053 [info ] [MainThread]: 
[0m17:22:33.244542 [info ] [MainThread]: [31mCompleted with 7 errors and 0 warnings:[0m
[0m17:22:33.245671 [info ] [MainThread]: 
[0m17:22:33.246950 [error] [MainThread]:   Compilation Error in test conditional_values_fct_trips_fare_amount__test_fare_amount_positive (models/tests/schema.yml)
  'test_conditional_values' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m17:22:33.247988 [info ] [MainThread]: 
[0m17:22:33.249234 [error] [MainThread]:   Compilation Error in test conditional_values_fct_trips_mta_tax__test_mta_tax_positive (models/tests/schema.yml)
  'test_conditional_values' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m17:22:33.250275 [info ] [MainThread]: 
[0m17:22:33.251498 [error] [MainThread]:   Compilation Error in test conditional_values_fct_trips_tip_amount__test_tip_amount_positive (models/tests/schema.yml)
  'test_conditional_values' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m17:22:33.252697 [info ] [MainThread]: 
[0m17:22:33.254001 [error] [MainThread]:   Compilation Error in test conditional_values_fct_trips_tolls_amount__test_tolls_amount_positive (models/tests/schema.yml)
  'test_conditional_values' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m17:22:33.255064 [info ] [MainThread]: 
[0m17:22:33.256455 [error] [MainThread]:   Compilation Error in test conditional_values_fct_trips_total_amount__test_total_amount_positive (models/tests/schema.yml)
  'test_conditional_values' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m17:22:33.257613 [info ] [MainThread]: 
[0m17:22:33.258925 [error] [MainThread]: [31mFailure in test not_null_dim_zone_service_zone (models/tests/schema.yml)[0m
[0m17:22:33.260240 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m17:22:33.261258 [info ] [MainThread]: 
[0m17:22:33.262483 [info ] [MainThread]:   compiled code at target/compiled/nyc_taxi/models/tests/schema.yml/not_null_dim_zone_service_zone.sql
[0m17:22:33.263877 [info ] [MainThread]: 
[0m17:22:33.265042 [error] [MainThread]: [31mFailure in test not_null_dim_zone_zone (models/tests/schema.yml)[0m
[0m17:22:33.266121 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m17:22:33.267065 [info ] [MainThread]: 
[0m17:22:33.268113 [info ] [MainThread]:   compiled code at target/compiled/nyc_taxi/models/tests/schema.yml/not_null_dim_zone_zone.sql
[0m17:22:33.269123 [info ] [MainThread]: 
[0m17:22:33.270114 [info ] [MainThread]: Done. PASS=21 WARN=0 ERROR=7 SKIP=0 TOTAL=28
[0m17:22:33.271933 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 55.43154, "process_in_blocks": "0", "process_kernel_time": 0.447504, "process_mem_max_rss": "244984", "process_out_blocks": "0", "process_user_time": 7.017256}
[0m17:22:33.273340 [debug] [MainThread]: Command `dbt test` failed at 17:22:33.273146 after 55.43 seconds
[0m17:22:33.274441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6feea5c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6fd3ddd60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6f010f0a0>]}
[0m17:22:33.275360 [debug] [MainThread]: Flushing usage events
[0m17:29:47.700619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5164c72c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51631727f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5162af8550>]}


============================== 17:29:47.708933 | 3e7c4921-8958-492a-abd4-812b02cbf505 ==============================
[0m17:29:47.708933 [info ] [MainThread]: Running with dbt=1.8.9
[0m17:29:47.710649 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'log_format': 'default', 'warn_error': 'None', 'empty': 'False', 'use_colors': 'True', 'static_parser': 'True', 'write_json': 'True', 'profiles_dir': '/opt/airflow/include/dbt/', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'debug': 'False', 'partial_parse': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/include/dbt/', 'fail_fast': 'False', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'log_path': '/opt/airflow/include/dbt/logs', 'cache_selected_only': 'False', 'target_path': 'None', 'no_print': 'None', 'printer_width': '80'}
[0m17:29:49.021942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3e7c4921-8958-492a-abd4-812b02cbf505', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5164425640>]}
[0m17:29:49.091348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3e7c4921-8958-492a-abd4-812b02cbf505', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5164fb3130>]}
[0m17:29:49.093282 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m17:29:49.274839 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m17:29:50.074710 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:29:50.076455 [debug] [MainThread]: Partial parsing: updated file: nyc_taxi://models/transform/dim_zone.sql
[0m17:29:50.484235 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m17:29:50.485913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '3e7c4921-8958-492a-abd4-812b02cbf505', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f515ddc0430>]}
[0m17:29:50.752722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3e7c4921-8958-492a-abd4-812b02cbf505', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f515ab5e130>]}
[0m17:29:50.939692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3e7c4921-8958-492a-abd4-812b02cbf505', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f515dfc6070>]}
[0m17:29:50.941099 [info ] [MainThread]: Found 5 models, 28 data tests, 2 sources, 600 macros
[0m17:29:50.942600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3e7c4921-8958-492a-abd4-812b02cbf505', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f515ab525e0>]}
[0m17:29:50.946118 [info ] [MainThread]: 
[0m17:29:50.947945 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:29:50.955620 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_northern-shield-437204-m0'
[0m17:29:50.957059 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:29:52.778887 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_northern-shield-437204-m0, now list_northern-shield-437204-m0_nyc_taxi)
[0m17:29:52.780454 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:29:51.623563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3e7c4921-8958-492a-abd4-812b02cbf505', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5164c5c2b0>]}
[0m17:29:51.625021 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:29:51.626126 [info ] [MainThread]: 
[0m17:29:51.634061 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_payment
[0m17:29:51.635899 [info ] [Thread-1  ]: 1 of 5 START sql table model nyc_taxi.dim_payment .............................. [RUN]
[0m17:29:51.637526 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_northern-shield-437204-m0_nyc_taxi, now model.nyc_taxi.dim_payment)
[0m17:29:51.638598 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_payment
[0m17:29:51.650336 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_payment"
[0m17:29:51.656541 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_payment
[0m17:29:51.677005 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:29:52.333881 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.dim_payment"
[0m17:29:52.340066 [debug] [Thread-1  ]: On model.nyc_taxi.dim_payment: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.dim_payment"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`dim_payment`
      
    
    

    OPTIONS()
    as (
      WITH payment_cte AS(
    SELECT DISTINCT
        payment_type AS type_id,
        CASE 
            WHEN payment_type = 1 THEN "Credit card"
            WHEN payment_type = 2 THEN "Cash"
            WHEN payment_type = 3 THEN "No charge"
            WHEN payment_type = 4 THEN "Dispute"
            WHEN payment_type = 5 THEN "Unknown"
            WHEN payment_type = 6 THEN "Voided trip"
        END AS payment_name
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata`
)
SELECT
    type_id,
    payment_name
FROM payment_cte
    );
  
[0m17:29:52.947847 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:c9ab668a-9760-4692-b2b7-91626cadd54c&page=queryresults
[0m17:29:55.542282 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3e7c4921-8958-492a-abd4-812b02cbf505', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f513035f370>]}
[0m17:29:55.544027 [info ] [Thread-1  ]: 1 of 5 OK created sql table model nyc_taxi.dim_payment ......................... [[32mCREATE TABLE (4.0 rows, 463.5 KiB processed)[0m in 3.90s]
[0m17:29:55.545959 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_payment
[0m17:29:55.547406 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_ratecode
[0m17:29:55.548613 [info ] [Thread-1  ]: 2 of 5 START sql table model nyc_taxi.dim_ratecode ............................. [RUN]
[0m17:29:55.549814 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_payment, now model.nyc_taxi.dim_ratecode)
[0m17:29:55.550801 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_ratecode
[0m17:29:55.556944 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_ratecode"
[0m17:29:55.562509 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_ratecode
[0m17:29:55.567138 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:29:56.180864 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.dim_ratecode"
[0m17:29:56.187265 [debug] [Thread-1  ]: On model.nyc_taxi.dim_ratecode: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.dim_ratecode"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`dim_ratecode`
      
    
    

    OPTIONS()
    as (
      WITH rate_code_cte AS(
    SELECT DISTINCT
        rate_code_id AS rate_id,
        CASE 
            WHEN rate_code_id = 1 THEN "Standard rate"
            WHEN rate_code_id = 2 THEN "JFK"
            WHEN rate_code_id = 3 THEN "Newark"
            WHEN rate_code_id = 4 THEN "Nassau or Westchester"
            WHEN rate_code_id = 5 THEN "Negotiated fare"
            WHEN rate_code_id = 6 THEN "Group ride"
        ELSE "Unknown"
        END AS rate_code_name
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata`
)
SELECT
    rate_id,
    rate_code_name
FROM rate_code_cte
    );
  
[0m17:29:56.764552 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:a4e76fff-9289-4e9a-82dc-d93e65d8d722&page=queryresults
[0m17:29:59.692235 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3e7c4921-8958-492a-abd4-812b02cbf505', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f513035f370>]}
[0m17:29:59.693929 [info ] [Thread-1  ]: 2 of 5 OK created sql table model nyc_taxi.dim_ratecode ........................ [[32mCREATE TABLE (6.0 rows, 463.5 KiB processed)[0m in 4.14s]
[0m17:29:59.695916 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_ratecode
[0m17:29:59.697418 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_vendor
[0m17:29:59.698837 [info ] [Thread-1  ]: 3 of 5 START sql table model nyc_taxi.dim_vendor ............................... [RUN]
[0m17:29:59.700290 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_ratecode, now model.nyc_taxi.dim_vendor)
[0m17:29:59.701605 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_vendor
[0m17:29:59.707860 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_vendor"
[0m17:29:59.713261 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_vendor
[0m17:29:59.718306 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:30:00.327745 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.dim_vendor"
[0m17:30:00.335841 [debug] [Thread-1  ]: On model.nyc_taxi.dim_vendor: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.dim_vendor"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`dim_vendor`
      
    
    

    OPTIONS()
    as (
      WITH vendor_cte AS(
    SELECT DISTINCT
        vendor_id AS id,
        CASE 
            WHEN vendor_id = 1 THEN "Creative Mobile Technologies"
            WHEN vendor_id = 2 THEN "VeriFone Inc."
        END AS vendor_name
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata`
)
SELECT
    id,
    vendor_name
FROM vendor_cte
    );
  
[0m17:30:00.895674 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:88888ac5-eef5-4620-804e-02b79d1434ad&page=queryresults
[0m17:30:03.466790 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3e7c4921-8958-492a-abd4-812b02cbf505', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f513035f370>]}
[0m17:30:03.468561 [info ] [Thread-1  ]: 3 of 5 OK created sql table model nyc_taxi.dim_vendor .......................... [[32mCREATE TABLE (2.0 rows, 463.5 KiB processed)[0m in 3.77s]
[0m17:30:03.470464 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_vendor
[0m17:30:03.471877 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_zone
[0m17:30:03.473243 [info ] [Thread-1  ]: 4 of 5 START sql table model nyc_taxi.dim_zone ................................. [RUN]
[0m17:30:03.474559 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_vendor, now model.nyc_taxi.dim_zone)
[0m17:30:03.475707 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_zone
[0m17:30:03.480939 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_zone"
[0m17:30:03.487540 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_zone
[0m17:30:03.494597 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:30:04.219461 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.dim_zone"
[0m17:30:04.225115 [debug] [Thread-1  ]: On model.nyc_taxi.dim_zone: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.dim_zone"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`dim_zone`
      
    
    

    OPTIONS()
    as (
      SELECT DISTINCT
    location_id,
    borough,
    zone,
    replace(service_zone, 'Boro', 'Green') as service_zone
FROM `northern-shield-437204-m0`.`nyc_taxi`.`zone_map`
WHERE borough != 'Unknown' or borough is not null
    );
  
[0m17:30:04.781948 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:cff075d3-791d-4c0a-92e9-69db294674fb&page=queryresults
[0m17:30:07.383840 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3e7c4921-8958-492a-abd4-812b02cbf505', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f516379adf0>]}
[0m17:30:07.385726 [info ] [Thread-1  ]: 4 of 5 OK created sql table model nyc_taxi.dim_zone ............................ [[32mCREATE TABLE (264.0 rows, 24.2 KiB processed)[0m in 3.91s]
[0m17:30:07.387974 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_zone
[0m17:30:07.389732 [debug] [Thread-1  ]: Began running node model.nyc_taxi.fct_trips
[0m17:30:07.391098 [info ] [Thread-1  ]: 5 of 5 START sql table model nyc_taxi.fct_trips ................................ [RUN]
[0m17:30:07.392508 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_zone, now model.nyc_taxi.fct_trips)
[0m17:30:07.393826 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.fct_trips
[0m17:30:07.416719 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.fct_trips"
[0m17:30:07.422491 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.fct_trips
[0m17:30:07.426928 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:30:08.034362 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.fct_trips"
[0m17:30:08.041424 [debug] [Thread-1  ]: On model.nyc_taxi.fct_trips: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.fct_trips"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips`
      
    
    

    OPTIONS()
    as (
      WITH tripdata_cte AS (
    SELECT 
        to_hex(md5(cast(coalesce(cast(vendor_id as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(lpep_pickup_datetime as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(lpep_dropoff_datetime as string), '_dbt_utils_surrogate_key_null_') as string)))  AS trip_id,
        t.vendor_id,
        t.lpep_pickup_datetime AS pickup_time,
        t.lpep_dropoff_datetime AS dropoff_time,
        t.rate_code_id,
        t.pu_location_id,
        t.do_location_id,
        t.passenger_count,
        t.trip_distance,
        t.fare_amount,
        t.extra,
        t.mta_tax,
        t.tip_amount,
        t.tolls_amount,
        t.improvement_surcharge,
        t.total_amount,
        t.payment_type,
        t.trip_type,
        t.congestion_surcharge
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata` AS t
    WHERE vendor_id IS NOT NULL
)
SELECT 
    trip_id,
    vendor_id,
    pickup_time,
    dropoff_time,
    rate_code_id,
    pu_location_id,
    do_location_id,
    passenger_count,
    trip_distance,
    fare_amount,
    extra,
    mta_tax,
    tip_amount,
    tolls_amount,
    improvement_surcharge,
    total_amount,
    payment_type,
    trip_type,
    congestion_surcharge
FROM tripdata_cte
    );
  
[0m17:30:08.618934 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:3f41c39e-a01d-4449-ba07-d2d0b14264a8&page=queryresults
[0m17:30:12.499443 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3e7c4921-8958-492a-abd4-812b02cbf505', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f515d250280>]}
[0m17:30:12.501444 [info ] [Thread-1  ]: 5 of 5 OK created sql table model nyc_taxi.fct_trips ........................... [[32mCREATE TABLE (59.3k rows, 8.1 MiB processed)[0m in 5.11s]
[0m17:30:12.503861 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.fct_trips
[0m17:30:12.506530 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:30:12.507707 [debug] [MainThread]: Connection 'model.nyc_taxi.fct_trips' was properly closed.
[0m17:30:12.509060 [info ] [MainThread]: 
[0m17:30:12.510311 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 21.56 seconds (21.56s).
[0m17:30:12.514239 [debug] [MainThread]: Command end result
[0m17:30:12.588318 [info ] [MainThread]: 
[0m17:30:12.589738 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:30:12.590940 [info ] [MainThread]: 
[0m17:30:12.592173 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m17:30:12.594251 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 26.730042, "process_in_blocks": "0", "process_kernel_time": 0.341467, "process_mem_max_rss": "244644", "process_out_blocks": "0", "process_user_time": 5.966194}
[0m17:30:12.595571 [debug] [MainThread]: Command `dbt run` succeeded at 17:30:12.595404 after 26.73 seconds
[0m17:30:12.596615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5164c72c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5164fb3130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5164425640>]}
[0m17:30:12.597708 [debug] [MainThread]: Flushing usage events
[0m17:40:23.687738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f364dc7dfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f364bb82e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f364bb82df0>]}


============================== 17:40:23.696634 | 5977f59a-6896-4f85-b825-4520a812bf3a ==============================
[0m17:40:23.696634 [info ] [MainThread]: Running with dbt=1.8.9
[0m17:40:23.698339 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'write_json': 'True', 'log_path': '/opt/airflow/include/dbt/logs', 'use_experimental_parser': 'False', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'invocation_command': 'dbt test --profiles-dir /opt/airflow/include/dbt/', 'log_format': 'default', 'indirect_selection': 'eager', 'fail_fast': 'False', 'cache_selected_only': 'False', 'static_parser': 'True', 'no_print': 'None', 'introspect': 'True', 'debug': 'False', 'use_colors': 'True', 'printer_width': '80', 'log_cache_events': 'False', 'version_check': 'True', 'empty': 'None', 'profiles_dir': '/opt/airflow/include/dbt/'}
[0m17:40:24.945281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5977f59a-6896-4f85-b825-4520a812bf3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f364bb58970>]}
[0m17:40:25.015260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5977f59a-6896-4f85-b825-4520a812bf3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36194c0eb0>]}
[0m17:40:25.017290 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m17:40:25.188575 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m17:40:25.922887 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:40:25.923961 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:40:25.992285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5977f59a-6896-4f85-b825-4520a812bf3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3646e26f10>]}
[0m17:40:26.310512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5977f59a-6896-4f85-b825-4520a812bf3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36186f8460>]}
[0m17:40:26.311944 [info ] [MainThread]: Found 5 models, 28 data tests, 2 sources, 600 macros
[0m17:40:26.313122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5977f59a-6896-4f85-b825-4520a812bf3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3646f25b50>]}
[0m17:40:26.318027 [info ] [MainThread]: 
[0m17:40:26.319800 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:40:26.326704 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_northern-shield-437204-m0_nyc_taxi'
[0m17:40:26.327817 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:40:27.015993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5977f59a-6896-4f85-b825-4520a812bf3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f364d46f160>]}
[0m17:40:27.017346 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:40:27.018371 [info ] [MainThread]: 
[0m17:40:27.027104 [debug] [Thread-1  ]: Began running node test.nyc_taxi.accepted_values_dim_payment_payment_name__Credit_card__Cash__No_charge__Dispute__Unknown__Voided_trip.58d00ef9f4
[0m17:40:27.028520 [info ] [Thread-1  ]: 1 of 28 START test accepted_values_dim_payment_payment_name__Credit_card__Cash__No_charge__Dispute__Unknown__Voided_trip  [RUN]
[0m17:40:27.029850 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_northern-shield-437204-m0_nyc_taxi, now test.nyc_taxi.accepted_values_dim_payment_payment_name__Credit_card__Cash__No_charge__Dispute__Unknown__Voided_trip.58d00ef9f4)
[0m17:40:27.030918 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.accepted_values_dim_payment_payment_name__Credit_card__Cash__No_charge__Dispute__Unknown__Voided_trip.58d00ef9f4
[0m17:40:27.059801 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.accepted_values_dim_payment_payment_name__Credit_card__Cash__No_charge__Dispute__Unknown__Voided_trip.58d00ef9f4"
[0m17:40:27.067580 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.accepted_values_dim_payment_payment_name__Credit_card__Cash__No_charge__Dispute__Unknown__Voided_trip.58d00ef9f4
[0m17:40:27.095135 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.accepted_values_dim_payment_payment_name__Credit_card__Cash__No_charge__Dispute__Unknown__Voided_trip.58d00ef9f4"
[0m17:40:27.102592 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:40:27.106309 [debug] [Thread-1  ]: On test.nyc_taxi.accepted_values_dim_payment_payment_name__Credit_card__Cash__No_charge__Dispute__Unknown__Voided_trip.58d00ef9f4: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.accepted_values_dim_payment_payment_name__Credit_card__Cash__No_charge__Dispute__Unknown__Voided_trip.58d00ef9f4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        payment_name as value_field,
        count(*) as n_records

    from `northern-shield-437204-m0`.`nyc_taxi`.`dim_payment`
    group by payment_name

)

select *
from all_values
where value_field not in (
    'Credit card','Cash','No charge','Dispute','Unknown','Voided trip'
)



      
    ) dbt_internal_test
[0m17:40:28.080817 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:0d3c41f5-1dac-4de2-baf3-3c705f986221&page=queryresults
[0m17:40:29.235027 [info ] [Thread-1  ]: 1 of 28 PASS accepted_values_dim_payment_payment_name__Credit_card__Cash__No_charge__Dispute__Unknown__Voided_trip  [[32mPASS[0m in 2.21s]
[0m17:40:29.237555 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.accepted_values_dim_payment_payment_name__Credit_card__Cash__No_charge__Dispute__Unknown__Voided_trip.58d00ef9f4
[0m17:40:29.239237 [debug] [Thread-1  ]: Began running node test.nyc_taxi.accepted_values_dim_ratecode_rate_code_name__Standard_rate__JFK__Newark__Nassau_or_Westchester__Negotiated_fare__Group_ride__Unknown.57ee02019f
[0m17:40:29.240652 [info ] [Thread-1  ]: 2 of 28 START test accepted_values_dim_ratecode_rate_code_name__Standard_rate__JFK__Newark__Nassau_or_Westchester__Negotiated_fare__Group_ride__Unknown  [RUN]
[0m17:40:29.242221 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.accepted_values_dim_payment_payment_name__Credit_card__Cash__No_charge__Dispute__Unknown__Voided_trip.58d00ef9f4, now test.nyc_taxi.accepted_values_dim_ratecode_rate_code_name__Standard_rate__JFK__Newark__Nassau_or_Westchester__Negotiated_fare__Group_ride__Unknown.57ee02019f)
[0m17:40:29.243847 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.accepted_values_dim_ratecode_rate_code_name__Standard_rate__JFK__Newark__Nassau_or_Westchester__Negotiated_fare__Group_ride__Unknown.57ee02019f
[0m17:40:29.254790 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.accepted_values_dim_ratecode_rate_code_name__Standard_rate__JFK__Newark__Nassau_or_Westchester__Negotiated_fare__Group_ride__Unknown.57ee02019f"
[0m17:40:29.261129 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.accepted_values_dim_ratecode_rate_code_name__Standard_rate__JFK__Newark__Nassau_or_Westchester__Negotiated_fare__Group_ride__Unknown.57ee02019f
[0m17:40:29.267368 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.accepted_values_dim_ratecode_rate_code_name__Standard_rate__JFK__Newark__Nassau_or_Westchester__Negotiated_fare__Group_ride__Unknown.57ee02019f"
[0m17:40:29.273400 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:40:29.276523 [debug] [Thread-1  ]: On test.nyc_taxi.accepted_values_dim_ratecode_rate_code_name__Standard_rate__JFK__Newark__Nassau_or_Westchester__Negotiated_fare__Group_ride__Unknown.57ee02019f: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.accepted_values_dim_ratecode_rate_code_name__Standard_rate__JFK__Newark__Nassau_or_Westchester__Negotiated_fare__Group_ride__Unknown.57ee02019f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        rate_code_name as value_field,
        count(*) as n_records

    from `northern-shield-437204-m0`.`nyc_taxi`.`dim_ratecode`
    group by rate_code_name

)

select *
from all_values
where value_field not in (
    'Standard rate','JFK','Newark','Nassau or Westchester','Negotiated fare','Group ride','Unknown'
)



      
    ) dbt_internal_test
[0m17:40:30.280458 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:8c99345a-a81f-4a13-bd04-3b2f7500a957&page=queryresults
[0m17:40:31.459327 [info ] [Thread-1  ]: 2 of 28 PASS accepted_values_dim_ratecode_rate_code_name__Standard_rate__JFK__Newark__Nassau_or_Westchester__Negotiated_fare__Group_ride__Unknown  [[32mPASS[0m in 2.22s]
[0m17:40:31.461528 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.accepted_values_dim_ratecode_rate_code_name__Standard_rate__JFK__Newark__Nassau_or_Westchester__Negotiated_fare__Group_ride__Unknown.57ee02019f
[0m17:40:31.463075 [debug] [Thread-1  ]: Began running node test.nyc_taxi.accepted_values_dim_vendor_vendor_name__Creative_Mobile_Technologies__VeriFone_Inc_.7481cecf07
[0m17:40:31.464202 [info ] [Thread-1  ]: 3 of 28 START test accepted_values_dim_vendor_vendor_name__Creative_Mobile_Technologies__VeriFone_Inc_  [RUN]
[0m17:40:31.465622 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.accepted_values_dim_ratecode_rate_code_name__Standard_rate__JFK__Newark__Nassau_or_Westchester__Negotiated_fare__Group_ride__Unknown.57ee02019f, now test.nyc_taxi.accepted_values_dim_vendor_vendor_name__Creative_Mobile_Technologies__VeriFone_Inc_.7481cecf07)
[0m17:40:31.466917 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.accepted_values_dim_vendor_vendor_name__Creative_Mobile_Technologies__VeriFone_Inc_.7481cecf07
[0m17:40:31.476401 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.accepted_values_dim_vendor_vendor_name__Creative_Mobile_Technologies__VeriFone_Inc_.7481cecf07"
[0m17:40:31.482179 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.accepted_values_dim_vendor_vendor_name__Creative_Mobile_Technologies__VeriFone_Inc_.7481cecf07
[0m17:40:31.488769 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.accepted_values_dim_vendor_vendor_name__Creative_Mobile_Technologies__VeriFone_Inc_.7481cecf07"
[0m17:40:31.495523 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:40:31.499478 [debug] [Thread-1  ]: On test.nyc_taxi.accepted_values_dim_vendor_vendor_name__Creative_Mobile_Technologies__VeriFone_Inc_.7481cecf07: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.accepted_values_dim_vendor_vendor_name__Creative_Mobile_Technologies__VeriFone_Inc_.7481cecf07"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        vendor_name as value_field,
        count(*) as n_records

    from `northern-shield-437204-m0`.`nyc_taxi`.`dim_vendor`
    group by vendor_name

)

select *
from all_values
where value_field not in (
    'Creative Mobile Technologies','VeriFone Inc.'
)



      
    ) dbt_internal_test
[0m17:40:32.479605 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:c8a266cb-b6bb-4fe6-9fde-441da4528d19&page=queryresults
[0m17:40:33.621632 [info ] [Thread-1  ]: 3 of 28 PASS accepted_values_dim_vendor_vendor_name__Creative_Mobile_Technologies__VeriFone_Inc_  [[32mPASS[0m in 2.16s]
[0m17:40:33.623891 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.accepted_values_dim_vendor_vendor_name__Creative_Mobile_Technologies__VeriFone_Inc_.7481cecf07
[0m17:40:33.625294 [debug] [Thread-1  ]: Began running node test.nyc_taxi.conditional_values_fct_trips_fare_amount__test_fare_amount_positive.42cfe6599e
[0m17:40:33.626465 [info ] [Thread-1  ]: 4 of 28 START test conditional_values_fct_trips_fare_amount__test_fare_amount_positive  [RUN]
[0m17:40:33.627827 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.accepted_values_dim_vendor_vendor_name__Creative_Mobile_Technologies__VeriFone_Inc_.7481cecf07, now test.nyc_taxi.conditional_values_fct_trips_fare_amount__test_fare_amount_positive.42cfe6599e)
[0m17:40:33.628943 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.conditional_values_fct_trips_fare_amount__test_fare_amount_positive.42cfe6599e
[0m17:40:33.638210 [debug] [Thread-1  ]: Compilation Error in test conditional_values_fct_trips_fare_amount__test_fare_amount_positive (models/tests/schema.yml)
  'test_conditional_values' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m17:40:33.639637 [error] [Thread-1  ]: 4 of 28 ERROR conditional_values_fct_trips_fare_amount__test_fare_amount_positive  [[31mERROR[0m in 0.01s]
[0m17:40:33.641324 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.conditional_values_fct_trips_fare_amount__test_fare_amount_positive.42cfe6599e
[0m17:40:33.642943 [debug] [Thread-1  ]: Began running node test.nyc_taxi.conditional_values_fct_trips_mta_tax__test_mta_tax_positive.21bb3dd018
[0m17:40:33.644428 [info ] [Thread-1  ]: 5 of 28 START test conditional_values_fct_trips_mta_tax__test_mta_tax_positive . [RUN]
[0m17:40:33.645769 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.conditional_values_fct_trips_fare_amount__test_fare_amount_positive.42cfe6599e, now test.nyc_taxi.conditional_values_fct_trips_mta_tax__test_mta_tax_positive.21bb3dd018)
[0m17:40:33.646793 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.conditional_values_fct_trips_mta_tax__test_mta_tax_positive.21bb3dd018
[0m17:40:33.655005 [debug] [Thread-1  ]: Compilation Error in test conditional_values_fct_trips_mta_tax__test_mta_tax_positive (models/tests/schema.yml)
  'test_conditional_values' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m17:40:33.656607 [error] [Thread-1  ]: 5 of 28 ERROR conditional_values_fct_trips_mta_tax__test_mta_tax_positive ...... [[31mERROR[0m in 0.01s]
[0m17:40:33.658151 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.conditional_values_fct_trips_mta_tax__test_mta_tax_positive.21bb3dd018
[0m17:40:33.659383 [debug] [Thread-1  ]: Began running node test.nyc_taxi.conditional_values_fct_trips_tip_amount__test_tip_amount_positive.cc3a05edfa
[0m17:40:33.660442 [info ] [Thread-1  ]: 6 of 28 START test conditional_values_fct_trips_tip_amount__test_tip_amount_positive  [RUN]
[0m17:40:33.661609 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.conditional_values_fct_trips_mta_tax__test_mta_tax_positive.21bb3dd018, now test.nyc_taxi.conditional_values_fct_trips_tip_amount__test_tip_amount_positive.cc3a05edfa)
[0m17:40:33.662691 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.conditional_values_fct_trips_tip_amount__test_tip_amount_positive.cc3a05edfa
[0m17:40:33.671069 [debug] [Thread-1  ]: Compilation Error in test conditional_values_fct_trips_tip_amount__test_tip_amount_positive (models/tests/schema.yml)
  'test_conditional_values' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m17:40:33.672607 [error] [Thread-1  ]: 6 of 28 ERROR conditional_values_fct_trips_tip_amount__test_tip_amount_positive  [[31mERROR[0m in 0.01s]
[0m17:40:33.674432 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.conditional_values_fct_trips_tip_amount__test_tip_amount_positive.cc3a05edfa
[0m17:40:33.675895 [debug] [Thread-1  ]: Began running node test.nyc_taxi.conditional_values_fct_trips_tolls_amount__test_tolls_amount_positive.b5e4e898c5
[0m17:40:33.677125 [info ] [Thread-1  ]: 7 of 28 START test conditional_values_fct_trips_tolls_amount__test_tolls_amount_positive  [RUN]
[0m17:40:33.678451 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.conditional_values_fct_trips_tip_amount__test_tip_amount_positive.cc3a05edfa, now test.nyc_taxi.conditional_values_fct_trips_tolls_amount__test_tolls_amount_positive.b5e4e898c5)
[0m17:40:33.679636 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.conditional_values_fct_trips_tolls_amount__test_tolls_amount_positive.b5e4e898c5
[0m17:40:33.689886 [debug] [Thread-1  ]: Compilation Error in test conditional_values_fct_trips_tolls_amount__test_tolls_amount_positive (models/tests/schema.yml)
  'test_conditional_values' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m17:40:33.691552 [error] [Thread-1  ]: 7 of 28 ERROR conditional_values_fct_trips_tolls_amount__test_tolls_amount_positive  [[31mERROR[0m in 0.01s]
[0m17:40:33.693142 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.conditional_values_fct_trips_tolls_amount__test_tolls_amount_positive.b5e4e898c5
[0m17:40:33.694393 [debug] [Thread-1  ]: Began running node test.nyc_taxi.conditional_values_fct_trips_total_amount__test_total_amount_positive.1bd69ecc4e
[0m17:40:33.695502 [info ] [Thread-1  ]: 8 of 28 START test conditional_values_fct_trips_total_amount__test_total_amount_positive  [RUN]
[0m17:40:33.696712 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.conditional_values_fct_trips_tolls_amount__test_tolls_amount_positive.b5e4e898c5, now test.nyc_taxi.conditional_values_fct_trips_total_amount__test_total_amount_positive.1bd69ecc4e)
[0m17:40:33.697767 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.conditional_values_fct_trips_total_amount__test_total_amount_positive.1bd69ecc4e
[0m17:40:33.706146 [debug] [Thread-1  ]: Compilation Error in test conditional_values_fct_trips_total_amount__test_total_amount_positive (models/tests/schema.yml)
  'test_conditional_values' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m17:40:33.707657 [error] [Thread-1  ]: 8 of 28 ERROR conditional_values_fct_trips_total_amount__test_total_amount_positive  [[31mERROR[0m in 0.01s]
[0m17:40:33.709190 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.conditional_values_fct_trips_total_amount__test_total_amount_positive.1bd69ecc4e
[0m17:40:33.710387 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_dim_payment_type_id.96dfa722aa
[0m17:40:33.711428 [info ] [Thread-1  ]: 9 of 28 START test not_null_dim_payment_type_id ................................ [RUN]
[0m17:40:33.712621 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.conditional_values_fct_trips_total_amount__test_total_amount_positive.1bd69ecc4e, now test.nyc_taxi.not_null_dim_payment_type_id.96dfa722aa)
[0m17:40:33.713686 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_dim_payment_type_id.96dfa722aa
[0m17:40:33.723934 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_dim_payment_type_id.96dfa722aa"
[0m17:40:33.729933 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_dim_payment_type_id.96dfa722aa
[0m17:40:33.734914 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_dim_payment_type_id.96dfa722aa"
[0m17:40:33.741713 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:40:33.745687 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_dim_payment_type_id.96dfa722aa: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_dim_payment_type_id.96dfa722aa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select type_id
from `northern-shield-437204-m0`.`nyc_taxi`.`dim_payment`
where type_id is null



      
    ) dbt_internal_test
[0m17:40:34.620428 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:380d2127-cf35-4f71-9e05-d7989b8a48fc&page=queryresults
[0m17:40:35.745601 [info ] [Thread-1  ]: 9 of 28 PASS not_null_dim_payment_type_id ...................................... [[32mPASS[0m in 2.03s]
[0m17:40:35.747534 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_dim_payment_type_id.96dfa722aa
[0m17:40:35.748903 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_dim_zone_borough.1ed2272c52
[0m17:40:35.750008 [info ] [Thread-1  ]: 10 of 28 START test not_null_dim_zone_borough .................................. [RUN]
[0m17:40:35.751342 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_dim_payment_type_id.96dfa722aa, now test.nyc_taxi.not_null_dim_zone_borough.1ed2272c52)
[0m17:40:35.752459 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_dim_zone_borough.1ed2272c52
[0m17:40:35.758787 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_dim_zone_borough.1ed2272c52"
[0m17:40:35.765011 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_dim_zone_borough.1ed2272c52
[0m17:40:35.771700 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_dim_zone_borough.1ed2272c52"
[0m17:40:35.778187 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:40:35.781803 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_dim_zone_borough.1ed2272c52: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_dim_zone_borough.1ed2272c52"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select borough
from `northern-shield-437204-m0`.`nyc_taxi`.`dim_zone`
where borough is null



      
    ) dbt_internal_test
[0m17:40:36.725406 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:47b1abd4-1ec5-4c83-bb36-c59c5953d07b&page=queryresults
[0m17:40:37.864456 [info ] [Thread-1  ]: 10 of 28 PASS not_null_dim_zone_borough ........................................ [[32mPASS[0m in 2.11s]
[0m17:40:37.866909 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_dim_zone_borough.1ed2272c52
[0m17:40:37.868993 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_dim_zone_service_zone.2007f611c5
[0m17:40:37.870429 [info ] [Thread-1  ]: 11 of 28 START test not_null_dim_zone_service_zone ............................. [RUN]
[0m17:40:37.871967 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_dim_zone_borough.1ed2272c52, now test.nyc_taxi.not_null_dim_zone_service_zone.2007f611c5)
[0m17:40:37.873209 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_dim_zone_service_zone.2007f611c5
[0m17:40:37.880890 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_dim_zone_service_zone.2007f611c5"
[0m17:40:37.887219 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_dim_zone_service_zone.2007f611c5
[0m17:40:37.892204 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_dim_zone_service_zone.2007f611c5"
[0m17:40:37.898899 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:40:37.902658 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_dim_zone_service_zone.2007f611c5: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_dim_zone_service_zone.2007f611c5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select service_zone
from `northern-shield-437204-m0`.`nyc_taxi`.`dim_zone`
where service_zone is null



      
    ) dbt_internal_test
[0m17:40:38.709706 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:7db721b9-6816-4e7e-a25f-e12d1d3bc8df&page=queryresults
[0m17:40:39.813155 [info ] [Thread-1  ]: 11 of 28 PASS not_null_dim_zone_service_zone ................................... [[32mPASS[0m in 1.94s]
[0m17:40:39.815681 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_dim_zone_service_zone.2007f611c5
[0m17:40:39.817629 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_dim_zone_zone.a1c4a4c37a
[0m17:40:39.818936 [info ] [Thread-1  ]: 12 of 28 START test not_null_dim_zone_zone ..................................... [RUN]
[0m17:40:39.820390 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_dim_zone_service_zone.2007f611c5, now test.nyc_taxi.not_null_dim_zone_zone.a1c4a4c37a)
[0m17:40:39.821952 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_dim_zone_zone.a1c4a4c37a
[0m17:40:39.829677 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_dim_zone_zone.a1c4a4c37a"
[0m17:40:39.836055 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_dim_zone_zone.a1c4a4c37a
[0m17:40:39.840908 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_dim_zone_zone.a1c4a4c37a"
[0m17:40:39.847370 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:40:39.857079 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_dim_zone_zone.a1c4a4c37a: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_dim_zone_zone.a1c4a4c37a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select zone
from `northern-shield-437204-m0`.`nyc_taxi`.`dim_zone`
where zone is null



      
    ) dbt_internal_test
[0m17:40:40.701416 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:d055cf24-b35f-4150-b703-ae967c813109&page=queryresults
[0m17:40:41.829708 [info ] [Thread-1  ]: 12 of 28 PASS not_null_dim_zone_zone ........................................... [[32mPASS[0m in 2.01s]
[0m17:40:41.832093 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_dim_zone_zone.a1c4a4c37a
[0m17:40:41.836776 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_do_location_id.6acdd302a6
[0m17:40:41.838334 [info ] [Thread-1  ]: 13 of 28 START test not_null_fct_trips_do_location_id .......................... [RUN]
[0m17:40:41.839830 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_dim_zone_zone.a1c4a4c37a, now test.nyc_taxi.not_null_fct_trips_do_location_id.6acdd302a6)
[0m17:40:41.841148 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_do_location_id.6acdd302a6
[0m17:40:41.850381 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_do_location_id.6acdd302a6"
[0m17:40:41.857160 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_do_location_id.6acdd302a6
[0m17:40:41.862445 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_fct_trips_do_location_id.6acdd302a6"
[0m17:40:41.870779 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:40:41.875077 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_fct_trips_do_location_id.6acdd302a6: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_fct_trips_do_location_id.6acdd302a6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select do_location_id
from `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips`
where do_location_id is null



      
    ) dbt_internal_test
[0m17:40:41.000817 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:061af379-aaa3-4af9-a890-33fa69fe4a2f&page=queryresults
[0m17:40:42.140913 [info ] [Thread-1  ]: 13 of 28 PASS not_null_fct_trips_do_location_id ................................ [[32mPASS[0m in 0.30s]
[0m17:40:42.143278 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_do_location_id.6acdd302a6
[0m17:40:42.145064 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_dropoff_time.04b71dc609
[0m17:40:42.146415 [info ] [Thread-1  ]: 14 of 28 START test not_null_fct_trips_dropoff_time ............................ [RUN]
[0m17:40:42.148043 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_do_location_id.6acdd302a6, now test.nyc_taxi.not_null_fct_trips_dropoff_time.04b71dc609)
[0m17:40:42.149234 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_dropoff_time.04b71dc609
[0m17:40:42.156904 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_dropoff_time.04b71dc609"
[0m17:40:42.163553 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_dropoff_time.04b71dc609
[0m17:40:42.168257 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_fct_trips_dropoff_time.04b71dc609"
[0m17:40:42.174288 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:40:42.178527 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_fct_trips_dropoff_time.04b71dc609: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_fct_trips_dropoff_time.04b71dc609"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select dropoff_time
from `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips`
where dropoff_time is null



      
    ) dbt_internal_test
[0m17:40:43.041491 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:efb0b9a4-baab-476b-b0b2-705577c15951&page=queryresults
[0m17:40:44.236817 [info ] [Thread-1  ]: 14 of 28 PASS not_null_fct_trips_dropoff_time .................................. [[32mPASS[0m in 2.09s]
[0m17:40:44.239523 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_dropoff_time.04b71dc609
[0m17:40:44.241328 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_extra.1801055bb3
[0m17:40:44.242640 [info ] [Thread-1  ]: 15 of 28 START test not_null_fct_trips_extra ................................... [RUN]
[0m17:40:44.244173 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_dropoff_time.04b71dc609, now test.nyc_taxi.not_null_fct_trips_extra.1801055bb3)
[0m17:40:44.245627 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_extra.1801055bb3
[0m17:40:44.255957 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_extra.1801055bb3"
[0m17:40:44.261769 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_extra.1801055bb3
[0m17:40:44.266802 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_fct_trips_extra.1801055bb3"
[0m17:40:44.273016 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:40:44.276390 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_fct_trips_extra.1801055bb3: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_fct_trips_extra.1801055bb3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select extra
from `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips`
where extra is null



      
    ) dbt_internal_test
[0m17:40:45.148430 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:bb67e555-3f75-430c-9cd3-5c215896353d&page=queryresults
[0m17:40:46.254641 [info ] [Thread-1  ]: 15 of 28 PASS not_null_fct_trips_extra ......................................... [[32mPASS[0m in 2.01s]
[0m17:40:46.257296 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_extra.1801055bb3
[0m17:40:46.259110 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_improvement_surcharge.4cf28d1443
[0m17:40:46.260476 [info ] [Thread-1  ]: 16 of 28 START test not_null_fct_trips_improvement_surcharge ................... [RUN]
[0m17:40:46.262122 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_extra.1801055bb3, now test.nyc_taxi.not_null_fct_trips_improvement_surcharge.4cf28d1443)
[0m17:40:46.263486 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_improvement_surcharge.4cf28d1443
[0m17:40:46.272534 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_improvement_surcharge.4cf28d1443"
[0m17:40:46.278451 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_improvement_surcharge.4cf28d1443
[0m17:40:46.282966 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_fct_trips_improvement_surcharge.4cf28d1443"
[0m17:40:46.289917 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:40:46.293648 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_fct_trips_improvement_surcharge.4cf28d1443: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_fct_trips_improvement_surcharge.4cf28d1443"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select improvement_surcharge
from `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips`
where improvement_surcharge is null



      
    ) dbt_internal_test
[0m17:40:47.138794 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:b7d824d1-a82b-442e-8258-42fc3abce36a&page=queryresults
[0m17:40:48.259036 [info ] [Thread-1  ]: 16 of 28 PASS not_null_fct_trips_improvement_surcharge ......................... [[32mPASS[0m in 2.00s]
[0m17:40:48.261532 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_improvement_surcharge.4cf28d1443
[0m17:40:48.263204 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_passenger_count.b1370cab1c
[0m17:40:48.264557 [info ] [Thread-1  ]: 17 of 28 START test not_null_fct_trips_passenger_count ......................... [RUN]
[0m17:40:48.266038 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_improvement_surcharge.4cf28d1443, now test.nyc_taxi.not_null_fct_trips_passenger_count.b1370cab1c)
[0m17:40:48.267476 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_passenger_count.b1370cab1c
[0m17:40:48.275334 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_passenger_count.b1370cab1c"
[0m17:40:48.281064 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_passenger_count.b1370cab1c
[0m17:40:48.285877 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_fct_trips_passenger_count.b1370cab1c"
[0m17:40:48.291576 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:40:48.295047 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_fct_trips_passenger_count.b1370cab1c: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_fct_trips_passenger_count.b1370cab1c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select passenger_count
from `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips`
where passenger_count is null



      
    ) dbt_internal_test
[0m17:40:49.149146 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:8ddaf911-b317-4064-a292-08f3d11f7564&page=queryresults
[0m17:40:50.270718 [info ] [Thread-1  ]: 17 of 28 PASS not_null_fct_trips_passenger_count ............................... [[32mPASS[0m in 2.00s]
[0m17:40:50.273083 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_passenger_count.b1370cab1c
[0m17:40:50.277276 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_payment_type.93889b679a
[0m17:40:50.278650 [info ] [Thread-1  ]: 18 of 28 START test not_null_fct_trips_payment_type ............................ [RUN]
[0m17:40:50.280150 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_passenger_count.b1370cab1c, now test.nyc_taxi.not_null_fct_trips_payment_type.93889b679a)
[0m17:40:50.281531 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_payment_type.93889b679a
[0m17:40:50.289073 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_payment_type.93889b679a"
[0m17:40:50.295122 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_payment_type.93889b679a
[0m17:40:50.300203 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_fct_trips_payment_type.93889b679a"
[0m17:40:50.307195 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:40:50.310682 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_fct_trips_payment_type.93889b679a: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_fct_trips_payment_type.93889b679a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select payment_type
from `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips`
where payment_type is null



      
    ) dbt_internal_test
[0m17:40:51.182302 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:8a236738-5f6a-491b-82f2-e062f2a469b5&page=queryresults
[0m17:40:52.298746 [info ] [Thread-1  ]: 18 of 28 PASS not_null_fct_trips_payment_type .................................. [[32mPASS[0m in 2.02s]
[0m17:40:52.300956 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_payment_type.93889b679a
[0m17:40:52.302753 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_pickup_time.693af2bf31
[0m17:40:52.303974 [info ] [Thread-1  ]: 19 of 28 START test not_null_fct_trips_pickup_time ............................. [RUN]
[0m17:40:52.305512 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_payment_type.93889b679a, now test.nyc_taxi.not_null_fct_trips_pickup_time.693af2bf31)
[0m17:40:52.306788 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_pickup_time.693af2bf31
[0m17:40:52.313946 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_pickup_time.693af2bf31"
[0m17:40:52.321176 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_pickup_time.693af2bf31
[0m17:40:52.326132 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_fct_trips_pickup_time.693af2bf31"
[0m17:40:52.331577 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:40:52.335774 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_fct_trips_pickup_time.693af2bf31: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_fct_trips_pickup_time.693af2bf31"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select pickup_time
from `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips`
where pickup_time is null



      
    ) dbt_internal_test
[0m17:40:53.187179 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:06d187ec-3606-4078-a88d-152aac4cc910&page=queryresults
[0m17:40:54.331618 [info ] [Thread-1  ]: 19 of 28 PASS not_null_fct_trips_pickup_time ................................... [[32mPASS[0m in 2.03s]
[0m17:40:54.333859 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_pickup_time.693af2bf31
[0m17:40:54.335627 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_pu_location_id.b0dc8dd185
[0m17:40:54.336901 [info ] [Thread-1  ]: 20 of 28 START test not_null_fct_trips_pu_location_id .......................... [RUN]
[0m17:40:54.338172 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_pickup_time.693af2bf31, now test.nyc_taxi.not_null_fct_trips_pu_location_id.b0dc8dd185)
[0m17:40:54.339220 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_pu_location_id.b0dc8dd185
[0m17:40:54.348155 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_pu_location_id.b0dc8dd185"
[0m17:40:54.354740 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_pu_location_id.b0dc8dd185
[0m17:40:54.359957 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_fct_trips_pu_location_id.b0dc8dd185"
[0m17:40:54.366043 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:40:54.370549 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_fct_trips_pu_location_id.b0dc8dd185: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_fct_trips_pu_location_id.b0dc8dd185"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select pu_location_id
from `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips`
where pu_location_id is null



      
    ) dbt_internal_test
[0m17:40:55.310149 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:70b8d729-4a89-4479-a612-857dde655376&page=queryresults
[0m17:40:56.448368 [info ] [Thread-1  ]: 20 of 28 PASS not_null_fct_trips_pu_location_id ................................ [[32mPASS[0m in 2.11s]
[0m17:40:56.450452 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_pu_location_id.b0dc8dd185
[0m17:40:56.451799 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_rate_code_id.ba0047eaae
[0m17:40:56.453022 [info ] [Thread-1  ]: 21 of 28 START test not_null_fct_trips_rate_code_id ............................ [RUN]
[0m17:40:56.454260 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_pu_location_id.b0dc8dd185, now test.nyc_taxi.not_null_fct_trips_rate_code_id.ba0047eaae)
[0m17:40:56.455317 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_rate_code_id.ba0047eaae
[0m17:40:56.462314 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_rate_code_id.ba0047eaae"
[0m17:40:56.469035 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_rate_code_id.ba0047eaae
[0m17:40:56.474346 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_fct_trips_rate_code_id.ba0047eaae"
[0m17:40:56.482014 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:40:56.486118 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_fct_trips_rate_code_id.ba0047eaae: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_fct_trips_rate_code_id.ba0047eaae"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select rate_code_id
from `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips`
where rate_code_id is null



      
    ) dbt_internal_test
[0m17:40:57.302595 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:f75cbad6-a970-4a18-b684-12af2bf9f5db&page=queryresults
[0m17:40:58.440009 [info ] [Thread-1  ]: 21 of 28 PASS not_null_fct_trips_rate_code_id .................................. [[32mPASS[0m in 1.99s]
[0m17:40:58.442479 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_rate_code_id.ba0047eaae
[0m17:40:58.444039 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_trip_distance.19cd17f1df
[0m17:40:58.445442 [info ] [Thread-1  ]: 22 of 28 START test not_null_fct_trips_trip_distance ........................... [RUN]
[0m17:40:58.446989 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_rate_code_id.ba0047eaae, now test.nyc_taxi.not_null_fct_trips_trip_distance.19cd17f1df)
[0m17:40:58.448457 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_trip_distance.19cd17f1df
[0m17:40:58.456834 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_trip_distance.19cd17f1df"
[0m17:40:58.462865 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_trip_distance.19cd17f1df
[0m17:40:58.467409 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_fct_trips_trip_distance.19cd17f1df"
[0m17:40:58.473574 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:40:58.476905 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_fct_trips_trip_distance.19cd17f1df: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_fct_trips_trip_distance.19cd17f1df"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select trip_distance
from `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips`
where trip_distance is null



      
    ) dbt_internal_test
[0m17:40:59.320901 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:9d182c12-807f-45ad-8141-ed504faa630a&page=queryresults
[0m17:41:00.405534 [info ] [Thread-1  ]: 22 of 28 PASS not_null_fct_trips_trip_distance ................................. [[32mPASS[0m in 1.96s]
[0m17:41:00.407986 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_trip_distance.19cd17f1df
[0m17:41:00.412039 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_vendor_id.b9b2f380bb
[0m17:41:00.413364 [info ] [Thread-1  ]: 23 of 28 START test not_null_fct_trips_vendor_id ............................... [RUN]
[0m17:41:00.414791 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_trip_distance.19cd17f1df, now test.nyc_taxi.not_null_fct_trips_vendor_id.b9b2f380bb)
[0m17:41:00.416077 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_vendor_id.b9b2f380bb
[0m17:41:00.423982 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_vendor_id.b9b2f380bb"
[0m17:41:00.430468 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_vendor_id.b9b2f380bb
[0m17:41:00.435199 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_fct_trips_vendor_id.b9b2f380bb"
[0m17:41:00.442154 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:41:00.445507 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_fct_trips_vendor_id.b9b2f380bb: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_fct_trips_vendor_id.b9b2f380bb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select vendor_id
from `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips`
where vendor_id is null



      
    ) dbt_internal_test
[0m17:41:01.286394 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:057cbef1-f3d3-414c-8d71-0d7709cfaab6&page=queryresults
[0m17:41:02.386759 [info ] [Thread-1  ]: 23 of 28 PASS not_null_fct_trips_vendor_id ..................................... [[32mPASS[0m in 1.97s]
[0m17:41:02.389137 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_vendor_id.b9b2f380bb
[0m17:41:02.390905 [debug] [Thread-1  ]: Began running node test.nyc_taxi.unique_dim_payment_type_id.dea55de04e
[0m17:41:02.392257 [info ] [Thread-1  ]: 24 of 28 START test unique_dim_payment_type_id ................................. [RUN]
[0m17:41:02.393781 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_vendor_id.b9b2f380bb, now test.nyc_taxi.unique_dim_payment_type_id.dea55de04e)
[0m17:41:02.395140 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.unique_dim_payment_type_id.dea55de04e
[0m17:41:02.405751 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.unique_dim_payment_type_id.dea55de04e"
[0m17:41:02.411664 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.unique_dim_payment_type_id.dea55de04e
[0m17:41:02.416139 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.unique_dim_payment_type_id.dea55de04e"
[0m17:41:02.422263 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:41:02.425841 [debug] [Thread-1  ]: On test.nyc_taxi.unique_dim_payment_type_id.dea55de04e: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.unique_dim_payment_type_id.dea55de04e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select type_id as unique_field
  from `northern-shield-437204-m0`.`nyc_taxi`.`dim_payment`
  where type_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m17:41:03.299844 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:eeca52a6-b5b0-4433-8f84-06948150ca2b&page=queryresults
[0m17:41:04.397897 [info ] [Thread-1  ]: 24 of 28 PASS unique_dim_payment_type_id ....................................... [[32mPASS[0m in 2.00s]
[0m17:41:04.400178 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.unique_dim_payment_type_id.dea55de04e
[0m17:41:04.401787 [debug] [Thread-1  ]: Began running node test.nyc_taxi.unique_dim_ratecode_rate_id.75ae8e4885
[0m17:41:04.402928 [info ] [Thread-1  ]: 25 of 28 START test unique_dim_ratecode_rate_id ................................ [RUN]
[0m17:41:04.404295 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.unique_dim_payment_type_id.dea55de04e, now test.nyc_taxi.unique_dim_ratecode_rate_id.75ae8e4885)
[0m17:41:04.405401 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.unique_dim_ratecode_rate_id.75ae8e4885
[0m17:41:04.414389 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.unique_dim_ratecode_rate_id.75ae8e4885"
[0m17:41:04.420467 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.unique_dim_ratecode_rate_id.75ae8e4885
[0m17:41:04.425784 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.unique_dim_ratecode_rate_id.75ae8e4885"
[0m17:41:04.431959 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:41:04.435585 [debug] [Thread-1  ]: On test.nyc_taxi.unique_dim_ratecode_rate_id.75ae8e4885: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.unique_dim_ratecode_rate_id.75ae8e4885"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select rate_id as unique_field
  from `northern-shield-437204-m0`.`nyc_taxi`.`dim_ratecode`
  where rate_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m17:41:05.411983 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:562ab151-b0df-4980-94d3-5357fdf76267&page=queryresults
[0m17:41:06.508646 [info ] [Thread-1  ]: 25 of 28 PASS unique_dim_ratecode_rate_id ...................................... [[32mPASS[0m in 2.10s]
[0m17:41:06.510507 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.unique_dim_ratecode_rate_id.75ae8e4885
[0m17:41:06.511943 [debug] [Thread-1  ]: Began running node test.nyc_taxi.unique_dim_vendor_id.03fad38d04
[0m17:41:06.513089 [info ] [Thread-1  ]: 26 of 28 START test unique_dim_vendor_id ....................................... [RUN]
[0m17:41:06.514572 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.unique_dim_ratecode_rate_id.75ae8e4885, now test.nyc_taxi.unique_dim_vendor_id.03fad38d04)
[0m17:41:06.515724 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.unique_dim_vendor_id.03fad38d04
[0m17:41:06.522835 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.unique_dim_vendor_id.03fad38d04"
[0m17:41:06.529940 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.unique_dim_vendor_id.03fad38d04
[0m17:41:06.535591 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.unique_dim_vendor_id.03fad38d04"
[0m17:41:06.541250 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:41:06.545367 [debug] [Thread-1  ]: On test.nyc_taxi.unique_dim_vendor_id.03fad38d04: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.unique_dim_vendor_id.03fad38d04"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select id as unique_field
  from `northern-shield-437204-m0`.`nyc_taxi`.`dim_vendor`
  where id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m17:41:07.432706 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:8f8e1952-5f45-4b08-b2e9-434ce0083a18&page=queryresults
[0m17:41:08.504433 [info ] [Thread-1  ]: 26 of 28 PASS unique_dim_vendor_id ............................................. [[32mPASS[0m in 1.99s]
[0m17:41:08.506914 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.unique_dim_vendor_id.03fad38d04
[0m17:41:08.508416 [debug] [Thread-1  ]: Began running node test.nyc_taxi.unique_dim_zone_location_id.7702f92424
[0m17:41:08.509658 [info ] [Thread-1  ]: 27 of 28 START test unique_dim_zone_location_id ................................ [RUN]
[0m17:41:08.511212 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.unique_dim_vendor_id.03fad38d04, now test.nyc_taxi.unique_dim_zone_location_id.7702f92424)
[0m17:41:08.512613 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.unique_dim_zone_location_id.7702f92424
[0m17:41:08.520866 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.unique_dim_zone_location_id.7702f92424"
[0m17:41:08.526585 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.unique_dim_zone_location_id.7702f92424
[0m17:41:08.531107 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.unique_dim_zone_location_id.7702f92424"
[0m17:41:08.539214 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:41:08.542639 [debug] [Thread-1  ]: On test.nyc_taxi.unique_dim_zone_location_id.7702f92424: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.unique_dim_zone_location_id.7702f92424"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select location_id as unique_field
  from `northern-shield-437204-m0`.`nyc_taxi`.`dim_zone`
  where location_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m17:41:09.446562 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:73cecc3a-ac09-427c-9997-8bf7a4ed0f14&page=queryresults
[0m17:41:08.712616 [info ] [Thread-1  ]: 27 of 28 PASS unique_dim_zone_location_id ...................................... [[32mPASS[0m in 0.20s]
[0m17:41:08.714825 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.unique_dim_zone_location_id.7702f92424
[0m17:41:08.719260 [debug] [Thread-1  ]: Began running node test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab
[0m17:41:08.720574 [info ] [Thread-1  ]: 28 of 28 START test unique_fct_trips_trip_id ................................... [RUN]
[0m17:41:08.722396 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.unique_dim_zone_location_id.7702f92424, now test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab)
[0m17:41:08.723680 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab
[0m17:41:08.730604 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab"
[0m17:41:08.736167 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab
[0m17:41:08.740561 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab"
[0m17:41:08.747298 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:41:08.750804 [debug] [Thread-1  ]: On test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select trip_id as unique_field
  from `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips`
  where trip_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m17:41:09.850102 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:8e1b7b67-fe91-4e64-ac72-6d19bc2f4ec8&page=queryresults
[0m17:41:10.941883 [info ] [Thread-1  ]: 28 of 28 PASS unique_fct_trips_trip_id ......................................... [[32mPASS[0m in 2.22s]
[0m17:41:10.944104 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab
[0m17:41:10.946815 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:41:10.947745 [debug] [MainThread]: Connection 'test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab' was properly closed.
[0m17:41:10.948748 [info ] [MainThread]: 
[0m17:41:10.949910 [info ] [MainThread]: Finished running 28 data tests in 0 hours 0 minutes and 44.63 seconds (44.63s).
[0m17:41:10.960016 [debug] [MainThread]: Command end result
[0m17:41:11.040949 [info ] [MainThread]: 
[0m17:41:11.042469 [info ] [MainThread]: [31mCompleted with 5 errors and 0 warnings:[0m
[0m17:41:11.043622 [info ] [MainThread]: 
[0m17:41:11.044872 [error] [MainThread]:   Compilation Error in test conditional_values_fct_trips_fare_amount__test_fare_amount_positive (models/tests/schema.yml)
  'test_conditional_values' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m17:41:11.045891 [info ] [MainThread]: 
[0m17:41:11.047155 [error] [MainThread]:   Compilation Error in test conditional_values_fct_trips_mta_tax__test_mta_tax_positive (models/tests/schema.yml)
  'test_conditional_values' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m17:41:11.048596 [info ] [MainThread]: 
[0m17:41:11.049861 [error] [MainThread]:   Compilation Error in test conditional_values_fct_trips_tip_amount__test_tip_amount_positive (models/tests/schema.yml)
  'test_conditional_values' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m17:41:11.051009 [info ] [MainThread]: 
[0m17:41:11.052217 [error] [MainThread]:   Compilation Error in test conditional_values_fct_trips_tolls_amount__test_tolls_amount_positive (models/tests/schema.yml)
  'test_conditional_values' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m17:41:11.053305 [info ] [MainThread]: 
[0m17:41:11.054651 [error] [MainThread]:   Compilation Error in test conditional_values_fct_trips_total_amount__test_total_amount_positive (models/tests/schema.yml)
  'test_conditional_values' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m17:41:11.055780 [info ] [MainThread]: 
[0m17:41:11.056972 [info ] [MainThread]: Done. PASS=23 WARN=0 ERROR=5 SKIP=0 TOTAL=28
[0m17:41:11.059184 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 51.06579, "process_in_blocks": "0", "process_kernel_time": 0.422939, "process_mem_max_rss": "242620", "process_out_blocks": "0", "process_user_time": 6.62605}
[0m17:41:11.060769 [debug] [MainThread]: Command `dbt test` failed at 17:41:11.060530 after 51.07 seconds
[0m17:41:11.062039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f364dc7dfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36185db0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f364c2b9fa0>]}
[0m17:41:11.063278 [debug] [MainThread]: Flushing usage events
[0m17:48:14.958841 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f617ae70c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6178cbbe50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6178cbbdf0>]}


============================== 17:48:14.968322 | 11fc1db7-39b0-4677-880d-af33cebd84d6 ==============================
[0m17:48:14.968322 [info ] [MainThread]: Running with dbt=1.8.9
[0m17:48:14.969976 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'log_path': '/opt/airflow/include/dbt/logs', 'use_colors': 'True', 'log_format': 'default', 'static_parser': 'True', 'use_experimental_parser': 'False', 'introspect': 'True', 'quiet': 'False', 'no_print': 'None', 'log_cache_events': 'False', 'debug': 'False', 'version_check': 'True', 'printer_width': '80', 'empty': 'None', 'profiles_dir': '/opt/airflow/include/dbt', 'invocation_command': 'dbt deps', 'indirect_selection': 'eager', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'warn_error': 'None', 'cache_selected_only': 'False'}
[0m17:48:15.133332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '11fc1db7-39b0-4677-880d-af33cebd84d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6178c85af0>]}
[0m17:48:15.359286 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-_45xmdoa'
[0m17:48:15.360400 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m17:48:15.840436 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m17:48:15.842148 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m17:48:15.928724 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m17:48:15.937472 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m17:48:17.885250 [info ] [MainThread]: Installed from version 1.3.0
[0m17:48:17.886813 [info ] [MainThread]: Up to date!
[0m17:48:17.888341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '11fc1db7-39b0-4677-880d-af33cebd84d6', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6178c548b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6178c54be0>]}
[0m17:48:17.890515 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 3.0123935, "process_in_blocks": "160", "process_kernel_time": 0.23139, "process_mem_max_rss": "95420", "process_out_blocks": "176", "process_user_time": 2.101021}
[0m17:48:17.891729 [debug] [MainThread]: Command `dbt deps` succeeded at 17:48:17.891551 after 3.01 seconds
[0m17:48:17.892670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f617ae70c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6178ca13a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6178b751c0>]}
[0m17:48:17.893594 [debug] [MainThread]: Flushing usage events
[0m17:48:40.093924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33b9c3aca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33b9f8d820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33b8e81fd0>]}


============================== 17:48:40.102238 | 9390f3b3-7ccf-427d-bc08-1974357b118d ==============================
[0m17:48:40.102238 [info ] [MainThread]: Running with dbt=1.8.9
[0m17:48:40.104100 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'warn_error': 'None', 'empty': 'None', 'static_parser': 'True', 'target_path': 'None', 'no_print': 'None', 'version_check': 'True', 'debug': 'False', 'indirect_selection': 'eager', 'invocation_command': 'dbt test --profiles-dir /opt/airflow/include/dbt/', 'send_anonymous_usage_stats': 'True', 'log_cache_events': 'False', 'use_colors': 'True', 'quiet': 'False', 'partial_parse': 'True', 'profiles_dir': '/opt/airflow/include/dbt/', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'write_json': 'True', 'log_format': 'default', 'printer_width': '80', 'log_path': '/opt/airflow/include/dbt/logs', 'fail_fast': 'False'}
[0m17:48:41.347761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9390f3b3-7ccf-427d-bc08-1974357b118d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f338464cf40>]}
[0m17:48:41.413603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9390f3b3-7ccf-427d-bc08-1974357b118d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3384656820>]}
[0m17:48:41.415809 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m17:48:41.592864 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m17:48:42.322645 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:48:42.323748 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:48:42.391020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9390f3b3-7ccf-427d-bc08-1974357b118d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33b2e20130>]}
[0m17:48:42.706931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9390f3b3-7ccf-427d-bc08-1974357b118d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f338460e4f0>]}
[0m17:48:42.708247 [info ] [MainThread]: Found 5 models, 28 data tests, 2 sources, 600 macros
[0m17:48:42.709485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9390f3b3-7ccf-427d-bc08-1974357b118d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33b2f747c0>]}
[0m17:48:42.714225 [info ] [MainThread]: 
[0m17:48:42.715999 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:48:42.723138 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_northern-shield-437204-m0_nyc_taxi'
[0m17:48:42.724401 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:48:43.423384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9390f3b3-7ccf-427d-bc08-1974357b118d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33b79fe040>]}
[0m17:48:43.425065 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:48:43.426533 [info ] [MainThread]: 
[0m17:48:43.436431 [debug] [Thread-1  ]: Began running node test.nyc_taxi.accepted_values_dim_payment_payment_name__Credit_card__Cash__No_charge__Dispute__Unknown__Voided_trip.58d00ef9f4
[0m17:48:43.437772 [info ] [Thread-1  ]: 1 of 28 START test accepted_values_dim_payment_payment_name__Credit_card__Cash__No_charge__Dispute__Unknown__Voided_trip  [RUN]
[0m17:48:43.439078 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_northern-shield-437204-m0_nyc_taxi, now test.nyc_taxi.accepted_values_dim_payment_payment_name__Credit_card__Cash__No_charge__Dispute__Unknown__Voided_trip.58d00ef9f4)
[0m17:48:43.440381 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.accepted_values_dim_payment_payment_name__Credit_card__Cash__No_charge__Dispute__Unknown__Voided_trip.58d00ef9f4
[0m17:48:43.468759 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.accepted_values_dim_payment_payment_name__Credit_card__Cash__No_charge__Dispute__Unknown__Voided_trip.58d00ef9f4"
[0m17:48:43.474631 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.accepted_values_dim_payment_payment_name__Credit_card__Cash__No_charge__Dispute__Unknown__Voided_trip.58d00ef9f4
[0m17:48:43.502587 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.accepted_values_dim_payment_payment_name__Credit_card__Cash__No_charge__Dispute__Unknown__Voided_trip.58d00ef9f4"
[0m17:48:43.507740 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:48:43.511485 [debug] [Thread-1  ]: On test.nyc_taxi.accepted_values_dim_payment_payment_name__Credit_card__Cash__No_charge__Dispute__Unknown__Voided_trip.58d00ef9f4: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.accepted_values_dim_payment_payment_name__Credit_card__Cash__No_charge__Dispute__Unknown__Voided_trip.58d00ef9f4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        payment_name as value_field,
        count(*) as n_records

    from `northern-shield-437204-m0`.`nyc_taxi`.`dim_payment`
    group by payment_name

)

select *
from all_values
where value_field not in (
    'Credit card','Cash','No charge','Dispute','Unknown','Voided trip'
)



      
    ) dbt_internal_test
[0m17:48:44.302891 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:cde2dcd3-a58c-4c69-b7bc-c47d5936b174&page=queryresults
[0m17:48:45.467876 [info ] [Thread-1  ]: 1 of 28 PASS accepted_values_dim_payment_payment_name__Credit_card__Cash__No_charge__Dispute__Unknown__Voided_trip  [[32mPASS[0m in 2.03s]
[0m17:48:45.472678 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.accepted_values_dim_payment_payment_name__Credit_card__Cash__No_charge__Dispute__Unknown__Voided_trip.58d00ef9f4
[0m17:48:45.475660 [debug] [Thread-1  ]: Began running node test.nyc_taxi.accepted_values_dim_ratecode_rate_code_name__Standard_rate__JFK__Newark__Nassau_or_Westchester__Negotiated_fare__Group_ride__Unknown.57ee02019f
[0m17:48:45.477489 [info ] [Thread-1  ]: 2 of 28 START test accepted_values_dim_ratecode_rate_code_name__Standard_rate__JFK__Newark__Nassau_or_Westchester__Negotiated_fare__Group_ride__Unknown  [RUN]
[0m17:48:45.479743 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.accepted_values_dim_payment_payment_name__Credit_card__Cash__No_charge__Dispute__Unknown__Voided_trip.58d00ef9f4, now test.nyc_taxi.accepted_values_dim_ratecode_rate_code_name__Standard_rate__JFK__Newark__Nassau_or_Westchester__Negotiated_fare__Group_ride__Unknown.57ee02019f)
[0m17:48:45.481735 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.accepted_values_dim_ratecode_rate_code_name__Standard_rate__JFK__Newark__Nassau_or_Westchester__Negotiated_fare__Group_ride__Unknown.57ee02019f
[0m17:48:45.501320 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.accepted_values_dim_ratecode_rate_code_name__Standard_rate__JFK__Newark__Nassau_or_Westchester__Negotiated_fare__Group_ride__Unknown.57ee02019f"
[0m17:48:45.506325 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.accepted_values_dim_ratecode_rate_code_name__Standard_rate__JFK__Newark__Nassau_or_Westchester__Negotiated_fare__Group_ride__Unknown.57ee02019f
[0m17:48:45.513449 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.accepted_values_dim_ratecode_rate_code_name__Standard_rate__JFK__Newark__Nassau_or_Westchester__Negotiated_fare__Group_ride__Unknown.57ee02019f"
[0m17:48:45.518649 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:48:45.522226 [debug] [Thread-1  ]: On test.nyc_taxi.accepted_values_dim_ratecode_rate_code_name__Standard_rate__JFK__Newark__Nassau_or_Westchester__Negotiated_fare__Group_ride__Unknown.57ee02019f: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.accepted_values_dim_ratecode_rate_code_name__Standard_rate__JFK__Newark__Nassau_or_Westchester__Negotiated_fare__Group_ride__Unknown.57ee02019f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        rate_code_name as value_field,
        count(*) as n_records

    from `northern-shield-437204-m0`.`nyc_taxi`.`dim_ratecode`
    group by rate_code_name

)

select *
from all_values
where value_field not in (
    'Standard rate','JFK','Newark','Nassau or Westchester','Negotiated fare','Group ride','Unknown'
)



      
    ) dbt_internal_test
[0m17:48:46.257965 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:58a83ff5-8a22-4f7c-b885-bfc5f8839f01&page=queryresults
[0m17:48:47.412661 [info ] [Thread-1  ]: 2 of 28 PASS accepted_values_dim_ratecode_rate_code_name__Standard_rate__JFK__Newark__Nassau_or_Westchester__Negotiated_fare__Group_ride__Unknown  [[32mPASS[0m in 1.93s]
[0m17:48:47.414925 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.accepted_values_dim_ratecode_rate_code_name__Standard_rate__JFK__Newark__Nassau_or_Westchester__Negotiated_fare__Group_ride__Unknown.57ee02019f
[0m17:48:47.416516 [debug] [Thread-1  ]: Began running node test.nyc_taxi.accepted_values_dim_vendor_vendor_name__Creative_Mobile_Technologies__VeriFone_Inc_.7481cecf07
[0m17:48:47.417899 [info ] [Thread-1  ]: 3 of 28 START test accepted_values_dim_vendor_vendor_name__Creative_Mobile_Technologies__VeriFone_Inc_  [RUN]
[0m17:48:47.419595 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.accepted_values_dim_ratecode_rate_code_name__Standard_rate__JFK__Newark__Nassau_or_Westchester__Negotiated_fare__Group_ride__Unknown.57ee02019f, now test.nyc_taxi.accepted_values_dim_vendor_vendor_name__Creative_Mobile_Technologies__VeriFone_Inc_.7481cecf07)
[0m17:48:47.421175 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.accepted_values_dim_vendor_vendor_name__Creative_Mobile_Technologies__VeriFone_Inc_.7481cecf07
[0m17:48:47.431169 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.accepted_values_dim_vendor_vendor_name__Creative_Mobile_Technologies__VeriFone_Inc_.7481cecf07"
[0m17:48:47.437562 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.accepted_values_dim_vendor_vendor_name__Creative_Mobile_Technologies__VeriFone_Inc_.7481cecf07
[0m17:48:47.443275 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.accepted_values_dim_vendor_vendor_name__Creative_Mobile_Technologies__VeriFone_Inc_.7481cecf07"
[0m17:48:47.450639 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:48:47.455182 [debug] [Thread-1  ]: On test.nyc_taxi.accepted_values_dim_vendor_vendor_name__Creative_Mobile_Technologies__VeriFone_Inc_.7481cecf07: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.accepted_values_dim_vendor_vendor_name__Creative_Mobile_Technologies__VeriFone_Inc_.7481cecf07"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        vendor_name as value_field,
        count(*) as n_records

    from `northern-shield-437204-m0`.`nyc_taxi`.`dim_vendor`
    group by vendor_name

)

select *
from all_values
where value_field not in (
    'Creative Mobile Technologies','VeriFone Inc.'
)



      
    ) dbt_internal_test
[0m17:48:48.170771 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:259066a4-ebe3-4c29-bfe4-eab2a092448a&page=queryresults
[0m17:48:49.259066 [info ] [Thread-1  ]: 3 of 28 PASS accepted_values_dim_vendor_vendor_name__Creative_Mobile_Technologies__VeriFone_Inc_  [[32mPASS[0m in 1.84s]
[0m17:48:49.261425 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.accepted_values_dim_vendor_vendor_name__Creative_Mobile_Technologies__VeriFone_Inc_.7481cecf07
[0m17:48:49.263248 [debug] [Thread-1  ]: Began running node test.nyc_taxi.conditional_values_fct_trips_fare_amount__test_fare_amount_positive.42cfe6599e
[0m17:48:49.264624 [info ] [Thread-1  ]: 4 of 28 START test conditional_values_fct_trips_fare_amount__test_fare_amount_positive  [RUN]
[0m17:48:49.266120 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.accepted_values_dim_vendor_vendor_name__Creative_Mobile_Technologies__VeriFone_Inc_.7481cecf07, now test.nyc_taxi.conditional_values_fct_trips_fare_amount__test_fare_amount_positive.42cfe6599e)
[0m17:48:49.267360 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.conditional_values_fct_trips_fare_amount__test_fare_amount_positive.42cfe6599e
[0m17:48:49.277991 [debug] [Thread-1  ]: Compilation Error in test conditional_values_fct_trips_fare_amount__test_fare_amount_positive (models/tests/schema.yml)
  'test_conditional_values' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m17:48:49.279550 [error] [Thread-1  ]: 4 of 28 ERROR conditional_values_fct_trips_fare_amount__test_fare_amount_positive  [[31mERROR[0m in 0.01s]
[0m17:48:49.281322 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.conditional_values_fct_trips_fare_amount__test_fare_amount_positive.42cfe6599e
[0m17:48:49.282595 [debug] [Thread-1  ]: Began running node test.nyc_taxi.conditional_values_fct_trips_mta_tax__test_mta_tax_positive.21bb3dd018
[0m17:48:49.283879 [info ] [Thread-1  ]: 5 of 28 START test conditional_values_fct_trips_mta_tax__test_mta_tax_positive . [RUN]
[0m17:48:49.285083 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.conditional_values_fct_trips_fare_amount__test_fare_amount_positive.42cfe6599e, now test.nyc_taxi.conditional_values_fct_trips_mta_tax__test_mta_tax_positive.21bb3dd018)
[0m17:48:49.286200 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.conditional_values_fct_trips_mta_tax__test_mta_tax_positive.21bb3dd018
[0m17:48:49.293756 [debug] [Thread-1  ]: Compilation Error in test conditional_values_fct_trips_mta_tax__test_mta_tax_positive (models/tests/schema.yml)
  'test_conditional_values' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m17:48:49.295247 [error] [Thread-1  ]: 5 of 28 ERROR conditional_values_fct_trips_mta_tax__test_mta_tax_positive ...... [[31mERROR[0m in 0.01s]
[0m17:48:49.297359 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.conditional_values_fct_trips_mta_tax__test_mta_tax_positive.21bb3dd018
[0m17:48:49.298915 [debug] [Thread-1  ]: Began running node test.nyc_taxi.conditional_values_fct_trips_tip_amount__test_tip_amount_positive.cc3a05edfa
[0m17:48:49.300266 [info ] [Thread-1  ]: 6 of 28 START test conditional_values_fct_trips_tip_amount__test_tip_amount_positive  [RUN]
[0m17:48:49.301433 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.conditional_values_fct_trips_mta_tax__test_mta_tax_positive.21bb3dd018, now test.nyc_taxi.conditional_values_fct_trips_tip_amount__test_tip_amount_positive.cc3a05edfa)
[0m17:48:49.302470 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.conditional_values_fct_trips_tip_amount__test_tip_amount_positive.cc3a05edfa
[0m17:48:49.310236 [debug] [Thread-1  ]: Compilation Error in test conditional_values_fct_trips_tip_amount__test_tip_amount_positive (models/tests/schema.yml)
  'test_conditional_values' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m17:48:49.311887 [error] [Thread-1  ]: 6 of 28 ERROR conditional_values_fct_trips_tip_amount__test_tip_amount_positive  [[31mERROR[0m in 0.01s]
[0m17:48:49.314124 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.conditional_values_fct_trips_tip_amount__test_tip_amount_positive.cc3a05edfa
[0m17:48:49.315450 [debug] [Thread-1  ]: Began running node test.nyc_taxi.conditional_values_fct_trips_tolls_amount__test_tolls_amount_positive.b5e4e898c5
[0m17:48:49.316556 [info ] [Thread-1  ]: 7 of 28 START test conditional_values_fct_trips_tolls_amount__test_tolls_amount_positive  [RUN]
[0m17:48:49.317806 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.conditional_values_fct_trips_tip_amount__test_tip_amount_positive.cc3a05edfa, now test.nyc_taxi.conditional_values_fct_trips_tolls_amount__test_tolls_amount_positive.b5e4e898c5)
[0m17:48:49.318943 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.conditional_values_fct_trips_tolls_amount__test_tolls_amount_positive.b5e4e898c5
[0m17:48:49.328287 [debug] [Thread-1  ]: Compilation Error in test conditional_values_fct_trips_tolls_amount__test_tolls_amount_positive (models/tests/schema.yml)
  'test_conditional_values' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m17:48:49.329894 [error] [Thread-1  ]: 7 of 28 ERROR conditional_values_fct_trips_tolls_amount__test_tolls_amount_positive  [[31mERROR[0m in 0.01s]
[0m17:48:49.331754 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.conditional_values_fct_trips_tolls_amount__test_tolls_amount_positive.b5e4e898c5
[0m17:48:49.333073 [debug] [Thread-1  ]: Began running node test.nyc_taxi.conditional_values_fct_trips_total_amount__test_total_amount_positive.1bd69ecc4e
[0m17:48:49.334216 [info ] [Thread-1  ]: 8 of 28 START test conditional_values_fct_trips_total_amount__test_total_amount_positive  [RUN]
[0m17:48:49.335387 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.conditional_values_fct_trips_tolls_amount__test_tolls_amount_positive.b5e4e898c5, now test.nyc_taxi.conditional_values_fct_trips_total_amount__test_total_amount_positive.1bd69ecc4e)
[0m17:48:49.336430 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.conditional_values_fct_trips_total_amount__test_total_amount_positive.1bd69ecc4e
[0m17:48:49.344038 [debug] [Thread-1  ]: Compilation Error in test conditional_values_fct_trips_total_amount__test_total_amount_positive (models/tests/schema.yml)
  'test_conditional_values' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m17:48:49.345213 [error] [Thread-1  ]: 8 of 28 ERROR conditional_values_fct_trips_total_amount__test_total_amount_positive  [[31mERROR[0m in 0.01s]
[0m17:48:49.346644 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.conditional_values_fct_trips_total_amount__test_total_amount_positive.1bd69ecc4e
[0m17:48:49.347963 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_dim_payment_type_id.96dfa722aa
[0m17:48:49.349795 [info ] [Thread-1  ]: 9 of 28 START test not_null_dim_payment_type_id ................................ [RUN]
[0m17:48:49.351265 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.conditional_values_fct_trips_total_amount__test_total_amount_positive.1bd69ecc4e, now test.nyc_taxi.not_null_dim_payment_type_id.96dfa722aa)
[0m17:48:49.352427 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_dim_payment_type_id.96dfa722aa
[0m17:48:49.362139 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_dim_payment_type_id.96dfa722aa"
[0m17:48:49.368862 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_dim_payment_type_id.96dfa722aa
[0m17:48:49.373539 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_dim_payment_type_id.96dfa722aa"
[0m17:48:49.379089 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:48:49.382148 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_dim_payment_type_id.96dfa722aa: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_dim_payment_type_id.96dfa722aa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select type_id
from `northern-shield-437204-m0`.`nyc_taxi`.`dim_payment`
where type_id is null



      
    ) dbt_internal_test
[0m17:48:50.129826 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:928b2911-fb6a-4648-889d-da9db999d787&page=queryresults
[0m17:48:51.219599 [info ] [Thread-1  ]: 9 of 28 PASS not_null_dim_payment_type_id ...................................... [[32mPASS[0m in 1.87s]
[0m17:48:51.222100 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_dim_payment_type_id.96dfa722aa
[0m17:48:51.223653 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_dim_zone_borough.1ed2272c52
[0m17:48:51.224890 [info ] [Thread-1  ]: 10 of 28 START test not_null_dim_zone_borough .................................. [RUN]
[0m17:48:51.226357 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_dim_payment_type_id.96dfa722aa, now test.nyc_taxi.not_null_dim_zone_borough.1ed2272c52)
[0m17:48:51.227687 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_dim_zone_borough.1ed2272c52
[0m17:48:51.235650 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_dim_zone_borough.1ed2272c52"
[0m17:48:51.240859 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_dim_zone_borough.1ed2272c52
[0m17:48:51.247747 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_dim_zone_borough.1ed2272c52"
[0m17:48:51.252810 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:48:51.256023 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_dim_zone_borough.1ed2272c52: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_dim_zone_borough.1ed2272c52"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select borough
from `northern-shield-437204-m0`.`nyc_taxi`.`dim_zone`
where borough is null



      
    ) dbt_internal_test
[0m17:48:52.027394 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:c8b98ea9-70b1-4b99-85cc-fd01f8acca38&page=queryresults
[0m17:48:53.150049 [info ] [Thread-1  ]: 10 of 28 PASS not_null_dim_zone_borough ........................................ [[32mPASS[0m in 1.92s]
[0m17:48:53.152428 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_dim_zone_borough.1ed2272c52
[0m17:48:53.154100 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_dim_zone_service_zone.2007f611c5
[0m17:48:53.155494 [info ] [Thread-1  ]: 11 of 28 START test not_null_dim_zone_service_zone ............................. [RUN]
[0m17:48:53.156943 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_dim_zone_borough.1ed2272c52, now test.nyc_taxi.not_null_dim_zone_service_zone.2007f611c5)
[0m17:48:53.158375 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_dim_zone_service_zone.2007f611c5
[0m17:48:53.167239 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_dim_zone_service_zone.2007f611c5"
[0m17:48:53.174085 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_dim_zone_service_zone.2007f611c5
[0m17:48:53.178871 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_dim_zone_service_zone.2007f611c5"
[0m17:48:53.184816 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:48:53.188123 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_dim_zone_service_zone.2007f611c5: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_dim_zone_service_zone.2007f611c5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select service_zone
from `northern-shield-437204-m0`.`nyc_taxi`.`dim_zone`
where service_zone is null



      
    ) dbt_internal_test
[0m17:48:53.967014 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:18f71b9c-6221-433c-8ccc-1945c69f9b3b&page=queryresults
[0m17:48:55.125283 [info ] [Thread-1  ]: 11 of 28 PASS not_null_dim_zone_service_zone ................................... [[32mPASS[0m in 1.97s]
[0m17:48:55.127472 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_dim_zone_service_zone.2007f611c5
[0m17:48:55.128767 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_dim_zone_zone.a1c4a4c37a
[0m17:48:55.129854 [info ] [Thread-1  ]: 12 of 28 START test not_null_dim_zone_zone ..................................... [RUN]
[0m17:48:55.131051 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_dim_zone_service_zone.2007f611c5, now test.nyc_taxi.not_null_dim_zone_zone.a1c4a4c37a)
[0m17:48:55.132045 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_dim_zone_zone.a1c4a4c37a
[0m17:48:55.139657 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_dim_zone_zone.a1c4a4c37a"
[0m17:48:55.146075 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_dim_zone_zone.a1c4a4c37a
[0m17:48:55.150788 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_dim_zone_zone.a1c4a4c37a"
[0m17:48:55.157696 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:48:55.161352 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_dim_zone_zone.a1c4a4c37a: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_dim_zone_zone.a1c4a4c37a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select zone
from `northern-shield-437204-m0`.`nyc_taxi`.`dim_zone`
where zone is null



      
    ) dbt_internal_test
[0m17:48:55.904338 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:8281328c-9b41-4c69-adbc-871348268617&page=queryresults
[0m17:48:57.054571 [info ] [Thread-1  ]: 12 of 28 PASS not_null_dim_zone_zone ........................................... [[32mPASS[0m in 1.92s]
[0m17:48:57.056747 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_dim_zone_zone.a1c4a4c37a
[0m17:48:57.058286 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_do_location_id.6acdd302a6
[0m17:48:57.059533 [info ] [Thread-1  ]: 13 of 28 START test not_null_fct_trips_do_location_id .......................... [RUN]
[0m17:48:57.060813 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_dim_zone_zone.a1c4a4c37a, now test.nyc_taxi.not_null_fct_trips_do_location_id.6acdd302a6)
[0m17:48:57.061947 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_do_location_id.6acdd302a6
[0m17:48:57.071174 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_do_location_id.6acdd302a6"
[0m17:48:57.079250 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_do_location_id.6acdd302a6
[0m17:48:57.084121 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_fct_trips_do_location_id.6acdd302a6"
[0m17:48:57.091948 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:48:57.095831 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_fct_trips_do_location_id.6acdd302a6: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_fct_trips_do_location_id.6acdd302a6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select do_location_id
from `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips`
where do_location_id is null



      
    ) dbt_internal_test
[0m17:48:57.873793 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:a610caea-2113-496d-a8e3-163079394325&page=queryresults
[0m17:48:58.966912 [info ] [Thread-1  ]: 13 of 28 PASS not_null_fct_trips_do_location_id ................................ [[32mPASS[0m in 1.91s]
[0m17:48:58.969107 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_do_location_id.6acdd302a6
[0m17:48:58.970400 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_dropoff_time.04b71dc609
[0m17:48:58.971517 [info ] [Thread-1  ]: 14 of 28 START test not_null_fct_trips_dropoff_time ............................ [RUN]
[0m17:48:58.972664 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_do_location_id.6acdd302a6, now test.nyc_taxi.not_null_fct_trips_dropoff_time.04b71dc609)
[0m17:48:58.973682 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_dropoff_time.04b71dc609
[0m17:48:58.981399 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_dropoff_time.04b71dc609"
[0m17:48:58.988008 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_dropoff_time.04b71dc609
[0m17:48:58.993010 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_fct_trips_dropoff_time.04b71dc609"
[0m17:48:58.998317 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:48:59.002394 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_fct_trips_dropoff_time.04b71dc609: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_fct_trips_dropoff_time.04b71dc609"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select dropoff_time
from `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips`
where dropoff_time is null



      
    ) dbt_internal_test
[0m17:48:59.763892 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:bf5e7c96-ac42-4c53-8be1-cdc044d39fe4&page=queryresults
[0m17:49:00.886732 [info ] [Thread-1  ]: 14 of 28 PASS not_null_fct_trips_dropoff_time .................................. [[32mPASS[0m in 1.91s]
[0m17:49:00.889205 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_dropoff_time.04b71dc609
[0m17:49:00.890753 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_extra.1801055bb3
[0m17:49:00.892155 [info ] [Thread-1  ]: 15 of 28 START test not_null_fct_trips_extra ................................... [RUN]
[0m17:49:00.893589 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_dropoff_time.04b71dc609, now test.nyc_taxi.not_null_fct_trips_extra.1801055bb3)
[0m17:49:00.894803 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_extra.1801055bb3
[0m17:49:00.902727 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_extra.1801055bb3"
[0m17:49:00.908511 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_extra.1801055bb3
[0m17:49:00.915114 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_fct_trips_extra.1801055bb3"
[0m17:49:00.920966 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:49:00.924089 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_fct_trips_extra.1801055bb3: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_fct_trips_extra.1801055bb3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select extra
from `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips`
where extra is null



      
    ) dbt_internal_test
[0m17:49:01.666615 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:f03f08fb-e5b0-4894-96b2-8ee1b39da0dc&page=queryresults
[0m17:49:02.782184 [info ] [Thread-1  ]: 15 of 28 PASS not_null_fct_trips_extra ......................................... [[32mPASS[0m in 1.89s]
[0m17:49:02.784251 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_extra.1801055bb3
[0m17:49:02.785621 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_improvement_surcharge.4cf28d1443
[0m17:49:02.786757 [info ] [Thread-1  ]: 16 of 28 START test not_null_fct_trips_improvement_surcharge ................... [RUN]
[0m17:49:02.788004 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_extra.1801055bb3, now test.nyc_taxi.not_null_fct_trips_improvement_surcharge.4cf28d1443)
[0m17:49:02.789134 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_improvement_surcharge.4cf28d1443
[0m17:49:02.797206 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_improvement_surcharge.4cf28d1443"
[0m17:49:02.804178 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_improvement_surcharge.4cf28d1443
[0m17:49:02.809469 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_fct_trips_improvement_surcharge.4cf28d1443"
[0m17:49:02.816323 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:49:02.820474 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_fct_trips_improvement_surcharge.4cf28d1443: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_fct_trips_improvement_surcharge.4cf28d1443"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select improvement_surcharge
from `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips`
where improvement_surcharge is null



      
    ) dbt_internal_test
[0m17:49:03.585756 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:a2be017c-3450-48ea-8e22-8c6629a6a7a8&page=queryresults
[0m17:49:04.721497 [info ] [Thread-1  ]: 16 of 28 PASS not_null_fct_trips_improvement_surcharge ......................... [[32mPASS[0m in 1.93s]
[0m17:49:04.723577 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_improvement_surcharge.4cf28d1443
[0m17:49:04.724957 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_passenger_count.b1370cab1c
[0m17:49:04.726085 [info ] [Thread-1  ]: 17 of 28 START test not_null_fct_trips_passenger_count ......................... [RUN]
[0m17:49:04.727338 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_improvement_surcharge.4cf28d1443, now test.nyc_taxi.not_null_fct_trips_passenger_count.b1370cab1c)
[0m17:49:04.728346 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_passenger_count.b1370cab1c
[0m17:49:04.735453 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_passenger_count.b1370cab1c"
[0m17:49:04.741441 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_passenger_count.b1370cab1c
[0m17:49:04.746808 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_fct_trips_passenger_count.b1370cab1c"
[0m17:49:04.753307 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:49:04.756674 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_fct_trips_passenger_count.b1370cab1c: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_fct_trips_passenger_count.b1370cab1c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select passenger_count
from `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips`
where passenger_count is null



      
    ) dbt_internal_test
[0m17:49:05.478673 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:65fcf719-dc93-4ba6-857f-bb06be43dd37&page=queryresults
[0m17:49:06.584948 [info ] [Thread-1  ]: 17 of 28 PASS not_null_fct_trips_passenger_count ............................... [[32mPASS[0m in 1.86s]
[0m17:49:06.586965 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_passenger_count.b1370cab1c
[0m17:49:06.588569 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_payment_type.93889b679a
[0m17:49:06.589926 [info ] [Thread-1  ]: 18 of 28 START test not_null_fct_trips_payment_type ............................ [RUN]
[0m17:49:06.591257 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_passenger_count.b1370cab1c, now test.nyc_taxi.not_null_fct_trips_payment_type.93889b679a)
[0m17:49:06.592321 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_payment_type.93889b679a
[0m17:49:06.601644 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_payment_type.93889b679a"
[0m17:49:06.609252 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_payment_type.93889b679a
[0m17:49:06.614149 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_fct_trips_payment_type.93889b679a"
[0m17:49:06.620816 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:49:06.625082 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_fct_trips_payment_type.93889b679a: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_fct_trips_payment_type.93889b679a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select payment_type
from `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips`
where payment_type is null



      
    ) dbt_internal_test
[0m17:49:08.569308 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:ee532637-398f-4593-8b7c-1c5aeeb05537&page=queryresults
[0m17:49:09.005254 [info ] [Thread-1  ]: 18 of 28 PASS not_null_fct_trips_payment_type .................................. [[32mPASS[0m in 2.41s]
[0m17:49:09.007879 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_payment_type.93889b679a
[0m17:49:09.009579 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_pickup_time.693af2bf31
[0m17:49:09.011090 [info ] [Thread-1  ]: 19 of 28 START test not_null_fct_trips_pickup_time ............................. [RUN]
[0m17:49:09.012484 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_payment_type.93889b679a, now test.nyc_taxi.not_null_fct_trips_pickup_time.693af2bf31)
[0m17:49:09.013766 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_pickup_time.693af2bf31
[0m17:49:09.022223 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_pickup_time.693af2bf31"
[0m17:49:09.028308 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_pickup_time.693af2bf31
[0m17:49:09.033075 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_fct_trips_pickup_time.693af2bf31"
[0m17:49:09.038826 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:49:09.043043 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_fct_trips_pickup_time.693af2bf31: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_fct_trips_pickup_time.693af2bf31"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select pickup_time
from `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips`
where pickup_time is null



      
    ) dbt_internal_test
[0m17:49:08.699881 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:385ac7f2-87d5-40a7-9caa-34871af16a21&page=queryresults
[0m17:49:09.822873 [info ] [Thread-1  ]: 19 of 28 PASS not_null_fct_trips_pickup_time ................................... [[32mPASS[0m in 0.81s]
[0m17:49:09.825306 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_pickup_time.693af2bf31
[0m17:49:09.826856 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_pu_location_id.b0dc8dd185
[0m17:49:09.828365 [info ] [Thread-1  ]: 20 of 28 START test not_null_fct_trips_pu_location_id .......................... [RUN]
[0m17:49:09.830198 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_pickup_time.693af2bf31, now test.nyc_taxi.not_null_fct_trips_pu_location_id.b0dc8dd185)
[0m17:49:09.831732 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_pu_location_id.b0dc8dd185
[0m17:49:09.840684 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_pu_location_id.b0dc8dd185"
[0m17:49:09.846779 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_pu_location_id.b0dc8dd185
[0m17:49:09.851647 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_fct_trips_pu_location_id.b0dc8dd185"
[0m17:49:09.858693 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:49:09.862413 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_fct_trips_pu_location_id.b0dc8dd185: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_fct_trips_pu_location_id.b0dc8dd185"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select pu_location_id
from `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips`
where pu_location_id is null



      
    ) dbt_internal_test
[0m17:49:10.591840 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:916b4172-f72e-4e48-a5e9-ad7249e03236&page=queryresults
[0m17:49:11.709350 [info ] [Thread-1  ]: 20 of 28 PASS not_null_fct_trips_pu_location_id ................................ [[32mPASS[0m in 1.88s]
[0m17:49:11.711629 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_pu_location_id.b0dc8dd185
[0m17:49:11.716011 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_rate_code_id.ba0047eaae
[0m17:49:11.717872 [info ] [Thread-1  ]: 21 of 28 START test not_null_fct_trips_rate_code_id ............................ [RUN]
[0m17:49:11.719530 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_pu_location_id.b0dc8dd185, now test.nyc_taxi.not_null_fct_trips_rate_code_id.ba0047eaae)
[0m17:49:11.720885 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_rate_code_id.ba0047eaae
[0m17:49:11.728390 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_rate_code_id.ba0047eaae"
[0m17:49:11.735509 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_rate_code_id.ba0047eaae
[0m17:49:11.740458 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_fct_trips_rate_code_id.ba0047eaae"
[0m17:49:11.746574 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:49:11.749898 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_fct_trips_rate_code_id.ba0047eaae: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_fct_trips_rate_code_id.ba0047eaae"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select rate_code_id
from `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips`
where rate_code_id is null



      
    ) dbt_internal_test
[0m17:49:12.449226 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:51ee78b9-b3d9-4752-bbc1-b1b3b554b168&page=queryresults
[0m17:49:13.538645 [info ] [Thread-1  ]: 21 of 28 PASS not_null_fct_trips_rate_code_id .................................. [[32mPASS[0m in 1.82s]
[0m17:49:13.541072 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_rate_code_id.ba0047eaae
[0m17:49:13.542732 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_trip_distance.19cd17f1df
[0m17:49:13.544057 [info ] [Thread-1  ]: 22 of 28 START test not_null_fct_trips_trip_distance ........................... [RUN]
[0m17:49:13.545509 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_rate_code_id.ba0047eaae, now test.nyc_taxi.not_null_fct_trips_trip_distance.19cd17f1df)
[0m17:49:13.546969 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_trip_distance.19cd17f1df
[0m17:49:13.554725 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_trip_distance.19cd17f1df"
[0m17:49:13.560600 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_trip_distance.19cd17f1df
[0m17:49:13.565367 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_fct_trips_trip_distance.19cd17f1df"
[0m17:49:13.572131 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:49:13.575694 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_fct_trips_trip_distance.19cd17f1df: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_fct_trips_trip_distance.19cd17f1df"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select trip_distance
from `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips`
where trip_distance is null



      
    ) dbt_internal_test
[0m17:49:14.308543 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:5d8f6269-ecf9-4c5d-b13e-c17582cf9da0&page=queryresults
[0m17:49:15.424670 [info ] [Thread-1  ]: 22 of 28 PASS not_null_fct_trips_trip_distance ................................. [[32mPASS[0m in 1.88s]
[0m17:49:15.427033 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_trip_distance.19cd17f1df
[0m17:49:15.428664 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_vendor_id.b9b2f380bb
[0m17:49:15.430264 [info ] [Thread-1  ]: 23 of 28 START test not_null_fct_trips_vendor_id ............................... [RUN]
[0m17:49:15.431795 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_trip_distance.19cd17f1df, now test.nyc_taxi.not_null_fct_trips_vendor_id.b9b2f380bb)
[0m17:49:15.433213 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_vendor_id.b9b2f380bb
[0m17:49:15.442014 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_vendor_id.b9b2f380bb"
[0m17:49:15.448386 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_vendor_id.b9b2f380bb
[0m17:49:15.455171 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_fct_trips_vendor_id.b9b2f380bb"
[0m17:49:15.462171 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:49:15.465623 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_fct_trips_vendor_id.b9b2f380bb: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_fct_trips_vendor_id.b9b2f380bb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select vendor_id
from `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips`
where vendor_id is null



      
    ) dbt_internal_test
[0m17:49:16.225398 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:07ad7ac2-e4f7-480b-a183-5ed42b8b87c6&page=queryresults
[0m17:49:17.337000 [info ] [Thread-1  ]: 23 of 28 PASS not_null_fct_trips_vendor_id ..................................... [[32mPASS[0m in 1.91s]
[0m17:49:17.339157 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_vendor_id.b9b2f380bb
[0m17:49:17.341053 [debug] [Thread-1  ]: Began running node test.nyc_taxi.unique_dim_payment_type_id.dea55de04e
[0m17:49:17.342337 [info ] [Thread-1  ]: 24 of 28 START test unique_dim_payment_type_id ................................. [RUN]
[0m17:49:17.343784 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_vendor_id.b9b2f380bb, now test.nyc_taxi.unique_dim_payment_type_id.dea55de04e)
[0m17:49:17.345052 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.unique_dim_payment_type_id.dea55de04e
[0m17:49:17.355795 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.unique_dim_payment_type_id.dea55de04e"
[0m17:49:17.361789 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.unique_dim_payment_type_id.dea55de04e
[0m17:49:17.366293 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.unique_dim_payment_type_id.dea55de04e"
[0m17:49:17.373333 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:49:17.377181 [debug] [Thread-1  ]: On test.nyc_taxi.unique_dim_payment_type_id.dea55de04e: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.unique_dim_payment_type_id.dea55de04e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select type_id as unique_field
  from `northern-shield-437204-m0`.`nyc_taxi`.`dim_payment`
  where type_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m17:49:18.137431 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:cef4c440-dd94-4364-8911-5a4f4a4d41a8&page=queryresults
[0m17:49:19.232857 [info ] [Thread-1  ]: 24 of 28 PASS unique_dim_payment_type_id ....................................... [[32mPASS[0m in 1.89s]
[0m17:49:19.235448 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.unique_dim_payment_type_id.dea55de04e
[0m17:49:19.237260 [debug] [Thread-1  ]: Began running node test.nyc_taxi.unique_dim_ratecode_rate_id.75ae8e4885
[0m17:49:19.238558 [info ] [Thread-1  ]: 25 of 28 START test unique_dim_ratecode_rate_id ................................ [RUN]
[0m17:49:19.240140 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.unique_dim_payment_type_id.dea55de04e, now test.nyc_taxi.unique_dim_ratecode_rate_id.75ae8e4885)
[0m17:49:19.241609 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.unique_dim_ratecode_rate_id.75ae8e4885
[0m17:49:19.249441 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.unique_dim_ratecode_rate_id.75ae8e4885"
[0m17:49:19.256169 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.unique_dim_ratecode_rate_id.75ae8e4885
[0m17:49:19.260851 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.unique_dim_ratecode_rate_id.75ae8e4885"
[0m17:49:19.266626 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:49:19.270090 [debug] [Thread-1  ]: On test.nyc_taxi.unique_dim_ratecode_rate_id.75ae8e4885: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.unique_dim_ratecode_rate_id.75ae8e4885"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select rate_id as unique_field
  from `northern-shield-437204-m0`.`nyc_taxi`.`dim_ratecode`
  where rate_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m17:49:20.000292 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:f3afc4c9-ede8-4c91-b022-095d58b625a1&page=queryresults
[0m17:49:21.115790 [info ] [Thread-1  ]: 25 of 28 PASS unique_dim_ratecode_rate_id ...................................... [[32mPASS[0m in 1.88s]
[0m17:49:21.118684 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.unique_dim_ratecode_rate_id.75ae8e4885
[0m17:49:21.124718 [debug] [Thread-1  ]: Began running node test.nyc_taxi.unique_dim_vendor_id.03fad38d04
[0m17:49:21.126205 [info ] [Thread-1  ]: 26 of 28 START test unique_dim_vendor_id ....................................... [RUN]
[0m17:49:21.127872 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.unique_dim_ratecode_rate_id.75ae8e4885, now test.nyc_taxi.unique_dim_vendor_id.03fad38d04)
[0m17:49:21.129213 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.unique_dim_vendor_id.03fad38d04
[0m17:49:21.137493 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.unique_dim_vendor_id.03fad38d04"
[0m17:49:21.143563 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.unique_dim_vendor_id.03fad38d04
[0m17:49:21.148620 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.unique_dim_vendor_id.03fad38d04"
[0m17:49:21.156051 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:49:21.160305 [debug] [Thread-1  ]: On test.nyc_taxi.unique_dim_vendor_id.03fad38d04: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.unique_dim_vendor_id.03fad38d04"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select id as unique_field
  from `northern-shield-437204-m0`.`nyc_taxi`.`dim_vendor`
  where id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m17:49:21.904305 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:4128059c-ed36-4d09-9e0f-0654d6a54cdf&page=queryresults
[0m17:49:23.019224 [info ] [Thread-1  ]: 26 of 28 PASS unique_dim_vendor_id ............................................. [[32mPASS[0m in 1.89s]
[0m17:49:23.021621 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.unique_dim_vendor_id.03fad38d04
[0m17:49:23.023172 [debug] [Thread-1  ]: Began running node test.nyc_taxi.unique_dim_zone_location_id.7702f92424
[0m17:49:23.024462 [info ] [Thread-1  ]: 27 of 28 START test unique_dim_zone_location_id ................................ [RUN]
[0m17:49:23.025927 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.unique_dim_vendor_id.03fad38d04, now test.nyc_taxi.unique_dim_zone_location_id.7702f92424)
[0m17:49:23.027112 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.unique_dim_zone_location_id.7702f92424
[0m17:49:23.035774 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.unique_dim_zone_location_id.7702f92424"
[0m17:49:23.042270 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.unique_dim_zone_location_id.7702f92424
[0m17:49:23.046894 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.unique_dim_zone_location_id.7702f92424"
[0m17:49:23.053426 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:49:23.056882 [debug] [Thread-1  ]: On test.nyc_taxi.unique_dim_zone_location_id.7702f92424: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.unique_dim_zone_location_id.7702f92424"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select location_id as unique_field
  from `northern-shield-437204-m0`.`nyc_taxi`.`dim_zone`
  where location_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m17:49:23.782743 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:eb15b314-9322-4c59-991c-2e3a5497e8e8&page=queryresults
[0m17:49:24.928755 [info ] [Thread-1  ]: 27 of 28 PASS unique_dim_zone_location_id ...................................... [[32mPASS[0m in 1.90s]
[0m17:49:24.930841 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.unique_dim_zone_location_id.7702f92424
[0m17:49:24.932303 [debug] [Thread-1  ]: Began running node test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab
[0m17:49:24.933568 [info ] [Thread-1  ]: 28 of 28 START test unique_fct_trips_trip_id ................................... [RUN]
[0m17:49:24.934827 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.unique_dim_zone_location_id.7702f92424, now test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab)
[0m17:49:24.935890 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab
[0m17:49:24.942821 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab"
[0m17:49:24.954536 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab
[0m17:49:24.963759 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab"
[0m17:49:24.971232 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:49:24.976049 [debug] [Thread-1  ]: On test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select trip_id as unique_field
  from `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips`
  where trip_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m17:49:25.759082 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:d024b4f6-71d6-4b5c-8bba-e24dc6e108a2&page=queryresults
[0m17:49:26.837049 [info ] [Thread-1  ]: 28 of 28 PASS unique_fct_trips_trip_id ......................................... [[32mPASS[0m in 1.90s]
[0m17:49:26.839572 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab
[0m17:49:26.842917 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:49:26.844095 [debug] [MainThread]: Connection 'test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab' was properly closed.
[0m17:49:26.845323 [info ] [MainThread]: 
[0m17:49:26.846642 [info ] [MainThread]: Finished running 28 data tests in 0 hours 0 minutes and 44.13 seconds (44.13s).
[0m17:49:26.858576 [debug] [MainThread]: Command end result
[0m17:49:26.939272 [info ] [MainThread]: 
[0m17:49:26.940748 [info ] [MainThread]: [31mCompleted with 5 errors and 0 warnings:[0m
[0m17:49:26.941994 [info ] [MainThread]: 
[0m17:49:26.943296 [error] [MainThread]:   Compilation Error in test conditional_values_fct_trips_fare_amount__test_fare_amount_positive (models/tests/schema.yml)
  'test_conditional_values' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m17:49:26.944386 [info ] [MainThread]: 
[0m17:49:26.945549 [error] [MainThread]:   Compilation Error in test conditional_values_fct_trips_mta_tax__test_mta_tax_positive (models/tests/schema.yml)
  'test_conditional_values' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m17:49:26.946571 [info ] [MainThread]: 
[0m17:49:26.947724 [error] [MainThread]:   Compilation Error in test conditional_values_fct_trips_tip_amount__test_tip_amount_positive (models/tests/schema.yml)
  'test_conditional_values' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m17:49:26.948783 [info ] [MainThread]: 
[0m17:49:26.949908 [error] [MainThread]:   Compilation Error in test conditional_values_fct_trips_tolls_amount__test_tolls_amount_positive (models/tests/schema.yml)
  'test_conditional_values' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m17:49:26.950965 [info ] [MainThread]: 
[0m17:49:26.954536 [error] [MainThread]:   Compilation Error in test conditional_values_fct_trips_total_amount__test_total_amount_positive (models/tests/schema.yml)
  'test_conditional_values' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m17:49:26.955716 [info ] [MainThread]: 
[0m17:49:26.956874 [info ] [MainThread]: Done. PASS=23 WARN=0 ERROR=5 SKIP=0 TOTAL=28
[0m17:49:26.959068 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 48.70683, "process_in_blocks": "0", "process_kernel_time": 0.411757, "process_mem_max_rss": "232732", "process_out_blocks": "0", "process_user_time": 6.616839}
[0m17:49:26.960965 [debug] [MainThread]: Command `dbt test` failed at 17:49:26.960552 after 48.71 seconds
[0m17:49:26.962252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33b9c3aca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3384656820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3384597ca0>]}
[0m17:49:26.963339 [debug] [MainThread]: Flushing usage events
[0m17:57:07.722576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a0404bc40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a03283eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a01edfd90>]}


============================== 17:57:07.731163 | 42bb0bfe-7849-4ff0-a0af-fb5dbc95dd5b ==============================
[0m17:57:07.731163 [info ] [MainThread]: Running with dbt=1.8.9
[0m17:57:07.732669 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'profiles_dir': '/opt/airflow/include/dbt/', 'partial_parse': 'True', 'version_check': 'True', 'static_parser': 'True', 'warn_error': 'None', 'no_print': 'None', 'debug': 'False', 'write_json': 'True', 'printer_width': '80', 'target_path': 'None', 'log_format': 'default', 'empty': 'None', 'cache_selected_only': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'fail_fast': 'False', 'indirect_selection': 'eager', 'quiet': 'False', 'invocation_command': 'dbt test --profiles-dir /opt/airflow/include/dbt/', 'log_path': '/opt/airflow/include/dbt/logs', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'use_colors': 'True', 'log_cache_events': 'False'}
[0m17:57:09.118951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '42bb0bfe-7849-4ff0-a0af-fb5dbc95dd5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f49caa59040>]}
[0m17:57:09.186278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '42bb0bfe-7849-4ff0-a0af-fb5dbc95dd5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f49caa16370>]}
[0m17:57:09.188253 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m17:57:09.374298 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m17:57:10.166038 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 5 files added, 0 files changed.
[0m17:57:10.167595 [debug] [MainThread]: Partial parsing: added file: nyc_taxi://models/tests/test_mta_tax_positive.sql
[0m17:57:10.168754 [debug] [MainThread]: Partial parsing: added file: nyc_taxi://models/tests/test_fare_amount_positive.sql
[0m17:57:10.169757 [debug] [MainThread]: Partial parsing: added file: nyc_taxi://models/tests/test_total_amount_positive.sql
[0m17:57:10.170669 [debug] [MainThread]: Partial parsing: added file: nyc_taxi://models/tests/test_tolls_amount_positive.sql
[0m17:57:10.171583 [debug] [MainThread]: Partial parsing: added file: nyc_taxi://models/tests/test_tip_amount_positive.sql
[0m17:57:10.632062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '42bb0bfe-7849-4ff0-a0af-fb5dbc95dd5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f49fc70cee0>]}
[0m17:57:10.821177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '42bb0bfe-7849-4ff0-a0af-fb5dbc95dd5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f49f9f1cee0>]}
[0m17:57:10.822431 [info ] [MainThread]: Found 10 models, 28 data tests, 2 sources, 600 macros
[0m17:57:10.823596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '42bb0bfe-7849-4ff0-a0af-fb5dbc95dd5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f49fc768190>]}
[0m17:57:10.828335 [info ] [MainThread]: 
[0m17:57:10.830120 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:57:10.837546 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_northern-shield-437204-m0_nyc_taxi'
[0m17:57:10.838725 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:57:11.516596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '42bb0bfe-7849-4ff0-a0af-fb5dbc95dd5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a040362b0>]}
[0m17:57:11.518490 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:57:11.519942 [info ] [MainThread]: 
[0m17:57:11.530178 [debug] [Thread-1  ]: Began running node test.nyc_taxi.accepted_values_dim_payment_payment_name__Credit_card__Cash__No_charge__Dispute__Unknown__Voided_trip.58d00ef9f4
[0m17:57:11.531644 [info ] [Thread-1  ]: 1 of 28 START test accepted_values_dim_payment_payment_name__Credit_card__Cash__No_charge__Dispute__Unknown__Voided_trip  [RUN]
[0m17:57:11.533192 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_northern-shield-437204-m0_nyc_taxi, now test.nyc_taxi.accepted_values_dim_payment_payment_name__Credit_card__Cash__No_charge__Dispute__Unknown__Voided_trip.58d00ef9f4)
[0m17:57:11.534286 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.accepted_values_dim_payment_payment_name__Credit_card__Cash__No_charge__Dispute__Unknown__Voided_trip.58d00ef9f4
[0m17:57:11.559155 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.accepted_values_dim_payment_payment_name__Credit_card__Cash__No_charge__Dispute__Unknown__Voided_trip.58d00ef9f4"
[0m17:57:11.565972 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.accepted_values_dim_payment_payment_name__Credit_card__Cash__No_charge__Dispute__Unknown__Voided_trip.58d00ef9f4
[0m17:57:11.593643 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.accepted_values_dim_payment_payment_name__Credit_card__Cash__No_charge__Dispute__Unknown__Voided_trip.58d00ef9f4"
[0m17:57:11.599610 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:57:11.602838 [debug] [Thread-1  ]: On test.nyc_taxi.accepted_values_dim_payment_payment_name__Credit_card__Cash__No_charge__Dispute__Unknown__Voided_trip.58d00ef9f4: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.accepted_values_dim_payment_payment_name__Credit_card__Cash__No_charge__Dispute__Unknown__Voided_trip.58d00ef9f4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        payment_name as value_field,
        count(*) as n_records

    from `northern-shield-437204-m0`.`nyc_taxi`.`dim_payment`
    group by payment_name

)

select *
from all_values
where value_field not in (
    'Credit card','Cash','No charge','Dispute','Unknown','Voided trip'
)



      
    ) dbt_internal_test
[0m17:57:12.500191 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:bcfa054a-202e-4a5e-b53d-8395fdd5a8f2&page=queryresults
[0m17:57:13.712519 [info ] [Thread-1  ]: 1 of 28 PASS accepted_values_dim_payment_payment_name__Credit_card__Cash__No_charge__Dispute__Unknown__Voided_trip  [[32mPASS[0m in 2.18s]
[0m17:57:13.714869 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.accepted_values_dim_payment_payment_name__Credit_card__Cash__No_charge__Dispute__Unknown__Voided_trip.58d00ef9f4
[0m17:57:13.716581 [debug] [Thread-1  ]: Began running node test.nyc_taxi.accepted_values_dim_ratecode_rate_code_name__Standard_rate__JFK__Newark__Nassau_or_Westchester__Negotiated_fare__Group_ride__Unknown.57ee02019f
[0m17:57:13.717827 [info ] [Thread-1  ]: 2 of 28 START test accepted_values_dim_ratecode_rate_code_name__Standard_rate__JFK__Newark__Nassau_or_Westchester__Negotiated_fare__Group_ride__Unknown  [RUN]
[0m17:57:13.719178 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.accepted_values_dim_payment_payment_name__Credit_card__Cash__No_charge__Dispute__Unknown__Voided_trip.58d00ef9f4, now test.nyc_taxi.accepted_values_dim_ratecode_rate_code_name__Standard_rate__JFK__Newark__Nassau_or_Westchester__Negotiated_fare__Group_ride__Unknown.57ee02019f)
[0m17:57:13.720405 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.accepted_values_dim_ratecode_rate_code_name__Standard_rate__JFK__Newark__Nassau_or_Westchester__Negotiated_fare__Group_ride__Unknown.57ee02019f
[0m17:57:13.732713 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.accepted_values_dim_ratecode_rate_code_name__Standard_rate__JFK__Newark__Nassau_or_Westchester__Negotiated_fare__Group_ride__Unknown.57ee02019f"
[0m17:57:13.741670 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.accepted_values_dim_ratecode_rate_code_name__Standard_rate__JFK__Newark__Nassau_or_Westchester__Negotiated_fare__Group_ride__Unknown.57ee02019f
[0m17:57:13.751856 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.accepted_values_dim_ratecode_rate_code_name__Standard_rate__JFK__Newark__Nassau_or_Westchester__Negotiated_fare__Group_ride__Unknown.57ee02019f"
[0m17:57:13.759753 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:57:13.764194 [debug] [Thread-1  ]: On test.nyc_taxi.accepted_values_dim_ratecode_rate_code_name__Standard_rate__JFK__Newark__Nassau_or_Westchester__Negotiated_fare__Group_ride__Unknown.57ee02019f: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.accepted_values_dim_ratecode_rate_code_name__Standard_rate__JFK__Newark__Nassau_or_Westchester__Negotiated_fare__Group_ride__Unknown.57ee02019f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        rate_code_name as value_field,
        count(*) as n_records

    from `northern-shield-437204-m0`.`nyc_taxi`.`dim_ratecode`
    group by rate_code_name

)

select *
from all_values
where value_field not in (
    'Standard rate','JFK','Newark','Nassau or Westchester','Negotiated fare','Group ride','Unknown'
)



      
    ) dbt_internal_test
[0m17:57:14.629519 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:073a3aa6-cc8e-40b1-ba5a-1e33e5e17569&page=queryresults
[0m17:57:15.835389 [info ] [Thread-1  ]: 2 of 28 PASS accepted_values_dim_ratecode_rate_code_name__Standard_rate__JFK__Newark__Nassau_or_Westchester__Negotiated_fare__Group_ride__Unknown  [[32mPASS[0m in 2.12s]
[0m17:57:15.837687 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.accepted_values_dim_ratecode_rate_code_name__Standard_rate__JFK__Newark__Nassau_or_Westchester__Negotiated_fare__Group_ride__Unknown.57ee02019f
[0m17:57:15.839125 [debug] [Thread-1  ]: Began running node test.nyc_taxi.accepted_values_dim_vendor_vendor_name__Creative_Mobile_Technologies__VeriFone_Inc_.7481cecf07
[0m17:57:15.840387 [info ] [Thread-1  ]: 3 of 28 START test accepted_values_dim_vendor_vendor_name__Creative_Mobile_Technologies__VeriFone_Inc_  [RUN]
[0m17:57:15.841602 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.accepted_values_dim_ratecode_rate_code_name__Standard_rate__JFK__Newark__Nassau_or_Westchester__Negotiated_fare__Group_ride__Unknown.57ee02019f, now test.nyc_taxi.accepted_values_dim_vendor_vendor_name__Creative_Mobile_Technologies__VeriFone_Inc_.7481cecf07)
[0m17:57:15.842610 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.accepted_values_dim_vendor_vendor_name__Creative_Mobile_Technologies__VeriFone_Inc_.7481cecf07
[0m17:57:15.851154 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.accepted_values_dim_vendor_vendor_name__Creative_Mobile_Technologies__VeriFone_Inc_.7481cecf07"
[0m17:57:15.856832 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.accepted_values_dim_vendor_vendor_name__Creative_Mobile_Technologies__VeriFone_Inc_.7481cecf07
[0m17:57:15.861370 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.accepted_values_dim_vendor_vendor_name__Creative_Mobile_Technologies__VeriFone_Inc_.7481cecf07"
[0m17:57:15.868993 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:57:15.873097 [debug] [Thread-1  ]: On test.nyc_taxi.accepted_values_dim_vendor_vendor_name__Creative_Mobile_Technologies__VeriFone_Inc_.7481cecf07: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.accepted_values_dim_vendor_vendor_name__Creative_Mobile_Technologies__VeriFone_Inc_.7481cecf07"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        vendor_name as value_field,
        count(*) as n_records

    from `northern-shield-437204-m0`.`nyc_taxi`.`dim_vendor`
    group by vendor_name

)

select *
from all_values
where value_field not in (
    'Creative Mobile Technologies','VeriFone Inc.'
)



      
    ) dbt_internal_test
[0m17:57:16.659044 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:65da1aa1-f0a2-4089-a0e3-28832c3a92ba&page=queryresults
[0m17:57:17.797528 [info ] [Thread-1  ]: 3 of 28 PASS accepted_values_dim_vendor_vendor_name__Creative_Mobile_Technologies__VeriFone_Inc_  [[32mPASS[0m in 1.96s]
[0m17:57:17.799833 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.accepted_values_dim_vendor_vendor_name__Creative_Mobile_Technologies__VeriFone_Inc_.7481cecf07
[0m17:57:17.801605 [debug] [Thread-1  ]: Began running node test.nyc_taxi.conditional_values_fct_trips_fare_amount__test_fare_amount_positive.42cfe6599e
[0m17:57:17.802937 [info ] [Thread-1  ]: 4 of 28 START test conditional_values_fct_trips_fare_amount__test_fare_amount_positive  [RUN]
[0m17:57:17.804360 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.accepted_values_dim_vendor_vendor_name__Creative_Mobile_Technologies__VeriFone_Inc_.7481cecf07, now test.nyc_taxi.conditional_values_fct_trips_fare_amount__test_fare_amount_positive.42cfe6599e)
[0m17:57:17.805563 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.conditional_values_fct_trips_fare_amount__test_fare_amount_positive.42cfe6599e
[0m17:57:17.815988 [debug] [Thread-1  ]: Compilation Error in test conditional_values_fct_trips_fare_amount__test_fare_amount_positive (models/tests/schema.yml)
  'test_conditional_values' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m17:57:17.817308 [error] [Thread-1  ]: 4 of 28 ERROR conditional_values_fct_trips_fare_amount__test_fare_amount_positive  [[31mERROR[0m in 0.01s]
[0m17:57:17.818730 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.conditional_values_fct_trips_fare_amount__test_fare_amount_positive.42cfe6599e
[0m17:57:17.820002 [debug] [Thread-1  ]: Began running node test.nyc_taxi.conditional_values_fct_trips_mta_tax__test_mta_tax_positive.21bb3dd018
[0m17:57:17.821188 [info ] [Thread-1  ]: 5 of 28 START test conditional_values_fct_trips_mta_tax__test_mta_tax_positive . [RUN]
[0m17:57:17.822395 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.conditional_values_fct_trips_fare_amount__test_fare_amount_positive.42cfe6599e, now test.nyc_taxi.conditional_values_fct_trips_mta_tax__test_mta_tax_positive.21bb3dd018)
[0m17:57:17.823605 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.conditional_values_fct_trips_mta_tax__test_mta_tax_positive.21bb3dd018
[0m17:57:17.831547 [debug] [Thread-1  ]: Compilation Error in test conditional_values_fct_trips_mta_tax__test_mta_tax_positive (models/tests/schema.yml)
  'test_conditional_values' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m17:57:17.833041 [error] [Thread-1  ]: 5 of 28 ERROR conditional_values_fct_trips_mta_tax__test_mta_tax_positive ...... [[31mERROR[0m in 0.01s]
[0m17:57:17.834730 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.conditional_values_fct_trips_mta_tax__test_mta_tax_positive.21bb3dd018
[0m17:57:17.836210 [debug] [Thread-1  ]: Began running node test.nyc_taxi.conditional_values_fct_trips_tip_amount__test_tip_amount_positive.cc3a05edfa
[0m17:57:17.837478 [info ] [Thread-1  ]: 6 of 28 START test conditional_values_fct_trips_tip_amount__test_tip_amount_positive  [RUN]
[0m17:57:17.838671 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.conditional_values_fct_trips_mta_tax__test_mta_tax_positive.21bb3dd018, now test.nyc_taxi.conditional_values_fct_trips_tip_amount__test_tip_amount_positive.cc3a05edfa)
[0m17:57:17.839686 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.conditional_values_fct_trips_tip_amount__test_tip_amount_positive.cc3a05edfa
[0m17:57:17.848921 [debug] [Thread-1  ]: Compilation Error in test conditional_values_fct_trips_tip_amount__test_tip_amount_positive (models/tests/schema.yml)
  'test_conditional_values' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m17:57:17.850482 [error] [Thread-1  ]: 6 of 28 ERROR conditional_values_fct_trips_tip_amount__test_tip_amount_positive  [[31mERROR[0m in 0.01s]
[0m17:57:17.852251 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.conditional_values_fct_trips_tip_amount__test_tip_amount_positive.cc3a05edfa
[0m17:57:17.854275 [debug] [Thread-1  ]: Began running node test.nyc_taxi.conditional_values_fct_trips_tolls_amount__test_tolls_amount_positive.b5e4e898c5
[0m17:57:17.855760 [info ] [Thread-1  ]: 7 of 28 START test conditional_values_fct_trips_tolls_amount__test_tolls_amount_positive  [RUN]
[0m17:57:17.857210 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.conditional_values_fct_trips_tip_amount__test_tip_amount_positive.cc3a05edfa, now test.nyc_taxi.conditional_values_fct_trips_tolls_amount__test_tolls_amount_positive.b5e4e898c5)
[0m17:57:17.858357 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.conditional_values_fct_trips_tolls_amount__test_tolls_amount_positive.b5e4e898c5
[0m17:57:17.866032 [debug] [Thread-1  ]: Compilation Error in test conditional_values_fct_trips_tolls_amount__test_tolls_amount_positive (models/tests/schema.yml)
  'test_conditional_values' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m17:57:17.867208 [error] [Thread-1  ]: 7 of 28 ERROR conditional_values_fct_trips_tolls_amount__test_tolls_amount_positive  [[31mERROR[0m in 0.01s]
[0m17:57:17.868687 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.conditional_values_fct_trips_tolls_amount__test_tolls_amount_positive.b5e4e898c5
[0m17:57:17.870036 [debug] [Thread-1  ]: Began running node test.nyc_taxi.conditional_values_fct_trips_total_amount__test_total_amount_positive.1bd69ecc4e
[0m17:57:17.871294 [info ] [Thread-1  ]: 8 of 28 START test conditional_values_fct_trips_total_amount__test_total_amount_positive  [RUN]
[0m17:57:17.872889 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.conditional_values_fct_trips_tolls_amount__test_tolls_amount_positive.b5e4e898c5, now test.nyc_taxi.conditional_values_fct_trips_total_amount__test_total_amount_positive.1bd69ecc4e)
[0m17:57:17.874110 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.conditional_values_fct_trips_total_amount__test_total_amount_positive.1bd69ecc4e
[0m17:57:17.881978 [debug] [Thread-1  ]: Compilation Error in test conditional_values_fct_trips_total_amount__test_total_amount_positive (models/tests/schema.yml)
  'test_conditional_values' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m17:57:17.883557 [error] [Thread-1  ]: 8 of 28 ERROR conditional_values_fct_trips_total_amount__test_total_amount_positive  [[31mERROR[0m in 0.01s]
[0m17:57:17.885270 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.conditional_values_fct_trips_total_amount__test_total_amount_positive.1bd69ecc4e
[0m17:57:17.886558 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_dim_payment_type_id.96dfa722aa
[0m17:57:17.887790 [info ] [Thread-1  ]: 9 of 28 START test not_null_dim_payment_type_id ................................ [RUN]
[0m17:57:17.889252 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.conditional_values_fct_trips_total_amount__test_total_amount_positive.1bd69ecc4e, now test.nyc_taxi.not_null_dim_payment_type_id.96dfa722aa)
[0m17:57:17.890505 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_dim_payment_type_id.96dfa722aa
[0m17:57:17.900055 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_dim_payment_type_id.96dfa722aa"
[0m17:57:17.905598 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_dim_payment_type_id.96dfa722aa
[0m17:57:17.910731 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_dim_payment_type_id.96dfa722aa"
[0m17:57:17.916315 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:57:17.919517 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_dim_payment_type_id.96dfa722aa: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_dim_payment_type_id.96dfa722aa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select type_id
from `northern-shield-437204-m0`.`nyc_taxi`.`dim_payment`
where type_id is null



      
    ) dbt_internal_test
[0m17:57:18.718340 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:a7fd35dc-91a1-4281-8ff8-962a11637d6b&page=queryresults
[0m17:57:19.875526 [info ] [Thread-1  ]: 9 of 28 PASS not_null_dim_payment_type_id ...................................... [[32mPASS[0m in 1.99s]
[0m17:57:19.878281 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_dim_payment_type_id.96dfa722aa
[0m17:57:19.880143 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_dim_zone_borough.1ed2272c52
[0m17:57:19.881541 [info ] [Thread-1  ]: 10 of 28 START test not_null_dim_zone_borough .................................. [RUN]
[0m17:57:19.883161 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_dim_payment_type_id.96dfa722aa, now test.nyc_taxi.not_null_dim_zone_borough.1ed2272c52)
[0m17:57:19.884475 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_dim_zone_borough.1ed2272c52
[0m17:57:19.894544 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_dim_zone_borough.1ed2272c52"
[0m17:57:19.900363 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_dim_zone_borough.1ed2272c52
[0m17:57:19.905266 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_dim_zone_borough.1ed2272c52"
[0m17:57:19.911253 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:57:19.914577 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_dim_zone_borough.1ed2272c52: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_dim_zone_borough.1ed2272c52"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select borough
from `northern-shield-437204-m0`.`nyc_taxi`.`dim_zone`
where borough is null



      
    ) dbt_internal_test
[0m17:57:20.673587 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:9d9c467c-ca49-4a52-bef5-a211f3caebca&page=queryresults
[0m17:57:21.857481 [info ] [Thread-1  ]: 10 of 28 PASS not_null_dim_zone_borough ........................................ [[32mPASS[0m in 1.97s]
[0m17:57:21.860013 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_dim_zone_borough.1ed2272c52
[0m17:57:21.861834 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_dim_zone_service_zone.2007f611c5
[0m17:57:21.863152 [info ] [Thread-1  ]: 11 of 28 START test not_null_dim_zone_service_zone ............................. [RUN]
[0m17:57:21.864651 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_dim_zone_borough.1ed2272c52, now test.nyc_taxi.not_null_dim_zone_service_zone.2007f611c5)
[0m17:57:21.866275 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_dim_zone_service_zone.2007f611c5
[0m17:57:21.875445 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_dim_zone_service_zone.2007f611c5"
[0m17:57:21.881527 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_dim_zone_service_zone.2007f611c5
[0m17:57:21.886867 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_dim_zone_service_zone.2007f611c5"
[0m17:57:21.893162 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:57:21.896443 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_dim_zone_service_zone.2007f611c5: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_dim_zone_service_zone.2007f611c5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select service_zone
from `northern-shield-437204-m0`.`nyc_taxi`.`dim_zone`
where service_zone is null



      
    ) dbt_internal_test
[0m17:57:22.713600 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:cd719ca7-9a91-48e1-bc53-fdb4c164072f&page=queryresults
[0m17:57:23.879199 [info ] [Thread-1  ]: 11 of 28 PASS not_null_dim_zone_service_zone ................................... [[32mPASS[0m in 2.01s]
[0m17:57:23.881668 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_dim_zone_service_zone.2007f611c5
[0m17:57:23.883441 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_dim_zone_zone.a1c4a4c37a
[0m17:57:23.884727 [info ] [Thread-1  ]: 12 of 28 START test not_null_dim_zone_zone ..................................... [RUN]
[0m17:57:23.886272 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_dim_zone_service_zone.2007f611c5, now test.nyc_taxi.not_null_dim_zone_zone.a1c4a4c37a)
[0m17:57:23.887522 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_dim_zone_zone.a1c4a4c37a
[0m17:57:23.895422 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_dim_zone_zone.a1c4a4c37a"
[0m17:57:23.901526 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_dim_zone_zone.a1c4a4c37a
[0m17:57:23.906197 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_dim_zone_zone.a1c4a4c37a"
[0m17:57:23.911755 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:57:23.915396 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_dim_zone_zone.a1c4a4c37a: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_dim_zone_zone.a1c4a4c37a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select zone
from `northern-shield-437204-m0`.`nyc_taxi`.`dim_zone`
where zone is null



      
    ) dbt_internal_test
[0m17:57:24.652831 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:7e10b2d1-8d9c-42c5-a218-386bd34ad0c4&page=queryresults
[0m17:57:25.789999 [info ] [Thread-1  ]: 12 of 28 PASS not_null_dim_zone_zone ........................................... [[32mPASS[0m in 1.90s]
[0m17:57:25.792390 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_dim_zone_zone.a1c4a4c37a
[0m17:57:25.796722 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_do_location_id.6acdd302a6
[0m17:57:25.798032 [info ] [Thread-1  ]: 13 of 28 START test not_null_fct_trips_do_location_id .......................... [RUN]
[0m17:57:25.799501 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_dim_zone_zone.a1c4a4c37a, now test.nyc_taxi.not_null_fct_trips_do_location_id.6acdd302a6)
[0m17:57:25.800808 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_do_location_id.6acdd302a6
[0m17:57:25.808158 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_do_location_id.6acdd302a6"
[0m17:57:25.814266 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_do_location_id.6acdd302a6
[0m17:57:25.818903 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_fct_trips_do_location_id.6acdd302a6"
[0m17:57:25.825241 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:57:25.828806 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_fct_trips_do_location_id.6acdd302a6: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_fct_trips_do_location_id.6acdd302a6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select do_location_id
from `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips`
where do_location_id is null



      
    ) dbt_internal_test
[0m17:57:26.610170 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:93bcb903-b878-4c7b-b220-e467a88f0800&page=queryresults
[0m17:57:27.717912 [info ] [Thread-1  ]: 13 of 28 PASS not_null_fct_trips_do_location_id ................................ [[32mPASS[0m in 1.92s]
[0m17:57:27.720260 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_do_location_id.6acdd302a6
[0m17:57:27.722171 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_dropoff_time.04b71dc609
[0m17:57:27.723677 [info ] [Thread-1  ]: 14 of 28 START test not_null_fct_trips_dropoff_time ............................ [RUN]
[0m17:57:27.725148 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_do_location_id.6acdd302a6, now test.nyc_taxi.not_null_fct_trips_dropoff_time.04b71dc609)
[0m17:57:27.726500 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_dropoff_time.04b71dc609
[0m17:57:27.734395 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_dropoff_time.04b71dc609"
[0m17:57:27.739762 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_dropoff_time.04b71dc609
[0m17:57:27.744846 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_fct_trips_dropoff_time.04b71dc609"
[0m17:57:27.750474 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:57:27.754077 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_fct_trips_dropoff_time.04b71dc609: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_fct_trips_dropoff_time.04b71dc609"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select dropoff_time
from `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips`
where dropoff_time is null



      
    ) dbt_internal_test
[0m17:57:28.478396 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:441bcb30-2fde-4a05-a783-3b2383a33fbb&page=queryresults
[0m17:57:29.602856 [info ] [Thread-1  ]: 14 of 28 PASS not_null_fct_trips_dropoff_time .................................. [[32mPASS[0m in 1.88s]
[0m17:57:29.605368 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_dropoff_time.04b71dc609
[0m17:57:29.607007 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_extra.1801055bb3
[0m17:57:29.608271 [info ] [Thread-1  ]: 15 of 28 START test not_null_fct_trips_extra ................................... [RUN]
[0m17:57:29.609617 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_dropoff_time.04b71dc609, now test.nyc_taxi.not_null_fct_trips_extra.1801055bb3)
[0m17:57:29.610859 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_extra.1801055bb3
[0m17:57:29.621188 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_extra.1801055bb3"
[0m17:57:29.626444 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_extra.1801055bb3
[0m17:57:29.630987 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_fct_trips_extra.1801055bb3"
[0m17:57:29.635714 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:57:29.639732 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_fct_trips_extra.1801055bb3: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_fct_trips_extra.1801055bb3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select extra
from `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips`
where extra is null



      
    ) dbt_internal_test
[0m17:57:30.415340 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:b3102c3e-9247-4a0f-9a98-703eb75385d3&page=queryresults
[0m17:57:31.622509 [info ] [Thread-1  ]: 15 of 28 PASS not_null_fct_trips_extra ......................................... [[32mPASS[0m in 2.01s]
[0m17:57:31.625172 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_extra.1801055bb3
[0m17:57:31.626749 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_improvement_surcharge.4cf28d1443
[0m17:57:31.628124 [info ] [Thread-1  ]: 16 of 28 START test not_null_fct_trips_improvement_surcharge ................... [RUN]
[0m17:57:31.629810 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_extra.1801055bb3, now test.nyc_taxi.not_null_fct_trips_improvement_surcharge.4cf28d1443)
[0m17:57:31.631083 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_improvement_surcharge.4cf28d1443
[0m17:57:31.639945 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_improvement_surcharge.4cf28d1443"
[0m17:57:31.645948 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_improvement_surcharge.4cf28d1443
[0m17:57:31.650405 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_fct_trips_improvement_surcharge.4cf28d1443"
[0m17:57:31.656726 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:57:31.660432 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_fct_trips_improvement_surcharge.4cf28d1443: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_fct_trips_improvement_surcharge.4cf28d1443"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select improvement_surcharge
from `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips`
where improvement_surcharge is null



      
    ) dbt_internal_test
[0m17:57:32.425163 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:8908f9c2-8df3-4952-ad1a-78059b635571&page=queryresults
[0m17:57:33.546071 [info ] [Thread-1  ]: 16 of 28 PASS not_null_fct_trips_improvement_surcharge ......................... [[32mPASS[0m in 1.92s]
[0m17:57:33.548036 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_improvement_surcharge.4cf28d1443
[0m17:57:33.549475 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_passenger_count.b1370cab1c
[0m17:57:33.550695 [info ] [Thread-1  ]: 17 of 28 START test not_null_fct_trips_passenger_count ......................... [RUN]
[0m17:57:33.551941 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_improvement_surcharge.4cf28d1443, now test.nyc_taxi.not_null_fct_trips_passenger_count.b1370cab1c)
[0m17:57:33.553069 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_passenger_count.b1370cab1c
[0m17:57:33.559513 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_passenger_count.b1370cab1c"
[0m17:57:33.566427 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_passenger_count.b1370cab1c
[0m17:57:33.571773 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_fct_trips_passenger_count.b1370cab1c"
[0m17:57:33.577537 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:57:33.580660 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_fct_trips_passenger_count.b1370cab1c: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_fct_trips_passenger_count.b1370cab1c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select passenger_count
from `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips`
where passenger_count is null



      
    ) dbt_internal_test
[0m17:57:34.352286 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:a9f36d3a-742e-4101-a960-e18a8d0dd3c6&page=queryresults
[0m17:57:35.489188 [info ] [Thread-1  ]: 17 of 28 PASS not_null_fct_trips_passenger_count ............................... [[32mPASS[0m in 1.94s]
[0m17:57:35.491466 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_passenger_count.b1370cab1c
[0m17:57:35.495129 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_payment_type.93889b679a
[0m17:57:35.496259 [info ] [Thread-1  ]: 18 of 28 START test not_null_fct_trips_payment_type ............................ [RUN]
[0m17:57:35.497614 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_passenger_count.b1370cab1c, now test.nyc_taxi.not_null_fct_trips_payment_type.93889b679a)
[0m17:57:35.498809 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_payment_type.93889b679a
[0m17:57:35.506214 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_payment_type.93889b679a"
[0m17:57:35.511970 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_payment_type.93889b679a
[0m17:57:35.517263 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_fct_trips_payment_type.93889b679a"
[0m17:57:35.523916 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:57:35.527383 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_fct_trips_payment_type.93889b679a: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_fct_trips_payment_type.93889b679a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select payment_type
from `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips`
where payment_type is null



      
    ) dbt_internal_test
[0m17:57:36.254532 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:91af58ef-d72f-4694-b8b4-6966511f5305&page=queryresults
[0m17:57:35.542391 [info ] [Thread-1  ]: 18 of 28 PASS not_null_fct_trips_payment_type .................................. [[32mPASS[0m in 0.04s]
[0m17:57:35.544502 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_payment_type.93889b679a
[0m17:57:35.545998 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_pickup_time.693af2bf31
[0m17:57:35.547131 [info ] [Thread-1  ]: 19 of 28 START test not_null_fct_trips_pickup_time ............................. [RUN]
[0m17:57:35.548503 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_payment_type.93889b679a, now test.nyc_taxi.not_null_fct_trips_pickup_time.693af2bf31)
[0m17:57:35.549642 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_pickup_time.693af2bf31
[0m17:57:35.556947 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_pickup_time.693af2bf31"
[0m17:57:35.562660 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_pickup_time.693af2bf31
[0m17:57:35.567909 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_fct_trips_pickup_time.693af2bf31"
[0m17:57:35.573477 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:57:35.576968 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_fct_trips_pickup_time.693af2bf31: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_fct_trips_pickup_time.693af2bf31"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select pickup_time
from `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips`
where pickup_time is null



      
    ) dbt_internal_test
[0m17:57:36.335731 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:463a9b59-d319-4011-b50e-951057e3ae41&page=queryresults
[0m17:57:37.438330 [info ] [Thread-1  ]: 19 of 28 PASS not_null_fct_trips_pickup_time ................................... [[32mPASS[0m in 1.89s]
[0m17:57:37.440828 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_pickup_time.693af2bf31
[0m17:57:37.442687 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_pu_location_id.b0dc8dd185
[0m17:57:37.444094 [info ] [Thread-1  ]: 20 of 28 START test not_null_fct_trips_pu_location_id .......................... [RUN]
[0m17:57:37.445652 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_pickup_time.693af2bf31, now test.nyc_taxi.not_null_fct_trips_pu_location_id.b0dc8dd185)
[0m17:57:37.446969 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_pu_location_id.b0dc8dd185
[0m17:57:37.457111 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_pu_location_id.b0dc8dd185"
[0m17:57:37.463121 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_pu_location_id.b0dc8dd185
[0m17:57:37.467968 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_fct_trips_pu_location_id.b0dc8dd185"
[0m17:57:37.473903 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:57:37.477647 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_fct_trips_pu_location_id.b0dc8dd185: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_fct_trips_pu_location_id.b0dc8dd185"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select pu_location_id
from `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips`
where pu_location_id is null



      
    ) dbt_internal_test
[0m17:57:38.181725 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:e40b219c-0768-4006-ae3a-6e99375b91e3&page=queryresults
[0m17:57:39.268232 [info ] [Thread-1  ]: 20 of 28 PASS not_null_fct_trips_pu_location_id ................................ [[32mPASS[0m in 1.82s]
[0m17:57:39.270255 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_pu_location_id.b0dc8dd185
[0m17:57:39.271601 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_rate_code_id.ba0047eaae
[0m17:57:39.272825 [info ] [Thread-1  ]: 21 of 28 START test not_null_fct_trips_rate_code_id ............................ [RUN]
[0m17:57:39.274097 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_pu_location_id.b0dc8dd185, now test.nyc_taxi.not_null_fct_trips_rate_code_id.ba0047eaae)
[0m17:57:39.275116 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_rate_code_id.ba0047eaae
[0m17:57:39.283470 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_rate_code_id.ba0047eaae"
[0m17:57:39.289971 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_rate_code_id.ba0047eaae
[0m17:57:39.294898 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_fct_trips_rate_code_id.ba0047eaae"
[0m17:57:39.301445 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:57:39.305525 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_fct_trips_rate_code_id.ba0047eaae: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_fct_trips_rate_code_id.ba0047eaae"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select rate_code_id
from `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips`
where rate_code_id is null



      
    ) dbt_internal_test
[0m17:57:40.008752 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:7bbda0aa-1c3a-47f6-aab1-96814b8d76f2&page=queryresults
[0m17:57:41.094382 [info ] [Thread-1  ]: 21 of 28 PASS not_null_fct_trips_rate_code_id .................................. [[32mPASS[0m in 1.82s]
[0m17:57:41.096534 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_rate_code_id.ba0047eaae
[0m17:57:41.098169 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_trip_distance.19cd17f1df
[0m17:57:41.099372 [info ] [Thread-1  ]: 22 of 28 START test not_null_fct_trips_trip_distance ........................... [RUN]
[0m17:57:41.100627 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_rate_code_id.ba0047eaae, now test.nyc_taxi.not_null_fct_trips_trip_distance.19cd17f1df)
[0m17:57:41.101706 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_trip_distance.19cd17f1df
[0m17:57:41.109415 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_trip_distance.19cd17f1df"
[0m17:57:41.115925 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_trip_distance.19cd17f1df
[0m17:57:41.120840 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_fct_trips_trip_distance.19cd17f1df"
[0m17:57:41.127913 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:57:41.131594 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_fct_trips_trip_distance.19cd17f1df: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_fct_trips_trip_distance.19cd17f1df"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select trip_distance
from `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips`
where trip_distance is null



      
    ) dbt_internal_test
[0m17:57:41.874601 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:b8a17063-56ec-4b8e-9fdd-c1e33f107d56&page=queryresults
[0m17:57:42.993716 [info ] [Thread-1  ]: 22 of 28 PASS not_null_fct_trips_trip_distance ................................. [[32mPASS[0m in 1.89s]
[0m17:57:42.995977 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_trip_distance.19cd17f1df
[0m17:57:43.000139 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_vendor_id.b9b2f380bb
[0m17:57:43.001387 [info ] [Thread-1  ]: 23 of 28 START test not_null_fct_trips_vendor_id ............................... [RUN]
[0m17:57:43.003142 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_trip_distance.19cd17f1df, now test.nyc_taxi.not_null_fct_trips_vendor_id.b9b2f380bb)
[0m17:57:43.004853 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_vendor_id.b9b2f380bb
[0m17:57:43.012069 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_vendor_id.b9b2f380bb"
[0m17:57:43.017647 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_vendor_id.b9b2f380bb
[0m17:57:43.022409 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_fct_trips_vendor_id.b9b2f380bb"
[0m17:57:43.029600 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:57:43.032903 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_fct_trips_vendor_id.b9b2f380bb: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_fct_trips_vendor_id.b9b2f380bb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select vendor_id
from `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips`
where vendor_id is null



      
    ) dbt_internal_test
[0m17:57:43.796307 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:04d3ccfc-4c78-4b78-9fc9-b8e3c910025f&page=queryresults
[0m17:57:44.879565 [info ] [Thread-1  ]: 23 of 28 PASS not_null_fct_trips_vendor_id ..................................... [[32mPASS[0m in 1.88s]
[0m17:57:44.882064 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_vendor_id.b9b2f380bb
[0m17:57:44.883862 [debug] [Thread-1  ]: Began running node test.nyc_taxi.unique_dim_payment_type_id.dea55de04e
[0m17:57:44.885219 [info ] [Thread-1  ]: 24 of 28 START test unique_dim_payment_type_id ................................. [RUN]
[0m17:57:44.886740 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_vendor_id.b9b2f380bb, now test.nyc_taxi.unique_dim_payment_type_id.dea55de04e)
[0m17:57:44.888202 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.unique_dim_payment_type_id.dea55de04e
[0m17:57:44.899096 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.unique_dim_payment_type_id.dea55de04e"
[0m17:57:44.905873 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.unique_dim_payment_type_id.dea55de04e
[0m17:57:44.910966 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.unique_dim_payment_type_id.dea55de04e"
[0m17:57:44.916642 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:57:44.920939 [debug] [Thread-1  ]: On test.nyc_taxi.unique_dim_payment_type_id.dea55de04e: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.unique_dim_payment_type_id.dea55de04e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select type_id as unique_field
  from `northern-shield-437204-m0`.`nyc_taxi`.`dim_payment`
  where type_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m17:57:45.752789 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:dae8adc8-6cbc-4961-b798-0355b9a7979e&page=queryresults
[0m17:57:46.868829 [info ] [Thread-1  ]: 24 of 28 PASS unique_dim_payment_type_id ....................................... [[32mPASS[0m in 1.98s]
[0m17:57:46.871173 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.unique_dim_payment_type_id.dea55de04e
[0m17:57:46.873602 [debug] [Thread-1  ]: Began running node test.nyc_taxi.unique_dim_ratecode_rate_id.75ae8e4885
[0m17:57:46.875155 [info ] [Thread-1  ]: 25 of 28 START test unique_dim_ratecode_rate_id ................................ [RUN]
[0m17:57:46.876830 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.unique_dim_payment_type_id.dea55de04e, now test.nyc_taxi.unique_dim_ratecode_rate_id.75ae8e4885)
[0m17:57:46.878125 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.unique_dim_ratecode_rate_id.75ae8e4885
[0m17:57:46.887789 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.unique_dim_ratecode_rate_id.75ae8e4885"
[0m17:57:46.893598 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.unique_dim_ratecode_rate_id.75ae8e4885
[0m17:57:46.898501 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.unique_dim_ratecode_rate_id.75ae8e4885"
[0m17:57:46.904465 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:57:46.908365 [debug] [Thread-1  ]: On test.nyc_taxi.unique_dim_ratecode_rate_id.75ae8e4885: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.unique_dim_ratecode_rate_id.75ae8e4885"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select rate_id as unique_field
  from `northern-shield-437204-m0`.`nyc_taxi`.`dim_ratecode`
  where rate_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m17:57:47.634431 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:8b8f1ea7-5bcb-484c-838d-48a03b2a0fb3&page=queryresults
[0m17:57:48.761801 [info ] [Thread-1  ]: 25 of 28 PASS unique_dim_ratecode_rate_id ...................................... [[32mPASS[0m in 1.88s]
[0m17:57:48.764331 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.unique_dim_ratecode_rate_id.75ae8e4885
[0m17:57:48.765828 [debug] [Thread-1  ]: Began running node test.nyc_taxi.unique_dim_vendor_id.03fad38d04
[0m17:57:48.767155 [info ] [Thread-1  ]: 26 of 28 START test unique_dim_vendor_id ....................................... [RUN]
[0m17:57:48.768660 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.unique_dim_ratecode_rate_id.75ae8e4885, now test.nyc_taxi.unique_dim_vendor_id.03fad38d04)
[0m17:57:48.770078 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.unique_dim_vendor_id.03fad38d04
[0m17:57:48.778559 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.unique_dim_vendor_id.03fad38d04"
[0m17:57:48.784411 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.unique_dim_vendor_id.03fad38d04
[0m17:57:48.789496 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.unique_dim_vendor_id.03fad38d04"
[0m17:57:48.795069 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:57:48.798470 [debug] [Thread-1  ]: On test.nyc_taxi.unique_dim_vendor_id.03fad38d04: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.unique_dim_vendor_id.03fad38d04"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select id as unique_field
  from `northern-shield-437204-m0`.`nyc_taxi`.`dim_vendor`
  where id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m17:57:49.594627 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:100fc21f-f269-41a3-ac58-3bc4ca70fa20&page=queryresults
[0m17:57:50.725294 [info ] [Thread-1  ]: 26 of 28 PASS unique_dim_vendor_id ............................................. [[32mPASS[0m in 1.96s]
[0m17:57:50.727868 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.unique_dim_vendor_id.03fad38d04
[0m17:57:50.729555 [debug] [Thread-1  ]: Began running node test.nyc_taxi.unique_dim_zone_location_id.7702f92424
[0m17:57:50.731006 [info ] [Thread-1  ]: 27 of 28 START test unique_dim_zone_location_id ................................ [RUN]
[0m17:57:50.732458 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.unique_dim_vendor_id.03fad38d04, now test.nyc_taxi.unique_dim_zone_location_id.7702f92424)
[0m17:57:50.733818 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.unique_dim_zone_location_id.7702f92424
[0m17:57:50.741959 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.unique_dim_zone_location_id.7702f92424"
[0m17:57:50.748168 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.unique_dim_zone_location_id.7702f92424
[0m17:57:50.752759 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.unique_dim_zone_location_id.7702f92424"
[0m17:57:50.758798 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:57:50.762987 [debug] [Thread-1  ]: On test.nyc_taxi.unique_dim_zone_location_id.7702f92424: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.unique_dim_zone_location_id.7702f92424"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select location_id as unique_field
  from `northern-shield-437204-m0`.`nyc_taxi`.`dim_zone`
  where location_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m17:57:51.491061 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:cd91992b-ac9c-40c0-9676-6c03437c007d&page=queryresults
[0m17:57:52.581644 [info ] [Thread-1  ]: 27 of 28 PASS unique_dim_zone_location_id ...................................... [[32mPASS[0m in 1.85s]
[0m17:57:52.584029 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.unique_dim_zone_location_id.7702f92424
[0m17:57:52.585577 [debug] [Thread-1  ]: Began running node test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab
[0m17:57:52.586853 [info ] [Thread-1  ]: 28 of 28 START test unique_fct_trips_trip_id ................................... [RUN]
[0m17:57:52.588417 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.unique_dim_zone_location_id.7702f92424, now test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab)
[0m17:57:52.589618 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab
[0m17:57:52.599940 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab"
[0m17:57:52.605631 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab
[0m17:57:52.610170 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab"
[0m17:57:52.615953 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:57:52.619340 [debug] [Thread-1  ]: On test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select trip_id as unique_field
  from `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips`
  where trip_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m17:57:53.360063 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:5a037a46-8d16-4c6c-808e-3589e70c5bdf&page=queryresults
[0m17:57:54.452495 [info ] [Thread-1  ]: 28 of 28 PASS unique_fct_trips_trip_id ......................................... [[32mPASS[0m in 1.86s]
[0m17:57:54.454555 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab
[0m17:57:54.457119 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:57:54.458195 [debug] [MainThread]: Connection 'test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab' was properly closed.
[0m17:57:54.459312 [info ] [MainThread]: 
[0m17:57:54.460483 [info ] [MainThread]: Finished running 28 data tests in 0 hours 0 minutes and 43.63 seconds (43.63s).
[0m17:57:54.470672 [debug] [MainThread]: Command end result
[0m17:57:54.551585 [info ] [MainThread]: 
[0m17:57:54.553118 [info ] [MainThread]: [31mCompleted with 5 errors and 0 warnings:[0m
[0m17:57:54.554269 [info ] [MainThread]: 
[0m17:57:54.555512 [error] [MainThread]:   Compilation Error in test conditional_values_fct_trips_fare_amount__test_fare_amount_positive (models/tests/schema.yml)
  'test_conditional_values' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m17:57:54.556595 [info ] [MainThread]: 
[0m17:57:54.557954 [error] [MainThread]:   Compilation Error in test conditional_values_fct_trips_mta_tax__test_mta_tax_positive (models/tests/schema.yml)
  'test_conditional_values' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m17:57:54.559180 [info ] [MainThread]: 
[0m17:57:54.560494 [error] [MainThread]:   Compilation Error in test conditional_values_fct_trips_tip_amount__test_tip_amount_positive (models/tests/schema.yml)
  'test_conditional_values' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m17:57:54.561561 [info ] [MainThread]: 
[0m17:57:54.562727 [error] [MainThread]:   Compilation Error in test conditional_values_fct_trips_tolls_amount__test_tolls_amount_positive (models/tests/schema.yml)
  'test_conditional_values' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m17:57:54.563701 [info ] [MainThread]: 
[0m17:57:54.564718 [error] [MainThread]:   Compilation Error in test conditional_values_fct_trips_total_amount__test_total_amount_positive (models/tests/schema.yml)
  'test_conditional_values' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m17:57:54.565729 [info ] [MainThread]: 
[0m17:57:54.566841 [info ] [MainThread]: Done. PASS=23 WARN=0 ERROR=5 SKIP=0 TOTAL=28
[0m17:57:54.568911 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 48.76619, "process_in_blocks": "0", "process_kernel_time": 0.420001, "process_mem_max_rss": "244808", "process_out_blocks": "0", "process_user_time": 6.94403}
[0m17:57:54.570501 [debug] [MainThread]: Command `dbt test` failed at 17:57:54.570277 after 48.77 seconds
[0m17:57:54.571653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a0404bc40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f49caa59040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a02591af0>]}
[0m17:57:54.572622 [debug] [MainThread]: Flushing usage events
[0m17:58:06.537254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2352e31c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2350cca250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2351f7a6a0>]}


============================== 17:58:06.545039 | 73dace3e-be33-42e8-b30b-1a8ae0bb675d ==============================
[0m17:58:06.545039 [info ] [MainThread]: Running with dbt=1.8.9
[0m17:58:06.546517 [debug] [MainThread]: running dbt with arguments {'log_path': '/opt/airflow/include/dbt/logs', 'fail_fast': 'False', 'target_path': 'None', 'log_cache_events': 'False', 'printer_width': '80', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'write_json': 'True', 'use_colors': 'True', 'partial_parse': 'True', 'profiles_dir': '/opt/airflow/include/dbt', 'indirect_selection': 'eager', 'static_parser': 'True', 'cache_selected_only': 'False', 'introspect': 'True', 'use_experimental_parser': 'False', 'debug': 'False', 'warn_error': 'None', 'empty': 'None', 'send_anonymous_usage_stats': 'True', 'invocation_command': 'dbt deps', 'version_check': 'True', 'quiet': 'False', 'log_format': 'default', 'no_print': 'None'}
[0m17:58:06.672760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '73dace3e-be33-42e8-b30b-1a8ae0bb675d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2350c46a30>]}
[0m17:58:06.901339 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-h61f8nor'
[0m17:58:06.902452 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m17:58:07.371925 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m17:58:07.373605 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m17:58:07.450325 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m17:58:07.458006 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m17:58:09.330436 [info ] [MainThread]: Installed from version 1.3.0
[0m17:58:09.331856 [info ] [MainThread]: Up to date!
[0m17:58:09.333066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '73dace3e-be33-42e8-b30b-1a8ae0bb675d', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2350ca6370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2350c546d0>]}
[0m17:58:09.335215 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 2.8706663, "process_in_blocks": "0", "process_kernel_time": 0.197772, "process_mem_max_rss": "95564", "process_out_blocks": "176", "process_user_time": 2.203753}
[0m17:58:09.336520 [debug] [MainThread]: Command `dbt deps` succeeded at 17:58:09.336343 after 2.87 seconds
[0m17:58:09.337463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2352e31c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2350bd0220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2350ca6370>]}
[0m17:58:09.338304 [debug] [MainThread]: Flushing usage events
[0m18:00:37.929067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74c1ebbc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74c1121550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74c21f6580>]}


============================== 18:00:37.937273 | 4f45ba07-a208-48a5-abb7-e0075a1fcdb1 ==============================
[0m18:00:37.937273 [info ] [MainThread]: Running with dbt=1.8.9
[0m18:00:37.938757 [debug] [MainThread]: running dbt with arguments {'use_experimental_parser': 'False', 'empty': 'None', 'use_colors': 'True', 'partial_parse': 'True', 'quiet': 'False', 'introspect': 'True', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'printer_width': '80', 'profiles_dir': '/opt/airflow/include/dbt/', 'cache_selected_only': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/include/dbt/logs', 'invocation_command': 'dbt test --profiles-dir /opt/airflow/include/dbt/', 'indirect_selection': 'eager', 'version_check': 'True', 'warn_error': 'None', 'log_format': 'default', 'target_path': 'None', 'no_print': 'None', 'debug': 'False', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])'}
[0m18:00:39.133803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4f45ba07-a208-48a5-abb7-e0075a1fcdb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7489934cd0>]}
[0m18:00:39.200217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4f45ba07-a208-48a5-abb7-e0075a1fcdb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74887ed280>]}
[0m18:00:39.202118 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m18:00:39.374759 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m18:00:40.125977 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:00:40.128022 [debug] [MainThread]: Partial parsing: updated file: nyc_taxi://models/tests/schema.yml
[0m18:00:40.550986 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m18:00:40.552826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '4f45ba07-a208-48a5-abb7-e0075a1fcdb1', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74baf90af0>]}
[0m18:00:40.797492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4f45ba07-a208-48a5-abb7-e0075a1fcdb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74bad69130>]}
[0m18:00:40.981595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4f45ba07-a208-48a5-abb7-e0075a1fcdb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74bad650a0>]}
[0m18:00:40.983125 [info ] [MainThread]: Found 10 models, 23 data tests, 2 sources, 600 macros
[0m18:00:40.984456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4f45ba07-a208-48a5-abb7-e0075a1fcdb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74bae6e580>]}
[0m18:00:40.988904 [info ] [MainThread]: 
[0m18:00:40.990479 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:00:40.997708 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_northern-shield-437204-m0_nyc_taxi'
[0m18:00:40.998822 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:00:41.608727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4f45ba07-a208-48a5-abb7-e0075a1fcdb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74c1ea5220>]}
[0m18:00:41.610281 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:00:41.611413 [info ] [MainThread]: 
[0m18:00:41.619549 [debug] [Thread-1  ]: Began running node test.nyc_taxi.accepted_values_dim_payment_payment_name__Credit_card__Cash__No_charge__Dispute__Unknown__Voided_trip.58d00ef9f4
[0m18:00:41.627352 [info ] [Thread-1  ]: 1 of 23 START test accepted_values_dim_payment_payment_name__Credit_card__Cash__No_charge__Dispute__Unknown__Voided_trip  [RUN]
[0m18:00:41.628951 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_northern-shield-437204-m0_nyc_taxi, now test.nyc_taxi.accepted_values_dim_payment_payment_name__Credit_card__Cash__No_charge__Dispute__Unknown__Voided_trip.58d00ef9f4)
[0m18:00:41.630035 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.accepted_values_dim_payment_payment_name__Credit_card__Cash__No_charge__Dispute__Unknown__Voided_trip.58d00ef9f4
[0m18:00:41.654680 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.accepted_values_dim_payment_payment_name__Credit_card__Cash__No_charge__Dispute__Unknown__Voided_trip.58d00ef9f4"
[0m18:00:41.661763 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.accepted_values_dim_payment_payment_name__Credit_card__Cash__No_charge__Dispute__Unknown__Voided_trip.58d00ef9f4
[0m18:00:41.689669 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.accepted_values_dim_payment_payment_name__Credit_card__Cash__No_charge__Dispute__Unknown__Voided_trip.58d00ef9f4"
[0m18:00:41.696786 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:00:41.700018 [debug] [Thread-1  ]: On test.nyc_taxi.accepted_values_dim_payment_payment_name__Credit_card__Cash__No_charge__Dispute__Unknown__Voided_trip.58d00ef9f4: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.accepted_values_dim_payment_payment_name__Credit_card__Cash__No_charge__Dispute__Unknown__Voided_trip.58d00ef9f4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        payment_name as value_field,
        count(*) as n_records

    from `northern-shield-437204-m0`.`nyc_taxi`.`dim_payment`
    group by payment_name

)

select *
from all_values
where value_field not in (
    'Credit card','Cash','No charge','Dispute','Unknown','Voided trip'
)



      
    ) dbt_internal_test
[0m18:00:42.432329 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:e715f7b7-48b4-441f-b4d3-64f48a5f2843&page=queryresults
[0m18:00:43.579670 [info ] [Thread-1  ]: 1 of 23 PASS accepted_values_dim_payment_payment_name__Credit_card__Cash__No_charge__Dispute__Unknown__Voided_trip  [[32mPASS[0m in 1.95s]
[0m18:00:43.582259 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.accepted_values_dim_payment_payment_name__Credit_card__Cash__No_charge__Dispute__Unknown__Voided_trip.58d00ef9f4
[0m18:00:43.583902 [debug] [Thread-1  ]: Began running node test.nyc_taxi.accepted_values_dim_ratecode_rate_code_name__Standard_rate__JFK__Newark__Nassau_or_Westchester__Negotiated_fare__Group_ride__Unknown.57ee02019f
[0m18:00:43.585264 [info ] [Thread-1  ]: 2 of 23 START test accepted_values_dim_ratecode_rate_code_name__Standard_rate__JFK__Newark__Nassau_or_Westchester__Negotiated_fare__Group_ride__Unknown  [RUN]
[0m18:00:43.586736 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.accepted_values_dim_payment_payment_name__Credit_card__Cash__No_charge__Dispute__Unknown__Voided_trip.58d00ef9f4, now test.nyc_taxi.accepted_values_dim_ratecode_rate_code_name__Standard_rate__JFK__Newark__Nassau_or_Westchester__Negotiated_fare__Group_ride__Unknown.57ee02019f)
[0m18:00:43.588008 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.accepted_values_dim_ratecode_rate_code_name__Standard_rate__JFK__Newark__Nassau_or_Westchester__Negotiated_fare__Group_ride__Unknown.57ee02019f
[0m18:00:43.599520 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.accepted_values_dim_ratecode_rate_code_name__Standard_rate__JFK__Newark__Nassau_or_Westchester__Negotiated_fare__Group_ride__Unknown.57ee02019f"
[0m18:00:43.605374 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.accepted_values_dim_ratecode_rate_code_name__Standard_rate__JFK__Newark__Nassau_or_Westchester__Negotiated_fare__Group_ride__Unknown.57ee02019f
[0m18:00:43.611690 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.accepted_values_dim_ratecode_rate_code_name__Standard_rate__JFK__Newark__Nassau_or_Westchester__Negotiated_fare__Group_ride__Unknown.57ee02019f"
[0m18:00:43.618579 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:00:43.622452 [debug] [Thread-1  ]: On test.nyc_taxi.accepted_values_dim_ratecode_rate_code_name__Standard_rate__JFK__Newark__Nassau_or_Westchester__Negotiated_fare__Group_ride__Unknown.57ee02019f: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.accepted_values_dim_ratecode_rate_code_name__Standard_rate__JFK__Newark__Nassau_or_Westchester__Negotiated_fare__Group_ride__Unknown.57ee02019f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        rate_code_name as value_field,
        count(*) as n_records

    from `northern-shield-437204-m0`.`nyc_taxi`.`dim_ratecode`
    group by rate_code_name

)

select *
from all_values
where value_field not in (
    'Standard rate','JFK','Newark','Nassau or Westchester','Negotiated fare','Group ride','Unknown'
)



      
    ) dbt_internal_test
[0m18:00:44.383849 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:7a6de60b-f616-4a7a-ba82-7e2c985e1c32&page=queryresults
[0m18:00:45.482315 [info ] [Thread-1  ]: 2 of 23 PASS accepted_values_dim_ratecode_rate_code_name__Standard_rate__JFK__Newark__Nassau_or_Westchester__Negotiated_fare__Group_ride__Unknown  [[32mPASS[0m in 1.90s]
[0m18:00:45.485555 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.accepted_values_dim_ratecode_rate_code_name__Standard_rate__JFK__Newark__Nassau_or_Westchester__Negotiated_fare__Group_ride__Unknown.57ee02019f
[0m18:00:45.487222 [debug] [Thread-1  ]: Began running node test.nyc_taxi.accepted_values_dim_vendor_vendor_name__Creative_Mobile_Technologies__VeriFone_Inc_.7481cecf07
[0m18:00:45.488648 [info ] [Thread-1  ]: 3 of 23 START test accepted_values_dim_vendor_vendor_name__Creative_Mobile_Technologies__VeriFone_Inc_  [RUN]
[0m18:00:45.490209 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.accepted_values_dim_ratecode_rate_code_name__Standard_rate__JFK__Newark__Nassau_or_Westchester__Negotiated_fare__Group_ride__Unknown.57ee02019f, now test.nyc_taxi.accepted_values_dim_vendor_vendor_name__Creative_Mobile_Technologies__VeriFone_Inc_.7481cecf07)
[0m18:00:45.491608 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.accepted_values_dim_vendor_vendor_name__Creative_Mobile_Technologies__VeriFone_Inc_.7481cecf07
[0m18:00:45.501634 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.accepted_values_dim_vendor_vendor_name__Creative_Mobile_Technologies__VeriFone_Inc_.7481cecf07"
[0m18:00:45.507933 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.accepted_values_dim_vendor_vendor_name__Creative_Mobile_Technologies__VeriFone_Inc_.7481cecf07
[0m18:00:45.512370 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.accepted_values_dim_vendor_vendor_name__Creative_Mobile_Technologies__VeriFone_Inc_.7481cecf07"
[0m18:00:45.518451 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:00:45.522039 [debug] [Thread-1  ]: On test.nyc_taxi.accepted_values_dim_vendor_vendor_name__Creative_Mobile_Technologies__VeriFone_Inc_.7481cecf07: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.accepted_values_dim_vendor_vendor_name__Creative_Mobile_Technologies__VeriFone_Inc_.7481cecf07"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        vendor_name as value_field,
        count(*) as n_records

    from `northern-shield-437204-m0`.`nyc_taxi`.`dim_vendor`
    group by vendor_name

)

select *
from all_values
where value_field not in (
    'Creative Mobile Technologies','VeriFone Inc.'
)



      
    ) dbt_internal_test
[0m18:00:46.253141 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:afca7bc2-41f1-422f-a2ee-73d95a71a2e7&page=queryresults
[0m18:00:47.399840 [info ] [Thread-1  ]: 3 of 23 PASS accepted_values_dim_vendor_vendor_name__Creative_Mobile_Technologies__VeriFone_Inc_  [[32mPASS[0m in 1.91s]
[0m18:00:47.402399 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.accepted_values_dim_vendor_vendor_name__Creative_Mobile_Technologies__VeriFone_Inc_.7481cecf07
[0m18:00:47.403986 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_dim_payment_type_id.96dfa722aa
[0m18:00:47.405325 [info ] [Thread-1  ]: 4 of 23 START test not_null_dim_payment_type_id ................................ [RUN]
[0m18:00:47.406978 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.accepted_values_dim_vendor_vendor_name__Creative_Mobile_Technologies__VeriFone_Inc_.7481cecf07, now test.nyc_taxi.not_null_dim_payment_type_id.96dfa722aa)
[0m18:00:47.408352 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_dim_payment_type_id.96dfa722aa
[0m18:00:47.419307 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_dim_payment_type_id.96dfa722aa"
[0m18:00:47.425781 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_dim_payment_type_id.96dfa722aa
[0m18:00:47.434789 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_dim_payment_type_id.96dfa722aa"
[0m18:00:47.440424 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:00:47.444286 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_dim_payment_type_id.96dfa722aa: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_dim_payment_type_id.96dfa722aa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select type_id
from `northern-shield-437204-m0`.`nyc_taxi`.`dim_payment`
where type_id is null



      
    ) dbt_internal_test
[0m18:00:48.200085 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:51fb9bc3-3a96-4cd4-9823-26f41ed9741b&page=queryresults
[0m18:00:49.298152 [info ] [Thread-1  ]: 4 of 23 PASS not_null_dim_payment_type_id ...................................... [[32mPASS[0m in 1.89s]
[0m18:00:49.300147 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_dim_payment_type_id.96dfa722aa
[0m18:00:49.301688 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_dim_zone_borough.1ed2272c52
[0m18:00:49.302803 [info ] [Thread-1  ]: 5 of 23 START test not_null_dim_zone_borough ................................... [RUN]
[0m18:00:49.304151 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_dim_payment_type_id.96dfa722aa, now test.nyc_taxi.not_null_dim_zone_borough.1ed2272c52)
[0m18:00:49.305264 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_dim_zone_borough.1ed2272c52
[0m18:00:49.314652 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_dim_zone_borough.1ed2272c52"
[0m18:00:49.321430 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_dim_zone_borough.1ed2272c52
[0m18:00:49.326794 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_dim_zone_borough.1ed2272c52"
[0m18:00:49.333104 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:00:49.336778 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_dim_zone_borough.1ed2272c52: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_dim_zone_borough.1ed2272c52"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select borough
from `northern-shield-437204-m0`.`nyc_taxi`.`dim_zone`
where borough is null



      
    ) dbt_internal_test
[0m18:00:50.043424 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:bba4b62f-86d3-4376-8dbe-81d761a5d073&page=queryresults
[0m18:00:51.139680 [info ] [Thread-1  ]: 5 of 23 PASS not_null_dim_zone_borough ......................................... [[32mPASS[0m in 1.84s]
[0m18:00:51.142319 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_dim_zone_borough.1ed2272c52
[0m18:00:51.143979 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_dim_zone_service_zone.2007f611c5
[0m18:00:51.145278 [info ] [Thread-1  ]: 6 of 23 START test not_null_dim_zone_service_zone .............................. [RUN]
[0m18:00:51.146888 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_dim_zone_borough.1ed2272c52, now test.nyc_taxi.not_null_dim_zone_service_zone.2007f611c5)
[0m18:00:51.148257 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_dim_zone_service_zone.2007f611c5
[0m18:00:51.157855 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_dim_zone_service_zone.2007f611c5"
[0m18:00:51.164390 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_dim_zone_service_zone.2007f611c5
[0m18:00:51.169418 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_dim_zone_service_zone.2007f611c5"
[0m18:00:51.175390 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:00:51.179015 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_dim_zone_service_zone.2007f611c5: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_dim_zone_service_zone.2007f611c5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select service_zone
from `northern-shield-437204-m0`.`nyc_taxi`.`dim_zone`
where service_zone is null



      
    ) dbt_internal_test
[0m18:00:51.890348 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:f6a46406-38c8-4885-a34d-3ce85c039138&page=queryresults
[0m18:00:53.001300 [info ] [Thread-1  ]: 6 of 23 PASS not_null_dim_zone_service_zone .................................... [[32mPASS[0m in 1.85s]
[0m18:00:53.003584 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_dim_zone_service_zone.2007f611c5
[0m18:00:53.005035 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_dim_zone_zone.a1c4a4c37a
[0m18:00:53.006291 [info ] [Thread-1  ]: 7 of 23 START test not_null_dim_zone_zone ...................................... [RUN]
[0m18:00:53.007812 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_dim_zone_service_zone.2007f611c5, now test.nyc_taxi.not_null_dim_zone_zone.a1c4a4c37a)
[0m18:00:53.009139 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_dim_zone_zone.a1c4a4c37a
[0m18:00:53.017220 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_dim_zone_zone.a1c4a4c37a"
[0m18:00:53.024543 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_dim_zone_zone.a1c4a4c37a
[0m18:00:53.032406 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_dim_zone_zone.a1c4a4c37a"
[0m18:00:53.039639 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:00:53.043705 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_dim_zone_zone.a1c4a4c37a: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_dim_zone_zone.a1c4a4c37a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select zone
from `northern-shield-437204-m0`.`nyc_taxi`.`dim_zone`
where zone is null



      
    ) dbt_internal_test
[0m18:00:53.777188 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:15827a73-ae72-4212-a918-d6a02cbd53dc&page=queryresults
[0m18:00:53.035718 [info ] [Thread-1  ]: 7 of 23 PASS not_null_dim_zone_zone ............................................ [[32mPASS[0m in 0.03s]
[0m18:00:53.037870 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_dim_zone_zone.a1c4a4c37a
[0m18:00:53.039578 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_do_location_id.6acdd302a6
[0m18:00:53.041129 [info ] [Thread-1  ]: 8 of 23 START test not_null_fct_trips_do_location_id ........................... [RUN]
[0m18:00:53.042467 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_dim_zone_zone.a1c4a4c37a, now test.nyc_taxi.not_null_fct_trips_do_location_id.6acdd302a6)
[0m18:00:53.043662 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_do_location_id.6acdd302a6
[0m18:00:53.051941 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_do_location_id.6acdd302a6"
[0m18:00:53.059347 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_do_location_id.6acdd302a6
[0m18:00:53.064714 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_fct_trips_do_location_id.6acdd302a6"
[0m18:00:53.071948 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:00:53.076750 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_fct_trips_do_location_id.6acdd302a6: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_fct_trips_do_location_id.6acdd302a6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select do_location_id
from `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips`
where do_location_id is null



      
    ) dbt_internal_test
[0m18:00:53.816723 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:ef6f90cb-060e-4a97-9f3c-b73fb927ee03&page=queryresults
[0m18:00:54.918276 [info ] [Thread-1  ]: 8 of 23 PASS not_null_fct_trips_do_location_id ................................. [[32mPASS[0m in 1.88s]
[0m18:00:54.920370 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_do_location_id.6acdd302a6
[0m18:00:54.921619 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_dropoff_time.04b71dc609
[0m18:00:54.922841 [info ] [Thread-1  ]: 9 of 23 START test not_null_fct_trips_dropoff_time ............................. [RUN]
[0m18:00:54.924173 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_do_location_id.6acdd302a6, now test.nyc_taxi.not_null_fct_trips_dropoff_time.04b71dc609)
[0m18:00:54.925201 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_dropoff_time.04b71dc609
[0m18:00:54.931984 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_dropoff_time.04b71dc609"
[0m18:00:54.938003 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_dropoff_time.04b71dc609
[0m18:00:54.942907 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_fct_trips_dropoff_time.04b71dc609"
[0m18:00:54.948929 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:00:54.952704 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_fct_trips_dropoff_time.04b71dc609: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_fct_trips_dropoff_time.04b71dc609"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select dropoff_time
from `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips`
where dropoff_time is null



      
    ) dbt_internal_test
[0m18:00:55.720591 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:799c0ce3-26f9-442d-84a3-1ea8bd647eb0&page=queryresults
[0m18:00:56.799005 [info ] [Thread-1  ]: 9 of 23 PASS not_null_fct_trips_dropoff_time ................................... [[32mPASS[0m in 1.87s]
[0m18:00:56.801368 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_dropoff_time.04b71dc609
[0m18:00:56.803274 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_extra.1801055bb3
[0m18:00:56.804643 [info ] [Thread-1  ]: 10 of 23 START test not_null_fct_trips_extra ................................... [RUN]
[0m18:00:56.806155 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_dropoff_time.04b71dc609, now test.nyc_taxi.not_null_fct_trips_extra.1801055bb3)
[0m18:00:56.807384 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_extra.1801055bb3
[0m18:00:56.817506 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_extra.1801055bb3"
[0m18:00:56.823299 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_extra.1801055bb3
[0m18:00:56.827620 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_fct_trips_extra.1801055bb3"
[0m18:00:56.833875 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:00:56.837297 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_fct_trips_extra.1801055bb3: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_fct_trips_extra.1801055bb3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select extra
from `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips`
where extra is null



      
    ) dbt_internal_test
[0m18:00:57.541660 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:97791cf5-e679-4f88-922c-acdb520e3f96&page=queryresults
[0m18:00:58.660756 [info ] [Thread-1  ]: 10 of 23 PASS not_null_fct_trips_extra ......................................... [[32mPASS[0m in 1.85s]
[0m18:00:58.663133 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_extra.1801055bb3
[0m18:00:58.664664 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_improvement_surcharge.4cf28d1443
[0m18:00:58.665973 [info ] [Thread-1  ]: 11 of 23 START test not_null_fct_trips_improvement_surcharge ................... [RUN]
[0m18:00:58.667399 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_extra.1801055bb3, now test.nyc_taxi.not_null_fct_trips_improvement_surcharge.4cf28d1443)
[0m18:00:58.668624 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_improvement_surcharge.4cf28d1443
[0m18:00:58.676896 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_improvement_surcharge.4cf28d1443"
[0m18:00:58.683574 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_improvement_surcharge.4cf28d1443
[0m18:00:58.688321 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_fct_trips_improvement_surcharge.4cf28d1443"
[0m18:00:58.694687 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:00:58.698674 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_fct_trips_improvement_surcharge.4cf28d1443: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_fct_trips_improvement_surcharge.4cf28d1443"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select improvement_surcharge
from `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips`
where improvement_surcharge is null



      
    ) dbt_internal_test
[0m18:00:59.412354 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:a92a4997-2504-4f2b-b8cb-c1f30565cd8a&page=queryresults
[0m18:01:00.480701 [info ] [Thread-1  ]: 11 of 23 PASS not_null_fct_trips_improvement_surcharge ......................... [[32mPASS[0m in 1.81s]
[0m18:01:00.483226 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_improvement_surcharge.4cf28d1443
[0m18:01:00.484851 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_passenger_count.b1370cab1c
[0m18:01:00.486116 [info ] [Thread-1  ]: 12 of 23 START test not_null_fct_trips_passenger_count ......................... [RUN]
[0m18:01:00.487534 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_improvement_surcharge.4cf28d1443, now test.nyc_taxi.not_null_fct_trips_passenger_count.b1370cab1c)
[0m18:01:00.488731 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_passenger_count.b1370cab1c
[0m18:01:00.496384 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_passenger_count.b1370cab1c"
[0m18:01:00.502383 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_passenger_count.b1370cab1c
[0m18:01:00.507472 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_fct_trips_passenger_count.b1370cab1c"
[0m18:01:00.513421 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:01:00.516701 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_fct_trips_passenger_count.b1370cab1c: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_fct_trips_passenger_count.b1370cab1c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select passenger_count
from `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips`
where passenger_count is null



      
    ) dbt_internal_test
[0m18:01:01.268636 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:689f9bf0-e2db-4ff6-a8fe-5dadee28d627&page=queryresults
[0m18:01:02.363016 [info ] [Thread-1  ]: 12 of 23 PASS not_null_fct_trips_passenger_count ............................... [[32mPASS[0m in 1.88s]
[0m18:01:02.365690 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_passenger_count.b1370cab1c
[0m18:01:02.369790 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_payment_type.93889b679a
[0m18:01:02.371145 [info ] [Thread-1  ]: 13 of 23 START test not_null_fct_trips_payment_type ............................ [RUN]
[0m18:01:02.372731 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_passenger_count.b1370cab1c, now test.nyc_taxi.not_null_fct_trips_payment_type.93889b679a)
[0m18:01:02.374256 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_payment_type.93889b679a
[0m18:01:02.382067 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_payment_type.93889b679a"
[0m18:01:02.388959 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_payment_type.93889b679a
[0m18:01:02.394077 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_fct_trips_payment_type.93889b679a"
[0m18:01:02.400714 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:01:02.405218 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_fct_trips_payment_type.93889b679a: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_fct_trips_payment_type.93889b679a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select payment_type
from `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips`
where payment_type is null



      
    ) dbt_internal_test
[0m18:01:03.423594 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:81550400-ae85-4a85-8f5b-e4295671ebe0&page=queryresults
[0m18:01:04.629082 [info ] [Thread-1  ]: 13 of 23 PASS not_null_fct_trips_payment_type .................................. [[32mPASS[0m in 2.26s]
[0m18:01:04.631539 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_payment_type.93889b679a
[0m18:01:04.633293 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_pickup_time.693af2bf31
[0m18:01:04.634635 [info ] [Thread-1  ]: 14 of 23 START test not_null_fct_trips_pickup_time ............................. [RUN]
[0m18:01:04.636304 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_payment_type.93889b679a, now test.nyc_taxi.not_null_fct_trips_pickup_time.693af2bf31)
[0m18:01:04.637655 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_pickup_time.693af2bf31
[0m18:01:04.645477 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_pickup_time.693af2bf31"
[0m18:01:04.651532 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_pickup_time.693af2bf31
[0m18:01:04.655847 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_fct_trips_pickup_time.693af2bf31"
[0m18:01:04.661861 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:01:04.665622 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_fct_trips_pickup_time.693af2bf31: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_fct_trips_pickup_time.693af2bf31"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select pickup_time
from `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips`
where pickup_time is null



      
    ) dbt_internal_test
[0m18:01:05.488493 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:10c44d0b-2183-4863-b75a-343295c2bfb3&page=queryresults
[0m18:01:06.597964 [info ] [Thread-1  ]: 14 of 23 PASS not_null_fct_trips_pickup_time ................................... [[32mPASS[0m in 1.96s]
[0m18:01:06.600479 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_pickup_time.693af2bf31
[0m18:01:06.602227 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_pu_location_id.b0dc8dd185
[0m18:01:06.603540 [info ] [Thread-1  ]: 15 of 23 START test not_null_fct_trips_pu_location_id .......................... [RUN]
[0m18:01:06.605077 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_pickup_time.693af2bf31, now test.nyc_taxi.not_null_fct_trips_pu_location_id.b0dc8dd185)
[0m18:01:06.606507 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_pu_location_id.b0dc8dd185
[0m18:01:06.617520 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_pu_location_id.b0dc8dd185"
[0m18:01:06.623696 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_pu_location_id.b0dc8dd185
[0m18:01:06.628665 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_fct_trips_pu_location_id.b0dc8dd185"
[0m18:01:06.635068 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:01:06.638602 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_fct_trips_pu_location_id.b0dc8dd185: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_fct_trips_pu_location_id.b0dc8dd185"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select pu_location_id
from `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips`
where pu_location_id is null



      
    ) dbt_internal_test
[0m18:01:07.336686 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:df0f58ff-3112-4efc-85a5-327731e0e819&page=queryresults
[0m18:01:08.451302 [info ] [Thread-1  ]: 15 of 23 PASS not_null_fct_trips_pu_location_id ................................ [[32mPASS[0m in 1.85s]
[0m18:01:08.453715 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_pu_location_id.b0dc8dd185
[0m18:01:08.455214 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_rate_code_id.ba0047eaae
[0m18:01:08.456466 [info ] [Thread-1  ]: 16 of 23 START test not_null_fct_trips_rate_code_id ............................ [RUN]
[0m18:01:08.458175 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_pu_location_id.b0dc8dd185, now test.nyc_taxi.not_null_fct_trips_rate_code_id.ba0047eaae)
[0m18:01:08.459605 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_rate_code_id.ba0047eaae
[0m18:01:08.468729 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_rate_code_id.ba0047eaae"
[0m18:01:08.475304 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_rate_code_id.ba0047eaae
[0m18:01:08.479952 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_fct_trips_rate_code_id.ba0047eaae"
[0m18:01:08.485520 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:01:08.488930 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_fct_trips_rate_code_id.ba0047eaae: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_fct_trips_rate_code_id.ba0047eaae"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select rate_code_id
from `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips`
where rate_code_id is null



      
    ) dbt_internal_test
[0m18:01:09.205277 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:5ed42e19-c05c-4b6f-9ecd-80c5999990ac&page=queryresults
[0m18:01:10.429712 [info ] [Thread-1  ]: 16 of 23 PASS not_null_fct_trips_rate_code_id .................................. [[32mPASS[0m in 1.97s]
[0m18:01:10.432054 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_rate_code_id.ba0047eaae
[0m18:01:10.433522 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_trip_distance.19cd17f1df
[0m18:01:10.434750 [info ] [Thread-1  ]: 17 of 23 START test not_null_fct_trips_trip_distance ........................... [RUN]
[0m18:01:10.436014 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_rate_code_id.ba0047eaae, now test.nyc_taxi.not_null_fct_trips_trip_distance.19cd17f1df)
[0m18:01:10.436992 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_trip_distance.19cd17f1df
[0m18:01:10.443687 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_trip_distance.19cd17f1df"
[0m18:01:10.448627 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_trip_distance.19cd17f1df
[0m18:01:10.453809 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_fct_trips_trip_distance.19cd17f1df"
[0m18:01:10.459719 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:01:10.463042 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_fct_trips_trip_distance.19cd17f1df: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_fct_trips_trip_distance.19cd17f1df"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select trip_distance
from `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips`
where trip_distance is null



      
    ) dbt_internal_test
[0m18:01:11.276884 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:c6afacfd-292b-4397-8411-301ed2b88587&page=queryresults
[0m18:01:12.400761 [info ] [Thread-1  ]: 17 of 23 PASS not_null_fct_trips_trip_distance ................................. [[32mPASS[0m in 1.96s]
[0m18:01:12.403056 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_trip_distance.19cd17f1df
[0m18:01:12.407494 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_vendor_id.b9b2f380bb
[0m18:01:12.408750 [info ] [Thread-1  ]: 18 of 23 START test not_null_fct_trips_vendor_id ............................... [RUN]
[0m18:01:12.410075 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_trip_distance.19cd17f1df, now test.nyc_taxi.not_null_fct_trips_vendor_id.b9b2f380bb)
[0m18:01:12.411329 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_vendor_id.b9b2f380bb
[0m18:01:12.419023 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_vendor_id.b9b2f380bb"
[0m18:01:12.424393 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_vendor_id.b9b2f380bb
[0m18:01:12.429523 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_fct_trips_vendor_id.b9b2f380bb"
[0m18:01:12.435810 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:01:12.439075 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_fct_trips_vendor_id.b9b2f380bb: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_fct_trips_vendor_id.b9b2f380bb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select vendor_id
from `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips`
where vendor_id is null



      
    ) dbt_internal_test
[0m18:01:13.172671 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:9f60f9ce-ee88-4bd0-a764-7478cadb8a3f&page=queryresults
[0m18:01:14.281417 [info ] [Thread-1  ]: 18 of 23 PASS not_null_fct_trips_vendor_id ..................................... [[32mPASS[0m in 1.87s]
[0m18:01:14.283968 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_vendor_id.b9b2f380bb
[0m18:01:14.285792 [debug] [Thread-1  ]: Began running node test.nyc_taxi.unique_dim_payment_type_id.dea55de04e
[0m18:01:14.287147 [info ] [Thread-1  ]: 19 of 23 START test unique_dim_payment_type_id ................................. [RUN]
[0m18:01:14.288687 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_vendor_id.b9b2f380bb, now test.nyc_taxi.unique_dim_payment_type_id.dea55de04e)
[0m18:01:14.289967 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.unique_dim_payment_type_id.dea55de04e
[0m18:01:14.300937 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.unique_dim_payment_type_id.dea55de04e"
[0m18:01:14.306571 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.unique_dim_payment_type_id.dea55de04e
[0m18:01:14.311236 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.unique_dim_payment_type_id.dea55de04e"
[0m18:01:14.317257 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:01:14.320618 [debug] [Thread-1  ]: On test.nyc_taxi.unique_dim_payment_type_id.dea55de04e: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.unique_dim_payment_type_id.dea55de04e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select type_id as unique_field
  from `northern-shield-437204-m0`.`nyc_taxi`.`dim_payment`
  where type_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m18:01:15.017073 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:cb9dfdee-9f00-46da-a62d-71becfc47343&page=queryresults
[0m18:01:16.173550 [info ] [Thread-1  ]: 19 of 23 PASS unique_dim_payment_type_id ....................................... [[32mPASS[0m in 1.88s]
[0m18:01:16.176079 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.unique_dim_payment_type_id.dea55de04e
[0m18:01:16.177843 [debug] [Thread-1  ]: Began running node test.nyc_taxi.unique_dim_ratecode_rate_id.75ae8e4885
[0m18:01:16.179219 [info ] [Thread-1  ]: 20 of 23 START test unique_dim_ratecode_rate_id ................................ [RUN]
[0m18:01:16.180868 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.unique_dim_payment_type_id.dea55de04e, now test.nyc_taxi.unique_dim_ratecode_rate_id.75ae8e4885)
[0m18:01:16.182145 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.unique_dim_ratecode_rate_id.75ae8e4885
[0m18:01:16.192375 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.unique_dim_ratecode_rate_id.75ae8e4885"
[0m18:01:16.198232 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.unique_dim_ratecode_rate_id.75ae8e4885
[0m18:01:16.202876 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.unique_dim_ratecode_rate_id.75ae8e4885"
[0m18:01:16.209221 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:01:16.212581 [debug] [Thread-1  ]: On test.nyc_taxi.unique_dim_ratecode_rate_id.75ae8e4885: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.unique_dim_ratecode_rate_id.75ae8e4885"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select rate_id as unique_field
  from `northern-shield-437204-m0`.`nyc_taxi`.`dim_ratecode`
  where rate_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m18:01:16.961309 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:74ff300d-8423-4cde-81df-a38e9114eb82&page=queryresults
[0m18:01:18.062162 [info ] [Thread-1  ]: 20 of 23 PASS unique_dim_ratecode_rate_id ...................................... [[32mPASS[0m in 1.88s]
[0m18:01:18.064651 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.unique_dim_ratecode_rate_id.75ae8e4885
[0m18:01:18.066206 [debug] [Thread-1  ]: Began running node test.nyc_taxi.unique_dim_vendor_id.03fad38d04
[0m18:01:18.067460 [info ] [Thread-1  ]: 21 of 23 START test unique_dim_vendor_id ....................................... [RUN]
[0m18:01:18.068900 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.unique_dim_ratecode_rate_id.75ae8e4885, now test.nyc_taxi.unique_dim_vendor_id.03fad38d04)
[0m18:01:18.070020 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.unique_dim_vendor_id.03fad38d04
[0m18:01:18.077988 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.unique_dim_vendor_id.03fad38d04"
[0m18:01:18.085294 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.unique_dim_vendor_id.03fad38d04
[0m18:01:18.090045 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.unique_dim_vendor_id.03fad38d04"
[0m18:01:18.095516 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:01:18.098588 [debug] [Thread-1  ]: On test.nyc_taxi.unique_dim_vendor_id.03fad38d04: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.unique_dim_vendor_id.03fad38d04"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select id as unique_field
  from `northern-shield-437204-m0`.`nyc_taxi`.`dim_vendor`
  where id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m18:01:18.825447 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:f2d818f8-0b50-4942-86ca-7c884f8c2b73&page=queryresults
[0m18:01:19.929709 [info ] [Thread-1  ]: 21 of 23 PASS unique_dim_vendor_id ............................................. [[32mPASS[0m in 1.86s]
[0m18:01:19.932355 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.unique_dim_vendor_id.03fad38d04
[0m18:01:19.933982 [debug] [Thread-1  ]: Began running node test.nyc_taxi.unique_dim_zone_location_id.7702f92424
[0m18:01:19.935271 [info ] [Thread-1  ]: 22 of 23 START test unique_dim_zone_location_id ................................ [RUN]
[0m18:01:19.936706 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.unique_dim_vendor_id.03fad38d04, now test.nyc_taxi.unique_dim_zone_location_id.7702f92424)
[0m18:01:19.937967 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.unique_dim_zone_location_id.7702f92424
[0m18:01:19.945634 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.unique_dim_zone_location_id.7702f92424"
[0m18:01:19.951303 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.unique_dim_zone_location_id.7702f92424
[0m18:01:19.955996 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.unique_dim_zone_location_id.7702f92424"
[0m18:01:19.962432 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:01:19.965826 [debug] [Thread-1  ]: On test.nyc_taxi.unique_dim_zone_location_id.7702f92424: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.unique_dim_zone_location_id.7702f92424"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select location_id as unique_field
  from `northern-shield-437204-m0`.`nyc_taxi`.`dim_zone`
  where location_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m18:01:20.757440 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:25ea0281-027f-4bb8-ba18-7a5c16f732d7&page=queryresults
[0m18:01:21.835423 [info ] [Thread-1  ]: 22 of 23 PASS unique_dim_zone_location_id ...................................... [[32mPASS[0m in 1.90s]
[0m18:01:21.837581 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.unique_dim_zone_location_id.7702f92424
[0m18:01:21.838966 [debug] [Thread-1  ]: Began running node test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab
[0m18:01:21.840193 [info ] [Thread-1  ]: 23 of 23 START test unique_fct_trips_trip_id ................................... [RUN]
[0m18:01:21.841576 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.unique_dim_zone_location_id.7702f92424, now test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab)
[0m18:01:21.842688 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab
[0m18:01:21.852603 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab"
[0m18:01:21.858658 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab
[0m18:01:21.869599 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab"
[0m18:01:21.875665 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:01:21.880034 [debug] [Thread-1  ]: On test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select trip_id as unique_field
  from `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips`
  where trip_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m18:01:21.942982 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:ac4742fa-cf76-4d09-a0b7-ee3ae95bce5d&page=queryresults
[0m18:01:21.910544 [info ] [Thread-1  ]: 23 of 23 PASS unique_fct_trips_trip_id ......................................... [[32mPASS[0m in 0.07s]
[0m18:01:21.912630 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab
[0m18:01:21.915415 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:01:21.916319 [debug] [MainThread]: Connection 'test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab' was properly closed.
[0m18:01:21.917209 [info ] [MainThread]: 
[0m18:01:21.918422 [info ] [MainThread]: Finished running 23 data tests in 0 hours 0 minutes and 40.93 seconds (40.93s).
[0m18:01:21.927571 [debug] [MainThread]: Command end result
[0m18:01:22.010196 [info ] [MainThread]: 
[0m18:01:22.011972 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:01:22.013223 [info ] [MainThread]: 
[0m18:01:22.014351 [info ] [MainThread]: Done. PASS=23 WARN=0 ERROR=0 SKIP=0 TOTAL=23
[0m18:01:22.016506 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 47.83419, "process_in_blocks": "0", "process_kernel_time": 0.476505, "process_mem_max_rss": "244868", "process_out_blocks": "0", "process_user_time": 6.804503}
[0m18:01:22.018026 [debug] [MainThread]: Command `dbt test` succeeded at 18:01:22.017744 after 47.84 seconds
[0m18:01:22.019187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74c1ebbc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74baa8fc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74baa8f910>]}
[0m18:01:22.020469 [debug] [MainThread]: Flushing usage events
[0m18:03:01.241728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f11c9236c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f11c8397460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f11c704dbe0>]}


============================== 18:03:01.249797 | b6493d15-c56c-40e8-a7a0-85906f1cf285 ==============================
[0m18:03:01.249797 [info ] [MainThread]: Running with dbt=1.8.9
[0m18:03:01.251408 [debug] [MainThread]: running dbt with arguments {'empty': 'None', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'log_format': 'default', 'warn_error': 'None', 'write_json': 'True', 'use_colors': 'True', 'log_path': '/opt/airflow/include/dbt/logs', 'static_parser': 'True', 'indirect_selection': 'eager', 'profiles_dir': '/opt/airflow/include/dbt/', 'printer_width': '80', 'quiet': 'False', 'version_check': 'True', 'cache_selected_only': 'False', 'no_print': 'None', 'invocation_command': 'dbt docs generate --profiles-dir /opt/airflow/include/dbt/', 'target_path': 'None', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'debug': 'False', 'introspect': 'True', 'log_cache_events': 'False'}
[0m18:03:02.488024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b6493d15-c56c-40e8-a7a0-85906f1cf285', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f118fc21430>]}
[0m18:03:02.554888 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b6493d15-c56c-40e8-a7a0-85906f1cf285', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f118fb54940>]}
[0m18:03:02.556724 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m18:03:02.771795 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m18:03:03.676523 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:03:03.678045 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:03:03.752711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b6493d15-c56c-40e8-a7a0-85906f1cf285', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f11c24279a0>]}
[0m18:03:03.778383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b6493d15-c56c-40e8-a7a0-85906f1cf285', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f11c23cba30>]}
[0m18:03:03.780339 [info ] [MainThread]: Found 10 models, 23 data tests, 2 sources, 600 macros
[0m18:03:03.782712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b6493d15-c56c-40e8-a7a0-85906f1cf285', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f11c23cba60>]}
[0m18:03:03.787789 [info ] [MainThread]: 
[0m18:03:03.789801 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:03:03.797585 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_northern-shield-437204-m0_nyc_taxi'
[0m18:03:03.798946 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:03:04.695501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b6493d15-c56c-40e8-a7a0-85906f1cf285', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f11c92212b0>]}
[0m18:03:04.697036 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:03:04.698178 [info ] [MainThread]: 
[0m18:03:04.706762 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_payment
[0m18:03:04.708546 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_northern-shield-437204-m0_nyc_taxi, now model.nyc_taxi.dim_payment)
[0m18:03:04.710075 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_payment
[0m18:03:04.723834 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_payment"
[0m18:03:04.729951 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_payment
[0m18:03:04.732314 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_payment
[0m18:03:04.735861 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_ratecode
[0m18:03:04.737341 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_payment, now model.nyc_taxi.dim_ratecode)
[0m18:03:04.738481 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_ratecode
[0m18:03:04.875882 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_ratecode"
[0m18:03:04.881917 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_ratecode
[0m18:03:04.884019 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_ratecode
[0m18:03:04.885405 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_vendor
[0m18:03:04.886822 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_ratecode, now model.nyc_taxi.dim_vendor)
[0m18:03:04.888002 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_vendor
[0m18:03:04.893061 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_vendor"
[0m18:03:04.897929 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_vendor
[0m18:03:04.899796 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_vendor
[0m18:03:04.901078 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_zone
[0m18:03:04.902576 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_vendor, now model.nyc_taxi.dim_zone)
[0m18:03:04.903687 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_zone
[0m18:03:04.908605 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_zone"
[0m18:03:04.913730 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_zone
[0m18:03:04.915563 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_zone
[0m18:03:04.916806 [debug] [Thread-1  ]: Began running node model.nyc_taxi.fct_trips
[0m18:03:04.918196 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_zone, now model.nyc_taxi.fct_trips)
[0m18:03:04.919488 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.fct_trips
[0m18:03:04.941419 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.fct_trips"
[0m18:03:04.948845 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.fct_trips
[0m18:03:04.950977 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.fct_trips
[0m18:03:04.952423 [debug] [Thread-1  ]: Began running node test.nyc_taxi.accepted_values_dim_payment_payment_name__Credit_card__Cash__No_charge__Dispute__Unknown__Voided_trip.58d00ef9f4
[0m18:03:04.954101 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.fct_trips, now test.nyc_taxi.accepted_values_dim_payment_payment_name__Credit_card__Cash__No_charge__Dispute__Unknown__Voided_trip.58d00ef9f4)
[0m18:03:04.955250 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.accepted_values_dim_payment_payment_name__Credit_card__Cash__No_charge__Dispute__Unknown__Voided_trip.58d00ef9f4
[0m18:03:04.975608 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.accepted_values_dim_payment_payment_name__Credit_card__Cash__No_charge__Dispute__Unknown__Voided_trip.58d00ef9f4"
[0m18:03:04.981519 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.accepted_values_dim_payment_payment_name__Credit_card__Cash__No_charge__Dispute__Unknown__Voided_trip.58d00ef9f4
[0m18:03:04.983341 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.accepted_values_dim_payment_payment_name__Credit_card__Cash__No_charge__Dispute__Unknown__Voided_trip.58d00ef9f4
[0m18:03:04.984513 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_dim_payment_type_id.96dfa722aa
[0m18:03:04.985535 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.accepted_values_dim_payment_payment_name__Credit_card__Cash__No_charge__Dispute__Unknown__Voided_trip.58d00ef9f4, now test.nyc_taxi.not_null_dim_payment_type_id.96dfa722aa)
[0m18:03:04.986497 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_dim_payment_type_id.96dfa722aa
[0m18:03:04.997993 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_dim_payment_type_id.96dfa722aa"
[0m18:03:05.003780 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_dim_payment_type_id.96dfa722aa
[0m18:03:05.005296 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_dim_payment_type_id.96dfa722aa
[0m18:03:05.006391 [debug] [Thread-1  ]: Began running node test.nyc_taxi.unique_dim_payment_type_id.dea55de04e
[0m18:03:05.007407 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_dim_payment_type_id.96dfa722aa, now test.nyc_taxi.unique_dim_payment_type_id.dea55de04e)
[0m18:03:05.008297 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.unique_dim_payment_type_id.dea55de04e
[0m18:03:05.017125 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.unique_dim_payment_type_id.dea55de04e"
[0m18:03:05.022619 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.unique_dim_payment_type_id.dea55de04e
[0m18:03:05.024156 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.unique_dim_payment_type_id.dea55de04e
[0m18:03:05.025455 [debug] [Thread-1  ]: Began running node test.nyc_taxi.accepted_values_dim_ratecode_rate_code_name__Standard_rate__JFK__Newark__Nassau_or_Westchester__Negotiated_fare__Group_ride__Unknown.57ee02019f
[0m18:03:05.026644 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.unique_dim_payment_type_id.dea55de04e, now test.nyc_taxi.accepted_values_dim_ratecode_rate_code_name__Standard_rate__JFK__Newark__Nassau_or_Westchester__Negotiated_fare__Group_ride__Unknown.57ee02019f)
[0m18:03:05.027605 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.accepted_values_dim_ratecode_rate_code_name__Standard_rate__JFK__Newark__Nassau_or_Westchester__Negotiated_fare__Group_ride__Unknown.57ee02019f
[0m18:03:05.038078 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.accepted_values_dim_ratecode_rate_code_name__Standard_rate__JFK__Newark__Nassau_or_Westchester__Negotiated_fare__Group_ride__Unknown.57ee02019f"
[0m18:03:05.043984 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.accepted_values_dim_ratecode_rate_code_name__Standard_rate__JFK__Newark__Nassau_or_Westchester__Negotiated_fare__Group_ride__Unknown.57ee02019f
[0m18:03:05.045530 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.accepted_values_dim_ratecode_rate_code_name__Standard_rate__JFK__Newark__Nassau_or_Westchester__Negotiated_fare__Group_ride__Unknown.57ee02019f
[0m18:03:05.046744 [debug] [Thread-1  ]: Began running node test.nyc_taxi.unique_dim_ratecode_rate_id.75ae8e4885
[0m18:03:05.047999 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.accepted_values_dim_ratecode_rate_code_name__Standard_rate__JFK__Newark__Nassau_or_Westchester__Negotiated_fare__Group_ride__Unknown.57ee02019f, now test.nyc_taxi.unique_dim_ratecode_rate_id.75ae8e4885)
[0m18:03:05.049053 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.unique_dim_ratecode_rate_id.75ae8e4885
[0m18:03:05.055447 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.unique_dim_ratecode_rate_id.75ae8e4885"
[0m18:03:05.060787 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.unique_dim_ratecode_rate_id.75ae8e4885
[0m18:03:05.062434 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.unique_dim_ratecode_rate_id.75ae8e4885
[0m18:03:05.063570 [debug] [Thread-1  ]: Began running node test.nyc_taxi.accepted_values_dim_vendor_vendor_name__Creative_Mobile_Technologies__VeriFone_Inc_.7481cecf07
[0m18:03:05.064587 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.unique_dim_ratecode_rate_id.75ae8e4885, now test.nyc_taxi.accepted_values_dim_vendor_vendor_name__Creative_Mobile_Technologies__VeriFone_Inc_.7481cecf07)
[0m18:03:05.065598 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.accepted_values_dim_vendor_vendor_name__Creative_Mobile_Technologies__VeriFone_Inc_.7481cecf07
[0m18:03:05.073874 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.accepted_values_dim_vendor_vendor_name__Creative_Mobile_Technologies__VeriFone_Inc_.7481cecf07"
[0m18:03:05.079382 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.accepted_values_dim_vendor_vendor_name__Creative_Mobile_Technologies__VeriFone_Inc_.7481cecf07
[0m18:03:05.080977 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.accepted_values_dim_vendor_vendor_name__Creative_Mobile_Technologies__VeriFone_Inc_.7481cecf07
[0m18:03:05.084050 [debug] [Thread-1  ]: Began running node test.nyc_taxi.unique_dim_vendor_id.03fad38d04
[0m18:03:05.085099 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.accepted_values_dim_vendor_vendor_name__Creative_Mobile_Technologies__VeriFone_Inc_.7481cecf07, now test.nyc_taxi.unique_dim_vendor_id.03fad38d04)
[0m18:03:05.086387 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.unique_dim_vendor_id.03fad38d04
[0m18:03:05.092912 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.unique_dim_vendor_id.03fad38d04"
[0m18:03:05.098298 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.unique_dim_vendor_id.03fad38d04
[0m18:03:05.099981 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.unique_dim_vendor_id.03fad38d04
[0m18:03:05.101275 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_dim_zone_borough.1ed2272c52
[0m18:03:05.102504 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.unique_dim_vendor_id.03fad38d04, now test.nyc_taxi.not_null_dim_zone_borough.1ed2272c52)
[0m18:03:05.103746 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_dim_zone_borough.1ed2272c52
[0m18:03:05.110375 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_dim_zone_borough.1ed2272c52"
[0m18:03:05.115688 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_dim_zone_borough.1ed2272c52
[0m18:03:05.117175 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_dim_zone_borough.1ed2272c52
[0m18:03:05.118251 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_dim_zone_service_zone.2007f611c5
[0m18:03:05.119357 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_dim_zone_borough.1ed2272c52, now test.nyc_taxi.not_null_dim_zone_service_zone.2007f611c5)
[0m18:03:05.120309 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_dim_zone_service_zone.2007f611c5
[0m18:03:05.126589 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_dim_zone_service_zone.2007f611c5"
[0m18:03:05.131940 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_dim_zone_service_zone.2007f611c5
[0m18:03:05.133413 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_dim_zone_service_zone.2007f611c5
[0m18:03:05.134726 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_dim_zone_zone.a1c4a4c37a
[0m18:03:05.136017 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_dim_zone_service_zone.2007f611c5, now test.nyc_taxi.not_null_dim_zone_zone.a1c4a4c37a)
[0m18:03:05.137048 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_dim_zone_zone.a1c4a4c37a
[0m18:03:05.143336 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_dim_zone_zone.a1c4a4c37a"
[0m18:03:05.148446 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_dim_zone_zone.a1c4a4c37a
[0m18:03:05.149989 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_dim_zone_zone.a1c4a4c37a
[0m18:03:05.151195 [debug] [Thread-1  ]: Began running node test.nyc_taxi.unique_dim_zone_location_id.7702f92424
[0m18:03:05.152207 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_dim_zone_zone.a1c4a4c37a, now test.nyc_taxi.unique_dim_zone_location_id.7702f92424)
[0m18:03:05.153250 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.unique_dim_zone_location_id.7702f92424
[0m18:03:05.161290 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.unique_dim_zone_location_id.7702f92424"
[0m18:03:05.168066 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.unique_dim_zone_location_id.7702f92424
[0m18:03:05.172006 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.unique_dim_zone_location_id.7702f92424
[0m18:03:05.174042 [debug] [Thread-1  ]: Began running node model.nyc_taxi.test_fare_amount_positive
[0m18:03:05.175428 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.unique_dim_zone_location_id.7702f92424, now model.nyc_taxi.test_fare_amount_positive)
[0m18:03:05.176625 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.test_fare_amount_positive
[0m18:03:05.184646 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.test_fare_amount_positive"
[0m18:03:05.191011 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.test_fare_amount_positive
[0m18:03:05.193188 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.test_fare_amount_positive
[0m18:03:05.194616 [debug] [Thread-1  ]: Began running node model.nyc_taxi.test_mta_tax_positive
[0m18:03:05.195886 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.test_fare_amount_positive, now model.nyc_taxi.test_mta_tax_positive)
[0m18:03:05.196982 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.test_mta_tax_positive
[0m18:03:05.202057 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.test_mta_tax_positive"
[0m18:03:05.207141 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.test_mta_tax_positive
[0m18:03:05.208863 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.test_mta_tax_positive
[0m18:03:05.210142 [debug] [Thread-1  ]: Began running node model.nyc_taxi.test_tip_amount_positive
[0m18:03:05.211462 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.test_mta_tax_positive, now model.nyc_taxi.test_tip_amount_positive)
[0m18:03:05.212529 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.test_tip_amount_positive
[0m18:03:05.217318 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.test_tip_amount_positive"
[0m18:03:05.222723 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.test_tip_amount_positive
[0m18:03:05.224398 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.test_tip_amount_positive
[0m18:03:05.225797 [debug] [Thread-1  ]: Began running node model.nyc_taxi.test_tolls_amount_positive
[0m18:03:05.227022 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.test_tip_amount_positive, now model.nyc_taxi.test_tolls_amount_positive)
[0m18:03:05.228068 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.test_tolls_amount_positive
[0m18:03:05.232861 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.test_tolls_amount_positive"
[0m18:03:05.237977 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.test_tolls_amount_positive
[0m18:03:05.239677 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.test_tolls_amount_positive
[0m18:03:05.240841 [debug] [Thread-1  ]: Began running node model.nyc_taxi.test_total_amount_positive
[0m18:03:05.242116 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.test_tolls_amount_positive, now model.nyc_taxi.test_total_amount_positive)
[0m18:03:05.243214 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.test_total_amount_positive
[0m18:03:05.247985 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.test_total_amount_positive"
[0m18:03:05.253271 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.test_total_amount_positive
[0m18:03:05.254859 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.test_total_amount_positive
[0m18:03:05.256148 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_do_location_id.6acdd302a6
[0m18:03:05.257286 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.test_total_amount_positive, now test.nyc_taxi.not_null_fct_trips_do_location_id.6acdd302a6)
[0m18:03:05.258299 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_do_location_id.6acdd302a6
[0m18:03:05.264960 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_do_location_id.6acdd302a6"
[0m18:03:05.270105 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_do_location_id.6acdd302a6
[0m18:03:05.271781 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_do_location_id.6acdd302a6
[0m18:03:05.273022 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_dropoff_time.04b71dc609
[0m18:03:05.274069 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_do_location_id.6acdd302a6, now test.nyc_taxi.not_null_fct_trips_dropoff_time.04b71dc609)
[0m18:03:05.275037 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_dropoff_time.04b71dc609
[0m18:03:05.283233 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_dropoff_time.04b71dc609"
[0m18:03:05.288477 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_dropoff_time.04b71dc609
[0m18:03:05.290038 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_dropoff_time.04b71dc609
[0m18:03:05.291259 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_extra.1801055bb3
[0m18:03:05.292270 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_dropoff_time.04b71dc609, now test.nyc_taxi.not_null_fct_trips_extra.1801055bb3)
[0m18:03:05.293221 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_extra.1801055bb3
[0m18:03:05.299327 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_extra.1801055bb3"
[0m18:03:05.304680 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_extra.1801055bb3
[0m18:03:05.306189 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_extra.1801055bb3
[0m18:03:05.307403 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_improvement_surcharge.4cf28d1443
[0m18:03:05.308389 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_extra.1801055bb3, now test.nyc_taxi.not_null_fct_trips_improvement_surcharge.4cf28d1443)
[0m18:03:05.309326 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_improvement_surcharge.4cf28d1443
[0m18:03:05.315591 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_improvement_surcharge.4cf28d1443"
[0m18:03:05.320882 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_improvement_surcharge.4cf28d1443
[0m18:03:05.322510 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_improvement_surcharge.4cf28d1443
[0m18:03:05.323798 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_passenger_count.b1370cab1c
[0m18:03:05.324828 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_improvement_surcharge.4cf28d1443, now test.nyc_taxi.not_null_fct_trips_passenger_count.b1370cab1c)
[0m18:03:05.325757 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_passenger_count.b1370cab1c
[0m18:03:05.331989 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_passenger_count.b1370cab1c"
[0m18:03:05.337366 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_passenger_count.b1370cab1c
[0m18:03:05.338807 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_passenger_count.b1370cab1c
[0m18:03:05.340224 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_payment_type.93889b679a
[0m18:03:05.341401 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_passenger_count.b1370cab1c, now test.nyc_taxi.not_null_fct_trips_payment_type.93889b679a)
[0m18:03:05.342345 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_payment_type.93889b679a
[0m18:03:05.348787 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_payment_type.93889b679a"
[0m18:03:05.354395 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_payment_type.93889b679a
[0m18:03:05.356071 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_payment_type.93889b679a
[0m18:03:05.357291 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_pickup_time.693af2bf31
[0m18:03:05.358337 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_payment_type.93889b679a, now test.nyc_taxi.not_null_fct_trips_pickup_time.693af2bf31)
[0m18:03:05.359282 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_pickup_time.693af2bf31
[0m18:03:05.367362 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_pickup_time.693af2bf31"
[0m18:03:05.373257 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_pickup_time.693af2bf31
[0m18:03:05.374796 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_pickup_time.693af2bf31
[0m18:03:05.375904 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_pu_location_id.b0dc8dd185
[0m18:03:05.376996 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_pickup_time.693af2bf31, now test.nyc_taxi.not_null_fct_trips_pu_location_id.b0dc8dd185)
[0m18:03:05.378094 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_pu_location_id.b0dc8dd185
[0m18:03:05.384472 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_pu_location_id.b0dc8dd185"
[0m18:03:05.390385 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_pu_location_id.b0dc8dd185
[0m18:03:05.392142 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_pu_location_id.b0dc8dd185
[0m18:03:05.393281 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_rate_code_id.ba0047eaae
[0m18:03:05.394353 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_pu_location_id.b0dc8dd185, now test.nyc_taxi.not_null_fct_trips_rate_code_id.ba0047eaae)
[0m18:03:05.395286 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_rate_code_id.ba0047eaae
[0m18:03:05.401773 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_rate_code_id.ba0047eaae"
[0m18:03:05.407145 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_rate_code_id.ba0047eaae
[0m18:03:05.408695 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_rate_code_id.ba0047eaae
[0m18:03:05.409926 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_trip_distance.19cd17f1df
[0m18:03:05.411052 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_rate_code_id.ba0047eaae, now test.nyc_taxi.not_null_fct_trips_trip_distance.19cd17f1df)
[0m18:03:05.412061 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_trip_distance.19cd17f1df
[0m18:03:05.418664 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_trip_distance.19cd17f1df"
[0m18:03:05.424392 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_trip_distance.19cd17f1df
[0m18:03:05.425964 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_trip_distance.19cd17f1df
[0m18:03:05.427063 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_vendor_id.b9b2f380bb
[0m18:03:05.428130 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_trip_distance.19cd17f1df, now test.nyc_taxi.not_null_fct_trips_vendor_id.b9b2f380bb)
[0m18:03:05.429047 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_vendor_id.b9b2f380bb
[0m18:03:05.435636 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_vendor_id.b9b2f380bb"
[0m18:03:05.441150 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_vendor_id.b9b2f380bb
[0m18:03:05.442756 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_vendor_id.b9b2f380bb
[0m18:03:05.443921 [debug] [Thread-1  ]: Began running node test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab
[0m18:03:05.444907 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_vendor_id.b9b2f380bb, now test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab)
[0m18:03:05.445848 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab
[0m18:03:05.452200 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab"
[0m18:03:05.457554 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab
[0m18:03:05.459073 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab
[0m18:03:05.461005 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:03:05.461825 [debug] [MainThread]: Connection 'test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab' was properly closed.
[0m18:03:05.473494 [debug] [MainThread]: Command end result
[0m18:03:05.664584 [debug] [MainThread]: Acquiring new bigquery connection 'generate_catalog'
[0m18:03:05.665877 [info ] [MainThread]: Building catalog
[0m18:03:05.676076 [debug] [ThreadPool]: Acquiring new bigquery connection 'northern-shield-437204-m0.information_schema'
[0m18:03:05.705812 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:03:05.710128 [debug] [ThreadPool]: On northern-shield-437204-m0.information_schema: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "connection_name": "northern-shield-437204-m0.information_schema"} */

    with
                table_shards_stage as (
    select
        tables.project_id as table_catalog,
        tables.dataset_id as table_schema,
        coalesce(REGEXP_EXTRACT(tables.table_id, '^(.+)[0-9]{8}$'), tables.table_id) as table_name,
        tables.table_id as shard_name,
        REGEXP_EXTRACT(tables.table_id, '^.+([0-9]{8})$') as shard_index,
        REGEXP_CONTAINS(tables.table_id, '^.+[0-9]{8}$') and tables.type = 1 as is_date_shard,
        case
            when materialized_views.table_name is not null then 'materialized view'
            when tables.type = 1 then 'table'
            when tables.type = 2 then 'view'
            else 'external'
        end as table_type,
        tables.type = 1 as is_table,
        JSON_VALUE(table_description.option_value) as table_comment,
        tables.size_bytes,
        tables.row_count
    from `northern-shield-437204-m0`.`nyc_taxi`.__TABLES__ tables
    left join `northern-shield-437204-m0`.`nyc_taxi`.INFORMATION_SCHEMA.MATERIALIZED_VIEWS materialized_views
        on materialized_views.table_catalog = tables.project_id
        and materialized_views.table_schema = tables.dataset_id
        and materialized_views.table_name = tables.table_id
    left join `northern-shield-437204-m0`.`nyc_taxi`.INFORMATION_SCHEMA.TABLE_OPTIONS table_description
        on table_description.table_catalog = tables.project_id
        and table_description.table_schema = tables.dataset_id
        and table_description.table_name = tables.table_id
        and table_description.option_name = 'description'
),
                table_shards as (
                    select * from table_shards_stage
                    where ((
                                upper(table_schema) = upper('nyc_taxi')
                            and upper(table_name) = upper('test_mta_tax_positive')
                            ) or (
                                upper(table_schema) = upper('nyc_taxi')
                            and upper(table_name) = upper('zone_map')
                            ) or (
                                upper(table_schema) = upper('nyc_taxi')
                            and upper(table_name) = upper('green_tripdata')
                            ) or (
                                upper(table_schema) = upper('nyc_taxi')
                            and upper(table_name) = upper('test_tip_amount_positive')
                            ) or (
                                upper(table_schema) = upper('nyc_taxi')
                            and upper(table_name) = upper('test_tolls_amount_positive')
                            ) or (
                                upper(table_schema) = upper('nyc_taxi')
                            and upper(table_name) = upper('test_fare_amount_positive')
                            ) or (
                                upper(table_schema) = upper('nyc_taxi')
                            and upper(table_name) = upper('dim_payment')
                            ) or (
                                upper(table_schema) = upper('nyc_taxi')
                            and upper(table_name) = upper('dim_vendor')
                            ) or (
                                upper(table_schema) = upper('nyc_taxi')
                            and upper(table_name) = upper('dim_ratecode')
                            ) or (
                                upper(table_schema) = upper('nyc_taxi')
                            and upper(table_name) = upper('dim_zone')
                            ) or (
                                upper(table_schema) = upper('nyc_taxi')
                            and upper(table_name) = upper('test_total_amount_positive')
                            ) or (
                                upper(table_schema) = upper('nyc_taxi')
                            and upper(table_name) = upper('fct_trips')
                            ))
                ),
                tables as (
    select distinct
        table_catalog,
        table_schema,
        table_name,
        is_date_shard,
        table_type,
        is_table,
        table_comment
    from table_shards
),
                table_stats as (
    select
        table_catalog,
        table_schema,
        table_name,
        max(shard_name) as latest_shard_name,
        min(shard_index) as shard_min,
        max(shard_index) as shard_max,
        count(shard_index) as shard_count,
        sum(size_bytes) as size_bytes,
        sum(row_count) as row_count
    from table_shards
    group by 1, 2, 3
),

                columns as (
    select
        columns.table_catalog,
        columns.table_schema,
        columns.table_name as shard_name,
        coalesce(paths.field_path, '<unknown>') as column_name,
        -- invent a row number to account for nested fields
        -- BQ does not treat these nested properties as independent fields
        row_number() over (
            partition by
                columns.table_catalog,
                columns.table_schema,
                columns.table_name
            order by
                columns.ordinal_position,
                paths.field_path
        ) as column_index,
        coalesce(paths.data_type, '<unknown>') as column_type,
        paths.description as column_comment,
        case when columns.is_partitioning_column = 'YES' then 1 else 0 end as is_partitioning_column,
        case when columns.is_partitioning_column = 'YES' then paths.field_path end as partition_column,
        case when columns.clustering_ordinal_position is not null then 1 else 0 end as is_clustering_column,
        case when columns.clustering_ordinal_position is not null then paths.field_path end as cluster_column,
        columns.clustering_ordinal_position
    from `northern-shield-437204-m0`.`nyc_taxi`.INFORMATION_SCHEMA.COLUMNS columns
    join `northern-shield-437204-m0`.`nyc_taxi`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS paths
        on paths.table_catalog = columns.table_catalog
        and paths.table_schema = columns.table_schema
        and paths.table_name = columns.table_name
        and paths.column_name = columns.column_name
    where columns.ordinal_position is not null
),
                column_stats as (
    select
        table_catalog,
        table_schema,
        shard_name,
        max(is_partitioning_column) = 1 as is_partitioned,
        max(partition_column) as partition_column,
        max(is_clustering_column) = 1 as is_clustered,
        array_to_string(
            array_agg(
                cluster_column ignore nulls
                order by clustering_ordinal_position
            ), ', '
        ) as clustering_columns
    from columns
    group by 1, 2, 3
)

            
    select
        tables.table_catalog as table_database,
        tables.table_schema,
        case
            when tables.is_date_shard then concat(tables.table_name, '*')
            else tables.table_name
        end as table_name,
        tables.table_type,
        tables.table_comment,
        -- coalesce column metadata fields to ensure they are non-null for catalog generation
        -- external table columns are not present in COLUMN_FIELD_PATHS
        coalesce(columns.column_name, '<unknown>') as column_name,
        coalesce(columns.column_index, 1) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        coalesce(columns.column_comment, '') as column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_stats.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        tables.is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_stats.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        tables.is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_stats.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        tables.is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        table_stats.row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        tables.is_table as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        table_stats.size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        tables.is_table as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        column_stats.partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        column_stats.is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        column_stats.clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        column_stats.is_clustered as `stats__clustering_fields__include`

    from tables
    join table_stats
        on table_stats.table_catalog = tables.table_catalog
        and table_stats.table_schema = tables.table_schema
        and table_stats.table_name = tables.table_name
    left join column_stats
        on column_stats.table_catalog = tables.table_catalog
        and column_stats.table_schema = tables.table_schema
        and column_stats.shard_name = table_stats.latest_shard_name
    left join columns
        on columns.table_catalog = tables.table_catalog
        and columns.table_schema = tables.table_schema
        and columns.shard_name = table_stats.latest_shard_name

  
[0m18:03:06.502425 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:3c228e3f-49bc-49df-b768-99f96c8e913a&page=queryresults
[0m18:03:09.543292 [info ] [MainThread]: Catalog written to /opt/airflow/include/dbt/target/catalog.json
[0m18:03:09.545786 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 8.378201, "process_in_blocks": "3000", "process_kernel_time": 0.346767, "process_mem_max_rss": "244672", "process_out_blocks": "0", "process_user_time": 5.623249}
[0m18:03:09.547290 [debug] [MainThread]: Command `dbt docs generate` succeeded at 18:03:09.547096 after 8.38 seconds
[0m18:03:09.548404 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m18:03:09.549617 [debug] [MainThread]: Connection 'northern-shield-437204-m0.information_schema' was properly closed.
[0m18:03:09.550695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f11c9236c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f118fc21430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f118fb85f10>]}
[0m18:03:09.551685 [debug] [MainThread]: Flushing usage events
[0m18:03:42.511439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e85201c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e84346be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e8300ccd0>]}


============================== 18:03:42.520695 | c6f96a0c-4c02-4871-b799-f50c72485679 ==============================
[0m18:03:42.520695 [info ] [MainThread]: Running with dbt=1.8.9
[0m18:03:42.522254 [debug] [MainThread]: running dbt with arguments {'use_experimental_parser': 'False', 'invocation_command': 'dbt docs serve --profiles-dir /opt/airflow/include/dbt/', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/include/dbt/logs', 'log_cache_events': 'False', 'empty': 'None', 'use_colors': 'True', 'cache_selected_only': 'False', 'version_check': 'True', 'printer_width': '80', 'partial_parse': 'True', 'introspect': 'True', 'quiet': 'False', 'indirect_selection': 'eager', 'write_json': 'True', 'warn_error': 'None', 'static_parser': 'True', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'profiles_dir': '/opt/airflow/include/dbt/', 'log_format': 'default'}
[0m18:03:43.789982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c6f96a0c-4c02-4871-b799-f50c72485679', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e4bbf4850>]}
[0m18:03:43.858153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c6f96a0c-4c02-4871-b799-f50c72485679', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e4bbb5fd0>]}
[0m18:09:53.226586 [error] [MainThread]: Encountered an error:

[0m18:09:53.237491 [error] [MainThread]: Traceback (most recent call last):
  File "/opt/airflow/dbt_venv/lib/python3.9/site-packages/dbt/cli/requires.py", line 138, in wrapper
    result, success = func(*args, **kwargs)
  File "/opt/airflow/dbt_venv/lib/python3.9/site-packages/dbt/cli/requires.py", line 101, in wrapper
    return func(*args, **kwargs)
  File "/opt/airflow/dbt_venv/lib/python3.9/site-packages/dbt/cli/requires.py", line 218, in wrapper
    return func(*args, **kwargs)
  File "/opt/airflow/dbt_venv/lib/python3.9/site-packages/dbt/cli/requires.py", line 247, in wrapper
    return func(*args, **kwargs)
  File "/opt/airflow/dbt_venv/lib/python3.9/site-packages/dbt/cli/requires.py", line 294, in wrapper
    return func(*args, **kwargs)
  File "/opt/airflow/dbt_venv/lib/python3.9/site-packages/dbt/cli/main.py", line 303, in docs_serve
    results = task.run()
  File "/opt/airflow/dbt_venv/lib/python3.9/site-packages/dbt/task/docs/serve.py", line 29, in run
    httpd.serve_forever()
  File "/usr/local/lib/python3.9/socketserver.py", line 232, in serve_forever
    ready = selector.select(poll_interval)
  File "/usr/local/lib/python3.9/selectors.py", line 416, in select
    fd_event_list = self._selector.poll(timeout)
KeyboardInterrupt

[0m18:09:53.241224 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_success": false, "command_wall_clock_time": 394.84006, "process_in_blocks": "16", "process_kernel_time": 0.225772, "process_mem_max_rss": "246856", "process_out_blocks": "0", "process_user_time": 4.440189}
[0m18:09:53.243751 [debug] [MainThread]: Command `dbt docs serve` failed at 18:09:53.243402 after 394.84 seconds
[0m18:09:53.245597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e85201c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e4bbbe1c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e4bbbeb50>]}
[0m18:09:53.247021 [debug] [MainThread]: Flushing usage events
[0m18:10:01.168726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90a3b29c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90a1926f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90a1926f10>]}


============================== 18:10:01.177495 | 1bd7fc90-5556-4e48-8cc9-751fc47ced52 ==============================
[0m18:10:01.177495 [info ] [MainThread]: Running with dbt=1.8.9
[0m18:10:01.179107 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'log_path': '/opt/airflow/include/dbt/logs', 'introspect': 'True', 'use_experimental_parser': 'False', 'profiles_dir': '/opt/airflow/include/dbt/', 'warn_error': 'None', 'log_cache_events': 'False', 'debug': 'False', 'send_anonymous_usage_stats': 'True', 'printer_width': '80', 'indirect_selection': 'eager', 'cache_selected_only': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'use_colors': 'True', 'fail_fast': 'False', 'quiet': 'False', 'empty': 'None', 'version_check': 'True', 'target_path': 'None', 'invocation_command': 'dbt docs serve --profiles-dir /opt/airflow/include/dbt/ --port 8081', 'write_json': 'True', 'no_print': 'None', 'partial_parse': 'True', 'log_format': 'default'}
[0m18:10:02.570272 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1bd7fc90-5556-4e48-8cc9-751fc47ced52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90a196a730>]}
[0m18:10:02.662219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1bd7fc90-5556-4e48-8cc9-751fc47ced52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90a3e7d0a0>]}
[0m18:15:27.475542 [error] [MainThread]: Encountered an error:

[0m18:15:27.484871 [error] [MainThread]: Traceback (most recent call last):
  File "/opt/airflow/dbt_venv/lib/python3.9/site-packages/dbt/cli/requires.py", line 138, in wrapper
    result, success = func(*args, **kwargs)
  File "/opt/airflow/dbt_venv/lib/python3.9/site-packages/dbt/cli/requires.py", line 101, in wrapper
    return func(*args, **kwargs)
  File "/opt/airflow/dbt_venv/lib/python3.9/site-packages/dbt/cli/requires.py", line 218, in wrapper
    return func(*args, **kwargs)
  File "/opt/airflow/dbt_venv/lib/python3.9/site-packages/dbt/cli/requires.py", line 247, in wrapper
    return func(*args, **kwargs)
  File "/opt/airflow/dbt_venv/lib/python3.9/site-packages/dbt/cli/requires.py", line 294, in wrapper
    return func(*args, **kwargs)
  File "/opt/airflow/dbt_venv/lib/python3.9/site-packages/dbt/cli/main.py", line 303, in docs_serve
    results = task.run()
  File "/opt/airflow/dbt_venv/lib/python3.9/site-packages/dbt/task/docs/serve.py", line 29, in run
    httpd.serve_forever()
  File "/usr/local/lib/python3.9/socketserver.py", line 232, in serve_forever
    ready = selector.select(poll_interval)
  File "/usr/local/lib/python3.9/selectors.py", line 416, in select
    fd_event_list = self._selector.poll(timeout)
KeyboardInterrupt

[0m18:15:27.494410 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_success": false, "command_wall_clock_time": 348.71307, "process_in_blocks": "520", "process_kernel_time": 0.196355, "process_mem_max_rss": "246808", "process_out_blocks": "0", "process_user_time": 4.488133}
[0m18:15:27.500102 [debug] [MainThread]: Command `dbt docs serve` failed at 18:15:27.499531 after 348.72 seconds
[0m18:15:27.504691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90a3b29c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f906a350880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f906a350ee0>]}
[0m18:15:27.508545 [debug] [MainThread]: Flushing usage events
[0m18:20:55.877486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e6ab65c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e689b0f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e689b0f10>]}


============================== 18:20:55.897560 | 18d7627d-e1d9-4c66-a28d-19c7ccae1ffb ==============================
[0m18:20:55.897560 [info ] [MainThread]: Running with dbt=1.8.9
[0m18:20:55.901448 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'log_cache_events': 'False', 'warn_error': 'None', 'indirect_selection': 'eager', 'profiles_dir': '/opt/airflow/include/dbt/', 'use_colors': 'True', 'quiet': 'False', 'invocation_command': 'dbt docs serve --profiles-dir /opt/airflow/include/dbt/ --port 8081 --host 0.0.0.0', 'log_path': '/opt/airflow/include/dbt/logs', 'empty': 'None', 'target_path': 'None', 'fail_fast': 'False', 'printer_width': '80', 'cache_selected_only': 'False', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'version_check': 'True', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'debug': 'False', 'write_json': 'True', 'no_print': 'None'}
[0m18:20:59.035273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '18d7627d-e1d9-4c66-a28d-19c7ccae1ffb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e6a324820>]}
[0m18:20:59.201976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '18d7627d-e1d9-4c66-a28d-19c7ccae1ffb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e314adc10>]}
[0m18:22:31.882881 [error] [MainThread]: Encountered an error:

[0m18:22:31.892005 [error] [MainThread]: Traceback (most recent call last):
  File "/opt/airflow/dbt_venv/lib/python3.9/site-packages/dbt/cli/requires.py", line 138, in wrapper
    result, success = func(*args, **kwargs)
  File "/opt/airflow/dbt_venv/lib/python3.9/site-packages/dbt/cli/requires.py", line 101, in wrapper
    return func(*args, **kwargs)
  File "/opt/airflow/dbt_venv/lib/python3.9/site-packages/dbt/cli/requires.py", line 218, in wrapper
    return func(*args, **kwargs)
  File "/opt/airflow/dbt_venv/lib/python3.9/site-packages/dbt/cli/requires.py", line 247, in wrapper
    return func(*args, **kwargs)
  File "/opt/airflow/dbt_venv/lib/python3.9/site-packages/dbt/cli/requires.py", line 294, in wrapper
    return func(*args, **kwargs)
  File "/opt/airflow/dbt_venv/lib/python3.9/site-packages/dbt/cli/main.py", line 303, in docs_serve
    results = task.run()
  File "/opt/airflow/dbt_venv/lib/python3.9/site-packages/dbt/task/docs/serve.py", line 29, in run
    httpd.serve_forever()
  File "/usr/local/lib/python3.9/socketserver.py", line 232, in serve_forever
    ready = selector.select(poll_interval)
  File "/usr/local/lib/python3.9/selectors.py", line 416, in select
    fd_event_list = self._selector.poll(timeout)
KeyboardInterrupt

[0m18:22:31.899986 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_success": false, "command_wall_clock_time": 103.83366, "process_in_blocks": "0", "process_kernel_time": 0.587873, "process_mem_max_rss": "226516", "process_out_blocks": "0", "process_user_time": 9.059041}
[0m18:22:31.906404 [debug] [MainThread]: Command `dbt docs serve` failed at 18:22:31.905565 after 103.84 seconds
[0m18:22:31.910736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e6ab65c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e3139cfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e3139c910>]}
[0m18:22:31.915572 [debug] [MainThread]: Flushing usage events
[0m18:26:12.010481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71aa0eac70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71a7f34bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71a7f34250>]}


============================== 18:26:12.034919 | dd340554-ebee-4a35-8622-b2e37a157901 ==============================
[0m18:26:12.034919 [info ] [MainThread]: Running with dbt=1.8.9
[0m18:26:12.039536 [debug] [MainThread]: running dbt with arguments {'debug': 'False', 'warn_error': 'None', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'introspect': 'True', 'target_path': 'None', 'log_cache_events': 'False', 'version_check': 'True', 'empty': 'None', 'quiet': 'False', 'printer_width': '80', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True', 'log_path': '/opt/airflow/include/dbt/logs', 'log_format': 'default', 'write_json': 'True', 'use_colors': 'True', 'static_parser': 'True', 'no_print': 'None', 'invocation_command': 'dbt debug --profiles-dir /opt/airflow/include/dbt/', 'partial_parse': 'True', 'profiles_dir': '/opt/airflow/include/dbt/', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])'}
[0m18:26:12.074122 [info ] [MainThread]: dbt version: 1.8.9
[0m18:26:12.078266 [info ] [MainThread]: python version: 3.9.19
[0m18:26:12.082754 [info ] [MainThread]: python path: /opt/airflow/dbt_venv/bin/python
[0m18:26:12.086654 [info ] [MainThread]: os info: Linux-5.15.167.4-microsoft-standard-WSL2-x86_64-with-glibc2.36
[0m18:26:13.294508 [info ] [MainThread]: Using profiles dir at /opt/airflow/include/dbt/
[0m18:26:13.297683 [info ] [MainThread]: Using profiles.yml file at /opt/airflow/include/dbt/profiles.yml
[0m18:26:13.300972 [info ] [MainThread]: Using dbt_project.yml file at /opt/airflow/include/dbt/dbt_project.yml
[0m18:26:13.303490 [info ] [MainThread]: adapter type: bigquery
[0m18:26:13.305973 [info ] [MainThread]: adapter version: 1.8.3
[0m18:26:13.613434 [info ] [MainThread]: Configuration:
[0m18:26:13.616684 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m18:26:13.619756 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m18:26:13.622550 [info ] [MainThread]: Required dependencies:
[0m18:26:13.625777 [debug] [MainThread]: Executing "git --help"
[0m18:26:13.674727 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m18:26:13.679089 [debug] [MainThread]: STDERR: "b''"
[0m18:26:13.682685 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m18:26:13.686401 [info ] [MainThread]: Connection:
[0m18:26:13.689519 [info ] [MainThread]:   method: service-account
[0m18:26:13.692385 [info ] [MainThread]:   database: northern-shield-437204-m0
[0m18:26:13.695318 [info ] [MainThread]:   execution_project: northern-shield-437204-m0
[0m18:26:13.698423 [info ] [MainThread]:   schema: nyc_taxi
[0m18:26:13.701605 [info ] [MainThread]:   location: us-central1
[0m18:26:13.704628 [info ] [MainThread]:   priority: None
[0m18:26:13.707690 [info ] [MainThread]:   maximum_bytes_billed: None
[0m18:26:13.710936 [info ] [MainThread]:   impersonate_service_account: None
[0m18:26:13.713985 [info ] [MainThread]:   job_retry_deadline_seconds: None
[0m18:26:13.717529 [info ] [MainThread]:   job_retries: 1
[0m18:26:13.722311 [info ] [MainThread]:   job_creation_timeout_seconds: None
[0m18:26:13.725584 [info ] [MainThread]:   job_execution_timeout_seconds: 300
[0m18:26:13.728314 [info ] [MainThread]:   timeout_seconds: 300
[0m18:26:13.733558 [info ] [MainThread]:   client_id: None
[0m18:26:13.739067 [info ] [MainThread]:   token_uri: None
[0m18:26:13.745341 [info ] [MainThread]:   dataproc_region: None
[0m18:26:13.783005 [info ] [MainThread]:   dataproc_cluster_name: None
[0m18:26:13.798963 [info ] [MainThread]:   gcs_bucket: None
[0m18:26:13.801727 [info ] [MainThread]:   dataproc_batch: None
[0m18:26:13.815298 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m18:26:14.293601 [debug] [MainThread]: Acquiring new bigquery connection 'debug'
[0m18:26:14.297787 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:26:14.309856 [debug] [MainThread]: On debug: select 1 as id
[0m18:26:16.495179 [debug] [MainThread]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:ab8ffac8-4e76-4d87-a946-3250483cb6dc&page=queryresults
[0m18:26:17.340326 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m18:26:17.343641 [info ] [MainThread]: [32mAll checks passed![0m
[0m18:26:17.349980 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 7.45411, "process_in_blocks": "120", "process_kernel_time": 0.760607, "process_mem_max_rss": "234628", "process_out_blocks": "0", "process_user_time": 9.897404}
[0m18:26:17.354316 [debug] [MainThread]: Command `dbt debug` succeeded at 18:26:17.353733 after 7.46 seconds
[0m18:26:17.357905 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m18:26:17.361055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71aa0eac70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7170a33400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71a7e070d0>]}
[0m18:26:17.366529 [debug] [MainThread]: Flushing usage events
[0m18:30:59.100690 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80f013ec70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80edf3fd00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80edf3fd60>]}


============================== 18:30:59.120919 | 81f0ba54-b2c9-4b0b-92fc-616e93ed1f4d ==============================
[0m18:30:59.120919 [info ] [MainThread]: Running with dbt=1.8.9
[0m18:30:59.125832 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'empty': 'None', 'debug': 'False', 'log_path': '/opt/airflow/include/dbt/logs', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'use_experimental_parser': 'False', 'quiet': 'False', 'no_print': 'None', 'static_parser': 'True', 'invocation_command': 'dbt docs generate --profiles-dir /opt/airflow/include/dbt/', 'profiles_dir': '/opt/airflow/include/dbt/', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'printer_width': '80', 'use_colors': 'True', 'log_format': 'default', 'introspect': 'True', 'cache_selected_only': 'False', 'write_json': 'True', 'indirect_selection': 'eager', 'version_check': 'True', 'fail_fast': 'False', 'warn_error': 'None'}
[0m18:31:02.029242 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '81f0ba54-b2c9-4b0b-92fc-616e93ed1f4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80ef8f1eb0>]}
[0m18:31:02.196254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '81f0ba54-b2c9-4b0b-92fc-616e93ed1f4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80b6a58430>]}
[0m18:31:02.200408 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m18:31:02.714232 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m18:31:06.332265 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:31:06.335733 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:31:06.504536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '81f0ba54-b2c9-4b0b-92fc-616e93ed1f4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80e922eee0>]}
[0m18:31:06.560066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '81f0ba54-b2c9-4b0b-92fc-616e93ed1f4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80e91d2af0>]}
[0m18:31:06.563399 [info ] [MainThread]: Found 10 models, 23 data tests, 2 sources, 600 macros
[0m18:31:06.567547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '81f0ba54-b2c9-4b0b-92fc-616e93ed1f4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80e91d2ac0>]}
[0m18:31:06.579373 [info ] [MainThread]: 
[0m18:31:06.584394 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:31:06.603472 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_northern-shield-437204-m0_nyc_taxi'
[0m18:31:06.607417 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:31:07.317557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '81f0ba54-b2c9-4b0b-92fc-616e93ed1f4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80b6ab1c70>]}
[0m18:31:07.322150 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:31:07.325223 [info ] [MainThread]: 
[0m18:31:07.347725 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_payment
[0m18:31:07.352939 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_northern-shield-437204-m0_nyc_taxi, now model.nyc_taxi.dim_payment)
[0m18:31:07.356839 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_payment
[0m18:31:07.392631 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_payment"
[0m18:31:07.420046 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_payment
[0m18:31:07.425648 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_payment
[0m18:31:07.434156 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_ratecode
[0m18:31:07.438074 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_payment, now model.nyc_taxi.dim_ratecode)
[0m18:31:07.441880 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_ratecode
[0m18:31:07.732046 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_ratecode"
[0m18:31:07.755482 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_ratecode
[0m18:31:07.761089 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_ratecode
[0m18:31:07.764950 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_vendor
[0m18:31:07.768835 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_ratecode, now model.nyc_taxi.dim_vendor)
[0m18:31:07.772269 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_vendor
[0m18:31:07.786928 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_vendor"
[0m18:31:07.811216 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_vendor
[0m18:31:07.816996 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_vendor
[0m18:31:07.821463 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_zone
[0m18:31:07.825414 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_vendor, now model.nyc_taxi.dim_zone)
[0m18:31:07.829268 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_zone
[0m18:31:07.841257 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_zone"
[0m18:31:07.866011 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_zone
[0m18:31:07.871753 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_zone
[0m18:31:07.875929 [debug] [Thread-1  ]: Began running node model.nyc_taxi.fct_trips
[0m18:31:07.879613 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_zone, now model.nyc_taxi.fct_trips)
[0m18:31:07.883094 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.fct_trips
[0m18:31:07.942976 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.fct_trips"
[0m18:31:07.968999 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.fct_trips
[0m18:31:07.974203 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.fct_trips
[0m18:31:07.978554 [debug] [Thread-1  ]: Began running node test.nyc_taxi.accepted_values_dim_payment_payment_name__Credit_card__Cash__No_charge__Dispute__Unknown__Voided_trip.58d00ef9f4
[0m18:31:07.983283 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.fct_trips, now test.nyc_taxi.accepted_values_dim_payment_payment_name__Credit_card__Cash__No_charge__Dispute__Unknown__Voided_trip.58d00ef9f4)
[0m18:31:07.986823 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.accepted_values_dim_payment_payment_name__Credit_card__Cash__No_charge__Dispute__Unknown__Voided_trip.58d00ef9f4
[0m18:31:08.038152 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.accepted_values_dim_payment_payment_name__Credit_card__Cash__No_charge__Dispute__Unknown__Voided_trip.58d00ef9f4"
[0m18:31:08.068158 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.accepted_values_dim_payment_payment_name__Credit_card__Cash__No_charge__Dispute__Unknown__Voided_trip.58d00ef9f4
[0m18:31:08.073578 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.accepted_values_dim_payment_payment_name__Credit_card__Cash__No_charge__Dispute__Unknown__Voided_trip.58d00ef9f4
[0m18:31:08.077421 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_dim_payment_type_id.96dfa722aa
[0m18:31:08.081297 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.accepted_values_dim_payment_payment_name__Credit_card__Cash__No_charge__Dispute__Unknown__Voided_trip.58d00ef9f4, now test.nyc_taxi.not_null_dim_payment_type_id.96dfa722aa)
[0m18:31:08.084742 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_dim_payment_type_id.96dfa722aa
[0m18:31:08.116847 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_dim_payment_type_id.96dfa722aa"
[0m18:31:08.144560 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_dim_payment_type_id.96dfa722aa
[0m18:31:08.149661 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_dim_payment_type_id.96dfa722aa
[0m18:31:08.153739 [debug] [Thread-1  ]: Began running node test.nyc_taxi.unique_dim_payment_type_id.dea55de04e
[0m18:31:08.157108 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_dim_payment_type_id.96dfa722aa, now test.nyc_taxi.unique_dim_payment_type_id.dea55de04e)
[0m18:31:08.160686 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.unique_dim_payment_type_id.dea55de04e
[0m18:31:08.183569 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.unique_dim_payment_type_id.dea55de04e"
[0m18:31:08.213579 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.unique_dim_payment_type_id.dea55de04e
[0m18:31:08.218477 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.unique_dim_payment_type_id.dea55de04e
[0m18:31:08.222347 [debug] [Thread-1  ]: Began running node test.nyc_taxi.accepted_values_dim_ratecode_rate_code_name__Standard_rate__JFK__Newark__Nassau_or_Westchester__Negotiated_fare__Group_ride__Unknown.57ee02019f
[0m18:31:08.226109 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.unique_dim_payment_type_id.dea55de04e, now test.nyc_taxi.accepted_values_dim_ratecode_rate_code_name__Standard_rate__JFK__Newark__Nassau_or_Westchester__Negotiated_fare__Group_ride__Unknown.57ee02019f)
[0m18:31:08.229307 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.accepted_values_dim_ratecode_rate_code_name__Standard_rate__JFK__Newark__Nassau_or_Westchester__Negotiated_fare__Group_ride__Unknown.57ee02019f
[0m18:31:08.256054 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.accepted_values_dim_ratecode_rate_code_name__Standard_rate__JFK__Newark__Nassau_or_Westchester__Negotiated_fare__Group_ride__Unknown.57ee02019f"
[0m18:31:08.286334 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.accepted_values_dim_ratecode_rate_code_name__Standard_rate__JFK__Newark__Nassau_or_Westchester__Negotiated_fare__Group_ride__Unknown.57ee02019f
[0m18:31:08.291160 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.accepted_values_dim_ratecode_rate_code_name__Standard_rate__JFK__Newark__Nassau_or_Westchester__Negotiated_fare__Group_ride__Unknown.57ee02019f
[0m18:31:08.295668 [debug] [Thread-1  ]: Began running node test.nyc_taxi.unique_dim_ratecode_rate_id.75ae8e4885
[0m18:31:08.299346 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.accepted_values_dim_ratecode_rate_code_name__Standard_rate__JFK__Newark__Nassau_or_Westchester__Negotiated_fare__Group_ride__Unknown.57ee02019f, now test.nyc_taxi.unique_dim_ratecode_rate_id.75ae8e4885)
[0m18:31:08.302330 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.unique_dim_ratecode_rate_id.75ae8e4885
[0m18:31:08.322409 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.unique_dim_ratecode_rate_id.75ae8e4885"
[0m18:31:08.349230 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.unique_dim_ratecode_rate_id.75ae8e4885
[0m18:31:08.354115 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.unique_dim_ratecode_rate_id.75ae8e4885
[0m18:31:08.357928 [debug] [Thread-1  ]: Began running node test.nyc_taxi.accepted_values_dim_vendor_vendor_name__Creative_Mobile_Technologies__VeriFone_Inc_.7481cecf07
[0m18:31:08.361655 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.unique_dim_ratecode_rate_id.75ae8e4885, now test.nyc_taxi.accepted_values_dim_vendor_vendor_name__Creative_Mobile_Technologies__VeriFone_Inc_.7481cecf07)
[0m18:31:08.367475 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.accepted_values_dim_vendor_vendor_name__Creative_Mobile_Technologies__VeriFone_Inc_.7481cecf07
[0m18:31:08.396367 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.accepted_values_dim_vendor_vendor_name__Creative_Mobile_Technologies__VeriFone_Inc_.7481cecf07"
[0m18:31:08.423660 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.accepted_values_dim_vendor_vendor_name__Creative_Mobile_Technologies__VeriFone_Inc_.7481cecf07
[0m18:31:08.428288 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.accepted_values_dim_vendor_vendor_name__Creative_Mobile_Technologies__VeriFone_Inc_.7481cecf07
[0m18:31:08.436274 [debug] [Thread-1  ]: Began running node test.nyc_taxi.unique_dim_vendor_id.03fad38d04
[0m18:31:08.440342 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.accepted_values_dim_vendor_vendor_name__Creative_Mobile_Technologies__VeriFone_Inc_.7481cecf07, now test.nyc_taxi.unique_dim_vendor_id.03fad38d04)
[0m18:31:08.444048 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.unique_dim_vendor_id.03fad38d04
[0m18:31:08.460223 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.unique_dim_vendor_id.03fad38d04"
[0m18:31:08.486306 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.unique_dim_vendor_id.03fad38d04
[0m18:31:08.492121 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.unique_dim_vendor_id.03fad38d04
[0m18:31:08.496217 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_dim_zone_borough.1ed2272c52
[0m18:31:08.501069 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.unique_dim_vendor_id.03fad38d04, now test.nyc_taxi.not_null_dim_zone_borough.1ed2272c52)
[0m18:31:08.505128 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_dim_zone_borough.1ed2272c52
[0m18:31:08.524041 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_dim_zone_borough.1ed2272c52"
[0m18:31:08.552581 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_dim_zone_borough.1ed2272c52
[0m18:31:08.558384 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_dim_zone_borough.1ed2272c52
[0m18:31:08.563132 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_dim_zone_service_zone.2007f611c5
[0m18:31:08.567079 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_dim_zone_borough.1ed2272c52, now test.nyc_taxi.not_null_dim_zone_service_zone.2007f611c5)
[0m18:31:08.570265 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_dim_zone_service_zone.2007f611c5
[0m18:31:08.586706 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_dim_zone_service_zone.2007f611c5"
[0m18:31:08.607042 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_dim_zone_service_zone.2007f611c5
[0m18:31:08.611470 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_dim_zone_service_zone.2007f611c5
[0m18:31:08.614678 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_dim_zone_zone.a1c4a4c37a
[0m18:31:08.617686 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_dim_zone_service_zone.2007f611c5, now test.nyc_taxi.not_null_dim_zone_zone.a1c4a4c37a)
[0m18:31:08.620456 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_dim_zone_zone.a1c4a4c37a
[0m18:31:08.640555 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_dim_zone_zone.a1c4a4c37a"
[0m18:31:08.663083 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_dim_zone_zone.a1c4a4c37a
[0m18:31:08.668391 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_dim_zone_zone.a1c4a4c37a
[0m18:31:08.672520 [debug] [Thread-1  ]: Began running node test.nyc_taxi.unique_dim_zone_location_id.7702f92424
[0m18:31:08.675815 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_dim_zone_zone.a1c4a4c37a, now test.nyc_taxi.unique_dim_zone_location_id.7702f92424)
[0m18:31:08.679075 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.unique_dim_zone_location_id.7702f92424
[0m18:31:08.696517 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.unique_dim_zone_location_id.7702f92424"
[0m18:31:08.726737 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.unique_dim_zone_location_id.7702f92424
[0m18:31:08.732530 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.unique_dim_zone_location_id.7702f92424
[0m18:31:08.737242 [debug] [Thread-1  ]: Began running node model.nyc_taxi.test_fare_amount_positive
[0m18:31:08.740669 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.unique_dim_zone_location_id.7702f92424, now model.nyc_taxi.test_fare_amount_positive)
[0m18:31:08.743631 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.test_fare_amount_positive
[0m18:31:08.759133 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.test_fare_amount_positive"
[0m18:31:08.782484 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.test_fare_amount_positive
[0m18:31:08.787326 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.test_fare_amount_positive
[0m18:31:08.791021 [debug] [Thread-1  ]: Began running node model.nyc_taxi.test_mta_tax_positive
[0m18:31:08.795073 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.test_fare_amount_positive, now model.nyc_taxi.test_mta_tax_positive)
[0m18:31:08.798754 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.test_mta_tax_positive
[0m18:31:08.811347 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.test_mta_tax_positive"
[0m18:31:08.835513 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.test_mta_tax_positive
[0m18:31:08.840403 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.test_mta_tax_positive
[0m18:31:08.843999 [debug] [Thread-1  ]: Began running node model.nyc_taxi.test_tip_amount_positive
[0m18:31:08.848296 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.test_mta_tax_positive, now model.nyc_taxi.test_tip_amount_positive)
[0m18:31:08.851887 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.test_tip_amount_positive
[0m18:31:08.866866 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.test_tip_amount_positive"
[0m18:31:08.886604 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.test_tip_amount_positive
[0m18:31:08.892096 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.test_tip_amount_positive
[0m18:31:08.895919 [debug] [Thread-1  ]: Began running node model.nyc_taxi.test_tolls_amount_positive
[0m18:31:08.899705 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.test_tip_amount_positive, now model.nyc_taxi.test_tolls_amount_positive)
[0m18:31:08.902522 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.test_tolls_amount_positive
[0m18:31:08.913972 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.test_tolls_amount_positive"
[0m18:31:08.932856 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.test_tolls_amount_positive
[0m18:31:08.937880 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.test_tolls_amount_positive
[0m18:31:08.941941 [debug] [Thread-1  ]: Began running node model.nyc_taxi.test_total_amount_positive
[0m18:31:08.945440 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.test_tolls_amount_positive, now model.nyc_taxi.test_total_amount_positive)
[0m18:31:08.948710 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.test_total_amount_positive
[0m18:31:08.961159 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.test_total_amount_positive"
[0m18:31:08.984307 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.test_total_amount_positive
[0m18:31:08.989956 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.test_total_amount_positive
[0m18:31:08.993950 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_do_location_id.6acdd302a6
[0m18:31:08.998309 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.test_total_amount_positive, now test.nyc_taxi.not_null_fct_trips_do_location_id.6acdd302a6)
[0m18:31:09.002095 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_do_location_id.6acdd302a6
[0m18:31:09.018092 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_do_location_id.6acdd302a6"
[0m18:31:09.039422 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_do_location_id.6acdd302a6
[0m18:31:09.043756 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_do_location_id.6acdd302a6
[0m18:31:09.047224 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_dropoff_time.04b71dc609
[0m18:31:09.050202 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_do_location_id.6acdd302a6, now test.nyc_taxi.not_null_fct_trips_dropoff_time.04b71dc609)
[0m18:31:09.052833 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_dropoff_time.04b71dc609
[0m18:31:09.075346 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_dropoff_time.04b71dc609"
[0m18:31:09.097412 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_dropoff_time.04b71dc609
[0m18:31:09.103003 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_dropoff_time.04b71dc609
[0m18:31:09.106886 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_extra.1801055bb3
[0m18:31:09.110685 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_dropoff_time.04b71dc609, now test.nyc_taxi.not_null_fct_trips_extra.1801055bb3)
[0m18:31:09.114256 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_extra.1801055bb3
[0m18:31:09.132517 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_extra.1801055bb3"
[0m18:31:09.155406 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_extra.1801055bb3
[0m18:31:09.160857 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_extra.1801055bb3
[0m18:31:09.164707 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_improvement_surcharge.4cf28d1443
[0m18:31:09.167658 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_extra.1801055bb3, now test.nyc_taxi.not_null_fct_trips_improvement_surcharge.4cf28d1443)
[0m18:31:09.170733 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_improvement_surcharge.4cf28d1443
[0m18:31:09.188135 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_improvement_surcharge.4cf28d1443"
[0m18:31:09.212379 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_improvement_surcharge.4cf28d1443
[0m18:31:09.217533 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_improvement_surcharge.4cf28d1443
[0m18:31:09.222678 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_passenger_count.b1370cab1c
[0m18:31:09.226230 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_improvement_surcharge.4cf28d1443, now test.nyc_taxi.not_null_fct_trips_passenger_count.b1370cab1c)
[0m18:31:09.229423 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_passenger_count.b1370cab1c
[0m18:31:09.249358 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_passenger_count.b1370cab1c"
[0m18:31:09.273502 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_passenger_count.b1370cab1c
[0m18:31:09.278350 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_passenger_count.b1370cab1c
[0m18:31:09.282294 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_payment_type.93889b679a
[0m18:31:09.286054 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_passenger_count.b1370cab1c, now test.nyc_taxi.not_null_fct_trips_payment_type.93889b679a)
[0m18:31:09.289655 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_payment_type.93889b679a
[0m18:31:09.308862 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_payment_type.93889b679a"
[0m18:31:09.335893 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_payment_type.93889b679a
[0m18:31:09.341181 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_payment_type.93889b679a
[0m18:31:09.345201 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_pickup_time.693af2bf31
[0m18:31:09.348767 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_payment_type.93889b679a, now test.nyc_taxi.not_null_fct_trips_pickup_time.693af2bf31)
[0m18:31:09.352160 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_pickup_time.693af2bf31
[0m18:31:09.372264 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_pickup_time.693af2bf31"
[0m18:31:09.399335 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_pickup_time.693af2bf31
[0m18:31:09.405548 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_pickup_time.693af2bf31
[0m18:31:09.409935 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_pu_location_id.b0dc8dd185
[0m18:31:09.413478 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_pickup_time.693af2bf31, now test.nyc_taxi.not_null_fct_trips_pu_location_id.b0dc8dd185)
[0m18:31:09.417203 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_pu_location_id.b0dc8dd185
[0m18:31:09.436294 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_pu_location_id.b0dc8dd185"
[0m18:31:09.464071 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_pu_location_id.b0dc8dd185
[0m18:31:09.469035 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_pu_location_id.b0dc8dd185
[0m18:31:09.472788 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_rate_code_id.ba0047eaae
[0m18:31:09.476479 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_pu_location_id.b0dc8dd185, now test.nyc_taxi.not_null_fct_trips_rate_code_id.ba0047eaae)
[0m18:31:09.480018 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_rate_code_id.ba0047eaae
[0m18:31:09.496915 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_rate_code_id.ba0047eaae"
[0m18:31:09.520104 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_rate_code_id.ba0047eaae
[0m18:31:09.524713 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_rate_code_id.ba0047eaae
[0m18:31:09.528913 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_trip_distance.19cd17f1df
[0m18:31:09.532528 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_rate_code_id.ba0047eaae, now test.nyc_taxi.not_null_fct_trips_trip_distance.19cd17f1df)
[0m18:31:09.535781 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_trip_distance.19cd17f1df
[0m18:31:09.553350 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_trip_distance.19cd17f1df"
[0m18:31:09.578442 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_trip_distance.19cd17f1df
[0m18:31:09.584049 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_trip_distance.19cd17f1df
[0m18:31:09.587819 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_vendor_id.b9b2f380bb
[0m18:31:09.591412 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_trip_distance.19cd17f1df, now test.nyc_taxi.not_null_fct_trips_vendor_id.b9b2f380bb)
[0m18:31:09.594724 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_vendor_id.b9b2f380bb
[0m18:31:09.616065 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_vendor_id.b9b2f380bb"
[0m18:31:09.643912 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_vendor_id.b9b2f380bb
[0m18:31:09.649905 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_vendor_id.b9b2f380bb
[0m18:31:09.653847 [debug] [Thread-1  ]: Began running node test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab
[0m18:31:09.657080 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_vendor_id.b9b2f380bb, now test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab)
[0m18:31:09.660176 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab
[0m18:31:09.676353 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab"
[0m18:31:09.701158 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab
[0m18:31:09.705777 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab
[0m18:31:09.711210 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:31:09.714314 [debug] [MainThread]: Connection 'test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab' was properly closed.
[0m18:31:09.743280 [debug] [MainThread]: Command end result
[0m18:31:10.312549 [debug] [MainThread]: Acquiring new bigquery connection 'generate_catalog'
[0m18:31:10.316105 [info ] [MainThread]: Building catalog
[0m18:31:10.341343 [debug] [ThreadPool]: Acquiring new bigquery connection 'northern-shield-437204-m0.information_schema'
[0m18:31:10.418007 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:31:10.429227 [debug] [ThreadPool]: On northern-shield-437204-m0.information_schema: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "connection_name": "northern-shield-437204-m0.information_schema"} */

    with
                table_shards_stage as (
    select
        tables.project_id as table_catalog,
        tables.dataset_id as table_schema,
        coalesce(REGEXP_EXTRACT(tables.table_id, '^(.+)[0-9]{8}$'), tables.table_id) as table_name,
        tables.table_id as shard_name,
        REGEXP_EXTRACT(tables.table_id, '^.+([0-9]{8})$') as shard_index,
        REGEXP_CONTAINS(tables.table_id, '^.+[0-9]{8}$') and tables.type = 1 as is_date_shard,
        case
            when materialized_views.table_name is not null then 'materialized view'
            when tables.type = 1 then 'table'
            when tables.type = 2 then 'view'
            else 'external'
        end as table_type,
        tables.type = 1 as is_table,
        JSON_VALUE(table_description.option_value) as table_comment,
        tables.size_bytes,
        tables.row_count
    from `northern-shield-437204-m0`.`nyc_taxi`.__TABLES__ tables
    left join `northern-shield-437204-m0`.`nyc_taxi`.INFORMATION_SCHEMA.MATERIALIZED_VIEWS materialized_views
        on materialized_views.table_catalog = tables.project_id
        and materialized_views.table_schema = tables.dataset_id
        and materialized_views.table_name = tables.table_id
    left join `northern-shield-437204-m0`.`nyc_taxi`.INFORMATION_SCHEMA.TABLE_OPTIONS table_description
        on table_description.table_catalog = tables.project_id
        and table_description.table_schema = tables.dataset_id
        and table_description.table_name = tables.table_id
        and table_description.option_name = 'description'
),
                table_shards as (
                    select * from table_shards_stage
                    where ((
                                upper(table_schema) = upper('nyc_taxi')
                            and upper(table_name) = upper('dim_ratecode')
                            ) or (
                                upper(table_schema) = upper('nyc_taxi')
                            and upper(table_name) = upper('test_tip_amount_positive')
                            ) or (
                                upper(table_schema) = upper('nyc_taxi')
                            and upper(table_name) = upper('dim_vendor')
                            ) or (
                                upper(table_schema) = upper('nyc_taxi')
                            and upper(table_name) = upper('test_mta_tax_positive')
                            ) or (
                                upper(table_schema) = upper('nyc_taxi')
                            and upper(table_name) = upper('dim_payment')
                            ) or (
                                upper(table_schema) = upper('nyc_taxi')
                            and upper(table_name) = upper('test_total_amount_positive')
                            ) or (
                                upper(table_schema) = upper('nyc_taxi')
                            and upper(table_name) = upper('test_tolls_amount_positive')
                            ) or (
                                upper(table_schema) = upper('nyc_taxi')
                            and upper(table_name) = upper('test_fare_amount_positive')
                            ) or (
                                upper(table_schema) = upper('nyc_taxi')
                            and upper(table_name) = upper('dim_zone')
                            ) or (
                                upper(table_schema) = upper('nyc_taxi')
                            and upper(table_name) = upper('fct_trips')
                            ) or (
                                upper(table_schema) = upper('nyc_taxi')
                            and upper(table_name) = upper('zone_map')
                            ) or (
                                upper(table_schema) = upper('nyc_taxi')
                            and upper(table_name) = upper('green_tripdata')
                            ))
                ),
                tables as (
    select distinct
        table_catalog,
        table_schema,
        table_name,
        is_date_shard,
        table_type,
        is_table,
        table_comment
    from table_shards
),
                table_stats as (
    select
        table_catalog,
        table_schema,
        table_name,
        max(shard_name) as latest_shard_name,
        min(shard_index) as shard_min,
        max(shard_index) as shard_max,
        count(shard_index) as shard_count,
        sum(size_bytes) as size_bytes,
        sum(row_count) as row_count
    from table_shards
    group by 1, 2, 3
),

                columns as (
    select
        columns.table_catalog,
        columns.table_schema,
        columns.table_name as shard_name,
        coalesce(paths.field_path, '<unknown>') as column_name,
        -- invent a row number to account for nested fields
        -- BQ does not treat these nested properties as independent fields
        row_number() over (
            partition by
                columns.table_catalog,
                columns.table_schema,
                columns.table_name
            order by
                columns.ordinal_position,
                paths.field_path
        ) as column_index,
        coalesce(paths.data_type, '<unknown>') as column_type,
        paths.description as column_comment,
        case when columns.is_partitioning_column = 'YES' then 1 else 0 end as is_partitioning_column,
        case when columns.is_partitioning_column = 'YES' then paths.field_path end as partition_column,
        case when columns.clustering_ordinal_position is not null then 1 else 0 end as is_clustering_column,
        case when columns.clustering_ordinal_position is not null then paths.field_path end as cluster_column,
        columns.clustering_ordinal_position
    from `northern-shield-437204-m0`.`nyc_taxi`.INFORMATION_SCHEMA.COLUMNS columns
    join `northern-shield-437204-m0`.`nyc_taxi`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS paths
        on paths.table_catalog = columns.table_catalog
        and paths.table_schema = columns.table_schema
        and paths.table_name = columns.table_name
        and paths.column_name = columns.column_name
    where columns.ordinal_position is not null
),
                column_stats as (
    select
        table_catalog,
        table_schema,
        shard_name,
        max(is_partitioning_column) = 1 as is_partitioned,
        max(partition_column) as partition_column,
        max(is_clustering_column) = 1 as is_clustered,
        array_to_string(
            array_agg(
                cluster_column ignore nulls
                order by clustering_ordinal_position
            ), ', '
        ) as clustering_columns
    from columns
    group by 1, 2, 3
)

            
    select
        tables.table_catalog as table_database,
        tables.table_schema,
        case
            when tables.is_date_shard then concat(tables.table_name, '*')
            else tables.table_name
        end as table_name,
        tables.table_type,
        tables.table_comment,
        -- coalesce column metadata fields to ensure they are non-null for catalog generation
        -- external table columns are not present in COLUMN_FIELD_PATHS
        coalesce(columns.column_name, '<unknown>') as column_name,
        coalesce(columns.column_index, 1) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        coalesce(columns.column_comment, '') as column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_stats.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        tables.is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_stats.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        tables.is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_stats.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        tables.is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        table_stats.row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        tables.is_table as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        table_stats.size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        tables.is_table as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        column_stats.partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        column_stats.is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        column_stats.clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        column_stats.is_clustered as `stats__clustering_fields__include`

    from tables
    join table_stats
        on table_stats.table_catalog = tables.table_catalog
        and table_stats.table_schema = tables.table_schema
        and table_stats.table_name = tables.table_name
    left join column_stats
        on column_stats.table_catalog = tables.table_catalog
        and column_stats.table_schema = tables.table_schema
        and column_stats.shard_name = table_stats.latest_shard_name
    left join columns
        on columns.table_catalog = tables.table_catalog
        and columns.table_schema = tables.table_schema
        and columns.shard_name = table_stats.latest_shard_name

  
[0m18:31:11.414164 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:f8311069-93d6-471a-aa9e-c185602acf2e&page=queryresults
[0m18:31:14.090043 [info ] [MainThread]: Catalog written to /opt/airflow/include/dbt/target/catalog.json
[0m18:31:14.095868 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 15.193759, "process_in_blocks": "0", "process_kernel_time": 0.776709, "process_mem_max_rss": "230768", "process_out_blocks": "0", "process_user_time": 12.20681}
[0m18:31:14.100183 [debug] [MainThread]: Command `dbt docs generate` succeeded at 18:31:14.099702 after 15.20 seconds
[0m18:31:14.103126 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m18:31:14.105798 [debug] [MainThread]: Connection 'northern-shield-437204-m0.information_schema' was properly closed.
[0m18:31:14.108859 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80f013ec70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80ef8f1eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80b6b4f6d0>]}
[0m18:31:14.112116 [debug] [MainThread]: Flushing usage events
[0m18:31:40.546351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5dc33b3fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5dc26dc370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5dc12f9760>]}


============================== 18:31:40.564813 | c4929ccb-8e41-4d93-bc6c-4efec4aa99c2 ==============================
[0m18:31:40.564813 [info ] [MainThread]: Running with dbt=1.8.9
[0m18:31:40.568996 [debug] [MainThread]: running dbt with arguments {'empty': 'None', 'version_check': 'True', 'fail_fast': 'False', 'introspect': 'True', 'partial_parse': 'True', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'indirect_selection': 'eager', 'target_path': 'None', 'quiet': 'False', 'debug': 'False', 'profiles_dir': '/opt/airflow/include/dbt', 'warn_error': 'None', 'log_format': 'default', 'invocation_command': 'dbt docs serve --port 8081 --host 0.0.0.0', 'printer_width': '80', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'cache_selected_only': 'False', 'log_cache_events': 'False', 'log_path': '/opt/airflow/include/dbt/logs', 'write_json': 'True'}
[0m18:31:43.697900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c4929ccb-8e41-4d93-bc6c-4efec4aa99c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5dc2c6bc10>]}
[0m18:31:43.957499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c4929ccb-8e41-4d93-bc6c-4efec4aa99c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5dc26141f0>]}
[0m18:39:10.644421 [error] [MainThread]: Encountered an error:

[0m18:39:10.655242 [error] [MainThread]: Traceback (most recent call last):
  File "/opt/airflow/dbt_venv/lib/python3.9/site-packages/dbt/cli/requires.py", line 138, in wrapper
    result, success = func(*args, **kwargs)
  File "/opt/airflow/dbt_venv/lib/python3.9/site-packages/dbt/cli/requires.py", line 101, in wrapper
    return func(*args, **kwargs)
  File "/opt/airflow/dbt_venv/lib/python3.9/site-packages/dbt/cli/requires.py", line 218, in wrapper
    return func(*args, **kwargs)
  File "/opt/airflow/dbt_venv/lib/python3.9/site-packages/dbt/cli/requires.py", line 247, in wrapper
    return func(*args, **kwargs)
  File "/opt/airflow/dbt_venv/lib/python3.9/site-packages/dbt/cli/requires.py", line 294, in wrapper
    return func(*args, **kwargs)
  File "/opt/airflow/dbt_venv/lib/python3.9/site-packages/dbt/cli/main.py", line 303, in docs_serve
    results = task.run()
  File "/opt/airflow/dbt_venv/lib/python3.9/site-packages/dbt/task/docs/serve.py", line 29, in run
    httpd.serve_forever()
  File "/usr/local/lib/python3.9/socketserver.py", line 232, in serve_forever
    ready = selector.select(poll_interval)
  File "/usr/local/lib/python3.9/selectors.py", line 416, in select
    fd_event_list = self._selector.poll(timeout)
KeyboardInterrupt

[0m18:39:10.665012 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_success": false, "command_wall_clock_time": 481.06387, "process_in_blocks": "0", "process_kernel_time": 0.527418, "process_mem_max_rss": "230588", "process_out_blocks": "0", "process_user_time": 9.041457}
[0m18:39:10.672487 [debug] [MainThread]: Command `dbt docs serve` failed at 18:39:10.671463 after 481.07 seconds
[0m18:39:10.677230 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5dc33b3fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d89d14640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d89d147c0>]}
[0m18:39:10.681243 [debug] [MainThread]: Flushing usage events
[0m18:39:22.525814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37e9c4bd00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37e8e41cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37e7a8f970>]}


============================== 18:39:22.548722 | 98dcea84-5187-4f51-b5ae-2a1cf6dba5c4 ==============================
[0m18:39:22.548722 [info ] [MainThread]: Running with dbt=1.8.9
[0m18:39:22.553167 [debug] [MainThread]: running dbt with arguments {'quiet': 'False', 'printer_width': '80', 'empty': 'None', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'log_path': '/opt/airflow/include/dbt/logs', 'static_parser': 'True', 'no_print': 'None', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'debug': 'False', 'fail_fast': 'False', 'invocation_command': 'dbt docs serve --port 8082 --host 0.0.0.0', 'cache_selected_only': 'False', 'log_cache_events': 'False', 'introspect': 'True', 'indirect_selection': 'eager', 'use_colors': 'True', 'target_path': 'None', 'log_format': 'default', 'warn_error': 'None', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'profiles_dir': '/opt/airflow/include/dbt'}
[0m18:39:26.068898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '98dcea84-5187-4f51-b5ae-2a1cf6dba5c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37b53dc4f0>]}
[0m18:39:26.274341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '98dcea84-5187-4f51-b5ae-2a1cf6dba5c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37b4619220>]}
[0m18:45:47.077697 [error] [MainThread]: Encountered an error:

[0m18:45:47.087034 [error] [MainThread]: Traceback (most recent call last):
  File "/opt/airflow/dbt_venv/lib/python3.9/site-packages/dbt/cli/requires.py", line 138, in wrapper
    result, success = func(*args, **kwargs)
  File "/opt/airflow/dbt_venv/lib/python3.9/site-packages/dbt/cli/requires.py", line 101, in wrapper
    return func(*args, **kwargs)
  File "/opt/airflow/dbt_venv/lib/python3.9/site-packages/dbt/cli/requires.py", line 218, in wrapper
    return func(*args, **kwargs)
  File "/opt/airflow/dbt_venv/lib/python3.9/site-packages/dbt/cli/requires.py", line 247, in wrapper
    return func(*args, **kwargs)
  File "/opt/airflow/dbt_venv/lib/python3.9/site-packages/dbt/cli/requires.py", line 294, in wrapper
    return func(*args, **kwargs)
  File "/opt/airflow/dbt_venv/lib/python3.9/site-packages/dbt/cli/main.py", line 303, in docs_serve
    results = task.run()
  File "/opt/airflow/dbt_venv/lib/python3.9/site-packages/dbt/task/docs/serve.py", line 29, in run
    httpd.serve_forever()
  File "/usr/local/lib/python3.9/socketserver.py", line 232, in serve_forever
    ready = selector.select(poll_interval)
  File "/usr/local/lib/python3.9/selectors.py", line 416, in select
    fd_event_list = self._selector.poll(timeout)
KeyboardInterrupt

[0m18:45:47.097342 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_success": false, "command_wall_clock_time": 410.00015, "process_in_blocks": "0", "process_kernel_time": 0.653667, "process_mem_max_rss": "232728", "process_out_blocks": "0", "process_user_time": 9.861858}
[0m18:45:47.102266 [debug] [MainThread]: Command `dbt docs serve` failed at 18:45:47.101659 after 410.01 seconds
[0m18:45:47.106277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37e9c4bd00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37e7aae910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37b4470ac0>]}
[0m18:45:47.109927 [debug] [MainThread]: Flushing usage events
[0m18:45:58.626912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb0af48d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb08d95eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb08d95e50>]}


============================== 18:45:58.653166 | e7b8aa38-4654-4829-9288-6d093bf04e8e ==============================
[0m18:45:58.653166 [info ] [MainThread]: Running with dbt=1.8.9
[0m18:45:58.658169 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'empty': 'None', 'indirect_selection': 'eager', 'no_print': 'None', 'write_json': 'True', 'profiles_dir': '/opt/airflow/include/dbt', 'fail_fast': 'False', 'static_parser': 'True', 'quiet': 'False', 'warn_error': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True', 'printer_width': '80', 'invocation_command': 'dbt debug', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'version_check': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'log_cache_events': 'False', 'log_format': 'default', 'log_path': '/opt/airflow/include/dbt/logs'}
[0m18:45:58.683158 [info ] [MainThread]: dbt version: 1.8.9
[0m18:45:58.687212 [info ] [MainThread]: python version: 3.9.19
[0m18:45:58.690903 [info ] [MainThread]: python path: /opt/airflow/dbt_venv/bin/python
[0m18:45:58.696160 [info ] [MainThread]: os info: Linux-5.15.167.4-microsoft-standard-WSL2-x86_64-with-glibc2.36
[0m18:46:01.304578 [info ] [MainThread]: Using profiles dir at /opt/airflow/include/dbt
[0m18:46:01.307833 [info ] [MainThread]: Using profiles.yml file at /opt/airflow/include/dbt/profiles.yml
[0m18:46:01.310973 [info ] [MainThread]: Using dbt_project.yml file at /opt/airflow/include/dbt/dbt_project.yml
[0m18:46:01.314227 [info ] [MainThread]: adapter type: bigquery
[0m18:46:01.317763 [info ] [MainThread]: adapter version: 1.8.3
[0m18:46:01.627399 [info ] [MainThread]: Configuration:
[0m18:46:01.631273 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m18:46:01.634646 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m18:46:01.638520 [info ] [MainThread]: Required dependencies:
[0m18:46:01.642368 [debug] [MainThread]: Executing "git --help"
[0m18:46:01.669546 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m18:46:01.674407 [debug] [MainThread]: STDERR: "b''"
[0m18:46:01.677827 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m18:46:01.681014 [info ] [MainThread]: Connection:
[0m18:46:01.684490 [info ] [MainThread]:   method: service-account
[0m18:46:01.687769 [info ] [MainThread]:   database: northern-shield-437204-m0
[0m18:46:01.690778 [info ] [MainThread]:   execution_project: northern-shield-437204-m0
[0m18:46:01.693448 [info ] [MainThread]:   schema: nyc_taxi
[0m18:46:01.696346 [info ] [MainThread]:   location: us-central1
[0m18:46:01.699352 [info ] [MainThread]:   priority: None
[0m18:46:01.702406 [info ] [MainThread]:   maximum_bytes_billed: None
[0m18:46:01.706144 [info ] [MainThread]:   impersonate_service_account: None
[0m18:46:01.709478 [info ] [MainThread]:   job_retry_deadline_seconds: None
[0m18:46:01.712258 [info ] [MainThread]:   job_retries: 1
[0m18:46:01.715675 [info ] [MainThread]:   job_creation_timeout_seconds: None
[0m18:46:01.719307 [info ] [MainThread]:   job_execution_timeout_seconds: 300
[0m18:46:01.723561 [info ] [MainThread]:   timeout_seconds: 300
[0m18:46:01.726912 [info ] [MainThread]:   client_id: None
[0m18:46:01.729894 [info ] [MainThread]:   token_uri: None
[0m18:46:01.732542 [info ] [MainThread]:   dataproc_region: None
[0m18:46:01.735674 [info ] [MainThread]:   dataproc_cluster_name: None
[0m18:46:01.741048 [info ] [MainThread]:   gcs_bucket: None
[0m18:46:01.744555 [info ] [MainThread]:   dataproc_batch: None
[0m18:46:01.748676 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m18:46:02.148386 [debug] [MainThread]: Acquiring new bigquery connection 'debug'
[0m18:46:02.152430 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:46:02.165196 [debug] [MainThread]: On debug: select 1 as id
[0m18:46:03.022548 [debug] [MainThread]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:0efdc146-7150-41a4-9b2e-2e303e5c66f1&page=queryresults
[0m18:46:03.812525 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m18:46:03.816677 [info ] [MainThread]: [32mAll checks passed![0m
[0m18:46:03.821882 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 5.39923, "process_in_blocks": "0", "process_kernel_time": 0.706074, "process_mem_max_rss": "224104", "process_out_blocks": "0", "process_user_time": 8.98552}
[0m18:46:03.826054 [debug] [MainThread]: Command `dbt debug` succeeded at 18:46:03.825531 after 5.40 seconds
[0m18:46:03.829640 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m18:46:03.833258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb0af48d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbad18aec40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb0a0af070>]}
[0m18:46:03.836821 [debug] [MainThread]: Flushing usage events
[0m18:51:22.044549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb70b1cac40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb708fd4d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb708fd4fd0>]}


============================== 18:51:22.063162 | 891ad365-a7e1-47ca-bbcb-6832dcda07a9 ==============================
[0m18:51:22.063162 [info ] [MainThread]: Running with dbt=1.8.9
[0m18:51:22.067352 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'debug': 'False', 'no_print': 'None', 'use_experimental_parser': 'False', 'log_path': '/opt/airflow/include/dbt/logs', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'log_format': 'default', 'quiet': 'False', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt docs generate', 'fail_fast': 'False', 'printer_width': '80', 'empty': 'None', 'partial_parse': 'True', 'static_parser': 'True', 'write_json': 'True', 'introspect': 'True', 'profiles_dir': '/opt/airflow/include/dbt', 'target_path': 'None', 'log_cache_events': 'False', 'warn_error': 'None', 'indirect_selection': 'eager'}
[0m18:51:24.974944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '891ad365-a7e1-47ca-bbcb-6832dcda07a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb70a97d640>]}
[0m18:51:25.143905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '891ad365-a7e1-47ca-bbcb-6832dcda07a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb70b50bee0>]}
[0m18:51:25.148159 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m18:51:25.630269 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m18:51:29.153170 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:51:29.156760 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:51:29.333705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '891ad365-a7e1-47ca-bbcb-6832dcda07a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb704227130>]}
[0m18:51:29.387599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '891ad365-a7e1-47ca-bbcb-6832dcda07a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7041ca640>]}
[0m18:51:29.391548 [info ] [MainThread]: Found 10 models, 23 data tests, 2 sources, 600 macros
[0m18:51:29.395086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '891ad365-a7e1-47ca-bbcb-6832dcda07a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7041ca670>]}
[0m18:51:29.405194 [info ] [MainThread]: 
[0m18:51:29.409080 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:51:29.431798 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_northern-shield-437204-m0_nyc_taxi'
[0m18:51:29.435540 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:51:30.123713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '891ad365-a7e1-47ca-bbcb-6832dcda07a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb70b1b52b0>]}
[0m18:51:30.127573 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:51:30.131183 [info ] [MainThread]: 
[0m18:51:30.151956 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_payment
[0m18:51:30.156225 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_northern-shield-437204-m0_nyc_taxi, now model.nyc_taxi.dim_payment)
[0m18:51:30.159851 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_payment
[0m18:51:30.196114 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_payment"
[0m18:51:30.222189 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_payment
[0m18:51:30.227785 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_payment
[0m18:51:30.235048 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_ratecode
[0m18:51:30.238793 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_payment, now model.nyc_taxi.dim_ratecode)
[0m18:51:30.242566 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_ratecode
[0m18:51:29.758254 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_ratecode"
[0m18:51:29.781445 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_ratecode
[0m18:51:29.786658 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_ratecode
[0m18:51:29.790571 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_vendor
[0m18:51:29.794398 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_ratecode, now model.nyc_taxi.dim_vendor)
[0m18:51:29.797892 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_vendor
[0m18:51:29.810587 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_vendor"
[0m18:51:29.834644 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_vendor
[0m18:51:29.839266 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_vendor
[0m18:51:29.843007 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_zone
[0m18:51:29.846743 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_vendor, now model.nyc_taxi.dim_zone)
[0m18:51:29.850161 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_zone
[0m18:51:29.861668 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_zone"
[0m18:51:29.885850 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_zone
[0m18:51:29.891723 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_zone
[0m18:51:29.895651 [debug] [Thread-1  ]: Began running node model.nyc_taxi.fct_trips
[0m18:51:29.899731 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_zone, now model.nyc_taxi.fct_trips)
[0m18:51:29.903261 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.fct_trips
[0m18:51:29.957407 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.fct_trips"
[0m18:51:29.981052 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.fct_trips
[0m18:51:29.985868 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.fct_trips
[0m18:51:29.989683 [debug] [Thread-1  ]: Began running node test.nyc_taxi.accepted_values_dim_payment_payment_name__Credit_card__Cash__No_charge__Dispute__Unknown__Voided_trip.58d00ef9f4
[0m18:51:29.994711 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.fct_trips, now test.nyc_taxi.accepted_values_dim_payment_payment_name__Credit_card__Cash__No_charge__Dispute__Unknown__Voided_trip.58d00ef9f4)
[0m18:51:28.746917 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.accepted_values_dim_payment_payment_name__Credit_card__Cash__No_charge__Dispute__Unknown__Voided_trip.58d00ef9f4
[0m18:51:28.811886 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.accepted_values_dim_payment_payment_name__Credit_card__Cash__No_charge__Dispute__Unknown__Voided_trip.58d00ef9f4"
[0m18:51:28.834107 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.accepted_values_dim_payment_payment_name__Credit_card__Cash__No_charge__Dispute__Unknown__Voided_trip.58d00ef9f4
[0m18:51:28.838530 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.accepted_values_dim_payment_payment_name__Credit_card__Cash__No_charge__Dispute__Unknown__Voided_trip.58d00ef9f4
[0m18:51:28.842558 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_dim_payment_type_id.96dfa722aa
[0m18:51:28.845678 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.accepted_values_dim_payment_payment_name__Credit_card__Cash__No_charge__Dispute__Unknown__Voided_trip.58d00ef9f4, now test.nyc_taxi.not_null_dim_payment_type_id.96dfa722aa)
[0m18:51:28.848821 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_dim_payment_type_id.96dfa722aa
[0m18:51:28.878298 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_dim_payment_type_id.96dfa722aa"
[0m18:51:28.904396 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_dim_payment_type_id.96dfa722aa
[0m18:51:28.909047 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_dim_payment_type_id.96dfa722aa
[0m18:51:28.913059 [debug] [Thread-1  ]: Began running node test.nyc_taxi.unique_dim_payment_type_id.dea55de04e
[0m18:51:28.916670 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_dim_payment_type_id.96dfa722aa, now test.nyc_taxi.unique_dim_payment_type_id.dea55de04e)
[0m18:51:28.919901 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.unique_dim_payment_type_id.dea55de04e
[0m18:51:28.942168 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.unique_dim_payment_type_id.dea55de04e"
[0m18:51:28.970606 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.unique_dim_payment_type_id.dea55de04e
[0m18:51:28.976091 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.unique_dim_payment_type_id.dea55de04e
[0m18:51:28.980655 [debug] [Thread-1  ]: Began running node test.nyc_taxi.accepted_values_dim_ratecode_rate_code_name__Standard_rate__JFK__Newark__Nassau_or_Westchester__Negotiated_fare__Group_ride__Unknown.57ee02019f
[0m18:51:28.985139 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.unique_dim_payment_type_id.dea55de04e, now test.nyc_taxi.accepted_values_dim_ratecode_rate_code_name__Standard_rate__JFK__Newark__Nassau_or_Westchester__Negotiated_fare__Group_ride__Unknown.57ee02019f)
[0m18:51:28.989017 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.accepted_values_dim_ratecode_rate_code_name__Standard_rate__JFK__Newark__Nassau_or_Westchester__Negotiated_fare__Group_ride__Unknown.57ee02019f
[0m18:51:29.015856 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.accepted_values_dim_ratecode_rate_code_name__Standard_rate__JFK__Newark__Nassau_or_Westchester__Negotiated_fare__Group_ride__Unknown.57ee02019f"
[0m18:51:29.045064 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.accepted_values_dim_ratecode_rate_code_name__Standard_rate__JFK__Newark__Nassau_or_Westchester__Negotiated_fare__Group_ride__Unknown.57ee02019f
[0m18:51:29.049935 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.accepted_values_dim_ratecode_rate_code_name__Standard_rate__JFK__Newark__Nassau_or_Westchester__Negotiated_fare__Group_ride__Unknown.57ee02019f
[0m18:51:29.053682 [debug] [Thread-1  ]: Began running node test.nyc_taxi.unique_dim_ratecode_rate_id.75ae8e4885
[0m18:51:29.057207 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.accepted_values_dim_ratecode_rate_code_name__Standard_rate__JFK__Newark__Nassau_or_Westchester__Negotiated_fare__Group_ride__Unknown.57ee02019f, now test.nyc_taxi.unique_dim_ratecode_rate_id.75ae8e4885)
[0m18:51:29.060601 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.unique_dim_ratecode_rate_id.75ae8e4885
[0m18:51:29.076614 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.unique_dim_ratecode_rate_id.75ae8e4885"
[0m18:51:29.103085 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.unique_dim_ratecode_rate_id.75ae8e4885
[0m18:51:29.108161 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.unique_dim_ratecode_rate_id.75ae8e4885
[0m18:51:29.112222 [debug] [Thread-1  ]: Began running node test.nyc_taxi.accepted_values_dim_vendor_vendor_name__Creative_Mobile_Technologies__VeriFone_Inc_.7481cecf07
[0m18:51:29.116090 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.unique_dim_ratecode_rate_id.75ae8e4885, now test.nyc_taxi.accepted_values_dim_vendor_vendor_name__Creative_Mobile_Technologies__VeriFone_Inc_.7481cecf07)
[0m18:51:29.119309 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.accepted_values_dim_vendor_vendor_name__Creative_Mobile_Technologies__VeriFone_Inc_.7481cecf07
[0m18:51:29.139915 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.accepted_values_dim_vendor_vendor_name__Creative_Mobile_Technologies__VeriFone_Inc_.7481cecf07"
[0m18:51:29.169511 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.accepted_values_dim_vendor_vendor_name__Creative_Mobile_Technologies__VeriFone_Inc_.7481cecf07
[0m18:51:29.174299 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.accepted_values_dim_vendor_vendor_name__Creative_Mobile_Technologies__VeriFone_Inc_.7481cecf07
[0m18:51:29.182260 [debug] [Thread-1  ]: Began running node test.nyc_taxi.unique_dim_vendor_id.03fad38d04
[0m18:51:29.185944 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.accepted_values_dim_vendor_vendor_name__Creative_Mobile_Technologies__VeriFone_Inc_.7481cecf07, now test.nyc_taxi.unique_dim_vendor_id.03fad38d04)
[0m18:51:29.189647 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.unique_dim_vendor_id.03fad38d04
[0m18:51:29.205373 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.unique_dim_vendor_id.03fad38d04"
[0m18:51:29.234582 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.unique_dim_vendor_id.03fad38d04
[0m18:51:29.239735 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.unique_dim_vendor_id.03fad38d04
[0m18:51:29.243625 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_dim_zone_borough.1ed2272c52
[0m18:51:29.247744 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.unique_dim_vendor_id.03fad38d04, now test.nyc_taxi.not_null_dim_zone_borough.1ed2272c52)
[0m18:51:29.251613 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_dim_zone_borough.1ed2272c52
[0m18:51:29.268548 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_dim_zone_borough.1ed2272c52"
[0m18:51:29.297410 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_dim_zone_borough.1ed2272c52
[0m18:51:29.302658 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_dim_zone_borough.1ed2272c52
[0m18:51:29.306884 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_dim_zone_service_zone.2007f611c5
[0m18:51:29.310413 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_dim_zone_borough.1ed2272c52, now test.nyc_taxi.not_null_dim_zone_service_zone.2007f611c5)
[0m18:51:29.314116 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_dim_zone_service_zone.2007f611c5
[0m18:51:29.330731 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_dim_zone_service_zone.2007f611c5"
[0m18:51:29.358434 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_dim_zone_service_zone.2007f611c5
[0m18:51:29.363742 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_dim_zone_service_zone.2007f611c5
[0m18:51:29.367429 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_dim_zone_zone.a1c4a4c37a
[0m18:51:29.371051 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_dim_zone_service_zone.2007f611c5, now test.nyc_taxi.not_null_dim_zone_zone.a1c4a4c37a)
[0m18:51:29.375012 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_dim_zone_zone.a1c4a4c37a
[0m18:51:29.391661 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_dim_zone_zone.a1c4a4c37a"
[0m18:51:29.417918 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_dim_zone_zone.a1c4a4c37a
[0m18:51:29.422722 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_dim_zone_zone.a1c4a4c37a
[0m18:51:29.426611 [debug] [Thread-1  ]: Began running node test.nyc_taxi.unique_dim_zone_location_id.7702f92424
[0m18:51:29.430533 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_dim_zone_zone.a1c4a4c37a, now test.nyc_taxi.unique_dim_zone_location_id.7702f92424)
[0m18:51:29.433952 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.unique_dim_zone_location_id.7702f92424
[0m18:51:29.450783 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.unique_dim_zone_location_id.7702f92424"
[0m18:51:29.478986 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.unique_dim_zone_location_id.7702f92424
[0m18:51:29.483636 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.unique_dim_zone_location_id.7702f92424
[0m18:51:29.487959 [debug] [Thread-1  ]: Began running node model.nyc_taxi.test_fare_amount_positive
[0m18:51:29.492176 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.unique_dim_zone_location_id.7702f92424, now model.nyc_taxi.test_fare_amount_positive)
[0m18:51:29.495683 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.test_fare_amount_positive
[0m18:51:29.510950 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.test_fare_amount_positive"
[0m18:51:29.602747 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.test_fare_amount_positive
[0m18:51:29.608189 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.test_fare_amount_positive
[0m18:51:29.616438 [debug] [Thread-1  ]: Began running node model.nyc_taxi.test_mta_tax_positive
[0m18:51:29.619920 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.test_fare_amount_positive, now model.nyc_taxi.test_mta_tax_positive)
[0m18:51:29.623088 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.test_mta_tax_positive
[0m18:51:29.634542 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.test_mta_tax_positive"
[0m18:51:29.653746 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.test_mta_tax_positive
[0m18:51:29.658749 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.test_mta_tax_positive
[0m18:51:29.662449 [debug] [Thread-1  ]: Began running node model.nyc_taxi.test_tip_amount_positive
[0m18:51:29.665949 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.test_mta_tax_positive, now model.nyc_taxi.test_tip_amount_positive)
[0m18:51:29.669467 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.test_tip_amount_positive
[0m18:51:29.681739 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.test_tip_amount_positive"
[0m18:51:29.708192 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.test_tip_amount_positive
[0m18:51:29.713269 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.test_tip_amount_positive
[0m18:51:29.717315 [debug] [Thread-1  ]: Began running node model.nyc_taxi.test_tolls_amount_positive
[0m18:51:29.720998 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.test_tip_amount_positive, now model.nyc_taxi.test_tolls_amount_positive)
[0m18:51:29.724558 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.test_tolls_amount_positive
[0m18:51:29.736437 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.test_tolls_amount_positive"
[0m18:51:29.764950 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.test_tolls_amount_positive
[0m18:51:29.770048 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.test_tolls_amount_positive
[0m18:51:29.774027 [debug] [Thread-1  ]: Began running node model.nyc_taxi.test_total_amount_positive
[0m18:51:29.777852 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.test_tolls_amount_positive, now model.nyc_taxi.test_total_amount_positive)
[0m18:51:29.781287 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.test_total_amount_positive
[0m18:51:29.792641 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.test_total_amount_positive"
[0m18:51:29.819204 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.test_total_amount_positive
[0m18:51:29.824245 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.test_total_amount_positive
[0m18:51:29.828270 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_do_location_id.6acdd302a6
[0m18:51:29.831996 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.test_total_amount_positive, now test.nyc_taxi.not_null_fct_trips_do_location_id.6acdd302a6)
[0m18:51:29.835746 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_do_location_id.6acdd302a6
[0m18:51:29.851639 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_do_location_id.6acdd302a6"
[0m18:51:29.883015 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_do_location_id.6acdd302a6
[0m18:51:29.887972 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_do_location_id.6acdd302a6
[0m18:51:29.891819 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_dropoff_time.04b71dc609
[0m18:51:29.895690 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_do_location_id.6acdd302a6, now test.nyc_taxi.not_null_fct_trips_dropoff_time.04b71dc609)
[0m18:51:29.899251 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_dropoff_time.04b71dc609
[0m18:51:29.918861 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_dropoff_time.04b71dc609"
[0m18:51:29.948737 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_dropoff_time.04b71dc609
[0m18:51:29.953866 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_dropoff_time.04b71dc609
[0m18:51:29.957864 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_extra.1801055bb3
[0m18:51:29.961671 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_dropoff_time.04b71dc609, now test.nyc_taxi.not_null_fct_trips_extra.1801055bb3)
[0m18:51:29.964919 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_extra.1801055bb3
[0m18:51:29.980915 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_extra.1801055bb3"
[0m18:51:30.007280 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_extra.1801055bb3
[0m18:51:30.012082 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_extra.1801055bb3
[0m18:51:30.015811 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_improvement_surcharge.4cf28d1443
[0m18:51:30.019698 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_extra.1801055bb3, now test.nyc_taxi.not_null_fct_trips_improvement_surcharge.4cf28d1443)
[0m18:51:30.023251 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_improvement_surcharge.4cf28d1443
[0m18:51:30.041352 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_improvement_surcharge.4cf28d1443"
[0m18:51:30.068616 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_improvement_surcharge.4cf28d1443
[0m18:51:30.073664 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_improvement_surcharge.4cf28d1443
[0m18:51:30.077683 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_passenger_count.b1370cab1c
[0m18:51:30.081752 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_improvement_surcharge.4cf28d1443, now test.nyc_taxi.not_null_fct_trips_passenger_count.b1370cab1c)
[0m18:51:30.085236 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_passenger_count.b1370cab1c
[0m18:51:30.101499 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_passenger_count.b1370cab1c"
[0m18:51:30.129180 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_passenger_count.b1370cab1c
[0m18:51:30.134134 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_passenger_count.b1370cab1c
[0m18:51:30.138029 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_payment_type.93889b679a
[0m18:51:30.141625 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_passenger_count.b1370cab1c, now test.nyc_taxi.not_null_fct_trips_payment_type.93889b679a)
[0m18:51:30.144826 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_payment_type.93889b679a
[0m18:51:30.164366 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_payment_type.93889b679a"
[0m18:51:30.193630 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_payment_type.93889b679a
[0m18:51:30.198358 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_payment_type.93889b679a
[0m18:51:30.202431 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_pickup_time.693af2bf31
[0m18:51:30.206276 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_payment_type.93889b679a, now test.nyc_taxi.not_null_fct_trips_pickup_time.693af2bf31)
[0m18:51:30.209856 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_pickup_time.693af2bf31
[0m18:51:30.228925 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_pickup_time.693af2bf31"
[0m18:51:30.259788 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_pickup_time.693af2bf31
[0m18:51:30.264675 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_pickup_time.693af2bf31
[0m18:51:30.268917 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_pu_location_id.b0dc8dd185
[0m18:51:30.272607 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_pickup_time.693af2bf31, now test.nyc_taxi.not_null_fct_trips_pu_location_id.b0dc8dd185)
[0m18:51:30.276221 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_pu_location_id.b0dc8dd185
[0m18:51:30.299868 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_pu_location_id.b0dc8dd185"
[0m18:51:30.330845 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_pu_location_id.b0dc8dd185
[0m18:51:30.336832 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_pu_location_id.b0dc8dd185
[0m18:51:30.340945 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_rate_code_id.ba0047eaae
[0m18:51:30.344686 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_pu_location_id.b0dc8dd185, now test.nyc_taxi.not_null_fct_trips_rate_code_id.ba0047eaae)
[0m18:51:30.348328 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_rate_code_id.ba0047eaae
[0m18:51:30.365106 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_rate_code_id.ba0047eaae"
[0m18:51:30.393573 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_rate_code_id.ba0047eaae
[0m18:51:30.399259 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_rate_code_id.ba0047eaae
[0m18:51:30.404127 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_trip_distance.19cd17f1df
[0m18:51:30.407974 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_rate_code_id.ba0047eaae, now test.nyc_taxi.not_null_fct_trips_trip_distance.19cd17f1df)
[0m18:51:30.411628 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_trip_distance.19cd17f1df
[0m18:51:30.428346 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_trip_distance.19cd17f1df"
[0m18:51:30.456569 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_trip_distance.19cd17f1df
[0m18:51:30.462838 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_trip_distance.19cd17f1df
[0m18:51:30.467071 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_vendor_id.b9b2f380bb
[0m18:51:30.471210 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_trip_distance.19cd17f1df, now test.nyc_taxi.not_null_fct_trips_vendor_id.b9b2f380bb)
[0m18:51:30.474346 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_vendor_id.b9b2f380bb
[0m18:51:30.490911 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_vendor_id.b9b2f380bb"
[0m18:51:30.515396 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_vendor_id.b9b2f380bb
[0m18:51:30.520084 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_vendor_id.b9b2f380bb
[0m18:51:30.523186 [debug] [Thread-1  ]: Began running node test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab
[0m18:51:30.526609 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_vendor_id.b9b2f380bb, now test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab)
[0m18:51:30.530039 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab
[0m18:51:30.546465 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab"
[0m18:51:30.574037 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab
[0m18:51:30.579535 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab
[0m18:51:30.585932 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:51:30.588808 [debug] [MainThread]: Connection 'test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab' was properly closed.
[0m18:51:30.617649 [debug] [MainThread]: Command end result
[0m18:51:31.189456 [debug] [MainThread]: Acquiring new bigquery connection 'generate_catalog'
[0m18:51:31.192288 [info ] [MainThread]: Building catalog
[0m18:51:31.220131 [debug] [ThreadPool]: Acquiring new bigquery connection 'northern-shield-437204-m0.information_schema'
[0m18:51:31.323257 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:51:31.333448 [debug] [ThreadPool]: On northern-shield-437204-m0.information_schema: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "connection_name": "northern-shield-437204-m0.information_schema"} */

    with
                table_shards_stage as (
    select
        tables.project_id as table_catalog,
        tables.dataset_id as table_schema,
        coalesce(REGEXP_EXTRACT(tables.table_id, '^(.+)[0-9]{8}$'), tables.table_id) as table_name,
        tables.table_id as shard_name,
        REGEXP_EXTRACT(tables.table_id, '^.+([0-9]{8})$') as shard_index,
        REGEXP_CONTAINS(tables.table_id, '^.+[0-9]{8}$') and tables.type = 1 as is_date_shard,
        case
            when materialized_views.table_name is not null then 'materialized view'
            when tables.type = 1 then 'table'
            when tables.type = 2 then 'view'
            else 'external'
        end as table_type,
        tables.type = 1 as is_table,
        JSON_VALUE(table_description.option_value) as table_comment,
        tables.size_bytes,
        tables.row_count
    from `northern-shield-437204-m0`.`nyc_taxi`.__TABLES__ tables
    left join `northern-shield-437204-m0`.`nyc_taxi`.INFORMATION_SCHEMA.MATERIALIZED_VIEWS materialized_views
        on materialized_views.table_catalog = tables.project_id
        and materialized_views.table_schema = tables.dataset_id
        and materialized_views.table_name = tables.table_id
    left join `northern-shield-437204-m0`.`nyc_taxi`.INFORMATION_SCHEMA.TABLE_OPTIONS table_description
        on table_description.table_catalog = tables.project_id
        and table_description.table_schema = tables.dataset_id
        and table_description.table_name = tables.table_id
        and table_description.option_name = 'description'
),
                table_shards as (
                    select * from table_shards_stage
                    where ((
                                upper(table_schema) = upper('nyc_taxi')
                            and upper(table_name) = upper('test_fare_amount_positive')
                            ) or (
                                upper(table_schema) = upper('nyc_taxi')
                            and upper(table_name) = upper('test_mta_tax_positive')
                            ) or (
                                upper(table_schema) = upper('nyc_taxi')
                            and upper(table_name) = upper('dim_vendor')
                            ) or (
                                upper(table_schema) = upper('nyc_taxi')
                            and upper(table_name) = upper('dim_payment')
                            ) or (
                                upper(table_schema) = upper('nyc_taxi')
                            and upper(table_name) = upper('test_tip_amount_positive')
                            ) or (
                                upper(table_schema) = upper('nyc_taxi')
                            and upper(table_name) = upper('dim_zone')
                            ) or (
                                upper(table_schema) = upper('nyc_taxi')
                            and upper(table_name) = upper('zone_map')
                            ) or (
                                upper(table_schema) = upper('nyc_taxi')
                            and upper(table_name) = upper('green_tripdata')
                            ) or (
                                upper(table_schema) = upper('nyc_taxi')
                            and upper(table_name) = upper('fct_trips')
                            ) or (
                                upper(table_schema) = upper('nyc_taxi')
                            and upper(table_name) = upper('dim_ratecode')
                            ) or (
                                upper(table_schema) = upper('nyc_taxi')
                            and upper(table_name) = upper('test_tolls_amount_positive')
                            ) or (
                                upper(table_schema) = upper('nyc_taxi')
                            and upper(table_name) = upper('test_total_amount_positive')
                            ))
                ),
                tables as (
    select distinct
        table_catalog,
        table_schema,
        table_name,
        is_date_shard,
        table_type,
        is_table,
        table_comment
    from table_shards
),
                table_stats as (
    select
        table_catalog,
        table_schema,
        table_name,
        max(shard_name) as latest_shard_name,
        min(shard_index) as shard_min,
        max(shard_index) as shard_max,
        count(shard_index) as shard_count,
        sum(size_bytes) as size_bytes,
        sum(row_count) as row_count
    from table_shards
    group by 1, 2, 3
),

                columns as (
    select
        columns.table_catalog,
        columns.table_schema,
        columns.table_name as shard_name,
        coalesce(paths.field_path, '<unknown>') as column_name,
        -- invent a row number to account for nested fields
        -- BQ does not treat these nested properties as independent fields
        row_number() over (
            partition by
                columns.table_catalog,
                columns.table_schema,
                columns.table_name
            order by
                columns.ordinal_position,
                paths.field_path
        ) as column_index,
        coalesce(paths.data_type, '<unknown>') as column_type,
        paths.description as column_comment,
        case when columns.is_partitioning_column = 'YES' then 1 else 0 end as is_partitioning_column,
        case when columns.is_partitioning_column = 'YES' then paths.field_path end as partition_column,
        case when columns.clustering_ordinal_position is not null then 1 else 0 end as is_clustering_column,
        case when columns.clustering_ordinal_position is not null then paths.field_path end as cluster_column,
        columns.clustering_ordinal_position
    from `northern-shield-437204-m0`.`nyc_taxi`.INFORMATION_SCHEMA.COLUMNS columns
    join `northern-shield-437204-m0`.`nyc_taxi`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS paths
        on paths.table_catalog = columns.table_catalog
        and paths.table_schema = columns.table_schema
        and paths.table_name = columns.table_name
        and paths.column_name = columns.column_name
    where columns.ordinal_position is not null
),
                column_stats as (
    select
        table_catalog,
        table_schema,
        shard_name,
        max(is_partitioning_column) = 1 as is_partitioned,
        max(partition_column) as partition_column,
        max(is_clustering_column) = 1 as is_clustered,
        array_to_string(
            array_agg(
                cluster_column ignore nulls
                order by clustering_ordinal_position
            ), ', '
        ) as clustering_columns
    from columns
    group by 1, 2, 3
)

            
    select
        tables.table_catalog as table_database,
        tables.table_schema,
        case
            when tables.is_date_shard then concat(tables.table_name, '*')
            else tables.table_name
        end as table_name,
        tables.table_type,
        tables.table_comment,
        -- coalesce column metadata fields to ensure they are non-null for catalog generation
        -- external table columns are not present in COLUMN_FIELD_PATHS
        coalesce(columns.column_name, '<unknown>') as column_name,
        coalesce(columns.column_index, 1) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        coalesce(columns.column_comment, '') as column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_stats.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        tables.is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_stats.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        tables.is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_stats.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        tables.is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        table_stats.row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        tables.is_table as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        table_stats.size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        tables.is_table as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        column_stats.partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        column_stats.is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        column_stats.clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        column_stats.is_clustered as `stats__clustering_fields__include`

    from tables
    join table_stats
        on table_stats.table_catalog = tables.table_catalog
        and table_stats.table_schema = tables.table_schema
        and table_stats.table_name = tables.table_name
    left join column_stats
        on column_stats.table_catalog = tables.table_catalog
        and column_stats.table_schema = tables.table_schema
        and column_stats.shard_name = table_stats.latest_shard_name
    left join columns
        on columns.table_catalog = tables.table_catalog
        and columns.table_schema = tables.table_schema
        and columns.shard_name = table_stats.latest_shard_name

  
[0m18:51:32.171632 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:d5821c34-408e-41b6-9d1b-cf10a199cf4e&page=queryresults
[0m18:51:35.172345 [info ] [MainThread]: Catalog written to /opt/airflow/include/dbt/target/catalog.json
[0m18:51:35.178195 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 15.27839, "process_in_blocks": "0", "process_kernel_time": 0.986865, "process_mem_max_rss": "232456", "process_out_blocks": "0", "process_user_time": 12.051146}
[0m18:51:35.182962 [debug] [MainThread]: Command `dbt docs generate` succeeded at 18:51:35.182360 after 15.28 seconds
[0m18:51:35.186959 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m18:51:35.190104 [debug] [MainThread]: Connection 'northern-shield-437204-m0.information_schema' was properly closed.
[0m18:51:35.193586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb70b1cac40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb70a371c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7044b5130>]}
[0m18:51:35.197275 [debug] [MainThread]: Flushing usage events
[0m18:51:55.330455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa210be3ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa20ea32fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa20ea32f40>]}


============================== 18:51:55.351391 | a4ecf79f-3778-491f-bb2a-6b4d4650cc46 ==============================
[0m18:51:55.351391 [info ] [MainThread]: Running with dbt=1.8.9
[0m18:51:55.355879 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'send_anonymous_usage_stats': 'True', 'log_path': '/opt/airflow/include/dbt/logs', 'target_path': 'None', 'warn_error': 'None', 'quiet': 'False', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'no_print': 'None', 'use_colors': 'True', 'log_cache_events': 'False', 'version_check': 'True', 'fail_fast': 'False', 'invocation_command': 'dbt docs serve', 'profiles_dir': '/opt/airflow/include/dbt', 'cache_selected_only': 'False', 'indirect_selection': 'eager', 'debug': 'False', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'static_parser': 'True', 'log_format': 'default', 'write_json': 'True'}
[0m18:51:56.940835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a4ecf79f-3778-491f-bb2a-6b4d4650cc46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1dc2cd0a0>]}
[0m18:51:57.140048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a4ecf79f-3778-491f-bb2a-6b4d4650cc46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1d751a9a0>]}
[0m18:52:23.261934 [error] [MainThread]: Encountered an error:

[0m18:52:23.269453 [error] [MainThread]: Traceback (most recent call last):
  File "/opt/airflow/dbt_venv/lib/python3.9/site-packages/dbt/cli/requires.py", line 138, in wrapper
    result, success = func(*args, **kwargs)
  File "/opt/airflow/dbt_venv/lib/python3.9/site-packages/dbt/cli/requires.py", line 101, in wrapper
    return func(*args, **kwargs)
  File "/opt/airflow/dbt_venv/lib/python3.9/site-packages/dbt/cli/requires.py", line 218, in wrapper
    return func(*args, **kwargs)
  File "/opt/airflow/dbt_venv/lib/python3.9/site-packages/dbt/cli/requires.py", line 247, in wrapper
    return func(*args, **kwargs)
  File "/opt/airflow/dbt_venv/lib/python3.9/site-packages/dbt/cli/requires.py", line 294, in wrapper
    return func(*args, **kwargs)
  File "/opt/airflow/dbt_venv/lib/python3.9/site-packages/dbt/cli/main.py", line 303, in docs_serve
    results = task.run()
  File "/opt/airflow/dbt_venv/lib/python3.9/site-packages/dbt/task/docs/serve.py", line 29, in run
    httpd.serve_forever()
  File "/usr/local/lib/python3.9/socketserver.py", line 232, in serve_forever
    ready = selector.select(poll_interval)
  File "/usr/local/lib/python3.9/selectors.py", line 416, in select
    fd_event_list = self._selector.poll(timeout)
KeyboardInterrupt

[0m18:52:23.276013 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_success": false, "command_wall_clock_time": 30.167982, "process_in_blocks": "0", "process_kernel_time": 0.660758, "process_mem_max_rss": "232408", "process_out_blocks": "0", "process_user_time": 9.77922}
[0m18:52:23.282080 [debug] [MainThread]: Command `dbt docs serve` failed at 18:52:23.281310 after 30.17 seconds
[0m18:52:23.286422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa210be3ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1d747c8e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1d747c580>]}
[0m18:52:23.290388 [debug] [MainThread]: Flushing usage events
[0m18:52:42.568916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0420598ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f041e3a3d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f041e3a3fd0>]}


============================== 18:52:42.587234 | 7d2e5bd7-ed4b-4b85-bafb-6e7f52e8ee93 ==============================
[0m18:52:42.587234 [info ] [MainThread]: Running with dbt=1.8.9
[0m18:52:42.591308 [debug] [MainThread]: running dbt with arguments {'use_experimental_parser': 'False', 'write_json': 'True', 'indirect_selection': 'eager', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'profiles_dir': '/opt/airflow/include/dbt', 'debug': 'False', 'cache_selected_only': 'False', 'introspect': 'True', 'log_cache_events': 'False', 'printer_width': '80', 'version_check': 'True', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True', 'invocation_command': 'dbt docs serve --port 8082 --host 0.0.0.0', 'fail_fast': 'False', 'quiet': 'False', 'log_format': 'default', 'partial_parse': 'True', 'no_print': 'None', 'target_path': 'None', 'static_parser': 'True', 'empty': 'None', 'log_path': '/opt/airflow/include/dbt/logs'}
[0m18:52:45.471260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7d2e5bd7-ed4b-4b85-bafb-6e7f52e8ee93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03e6fb59a0>]}
[0m18:52:45.668338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7d2e5bd7-ed4b-4b85-bafb-6e7f52e8ee93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03e6ed0cd0>]}
[0m18:54:50.835591 [error] [MainThread]: Encountered an error:

[0m18:54:50.843270 [error] [MainThread]: Traceback (most recent call last):
  File "/opt/airflow/dbt_venv/lib/python3.9/site-packages/dbt/cli/requires.py", line 138, in wrapper
    result, success = func(*args, **kwargs)
  File "/opt/airflow/dbt_venv/lib/python3.9/site-packages/dbt/cli/requires.py", line 101, in wrapper
    return func(*args, **kwargs)
  File "/opt/airflow/dbt_venv/lib/python3.9/site-packages/dbt/cli/requires.py", line 218, in wrapper
    return func(*args, **kwargs)
  File "/opt/airflow/dbt_venv/lib/python3.9/site-packages/dbt/cli/requires.py", line 247, in wrapper
    return func(*args, **kwargs)
  File "/opt/airflow/dbt_venv/lib/python3.9/site-packages/dbt/cli/requires.py", line 294, in wrapper
    return func(*args, **kwargs)
  File "/opt/airflow/dbt_venv/lib/python3.9/site-packages/dbt/cli/main.py", line 303, in docs_serve
    results = task.run()
  File "/opt/airflow/dbt_venv/lib/python3.9/site-packages/dbt/task/docs/serve.py", line 29, in run
    httpd.serve_forever()
  File "/usr/local/lib/python3.9/socketserver.py", line 232, in serve_forever
    ready = selector.select(poll_interval)
  File "/usr/local/lib/python3.9/selectors.py", line 416, in select
    fd_event_list = self._selector.poll(timeout)
KeyboardInterrupt

[0m18:54:50.852777 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_success": false, "command_wall_clock_time": 137.33563, "process_in_blocks": "0", "process_kernel_time": 0.558623, "process_mem_max_rss": "230068", "process_out_blocks": "0", "process_user_time": 8.687552}
[0m18:54:50.860137 [debug] [MainThread]: Command `dbt docs serve` failed at 18:54:50.859574 after 137.34 seconds
[0m18:54:50.863766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0420598ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03e6dd78e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03e6dd7f40>]}
[0m18:54:50.867175 [debug] [MainThread]: Flushing usage events
[0m19:08:13.810050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe060f1bc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe05ed67f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe05ed67ee0>]}


============================== 19:08:13.829111 | 55d7c87a-382d-42de-984e-b058fbc90504 ==============================
[0m19:08:13.829111 [info ] [MainThread]: Running with dbt=1.8.9
[0m19:08:13.833276 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'fail_fast': 'False', 'quiet': 'False', 'log_cache_events': 'False', 'invocation_command': 'dbt docs serve --profiles-dir /opt/airflow/include/dbt/ --port 8087 --host 0.0.0.0', 'static_parser': 'True', 'indirect_selection': 'eager', 'introspect': 'True', 'partial_parse': 'True', 'log_format': 'default', 'write_json': 'True', 'empty': 'None', 'use_experimental_parser': 'False', 'target_path': 'None', 'cache_selected_only': 'False', 'log_path': '/opt/airflow/include/dbt/logs', 'debug': 'False', 'no_print': 'None', 'profiles_dir': '/opt/airflow/include/dbt/', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'warn_error': 'None', 'printer_width': '80', 'version_check': 'True'}
[0m19:08:16.893643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '55d7c87a-382d-42de-984e-b058fbc90504', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe02793d7c0>]}
[0m19:08:17.074788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '55d7c87a-382d-42de-984e-b058fbc90504', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe02c673b20>]}
[0m19:09:39.412304 [error] [MainThread]: Encountered an error:

[0m19:09:39.419637 [error] [MainThread]: Traceback (most recent call last):
  File "/opt/airflow/dbt_venv/lib/python3.9/site-packages/dbt/cli/requires.py", line 138, in wrapper
    result, success = func(*args, **kwargs)
  File "/opt/airflow/dbt_venv/lib/python3.9/site-packages/dbt/cli/requires.py", line 101, in wrapper
    return func(*args, **kwargs)
  File "/opt/airflow/dbt_venv/lib/python3.9/site-packages/dbt/cli/requires.py", line 218, in wrapper
    return func(*args, **kwargs)
  File "/opt/airflow/dbt_venv/lib/python3.9/site-packages/dbt/cli/requires.py", line 247, in wrapper
    return func(*args, **kwargs)
  File "/opt/airflow/dbt_venv/lib/python3.9/site-packages/dbt/cli/requires.py", line 294, in wrapper
    return func(*args, **kwargs)
  File "/opt/airflow/dbt_venv/lib/python3.9/site-packages/dbt/cli/main.py", line 303, in docs_serve
    results = task.run()
  File "/opt/airflow/dbt_venv/lib/python3.9/site-packages/dbt/task/docs/serve.py", line 29, in run
    httpd.serve_forever()
  File "/usr/local/lib/python3.9/socketserver.py", line 232, in serve_forever
    ready = selector.select(poll_interval)
  File "/usr/local/lib/python3.9/selectors.py", line 416, in select
    fd_event_list = self._selector.poll(timeout)
KeyboardInterrupt

[0m19:09:39.427495 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_success": false, "command_wall_clock_time": 91.795, "process_in_blocks": "0", "process_kernel_time": 0.528421, "process_mem_max_rss": "228624", "process_out_blocks": "0", "process_user_time": 8.992947}
[0m19:09:39.433167 [debug] [MainThread]: Command `dbt docs serve` failed at 19:09:39.432518 after 91.80 seconds
[0m19:09:39.437110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe060f1bc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe027783d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe027783760>]}
[0m19:09:39.441187 [debug] [MainThread]: Flushing usage events
[0m19:13:03.110554 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f11236d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f0f041e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f0f041df0>]}


============================== 19:13:03.134033 | 8ead9ea1-9597-4fa0-873f-5dcb196afb6f ==============================
[0m19:13:03.134033 [info ] [MainThread]: Running with dbt=1.8.9
[0m19:13:03.138702 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'debug': 'False', 'indirect_selection': 'eager', 'log_format': 'default', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'target_path': 'None', 'use_colors': 'True', 'empty': 'None', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'version_check': 'True', 'printer_width': '80', 'log_path': '/opt/airflow/include/dbt/logs', 'write_json': 'True', 'invocation_command': 'dbt docs serve --profiles-dir /opt/airflow/include/dbt/ --port 8087 --host 0.0.0.0', 'cache_selected_only': 'False', 'quiet': 'False', 'profiles_dir': '/opt/airflow/include/dbt/', 'warn_error': 'None', 'use_experimental_parser': 'False', 'fail_fast': 'False'}
[0m19:13:06.536094 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8ead9ea1-9597-4fa0-873f-5dcb196afb6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0edc9c89d0>]}
[0m19:13:06.730338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8ead9ea1-9597-4fa0-873f-5dcb196afb6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ed7b548e0>]}
[0m19:27:45.559655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb045fa0c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0450c5d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb043df8d30>]}


============================== 19:27:45.580830 | ea63adc0-d80b-43c5-a4b0-e41a351338e7 ==============================
[0m19:27:45.580830 [info ] [MainThread]: Running with dbt=1.8.9
[0m19:27:45.584049 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt docs serve --profiles-dir /opt/airflow/include/dbt/ --port 8087 --host 0.0.0.0', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'indirect_selection': 'eager', 'empty': 'None', 'target_path': 'None', 'quiet': 'False', 'warn_error': 'None', 'static_parser': 'True', 'debug': 'False', 'log_format': 'default', 'version_check': 'True', 'fail_fast': 'False', 'printer_width': '80', 'no_print': 'None', 'log_cache_events': 'False', 'profiles_dir': '/opt/airflow/include/dbt/', 'cache_selected_only': 'False', 'log_path': '/opt/airflow/include/dbt/logs', 'write_json': 'True', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True'}
[0m19:27:49.702394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ea63adc0-d80b-43c5-a4b0-e41a351338e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb043e177c0>]}
[0m19:27:49.885118 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ea63adc0-d80b-43c5-a4b0-e41a351338e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb00c96ef70>]}
[0m19:28:38.717150 [error] [MainThread]: Encountered an error:

[0m19:28:38.729400 [error] [MainThread]: Traceback (most recent call last):
  File "/opt/airflow/dbt_venv/lib/python3.9/site-packages/dbt/cli/requires.py", line 138, in wrapper
    result, success = func(*args, **kwargs)
  File "/opt/airflow/dbt_venv/lib/python3.9/site-packages/dbt/cli/requires.py", line 101, in wrapper
    return func(*args, **kwargs)
  File "/opt/airflow/dbt_venv/lib/python3.9/site-packages/dbt/cli/requires.py", line 218, in wrapper
    return func(*args, **kwargs)
  File "/opt/airflow/dbt_venv/lib/python3.9/site-packages/dbt/cli/requires.py", line 247, in wrapper
    return func(*args, **kwargs)
  File "/opt/airflow/dbt_venv/lib/python3.9/site-packages/dbt/cli/requires.py", line 294, in wrapper
    return func(*args, **kwargs)
  File "/opt/airflow/dbt_venv/lib/python3.9/site-packages/dbt/cli/main.py", line 303, in docs_serve
    results = task.run()
  File "/opt/airflow/dbt_venv/lib/python3.9/site-packages/dbt/task/docs/serve.py", line 29, in run
    httpd.serve_forever()
  File "/usr/local/lib/python3.9/socketserver.py", line 232, in serve_forever
    ready = selector.select(poll_interval)
  File "/usr/local/lib/python3.9/selectors.py", line 416, in select
    fd_event_list = self._selector.poll(timeout)
KeyboardInterrupt

[0m19:28:38.743343 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_success": false, "command_wall_clock_time": 51.05956, "process_in_blocks": "212208", "process_kernel_time": 0.848713, "process_mem_max_rss": "226508", "process_out_blocks": "0", "process_user_time": 9.550715}
[0m19:28:38.748285 [debug] [MainThread]: Command `dbt docs serve` failed at 19:28:38.747776 after 51.06 seconds
[0m19:28:38.754900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb045fa0c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb00c853cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb00c853940>]}
[0m19:28:38.770162 [debug] [MainThread]: Flushing usage events
[0m19:29:20.055350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b8adb0c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b89f992b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b88bbad00>]}


============================== 19:29:20.074150 | 816410b6-848c-4d09-bf51-942b314f0cfc ==============================
[0m19:29:20.074150 [info ] [MainThread]: Running with dbt=1.8.9
[0m19:29:20.078429 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt docs serve --profiles-dir /opt/airflow/include/dbt/ --port 8087 --host 0.0.0.0', 'empty': 'None', 'cache_selected_only': 'False', 'warn_error': 'None', 'log_format': 'default', 'debug': 'False', 'static_parser': 'True', 'fail_fast': 'False', 'printer_width': '80', 'quiet': 'False', 'use_colors': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'use_experimental_parser': 'False', 'introspect': 'True', 'partial_parse': 'True', 'profiles_dir': '/opt/airflow/include/dbt/', 'version_check': 'True', 'log_path': '/opt/airflow/include/dbt/logs', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'log_cache_events': 'False', 'no_print': 'None', 'indirect_selection': 'eager'}
[0m19:29:22.607161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '816410b6-848c-4d09-bf51-942b314f0cfc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b8a570820>]}
[0m19:29:22.755794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '816410b6-848c-4d09-bf51-942b314f0cfc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b516e3460>]}
[0m19:34:59.980256 [error] [MainThread]: Encountered an error:

[0m19:34:59.985927 [error] [MainThread]: Traceback (most recent call last):
  File "/opt/airflow/dbt_venv/lib/python3.9/site-packages/dbt/cli/requires.py", line 138, in wrapper
    result, success = func(*args, **kwargs)
  File "/opt/airflow/dbt_venv/lib/python3.9/site-packages/dbt/cli/requires.py", line 101, in wrapper
    return func(*args, **kwargs)
  File "/opt/airflow/dbt_venv/lib/python3.9/site-packages/dbt/cli/requires.py", line 218, in wrapper
    return func(*args, **kwargs)
  File "/opt/airflow/dbt_venv/lib/python3.9/site-packages/dbt/cli/requires.py", line 247, in wrapper
    return func(*args, **kwargs)
  File "/opt/airflow/dbt_venv/lib/python3.9/site-packages/dbt/cli/requires.py", line 294, in wrapper
    return func(*args, **kwargs)
  File "/opt/airflow/dbt_venv/lib/python3.9/site-packages/dbt/cli/main.py", line 303, in docs_serve
    results = task.run()
  File "/opt/airflow/dbt_venv/lib/python3.9/site-packages/dbt/task/docs/serve.py", line 29, in run
    httpd.serve_forever()
  File "/usr/local/lib/python3.9/socketserver.py", line 232, in serve_forever
    ready = selector.select(poll_interval)
  File "/usr/local/lib/python3.9/selectors.py", line 416, in select
    fd_event_list = self._selector.poll(timeout)
KeyboardInterrupt

[0m19:34:59.991362 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_success": false, "command_wall_clock_time": 326.71246, "process_in_blocks": "1800", "process_kernel_time": 0.402491, "process_mem_max_rss": "235612", "process_out_blocks": "0", "process_user_time": 9.081852}
[0m19:34:59.995120 [debug] [MainThread]: Command `dbt docs serve` failed at 19:34:59.994677 after 326.72 seconds
[0m19:34:59.998052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b8adb0c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b516740d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b51674580>]}
[0m19:35:00.001014 [debug] [MainThread]: Flushing usage events
[0m19:51:22.148818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a0593fc40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a04b08cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a05c12100>]}


============================== 19:51:22.165468 | 32ab3a52-baf5-4506-94eb-5bd8cea4b5df ==============================
[0m19:51:22.165468 [info ] [MainThread]: Running with dbt=1.8.9
[0m19:51:22.169210 [debug] [MainThread]: running dbt with arguments {'use_experimental_parser': 'False', 'invocation_command': 'dbt docs serve --profiles-dir /opt/airflow/include/dbt/ --port 8087 --host 0.0.0.0', 'debug': 'False', 'log_format': 'default', 'use_colors': 'True', 'partial_parse': 'True', 'profiles_dir': '/opt/airflow/include/dbt/', 'send_anonymous_usage_stats': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'log_path': '/opt/airflow/include/dbt/logs', 'empty': 'None', 'warn_error': 'None', 'version_check': 'True', 'target_path': 'None', 'indirect_selection': 'eager', 'fail_fast': 'False', 'printer_width': '80', 'quiet': 'False', 'cache_selected_only': 'False', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'no_print': 'None', 'static_parser': 'True'}
[0m19:51:25.052746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '32ab3a52-baf5-4506-94eb-5bd8cea4b5df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79d10df820>]}
[0m19:51:25.206159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '32ab3a52-baf5-4506-94eb-5bd8cea4b5df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a037e39a0>]}
[0m19:52:14.623045 [error] [MainThread]: Encountered an error:

[0m19:52:14.628611 [error] [MainThread]: Traceback (most recent call last):
  File "/opt/airflow/dbt_venv/lib/python3.9/site-packages/dbt/cli/requires.py", line 138, in wrapper
    result, success = func(*args, **kwargs)
  File "/opt/airflow/dbt_venv/lib/python3.9/site-packages/dbt/cli/requires.py", line 101, in wrapper
    return func(*args, **kwargs)
  File "/opt/airflow/dbt_venv/lib/python3.9/site-packages/dbt/cli/requires.py", line 218, in wrapper
    return func(*args, **kwargs)
  File "/opt/airflow/dbt_venv/lib/python3.9/site-packages/dbt/cli/requires.py", line 247, in wrapper
    return func(*args, **kwargs)
  File "/opt/airflow/dbt_venv/lib/python3.9/site-packages/dbt/cli/requires.py", line 294, in wrapper
    return func(*args, **kwargs)
  File "/opt/airflow/dbt_venv/lib/python3.9/site-packages/dbt/cli/main.py", line 303, in docs_serve
    results = task.run()
  File "/opt/airflow/dbt_venv/lib/python3.9/site-packages/dbt/task/docs/serve.py", line 29, in run
    httpd.serve_forever()
  File "/usr/local/lib/python3.9/socketserver.py", line 232, in serve_forever
    ready = selector.select(poll_interval)
  File "/usr/local/lib/python3.9/selectors.py", line 416, in select
    fd_event_list = self._selector.poll(timeout)
KeyboardInterrupt

[0m19:52:14.635208 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_success": false, "command_wall_clock_time": 51.389606, "process_in_blocks": "10712", "process_kernel_time": 0.46349, "process_mem_max_rss": "230316", "process_out_blocks": "0", "process_user_time": 9.006454}
[0m19:52:14.639075 [debug] [MainThread]: Command `dbt docs serve` failed at 19:52:14.638602 after 51.39 seconds
[0m19:52:14.642165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a0593fc40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79d020dc40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79d020de80>]}
[0m19:52:14.644988 [debug] [MainThread]: Flushing usage events
[0m19:52:32.691378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f5320cfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f510edee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f510ede80>]}


============================== 19:52:32.707718 | 06697ba1-cddc-499d-ac51-1741934b89c8 ==============================
[0m19:52:32.707718 [info ] [MainThread]: Running with dbt=1.8.9
[0m19:52:32.711210 [debug] [MainThread]: running dbt with arguments {'empty': 'None', 'target_path': 'None', 'log_cache_events': 'False', 'static_parser': 'True', 'debug': 'False', 'invocation_command': 'dbt docs serve --profiles-dir /opt/airflow/include/dbt/ --port 8087 --host 127.0.0.1', 'send_anonymous_usage_stats': 'True', 'log_path': '/opt/airflow/include/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'quiet': 'False', 'fail_fast': 'False', 'no_print': 'None', 'partial_parse': 'True', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'cache_selected_only': 'False', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_format': 'default', 'profiles_dir': '/opt/airflow/include/dbt/'}
[0m19:52:35.278755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '06697ba1-cddc-499d-ac51-1741934b89c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f511467f0>]}
[0m19:52:35.450398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '06697ba1-cddc-499d-ac51-1741934b89c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f53521340>]}
[0m19:54:22.815911 [error] [MainThread]: Encountered an error:

[0m19:54:22.821769 [error] [MainThread]: Traceback (most recent call last):
  File "/opt/airflow/dbt_venv/lib/python3.9/site-packages/dbt/cli/requires.py", line 138, in wrapper
    result, success = func(*args, **kwargs)
  File "/opt/airflow/dbt_venv/lib/python3.9/site-packages/dbt/cli/requires.py", line 101, in wrapper
    return func(*args, **kwargs)
  File "/opt/airflow/dbt_venv/lib/python3.9/site-packages/dbt/cli/requires.py", line 218, in wrapper
    return func(*args, **kwargs)
  File "/opt/airflow/dbt_venv/lib/python3.9/site-packages/dbt/cli/requires.py", line 247, in wrapper
    return func(*args, **kwargs)
  File "/opt/airflow/dbt_venv/lib/python3.9/site-packages/dbt/cli/requires.py", line 294, in wrapper
    return func(*args, **kwargs)
  File "/opt/airflow/dbt_venv/lib/python3.9/site-packages/dbt/cli/main.py", line 303, in docs_serve
    results = task.run()
  File "/opt/airflow/dbt_venv/lib/python3.9/site-packages/dbt/task/docs/serve.py", line 29, in run
    httpd.serve_forever()
  File "/usr/local/lib/python3.9/socketserver.py", line 232, in serve_forever
    ready = selector.select(poll_interval)
  File "/usr/local/lib/python3.9/selectors.py", line 416, in select
    fd_event_list = self._selector.poll(timeout)
KeyboardInterrupt

[0m19:54:22.829896 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_success": false, "command_wall_clock_time": 106.40665, "process_in_blocks": "1456", "process_kernel_time": 0.502795, "process_mem_max_rss": "233612", "process_out_blocks": "0", "process_user_time": 8.516103}
[0m19:54:22.835282 [debug] [MainThread]: Command `dbt docs serve` failed at 19:54:22.834521 after 106.41 seconds
[0m19:54:22.838628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f5320cfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f19b401f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f19b40220>]}
[0m19:54:22.841412 [debug] [MainThread]: Flushing usage events
[0m20:00:15.922231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0075dac70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0053e8d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0053e8fa0>]}


============================== 20:00:15.938698 | 8b47c4ee-2397-48c9-8d18-cec9e50e47a3 ==============================
[0m20:00:15.938698 [info ] [MainThread]: Running with dbt=1.8.9
[0m20:00:15.941996 [debug] [MainThread]: running dbt with arguments {'debug': 'False', 'invocation_command': 'dbt docs generate --profiles-dir /opt/airflow/include/dbt/', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'profiles_dir': '/opt/airflow/include/dbt/', 'no_print': 'None', 'printer_width': '80', 'version_check': 'True', 'fail_fast': 'False', 'write_json': 'True', 'use_experimental_parser': 'False', 'log_path': '/opt/airflow/include/dbt/logs', 'log_cache_events': 'False', 'target_path': 'None', 'quiet': 'False', 'introspect': 'True', 'empty': 'None', 'cache_selected_only': 'False', 'warn_error': 'None', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'log_format': 'default', 'indirect_selection': 'eager', 'partial_parse': 'True'}
[0m20:00:18.695368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8b47c4ee-2397-48c9-8d18-cec9e50e47a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcfcdfa7550>]}
[0m20:00:18.852028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8b47c4ee-2397-48c9-8d18-cec9e50e47a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcfced6c040>]}
[0m20:00:18.855150 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m20:00:19.377972 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m20:00:23.094812 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:00:23.097952 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:00:23.281957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8b47c4ee-2397-48c9-8d18-cec9e50e47a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd000629130>]}
[0m20:00:23.345636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8b47c4ee-2397-48c9-8d18-cec9e50e47a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0005d1640>]}
[0m20:00:23.348827 [info ] [MainThread]: Found 10 models, 23 data tests, 2 sources, 600 macros
[0m20:00:23.353281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8b47c4ee-2397-48c9-8d18-cec9e50e47a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0005d1670>]}
[0m20:00:23.363520 [info ] [MainThread]: 
[0m20:00:23.367549 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m20:00:23.386526 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_northern-shield-437204-m0_nyc_taxi'
[0m20:00:23.389322 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:00:24.183492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8b47c4ee-2397-48c9-8d18-cec9e50e47a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0078ebf70>]}
[0m20:00:24.186937 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:00:24.190526 [info ] [MainThread]: 
[0m20:00:24.215734 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_payment
[0m20:00:24.219378 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_northern-shield-437204-m0_nyc_taxi, now model.nyc_taxi.dim_payment)
[0m20:00:24.222576 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_payment
[0m20:00:24.272459 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_payment"
[0m20:00:24.290719 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_payment
[0m20:00:24.295484 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_payment
[0m20:00:24.303943 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_ratecode
[0m20:00:24.308322 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_payment, now model.nyc_taxi.dim_ratecode)
[0m20:00:24.311343 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_ratecode
[0m20:00:24.487008 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_ratecode"
[0m20:00:24.512011 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_ratecode
[0m20:00:24.516325 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_ratecode
[0m20:00:24.519526 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_vendor
[0m20:00:24.522474 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_ratecode, now model.nyc_taxi.dim_vendor)
[0m20:00:24.525088 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_vendor
[0m20:00:24.535143 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_vendor"
[0m20:00:24.557390 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_vendor
[0m20:00:24.561344 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_vendor
[0m20:00:24.564915 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_zone
[0m20:00:24.568156 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_vendor, now model.nyc_taxi.dim_zone)
[0m20:00:24.571386 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_zone
[0m20:00:24.583111 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_zone"
[0m20:00:24.600400 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_zone
[0m20:00:24.605201 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_zone
[0m20:00:24.608170 [debug] [Thread-1  ]: Began running node model.nyc_taxi.fct_trips
[0m20:00:24.611240 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_zone, now model.nyc_taxi.fct_trips)
[0m20:00:24.614425 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.fct_trips
[0m20:00:24.667584 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.fct_trips"
[0m20:00:24.687171 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.fct_trips
[0m20:00:24.692340 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.fct_trips
[0m20:00:24.695909 [debug] [Thread-1  ]: Began running node test.nyc_taxi.accepted_values_dim_payment_payment_name__Credit_card__Cash__No_charge__Dispute__Unknown__Voided_trip.58d00ef9f4
[0m20:00:24.700354 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.fct_trips, now test.nyc_taxi.accepted_values_dim_payment_payment_name__Credit_card__Cash__No_charge__Dispute__Unknown__Voided_trip.58d00ef9f4)
[0m20:00:24.704220 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.accepted_values_dim_payment_payment_name__Credit_card__Cash__No_charge__Dispute__Unknown__Voided_trip.58d00ef9f4
[0m20:00:24.767020 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.accepted_values_dim_payment_payment_name__Credit_card__Cash__No_charge__Dispute__Unknown__Voided_trip.58d00ef9f4"
[0m20:00:24.789652 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.accepted_values_dim_payment_payment_name__Credit_card__Cash__No_charge__Dispute__Unknown__Voided_trip.58d00ef9f4
[0m20:00:24.794542 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.accepted_values_dim_payment_payment_name__Credit_card__Cash__No_charge__Dispute__Unknown__Voided_trip.58d00ef9f4
[0m20:00:24.798261 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_dim_payment_type_id.96dfa722aa
[0m20:00:24.801366 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.accepted_values_dim_payment_payment_name__Credit_card__Cash__No_charge__Dispute__Unknown__Voided_trip.58d00ef9f4, now test.nyc_taxi.not_null_dim_payment_type_id.96dfa722aa)
[0m20:00:24.804586 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_dim_payment_type_id.96dfa722aa
[0m20:00:24.833826 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_dim_payment_type_id.96dfa722aa"
[0m20:00:24.853323 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_dim_payment_type_id.96dfa722aa
[0m20:00:24.857778 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_dim_payment_type_id.96dfa722aa
[0m20:00:24.861315 [debug] [Thread-1  ]: Began running node test.nyc_taxi.unique_dim_payment_type_id.dea55de04e
[0m20:00:24.864543 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_dim_payment_type_id.96dfa722aa, now test.nyc_taxi.unique_dim_payment_type_id.dea55de04e)
[0m20:00:24.867595 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.unique_dim_payment_type_id.dea55de04e
[0m20:00:24.887927 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.unique_dim_payment_type_id.dea55de04e"
[0m20:00:24.914071 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.unique_dim_payment_type_id.dea55de04e
[0m20:00:24.918964 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.unique_dim_payment_type_id.dea55de04e
[0m20:00:24.923334 [debug] [Thread-1  ]: Began running node test.nyc_taxi.accepted_values_dim_ratecode_rate_code_name__Standard_rate__JFK__Newark__Nassau_or_Westchester__Negotiated_fare__Group_ride__Unknown.57ee02019f
[0m20:00:24.926650 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.unique_dim_payment_type_id.dea55de04e, now test.nyc_taxi.accepted_values_dim_ratecode_rate_code_name__Standard_rate__JFK__Newark__Nassau_or_Westchester__Negotiated_fare__Group_ride__Unknown.57ee02019f)
[0m20:00:24.929416 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.accepted_values_dim_ratecode_rate_code_name__Standard_rate__JFK__Newark__Nassau_or_Westchester__Negotiated_fare__Group_ride__Unknown.57ee02019f
[0m20:00:24.953191 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.accepted_values_dim_ratecode_rate_code_name__Standard_rate__JFK__Newark__Nassau_or_Westchester__Negotiated_fare__Group_ride__Unknown.57ee02019f"
[0m20:00:24.979830 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.accepted_values_dim_ratecode_rate_code_name__Standard_rate__JFK__Newark__Nassau_or_Westchester__Negotiated_fare__Group_ride__Unknown.57ee02019f
[0m20:00:24.984477 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.accepted_values_dim_ratecode_rate_code_name__Standard_rate__JFK__Newark__Nassau_or_Westchester__Negotiated_fare__Group_ride__Unknown.57ee02019f
[0m20:00:24.987905 [debug] [Thread-1  ]: Began running node test.nyc_taxi.unique_dim_ratecode_rate_id.75ae8e4885
[0m20:00:24.991028 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.accepted_values_dim_ratecode_rate_code_name__Standard_rate__JFK__Newark__Nassau_or_Westchester__Negotiated_fare__Group_ride__Unknown.57ee02019f, now test.nyc_taxi.unique_dim_ratecode_rate_id.75ae8e4885)
[0m20:00:24.994064 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.unique_dim_ratecode_rate_id.75ae8e4885
[0m20:00:25.007964 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.unique_dim_ratecode_rate_id.75ae8e4885"
[0m20:00:25.034288 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.unique_dim_ratecode_rate_id.75ae8e4885
[0m20:00:25.039040 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.unique_dim_ratecode_rate_id.75ae8e4885
[0m20:00:25.042546 [debug] [Thread-1  ]: Began running node test.nyc_taxi.accepted_values_dim_vendor_vendor_name__Creative_Mobile_Technologies__VeriFone_Inc_.7481cecf07
[0m20:00:25.045794 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.unique_dim_ratecode_rate_id.75ae8e4885, now test.nyc_taxi.accepted_values_dim_vendor_vendor_name__Creative_Mobile_Technologies__VeriFone_Inc_.7481cecf07)
[0m20:00:25.048771 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.accepted_values_dim_vendor_vendor_name__Creative_Mobile_Technologies__VeriFone_Inc_.7481cecf07
[0m20:00:25.065810 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.accepted_values_dim_vendor_vendor_name__Creative_Mobile_Technologies__VeriFone_Inc_.7481cecf07"
[0m20:00:25.091422 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.accepted_values_dim_vendor_vendor_name__Creative_Mobile_Technologies__VeriFone_Inc_.7481cecf07
[0m20:00:25.095696 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.accepted_values_dim_vendor_vendor_name__Creative_Mobile_Technologies__VeriFone_Inc_.7481cecf07
[0m20:00:25.102070 [debug] [Thread-1  ]: Began running node test.nyc_taxi.unique_dim_vendor_id.03fad38d04
[0m20:00:25.105337 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.accepted_values_dim_vendor_vendor_name__Creative_Mobile_Technologies__VeriFone_Inc_.7481cecf07, now test.nyc_taxi.unique_dim_vendor_id.03fad38d04)
[0m20:00:25.108399 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.unique_dim_vendor_id.03fad38d04
[0m20:00:25.122452 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.unique_dim_vendor_id.03fad38d04"
[0m20:00:25.145190 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.unique_dim_vendor_id.03fad38d04
[0m20:00:25.149601 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.unique_dim_vendor_id.03fad38d04
[0m20:00:25.152774 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_dim_zone_borough.1ed2272c52
[0m20:00:25.155844 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.unique_dim_vendor_id.03fad38d04, now test.nyc_taxi.not_null_dim_zone_borough.1ed2272c52)
[0m20:00:25.158975 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_dim_zone_borough.1ed2272c52
[0m20:00:25.173648 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_dim_zone_borough.1ed2272c52"
[0m20:00:25.198086 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_dim_zone_borough.1ed2272c52
[0m20:00:25.203327 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_dim_zone_borough.1ed2272c52
[0m20:00:25.207146 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_dim_zone_service_zone.2007f611c5
[0m20:00:25.210338 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_dim_zone_borough.1ed2272c52, now test.nyc_taxi.not_null_dim_zone_service_zone.2007f611c5)
[0m20:00:25.213261 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_dim_zone_service_zone.2007f611c5
[0m20:00:25.232894 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_dim_zone_service_zone.2007f611c5"
[0m20:00:25.258374 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_dim_zone_service_zone.2007f611c5
[0m20:00:25.262633 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_dim_zone_service_zone.2007f611c5
[0m20:00:25.266223 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_dim_zone_zone.a1c4a4c37a
[0m20:00:25.269197 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_dim_zone_service_zone.2007f611c5, now test.nyc_taxi.not_null_dim_zone_zone.a1c4a4c37a)
[0m20:00:25.272457 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_dim_zone_zone.a1c4a4c37a
[0m20:00:25.290059 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_dim_zone_zone.a1c4a4c37a"
[0m20:00:25.307361 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_dim_zone_zone.a1c4a4c37a
[0m20:00:25.311551 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_dim_zone_zone.a1c4a4c37a
[0m20:00:25.315048 [debug] [Thread-1  ]: Began running node test.nyc_taxi.unique_dim_zone_location_id.7702f92424
[0m20:00:25.318250 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_dim_zone_zone.a1c4a4c37a, now test.nyc_taxi.unique_dim_zone_location_id.7702f92424)
[0m20:00:25.321488 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.unique_dim_zone_location_id.7702f92424
[0m20:00:25.338083 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.unique_dim_zone_location_id.7702f92424"
[0m20:00:25.355545 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.unique_dim_zone_location_id.7702f92424
[0m20:00:25.359683 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.unique_dim_zone_location_id.7702f92424
[0m20:00:25.363536 [debug] [Thread-1  ]: Began running node model.nyc_taxi.test_fare_amount_positive
[0m20:00:25.366649 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.unique_dim_zone_location_id.7702f92424, now model.nyc_taxi.test_fare_amount_positive)
[0m20:00:25.370023 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.test_fare_amount_positive
[0m20:00:25.386484 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.test_fare_amount_positive"
[0m20:00:25.404293 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.test_fare_amount_positive
[0m20:00:25.408480 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.test_fare_amount_positive
[0m20:00:25.411441 [debug] [Thread-1  ]: Began running node model.nyc_taxi.test_mta_tax_positive
[0m20:00:25.414655 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.test_fare_amount_positive, now model.nyc_taxi.test_mta_tax_positive)
[0m20:00:25.417227 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.test_mta_tax_positive
[0m20:00:25.427642 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.test_mta_tax_positive"
[0m20:00:25.447254 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.test_mta_tax_positive
[0m20:00:25.451472 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.test_mta_tax_positive
[0m20:00:25.454878 [debug] [Thread-1  ]: Began running node model.nyc_taxi.test_tip_amount_positive
[0m20:00:25.457818 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.test_mta_tax_positive, now model.nyc_taxi.test_tip_amount_positive)
[0m20:00:25.460922 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.test_tip_amount_positive
[0m20:00:25.472214 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.test_tip_amount_positive"
[0m20:00:25.492615 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.test_tip_amount_positive
[0m20:00:25.496945 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.test_tip_amount_positive
[0m20:00:25.500436 [debug] [Thread-1  ]: Began running node model.nyc_taxi.test_tolls_amount_positive
[0m20:00:25.503440 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.test_tip_amount_positive, now model.nyc_taxi.test_tolls_amount_positive)
[0m20:00:25.506908 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.test_tolls_amount_positive
[0m20:00:25.518939 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.test_tolls_amount_positive"
[0m20:00:25.534609 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.test_tolls_amount_positive
[0m20:00:25.539295 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.test_tolls_amount_positive
[0m20:00:25.543245 [debug] [Thread-1  ]: Began running node model.nyc_taxi.test_total_amount_positive
[0m20:00:25.547741 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.test_tolls_amount_positive, now model.nyc_taxi.test_total_amount_positive)
[0m20:00:25.551006 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.test_total_amount_positive
[0m20:00:25.565391 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.test_total_amount_positive"
[0m20:00:25.581045 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.test_total_amount_positive
[0m20:00:25.585732 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.test_total_amount_positive
[0m20:00:25.588953 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_do_location_id.6acdd302a6
[0m20:00:25.592145 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.test_total_amount_positive, now test.nyc_taxi.not_null_fct_trips_do_location_id.6acdd302a6)
[0m20:00:25.595668 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_do_location_id.6acdd302a6
[0m20:00:25.614267 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_do_location_id.6acdd302a6"
[0m20:00:25.636662 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_do_location_id.6acdd302a6
[0m20:00:25.641327 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_do_location_id.6acdd302a6
[0m20:00:25.644727 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_dropoff_time.04b71dc609
[0m20:00:25.648310 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_do_location_id.6acdd302a6, now test.nyc_taxi.not_null_fct_trips_dropoff_time.04b71dc609)
[0m20:00:25.651043 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_dropoff_time.04b71dc609
[0m20:00:25.668915 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_dropoff_time.04b71dc609"
[0m20:00:25.685508 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_dropoff_time.04b71dc609
[0m20:00:25.689990 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_dropoff_time.04b71dc609
[0m20:00:25.694033 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_extra.1801055bb3
[0m20:00:25.698045 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_dropoff_time.04b71dc609, now test.nyc_taxi.not_null_fct_trips_extra.1801055bb3)
[0m20:00:25.700984 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_extra.1801055bb3
[0m20:00:25.716429 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_extra.1801055bb3"
[0m20:00:25.737937 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_extra.1801055bb3
[0m20:00:25.743048 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_extra.1801055bb3
[0m20:00:25.746915 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_improvement_surcharge.4cf28d1443
[0m20:00:25.750353 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_extra.1801055bb3, now test.nyc_taxi.not_null_fct_trips_improvement_surcharge.4cf28d1443)
[0m20:00:25.753513 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_improvement_surcharge.4cf28d1443
[0m20:00:25.773833 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_improvement_surcharge.4cf28d1443"
[0m20:00:25.811991 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_improvement_surcharge.4cf28d1443
[0m20:00:25.824792 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_improvement_surcharge.4cf28d1443
[0m20:00:25.828362 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_passenger_count.b1370cab1c
[0m20:00:25.837783 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_improvement_surcharge.4cf28d1443, now test.nyc_taxi.not_null_fct_trips_passenger_count.b1370cab1c)
[0m20:00:25.841629 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_passenger_count.b1370cab1c
[0m20:00:25.859677 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_passenger_count.b1370cab1c"
[0m20:00:25.880760 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_passenger_count.b1370cab1c
[0m20:00:25.884945 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_passenger_count.b1370cab1c
[0m20:00:25.887703 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_payment_type.93889b679a
[0m20:00:25.890263 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_passenger_count.b1370cab1c, now test.nyc_taxi.not_null_fct_trips_payment_type.93889b679a)
[0m20:00:25.892680 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_payment_type.93889b679a
[0m20:00:25.905829 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_payment_type.93889b679a"
[0m20:00:25.924146 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_payment_type.93889b679a
[0m20:00:25.928294 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_payment_type.93889b679a
[0m20:00:25.931845 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_pickup_time.693af2bf31
[0m20:00:25.934915 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_payment_type.93889b679a, now test.nyc_taxi.not_null_fct_trips_pickup_time.693af2bf31)
[0m20:00:25.938010 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_pickup_time.693af2bf31
[0m20:00:25.955916 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_pickup_time.693af2bf31"
[0m20:00:25.979198 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_pickup_time.693af2bf31
[0m20:00:25.983500 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_pickup_time.693af2bf31
[0m20:00:25.987147 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_pu_location_id.b0dc8dd185
[0m20:00:25.990243 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_pickup_time.693af2bf31, now test.nyc_taxi.not_null_fct_trips_pu_location_id.b0dc8dd185)
[0m20:00:25.993272 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_pu_location_id.b0dc8dd185
[0m20:00:26.007744 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_pu_location_id.b0dc8dd185"
[0m20:00:26.031973 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_pu_location_id.b0dc8dd185
[0m20:00:26.036446 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_pu_location_id.b0dc8dd185
[0m20:00:26.039577 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_rate_code_id.ba0047eaae
[0m20:00:26.043031 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_pu_location_id.b0dc8dd185, now test.nyc_taxi.not_null_fct_trips_rate_code_id.ba0047eaae)
[0m20:00:26.046083 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_rate_code_id.ba0047eaae
[0m20:00:26.063989 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_rate_code_id.ba0047eaae"
[0m20:00:26.086427 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_rate_code_id.ba0047eaae
[0m20:00:26.091554 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_rate_code_id.ba0047eaae
[0m20:00:26.095446 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_trip_distance.19cd17f1df
[0m20:00:26.098796 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_rate_code_id.ba0047eaae, now test.nyc_taxi.not_null_fct_trips_trip_distance.19cd17f1df)
[0m20:00:26.102241 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_trip_distance.19cd17f1df
[0m20:00:26.119929 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_trip_distance.19cd17f1df"
[0m20:00:26.140415 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_trip_distance.19cd17f1df
[0m20:00:26.144842 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_trip_distance.19cd17f1df
[0m20:00:26.148511 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_vendor_id.b9b2f380bb
[0m20:00:26.151832 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_trip_distance.19cd17f1df, now test.nyc_taxi.not_null_fct_trips_vendor_id.b9b2f380bb)
[0m20:00:26.154254 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_vendor_id.b9b2f380bb
[0m20:00:26.172153 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_vendor_id.b9b2f380bb"
[0m20:00:26.188584 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_vendor_id.b9b2f380bb
[0m20:00:26.192551 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_vendor_id.b9b2f380bb
[0m20:00:26.195979 [debug] [Thread-1  ]: Began running node test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab
[0m20:00:26.198811 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_vendor_id.b9b2f380bb, now test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab)
[0m20:00:26.201616 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab
[0m20:00:26.215271 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab"
[0m20:00:26.239686 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab
[0m20:00:26.244050 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab
[0m20:00:26.249112 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:00:26.251862 [debug] [MainThread]: Connection 'test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab' was properly closed.
[0m20:00:26.276325 [debug] [MainThread]: Command end result
[0m20:00:26.766560 [debug] [MainThread]: Acquiring new bigquery connection 'generate_catalog'
[0m20:00:26.769283 [info ] [MainThread]: Building catalog
[0m20:00:26.793105 [debug] [ThreadPool]: Acquiring new bigquery connection 'northern-shield-437204-m0.information_schema'
[0m20:00:26.866680 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:00:26.877302 [debug] [ThreadPool]: On northern-shield-437204-m0.information_schema: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "connection_name": "northern-shield-437204-m0.information_schema"} */

    with
                table_shards_stage as (
    select
        tables.project_id as table_catalog,
        tables.dataset_id as table_schema,
        coalesce(REGEXP_EXTRACT(tables.table_id, '^(.+)[0-9]{8}$'), tables.table_id) as table_name,
        tables.table_id as shard_name,
        REGEXP_EXTRACT(tables.table_id, '^.+([0-9]{8})$') as shard_index,
        REGEXP_CONTAINS(tables.table_id, '^.+[0-9]{8}$') and tables.type = 1 as is_date_shard,
        case
            when materialized_views.table_name is not null then 'materialized view'
            when tables.type = 1 then 'table'
            when tables.type = 2 then 'view'
            else 'external'
        end as table_type,
        tables.type = 1 as is_table,
        JSON_VALUE(table_description.option_value) as table_comment,
        tables.size_bytes,
        tables.row_count
    from `northern-shield-437204-m0`.`nyc_taxi`.__TABLES__ tables
    left join `northern-shield-437204-m0`.`nyc_taxi`.INFORMATION_SCHEMA.MATERIALIZED_VIEWS materialized_views
        on materialized_views.table_catalog = tables.project_id
        and materialized_views.table_schema = tables.dataset_id
        and materialized_views.table_name = tables.table_id
    left join `northern-shield-437204-m0`.`nyc_taxi`.INFORMATION_SCHEMA.TABLE_OPTIONS table_description
        on table_description.table_catalog = tables.project_id
        and table_description.table_schema = tables.dataset_id
        and table_description.table_name = tables.table_id
        and table_description.option_name = 'description'
),
                table_shards as (
                    select * from table_shards_stage
                    where ((
                                upper(table_schema) = upper('nyc_taxi')
                            and upper(table_name) = upper('test_tip_amount_positive')
                            ) or (
                                upper(table_schema) = upper('nyc_taxi')
                            and upper(table_name) = upper('zone_map')
                            ) or (
                                upper(table_schema) = upper('nyc_taxi')
                            and upper(table_name) = upper('test_fare_amount_positive')
                            ) or (
                                upper(table_schema) = upper('nyc_taxi')
                            and upper(table_name) = upper('dim_vendor')
                            ) or (
                                upper(table_schema) = upper('nyc_taxi')
                            and upper(table_name) = upper('green_tripdata')
                            ) or (
                                upper(table_schema) = upper('nyc_taxi')
                            and upper(table_name) = upper('test_mta_tax_positive')
                            ) or (
                                upper(table_schema) = upper('nyc_taxi')
                            and upper(table_name) = upper('fct_trips')
                            ) or (
                                upper(table_schema) = upper('nyc_taxi')
                            and upper(table_name) = upper('test_total_amount_positive')
                            ) or (
                                upper(table_schema) = upper('nyc_taxi')
                            and upper(table_name) = upper('dim_payment')
                            ) or (
                                upper(table_schema) = upper('nyc_taxi')
                            and upper(table_name) = upper('test_tolls_amount_positive')
                            ) or (
                                upper(table_schema) = upper('nyc_taxi')
                            and upper(table_name) = upper('dim_zone')
                            ) or (
                                upper(table_schema) = upper('nyc_taxi')
                            and upper(table_name) = upper('dim_ratecode')
                            ))
                ),
                tables as (
    select distinct
        table_catalog,
        table_schema,
        table_name,
        is_date_shard,
        table_type,
        is_table,
        table_comment
    from table_shards
),
                table_stats as (
    select
        table_catalog,
        table_schema,
        table_name,
        max(shard_name) as latest_shard_name,
        min(shard_index) as shard_min,
        max(shard_index) as shard_max,
        count(shard_index) as shard_count,
        sum(size_bytes) as size_bytes,
        sum(row_count) as row_count
    from table_shards
    group by 1, 2, 3
),

                columns as (
    select
        columns.table_catalog,
        columns.table_schema,
        columns.table_name as shard_name,
        coalesce(paths.field_path, '<unknown>') as column_name,
        -- invent a row number to account for nested fields
        -- BQ does not treat these nested properties as independent fields
        row_number() over (
            partition by
                columns.table_catalog,
                columns.table_schema,
                columns.table_name
            order by
                columns.ordinal_position,
                paths.field_path
        ) as column_index,
        coalesce(paths.data_type, '<unknown>') as column_type,
        paths.description as column_comment,
        case when columns.is_partitioning_column = 'YES' then 1 else 0 end as is_partitioning_column,
        case when columns.is_partitioning_column = 'YES' then paths.field_path end as partition_column,
        case when columns.clustering_ordinal_position is not null then 1 else 0 end as is_clustering_column,
        case when columns.clustering_ordinal_position is not null then paths.field_path end as cluster_column,
        columns.clustering_ordinal_position
    from `northern-shield-437204-m0`.`nyc_taxi`.INFORMATION_SCHEMA.COLUMNS columns
    join `northern-shield-437204-m0`.`nyc_taxi`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS paths
        on paths.table_catalog = columns.table_catalog
        and paths.table_schema = columns.table_schema
        and paths.table_name = columns.table_name
        and paths.column_name = columns.column_name
    where columns.ordinal_position is not null
),
                column_stats as (
    select
        table_catalog,
        table_schema,
        shard_name,
        max(is_partitioning_column) = 1 as is_partitioned,
        max(partition_column) as partition_column,
        max(is_clustering_column) = 1 as is_clustered,
        array_to_string(
            array_agg(
                cluster_column ignore nulls
                order by clustering_ordinal_position
            ), ', '
        ) as clustering_columns
    from columns
    group by 1, 2, 3
)

            
    select
        tables.table_catalog as table_database,
        tables.table_schema,
        case
            when tables.is_date_shard then concat(tables.table_name, '*')
            else tables.table_name
        end as table_name,
        tables.table_type,
        tables.table_comment,
        -- coalesce column metadata fields to ensure they are non-null for catalog generation
        -- external table columns are not present in COLUMN_FIELD_PATHS
        coalesce(columns.column_name, '<unknown>') as column_name,
        coalesce(columns.column_index, 1) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        coalesce(columns.column_comment, '') as column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_stats.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        tables.is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_stats.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        tables.is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_stats.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        tables.is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        table_stats.row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        tables.is_table as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        table_stats.size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        tables.is_table as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        column_stats.partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        column_stats.is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        column_stats.clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        column_stats.is_clustered as `stats__clustering_fields__include`

    from tables
    join table_stats
        on table_stats.table_catalog = tables.table_catalog
        and table_stats.table_schema = tables.table_schema
        and table_stats.table_name = tables.table_name
    left join column_stats
        on column_stats.table_catalog = tables.table_catalog
        and column_stats.table_schema = tables.table_schema
        and column_stats.shard_name = table_stats.latest_shard_name
    left join columns
        on columns.table_catalog = tables.table_catalog
        and columns.table_schema = tables.table_schema
        and columns.shard_name = table_stats.latest_shard_name

  
[0m20:00:27.826199 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:93c786a0-7433-42bd-81a2-9d6681cfc4e4&page=queryresults
[0m20:00:30.270845 [info ] [MainThread]: Catalog written to /opt/airflow/include/dbt/target/catalog.json
[0m20:00:30.275709 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 14.555708, "process_in_blocks": "2536", "process_kernel_time": 0.995135, "process_mem_max_rss": "226512", "process_out_blocks": "0", "process_user_time": 12.449785}
[0m20:00:30.279443 [debug] [MainThread]: Command `dbt docs generate` succeeded at 20:00:30.279000 after 14.56 seconds
[0m20:00:30.282316 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m20:00:30.285089 [debug] [MainThread]: Connection 'northern-shield-437204-m0.information_schema' was properly closed.
[0m20:00:30.287823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0075dac70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0067faa30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0008b42e0>]}
[0m20:00:30.290824 [debug] [MainThread]: Flushing usage events
[0m20:01:11.013055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e0d2e7c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e0b133ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e0b133e80>]}


============================== 20:01:11.030165 | 21f667cc-6de2-462a-92dc-803a404c8d3a ==============================
[0m20:01:11.030165 [info ] [MainThread]: Running with dbt=1.8.9
[0m20:01:11.033746 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'write_json': 'True', 'debug': 'False', 'profiles_dir': '/opt/airflow/include/dbt/', 'printer_width': '80', 'partial_parse': 'True', 'invocation_command': 'dbt docs serve --profiles-dir /opt/airflow/include/dbt/ --port 8087 --host 0.0.0.0', 'empty': 'None', 'use_experimental_parser': 'False', 'log_path': '/opt/airflow/include/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'static_parser': 'True', 'quiet': 'False', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'warn_error': 'None', 'send_anonymous_usage_stats': 'True', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'use_colors': 'True'}
[0m20:01:14.929463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '21f667cc-6de2-462a-92dc-803a404c8d3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e0caa6820>]}
[0m20:01:15.080146 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '21f667cc-6de2-462a-92dc-803a404c8d3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2dd8a4edc0>]}
[0m20:06:36.173684 [error] [MainThread]: Encountered an error:

[0m20:06:36.180404 [error] [MainThread]: Traceback (most recent call last):
  File "/opt/airflow/dbt_venv/lib/python3.9/site-packages/dbt/cli/requires.py", line 138, in wrapper
    result, success = func(*args, **kwargs)
  File "/opt/airflow/dbt_venv/lib/python3.9/site-packages/dbt/cli/requires.py", line 101, in wrapper
    return func(*args, **kwargs)
  File "/opt/airflow/dbt_venv/lib/python3.9/site-packages/dbt/cli/requires.py", line 218, in wrapper
    return func(*args, **kwargs)
  File "/opt/airflow/dbt_venv/lib/python3.9/site-packages/dbt/cli/requires.py", line 247, in wrapper
    return func(*args, **kwargs)
  File "/opt/airflow/dbt_venv/lib/python3.9/site-packages/dbt/cli/requires.py", line 294, in wrapper
    return func(*args, **kwargs)
  File "/opt/airflow/dbt_venv/lib/python3.9/site-packages/dbt/cli/main.py", line 303, in docs_serve
    results = task.run()
  File "/opt/airflow/dbt_venv/lib/python3.9/site-packages/dbt/task/docs/serve.py", line 29, in run
    httpd.serve_forever()
  File "/usr/local/lib/python3.9/socketserver.py", line 232, in serve_forever
    ready = selector.select(poll_interval)
  File "/usr/local/lib/python3.9/selectors.py", line 416, in select
    fd_event_list = self._selector.poll(timeout)
KeyboardInterrupt

[0m20:06:36.186856 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_success": false, "command_wall_clock_time": 310.58456, "process_in_blocks": "0", "process_kernel_time": 0.551452, "process_mem_max_rss": "227624", "process_out_blocks": "0", "process_user_time": 9.035332}
[0m20:06:36.190995 [debug] [MainThread]: Command `dbt docs serve` failed at 20:06:36.190414 after 310.59 seconds
[0m20:06:36.195559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e0d2e7c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2dd3b3fa90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2dd3ba0370>]}
[0m20:06:36.198938 [debug] [MainThread]: Flushing usage events
[0m20:06:51.659572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efeddbf4fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efedba94e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efedba94df0>]}


============================== 20:06:51.675314 | 1be5a5f6-11c6-420a-abcd-87c0b6214a50 ==============================
[0m20:06:51.675314 [info ] [MainThread]: Running with dbt=1.8.9
[0m20:06:51.678814 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'cache_selected_only': 'False', 'quiet': 'False', 'target_path': 'None', 'introspect': 'True', 'no_print': 'None', 'log_format': 'default', 'warn_error': 'None', 'log_path': '/opt/airflow/include/dbt/logs', 'partial_parse': 'True', 'use_colors': 'True', 'write_json': 'True', 'invocation_command': 'dbt docs generate --profiles-dir /opt/airflow/include/dbt/', 'debug': 'False', 'empty': 'None', 'profiles_dir': '/opt/airflow/include/dbt/', 'log_cache_events': 'False', 'static_parser': 'True', 'version_check': 'True', 'use_experimental_parser': 'False', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])'}
[0m20:06:54.198157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1be5a5f6-11c6-420a-abcd-87c0b6214a50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efedd44bbe0>]}
[0m20:06:54.350731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1be5a5f6-11c6-420a-abcd-87c0b6214a50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efea8655cd0>]}
[0m20:06:54.353909 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m20:06:54.747107 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m20:06:58.222179 [debug] [MainThread]: Partial parsing enabled: 5 files deleted, 0 files added, 0 files changed.
[0m20:06:58.225245 [debug] [MainThread]: Partial parsing: deleted file: nyc_taxi://models/tests/test_total_amount_positive.sql
[0m20:06:58.227882 [debug] [MainThread]: Partial parsing: deleted file: nyc_taxi://models/tests/test_tolls_amount_positive.sql
[0m20:06:58.230525 [debug] [MainThread]: Partial parsing: deleted file: nyc_taxi://models/tests/test_mta_tax_positive.sql
[0m20:06:58.232941 [debug] [MainThread]: Partial parsing: deleted file: nyc_taxi://models/tests/test_fare_amount_positive.sql
[0m20:06:58.235410 [debug] [MainThread]: Partial parsing: deleted file: nyc_taxi://models/tests/test_tip_amount_positive.sql
[0m20:06:59.360514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1be5a5f6-11c6-420a-abcd-87c0b6214a50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efed6e05130>]}
[0m20:06:59.575604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1be5a5f6-11c6-420a-abcd-87c0b6214a50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efed70929a0>]}
[0m20:06:59.579364 [info ] [MainThread]: Found 5 models, 23 data tests, 2 sources, 600 macros
[0m20:06:59.583915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1be5a5f6-11c6-420a-abcd-87c0b6214a50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efed7092910>]}
[0m20:06:59.595881 [info ] [MainThread]: 
[0m20:06:59.608596 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m20:06:59.640528 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_northern-shield-437204-m0_nyc_taxi'
[0m20:06:59.643729 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:07:00.486134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1be5a5f6-11c6-420a-abcd-87c0b6214a50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efed6ec3640>]}
[0m20:07:00.490090 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:07:00.493226 [info ] [MainThread]: 
[0m20:07:00.516034 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_payment
[0m20:07:00.520021 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_northern-shield-437204-m0_nyc_taxi, now model.nyc_taxi.dim_payment)
[0m20:07:00.523061 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_payment
[0m20:07:00.561039 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_payment"
[0m20:07:00.578743 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_payment
[0m20:07:00.583345 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_payment
[0m20:07:00.586687 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_ratecode
[0m20:07:00.589975 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_payment, now model.nyc_taxi.dim_ratecode)
[0m20:07:00.593030 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_ratecode
[0m20:07:00.605606 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_ratecode"
[0m20:07:00.623801 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_ratecode
[0m20:07:00.628353 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_ratecode
[0m20:07:00.631551 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_vendor
[0m20:07:00.634918 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_ratecode, now model.nyc_taxi.dim_vendor)
[0m20:07:00.637955 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_vendor
[0m20:07:00.648456 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_vendor"
[0m20:07:00.668341 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_vendor
[0m20:07:00.673498 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_vendor
[0m20:07:00.677390 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_zone
[0m20:07:00.681491 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_vendor, now model.nyc_taxi.dim_zone)
[0m20:07:00.684781 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_zone
[0m20:07:00.700222 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_zone"
[0m20:07:00.720905 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_zone
[0m20:07:00.725383 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_zone
[0m20:07:00.728852 [debug] [Thread-1  ]: Began running node model.nyc_taxi.fct_trips
[0m20:07:00.732607 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_zone, now model.nyc_taxi.fct_trips)
[0m20:07:00.735696 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.fct_trips
[0m20:07:00.783114 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.fct_trips"
[0m20:07:00.801705 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.fct_trips
[0m20:07:00.806429 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.fct_trips
[0m20:07:00.809876 [debug] [Thread-1  ]: Began running node test.nyc_taxi.accepted_values_dim_payment_payment_name__Credit_card__Cash__No_charge__Dispute__Unknown__Voided_trip.58d00ef9f4
[0m20:07:00.813642 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.fct_trips, now test.nyc_taxi.accepted_values_dim_payment_payment_name__Credit_card__Cash__No_charge__Dispute__Unknown__Voided_trip.58d00ef9f4)
[0m20:07:00.816145 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.accepted_values_dim_payment_payment_name__Credit_card__Cash__No_charge__Dispute__Unknown__Voided_trip.58d00ef9f4
[0m20:07:00.870457 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.accepted_values_dim_payment_payment_name__Credit_card__Cash__No_charge__Dispute__Unknown__Voided_trip.58d00ef9f4"
[0m20:07:00.894943 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.accepted_values_dim_payment_payment_name__Credit_card__Cash__No_charge__Dispute__Unknown__Voided_trip.58d00ef9f4
[0m20:07:00.899506 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.accepted_values_dim_payment_payment_name__Credit_card__Cash__No_charge__Dispute__Unknown__Voided_trip.58d00ef9f4
[0m20:07:00.903122 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_dim_payment_type_id.96dfa722aa
[0m20:07:00.906040 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.accepted_values_dim_payment_payment_name__Credit_card__Cash__No_charge__Dispute__Unknown__Voided_trip.58d00ef9f4, now test.nyc_taxi.not_null_dim_payment_type_id.96dfa722aa)
[0m20:07:00.909106 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_dim_payment_type_id.96dfa722aa
[0m20:07:00.950636 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_dim_payment_type_id.96dfa722aa"
[0m20:07:00.990771 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_dim_payment_type_id.96dfa722aa
[0m20:07:00.995662 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_dim_payment_type_id.96dfa722aa
[0m20:07:01.000333 [debug] [Thread-1  ]: Began running node test.nyc_taxi.unique_dim_payment_type_id.dea55de04e
[0m20:07:01.004233 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_dim_payment_type_id.96dfa722aa, now test.nyc_taxi.unique_dim_payment_type_id.dea55de04e)
[0m20:07:01.008168 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.unique_dim_payment_type_id.dea55de04e
[0m20:07:01.041724 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.unique_dim_payment_type_id.dea55de04e"
[0m20:07:01.060075 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.unique_dim_payment_type_id.dea55de04e
[0m20:07:01.064212 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.unique_dim_payment_type_id.dea55de04e
[0m20:07:01.073782 [debug] [Thread-1  ]: Began running node test.nyc_taxi.accepted_values_dim_ratecode_rate_code_name__Standard_rate__JFK__Newark__Nassau_or_Westchester__Negotiated_fare__Group_ride__Unknown.57ee02019f
[0m20:07:01.077073 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.unique_dim_payment_type_id.dea55de04e, now test.nyc_taxi.accepted_values_dim_ratecode_rate_code_name__Standard_rate__JFK__Newark__Nassau_or_Westchester__Negotiated_fare__Group_ride__Unknown.57ee02019f)
[0m20:07:01.079838 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.accepted_values_dim_ratecode_rate_code_name__Standard_rate__JFK__Newark__Nassau_or_Westchester__Negotiated_fare__Group_ride__Unknown.57ee02019f
[0m20:07:01.110077 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.accepted_values_dim_ratecode_rate_code_name__Standard_rate__JFK__Newark__Nassau_or_Westchester__Negotiated_fare__Group_ride__Unknown.57ee02019f"
[0m20:07:01.124352 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.accepted_values_dim_ratecode_rate_code_name__Standard_rate__JFK__Newark__Nassau_or_Westchester__Negotiated_fare__Group_ride__Unknown.57ee02019f
[0m20:07:01.128568 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.accepted_values_dim_ratecode_rate_code_name__Standard_rate__JFK__Newark__Nassau_or_Westchester__Negotiated_fare__Group_ride__Unknown.57ee02019f
[0m20:07:01.131475 [debug] [Thread-1  ]: Began running node test.nyc_taxi.unique_dim_ratecode_rate_id.75ae8e4885
[0m20:07:01.134180 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.accepted_values_dim_ratecode_rate_code_name__Standard_rate__JFK__Newark__Nassau_or_Westchester__Negotiated_fare__Group_ride__Unknown.57ee02019f, now test.nyc_taxi.unique_dim_ratecode_rate_id.75ae8e4885)
[0m20:07:01.137180 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.unique_dim_ratecode_rate_id.75ae8e4885
[0m20:07:01.152105 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.unique_dim_ratecode_rate_id.75ae8e4885"
[0m20:07:01.173515 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.unique_dim_ratecode_rate_id.75ae8e4885
[0m20:07:01.178398 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.unique_dim_ratecode_rate_id.75ae8e4885
[0m20:07:01.181097 [debug] [Thread-1  ]: Began running node test.nyc_taxi.accepted_values_dim_vendor_vendor_name__Creative_Mobile_Technologies__VeriFone_Inc_.7481cecf07
[0m20:07:01.184206 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.unique_dim_ratecode_rate_id.75ae8e4885, now test.nyc_taxi.accepted_values_dim_vendor_vendor_name__Creative_Mobile_Technologies__VeriFone_Inc_.7481cecf07)
[0m20:07:01.187010 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.accepted_values_dim_vendor_vendor_name__Creative_Mobile_Technologies__VeriFone_Inc_.7481cecf07
[0m20:07:01.208583 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.accepted_values_dim_vendor_vendor_name__Creative_Mobile_Technologies__VeriFone_Inc_.7481cecf07"
[0m20:07:01.228152 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.accepted_values_dim_vendor_vendor_name__Creative_Mobile_Technologies__VeriFone_Inc_.7481cecf07
[0m20:07:01.232905 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.accepted_values_dim_vendor_vendor_name__Creative_Mobile_Technologies__VeriFone_Inc_.7481cecf07
[0m20:07:01.236552 [debug] [Thread-1  ]: Began running node test.nyc_taxi.unique_dim_vendor_id.03fad38d04
[0m20:07:01.239423 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.accepted_values_dim_vendor_vendor_name__Creative_Mobile_Technologies__VeriFone_Inc_.7481cecf07, now test.nyc_taxi.unique_dim_vendor_id.03fad38d04)
[0m20:07:01.242379 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.unique_dim_vendor_id.03fad38d04
[0m20:07:01.259327 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.unique_dim_vendor_id.03fad38d04"
[0m20:07:01.278226 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.unique_dim_vendor_id.03fad38d04
[0m20:07:01.282983 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.unique_dim_vendor_id.03fad38d04
[0m20:07:01.286277 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_dim_zone_borough.1ed2272c52
[0m20:07:01.289436 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.unique_dim_vendor_id.03fad38d04, now test.nyc_taxi.not_null_dim_zone_borough.1ed2272c52)
[0m20:07:01.292538 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_dim_zone_borough.1ed2272c52
[0m20:07:01.311286 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_dim_zone_borough.1ed2272c52"
[0m20:07:01.328105 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_dim_zone_borough.1ed2272c52
[0m20:07:01.332721 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_dim_zone_borough.1ed2272c52
[0m20:07:01.338761 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_dim_zone_service_zone.2007f611c5
[0m20:07:01.341863 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_dim_zone_borough.1ed2272c52, now test.nyc_taxi.not_null_dim_zone_service_zone.2007f611c5)
[0m20:07:01.344914 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_dim_zone_service_zone.2007f611c5
[0m20:07:01.362667 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_dim_zone_service_zone.2007f611c5"
[0m20:07:01.386564 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_dim_zone_service_zone.2007f611c5
[0m20:07:01.391026 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_dim_zone_service_zone.2007f611c5
[0m20:07:01.394371 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_dim_zone_zone.a1c4a4c37a
[0m20:07:01.397626 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_dim_zone_service_zone.2007f611c5, now test.nyc_taxi.not_null_dim_zone_zone.a1c4a4c37a)
[0m20:07:01.401161 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_dim_zone_zone.a1c4a4c37a
[0m20:07:01.414969 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_dim_zone_zone.a1c4a4c37a"
[0m20:07:01.439577 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_dim_zone_zone.a1c4a4c37a
[0m20:07:01.444598 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_dim_zone_zone.a1c4a4c37a
[0m20:07:01.448401 [debug] [Thread-1  ]: Began running node test.nyc_taxi.unique_dim_zone_location_id.7702f92424
[0m20:07:01.451593 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_dim_zone_zone.a1c4a4c37a, now test.nyc_taxi.unique_dim_zone_location_id.7702f92424)
[0m20:07:01.454531 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.unique_dim_zone_location_id.7702f92424
[0m20:07:01.470637 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.unique_dim_zone_location_id.7702f92424"
[0m20:07:01.488073 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.unique_dim_zone_location_id.7702f92424
[0m20:07:01.492372 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.unique_dim_zone_location_id.7702f92424
[0m20:07:01.495895 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_do_location_id.6acdd302a6
[0m20:07:01.499052 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.unique_dim_zone_location_id.7702f92424, now test.nyc_taxi.not_null_fct_trips_do_location_id.6acdd302a6)
[0m20:07:01.501914 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_do_location_id.6acdd302a6
[0m20:07:01.519968 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_do_location_id.6acdd302a6"
[0m20:07:01.539816 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_do_location_id.6acdd302a6
[0m20:07:01.544499 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_do_location_id.6acdd302a6
[0m20:07:01.547866 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_dropoff_time.04b71dc609
[0m20:07:01.551182 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_do_location_id.6acdd302a6, now test.nyc_taxi.not_null_fct_trips_dropoff_time.04b71dc609)
[0m20:07:01.554483 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_dropoff_time.04b71dc609
[0m20:07:01.572143 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_dropoff_time.04b71dc609"
[0m20:07:01.595042 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_dropoff_time.04b71dc609
[0m20:07:01.599200 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_dropoff_time.04b71dc609
[0m20:07:01.602720 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_extra.1801055bb3
[0m20:07:01.605835 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_dropoff_time.04b71dc609, now test.nyc_taxi.not_null_fct_trips_extra.1801055bb3)
[0m20:07:01.609049 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_extra.1801055bb3
[0m20:07:01.625681 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_extra.1801055bb3"
[0m20:07:01.645969 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_extra.1801055bb3
[0m20:07:01.650609 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_extra.1801055bb3
[0m20:07:01.654118 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_improvement_surcharge.4cf28d1443
[0m20:07:01.657667 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_extra.1801055bb3, now test.nyc_taxi.not_null_fct_trips_improvement_surcharge.4cf28d1443)
[0m20:07:01.660519 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_improvement_surcharge.4cf28d1443
[0m20:07:01.677723 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_improvement_surcharge.4cf28d1443"
[0m20:07:01.699698 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_improvement_surcharge.4cf28d1443
[0m20:07:01.704673 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_improvement_surcharge.4cf28d1443
[0m20:07:01.707666 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_passenger_count.b1370cab1c
[0m20:07:01.710358 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_improvement_surcharge.4cf28d1443, now test.nyc_taxi.not_null_fct_trips_passenger_count.b1370cab1c)
[0m20:07:01.713573 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_passenger_count.b1370cab1c
[0m20:07:01.727596 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_passenger_count.b1370cab1c"
[0m20:07:01.746452 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_passenger_count.b1370cab1c
[0m20:07:01.750518 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_passenger_count.b1370cab1c
[0m20:07:01.753659 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_payment_type.93889b679a
[0m20:07:01.757112 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_passenger_count.b1370cab1c, now test.nyc_taxi.not_null_fct_trips_payment_type.93889b679a)
[0m20:07:01.760748 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_payment_type.93889b679a
[0m20:07:01.781099 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_payment_type.93889b679a"
[0m20:07:01.800467 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_payment_type.93889b679a
[0m20:07:01.805377 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_payment_type.93889b679a
[0m20:07:01.809205 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_pickup_time.693af2bf31
[0m20:07:01.812760 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_payment_type.93889b679a, now test.nyc_taxi.not_null_fct_trips_pickup_time.693af2bf31)
[0m20:07:01.816339 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_pickup_time.693af2bf31
[0m20:07:01.834303 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_pickup_time.693af2bf31"
[0m20:07:01.853664 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_pickup_time.693af2bf31
[0m20:07:01.858247 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_pickup_time.693af2bf31
[0m20:07:01.861356 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_pu_location_id.b0dc8dd185
[0m20:07:01.864395 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_pickup_time.693af2bf31, now test.nyc_taxi.not_null_fct_trips_pu_location_id.b0dc8dd185)
[0m20:07:01.867366 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_pu_location_id.b0dc8dd185
[0m20:07:01.885312 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_pu_location_id.b0dc8dd185"
[0m20:07:01.907295 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_pu_location_id.b0dc8dd185
[0m20:07:01.911717 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_pu_location_id.b0dc8dd185
[0m20:07:01.915092 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_rate_code_id.ba0047eaae
[0m20:07:01.917976 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_pu_location_id.b0dc8dd185, now test.nyc_taxi.not_null_fct_trips_rate_code_id.ba0047eaae)
[0m20:07:01.920763 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_rate_code_id.ba0047eaae
[0m20:07:01.937979 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_rate_code_id.ba0047eaae"
[0m20:07:01.963277 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_rate_code_id.ba0047eaae
[0m20:07:01.967724 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_rate_code_id.ba0047eaae
[0m20:07:01.971245 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_trip_distance.19cd17f1df
[0m20:07:01.974459 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_rate_code_id.ba0047eaae, now test.nyc_taxi.not_null_fct_trips_trip_distance.19cd17f1df)
[0m20:07:01.977485 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_trip_distance.19cd17f1df
[0m20:07:01.995465 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_trip_distance.19cd17f1df"
[0m20:07:02.016556 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_trip_distance.19cd17f1df
[0m20:07:02.021401 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_trip_distance.19cd17f1df
[0m20:07:02.024668 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_vendor_id.b9b2f380bb
[0m20:07:02.027614 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_trip_distance.19cd17f1df, now test.nyc_taxi.not_null_fct_trips_vendor_id.b9b2f380bb)
[0m20:07:02.030558 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_vendor_id.b9b2f380bb
[0m20:07:02.045219 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_vendor_id.b9b2f380bb"
[0m20:07:02.067383 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_vendor_id.b9b2f380bb
[0m20:07:02.071421 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_vendor_id.b9b2f380bb
[0m20:07:02.074865 [debug] [Thread-1  ]: Began running node test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab
[0m20:07:02.077958 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_vendor_id.b9b2f380bb, now test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab)
[0m20:07:02.080823 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab
[0m20:07:02.098703 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab"
[0m20:07:02.124254 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab
[0m20:07:02.128979 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab
[0m20:07:02.134403 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:07:02.137385 [debug] [MainThread]: Connection 'test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab' was properly closed.
[0m20:07:02.173613 [debug] [MainThread]: Command end result
[0m20:07:02.723914 [debug] [MainThread]: Acquiring new bigquery connection 'generate_catalog'
[0m20:07:02.726904 [info ] [MainThread]: Building catalog
[0m20:07:02.751798 [debug] [ThreadPool]: Acquiring new bigquery connection 'northern-shield-437204-m0.information_schema'
[0m20:07:02.812127 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:07:02.820256 [debug] [ThreadPool]: On northern-shield-437204-m0.information_schema: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "connection_name": "northern-shield-437204-m0.information_schema"} */

    with
                table_shards_stage as (
    select
        tables.project_id as table_catalog,
        tables.dataset_id as table_schema,
        coalesce(REGEXP_EXTRACT(tables.table_id, '^(.+)[0-9]{8}$'), tables.table_id) as table_name,
        tables.table_id as shard_name,
        REGEXP_EXTRACT(tables.table_id, '^.+([0-9]{8})$') as shard_index,
        REGEXP_CONTAINS(tables.table_id, '^.+[0-9]{8}$') and tables.type = 1 as is_date_shard,
        case
            when materialized_views.table_name is not null then 'materialized view'
            when tables.type = 1 then 'table'
            when tables.type = 2 then 'view'
            else 'external'
        end as table_type,
        tables.type = 1 as is_table,
        JSON_VALUE(table_description.option_value) as table_comment,
        tables.size_bytes,
        tables.row_count
    from `northern-shield-437204-m0`.`nyc_taxi`.__TABLES__ tables
    left join `northern-shield-437204-m0`.`nyc_taxi`.INFORMATION_SCHEMA.MATERIALIZED_VIEWS materialized_views
        on materialized_views.table_catalog = tables.project_id
        and materialized_views.table_schema = tables.dataset_id
        and materialized_views.table_name = tables.table_id
    left join `northern-shield-437204-m0`.`nyc_taxi`.INFORMATION_SCHEMA.TABLE_OPTIONS table_description
        on table_description.table_catalog = tables.project_id
        and table_description.table_schema = tables.dataset_id
        and table_description.table_name = tables.table_id
        and table_description.option_name = 'description'
),
                table_shards as (
                    select * from table_shards_stage
                    where ((
                                upper(table_schema) = upper('nyc_taxi')
                            and upper(table_name) = upper('dim_vendor')
                            ) or (
                                upper(table_schema) = upper('nyc_taxi')
                            and upper(table_name) = upper('zone_map')
                            ) or (
                                upper(table_schema) = upper('nyc_taxi')
                            and upper(table_name) = upper('dim_ratecode')
                            ) or (
                                upper(table_schema) = upper('nyc_taxi')
                            and upper(table_name) = upper('fct_trips')
                            ) or (
                                upper(table_schema) = upper('nyc_taxi')
                            and upper(table_name) = upper('dim_payment')
                            ) or (
                                upper(table_schema) = upper('nyc_taxi')
                            and upper(table_name) = upper('dim_zone')
                            ) or (
                                upper(table_schema) = upper('nyc_taxi')
                            and upper(table_name) = upper('green_tripdata')
                            ))
                ),
                tables as (
    select distinct
        table_catalog,
        table_schema,
        table_name,
        is_date_shard,
        table_type,
        is_table,
        table_comment
    from table_shards
),
                table_stats as (
    select
        table_catalog,
        table_schema,
        table_name,
        max(shard_name) as latest_shard_name,
        min(shard_index) as shard_min,
        max(shard_index) as shard_max,
        count(shard_index) as shard_count,
        sum(size_bytes) as size_bytes,
        sum(row_count) as row_count
    from table_shards
    group by 1, 2, 3
),

                columns as (
    select
        columns.table_catalog,
        columns.table_schema,
        columns.table_name as shard_name,
        coalesce(paths.field_path, '<unknown>') as column_name,
        -- invent a row number to account for nested fields
        -- BQ does not treat these nested properties as independent fields
        row_number() over (
            partition by
                columns.table_catalog,
                columns.table_schema,
                columns.table_name
            order by
                columns.ordinal_position,
                paths.field_path
        ) as column_index,
        coalesce(paths.data_type, '<unknown>') as column_type,
        paths.description as column_comment,
        case when columns.is_partitioning_column = 'YES' then 1 else 0 end as is_partitioning_column,
        case when columns.is_partitioning_column = 'YES' then paths.field_path end as partition_column,
        case when columns.clustering_ordinal_position is not null then 1 else 0 end as is_clustering_column,
        case when columns.clustering_ordinal_position is not null then paths.field_path end as cluster_column,
        columns.clustering_ordinal_position
    from `northern-shield-437204-m0`.`nyc_taxi`.INFORMATION_SCHEMA.COLUMNS columns
    join `northern-shield-437204-m0`.`nyc_taxi`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS paths
        on paths.table_catalog = columns.table_catalog
        and paths.table_schema = columns.table_schema
        and paths.table_name = columns.table_name
        and paths.column_name = columns.column_name
    where columns.ordinal_position is not null
),
                column_stats as (
    select
        table_catalog,
        table_schema,
        shard_name,
        max(is_partitioning_column) = 1 as is_partitioned,
        max(partition_column) as partition_column,
        max(is_clustering_column) = 1 as is_clustered,
        array_to_string(
            array_agg(
                cluster_column ignore nulls
                order by clustering_ordinal_position
            ), ', '
        ) as clustering_columns
    from columns
    group by 1, 2, 3
)

            
    select
        tables.table_catalog as table_database,
        tables.table_schema,
        case
            when tables.is_date_shard then concat(tables.table_name, '*')
            else tables.table_name
        end as table_name,
        tables.table_type,
        tables.table_comment,
        -- coalesce column metadata fields to ensure they are non-null for catalog generation
        -- external table columns are not present in COLUMN_FIELD_PATHS
        coalesce(columns.column_name, '<unknown>') as column_name,
        coalesce(columns.column_index, 1) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        coalesce(columns.column_comment, '') as column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_stats.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        tables.is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_stats.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        tables.is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_stats.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        tables.is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        table_stats.row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        tables.is_table as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        table_stats.size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        tables.is_table as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        column_stats.partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        column_stats.is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        column_stats.clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        column_stats.is_clustered as `stats__clustering_fields__include`

    from tables
    join table_stats
        on table_stats.table_catalog = tables.table_catalog
        and table_stats.table_schema = tables.table_schema
        and table_stats.table_name = tables.table_name
    left join column_stats
        on column_stats.table_catalog = tables.table_catalog
        and column_stats.table_schema = tables.table_schema
        and column_stats.shard_name = table_stats.latest_shard_name
    left join columns
        on columns.table_catalog = tables.table_catalog
        and columns.table_schema = tables.table_schema
        and columns.shard_name = table_stats.latest_shard_name

  
[0m20:07:03.745194 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:0acd52f7-63e7-48ee-8ad5-8dda30de1324&page=queryresults
[0m20:07:06.443522 [info ] [MainThread]: Catalog written to /opt/airflow/include/dbt/target/catalog.json
[0m20:07:06.448177 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 13.626583, "process_in_blocks": "0", "process_kernel_time": 0.900587, "process_mem_max_rss": "228284", "process_out_blocks": "0", "process_user_time": 11.697036}
[0m20:07:06.451885 [debug] [MainThread]: Command `dbt docs generate` succeeded at 20:07:06.451514 after 13.63 seconds
[0m20:07:06.454916 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m20:07:06.457820 [debug] [MainThread]: Connection 'northern-shield-437204-m0.information_schema' was properly closed.
[0m20:07:06.460678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efeddbf4fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efea8655cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efed6e24bb0>]}
[0m20:07:06.463492 [debug] [MainThread]: Flushing usage events
[0m20:08:32.305139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a8f5e5ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a8d431fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a8d431f70>]}


============================== 20:08:32.320718 | 46b35a5b-0fca-4907-8cd1-bfe64c228fed ==============================
[0m20:08:32.320718 [info ] [MainThread]: Running with dbt=1.8.9
[0m20:08:32.323812 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True', 'log_path': '/opt/airflow/include/dbt/logs', 'invocation_command': 'dbt docs serve --profiles-dir /opt/airflow/include/dbt/ --port 8087 --host 0.0.0.0', 'warn_error': 'None', 'use_colors': 'True', 'introspect': 'True', 'empty': 'None', 'profiles_dir': '/opt/airflow/include/dbt/', 'version_check': 'True', 'use_experimental_parser': 'False', 'target_path': 'None', 'log_cache_events': 'False', 'debug': 'False', 'static_parser': 'True', 'printer_width': '80', 'log_format': 'default', 'write_json': 'True', 'no_print': 'None', 'fail_fast': 'False', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'indirect_selection': 'eager'}
[0m20:08:35.801539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '46b35a5b-0fca-4907-8cd1-bfe64c228fed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a8d475850>]}
[0m20:08:35.976425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '46b35a5b-0fca-4907-8cd1-bfe64c228fed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a8e780700>]}
[0m19:47:07.648010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87cf681f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87cd4558b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87cd455850>]}


============================== 19:47:07.665845 | 444059d0-f678-47ff-8c76-86c6fb0d7f3e ==============================
[0m19:47:07.665845 [info ] [MainThread]: Running with dbt=1.8.9
[0m19:47:07.670900 [debug] [MainThread]: running dbt with arguments {'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'no_print': 'None', 'cache_selected_only': 'False', 'empty': 'None', 'profiles_dir': '/opt/airflow/include/dbt', 'debug': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'use_experimental_parser': 'False', 'warn_error': 'None', 'write_json': 'True', 'indirect_selection': 'eager', 'version_check': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'invocation_command': 'dbt deps', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/include/dbt/logs', 'printer_width': '80', 'target_path': 'None', 'use_colors': 'True'}
[0m19:47:08.009478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '444059d0-f678-47ff-8c76-86c6fb0d7f3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87cd47fd60>]}
[0m19:47:08.810503 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-f7hj_pbc'
[0m19:47:08.813020 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m19:47:08.941276 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m19:47:08.944824 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m19:47:09.018542 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m19:47:09.037017 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m19:47:15.468373 [info ] [MainThread]: Installed from version 1.3.0
[0m19:47:15.471259 [info ] [MainThread]: Up to date!
[0m19:47:15.474266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '444059d0-f678-47ff-8c76-86c6fb0d7f3e', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87cd3d9400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87cd43d070>]}
[0m19:47:15.479327 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 8.0614395, "process_in_blocks": "32432", "process_kernel_time": 0.87351, "process_mem_max_rss": "95588", "process_out_blocks": "176", "process_user_time": 5.590467}
[0m19:47:15.483290 [debug] [MainThread]: Command `dbt deps` succeeded at 19:47:15.482884 after 8.07 seconds
[0m19:47:15.486340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87cf681f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87ce83a730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87cd43d070>]}
[0m19:47:15.489051 [debug] [MainThread]: Flushing usage events
[0m19:47:50.774942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f769ccf70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f747a29d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f747a2970>]}


============================== 19:47:50.792830 | a59a8231-4d2b-49c4-8674-1b34ffd99374 ==============================
[0m19:47:50.792830 [info ] [MainThread]: Running with dbt=1.8.9
[0m19:47:50.796488 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'log_format': 'default', 'log_cache_events': 'False', 'debug': 'False', 'target_path': 'None', 'use_colors': 'True', 'warn_error': 'None', 'printer_width': '80', 'cache_selected_only': 'False', 'log_path': '/opt/airflow/include/dbt/logs', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/include/dbt/', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'no_print': 'None', 'use_experimental_parser': 'False', 'quiet': 'False', 'version_check': 'True', 'empty': 'False', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'write_json': 'True', 'profiles_dir': '/opt/airflow/include/dbt/', 'indirect_selection': 'eager', 'partial_parse': 'True', 'static_parser': 'True'}
[0m19:47:54.972777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a59a8231-4d2b-49c4-8674-1b34ffd99374', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f761b4fd0>]}
[0m19:47:55.149454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a59a8231-4d2b-49c4-8674-1b34ffd99374', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f3e0674f0>]}
[0m19:47:55.153258 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m19:47:55.739559 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m19:47:58.936308 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 5 files changed.
[0m19:47:58.940118 [debug] [MainThread]: Partial parsing: added file: nyc_taxi://models/transform/dim_time.sql
[0m19:47:58.944463 [debug] [MainThread]: Partial parsing: updated file: nyc_taxi://models/tests/schema.yml
[0m19:47:58.947224 [debug] [MainThread]: Partial parsing: updated file: dbt://macros/materializations/snapshots/snapshot.sql
[0m19:47:58.949723 [debug] [MainThread]: Partial parsing: updated file: nyc_taxi://models/transform/fct_trips.sql
[0m19:47:58.952751 [debug] [MainThread]: Partial parsing: updated file: dbt://macros/materializations/snapshots/helpers.sql
[0m19:47:58.955168 [debug] [MainThread]: Partial parsing: updated file: dbt://macros/materializations/snapshots/strategies.sql
[0m19:48:00.238456 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m19:48:00.241540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'a59a8231-4d2b-49c4-8674-1b34ffd99374', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f3d40f7f0>]}
[0m19:48:00.800966 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.nyc_taxi.fct_trips' (models/transform/fct_trips.sql) depends on a source named 'nyc_taxi.dim_time' which was not found
[0m19:48:00.805641 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 10.221841, "process_in_blocks": "170456", "process_kernel_time": 1.057145, "process_mem_max_rss": "227576", "process_out_blocks": "0", "process_user_time": 12.319813}
[0m19:48:00.809069 [debug] [MainThread]: Command `dbt run` failed at 19:48:00.808707 after 10.23 seconds
[0m19:48:00.812300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f769ccf70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f6fd2c4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f6fc30bb0>]}
[0m19:48:00.815321 [debug] [MainThread]: Flushing usage events
[0m19:49:20.945191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a03ccff40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a01aa28b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a01aa2850>]}


============================== 19:49:20.961814 | a40254c4-9f99-419a-ad26-8b4c8a362be0 ==============================
[0m19:49:20.961814 [info ] [MainThread]: Running with dbt=1.8.9
[0m19:49:20.965150 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt debug --profiles-dir /opt/airflow/include/dbt/', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'log_cache_events': 'False', 'quiet': 'False', 'target_path': 'None', 'partial_parse': 'True', 'indirect_selection': 'eager', 'no_print': 'None', 'profiles_dir': '/opt/airflow/include/dbt/', 'warn_error': 'None', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'log_format': 'default', 'empty': 'None', 'cache_selected_only': 'False', 'version_check': 'True', 'static_parser': 'True', 'debug': 'False', 'use_experimental_parser': 'False', 'printer_width': '80', 'write_json': 'True', 'log_path': '/opt/airflow/include/dbt/logs', 'introspect': 'True'}
[0m19:49:20.994957 [info ] [MainThread]: dbt version: 1.8.9
[0m19:49:20.998341 [info ] [MainThread]: python version: 3.9.19
[0m19:49:21.001754 [info ] [MainThread]: python path: /opt/airflow/dbt_venv/bin/python
[0m19:49:21.004435 [info ] [MainThread]: os info: Linux-5.15.167.4-microsoft-standard-WSL2-x86_64-with-glibc2.36
[0m19:49:23.561398 [info ] [MainThread]: Using profiles dir at /opt/airflow/include/dbt/
[0m19:49:23.565481 [info ] [MainThread]: Using profiles.yml file at /opt/airflow/include/dbt/profiles.yml
[0m19:49:23.569685 [info ] [MainThread]: Using dbt_project.yml file at /opt/airflow/include/dbt/dbt_project.yml
[0m19:49:23.573699 [info ] [MainThread]: adapter type: bigquery
[0m19:49:23.577688 [info ] [MainThread]: adapter version: 1.8.3
[0m19:49:23.976471 [info ] [MainThread]: Configuration:
[0m19:49:23.980367 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m19:49:23.983741 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m19:49:23.986431 [info ] [MainThread]: Required dependencies:
[0m19:49:23.989292 [debug] [MainThread]: Executing "git --help"
[0m19:49:24.027969 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m19:49:24.032034 [debug] [MainThread]: STDERR: "b''"
[0m19:49:24.035665 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m19:49:24.039226 [info ] [MainThread]: Connection:
[0m19:49:24.042125 [info ] [MainThread]:   method: service-account
[0m19:49:24.044555 [info ] [MainThread]:   database: northern-shield-437204-m0
[0m19:49:24.047680 [info ] [MainThread]:   execution_project: northern-shield-437204-m0
[0m19:49:24.050786 [info ] [MainThread]:   schema: nyc_taxi
[0m19:49:24.053618 [info ] [MainThread]:   location: us-central1
[0m19:49:24.056465 [info ] [MainThread]:   priority: None
[0m19:49:24.059372 [info ] [MainThread]:   maximum_bytes_billed: None
[0m19:49:24.062123 [info ] [MainThread]:   impersonate_service_account: None
[0m19:49:24.065048 [info ] [MainThread]:   job_retry_deadline_seconds: None
[0m19:49:24.068308 [info ] [MainThread]:   job_retries: 1
[0m19:49:24.071412 [info ] [MainThread]:   job_creation_timeout_seconds: None
[0m19:49:24.074566 [info ] [MainThread]:   job_execution_timeout_seconds: 300
[0m19:49:24.077424 [info ] [MainThread]:   timeout_seconds: 300
[0m19:49:24.080914 [info ] [MainThread]:   client_id: None
[0m19:49:24.083595 [info ] [MainThread]:   token_uri: None
[0m19:49:24.086825 [info ] [MainThread]:   dataproc_region: None
[0m19:49:24.089723 [info ] [MainThread]:   dataproc_cluster_name: None
[0m19:49:24.092314 [info ] [MainThread]:   gcs_bucket: None
[0m19:49:24.094990 [info ] [MainThread]:   dataproc_batch: None
[0m19:49:24.098758 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m19:49:24.473366 [debug] [MainThread]: Acquiring new bigquery connection 'debug'
[0m19:49:24.477291 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:49:24.486708 [debug] [MainThread]: On debug: select 1 as id
[0m19:49:27.582247 [debug] [MainThread]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:55f2d660-2a25-4ae2-b38e-8c7d8e27f7df&page=queryresults
[0m19:49:29.590838 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m19:49:29.595800 [info ] [MainThread]: [32mAll checks passed![0m
[0m19:49:29.601901 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 8.838683, "process_in_blocks": "80", "process_kernel_time": 0.610548, "process_mem_max_rss": "239268", "process_out_blocks": "0", "process_user_time": 9.118187}
[0m19:49:29.606654 [debug] [MainThread]: Command `dbt debug` succeeded at 19:49:29.606133 after 8.84 seconds
[0m19:49:29.610192 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m19:49:29.613756 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a03ccff40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39ca68a130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39ca58ef40>]}
[0m19:49:29.618263 [debug] [MainThread]: Flushing usage events
[0m19:50:16.218101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdeda10af70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fded7ee0970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fded7ee0910>]}


============================== 19:50:16.234537 | 90a6b256-429e-446a-9c7f-eba201e62be4 ==============================
[0m19:50:16.234537 [info ] [MainThread]: Running with dbt=1.8.9
[0m19:50:16.239333 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'profiles_dir': '/opt/airflow/include/dbt/', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/include/dbt/', 'target_path': 'None', 'use_experimental_parser': 'False', 'version_check': 'True', 'quiet': 'False', 'indirect_selection': 'eager', 'fail_fast': 'False', 'printer_width': '80', 'cache_selected_only': 'False', 'no_print': 'None', 'write_json': 'True', 'partial_parse': 'True', 'use_colors': 'True', 'log_cache_events': 'False', 'log_path': '/opt/airflow/include/dbt/logs', 'warn_error': 'None', 'empty': 'False', 'debug': 'False'}
[0m19:50:18.836294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '90a6b256-429e-446a-9c7f-eba201e62be4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdea0b4fb80>]}
[0m19:50:19.010827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '90a6b256-429e-446a-9c7f-eba201e62be4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fded8c02910>]}
[0m19:50:19.014812 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m19:50:19.428527 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m19:50:22.641156 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 4 files changed.
[0m19:50:22.651403 [debug] [MainThread]: Partial parsing: added file: nyc_taxi://models/transform/dim_time.sql
[0m19:50:22.656580 [debug] [MainThread]: Partial parsing: updated file: dbt://macros/materializations/snapshots/snapshot.sql
[0m19:50:22.659734 [debug] [MainThread]: Partial parsing: updated file: nyc_taxi://models/transform/fct_trips.sql
[0m19:50:22.663006 [debug] [MainThread]: Partial parsing: updated file: dbt://macros/materializations/snapshots/strategies.sql
[0m19:50:22.666611 [debug] [MainThread]: Partial parsing: updated file: dbt://macros/materializations/snapshots/helpers.sql
[0m19:50:23.718891 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.nyc_taxi.fct_trips' (models/transform/fct_trips.sql) depends on a source named 'nyc_taxi.dim_time' which was not found
[0m19:50:23.724799 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 7.6903334, "process_in_blocks": "0", "process_kernel_time": 0.678032, "process_mem_max_rss": "227420", "process_out_blocks": "0", "process_user_time": 10.493853}
[0m19:50:23.728963 [debug] [MainThread]: Command `dbt run` failed at 19:50:23.728385 after 7.70 seconds
[0m19:50:23.732384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdeda10af70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fded3299fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fded322e0a0>]}
[0m19:50:23.735685 [debug] [MainThread]: Flushing usage events
[0m19:53:10.481435 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8916b04f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89148dba30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89148db9d0>]}


============================== 19:53:10.497876 | faa1a545-de60-4ab0-984e-377e9a6d0117 ==============================
[0m19:53:10.497876 [info ] [MainThread]: Running with dbt=1.8.9
[0m19:53:10.501726 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run --select fct_trips', 'warn_error': 'None', 'send_anonymous_usage_stats': 'True', 'empty': 'False', 'cache_selected_only': 'False', 'indirect_selection': 'eager', 'log_format': 'default', 'printer_width': '80', 'use_colors': 'True', 'log_path': '/opt/airflow/include/dbt/logs', 'target_path': 'None', 'debug': 'False', 'static_parser': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'version_check': 'True', 'write_json': 'True', 'no_print': 'None', 'log_cache_events': 'False', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/include/dbt', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True'}
[0m19:53:13.174878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'faa1a545-de60-4ab0-984e-377e9a6d0117', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f891491e160>]}
[0m19:53:13.329392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'faa1a545-de60-4ab0-984e-377e9a6d0117', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88dd4b6fa0>]}
[0m19:53:13.333222 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m19:53:13.800412 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m19:53:16.983518 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 4 files changed.
[0m19:53:16.987297 [debug] [MainThread]: Partial parsing: added file: nyc_taxi://models/transform/dim_time.sql
[0m19:53:16.993969 [debug] [MainThread]: Partial parsing: updated file: dbt://macros/materializations/snapshots/helpers.sql
[0m19:53:16.997614 [debug] [MainThread]: Partial parsing: updated file: dbt://macros/materializations/snapshots/strategies.sql
[0m19:53:17.000668 [debug] [MainThread]: Partial parsing: updated file: nyc_taxi://models/transform/fct_trips.sql
[0m19:53:17.003571 [debug] [MainThread]: Partial parsing: updated file: dbt://macros/materializations/snapshots/snapshot.sql
[0m19:53:18.071068 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.nyc_taxi.fct_trips' (models/transform/fct_trips.sql) depends on a source named 'nyc_taxi.dim_time' which was not found
[0m19:53:18.078045 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 7.7865205, "process_in_blocks": "0", "process_kernel_time": 0.898009, "process_mem_max_rss": "231108", "process_out_blocks": "0", "process_user_time": 10.576555}
[0m19:53:18.081598 [debug] [MainThread]: Command `dbt run` failed at 19:53:18.081136 after 7.79 seconds
[0m19:53:18.084667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8916b04f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8915d5c5b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f890fc1e100>]}
[0m19:53:18.087956 [debug] [MainThread]: Flushing usage events
[0m19:53:43.199918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffaf565b400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffaf3494a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffaf34949d0>]}


============================== 19:53:43.220273 | c27b12bb-4e2c-4bef-adca-8addf54c412a ==============================
[0m19:53:43.220273 [info ] [MainThread]: Running with dbt=1.8.9
[0m19:53:43.224666 [debug] [MainThread]: running dbt with arguments {'warn_error': 'None', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'printer_width': '80', 'use_colors': 'True', 'log_cache_events': 'False', 'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'cache_selected_only': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select dim_payment', 'target_path': 'None', 'empty': 'False', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'indirect_selection': 'eager', 'log_path': '/opt/airflow/include/dbt/logs', 'use_experimental_parser': 'False', 'debug': 'False', 'profiles_dir': '/opt/airflow/include/dbt', 'write_json': 'True', 'introspect': 'True', 'quiet': 'False'}
[0m19:53:46.457570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c27b12bb-4e2c-4bef-adca-8addf54c412a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffaf4891610>]}
[0m19:53:46.712409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c27b12bb-4e2c-4bef-adca-8addf54c412a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffac0df1be0>]}
[0m19:53:46.718161 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m19:53:47.456427 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m19:53:50.299419 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 4 files changed.
[0m19:53:50.303338 [debug] [MainThread]: Partial parsing: added file: nyc_taxi://models/transform/dim_time.sql
[0m19:53:50.308166 [debug] [MainThread]: Partial parsing: updated file: dbt://macros/materializations/snapshots/strategies.sql
[0m19:53:50.311302 [debug] [MainThread]: Partial parsing: updated file: nyc_taxi://models/transform/fct_trips.sql
[0m19:53:50.315295 [debug] [MainThread]: Partial parsing: updated file: dbt://macros/materializations/snapshots/helpers.sql
[0m19:53:50.318356 [debug] [MainThread]: Partial parsing: updated file: dbt://macros/materializations/snapshots/snapshot.sql
[0m19:53:51.316609 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.nyc_taxi.fct_trips' (models/transform/fct_trips.sql) depends on a source named 'nyc_taxi.dim_time' which was not found
[0m19:53:51.321261 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 8.323914, "process_in_blocks": "0", "process_kernel_time": 1.007922, "process_mem_max_rss": "227184", "process_out_blocks": "0", "process_user_time": 11.586121}
[0m19:53:51.325019 [debug] [MainThread]: Command `dbt run` failed at 19:53:51.324458 after 8.33 seconds
[0m19:53:51.328163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffaf565b400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffaf4cc4130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffaf494b790>]}
[0m19:53:51.331336 [debug] [MainThread]: Flushing usage events
[0m19:57:12.919455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4edf8fd430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4edd735a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4edd7359d0>]}


============================== 19:57:12.935968 | b7d6d45e-44fc-467a-bcfa-762be68ed5ab ==============================
[0m19:57:12.935968 [info ] [MainThread]: Running with dbt=1.8.9
[0m19:57:12.939859 [debug] [MainThread]: running dbt with arguments {'quiet': 'False', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'printer_width': '80', 'debug': 'False', 'log_path': '/opt/airflow/include/dbt/logs', 'log_format': 'default', 'warn_error': 'None', 'partial_parse': 'True', 'indirect_selection': 'eager', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/include/dbt/', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'empty': 'False', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'introspect': 'True', 'write_json': 'True', 'use_colors': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'target_path': 'None', 'no_print': 'None', 'profiles_dir': '/opt/airflow/include/dbt/'}
[0m19:57:15.807071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b7d6d45e-44fc-467a-bcfa-762be68ed5ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4edeb9f0d0>]}
[0m19:57:16.006861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b7d6d45e-44fc-467a-bcfa-762be68ed5ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ea70db6a0>]}
[0m19:57:16.010898 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m19:57:16.473434 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m19:57:19.244426 [debug] [MainThread]: Partial parsing enabled: 2 files deleted, 1 files added, 3 files changed.
[0m19:57:19.247753 [debug] [MainThread]: Partial parsing: added file: nyc_taxi://models/transform/dim_time.sql
[0m19:57:19.251722 [debug] [MainThread]: Partial parsing: deleted file: nyc_taxi://models/transform/fct_trips.sql
[0m19:57:19.254743 [debug] [MainThread]: Partial parsing: updated file: dbt://macros/materializations/snapshots/snapshot.sql
[0m19:57:19.258396 [debug] [MainThread]: Partial parsing: updated file: dbt://macros/materializations/snapshots/strategies.sql
[0m19:57:19.261634 [debug] [MainThread]: Partial parsing: updated file: dbt://macros/materializations/snapshots/helpers.sql
[0m19:57:20.563639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b7d6d45e-44fc-467a-bcfa-762be68ed5ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ed7f17ee0>]}
[0m19:57:20.966534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b7d6d45e-44fc-467a-bcfa-762be68ed5ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ed7e96880>]}
[0m19:57:20.969303 [info ] [MainThread]: Found 5 models, 2 sources, 600 macros
[0m19:57:20.972242 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b7d6d45e-44fc-467a-bcfa-762be68ed5ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ed8cb1ac0>]}
[0m19:57:20.978558 [info ] [MainThread]: 
[0m19:57:20.982019 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:57:21.008329 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_northern-shield-437204-m0'
[0m19:57:21.011513 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:57:22.063771 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_northern-shield-437204-m0, now list_northern-shield-437204-m0_nyc_taxi)
[0m19:57:22.067143 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:57:22.968381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b7d6d45e-44fc-467a-bcfa-762be68ed5ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ea6ffb5e0>]}
[0m19:57:22.971737 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:57:22.974826 [info ] [MainThread]: 
[0m19:57:22.992669 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_payment
[0m19:57:22.996126 [info ] [Thread-1  ]: 1 of 5 START sql table model nyc_taxi.dim_payment .............................. [RUN]
[0m19:57:22.999333 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_northern-shield-437204-m0_nyc_taxi, now model.nyc_taxi.dim_payment)
[0m19:57:23.001989 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_payment
[0m19:57:23.034550 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_payment"
[0m19:57:23.053151 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_payment
[0m19:57:23.187116 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.dim_payment"
[0m19:57:23.209643 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:57:23.219240 [debug] [Thread-1  ]: On model.nyc_taxi.dim_payment: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.dim_payment"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`dim_payment`
      
    
    

    OPTIONS()
    as (
      WITH payment_cte AS(
    SELECT DISTINCT
        payment_type AS type_id,
        CASE 
            WHEN payment_type = 1 THEN "Credit card"
            WHEN payment_type = 2 THEN "Cash"
            WHEN payment_type = 3 THEN "No charge"
            WHEN payment_type = 4 THEN "Dispute"
            WHEN payment_type = 5 THEN "Unknown"
            WHEN payment_type = 6 THEN "Voided trip"
        END AS payment_name
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata`
)
SELECT
    type_id,
    payment_name
FROM payment_cte
    );
  
[0m19:57:24.472206 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:635a909d-1613-44af-b127-108307660788&page=queryresults
[0m19:57:27.137294 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7d6d45e-44fc-467a-bcfa-762be68ed5ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ede4695b0>]}
[0m19:57:27.142891 [info ] [Thread-1  ]: 1 of 5 OK created sql table model nyc_taxi.dim_payment ......................... [[32mCREATE TABLE (4.0 rows, 463.5 KiB processed)[0m in 4.14s]
[0m19:57:27.147221 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_payment
[0m19:57:27.151031 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_ratecode
[0m19:57:27.154448 [info ] [Thread-1  ]: 2 of 5 START sql table model nyc_taxi.dim_ratecode ............................. [RUN]
[0m19:57:27.157788 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_payment, now model.nyc_taxi.dim_ratecode)
[0m19:57:27.160613 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_ratecode
[0m19:57:27.175325 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_ratecode"
[0m19:57:27.197449 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_ratecode
[0m19:57:27.211243 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.dim_ratecode"
[0m19:57:27.237234 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:57:27.248580 [debug] [Thread-1  ]: On model.nyc_taxi.dim_ratecode: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.dim_ratecode"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`dim_ratecode`
      
    
    

    OPTIONS()
    as (
      WITH rate_code_cte AS(
    SELECT DISTINCT
        rate_code_id AS rate_id,
        CASE 
            WHEN rate_code_id = 1 THEN "Standard rate"
            WHEN rate_code_id = 2 THEN "JFK"
            WHEN rate_code_id = 3 THEN "Newark"
            WHEN rate_code_id = 4 THEN "Nassau or Westchester"
            WHEN rate_code_id = 5 THEN "Negotiated fare"
            WHEN rate_code_id = 6 THEN "Group ride"
        ELSE "Unknown"
        END AS rate_code_name
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata`
)
SELECT
    rate_id,
    rate_code_name
FROM rate_code_cte
    );
  
[0m19:57:28.986403 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:ebd3edd1-477e-4d1b-b230-aeab3aa3a394&page=queryresults
[0m19:57:31.372530 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7d6d45e-44fc-467a-bcfa-762be68ed5ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ea6ffb5e0>]}
[0m19:57:31.377036 [info ] [Thread-1  ]: 2 of 5 OK created sql table model nyc_taxi.dim_ratecode ........................ [[32mCREATE TABLE (6.0 rows, 463.5 KiB processed)[0m in 4.21s]
[0m19:57:31.384372 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_ratecode
[0m19:57:31.387963 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_time
[0m19:57:31.391699 [info ] [Thread-1  ]: 3 of 5 START sql table model nyc_taxi.dim_time ................................. [RUN]
[0m19:57:31.394933 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_ratecode, now model.nyc_taxi.dim_time)
[0m19:57:31.398040 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_time
[0m19:57:31.410781 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_time"
[0m19:57:31.434216 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_time
[0m19:57:31.446377 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.dim_time"
[0m19:57:31.469978 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:57:31.480956 [debug] [Thread-1  ]: On model.nyc_taxi.dim_time: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.dim_time"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`dim_time`
      
    
    

    OPTIONS()
    as (
      WITH datetime_cte AS (
    SELECT DISTINCT
        lpep_pickup_datetime AS datetime_value
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata`
    UNION ALL
    SELECT DISTINCT
        lpep_dropoff_datetime AS datetime_value
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata`
)
SELECT DISTINCT
    ROW_NUMBER() OVER (ORDER BY datetime_value) AS time_id,
    DATE(datetime_value) AS date,
    datetime_value AS date_part,
    EXTRACT(YEAR FROM datetime_value) AS year,
    EXTRACT(MONTH FROM datetime_value) AS month,
    EXTRACT(DAY FROM datetime_value) AS day,
    EXTRACT(HOUR FROM datetime_value) AS hour,
    EXTRACT(MINUTE FROM datetime_value) AS minute,
    TO_CHAR(datetime_value, 'Day') AS weekday
FROM datetime_cte
ORDER BY time_id;
    );
  
[0m19:57:32.399821 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:2e6db536-32cf-4d5a-bf22-6f92e19cc1fc&page=queryresults
[0m19:57:32.403752 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected ")" but got ";" at [33:17]; reason: invalidQuery, location: query, message: Syntax error: Expected ")" but got ";" at [33:17]')
[0m19:57:33.802829 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:6bb45fe1-a6de-426a-a0ff-c3f96ede0abb&page=queryresults
[0m19:57:33.807018 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:6bb45fe1-a6de-426a-a0ff-c3f96ede0abb&page=queryresults
[0m19:57:33.834697 [debug] [Thread-1  ]: Database Error in model dim_time (models/transform/dim_time.sql)
  Syntax error: Expected ")" but got ";" at [33:17]
  compiled code at target/run/nyc_taxi/models/transform/dim_time.sql
[0m19:57:33.837935 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7d6d45e-44fc-467a-bcfa-762be68ed5ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ed579fc40>]}
[0m19:57:33.842129 [error] [Thread-1  ]: 3 of 5 ERROR creating sql table model nyc_taxi.dim_time ........................ [[31mERROR[0m in 2.44s]
[0m19:57:33.848349 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_time
[0m19:57:33.852563 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_vendor
[0m19:57:33.857015 [info ] [Thread-1  ]: 4 of 5 START sql table model nyc_taxi.dim_vendor ............................... [RUN]
[0m19:57:33.863919 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_time, now model.nyc_taxi.dim_vendor)
[0m19:57:33.867691 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_vendor
[0m19:57:33.889486 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_vendor"
[0m19:57:33.908785 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_vendor
[0m19:57:33.920722 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.dim_vendor"
[0m19:57:33.941229 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:57:33.952582 [debug] [Thread-1  ]: On model.nyc_taxi.dim_vendor: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.dim_vendor"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`dim_vendor`
      
    
    

    OPTIONS()
    as (
      WITH vendor_cte AS(
    SELECT DISTINCT
        vendor_id AS id,
        CASE 
            WHEN vendor_id = 1 THEN "Creative Mobile Technologies"
            WHEN vendor_id = 2 THEN "VeriFone Inc."
        END AS vendor_name
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata`
)
SELECT
    id,
    vendor_name
FROM vendor_cte
    );
  
[0m19:57:35.108849 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:add93b1a-820f-4de9-8d64-49626ece2065&page=queryresults
[0m19:57:37.606043 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7d6d45e-44fc-467a-bcfa-762be68ed5ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ed57cf400>]}
[0m19:57:37.610196 [info ] [Thread-1  ]: 4 of 5 OK created sql table model nyc_taxi.dim_vendor .......................... [[32mCREATE TABLE (2.0 rows, 463.5 KiB processed)[0m in 3.74s]
[0m19:57:37.615926 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_vendor
[0m19:57:37.620628 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_zone
[0m19:57:37.624674 [info ] [Thread-1  ]: 5 of 5 START sql table model nyc_taxi.dim_zone ................................. [RUN]
[0m19:57:37.629201 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_vendor, now model.nyc_taxi.dim_zone)
[0m19:57:37.636752 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_zone
[0m19:57:37.654387 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_zone"
[0m19:57:37.674125 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_zone
[0m19:57:37.687192 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.dim_zone"
[0m19:57:37.704986 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:57:37.714113 [debug] [Thread-1  ]: On model.nyc_taxi.dim_zone: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.dim_zone"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`dim_zone`
      
    
    

    OPTIONS()
    as (
      SELECT DISTINCT
    location_id,
    borough,
    zone,
    replace(service_zone, 'Boro', 'Green') as service_zone
FROM `northern-shield-437204-m0`.`nyc_taxi`.`zone_map`
WHERE borough != 'Unknown' or borough is not null
    );
  
[0m19:57:38.923042 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:71aa284b-8371-4ebc-85b0-8ef1e75e408d&page=queryresults
[0m19:57:41.832371 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7d6d45e-44fc-467a-bcfa-762be68ed5ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ea740e8e0>]}
[0m19:57:41.836080 [info ] [Thread-1  ]: 5 of 5 OK created sql table model nyc_taxi.dim_zone ............................ [[32mCREATE TABLE (264.0 rows, 24.2 KiB processed)[0m in 4.20s]
[0m19:57:41.840495 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_zone
[0m19:57:41.846712 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:57:41.849173 [debug] [MainThread]: Connection 'model.nyc_taxi.dim_zone' was properly closed.
[0m19:57:41.852492 [info ] [MainThread]: 
[0m19:57:41.855648 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 20.87 seconds (20.87s).
[0m19:57:41.864607 [debug] [MainThread]: Command end result
[0m19:57:42.062554 [info ] [MainThread]: 
[0m19:57:42.065459 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m19:57:42.068141 [info ] [MainThread]: 
[0m19:57:42.070930 [error] [MainThread]:   Database Error in model dim_time (models/transform/dim_time.sql)
  Syntax error: Expected ")" but got ";" at [33:17]
  compiled code at target/run/nyc_taxi/models/transform/dim_time.sql
[0m19:57:42.073840 [info ] [MainThread]: 
[0m19:57:42.077031 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m19:57:42.083262 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 29.379807, "process_in_blocks": "672", "process_kernel_time": 0.627491, "process_mem_max_rss": "230716", "process_out_blocks": "0", "process_user_time": 12.934421}
[0m19:57:42.087403 [debug] [MainThread]: Command `dbt run` failed at 19:57:42.086733 after 29.38 seconds
[0m19:57:42.091080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4edf8fd430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4edeb9f0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4eddeb2a90>]}
[0m19:57:42.094497 [debug] [MainThread]: Flushing usage events
[0m19:58:00.865663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbba5f73400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbba3daba30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbba3dab9d0>]}


============================== 19:58:00.882331 | 0c77ced0-e843-4ff8-a054-211e96d02e06 ==============================
[0m19:58:00.882331 [info ] [MainThread]: Running with dbt=1.8.9
[0m19:58:00.885605 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'send_anonymous_usage_stats': 'True', 'log_cache_events': 'False', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/include/dbt/', 'write_json': 'True', 'warn_error': 'None', 'profiles_dir': '/opt/airflow/include/dbt/', 'introspect': 'True', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/include/dbt/logs', 'use_colors': 'True', 'target_path': 'None', 'empty': 'False', 'cache_selected_only': 'False', 'indirect_selection': 'eager', 'log_format': 'default', 'printer_width': '80', 'static_parser': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'partial_parse': 'True', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])'}
[0m19:58:03.808585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0c77ced0-e843-4ff8-a054-211e96d02e06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb6d71a820>]}
[0m19:58:03.979256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0c77ced0-e843-4ff8-a054-211e96d02e06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb6c9180a0>]}
[0m19:58:03.983191 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m19:58:04.452595 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m19:58:07.611372 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:58:07.615342 [debug] [MainThread]: Partial parsing: updated file: nyc_taxi://models/transform/dim_time.sql
[0m19:58:08.511537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0c77ced0-e843-4ff8-a054-211e96d02e06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb9f24ff70>]}
[0m19:58:08.879525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0c77ced0-e843-4ff8-a054-211e96d02e06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb9f262190>]}
[0m19:58:08.882359 [info ] [MainThread]: Found 5 models, 2 sources, 600 macros
[0m19:58:08.887237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0c77ced0-e843-4ff8-a054-211e96d02e06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb9f2aa2b0>]}
[0m19:58:08.894056 [info ] [MainThread]: 
[0m19:58:08.898910 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:58:08.916354 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_northern-shield-437204-m0'
[0m19:58:08.919669 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:58:10.334112 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_northern-shield-437204-m0, now list_northern-shield-437204-m0_nyc_taxi)
[0m19:58:10.337366 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:58:11.741708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0c77ced0-e843-4ff8-a054-211e96d02e06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbba6307520>]}
[0m19:58:11.747008 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:58:11.750113 [info ] [MainThread]: 
[0m19:58:11.774513 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_payment
[0m19:58:11.778863 [info ] [Thread-1  ]: 1 of 5 START sql table model nyc_taxi.dim_payment .............................. [RUN]
[0m19:58:11.782881 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_northern-shield-437204-m0_nyc_taxi, now model.nyc_taxi.dim_payment)
[0m19:58:11.786048 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_payment
[0m19:58:11.818874 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_payment"
[0m19:58:11.842801 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_payment
[0m19:58:11.891603 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:58:12.898060 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.dim_payment"
[0m19:58:12.962365 [debug] [Thread-1  ]: On model.nyc_taxi.dim_payment: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.dim_payment"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`dim_payment`
      
    
    

    OPTIONS()
    as (
      WITH payment_cte AS(
    SELECT DISTINCT
        payment_type AS type_id,
        CASE 
            WHEN payment_type = 1 THEN "Credit card"
            WHEN payment_type = 2 THEN "Cash"
            WHEN payment_type = 3 THEN "No charge"
            WHEN payment_type = 4 THEN "Dispute"
            WHEN payment_type = 5 THEN "Unknown"
            WHEN payment_type = 6 THEN "Voided trip"
        END AS payment_name
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata`
)
SELECT
    type_id,
    payment_name
FROM payment_cte
    );
  
[0m19:58:13.644512 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:8fccde41-b427-4793-af01-72f6792669aa&page=queryresults
[0m19:58:16.334648 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0c77ced0-e843-4ff8-a054-211e96d02e06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb6d7978b0>]}
[0m19:58:16.339933 [info ] [Thread-1  ]: 1 of 5 OK created sql table model nyc_taxi.dim_payment ......................... [[32mCREATE TABLE (4.0 rows, 463.5 KiB processed)[0m in 4.54s]
[0m19:58:16.347411 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_payment
[0m19:58:16.352157 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_ratecode
[0m19:58:16.356748 [info ] [Thread-1  ]: 2 of 5 START sql table model nyc_taxi.dim_ratecode ............................. [RUN]
[0m19:58:16.360875 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_payment, now model.nyc_taxi.dim_ratecode)
[0m19:58:16.364219 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_ratecode
[0m19:58:16.379408 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_ratecode"
[0m19:58:16.400090 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_ratecode
[0m19:58:16.415265 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:58:17.383213 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.dim_ratecode"
[0m19:58:17.403785 [debug] [Thread-1  ]: On model.nyc_taxi.dim_ratecode: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.dim_ratecode"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`dim_ratecode`
      
    
    

    OPTIONS()
    as (
      WITH rate_code_cte AS(
    SELECT DISTINCT
        rate_code_id AS rate_id,
        CASE 
            WHEN rate_code_id = 1 THEN "Standard rate"
            WHEN rate_code_id = 2 THEN "JFK"
            WHEN rate_code_id = 3 THEN "Newark"
            WHEN rate_code_id = 4 THEN "Nassau or Westchester"
            WHEN rate_code_id = 5 THEN "Negotiated fare"
            WHEN rate_code_id = 6 THEN "Group ride"
        ELSE "Unknown"
        END AS rate_code_name
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata`
)
SELECT
    rate_id,
    rate_code_name
FROM rate_code_cte
    );
  
[0m19:58:18.057798 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:538b849e-a01c-47f4-9ab6-d3c0727357d8&page=queryresults
[0m19:58:20.775989 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0c77ced0-e843-4ff8-a054-211e96d02e06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb9e650df0>]}
[0m19:58:20.781092 [info ] [Thread-1  ]: 2 of 5 OK created sql table model nyc_taxi.dim_ratecode ........................ [[32mCREATE TABLE (6.0 rows, 463.5 KiB processed)[0m in 4.42s]
[0m19:58:20.786811 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_ratecode
[0m19:58:20.791192 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_time
[0m19:58:20.796566 [info ] [Thread-1  ]: 3 of 5 START sql table model nyc_taxi.dim_time ................................. [RUN]
[0m19:58:20.800173 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_ratecode, now model.nyc_taxi.dim_time)
[0m19:58:20.804589 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_time
[0m19:58:20.819579 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_time"
[0m19:58:20.838189 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_time
[0m19:58:20.852517 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.dim_time"
[0m19:58:20.871604 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:58:20.882734 [debug] [Thread-1  ]: On model.nyc_taxi.dim_time: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.dim_time"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`dim_time`
      
    
    

    OPTIONS()
    as (
      WITH datetime_cte AS (
    SELECT DISTINCT
        lpep_pickup_datetime AS datetime_value
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata`
    UNION ALL
    SELECT DISTINCT
        lpep_dropoff_datetime AS datetime_value
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata`
)
SELECT DISTINCT
    ROW_NUMBER() OVER (ORDER BY datetime_value) AS time_id,
    DATE(datetime_value) AS date,
    datetime_value AS date_part,
    EXTRACT(YEAR FROM datetime_value) AS year,
    EXTRACT(MONTH FROM datetime_value) AS month,
    EXTRACT(DAY FROM datetime_value) AS day,
    EXTRACT(HOUR FROM datetime_value) AS hour,
    EXTRACT(MINUTE FROM datetime_value) AS minute,
    TO_CHAR(datetime_value, 'Day') AS weekday
FROM datetime_cte
ORDER BY time_id
    );
  
[0m19:58:22.575771 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:b6a03f9c-d0eb-40bf-a550-13ee6a607239&page=queryresults
[0m19:58:22.922639 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Function not found: TO_CHAR at [31:5]; reason: invalidQuery, location: query, message: Function not found: TO_CHAR at [31:5]')
[0m19:58:24.281154 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:2e8fe6ec-e0e4-4a90-9c0b-e6ad3972ae6d&page=queryresults
[0m19:58:24.634817 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:2e8fe6ec-e0e4-4a90-9c0b-e6ad3972ae6d&page=queryresults
[0m19:58:24.646977 [debug] [Thread-1  ]: Database Error in model dim_time (models/transform/dim_time.sql)
  Function not found: TO_CHAR at [31:5]
  compiled code at target/run/nyc_taxi/models/transform/dim_time.sql
[0m19:58:24.650591 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0c77ced0-e843-4ff8-a054-211e96d02e06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb9bff4820>]}
[0m19:58:24.654277 [error] [Thread-1  ]: 3 of 5 ERROR creating sql table model nyc_taxi.dim_time ........................ [[31mERROR[0m in 3.85s]
[0m19:58:24.659902 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_time
[0m19:58:24.665617 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_vendor
[0m19:58:24.669345 [info ] [Thread-1  ]: 4 of 5 START sql table model nyc_taxi.dim_vendor ............................... [RUN]
[0m19:58:24.673100 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_time, now model.nyc_taxi.dim_vendor)
[0m19:58:24.676973 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_vendor
[0m19:58:24.704425 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_vendor"
[0m19:58:24.737036 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_vendor
[0m19:58:24.751564 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:58:25.748561 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.dim_vendor"
[0m19:58:25.770877 [debug] [Thread-1  ]: On model.nyc_taxi.dim_vendor: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.dim_vendor"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`dim_vendor`
      
    
    

    OPTIONS()
    as (
      WITH vendor_cte AS(
    SELECT DISTINCT
        vendor_id AS id,
        CASE 
            WHEN vendor_id = 1 THEN "Creative Mobile Technologies"
            WHEN vendor_id = 2 THEN "VeriFone Inc."
        END AS vendor_name
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata`
)
SELECT
    id,
    vendor_name
FROM vendor_cte
    );
  
[0m19:58:26.396651 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:c90c01e8-6fec-4d8e-b728-666dfa241f2d&page=queryresults
[0m19:58:28.941358 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0c77ced0-e843-4ff8-a054-211e96d02e06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb9e69f0a0>]}
[0m19:58:28.946143 [info ] [Thread-1  ]: 4 of 5 OK created sql table model nyc_taxi.dim_vendor .......................... [[32mCREATE TABLE (2.0 rows, 463.5 KiB processed)[0m in 4.27s]
[0m19:58:28.951691 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_vendor
[0m19:58:28.955630 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_zone
[0m19:58:28.959612 [info ] [Thread-1  ]: 5 of 5 START sql table model nyc_taxi.dim_zone ................................. [RUN]
[0m19:58:28.963686 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_vendor, now model.nyc_taxi.dim_zone)
[0m19:58:28.966515 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_zone
[0m19:58:28.980434 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_zone"
[0m19:58:29.001873 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_zone
[0m19:58:29.017257 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:58:29.910405 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.dim_zone"
[0m19:58:29.932946 [debug] [Thread-1  ]: On model.nyc_taxi.dim_zone: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.dim_zone"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`dim_zone`
      
    
    

    OPTIONS()
    as (
      SELECT DISTINCT
    location_id,
    borough,
    zone,
    replace(service_zone, 'Boro', 'Green') as service_zone
FROM `northern-shield-437204-m0`.`nyc_taxi`.`zone_map`
WHERE borough != 'Unknown' or borough is not null
    );
  
[0m19:58:30.503598 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:50a04c9a-829e-46a8-b322-14dd3b86d8c2&page=queryresults
[0m19:58:33.217542 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0c77ced0-e843-4ff8-a054-211e96d02e06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb9e69f190>]}
[0m19:58:33.221142 [info ] [Thread-1  ]: 5 of 5 OK created sql table model nyc_taxi.dim_zone ............................ [[32mCREATE TABLE (264.0 rows, 24.2 KiB processed)[0m in 4.25s]
[0m19:58:33.225423 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_zone
[0m19:58:33.231852 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:58:33.235108 [debug] [MainThread]: Connection 'model.nyc_taxi.dim_zone' was properly closed.
[0m19:58:33.238142 [info ] [MainThread]: 
[0m19:58:33.243296 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 24.34 seconds (24.34s).
[0m19:58:33.256643 [debug] [MainThread]: Command end result
[0m19:58:33.465709 [info ] [MainThread]: 
[0m19:58:33.468923 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m19:58:33.472042 [info ] [MainThread]: 
[0m19:58:33.475778 [error] [MainThread]:   Database Error in model dim_time (models/transform/dim_time.sql)
  Function not found: TO_CHAR at [31:5]
  compiled code at target/run/nyc_taxi/models/transform/dim_time.sql
[0m19:58:33.478606 [info ] [MainThread]: 
[0m19:58:33.481740 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m19:58:33.486869 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 32.80176, "process_in_blocks": "0", "process_kernel_time": 0.928444, "process_mem_max_rss": "230316", "process_out_blocks": "0", "process_user_time": 12.51903}
[0m19:58:33.490862 [debug] [MainThread]: Command `dbt run` failed at 19:58:33.490369 after 32.81 seconds
[0m19:58:33.494111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbba5f73400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb9f233460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbba4581be0>]}
[0m19:58:33.497293 [debug] [MainThread]: Flushing usage events
[0m20:00:39.606951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47cc03d400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47c9e75a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47c9e759d0>]}


============================== 20:00:39.622455 | 29545337-0817-472a-b3bb-fd2acb2fedca ==============================
[0m20:00:39.622455 [info ] [MainThread]: Running with dbt=1.8.9
[0m20:00:39.625887 [debug] [MainThread]: running dbt with arguments {'empty': 'False', 'use_colors': 'True', 'write_json': 'True', 'log_format': 'default', 'no_print': 'None', 'partial_parse': 'True', 'fail_fast': 'False', 'printer_width': '80', 'log_cache_events': 'False', 'debug': 'False', 'cache_selected_only': 'False', 'target_path': 'None', 'use_experimental_parser': 'False', 'introspect': 'True', 'indirect_selection': 'eager', 'warn_error': 'None', 'version_check': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'quiet': 'False', 'send_anonymous_usage_stats': 'True', 'profiles_dir': '/opt/airflow/include/dbt/', 'log_path': '/opt/airflow/include/dbt/logs', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/include/dbt/'}
[0m20:00:43.012778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '29545337-0817-472a-b3bb-fd2acb2fedca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4793812e80>]}
[0m20:00:43.206204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '29545337-0817-472a-b3bb-fd2acb2fedca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47ca65ebe0>]}
[0m20:00:43.209699 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m20:00:43.699010 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m20:00:46.375833 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:00:46.379330 [debug] [MainThread]: Partial parsing: updated file: nyc_taxi://models/transform/dim_time.sql
[0m20:00:47.361447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '29545337-0817-472a-b3bb-fd2acb2fedca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47c9eb9f70>]}
[0m20:00:47.727401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '29545337-0817-472a-b3bb-fd2acb2fedca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47cb1d68e0>]}
[0m20:00:47.730657 [info ] [MainThread]: Found 5 models, 2 sources, 600 macros
[0m20:00:47.733534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '29545337-0817-472a-b3bb-fd2acb2fedca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47c549c0d0>]}
[0m20:00:47.740221 [info ] [MainThread]: 
[0m20:00:47.744035 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m20:00:47.760210 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_northern-shield-437204-m0'
[0m20:00:47.763984 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:00:48.424205 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_northern-shield-437204-m0, now list_northern-shield-437204-m0_nyc_taxi)
[0m20:00:48.428515 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:00:49.100445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '29545337-0817-472a-b3bb-fd2acb2fedca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47929f7ca0>]}
[0m20:00:49.104550 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:00:49.107503 [info ] [MainThread]: 
[0m20:00:49.126700 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_payment
[0m20:00:49.130056 [info ] [Thread-1  ]: 1 of 5 START sql table model nyc_taxi.dim_payment .............................. [RUN]
[0m20:00:49.133399 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_northern-shield-437204-m0_nyc_taxi, now model.nyc_taxi.dim_payment)
[0m20:00:49.136346 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_payment
[0m20:00:49.164180 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_payment"
[0m20:00:49.179447 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_payment
[0m20:00:49.226494 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:00:49.918251 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.dim_payment"
[0m20:00:49.935964 [debug] [Thread-1  ]: On model.nyc_taxi.dim_payment: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.dim_payment"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`dim_payment`
      
    
    

    OPTIONS()
    as (
      WITH payment_cte AS(
    SELECT DISTINCT
        payment_type AS type_id,
        CASE 
            WHEN payment_type = 1 THEN "Credit card"
            WHEN payment_type = 2 THEN "Cash"
            WHEN payment_type = 3 THEN "No charge"
            WHEN payment_type = 4 THEN "Dispute"
            WHEN payment_type = 5 THEN "Unknown"
            WHEN payment_type = 6 THEN "Voided trip"
        END AS payment_name
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata`
)
SELECT
    type_id,
    payment_name
FROM payment_cte
    );
  
[0m20:00:50.600233 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:41c0a770-6e0f-4b05-a8b5-b0b1edda9ee3&page=queryresults
[0m20:00:53.064220 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29545337-0817-472a-b3bb-fd2acb2fedca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47c527b5b0>]}
[0m20:00:53.068638 [info ] [Thread-1  ]: 1 of 5 OK created sql table model nyc_taxi.dim_payment ......................... [[32mCREATE TABLE (4.0 rows, 463.5 KiB processed)[0m in 3.93s]
[0m20:00:53.072824 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_payment
[0m20:00:53.076630 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_ratecode
[0m20:00:53.080135 [info ] [Thread-1  ]: 2 of 5 START sql table model nyc_taxi.dim_ratecode ............................. [RUN]
[0m20:00:53.083268 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_payment, now model.nyc_taxi.dim_ratecode)
[0m20:00:53.086453 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_ratecode
[0m20:00:53.100697 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_ratecode"
[0m20:00:53.121713 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_ratecode
[0m20:00:53.132717 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:00:53.763732 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.dim_ratecode"
[0m20:00:53.780521 [debug] [Thread-1  ]: On model.nyc_taxi.dim_ratecode: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.dim_ratecode"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`dim_ratecode`
      
    
    

    OPTIONS()
    as (
      WITH rate_code_cte AS(
    SELECT DISTINCT
        rate_code_id AS rate_id,
        CASE 
            WHEN rate_code_id = 1 THEN "Standard rate"
            WHEN rate_code_id = 2 THEN "JFK"
            WHEN rate_code_id = 3 THEN "Newark"
            WHEN rate_code_id = 4 THEN "Nassau or Westchester"
            WHEN rate_code_id = 5 THEN "Negotiated fare"
            WHEN rate_code_id = 6 THEN "Group ride"
        ELSE "Unknown"
        END AS rate_code_name
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata`
)
SELECT
    rate_id,
    rate_code_name
FROM rate_code_cte
    );
  
[0m20:00:54.414249 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:6f971bf3-b714-4cdb-bb1f-eb7f6fe238aa&page=queryresults
[0m20:00:56.934506 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29545337-0817-472a-b3bb-fd2acb2fedca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47c4650580>]}
[0m20:00:56.939459 [info ] [Thread-1  ]: 2 of 5 OK created sql table model nyc_taxi.dim_ratecode ........................ [[32mCREATE TABLE (6.0 rows, 463.5 KiB processed)[0m in 3.85s]
[0m20:00:56.945150 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_ratecode
[0m20:00:56.949000 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_time
[0m20:00:56.952416 [info ] [Thread-1  ]: 3 of 5 START sql table model nyc_taxi.dim_time ................................. [RUN]
[0m20:00:56.956268 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_ratecode, now model.nyc_taxi.dim_time)
[0m20:00:56.959641 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_time
[0m20:00:56.975677 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_time"
[0m20:00:56.993735 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_time
[0m20:00:57.007988 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.dim_time"
[0m20:00:57.024150 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:00:57.034323 [debug] [Thread-1  ]: On model.nyc_taxi.dim_time: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.dim_time"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`dim_time`
      
    
    

    OPTIONS()
    as (
      WITH datetime_cte AS (
    SELECT DISTINCT
        lpep_pickup_datetime AS datetime_value
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata`
    UNION ALL
    SELECT DISTINCT
        lpep_dropoff_datetime AS datetime_value
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata`
)
SELECT DISTINCT
    ROW_NUMBER() OVER (ORDER BY datetime_value) AS time_id,
    DATE(datetime_value) AS date,
    datetime_value AS date_part,
    EXTRACT(YEAR FROM datetime_value) AS year,
    EXTRACT(MONTH FROM datetime_value) AS month,
    EXTRACT(DAY FROM datetime_value) AS day,
    EXTRACT(HOUR FROM datetime_value) AS hour,
    EXTRACT(MINUTE FROM datetime_value) AS minute,
    FORMAT_TIMESTAMP('%A', datetime_value) AS weekday
FROM datetime_cte
ORDER BY time_id
    );
  
[0m20:00:57.927093 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:53b5a825-470d-4e78-a57b-c3af06f6b7cc&page=queryresults
[0m20:01:01.240727 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29545337-0817-472a-b3bb-fd2acb2fedca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47c466f370>]}
[0m20:01:01.245082 [info ] [Thread-1  ]: 3 of 5 OK created sql table model nyc_taxi.dim_time ............................ [[32mCREATE TABLE (116.8k rows, 927.0 KiB processed)[0m in 4.28s]
[0m20:01:01.250447 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_time
[0m20:01:01.255080 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_vendor
[0m20:01:01.258768 [info ] [Thread-1  ]: 4 of 5 START sql table model nyc_taxi.dim_vendor ............................... [RUN]
[0m20:01:01.264239 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_time, now model.nyc_taxi.dim_vendor)
[0m20:01:01.267816 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_vendor
[0m20:01:01.292822 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_vendor"
[0m20:01:01.312918 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_vendor
[0m20:01:01.325108 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:01:01.972860 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.dim_vendor"
[0m20:01:01.992018 [debug] [Thread-1  ]: On model.nyc_taxi.dim_vendor: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.dim_vendor"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`dim_vendor`
      
    
    

    OPTIONS()
    as (
      WITH vendor_cte AS(
    SELECT DISTINCT
        vendor_id AS id,
        CASE 
            WHEN vendor_id = 1 THEN "Creative Mobile Technologies"
            WHEN vendor_id = 2 THEN "VeriFone Inc."
        END AS vendor_name
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata`
)
SELECT
    id,
    vendor_name
FROM vendor_cte
    );
  
[0m20:01:02.542501 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:da2ca018-3958-41ae-9fa4-c62f84f90e5f&page=queryresults
[0m20:01:05.658981 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29545337-0817-472a-b3bb-fd2acb2fedca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47c4650a00>]}
[0m20:01:05.663640 [info ] [Thread-1  ]: 4 of 5 OK created sql table model nyc_taxi.dim_vendor .......................... [[32mCREATE TABLE (2.0 rows, 463.5 KiB processed)[0m in 4.40s]
[0m20:01:05.668325 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_vendor
[0m20:01:05.671756 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_zone
[0m20:01:05.675629 [info ] [Thread-1  ]: 5 of 5 START sql table model nyc_taxi.dim_zone ................................. [RUN]
[0m20:01:05.679122 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_vendor, now model.nyc_taxi.dim_zone)
[0m20:01:05.682633 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_zone
[0m20:01:05.698288 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_zone"
[0m20:01:05.721921 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_zone
[0m20:01:05.734973 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:01:06.959017 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.dim_zone"
[0m20:01:06.981642 [debug] [Thread-1  ]: On model.nyc_taxi.dim_zone: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.dim_zone"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`dim_zone`
      
    
    

    OPTIONS()
    as (
      SELECT DISTINCT
    location_id,
    borough,
    zone,
    replace(service_zone, 'Boro', 'Green') as service_zone
FROM `northern-shield-437204-m0`.`nyc_taxi`.`zone_map`
WHERE borough != 'Unknown' or borough is not null
    );
  
[0m20:01:07.559690 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:d20a9ace-b811-451e-a111-310909e2c053&page=queryresults
[0m20:01:10.509636 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29545337-0817-472a-b3bb-fd2acb2fedca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47c17e8f40>]}
[0m20:01:10.516889 [info ] [Thread-1  ]: 5 of 5 OK created sql table model nyc_taxi.dim_zone ............................ [[32mCREATE TABLE (264.0 rows, 24.2 KiB processed)[0m in 4.83s]
[0m20:01:10.524935 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_zone
[0m20:01:10.535379 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:01:10.539526 [debug] [MainThread]: Connection 'model.nyc_taxi.dim_zone' was properly closed.
[0m20:01:10.543905 [info ] [MainThread]: 
[0m20:01:10.550397 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 22.80 seconds (22.80s).
[0m20:01:10.564117 [debug] [MainThread]: Command end result
[0m20:01:10.810396 [info ] [MainThread]: 
[0m20:01:10.814561 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:01:10.817447 [info ] [MainThread]: 
[0m20:01:10.820448 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m20:01:10.824939 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 31.410902, "process_in_blocks": "0", "process_kernel_time": 0.95841, "process_mem_max_rss": "237200", "process_out_blocks": "0", "process_user_time": 13.185713}
[0m20:01:10.830480 [debug] [MainThread]: Command `dbt run` succeeded at 20:01:10.829576 after 31.42 seconds
[0m20:01:10.834405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47cc03d400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47c5268c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47c5204460>]}
[0m20:01:10.837674 [debug] [MainThread]: Flushing usage events
[0m20:03:54.515053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f09c07cb460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f09be602ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f09be602a60>]}


============================== 20:03:54.531704 | 7eff204e-a4c2-436d-b812-537a91077be6 ==============================
[0m20:03:54.531704 [info ] [MainThread]: Running with dbt=1.8.9
[0m20:03:54.534936 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run --profiles-dir /opt/airflow/include/dbt/', 'write_json': 'True', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'static_parser': 'True', 'log_format': 'default', 'printer_width': '80', 'empty': 'False', 'indirect_selection': 'eager', 'profiles_dir': '/opt/airflow/include/dbt/', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'log_path': '/opt/airflow/include/dbt/logs', 'warn_error': 'None', 'use_colors': 'True', 'version_check': 'True', 'send_anonymous_usage_stats': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'target_path': 'None', 'debug': 'False', 'fail_fast': 'False', 'cache_selected_only': 'False'}
[0m20:03:57.355094 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7eff204e-a4c2-436d-b812-537a91077be6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f09c0015a00>]}
[0m20:03:57.517920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7eff204e-a4c2-436d-b812-537a91077be6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f09be647e80>]}
[0m20:03:57.521294 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m20:03:57.984791 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m20:04:00.797049 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m20:04:00.800660 [debug] [MainThread]: Partial parsing: added file: nyc_taxi://models/transform/fct_trips.sql
[0m20:04:01.681984 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.nyc_taxi.fct_trips' (models/transform/fct_trips.sql) depends on a source named 'nyc_taxi.dim_time' which was not found
[0m20:04:01.686143 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 7.3599153, "process_in_blocks": "0", "process_kernel_time": 0.741513, "process_mem_max_rss": "225216", "process_out_blocks": "0", "process_user_time": 10.230883}
[0m20:04:01.689497 [debug] [MainThread]: Command `dbt run` failed at 20:04:01.689055 after 7.36 seconds
[0m20:04:01.692510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f09c07cb460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f09b9a54850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f09871510d0>]}
[0m20:04:01.695059 [debug] [MainThread]: Flushing usage events
[0m20:10:37.108102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f353dec1430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f353bcfbbe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f353bcfbb80>]}


============================== 20:10:37.124310 | d24a0117-e2a3-4544-9958-6627dcd85f09 ==============================
[0m20:10:37.124310 [info ] [MainThread]: Running with dbt=1.8.9
[0m20:10:37.128323 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'target_path': 'None', 'fail_fast': 'False', 'empty': 'None', 'log_path': '/opt/airflow/include/dbt/logs', 'use_colors': 'True', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'warn_error': 'None', 'log_format': 'default', 'static_parser': 'True', 'partial_parse': 'True', 'invocation_command': 'dbt source freshness --profiles-dir /opt/airflow/include/dbt/', 'indirect_selection': 'eager', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'send_anonymous_usage_stats': 'True', 'profiles_dir': '/opt/airflow/include/dbt/', 'debug': 'False', 'printer_width': '80', 'log_cache_events': 'False', 'write_json': 'True', 'quiet': 'False', 'introspect': 'True'}
[0m20:10:40.235095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd24a0117-e2a3-4544-9958-6627dcd85f09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35056430a0>]}
[0m20:10:40.446768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd24a0117-e2a3-4544-9958-6627dcd85f09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35048827f0>]}
[0m20:10:40.450409 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m20:10:40.943341 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m20:10:43.530149 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m20:10:43.535139 [debug] [MainThread]: Partial parsing: added file: nyc_taxi://models/transform/fct_trips.sql
[0m20:10:44.448889 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.nyc_taxi.fct_trips' (models/transform/fct_trips.sql) depends on a source named 'nyc_taxi.dim_time' which was not found
[0m20:10:44.453952 [debug] [MainThread]: Resource report: {"command_name": "freshness", "command_success": false, "command_wall_clock_time": 7.517994, "process_in_blocks": "0", "process_kernel_time": 0.903889, "process_mem_max_rss": "239608", "process_out_blocks": "0", "process_user_time": 11.067618}
[0m20:10:44.458457 [debug] [MainThread]: Command `dbt source freshness` failed at 20:10:44.457940 after 7.52 seconds
[0m20:10:44.461626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f353dec1430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35371ad850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3537054c70>]}
[0m20:10:44.464697 [debug] [MainThread]: Flushing usage events
[0m20:12:27.499464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0cdffe9f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0cdddbf9a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0cdddbf940>]}


============================== 20:12:27.516300 | 1963b2db-4f35-4e5a-b615-36ed94e06098 ==============================
[0m20:12:27.516300 [info ] [MainThread]: Running with dbt=1.8.9
[0m20:12:27.519572 [debug] [MainThread]: running dbt with arguments {'log_path': '/opt/airflow/include/dbt/logs', 'warn_error': 'None', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'write_json': 'True', 'no_print': 'None', 'target_path': 'None', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/include/dbt', 'use_colors': 'True', 'partial_parse': 'True', 'invocation_command': 'dbt run --select fct_trips', 'log_cache_events': 'False', 'debug': 'False', 'quiet': 'False', 'indirect_selection': 'eager', 'empty': 'False', 'printer_width': '80', 'fail_fast': 'False', 'introspect': 'True', 'log_format': 'default', 'use_experimental_parser': 'False', 'static_parser': 'True'}
[0m20:12:30.443409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1963b2db-4f35-4e5a-b615-36ed94e06098', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0cdde36cd0>]}
[0m20:12:30.652886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1963b2db-4f35-4e5a-b615-36ed94e06098', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ca775efd0>]}
[0m20:12:30.656637 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m20:12:31.104113 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m20:12:33.979670 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m20:12:33.982598 [debug] [MainThread]: Partial parsing: added file: nyc_taxi://models/transform/fct_trips.sql
[0m20:12:34.790702 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.nyc_taxi.fct_trips' (models/transform/fct_trips.sql) depends on a source named 'nyc_taxi.dim_time' which was not found
[0m20:12:34.797620 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 7.477915, "process_in_blocks": "4952", "process_kernel_time": 0.76435, "process_mem_max_rss": "227292", "process_out_blocks": "0", "process_user_time": 11.083081}
[0m20:12:34.801653 [debug] [MainThread]: Command `dbt run` failed at 20:12:34.801248 after 7.48 seconds
[0m20:12:34.804532 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0cdffe9f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0cd91b39a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0cd9055dc0>]}
[0m20:12:34.807866 [debug] [MainThread]: Flushing usage events
[0m20:14:43.059463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e0eb5df70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e0c935ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e0c935a60>]}


============================== 20:14:43.080482 | 0dae8cd5-0786-4acb-a123-ac3012aa585a ==============================
[0m20:14:43.080482 [info ] [MainThread]: Running with dbt=1.8.9
[0m20:14:43.083790 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'log_cache_events': 'False', 'send_anonymous_usage_stats': 'True', 'no_print': 'None', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'log_format': 'default', 'partial_parse': 'True', 'profiles_dir': '/opt/airflow/include/dbt/', 'version_check': 'True', 'target_path': 'None', 'invocation_command': 'dbt source freshness --profiles-dir /opt/airflow/include/dbt/', 'debug': 'False', 'use_experimental_parser': 'False', 'empty': 'None', 'warn_error': 'None', 'write_json': 'True', 'log_path': '/opt/airflow/include/dbt/logs', 'indirect_selection': 'eager', 'use_colors': 'True', 'cache_selected_only': 'False', 'printer_width': '80', 'static_parser': 'True', 'quiet': 'False'}
[0m20:14:46.128178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0dae8cd5-0786-4acb-a123-ac3012aa585a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1dd552fd90>]}
[0m20:14:46.376813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0dae8cd5-0786-4acb-a123-ac3012aa585a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1dd54a4b20>]}
[0m20:14:46.382467 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m20:14:47.042268 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m20:14:50.150081 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m20:14:50.154544 [debug] [MainThread]: Partial parsing: added file: nyc_taxi://models/transform/fct_trips.sql
[0m20:14:51.087633 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.nyc_taxi.fct_trips' (models/transform/fct_trips.sql) depends on a source named 'nyc_taxi.dim_time' which was not found
[0m20:14:51.092122 [debug] [MainThread]: Resource report: {"command_name": "freshness", "command_success": false, "command_wall_clock_time": 8.220821, "process_in_blocks": "0", "process_kernel_time": 0.854536, "process_mem_max_rss": "231060", "process_out_blocks": "0", "process_user_time": 11.17935}
[0m20:14:51.095527 [debug] [MainThread]: Command `dbt source freshness` failed at 20:14:51.095136 after 8.22 seconds
[0m20:14:51.098755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e0eb5df70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e0ca1aee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e07db7cd0>]}
[0m20:14:51.101595 [debug] [MainThread]: Flushing usage events
[0m20:21:54.370455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe9b69cff70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe9b47a59d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe9b47a5970>]}


============================== 20:21:54.409127 | e495f405-dc36-4a58-813a-f60bd3dba08d ==============================
[0m20:21:54.409127 [info ] [MainThread]: Running with dbt=1.8.9
[0m20:21:54.413026 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'static_parser': 'True', 'printer_width': '80', 'send_anonymous_usage_stats': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'no_print': 'None', 'write_json': 'True', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'version_check': 'True', 'indirect_selection': 'eager', 'log_format': 'default', 'debug': 'False', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/include/dbt/', 'warn_error': 'None', 'empty': 'False', 'log_path': '/opt/airflow/include/dbt/logs', 'use_colors': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'quiet': 'False', 'profiles_dir': '/opt/airflow/include/dbt/'}
[0m20:21:57.786345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e495f405-dc36-4a58-813a-f60bd3dba08d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe9b81508b0>]}
[0m20:21:57.964494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e495f405-dc36-4a58-813a-f60bd3dba08d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe97e1159d0>]}
[0m20:21:57.968773 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m20:21:58.449504 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m20:22:01.280800 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m20:22:01.284494 [debug] [MainThread]: Partial parsing: added file: nyc_taxi://models/transform/fct_trips.sql
[0m20:22:02.291387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e495f405-dc36-4a58-813a-f60bd3dba08d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe9afb1c130>]}
[0m20:22:02.674030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e495f405-dc36-4a58-813a-f60bd3dba08d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe9afb18340>]}
[0m20:22:02.677343 [info ] [MainThread]: Found 6 models, 2 sources, 600 macros
[0m20:22:02.680772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e495f405-dc36-4a58-813a-f60bd3dba08d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe9b5d98b50>]}
[0m20:22:02.688208 [info ] [MainThread]: 
[0m20:22:02.692557 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m20:22:02.708701 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_northern-shield-437204-m0'
[0m20:22:02.711500 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:22:03.979013 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_northern-shield-437204-m0, now list_northern-shield-437204-m0_nyc_taxi)
[0m20:22:03.982072 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:22:05.225991 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e495f405-dc36-4a58-813a-f60bd3dba08d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe9b60774c0>]}
[0m20:22:05.229913 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:22:05.235926 [info ] [MainThread]: 
[0m20:22:05.266745 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_payment
[0m20:22:05.273695 [info ] [Thread-1  ]: 1 of 6 START sql table model nyc_taxi.dim_payment .............................. [RUN]
[0m20:22:05.277654 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_northern-shield-437204-m0_nyc_taxi, now model.nyc_taxi.dim_payment)
[0m20:22:05.282313 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_payment
[0m20:22:05.321116 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_payment"
[0m20:22:05.338863 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_payment
[0m20:22:05.392725 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:22:06.591933 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.dim_payment"
[0m20:22:06.611087 [debug] [Thread-1  ]: On model.nyc_taxi.dim_payment: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.dim_payment"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`dim_payment`
      
    
    

    OPTIONS()
    as (
      WITH payment_cte AS(
    SELECT DISTINCT
        payment_type AS type_id,
        CASE 
            WHEN payment_type = 1 THEN "Credit card"
            WHEN payment_type = 2 THEN "Cash"
            WHEN payment_type = 3 THEN "No charge"
            WHEN payment_type = 4 THEN "Dispute"
            WHEN payment_type = 5 THEN "Unknown"
            WHEN payment_type = 6 THEN "Voided trip"
        END AS payment_name
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata`
)
SELECT
    type_id,
    payment_name
FROM payment_cte
    );
  
[0m20:22:07.924130 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:928ff74e-6d53-45c3-9563-4c678019f16a&page=queryresults
[0m20:22:10.895433 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e495f405-dc36-4a58-813a-f60bd3dba08d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe9afcac400>]}
[0m20:22:10.901056 [info ] [Thread-1  ]: 1 of 6 OK created sql table model nyc_taxi.dim_payment ......................... [[32mCREATE TABLE (4.0 rows, 463.5 KiB processed)[0m in 5.61s]
[0m20:22:10.906479 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_payment
[0m20:22:10.911347 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_ratecode
[0m20:22:10.914882 [info ] [Thread-1  ]: 2 of 6 START sql table model nyc_taxi.dim_ratecode ............................. [RUN]
[0m20:22:10.919429 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_payment, now model.nyc_taxi.dim_ratecode)
[0m20:22:10.923913 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_ratecode
[0m20:22:10.943953 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_ratecode"
[0m20:22:10.971772 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_ratecode
[0m20:22:10.985335 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:22:12.389009 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.dim_ratecode"
[0m20:22:12.406266 [debug] [Thread-1  ]: On model.nyc_taxi.dim_ratecode: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.dim_ratecode"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`dim_ratecode`
      
    
    

    OPTIONS()
    as (
      WITH rate_code_cte AS(
    SELECT DISTINCT
        rate_code_id AS rate_id,
        CASE 
            WHEN rate_code_id = 1 THEN "Standard rate"
            WHEN rate_code_id = 2 THEN "JFK"
            WHEN rate_code_id = 3 THEN "Newark"
            WHEN rate_code_id = 4 THEN "Nassau or Westchester"
            WHEN rate_code_id = 5 THEN "Negotiated fare"
            WHEN rate_code_id = 6 THEN "Group ride"
        ELSE "Unknown"
        END AS rate_code_name
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata`
)
SELECT
    rate_id,
    rate_code_name
FROM rate_code_cte
    );
  
[0m20:22:13.239355 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:0d373407-7744-41d4-aa69-677e5de4471d&page=queryresults
[0m20:22:15.853814 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e495f405-dc36-4a58-813a-f60bd3dba08d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe97d2d6be0>]}
[0m20:22:15.858182 [info ] [Thread-1  ]: 2 of 6 OK created sql table model nyc_taxi.dim_ratecode ........................ [[32mCREATE TABLE (6.0 rows, 463.5 KiB processed)[0m in 4.93s]
[0m20:22:15.862653 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_ratecode
[0m20:22:15.866498 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_time
[0m20:22:15.870199 [info ] [Thread-1  ]: 3 of 6 START sql table model nyc_taxi.dim_time ................................. [RUN]
[0m20:22:15.874120 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_ratecode, now model.nyc_taxi.dim_time)
[0m20:22:15.877895 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_time
[0m20:22:15.892484 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_time"
[0m20:22:15.913472 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_time
[0m20:22:15.931981 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:22:17.260853 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.dim_time"
[0m20:22:17.283352 [debug] [Thread-1  ]: On model.nyc_taxi.dim_time: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.dim_time"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`dim_time`
      
    
    

    OPTIONS()
    as (
      WITH datetime_cte AS (
    SELECT DISTINCT
        lpep_pickup_datetime AS datetime_value
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata`
    UNION ALL
    SELECT DISTINCT
        lpep_dropoff_datetime AS datetime_value
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata`
)
SELECT DISTINCT
    ROW_NUMBER() OVER (ORDER BY datetime_value) AS time_id,
    DATE(datetime_value) AS date,
    datetime_value AS date_part,
    EXTRACT(YEAR FROM datetime_value) AS year,
    EXTRACT(MONTH FROM datetime_value) AS month,
    EXTRACT(DAY FROM datetime_value) AS day,
    EXTRACT(HOUR FROM datetime_value) AS hour,
    EXTRACT(MINUTE FROM datetime_value) AS minute,
    FORMAT_TIMESTAMP('%A', datetime_value) AS weekday
FROM datetime_cte
ORDER BY time_id
    );
  
[0m20:22:18.759784 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:5edeaa95-ac92-4a92-8559-b29a60df8f6f&page=queryresults
[0m20:22:22.282331 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e495f405-dc36-4a58-813a-f60bd3dba08d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe9b54c8a90>]}
[0m20:22:22.286900 [info ] [Thread-1  ]: 3 of 6 OK created sql table model nyc_taxi.dim_time ............................ [[32mCREATE TABLE (116.8k rows, 927.0 KiB processed)[0m in 6.41s]
[0m20:22:22.291660 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_time
[0m20:22:22.295401 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_vendor
[0m20:22:22.299582 [info ] [Thread-1  ]: 4 of 6 START sql table model nyc_taxi.dim_vendor ............................... [RUN]
[0m20:22:22.303281 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_time, now model.nyc_taxi.dim_vendor)
[0m20:22:22.306673 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_vendor
[0m20:22:22.320200 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_vendor"
[0m20:22:22.344393 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_vendor
[0m20:22:22.355911 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:22:23.377860 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.dim_vendor"
[0m20:22:23.400648 [debug] [Thread-1  ]: On model.nyc_taxi.dim_vendor: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.dim_vendor"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`dim_vendor`
      
    
    

    OPTIONS()
    as (
      WITH vendor_cte AS(
    SELECT DISTINCT
        vendor_id AS id,
        CASE 
            WHEN vendor_id = 1 THEN "Creative Mobile Technologies"
            WHEN vendor_id = 2 THEN "VeriFone Inc."
        END AS vendor_name
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata`
)
SELECT
    id,
    vendor_name
FROM vendor_cte
    );
  
[0m20:22:24.078158 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:af17f259-09be-4a8a-9ea4-a4bb6fe42a3a&page=queryresults
[0m20:22:27.096539 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e495f405-dc36-4a58-813a-f60bd3dba08d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe9b54c8a90>]}
[0m20:22:27.101103 [info ] [Thread-1  ]: 4 of 6 OK created sql table model nyc_taxi.dim_vendor .......................... [[32mCREATE TABLE (2.0 rows, 463.5 KiB processed)[0m in 4.79s]
[0m20:22:27.106004 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_vendor
[0m20:22:27.109958 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_zone
[0m20:22:27.113654 [info ] [Thread-1  ]: 5 of 6 START sql table model nyc_taxi.dim_zone ................................. [RUN]
[0m20:22:27.118215 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_vendor, now model.nyc_taxi.dim_zone)
[0m20:22:27.121177 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_zone
[0m20:22:27.134326 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_zone"
[0m20:22:27.160034 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_zone
[0m20:22:27.172886 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:22:28.259502 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.dim_zone"
[0m20:22:28.281731 [debug] [Thread-1  ]: On model.nyc_taxi.dim_zone: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.dim_zone"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`dim_zone`
      
    
    

    OPTIONS()
    as (
      SELECT DISTINCT
    location_id,
    borough,
    zone,
    replace(service_zone, 'Boro', 'Green') as service_zone
FROM `northern-shield-437204-m0`.`nyc_taxi`.`zone_map`
WHERE borough != 'Unknown' or borough is not null
    );
  
[0m20:22:28.920402 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:b33eb3ae-67d9-4b87-b9ac-26c459ecc9f9&page=queryresults
[0m20:22:31.823053 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e495f405-dc36-4a58-813a-f60bd3dba08d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe9afc69ca0>]}
[0m20:22:31.828249 [info ] [Thread-1  ]: 5 of 6 OK created sql table model nyc_taxi.dim_zone ............................ [[32mCREATE TABLE (264.0 rows, 24.2 KiB processed)[0m in 4.70s]
[0m20:22:31.834039 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_zone
[0m20:22:31.838559 [debug] [Thread-1  ]: Began running node model.nyc_taxi.fct_trips
[0m20:22:31.841818 [info ] [Thread-1  ]: 6 of 6 START sql table model nyc_taxi.fct_trips ................................ [RUN]
[0m20:22:31.845734 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_zone, now model.nyc_taxi.fct_trips)
[0m20:22:31.849044 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.fct_trips
[0m20:22:31.878526 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.fct_trips"
[0m20:22:31.891054 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.fct_trips
[0m20:22:31.909276 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.fct_trips"
[0m20:22:31.926972 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:22:31.938206 [debug] [Thread-1  ]: On model.nyc_taxi.fct_trips: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.fct_trips"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips`
      
    
    

    OPTIONS()
    as (
      WITH tripdata_cte AS (
    SELECT 
        to_hex(md5(cast(coalesce(cast(vendor_id as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(lpep_pickup_datetime as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(lpep_dropoff_datetime as string), '_dbt_utils_surrogate_key_null_') as string)))  AS trip_id,
        t.vendor_id,
        pt.time_id AS pickup_time_id,
        dt.time_id AS dropoff_time_id,
        t.rate_code_id,
        t.pu_location_id,
        t.do_location_id,
        t.passenger_count,
        t.trip_distance,
        t.fare_amount,
        t.extra,
        t.mta_tax,
        t.tip_amount,
        t.tolls_amount,
        t.improvement_surcharge,
        t.total_amount,
        t.payment_type,
        t.trip_type,
        t.congestion_surcharge
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata` AS t
    LEFT JOIN (
        SELECT DISTINCT date_part, time_id 
        FROM `northern-shield-437204-m0`.`nyc_taxi`.`dim_time`
    ) pt ON t.lpep_pickup_datetime = pt.date_part
    LEFT JOIN (
        SELECT DISTINCT date_part, time_id 
        FROM `northern-shield-437204-m0`.`nyc_taxi`.`dim_time`
    ) dt ON t.lpep_dropoff_datetime = dt.date_part
    WHERE t.vendor_id IS NOT NULL
        AND t.passenger_count IS NOT NULL
        AND (t.trip_distance IS NOT NULL OR t.trip_distance >= 0)
        AND t.fare_amount >= 0
        AND t.extra >= 0
        AND t.mta_tax >= 0
        AND t.tip_amount >= 0
        AND t.improvement_surcharge >= 0
        AND t.total_amount >= 0
)
SELECT 
    trip_id,
    vendor_id,
    pickup_time_id,
    dropoff_time_id,
    rate_code_id,
    pu_location_id,
    do_location_id,
    passenger_count,
    trip_distance,
    fare_amount,
    extra,
    mta_tax,
    tip_amount,
    tolls_amount,
    improvement_surcharge,
    total_amount,
    payment_type,
    trip_type,
    congestion_surcharge
FROM tripdata_cte
    );
  
[0m20:22:33.711863 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:754ee140-e3c1-4df1-be3e-f04ba9028f2b&page=queryresults
[0m20:22:38.029463 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e495f405-dc36-4a58-813a-f60bd3dba08d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe9afc69c70>]}
[0m20:22:38.033863 [info ] [Thread-1  ]: 6 of 6 OK created sql table model nyc_taxi.fct_trips ........................... [[32mCREATE TABLE (63.0k rows, 9.9 MiB processed)[0m in 6.18s]
[0m20:22:38.039236 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.fct_trips
[0m20:22:38.045816 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:22:38.049075 [debug] [MainThread]: Connection 'model.nyc_taxi.fct_trips' was properly closed.
[0m20:22:38.052296 [info ] [MainThread]: 
[0m20:22:38.056051 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 35.36 seconds (35.36s).
[0m20:22:38.065781 [debug] [MainThread]: Command end result
[0m20:22:38.260286 [info ] [MainThread]: 
[0m20:22:38.263900 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:22:38.267190 [info ] [MainThread]: 
[0m20:22:38.269970 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m20:22:38.275228 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 44.112755, "process_in_blocks": "0", "process_kernel_time": 0.950168, "process_mem_max_rss": "232960", "process_out_blocks": "0", "process_user_time": 13.402383}
[0m20:22:38.278804 [debug] [MainThread]: Command `dbt run` succeeded at 20:22:38.278385 after 44.12 seconds
[0m20:22:38.281753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe9b69cff70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe97e1159d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe9afc7a6a0>]}
[0m20:22:38.284861 [debug] [MainThread]: Flushing usage events
[0m20:23:09.289220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc2a6ed5f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc2a4cab9a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc2a4cab940>]}


============================== 20:23:09.306103 | a28c9c5e-f21e-49d4-8cb1-1c597876dc79 ==============================
[0m20:23:09.306103 [info ] [MainThread]: Running with dbt=1.8.9
[0m20:23:09.310269 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'write_json': 'True', 'printer_width': '80', 'log_path': '/opt/airflow/include/dbt/logs', 'introspect': 'True', 'version_check': 'True', 'indirect_selection': 'eager', 'profiles_dir': '/opt/airflow/include/dbt/', 'empty': 'None', 'invocation_command': 'dbt test --profiles-dir /opt/airflow/include/dbt/', 'quiet': 'False', 'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'use_colors': 'True', 'debug': 'False', 'log_cache_events': 'False', 'static_parser': 'True', 'cache_selected_only': 'False', 'no_print': 'None', 'warn_error': 'None', 'log_format': 'default'}
[0m20:23:12.192965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a28c9c5e-f21e-49d4-8cb1-1c597876dc79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc2a4d4f310>]}
[0m20:23:12.359339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a28c9c5e-f21e-49d4-8cb1-1c597876dc79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc2a72590a0>]}
[0m20:23:12.362716 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m20:23:12.802877 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m20:23:15.501582 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:23:15.504282 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:23:15.625010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a28c9c5e-f21e-49d4-8cb1-1c597876dc79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc2a0060ee0>]}
[0m20:23:16.467029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a28c9c5e-f21e-49d4-8cb1-1c597876dc79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc26d779a90>]}
[0m20:23:16.470407 [info ] [MainThread]: Found 6 models, 2 sources, 600 macros
[0m20:23:16.473652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a28c9c5e-f21e-49d4-8cb1-1c597876dc79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc2a006cca0>]}
[0m20:23:16.480415 [info ] [MainThread]: 
[0m20:23:16.484067 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m20:23:16.495676 [debug] [MainThread]: Command end result
[0m20:23:16.658895 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 7.6048093, "process_in_blocks": "880", "process_kernel_time": 0.907456, "process_mem_max_rss": "258240", "process_out_blocks": "568", "process_user_time": 10.345008}
[0m20:23:16.662036 [debug] [MainThread]: Command `dbt test` succeeded at 20:23:16.661615 after 7.61 seconds
[0m20:23:16.664826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc2a6ed5f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc2a4d58520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc2a4d587f0>]}
[0m20:23:16.667389 [debug] [MainThread]: Flushing usage events
[0m20:24:07.326228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f947c5e0f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f947a3b69a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f947a3b6940>]}


============================== 20:24:07.342552 | ff3b6936-c6c4-4c31-a3fc-60c8d7f13fd6 ==============================
[0m20:24:07.342552 [info ] [MainThread]: Running with dbt=1.8.9
[0m20:24:07.347447 [debug] [MainThread]: running dbt with arguments {'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'no_print': 'None', 'cache_selected_only': 'False', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'log_cache_events': 'False', 'version_check': 'True', 'printer_width': '80', 'quiet': 'False', 'indirect_selection': 'eager', 'fail_fast': 'False', 'introspect': 'True', 'target_path': 'None', 'profiles_dir': '/opt/airflow/include/dbt/', 'invocation_command': 'dbt test --profiles-dir /opt/airflow/include/dbt/', 'debug': 'False', 'use_experimental_parser': 'False', 'static_parser': 'True', 'write_json': 'True', 'use_colors': 'True', 'empty': 'None', 'log_format': 'default', 'log_path': '/opt/airflow/include/dbt/logs'}
[0m20:24:09.923271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ff3b6936-c6c4-4c31-a3fc-60c8d7f13fd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9443d07a30>]}
[0m20:24:10.073039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ff3b6936-c6c4-4c31-a3fc-60c8d7f13fd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9442f1ab20>]}
[0m20:24:10.076876 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m20:24:10.504515 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m20:24:13.707007 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m20:24:13.712426 [debug] [MainThread]: Partial parsing: added file: nyc_taxi://models/tests/schema.yml
[0m20:24:13.905386 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m20:24:13.908808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'ff3b6936-c6c4-4c31-a3fc-60c8d7f13fd6', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94755e2f40>]}
[0m20:24:15.060691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ff3b6936-c6c4-4c31-a3fc-60c8d7f13fd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9475479130>]}
[0m20:24:15.571775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ff3b6936-c6c4-4c31-a3fc-60c8d7f13fd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9475242970>]}
[0m20:24:15.574882 [info ] [MainThread]: Found 6 models, 32 data tests, 2 sources, 600 macros
[0m20:24:15.577683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ff3b6936-c6c4-4c31-a3fc-60c8d7f13fd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94756b1c40>]}
[0m20:24:15.591461 [info ] [MainThread]: 
[0m20:24:15.595515 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m20:24:15.612081 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_northern-shield-437204-m0_nyc_taxi'
[0m20:24:15.615357 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:24:17.087388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ff3b6936-c6c4-4c31-a3fc-60c8d7f13fd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9475242f40>]}
[0m20:24:17.091256 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:24:17.094520 [info ] [MainThread]: 
[0m20:24:17.117064 [debug] [Thread-1  ]: Began running node test.nyc_taxi.accepted_values_dim_payment_payment_name__Credit_card__Cash__No_charge__Dispute__Unknown__Voided_trip.58d00ef9f4
[0m20:24:17.121354 [info ] [Thread-1  ]: 1 of 32 START test accepted_values_dim_payment_payment_name__Credit_card__Cash__No_charge__Dispute__Unknown__Voided_trip  [RUN]
[0m20:24:17.125757 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_northern-shield-437204-m0_nyc_taxi, now test.nyc_taxi.accepted_values_dim_payment_payment_name__Credit_card__Cash__No_charge__Dispute__Unknown__Voided_trip.58d00ef9f4)
[0m20:24:17.129150 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.accepted_values_dim_payment_payment_name__Credit_card__Cash__No_charge__Dispute__Unknown__Voided_trip.58d00ef9f4
[0m20:24:17.162976 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.accepted_values_dim_payment_payment_name__Credit_card__Cash__No_charge__Dispute__Unknown__Voided_trip.58d00ef9f4"
[0m20:24:17.190400 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.accepted_values_dim_payment_payment_name__Credit_card__Cash__No_charge__Dispute__Unknown__Voided_trip.58d00ef9f4
[0m20:24:17.254331 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.accepted_values_dim_payment_payment_name__Credit_card__Cash__No_charge__Dispute__Unknown__Voided_trip.58d00ef9f4"
[0m20:24:17.280425 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:24:17.290553 [debug] [Thread-1  ]: On test.nyc_taxi.accepted_values_dim_payment_payment_name__Credit_card__Cash__No_charge__Dispute__Unknown__Voided_trip.58d00ef9f4: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.accepted_values_dim_payment_payment_name__Credit_card__Cash__No_charge__Dispute__Unknown__Voided_trip.58d00ef9f4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        payment_name as value_field,
        count(*) as n_records

    from `northern-shield-437204-m0`.`nyc_taxi`.`dim_payment`
    group by payment_name

)

select *
from all_values
where value_field not in (
    'Credit card','Cash','No charge','Dispute','Unknown','Voided trip'
)



      
    ) dbt_internal_test
[0m20:24:18.484748 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:16b30e2b-d891-49f9-b85c-3067a74eac88&page=queryresults
[0m20:24:20.003879 [info ] [Thread-1  ]: 1 of 32 PASS accepted_values_dim_payment_payment_name__Credit_card__Cash__No_charge__Dispute__Unknown__Voided_trip  [[32mPASS[0m in 2.88s]
[0m20:24:20.008798 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.accepted_values_dim_payment_payment_name__Credit_card__Cash__No_charge__Dispute__Unknown__Voided_trip.58d00ef9f4
[0m20:24:20.012259 [debug] [Thread-1  ]: Began running node test.nyc_taxi.accepted_values_dim_ratecode_rate_code_name__Standard_rate__JFK__Newark__Nassau_or_Westchester__Negotiated_fare__Group_ride__Unknown.57ee02019f
[0m20:24:20.015893 [info ] [Thread-1  ]: 2 of 32 START test accepted_values_dim_ratecode_rate_code_name__Standard_rate__JFK__Newark__Nassau_or_Westchester__Negotiated_fare__Group_ride__Unknown  [RUN]
[0m20:24:20.020457 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.accepted_values_dim_payment_payment_name__Credit_card__Cash__No_charge__Dispute__Unknown__Voided_trip.58d00ef9f4, now test.nyc_taxi.accepted_values_dim_ratecode_rate_code_name__Standard_rate__JFK__Newark__Nassau_or_Westchester__Negotiated_fare__Group_ride__Unknown.57ee02019f)
[0m20:24:20.023950 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.accepted_values_dim_ratecode_rate_code_name__Standard_rate__JFK__Newark__Nassau_or_Westchester__Negotiated_fare__Group_ride__Unknown.57ee02019f
[0m20:24:20.052765 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.accepted_values_dim_ratecode_rate_code_name__Standard_rate__JFK__Newark__Nassau_or_Westchester__Negotiated_fare__Group_ride__Unknown.57ee02019f"
[0m20:24:20.082231 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.accepted_values_dim_ratecode_rate_code_name__Standard_rate__JFK__Newark__Nassau_or_Westchester__Negotiated_fare__Group_ride__Unknown.57ee02019f
[0m20:24:20.103475 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.accepted_values_dim_ratecode_rate_code_name__Standard_rate__JFK__Newark__Nassau_or_Westchester__Negotiated_fare__Group_ride__Unknown.57ee02019f"
[0m20:24:20.130041 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:24:20.141307 [debug] [Thread-1  ]: On test.nyc_taxi.accepted_values_dim_ratecode_rate_code_name__Standard_rate__JFK__Newark__Nassau_or_Westchester__Negotiated_fare__Group_ride__Unknown.57ee02019f: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.accepted_values_dim_ratecode_rate_code_name__Standard_rate__JFK__Newark__Nassau_or_Westchester__Negotiated_fare__Group_ride__Unknown.57ee02019f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        rate_code_name as value_field,
        count(*) as n_records

    from `northern-shield-437204-m0`.`nyc_taxi`.`dim_ratecode`
    group by rate_code_name

)

select *
from all_values
where value_field not in (
    'Standard rate','JFK','Newark','Nassau or Westchester','Negotiated fare','Group ride','Unknown'
)



      
    ) dbt_internal_test
[0m20:24:21.596764 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:2337ea3f-372a-4f78-9a4c-21cc1217fc1e&page=queryresults
[0m20:24:23.102151 [info ] [Thread-1  ]: 2 of 32 PASS accepted_values_dim_ratecode_rate_code_name__Standard_rate__JFK__Newark__Nassau_or_Westchester__Negotiated_fare__Group_ride__Unknown  [[32mPASS[0m in 3.08s]
[0m20:24:23.107065 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.accepted_values_dim_ratecode_rate_code_name__Standard_rate__JFK__Newark__Nassau_or_Westchester__Negotiated_fare__Group_ride__Unknown.57ee02019f
[0m20:24:23.110392 [debug] [Thread-1  ]: Began running node test.nyc_taxi.accepted_values_dim_time_weekday__Sunday__Monday__Tuesday__Wednesday__Thursday__Friday__Saturday.87b4c2a366
[0m20:24:23.113823 [info ] [Thread-1  ]: 3 of 32 START test accepted_values_dim_time_weekday__Sunday__Monday__Tuesday__Wednesday__Thursday__Friday__Saturday  [RUN]
[0m20:24:23.117629 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.accepted_values_dim_ratecode_rate_code_name__Standard_rate__JFK__Newark__Nassau_or_Westchester__Negotiated_fare__Group_ride__Unknown.57ee02019f, now test.nyc_taxi.accepted_values_dim_time_weekday__Sunday__Monday__Tuesday__Wednesday__Thursday__Friday__Saturday.87b4c2a366)
[0m20:24:23.122078 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.accepted_values_dim_time_weekday__Sunday__Monday__Tuesday__Wednesday__Thursday__Friday__Saturday.87b4c2a366
[0m20:24:23.146179 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.accepted_values_dim_time_weekday__Sunday__Monday__Tuesday__Wednesday__Thursday__Friday__Saturday.87b4c2a366"
[0m20:24:23.201608 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.accepted_values_dim_time_weekday__Sunday__Monday__Tuesday__Wednesday__Thursday__Friday__Saturday.87b4c2a366
[0m20:24:23.213780 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.accepted_values_dim_time_weekday__Sunday__Monday__Tuesday__Wednesday__Thursday__Friday__Saturday.87b4c2a366"
[0m20:24:23.239385 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:24:23.250038 [debug] [Thread-1  ]: On test.nyc_taxi.accepted_values_dim_time_weekday__Sunday__Monday__Tuesday__Wednesday__Thursday__Friday__Saturday.87b4c2a366: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.accepted_values_dim_time_weekday__Sunday__Monday__Tuesday__Wednesday__Thursday__Friday__Saturday.87b4c2a366"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        weekday as value_field,
        count(*) as n_records

    from `northern-shield-437204-m0`.`nyc_taxi`.`dim_time`
    group by weekday

)

select *
from all_values
where value_field not in (
    'Sunday','Monday','Tuesday','Wednesday','Thursday','Friday','Saturday'
)



      
    ) dbt_internal_test
[0m20:24:25.107234 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:41aadef6-b257-431f-8bec-5ff8ad423330&page=queryresults
[0m20:24:26.915601 [info ] [Thread-1  ]: 3 of 32 PASS accepted_values_dim_time_weekday__Sunday__Monday__Tuesday__Wednesday__Thursday__Friday__Saturday  [[32mPASS[0m in 3.80s]
[0m20:24:26.920722 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.accepted_values_dim_time_weekday__Sunday__Monday__Tuesday__Wednesday__Thursday__Friday__Saturday.87b4c2a366
[0m20:24:26.925250 [debug] [Thread-1  ]: Began running node test.nyc_taxi.accepted_values_dim_vendor_vendor_name__Creative_Mobile_Technologies__VeriFone_Inc_.7481cecf07
[0m20:24:26.928847 [info ] [Thread-1  ]: 4 of 32 START test accepted_values_dim_vendor_vendor_name__Creative_Mobile_Technologies__VeriFone_Inc_  [RUN]
[0m20:24:26.933783 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.accepted_values_dim_time_weekday__Sunday__Monday__Tuesday__Wednesday__Thursday__Friday__Saturday.87b4c2a366, now test.nyc_taxi.accepted_values_dim_vendor_vendor_name__Creative_Mobile_Technologies__VeriFone_Inc_.7481cecf07)
[0m20:24:26.937929 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.accepted_values_dim_vendor_vendor_name__Creative_Mobile_Technologies__VeriFone_Inc_.7481cecf07
[0m20:24:26.959271 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.accepted_values_dim_vendor_vendor_name__Creative_Mobile_Technologies__VeriFone_Inc_.7481cecf07"
[0m20:24:26.984868 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.accepted_values_dim_vendor_vendor_name__Creative_Mobile_Technologies__VeriFone_Inc_.7481cecf07
[0m20:24:27.002866 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.accepted_values_dim_vendor_vendor_name__Creative_Mobile_Technologies__VeriFone_Inc_.7481cecf07"
[0m20:24:27.028578 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:24:27.039410 [debug] [Thread-1  ]: On test.nyc_taxi.accepted_values_dim_vendor_vendor_name__Creative_Mobile_Technologies__VeriFone_Inc_.7481cecf07: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.accepted_values_dim_vendor_vendor_name__Creative_Mobile_Technologies__VeriFone_Inc_.7481cecf07"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        vendor_name as value_field,
        count(*) as n_records

    from `northern-shield-437204-m0`.`nyc_taxi`.`dim_vendor`
    group by vendor_name

)

select *
from all_values
where value_field not in (
    'Creative Mobile Technologies','VeriFone Inc.'
)



      
    ) dbt_internal_test
[0m20:24:28.720295 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:0ad6317a-b6a7-4ac7-95ae-eb73aac44ee6&page=queryresults
[0m20:24:30.369449 [info ] [Thread-1  ]: 4 of 32 PASS accepted_values_dim_vendor_vendor_name__Creative_Mobile_Technologies__VeriFone_Inc_  [[32mPASS[0m in 3.44s]
[0m20:24:30.382378 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.accepted_values_dim_vendor_vendor_name__Creative_Mobile_Technologies__VeriFone_Inc_.7481cecf07
[0m20:24:30.386971 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_dim_payment_type_id.96dfa722aa
[0m20:24:30.390611 [info ] [Thread-1  ]: 5 of 32 START test not_null_dim_payment_type_id ................................ [RUN]
[0m20:24:30.395107 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.accepted_values_dim_vendor_vendor_name__Creative_Mobile_Technologies__VeriFone_Inc_.7481cecf07, now test.nyc_taxi.not_null_dim_payment_type_id.96dfa722aa)
[0m20:24:30.398220 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_dim_payment_type_id.96dfa722aa
[0m20:24:30.443947 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_dim_payment_type_id.96dfa722aa"
[0m20:24:30.496521 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_dim_payment_type_id.96dfa722aa
[0m20:24:30.509992 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_dim_payment_type_id.96dfa722aa"
[0m20:24:30.529963 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:24:30.538979 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_dim_payment_type_id.96dfa722aa: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_dim_payment_type_id.96dfa722aa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select type_id
from `northern-shield-437204-m0`.`nyc_taxi`.`dim_payment`
where type_id is null



      
    ) dbt_internal_test
[0m20:24:32.809210 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:2d8b3ffb-e515-42b3-be8c-763ac9c9a736&page=queryresults
[0m20:24:34.850941 [info ] [Thread-1  ]: 5 of 32 PASS not_null_dim_payment_type_id ...................................... [[32mPASS[0m in 4.46s]
[0m20:24:34.860545 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_dim_payment_type_id.96dfa722aa
[0m20:24:34.863953 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_dim_time_date.2080f42875
[0m20:24:34.867354 [info ] [Thread-1  ]: 6 of 32 START test not_null_dim_time_date ...................................... [RUN]
[0m20:24:34.871483 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_dim_payment_type_id.96dfa722aa, now test.nyc_taxi.not_null_dim_time_date.2080f42875)
[0m20:24:34.876005 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_dim_time_date.2080f42875
[0m20:24:34.898582 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_dim_time_date.2080f42875"
[0m20:24:34.922904 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_dim_time_date.2080f42875
[0m20:24:34.937133 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_dim_time_date.2080f42875"
[0m20:24:34.954834 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:24:34.963093 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_dim_time_date.2080f42875: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_dim_time_date.2080f42875"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from `northern-shield-437204-m0`.`nyc_taxi`.`dim_time`
where date is null



      
    ) dbt_internal_test
[0m20:24:36.671583 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:962bd6de-0b5e-4968-9ed6-b02f41fc4721&page=queryresults
[0m20:24:38.397076 [info ] [Thread-1  ]: 6 of 32 PASS not_null_dim_time_date ............................................ [[32mPASS[0m in 3.53s]
[0m20:24:38.405829 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_dim_time_date.2080f42875
[0m20:24:38.410074 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_dim_time_date_part.59e6206332
[0m20:24:38.413598 [info ] [Thread-1  ]: 7 of 32 START test not_null_dim_time_date_part ................................. [RUN]
[0m20:24:38.418063 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_dim_time_date.2080f42875, now test.nyc_taxi.not_null_dim_time_date_part.59e6206332)
[0m20:24:38.421984 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_dim_time_date_part.59e6206332
[0m20:24:38.483190 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_dim_time_date_part.59e6206332"
[0m20:24:38.530463 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_dim_time_date_part.59e6206332
[0m20:24:38.542910 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_dim_time_date_part.59e6206332"
[0m20:24:38.562102 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:24:38.570823 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_dim_time_date_part.59e6206332: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_dim_time_date_part.59e6206332"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date_part
from `northern-shield-437204-m0`.`nyc_taxi`.`dim_time`
where date_part is null



      
    ) dbt_internal_test
[0m20:24:40.244096 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:54b69e9b-370e-4225-b666-f041fa47888f&page=queryresults
[0m20:24:41.609218 [info ] [Thread-1  ]: 7 of 32 PASS not_null_dim_time_date_part ....................................... [[32mPASS[0m in 3.19s]
[0m20:24:41.615099 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_dim_time_date_part.59e6206332
[0m20:24:41.619257 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_dim_time_day.dc0e917166
[0m20:24:41.622605 [info ] [Thread-1  ]: 8 of 32 START test not_null_dim_time_day ....................................... [RUN]
[0m20:24:41.627523 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_dim_time_date_part.59e6206332, now test.nyc_taxi.not_null_dim_time_day.dc0e917166)
[0m20:24:41.645032 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_dim_time_day.dc0e917166
[0m20:24:41.686810 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_dim_time_day.dc0e917166"
[0m20:24:41.708033 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_dim_time_day.dc0e917166
[0m20:24:41.719905 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_dim_time_day.dc0e917166"
[0m20:24:41.744240 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:24:41.756589 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_dim_time_day.dc0e917166: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_dim_time_day.dc0e917166"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select day
from `northern-shield-437204-m0`.`nyc_taxi`.`dim_time`
where day is null



      
    ) dbt_internal_test
[0m20:24:43.190806 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:06f86ddd-6410-4994-bc4a-702f1df3540b&page=queryresults
[0m20:24:44.831930 [info ] [Thread-1  ]: 8 of 32 PASS not_null_dim_time_day ............................................. [[32mPASS[0m in 3.20s]
[0m20:24:44.837988 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_dim_time_day.dc0e917166
[0m20:24:44.843224 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_dim_time_hour.5b8ccd8f25
[0m20:24:44.846996 [info ] [Thread-1  ]: 9 of 32 START test not_null_dim_time_hour ...................................... [RUN]
[0m20:24:44.850999 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_dim_time_day.dc0e917166, now test.nyc_taxi.not_null_dim_time_hour.5b8ccd8f25)
[0m20:24:44.855519 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_dim_time_hour.5b8ccd8f25
[0m20:24:44.873591 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_dim_time_hour.5b8ccd8f25"
[0m20:24:44.893611 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_dim_time_hour.5b8ccd8f25
[0m20:24:44.906210 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_dim_time_hour.5b8ccd8f25"
[0m20:24:44.931742 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:24:44.941092 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_dim_time_hour.5b8ccd8f25: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_dim_time_hour.5b8ccd8f25"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select hour
from `northern-shield-437204-m0`.`nyc_taxi`.`dim_time`
where hour is null



      
    ) dbt_internal_test
[0m20:24:46.584088 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:a608a3a9-4b57-4c5d-aa19-b9613f13d1c6&page=queryresults
[0m20:24:48.306801 [info ] [Thread-1  ]: 9 of 32 PASS not_null_dim_time_hour ............................................ [[32mPASS[0m in 3.46s]
[0m20:24:48.311829 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_dim_time_hour.5b8ccd8f25
[0m20:24:48.321383 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_dim_time_minute.23e906ca61
[0m20:24:48.324294 [info ] [Thread-1  ]: 10 of 32 START test not_null_dim_time_minute ................................... [RUN]
[0m20:24:48.328395 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_dim_time_hour.5b8ccd8f25, now test.nyc_taxi.not_null_dim_time_minute.23e906ca61)
[0m20:24:48.331644 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_dim_time_minute.23e906ca61
[0m20:24:48.355711 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_dim_time_minute.23e906ca61"
[0m20:24:48.377734 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_dim_time_minute.23e906ca61
[0m20:24:48.391358 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_dim_time_minute.23e906ca61"
[0m20:24:48.412288 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:24:48.421659 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_dim_time_minute.23e906ca61: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_dim_time_minute.23e906ca61"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select minute
from `northern-shield-437204-m0`.`nyc_taxi`.`dim_time`
where minute is null



      
    ) dbt_internal_test
[0m20:24:49.920778 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:495f4d27-45a6-47e1-bae9-c0a10bc40816&page=queryresults
[0m20:24:51.701471 [info ] [Thread-1  ]: 10 of 32 PASS not_null_dim_time_minute ......................................... [[32mPASS[0m in 3.37s]
[0m20:24:51.705797 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_dim_time_minute.23e906ca61
[0m20:24:51.709389 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_dim_time_month.9f6ecf2eb5
[0m20:24:51.712358 [info ] [Thread-1  ]: 11 of 32 START test not_null_dim_time_month .................................... [RUN]
[0m20:24:51.715723 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_dim_time_minute.23e906ca61, now test.nyc_taxi.not_null_dim_time_month.9f6ecf2eb5)
[0m20:24:51.719300 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_dim_time_month.9f6ecf2eb5
[0m20:24:51.734844 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_dim_time_month.9f6ecf2eb5"
[0m20:24:51.765000 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_dim_time_month.9f6ecf2eb5
[0m20:24:51.775650 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_dim_time_month.9f6ecf2eb5"
[0m20:24:51.801681 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:24:51.811639 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_dim_time_month.9f6ecf2eb5: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_dim_time_month.9f6ecf2eb5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select month
from `northern-shield-437204-m0`.`nyc_taxi`.`dim_time`
where month is null



      
    ) dbt_internal_test
[0m20:24:53.407065 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:bef5cc9a-20fd-4dea-93e1-4d16cbc40f3d&page=queryresults
[0m20:24:54.995987 [info ] [Thread-1  ]: 11 of 32 PASS not_null_dim_time_month .......................................... [[32mPASS[0m in 3.28s]
[0m20:24:55.005102 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_dim_time_month.9f6ecf2eb5
[0m20:24:55.009738 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_dim_time_year.6fb9595d53
[0m20:24:55.014034 [info ] [Thread-1  ]: 12 of 32 START test not_null_dim_time_year ..................................... [RUN]
[0m20:24:55.023522 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_dim_time_month.9f6ecf2eb5, now test.nyc_taxi.not_null_dim_time_year.6fb9595d53)
[0m20:24:55.026929 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_dim_time_year.6fb9595d53
[0m20:24:55.054766 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_dim_time_year.6fb9595d53"
[0m20:24:55.077124 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_dim_time_year.6fb9595d53
[0m20:24:55.088314 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_dim_time_year.6fb9595d53"
[0m20:24:55.117646 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:24:55.127607 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_dim_time_year.6fb9595d53: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_dim_time_year.6fb9595d53"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select year
from `northern-shield-437204-m0`.`nyc_taxi`.`dim_time`
where year is null



      
    ) dbt_internal_test
[0m20:24:56.517286 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:8df23c1a-5cc6-4b75-a10a-31b0d7dba4f8&page=queryresults
[0m20:24:58.179152 [info ] [Thread-1  ]: 12 of 32 PASS not_null_dim_time_year ........................................... [[32mPASS[0m in 3.16s]
[0m20:24:58.185316 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_dim_time_year.6fb9595d53
[0m20:24:58.189570 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_dim_zone_borough.1ed2272c52
[0m20:24:58.196069 [info ] [Thread-1  ]: 13 of 32 START test not_null_dim_zone_borough .................................. [RUN]
[0m20:24:58.200804 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_dim_time_year.6fb9595d53, now test.nyc_taxi.not_null_dim_zone_borough.1ed2272c52)
[0m20:24:58.204923 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_dim_zone_borough.1ed2272c52
[0m20:24:58.225540 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_dim_zone_borough.1ed2272c52"
[0m20:24:58.247253 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_dim_zone_borough.1ed2272c52
[0m20:24:58.262765 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_dim_zone_borough.1ed2272c52"
[0m20:24:58.283516 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:24:58.292858 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_dim_zone_borough.1ed2272c52: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_dim_zone_borough.1ed2272c52"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select borough
from `northern-shield-437204-m0`.`nyc_taxi`.`dim_zone`
where borough is null



      
    ) dbt_internal_test
[0m20:24:59.553118 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:f691e3a2-92be-4fc1-81bb-7a09058a0aa9&page=queryresults
[0m20:25:00.711269 [info ] [Thread-1  ]: 13 of 32 PASS not_null_dim_zone_borough ........................................ [[32mPASS[0m in 2.51s]
[0m20:25:00.716228 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_dim_zone_borough.1ed2272c52
[0m20:25:00.719722 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_dim_zone_service_zone.2007f611c5
[0m20:25:00.723187 [info ] [Thread-1  ]: 14 of 32 START test not_null_dim_zone_service_zone ............................. [RUN]
[0m20:25:00.726867 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_dim_zone_borough.1ed2272c52, now test.nyc_taxi.not_null_dim_zone_service_zone.2007f611c5)
[0m20:25:00.730583 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_dim_zone_service_zone.2007f611c5
[0m20:25:00.748899 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_dim_zone_service_zone.2007f611c5"
[0m20:25:00.774287 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_dim_zone_service_zone.2007f611c5
[0m20:25:00.787299 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_dim_zone_service_zone.2007f611c5"
[0m20:25:00.813938 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:25:00.824676 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_dim_zone_service_zone.2007f611c5: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_dim_zone_service_zone.2007f611c5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select service_zone
from `northern-shield-437204-m0`.`nyc_taxi`.`dim_zone`
where service_zone is null



      
    ) dbt_internal_test
[0m20:25:01.839236 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:15ca4778-8de7-4056-b559-6ee6e8d4dce8&page=queryresults
[0m20:25:03.243588 [error] [Thread-1  ]: 14 of 32 FAIL 1 not_null_dim_zone_service_zone ................................. [[31mFAIL 1[0m in 2.52s]
[0m20:25:03.248839 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_dim_zone_service_zone.2007f611c5
[0m20:25:03.259020 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_dim_zone_zone.a1c4a4c37a
[0m20:25:03.262792 [info ] [Thread-1  ]: 15 of 32 START test not_null_dim_zone_zone ..................................... [RUN]
[0m20:25:03.265979 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_dim_zone_service_zone.2007f611c5, now test.nyc_taxi.not_null_dim_zone_zone.a1c4a4c37a)
[0m20:25:03.269007 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_dim_zone_zone.a1c4a4c37a
[0m20:25:03.286271 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_dim_zone_zone.a1c4a4c37a"
[0m20:25:03.313174 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_dim_zone_zone.a1c4a4c37a
[0m20:25:03.325607 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_dim_zone_zone.a1c4a4c37a"
[0m20:25:03.352121 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:25:03.362491 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_dim_zone_zone.a1c4a4c37a: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_dim_zone_zone.a1c4a4c37a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select zone
from `northern-shield-437204-m0`.`nyc_taxi`.`dim_zone`
where zone is null



      
    ) dbt_internal_test
[0m20:25:04.547203 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:fcd25459-11c2-4374-9247-618f0bd7e0d4&page=queryresults
[0m20:25:06.055284 [error] [Thread-1  ]: 15 of 32 FAIL 1 not_null_dim_zone_zone ......................................... [[31mFAIL 1[0m in 2.79s]
[0m20:25:06.061649 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_dim_zone_zone.a1c4a4c37a
[0m20:25:06.067574 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_do_location_id.6acdd302a6
[0m20:25:06.071120 [info ] [Thread-1  ]: 16 of 32 START test not_null_fct_trips_do_location_id .......................... [RUN]
[0m20:25:06.074725 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_dim_zone_zone.a1c4a4c37a, now test.nyc_taxi.not_null_fct_trips_do_location_id.6acdd302a6)
[0m20:25:06.078282 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_do_location_id.6acdd302a6
[0m20:25:06.097104 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_do_location_id.6acdd302a6"
[0m20:25:06.123583 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_do_location_id.6acdd302a6
[0m20:25:06.135716 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_fct_trips_do_location_id.6acdd302a6"
[0m20:25:06.162685 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:25:06.173399 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_fct_trips_do_location_id.6acdd302a6: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_fct_trips_do_location_id.6acdd302a6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select do_location_id
from `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips`
where do_location_id is null



      
    ) dbt_internal_test
[0m20:25:07.661851 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:f29d446a-663e-4763-aeb4-a7fdffcc4297&page=queryresults
[0m20:25:09.164002 [info ] [Thread-1  ]: 16 of 32 PASS not_null_fct_trips_do_location_id ................................ [[32mPASS[0m in 3.09s]
[0m20:25:09.169936 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_do_location_id.6acdd302a6
[0m20:25:09.182954 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_dropoff_time_id.781496e98f
[0m20:25:09.187507 [info ] [Thread-1  ]: 17 of 32 START test not_null_fct_trips_dropoff_time_id ......................... [RUN]
[0m20:25:09.193471 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_do_location_id.6acdd302a6, now test.nyc_taxi.not_null_fct_trips_dropoff_time_id.781496e98f)
[0m20:25:09.196979 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_dropoff_time_id.781496e98f
[0m20:25:09.224382 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_dropoff_time_id.781496e98f"
[0m20:25:09.243696 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_dropoff_time_id.781496e98f
[0m20:25:09.256214 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_fct_trips_dropoff_time_id.781496e98f"
[0m20:25:09.275801 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:25:09.285621 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_fct_trips_dropoff_time_id.781496e98f: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_fct_trips_dropoff_time_id.781496e98f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select dropoff_time_id
from `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips`
where dropoff_time_id is null



      
    ) dbt_internal_test
[0m20:25:10.768177 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:14409b1e-119c-46c2-92b8-dcadf74972af&page=queryresults
[0m20:25:12.274444 [info ] [Thread-1  ]: 17 of 32 PASS not_null_fct_trips_dropoff_time_id ............................... [[32mPASS[0m in 3.08s]
[0m20:25:12.279063 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_dropoff_time_id.781496e98f
[0m20:25:12.282771 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_extra.1801055bb3
[0m20:25:12.286182 [info ] [Thread-1  ]: 18 of 32 START test not_null_fct_trips_extra ................................... [RUN]
[0m20:25:12.290251 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_dropoff_time_id.781496e98f, now test.nyc_taxi.not_null_fct_trips_extra.1801055bb3)
[0m20:25:12.293464 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_extra.1801055bb3
[0m20:25:12.311620 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_extra.1801055bb3"
[0m20:25:12.336832 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_extra.1801055bb3
[0m20:25:12.347339 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_fct_trips_extra.1801055bb3"
[0m20:25:12.374022 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:25:12.384028 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_fct_trips_extra.1801055bb3: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_fct_trips_extra.1801055bb3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select extra
from `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips`
where extra is null



      
    ) dbt_internal_test
[0m20:25:13.813643 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:7923f3dd-22d0-427e-836d-b6ede27b82a1&page=queryresults
[0m20:25:15.385292 [info ] [Thread-1  ]: 18 of 32 PASS not_null_fct_trips_extra ......................................... [[32mPASS[0m in 3.09s]
[0m20:25:15.391124 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_extra.1801055bb3
[0m20:25:15.397347 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_improvement_surcharge.4cf28d1443
[0m20:25:15.441902 [info ] [Thread-1  ]: 19 of 32 START test not_null_fct_trips_improvement_surcharge ................... [RUN]
[0m20:25:15.446213 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_extra.1801055bb3, now test.nyc_taxi.not_null_fct_trips_improvement_surcharge.4cf28d1443)
[0m20:25:15.449658 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_improvement_surcharge.4cf28d1443
[0m20:25:15.471955 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_improvement_surcharge.4cf28d1443"
[0m20:25:15.496364 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_improvement_surcharge.4cf28d1443
[0m20:25:15.508347 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_fct_trips_improvement_surcharge.4cf28d1443"
[0m20:25:15.527163 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:25:15.536791 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_fct_trips_improvement_surcharge.4cf28d1443: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_fct_trips_improvement_surcharge.4cf28d1443"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select improvement_surcharge
from `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips`
where improvement_surcharge is null



      
    ) dbt_internal_test
[0m20:25:17.091513 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:0c1c8531-ce7d-4968-befb-6354714dea41&page=queryresults
[0m20:25:18.770195 [info ] [Thread-1  ]: 19 of 32 PASS not_null_fct_trips_improvement_surcharge ......................... [[32mPASS[0m in 3.32s]
[0m20:25:18.776234 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_improvement_surcharge.4cf28d1443
[0m20:25:18.780314 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_passenger_count.b1370cab1c
[0m20:25:18.783395 [info ] [Thread-1  ]: 20 of 32 START test not_null_fct_trips_passenger_count ......................... [RUN]
[0m20:25:18.787987 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_improvement_surcharge.4cf28d1443, now test.nyc_taxi.not_null_fct_trips_passenger_count.b1370cab1c)
[0m20:25:18.791342 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_passenger_count.b1370cab1c
[0m20:25:18.810012 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_passenger_count.b1370cab1c"
[0m20:25:18.830727 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_passenger_count.b1370cab1c
[0m20:25:18.844954 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_fct_trips_passenger_count.b1370cab1c"
[0m20:25:18.865220 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:25:18.875215 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_fct_trips_passenger_count.b1370cab1c: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_fct_trips_passenger_count.b1370cab1c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select passenger_count
from `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips`
where passenger_count is null



      
    ) dbt_internal_test
[0m20:25:20.530471 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:4a0288e6-db46-41c8-8954-d3e0cf11a20c&page=queryresults
[0m20:25:22.296669 [info ] [Thread-1  ]: 20 of 32 PASS not_null_fct_trips_passenger_count ............................... [[32mPASS[0m in 3.51s]
[0m20:25:22.301588 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_passenger_count.b1370cab1c
[0m20:25:22.305774 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_payment_type.93889b679a
[0m20:25:22.308758 [info ] [Thread-1  ]: 21 of 32 START test not_null_fct_trips_payment_type ............................ [RUN]
[0m20:25:22.312701 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_passenger_count.b1370cab1c, now test.nyc_taxi.not_null_fct_trips_payment_type.93889b679a)
[0m20:25:22.316038 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_payment_type.93889b679a
[0m20:25:22.332747 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_payment_type.93889b679a"
[0m20:25:22.358703 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_payment_type.93889b679a
[0m20:25:22.369747 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_fct_trips_payment_type.93889b679a"
[0m20:25:22.396439 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:25:22.406187 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_fct_trips_payment_type.93889b679a: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_fct_trips_payment_type.93889b679a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select payment_type
from `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips`
where payment_type is null



      
    ) dbt_internal_test
[0m20:25:24.778175 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:8a1735b4-3e86-45ae-98c6-6b940b2fe5fa&page=queryresults
[0m20:25:27.191852 [info ] [Thread-1  ]: 21 of 32 PASS not_null_fct_trips_payment_type .................................. [[32mPASS[0m in 4.88s]
[0m20:25:27.197739 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_payment_type.93889b679a
[0m20:25:27.204200 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_pickup_time_id.f31fbe0eeb
[0m20:25:27.207255 [info ] [Thread-1  ]: 22 of 32 START test not_null_fct_trips_pickup_time_id .......................... [RUN]
[0m20:25:27.214861 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_payment_type.93889b679a, now test.nyc_taxi.not_null_fct_trips_pickup_time_id.f31fbe0eeb)
[0m20:25:27.219087 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_pickup_time_id.f31fbe0eeb
[0m20:25:27.250045 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_pickup_time_id.f31fbe0eeb"
[0m20:25:27.275534 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_pickup_time_id.f31fbe0eeb
[0m20:25:27.287732 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_fct_trips_pickup_time_id.f31fbe0eeb"
[0m20:25:27.313808 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:25:27.325525 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_fct_trips_pickup_time_id.f31fbe0eeb: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_fct_trips_pickup_time_id.f31fbe0eeb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select pickup_time_id
from `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips`
where pickup_time_id is null



      
    ) dbt_internal_test
[0m20:25:28.832563 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:ccd6a542-9311-4f58-9c3d-fae7745de092&page=queryresults
[0m20:25:30.438933 [info ] [Thread-1  ]: 22 of 32 PASS not_null_fct_trips_pickup_time_id ................................ [[32mPASS[0m in 3.22s]
[0m20:25:30.443893 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_pickup_time_id.f31fbe0eeb
[0m20:25:30.447507 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_pu_location_id.b0dc8dd185
[0m20:25:30.451093 [info ] [Thread-1  ]: 23 of 32 START test not_null_fct_trips_pu_location_id .......................... [RUN]
[0m20:25:30.454828 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_pickup_time_id.f31fbe0eeb, now test.nyc_taxi.not_null_fct_trips_pu_location_id.b0dc8dd185)
[0m20:25:30.458288 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_pu_location_id.b0dc8dd185
[0m20:25:30.479521 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_pu_location_id.b0dc8dd185"
[0m20:25:30.505809 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_pu_location_id.b0dc8dd185
[0m20:25:30.518604 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_fct_trips_pu_location_id.b0dc8dd185"
[0m20:25:30.547085 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:25:30.558538 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_fct_trips_pu_location_id.b0dc8dd185: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_fct_trips_pu_location_id.b0dc8dd185"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select pu_location_id
from `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips`
where pu_location_id is null



      
    ) dbt_internal_test
[0m20:25:31.944279 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:272082f9-741f-4704-a683-d701c76c619a&page=queryresults
[0m20:25:33.447644 [info ] [Thread-1  ]: 23 of 32 PASS not_null_fct_trips_pu_location_id ................................ [[32mPASS[0m in 2.99s]
[0m20:25:33.452467 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_pu_location_id.b0dc8dd185
[0m20:25:33.455741 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_rate_code_id.ba0047eaae
[0m20:25:33.458599 [info ] [Thread-1  ]: 24 of 32 START test not_null_fct_trips_rate_code_id ............................ [RUN]
[0m20:25:33.462578 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_pu_location_id.b0dc8dd185, now test.nyc_taxi.not_null_fct_trips_rate_code_id.ba0047eaae)
[0m20:25:33.465772 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_rate_code_id.ba0047eaae
[0m20:25:33.487629 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_rate_code_id.ba0047eaae"
[0m20:25:33.508111 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_rate_code_id.ba0047eaae
[0m20:25:33.522910 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_fct_trips_rate_code_id.ba0047eaae"
[0m20:25:33.537107 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:25:33.547965 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_fct_trips_rate_code_id.ba0047eaae: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_fct_trips_rate_code_id.ba0047eaae"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select rate_code_id
from `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips`
where rate_code_id is null



      
    ) dbt_internal_test
[0m20:25:34.754680 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:c9364ae5-1dad-43fd-8320-ee93404d41d6&page=queryresults
[0m20:25:36.257516 [info ] [Thread-1  ]: 24 of 32 PASS not_null_fct_trips_rate_code_id .................................. [[32mPASS[0m in 2.79s]
[0m20:25:36.262642 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_rate_code_id.ba0047eaae
[0m20:25:36.271994 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_trip_distance.19cd17f1df
[0m20:25:36.275078 [info ] [Thread-1  ]: 25 of 32 START test not_null_fct_trips_trip_distance ........................... [RUN]
[0m20:25:36.278460 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_rate_code_id.ba0047eaae, now test.nyc_taxi.not_null_fct_trips_trip_distance.19cd17f1df)
[0m20:25:36.285355 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_trip_distance.19cd17f1df
[0m20:25:36.301658 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_trip_distance.19cd17f1df"
[0m20:25:36.326670 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_trip_distance.19cd17f1df
[0m20:25:36.339295 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_fct_trips_trip_distance.19cd17f1df"
[0m20:25:36.362290 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:25:36.373938 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_fct_trips_trip_distance.19cd17f1df: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_fct_trips_trip_distance.19cd17f1df"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select trip_distance
from `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips`
where trip_distance is null



      
    ) dbt_internal_test
[0m20:25:37.666165 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:22312f5a-0eb0-4be3-9545-aca16bc79dcd&page=queryresults
[0m20:25:39.168880 [info ] [Thread-1  ]: 25 of 32 PASS not_null_fct_trips_trip_distance ................................. [[32mPASS[0m in 2.89s]
[0m20:25:39.174503 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_trip_distance.19cd17f1df
[0m20:25:39.178490 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_vendor_id.b9b2f380bb
[0m20:25:39.182113 [info ] [Thread-1  ]: 26 of 32 START test not_null_fct_trips_vendor_id ............................... [RUN]
[0m20:25:39.185802 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_trip_distance.19cd17f1df, now test.nyc_taxi.not_null_fct_trips_vendor_id.b9b2f380bb)
[0m20:25:39.189434 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_vendor_id.b9b2f380bb
[0m20:25:39.208591 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_vendor_id.b9b2f380bb"
[0m20:25:39.229215 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_vendor_id.b9b2f380bb
[0m20:25:39.241498 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_fct_trips_vendor_id.b9b2f380bb"
[0m20:25:39.266817 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:25:39.277452 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_fct_trips_vendor_id.b9b2f380bb: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_fct_trips_vendor_id.b9b2f380bb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select vendor_id
from `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips`
where vendor_id is null



      
    ) dbt_internal_test
[0m20:25:40.468295 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:c0cb9abc-9f77-4375-a3b5-de50b33db55f&page=queryresults
[0m20:25:41.685761 [info ] [Thread-1  ]: 26 of 32 PASS not_null_fct_trips_vendor_id ..................................... [[32mPASS[0m in 2.50s]
[0m20:25:41.691974 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_vendor_id.b9b2f380bb
[0m20:25:41.695836 [debug] [Thread-1  ]: Began running node test.nyc_taxi.unique_dim_payment_type_id.dea55de04e
[0m20:25:41.699446 [info ] [Thread-1  ]: 27 of 32 START test unique_dim_payment_type_id ................................. [RUN]
[0m20:25:41.704486 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_vendor_id.b9b2f380bb, now test.nyc_taxi.unique_dim_payment_type_id.dea55de04e)
[0m20:25:41.707878 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.unique_dim_payment_type_id.dea55de04e
[0m20:25:41.740154 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.unique_dim_payment_type_id.dea55de04e"
[0m20:25:41.766232 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.unique_dim_payment_type_id.dea55de04e
[0m20:25:41.778288 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.unique_dim_payment_type_id.dea55de04e"
[0m20:25:41.803203 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:25:41.813844 [debug] [Thread-1  ]: On test.nyc_taxi.unique_dim_payment_type_id.dea55de04e: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.unique_dim_payment_type_id.dea55de04e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select type_id as unique_field
  from `northern-shield-437204-m0`.`nyc_taxi`.`dim_payment`
  where type_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m20:25:42.883429 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:7e9269fb-7dd6-4cbc-a0e0-9503aa86e3ff&page=queryresults
[0m20:25:44.048826 [info ] [Thread-1  ]: 27 of 32 PASS unique_dim_payment_type_id ....................................... [[32mPASS[0m in 2.34s]
[0m20:25:44.054128 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.unique_dim_payment_type_id.dea55de04e
[0m20:25:44.058034 [debug] [Thread-1  ]: Began running node test.nyc_taxi.unique_dim_ratecode_rate_id.75ae8e4885
[0m20:25:44.061314 [info ] [Thread-1  ]: 28 of 32 START test unique_dim_ratecode_rate_id ................................ [RUN]
[0m20:25:44.064880 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.unique_dim_payment_type_id.dea55de04e, now test.nyc_taxi.unique_dim_ratecode_rate_id.75ae8e4885)
[0m20:25:44.068524 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.unique_dim_ratecode_rate_id.75ae8e4885
[0m20:25:44.123895 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.unique_dim_ratecode_rate_id.75ae8e4885"
[0m20:25:44.145592 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.unique_dim_ratecode_rate_id.75ae8e4885
[0m20:25:44.159439 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.unique_dim_ratecode_rate_id.75ae8e4885"
[0m20:25:44.183819 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:25:44.193995 [debug] [Thread-1  ]: On test.nyc_taxi.unique_dim_ratecode_rate_id.75ae8e4885: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.unique_dim_ratecode_rate_id.75ae8e4885"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select rate_id as unique_field
  from `northern-shield-437204-m0`.`nyc_taxi`.`dim_ratecode`
  where rate_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m20:25:45.608698 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:f4da06ed-f0b6-44f3-b1c2-24562f15ad7f&page=queryresults
[0m20:25:47.096795 [info ] [Thread-1  ]: 28 of 32 PASS unique_dim_ratecode_rate_id ...................................... [[32mPASS[0m in 3.03s]
[0m20:25:47.102133 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.unique_dim_ratecode_rate_id.75ae8e4885
[0m20:25:47.106099 [debug] [Thread-1  ]: Began running node test.nyc_taxi.unique_dim_time_time_id.0752c025e8
[0m20:25:47.109370 [info ] [Thread-1  ]: 29 of 32 START test unique_dim_time_time_id .................................... [RUN]
[0m20:25:47.113052 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.unique_dim_ratecode_rate_id.75ae8e4885, now test.nyc_taxi.unique_dim_time_time_id.0752c025e8)
[0m20:25:47.117141 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.unique_dim_time_time_id.0752c025e8
[0m20:25:47.135794 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.unique_dim_time_time_id.0752c025e8"
[0m20:25:47.160167 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.unique_dim_time_time_id.0752c025e8
[0m20:25:47.178549 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.unique_dim_time_time_id.0752c025e8"
[0m20:25:47.202343 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:25:47.212154 [debug] [Thread-1  ]: On test.nyc_taxi.unique_dim_time_time_id.0752c025e8: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.unique_dim_time_time_id.0752c025e8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select time_id as unique_field
  from `northern-shield-437204-m0`.`nyc_taxi`.`dim_time`
  where time_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m20:25:48.601000 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:611466d0-9f0d-40cb-8ace-f094b5e5feb6&page=queryresults
[0m20:25:50.107603 [info ] [Thread-1  ]: 29 of 32 PASS unique_dim_time_time_id .......................................... [[32mPASS[0m in 2.99s]
[0m20:25:50.112652 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.unique_dim_time_time_id.0752c025e8
[0m20:25:50.115974 [debug] [Thread-1  ]: Began running node test.nyc_taxi.unique_dim_vendor_id.03fad38d04
[0m20:25:50.119519 [info ] [Thread-1  ]: 30 of 32 START test unique_dim_vendor_id ....................................... [RUN]
[0m20:25:50.123167 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.unique_dim_time_time_id.0752c025e8, now test.nyc_taxi.unique_dim_vendor_id.03fad38d04)
[0m20:25:50.127424 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.unique_dim_vendor_id.03fad38d04
[0m20:25:50.147488 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.unique_dim_vendor_id.03fad38d04"
[0m20:25:50.172754 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.unique_dim_vendor_id.03fad38d04
[0m20:25:50.183622 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.unique_dim_vendor_id.03fad38d04"
[0m20:25:50.209331 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:25:50.220210 [debug] [Thread-1  ]: On test.nyc_taxi.unique_dim_vendor_id.03fad38d04: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.unique_dim_vendor_id.03fad38d04"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select id as unique_field
  from `northern-shield-437204-m0`.`nyc_taxi`.`dim_vendor`
  where id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m20:25:51.713066 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:e6523c14-a21d-4c99-a414-a9584a0c375d&page=queryresults
[0m20:25:53.234372 [info ] [Thread-1  ]: 30 of 32 PASS unique_dim_vendor_id ............................................. [[32mPASS[0m in 3.11s]
[0m20:25:53.246040 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.unique_dim_vendor_id.03fad38d04
[0m20:25:53.251637 [debug] [Thread-1  ]: Began running node test.nyc_taxi.unique_dim_zone_location_id.7702f92424
[0m20:25:53.254985 [info ] [Thread-1  ]: 31 of 32 START test unique_dim_zone_location_id ................................ [RUN]
[0m20:25:53.259643 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.unique_dim_vendor_id.03fad38d04, now test.nyc_taxi.unique_dim_zone_location_id.7702f92424)
[0m20:25:53.263457 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.unique_dim_zone_location_id.7702f92424
[0m20:25:53.280160 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.unique_dim_zone_location_id.7702f92424"
[0m20:25:53.304043 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.unique_dim_zone_location_id.7702f92424
[0m20:25:53.318193 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.unique_dim_zone_location_id.7702f92424"
[0m20:25:53.339537 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:25:53.348491 [debug] [Thread-1  ]: On test.nyc_taxi.unique_dim_zone_location_id.7702f92424: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.unique_dim_zone_location_id.7702f92424"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select location_id as unique_field
  from `northern-shield-437204-m0`.`nyc_taxi`.`dim_zone`
  where location_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m20:25:54.659139 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:e536e2f3-120b-469e-9461-59e21a7eb170&page=queryresults
[0m20:25:55.850087 [info ] [Thread-1  ]: 31 of 32 PASS unique_dim_zone_location_id ...................................... [[32mPASS[0m in 2.59s]
[0m20:25:55.854528 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.unique_dim_zone_location_id.7702f92424
[0m20:25:55.857931 [debug] [Thread-1  ]: Began running node test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab
[0m20:25:55.861037 [info ] [Thread-1  ]: 32 of 32 START test unique_fct_trips_trip_id ................................... [RUN]
[0m20:25:55.864195 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.unique_dim_zone_location_id.7702f92424, now test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab)
[0m20:25:55.867254 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab
[0m20:25:55.889412 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab"
[0m20:25:55.911343 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab
[0m20:25:55.925187 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab"
[0m20:25:55.944346 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:25:55.957506 [debug] [Thread-1  ]: On test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select trip_id as unique_field
  from `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips`
  where trip_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m20:25:57.253430 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:34d47549-80fb-40ad-aa4f-079cf472eb61&page=queryresults
[0m20:25:58.476728 [error] [Thread-1  ]: 32 of 32 FAIL 3555 unique_fct_trips_trip_id .................................... [[31mFAIL 3555[0m in 2.61s]
[0m20:25:58.481861 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab
[0m20:25:58.489022 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:25:58.491587 [debug] [MainThread]: Connection 'test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab' was properly closed.
[0m20:25:58.494749 [info ] [MainThread]: 
[0m20:25:58.497618 [info ] [MainThread]: Finished running 32 data tests in 0 hours 1 minutes and 42.90 seconds (102.90s).
[0m20:25:58.544628 [debug] [MainThread]: Command end result
[0m20:25:58.779375 [info ] [MainThread]: 
[0m20:25:58.782237 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m20:25:58.784657 [info ] [MainThread]: 
[0m20:25:58.788170 [error] [MainThread]: [31mFailure in test not_null_dim_zone_service_zone (models/tests/schema.yml)[0m
[0m20:25:58.791308 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m20:25:58.794540 [info ] [MainThread]: 
[0m20:25:58.797445 [info ] [MainThread]:   compiled code at target/compiled/nyc_taxi/models/tests/schema.yml/not_null_dim_zone_service_zone.sql
[0m20:25:58.800007 [info ] [MainThread]: 
[0m20:25:58.802888 [error] [MainThread]: [31mFailure in test not_null_dim_zone_zone (models/tests/schema.yml)[0m
[0m20:25:58.806404 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m20:25:58.809480 [info ] [MainThread]: 
[0m20:25:58.812748 [info ] [MainThread]:   compiled code at target/compiled/nyc_taxi/models/tests/schema.yml/not_null_dim_zone_zone.sql
[0m20:25:58.815508 [info ] [MainThread]: 
[0m20:25:58.818422 [error] [MainThread]: [31mFailure in test unique_fct_trips_trip_id (models/tests/schema.yml)[0m
[0m20:25:58.821928 [error] [MainThread]:   Got 3555 results, configured to fail if != 0
[0m20:25:58.824460 [info ] [MainThread]: 
[0m20:25:58.827438 [info ] [MainThread]:   compiled code at target/compiled/nyc_taxi/models/tests/schema.yml/unique_fct_trips_trip_id.sql
[0m20:25:58.830447 [info ] [MainThread]: 
[0m20:25:58.833104 [info ] [MainThread]: Done. PASS=29 WARN=0 ERROR=3 SKIP=0 TOTAL=32
[0m20:25:58.837778 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 111.7054, "process_in_blocks": "0", "process_kernel_time": 0.939066, "process_mem_max_rss": "234812", "process_out_blocks": "0", "process_user_time": 16.78071}
[0m20:25:58.841458 [debug] [MainThread]: Command `dbt test` failed at 20:25:58.841086 after 111.71 seconds
[0m20:25:58.844612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f947c5e0f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94751ac700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94751acca0>]}
[0m20:25:58.847635 [debug] [MainThread]: Flushing usage events
[0m20:29:24.680473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e818ca400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e7f702a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e7f7029d0>]}


============================== 20:29:24.697280 | ba8f25ea-62c4-4c7c-aa7b-093e509e5c73 ==============================
[0m20:29:24.697280 [info ] [MainThread]: Running with dbt=1.8.9
[0m20:29:24.701401 [debug] [MainThread]: running dbt with arguments {'quiet': 'False', 'introspect': 'True', 'debug': 'False', 'cache_selected_only': 'False', 'use_colors': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'log_cache_events': 'False', 'log_path': '/opt/airflow/include/dbt/logs', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'write_json': 'True', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'fail_fast': 'False', 'target_path': 'None', 'partial_parse': 'True', 'no_print': 'None', 'log_format': 'default', 'empty': 'False', 'static_parser': 'True', 'version_check': 'True', 'printer_width': '80', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/include/dbt/', 'profiles_dir': '/opt/airflow/include/dbt/'}
[0m20:29:27.311276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ba8f25ea-62c4-4c7c-aa7b-093e509e5c73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e4d0abc70>]}
[0m20:29:27.460182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ba8f25ea-62c4-4c7c-aa7b-093e509e5c73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e4c3701f0>]}
[0m20:29:27.463791 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m20:29:27.878889 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m20:29:31.061426 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:29:31.065421 [debug] [MainThread]: Partial parsing: updated file: nyc_taxi://models/transform/dim_zone.sql
[0m20:29:32.042037 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m20:29:32.045826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'ba8f25ea-62c4-4c7c-aa7b-093e509e5c73', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e7a991b20>]}
[0m20:29:32.790325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ba8f25ea-62c4-4c7c-aa7b-093e509e5c73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e77729a00>]}
[0m20:29:33.329973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ba8f25ea-62c4-4c7c-aa7b-093e509e5c73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e7aa0fb80>]}
[0m20:29:33.333900 [info ] [MainThread]: Found 6 models, 32 data tests, 2 sources, 600 macros
[0m20:29:33.336770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ba8f25ea-62c4-4c7c-aa7b-093e509e5c73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e77779910>]}
[0m20:29:33.345381 [info ] [MainThread]: 
[0m20:29:33.349701 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m20:29:33.367323 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_northern-shield-437204-m0'
[0m20:29:33.370951 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:29:34.505193 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_northern-shield-437204-m0, now list_northern-shield-437204-m0_nyc_taxi)
[0m20:29:34.508407 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:29:35.610810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ba8f25ea-62c4-4c7c-aa7b-093e509e5c73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e7a9ca160>]}
[0m20:29:35.614850 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:29:35.618004 [info ] [MainThread]: 
[0m20:29:35.637701 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_payment
[0m20:29:35.642318 [info ] [Thread-1  ]: 1 of 6 START sql table model nyc_taxi.dim_payment .............................. [RUN]
[0m20:29:35.646083 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_northern-shield-437204-m0_nyc_taxi, now model.nyc_taxi.dim_payment)
[0m20:29:35.649675 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_payment
[0m20:29:35.682902 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_payment"
[0m20:29:35.703812 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_payment
[0m20:29:35.761655 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:29:36.993200 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.dim_payment"
[0m20:29:37.011029 [debug] [Thread-1  ]: On model.nyc_taxi.dim_payment: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.dim_payment"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`dim_payment`
      
    
    

    OPTIONS()
    as (
      WITH payment_cte AS(
    SELECT DISTINCT
        payment_type AS type_id,
        CASE 
            WHEN payment_type = 1 THEN "Credit card"
            WHEN payment_type = 2 THEN "Cash"
            WHEN payment_type = 3 THEN "No charge"
            WHEN payment_type = 4 THEN "Dispute"
            WHEN payment_type = 5 THEN "Unknown"
            WHEN payment_type = 6 THEN "Voided trip"
        END AS payment_name
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata`
)
SELECT
    type_id,
    payment_name
FROM payment_cte
    );
  
[0m20:29:37.811591 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:ef07426e-86b1-4011-a58f-1888b01c65d7&page=queryresults
[0m20:29:40.354656 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ba8f25ea-62c4-4c7c-aa7b-093e509e5c73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e4c1bd670>]}
[0m20:29:40.360192 [info ] [Thread-1  ]: 1 of 6 OK created sql table model nyc_taxi.dim_payment ......................... [[32mCREATE TABLE (4.0 rows, 463.5 KiB processed)[0m in 4.70s]
[0m20:29:40.366041 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_payment
[0m20:29:40.370233 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_ratecode
[0m20:29:40.374313 [info ] [Thread-1  ]: 2 of 6 START sql table model nyc_taxi.dim_ratecode ............................. [RUN]
[0m20:29:40.378624 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_payment, now model.nyc_taxi.dim_ratecode)
[0m20:29:40.382918 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_ratecode
[0m20:29:40.403400 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_ratecode"
[0m20:29:40.421326 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_ratecode
[0m20:29:40.432521 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:29:41.428439 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.dim_ratecode"
[0m20:29:41.451484 [debug] [Thread-1  ]: On model.nyc_taxi.dim_ratecode: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.dim_ratecode"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`dim_ratecode`
      
    
    

    OPTIONS()
    as (
      WITH rate_code_cte AS(
    SELECT DISTINCT
        rate_code_id AS rate_id,
        CASE 
            WHEN rate_code_id = 1 THEN "Standard rate"
            WHEN rate_code_id = 2 THEN "JFK"
            WHEN rate_code_id = 3 THEN "Newark"
            WHEN rate_code_id = 4 THEN "Nassau or Westchester"
            WHEN rate_code_id = 5 THEN "Negotiated fare"
            WHEN rate_code_id = 6 THEN "Group ride"
        ELSE "Unknown"
        END AS rate_code_name
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata`
)
SELECT
    rate_id,
    rate_code_name
FROM rate_code_cte
    );
  
[0m20:29:42.010593 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:e4b5bae8-5433-4b2c-8503-667edb82f344&page=queryresults
[0m20:29:44.771076 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ba8f25ea-62c4-4c7c-aa7b-093e509e5c73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e4c1bd670>]}
[0m20:29:44.775377 [info ] [Thread-1  ]: 2 of 6 OK created sql table model nyc_taxi.dim_ratecode ........................ [[32mCREATE TABLE (6.0 rows, 463.5 KiB processed)[0m in 4.39s]
[0m20:29:44.780583 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_ratecode
[0m20:29:44.784818 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_time
[0m20:29:44.788887 [info ] [Thread-1  ]: 3 of 6 START sql table model nyc_taxi.dim_time ................................. [RUN]
[0m20:29:44.792687 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_ratecode, now model.nyc_taxi.dim_time)
[0m20:29:44.796841 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_time
[0m20:29:44.812262 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_time"
[0m20:29:44.836839 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_time
[0m20:29:44.848167 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:29:46.044176 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.dim_time"
[0m20:29:46.065329 [debug] [Thread-1  ]: On model.nyc_taxi.dim_time: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.dim_time"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`dim_time`
      
    
    

    OPTIONS()
    as (
      WITH datetime_cte AS (
    SELECT DISTINCT
        lpep_pickup_datetime AS datetime_value
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata`
    UNION ALL
    SELECT DISTINCT
        lpep_dropoff_datetime AS datetime_value
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata`
)
SELECT DISTINCT
    ROW_NUMBER() OVER (ORDER BY datetime_value) AS time_id,
    DATE(datetime_value) AS date,
    datetime_value AS date_part,
    EXTRACT(YEAR FROM datetime_value) AS year,
    EXTRACT(MONTH FROM datetime_value) AS month,
    EXTRACT(DAY FROM datetime_value) AS day,
    EXTRACT(HOUR FROM datetime_value) AS hour,
    EXTRACT(MINUTE FROM datetime_value) AS minute,
    FORMAT_TIMESTAMP('%A', datetime_value) AS weekday
FROM datetime_cte
ORDER BY time_id
    );
  
[0m20:29:46.844616 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:2d54eee3-7b81-475d-bef8-9f864a1dc4ce&page=queryresults
[0m20:29:50.619017 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ba8f25ea-62c4-4c7c-aa7b-093e509e5c73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e74dde340>]}
[0m20:29:50.622926 [info ] [Thread-1  ]: 3 of 6 OK created sql table model nyc_taxi.dim_time ............................ [[32mCREATE TABLE (116.8k rows, 927.0 KiB processed)[0m in 5.83s]
[0m20:29:50.627607 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_time
[0m20:29:50.631626 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_vendor
[0m20:29:50.635083 [info ] [Thread-1  ]: 4 of 6 START sql table model nyc_taxi.dim_vendor ............................... [RUN]
[0m20:29:50.639959 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_time, now model.nyc_taxi.dim_vendor)
[0m20:29:50.643231 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_vendor
[0m20:29:50.657749 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_vendor"
[0m20:29:50.679951 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_vendor
[0m20:29:50.700794 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:29:51.648969 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.dim_vendor"
[0m20:29:51.668897 [debug] [Thread-1  ]: On model.nyc_taxi.dim_vendor: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.dim_vendor"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`dim_vendor`
      
    
    

    OPTIONS()
    as (
      WITH vendor_cte AS(
    SELECT DISTINCT
        vendor_id AS id,
        CASE 
            WHEN vendor_id = 1 THEN "Creative Mobile Technologies"
            WHEN vendor_id = 2 THEN "VeriFone Inc."
        END AS vendor_name
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata`
)
SELECT
    id,
    vendor_name
FROM vendor_cte
    );
  
[0m20:29:52.362919 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:e950d5f3-c8be-47cf-8352-23d9ccbb44fd&page=queryresults
[0m20:29:55.081569 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ba8f25ea-62c4-4c7c-aa7b-093e509e5c73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e74d692b0>]}
[0m20:29:55.086526 [info ] [Thread-1  ]: 4 of 6 OK created sql table model nyc_taxi.dim_vendor .......................... [[32mCREATE TABLE (2.0 rows, 463.5 KiB processed)[0m in 4.44s]
[0m20:29:55.093531 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_vendor
[0m20:29:55.098844 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_zone
[0m20:29:55.103505 [info ] [Thread-1  ]: 5 of 6 START sql table model nyc_taxi.dim_zone ................................. [RUN]
[0m20:29:55.108919 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_vendor, now model.nyc_taxi.dim_zone)
[0m20:29:55.113550 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_zone
[0m20:29:55.128841 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_zone"
[0m20:29:55.146331 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_zone
[0m20:29:55.167126 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.dim_zone"
[0m20:29:55.184867 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:29:55.197457 [debug] [Thread-1  ]: On model.nyc_taxi.dim_zone: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.dim_zone"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`dim_zone`
      
    
    

    OPTIONS()
    as (
      SELECT DISTINCT
    location_id,
    borough,
    zone,
    replace(service_zone, 'Boro', 'Green') as service_zone
FROM `northern-shield-437204-m0`.`nyc_taxi`.`zone_map`
WHERE service_zone is not null
    );
  
[0m20:29:56.278582 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:3d6db035-974f-4ffd-aa91-82c1400bf967&page=queryresults
[0m20:29:58.992398 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ba8f25ea-62c4-4c7c-aa7b-093e509e5c73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e4c1bd280>]}
[0m20:29:58.996736 [info ] [Thread-1  ]: 5 of 6 OK created sql table model nyc_taxi.dim_zone ............................ [[32mCREATE TABLE (263.0 rows, 24.2 KiB processed)[0m in 3.88s]
[0m20:29:59.000965 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_zone
[0m20:29:59.004098 [debug] [Thread-1  ]: Began running node model.nyc_taxi.fct_trips
[0m20:29:59.007119 [info ] [Thread-1  ]: 6 of 6 START sql table model nyc_taxi.fct_trips ................................ [RUN]
[0m20:29:59.010197 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_zone, now model.nyc_taxi.fct_trips)
[0m20:29:59.013106 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.fct_trips
[0m20:29:59.066697 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.fct_trips"
[0m20:29:59.088082 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.fct_trips
[0m20:29:59.104093 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:30:00.132683 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.fct_trips"
[0m20:30:00.152368 [debug] [Thread-1  ]: On model.nyc_taxi.fct_trips: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.fct_trips"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips`
      
    
    

    OPTIONS()
    as (
      WITH tripdata_cte AS (
    SELECT 
        to_hex(md5(cast(coalesce(cast(vendor_id as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(lpep_pickup_datetime as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(lpep_dropoff_datetime as string), '_dbt_utils_surrogate_key_null_') as string)))  AS trip_id,
        t.vendor_id,
        pt.time_id AS pickup_time_id,
        dt.time_id AS dropoff_time_id,
        t.rate_code_id,
        t.pu_location_id,
        t.do_location_id,
        t.passenger_count,
        t.trip_distance,
        t.fare_amount,
        t.extra,
        t.mta_tax,
        t.tip_amount,
        t.tolls_amount,
        t.improvement_surcharge,
        t.total_amount,
        t.payment_type,
        t.trip_type,
        t.congestion_surcharge
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata` AS t
    LEFT JOIN (
        SELECT DISTINCT date_part, time_id 
        FROM `northern-shield-437204-m0`.`nyc_taxi`.`dim_time`
    ) pt ON t.lpep_pickup_datetime = pt.date_part
    LEFT JOIN (
        SELECT DISTINCT date_part, time_id 
        FROM `northern-shield-437204-m0`.`nyc_taxi`.`dim_time`
    ) dt ON t.lpep_dropoff_datetime = dt.date_part
    WHERE t.vendor_id IS NOT NULL
        AND t.passenger_count IS NOT NULL
        AND (t.trip_distance IS NOT NULL OR t.trip_distance >= 0)
        AND t.fare_amount >= 0
        AND t.extra >= 0
        AND t.mta_tax >= 0
        AND t.tip_amount >= 0
        AND t.improvement_surcharge >= 0
        AND t.total_amount >= 0
)
SELECT 
    trip_id,
    vendor_id,
    pickup_time_id,
    dropoff_time_id,
    rate_code_id,
    pu_location_id,
    do_location_id,
    passenger_count,
    trip_distance,
    fare_amount,
    extra,
    mta_tax,
    tip_amount,
    tolls_amount,
    improvement_surcharge,
    total_amount,
    payment_type,
    trip_type,
    congestion_surcharge
FROM tripdata_cte
    );
  
[0m20:30:00.894125 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:31c5cdbf-721d-4494-8982-5d9c0ca51660&page=queryresults
[0m20:30:05.315917 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ba8f25ea-62c4-4c7c-aa7b-093e509e5c73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e79ee32b0>]}
[0m20:30:05.320002 [info ] [Thread-1  ]: 6 of 6 OK created sql table model nyc_taxi.fct_trips ........................... [[32mCREATE TABLE (63.0k rows, 9.9 MiB processed)[0m in 6.31s]
[0m20:30:05.325645 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.fct_trips
[0m20:30:05.332965 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:30:05.336474 [debug] [MainThread]: Connection 'model.nyc_taxi.fct_trips' was properly closed.
[0m20:30:05.341139 [info ] [MainThread]: 
[0m20:30:05.344981 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 31.99 seconds (31.99s).
[0m20:30:05.357442 [debug] [MainThread]: Command end result
[0m20:30:05.579387 [info ] [MainThread]: 
[0m20:30:05.582379 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:30:05.585185 [info ] [MainThread]: 
[0m20:30:05.588592 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m20:30:05.593800 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 41.099983, "process_in_blocks": "0", "process_kernel_time": 0.712987, "process_mem_max_rss": "233764", "process_out_blocks": "0", "process_user_time": 13.393988}
[0m20:30:05.597733 [debug] [MainThread]: Command `dbt run` succeeded at 20:30:05.597107 after 41.10 seconds
[0m20:30:05.600847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e818ca400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e7fe88100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e4c1c3400>]}
[0m20:30:05.603845 [debug] [MainThread]: Flushing usage events
[0m20:32:05.877966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9b26d0f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9b04a69a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9b04a6940>]}


============================== 20:32:05.895933 | 6f2e55cc-2789-4ab0-a296-6dd3792f465e ==============================
[0m20:32:05.895933 [info ] [MainThread]: Running with dbt=1.8.9
[0m20:32:05.899539 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'partial_parse': 'True', 'version_check': 'True', 'printer_width': '80', 'empty': 'None', 'introspect': 'True', 'use_colors': 'True', 'log_path': '/opt/airflow/include/dbt/logs', 'quiet': 'False', 'debug': 'False', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'invocation_command': 'dbt test --profiles-dir /opt/airflow/include/dbt/', 'write_json': 'True', 'profiles_dir': '/opt/airflow/include/dbt/', 'warn_error': 'None', 'static_parser': 'True', 'log_format': 'default', 'no_print': 'None', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'use_experimental_parser': 'False', 'cache_selected_only': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])'}
[0m20:32:08.564490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6f2e55cc-2789-4ab0-a296-6dd3792f465e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9b0c07bb0>]}
[0m20:32:08.717420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6f2e55cc-2789-4ab0-a296-6dd3792f465e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc97905efa0>]}
[0m20:32:08.721688 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m20:32:09.143449 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m20:32:12.326471 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:32:12.329548 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:32:12.482899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6f2e55cc-2789-4ab0-a296-6dd3792f465e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9ab7c9130>]}
[0m20:32:13.149700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6f2e55cc-2789-4ab0-a296-6dd3792f465e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9b0c079d0>]}
[0m20:32:13.153398 [info ] [MainThread]: Found 6 models, 32 data tests, 2 sources, 600 macros
[0m20:32:13.156775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6f2e55cc-2789-4ab0-a296-6dd3792f465e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9ab8207f0>]}
[0m20:32:13.167494 [info ] [MainThread]: 
[0m20:32:13.171426 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m20:32:13.189576 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_northern-shield-437204-m0_nyc_taxi'
[0m20:32:13.192771 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:32:14.374104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6f2e55cc-2789-4ab0-a296-6dd3792f465e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc97907ff10>]}
[0m20:32:14.378243 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:32:14.381027 [info ] [MainThread]: 
[0m20:32:14.418822 [debug] [Thread-1  ]: Began running node test.nyc_taxi.accepted_values_dim_payment_payment_name__Credit_card__Cash__No_charge__Dispute__Unknown__Voided_trip.58d00ef9f4
[0m20:32:14.422875 [info ] [Thread-1  ]: 1 of 32 START test accepted_values_dim_payment_payment_name__Credit_card__Cash__No_charge__Dispute__Unknown__Voided_trip  [RUN]
[0m20:32:14.427283 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_northern-shield-437204-m0_nyc_taxi, now test.nyc_taxi.accepted_values_dim_payment_payment_name__Credit_card__Cash__No_charge__Dispute__Unknown__Voided_trip.58d00ef9f4)
[0m20:32:14.431197 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.accepted_values_dim_payment_payment_name__Credit_card__Cash__No_charge__Dispute__Unknown__Voided_trip.58d00ef9f4
[0m20:32:14.524750 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.accepted_values_dim_payment_payment_name__Credit_card__Cash__No_charge__Dispute__Unknown__Voided_trip.58d00ef9f4"
[0m20:32:14.547127 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.accepted_values_dim_payment_payment_name__Credit_card__Cash__No_charge__Dispute__Unknown__Voided_trip.58d00ef9f4
[0m20:32:14.612993 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.accepted_values_dim_payment_payment_name__Credit_card__Cash__No_charge__Dispute__Unknown__Voided_trip.58d00ef9f4"
[0m20:32:14.641075 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:32:14.651754 [debug] [Thread-1  ]: On test.nyc_taxi.accepted_values_dim_payment_payment_name__Credit_card__Cash__No_charge__Dispute__Unknown__Voided_trip.58d00ef9f4: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.accepted_values_dim_payment_payment_name__Credit_card__Cash__No_charge__Dispute__Unknown__Voided_trip.58d00ef9f4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        payment_name as value_field,
        count(*) as n_records

    from `northern-shield-437204-m0`.`nyc_taxi`.`dim_payment`
    group by payment_name

)

select *
from all_values
where value_field not in (
    'Credit card','Cash','No charge','Dispute','Unknown','Voided trip'
)



      
    ) dbt_internal_test
[0m20:32:16.174752 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:52b61488-1e80-4cdd-a7b1-cff83df75777&page=queryresults
[0m20:32:17.930963 [info ] [Thread-1  ]: 1 of 32 PASS accepted_values_dim_payment_payment_name__Credit_card__Cash__No_charge__Dispute__Unknown__Voided_trip  [[32mPASS[0m in 3.50s]
[0m20:32:17.938027 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.accepted_values_dim_payment_payment_name__Credit_card__Cash__No_charge__Dispute__Unknown__Voided_trip.58d00ef9f4
[0m20:32:17.942025 [debug] [Thread-1  ]: Began running node test.nyc_taxi.accepted_values_dim_ratecode_rate_code_name__Standard_rate__JFK__Newark__Nassau_or_Westchester__Negotiated_fare__Group_ride__Unknown.57ee02019f
[0m20:32:17.945783 [info ] [Thread-1  ]: 2 of 32 START test accepted_values_dim_ratecode_rate_code_name__Standard_rate__JFK__Newark__Nassau_or_Westchester__Negotiated_fare__Group_ride__Unknown  [RUN]
[0m20:32:17.952739 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.accepted_values_dim_payment_payment_name__Credit_card__Cash__No_charge__Dispute__Unknown__Voided_trip.58d00ef9f4, now test.nyc_taxi.accepted_values_dim_ratecode_rate_code_name__Standard_rate__JFK__Newark__Nassau_or_Westchester__Negotiated_fare__Group_ride__Unknown.57ee02019f)
[0m20:32:17.955999 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.accepted_values_dim_ratecode_rate_code_name__Standard_rate__JFK__Newark__Nassau_or_Westchester__Negotiated_fare__Group_ride__Unknown.57ee02019f
[0m20:32:17.985022 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.accepted_values_dim_ratecode_rate_code_name__Standard_rate__JFK__Newark__Nassau_or_Westchester__Negotiated_fare__Group_ride__Unknown.57ee02019f"
[0m20:32:18.008808 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.accepted_values_dim_ratecode_rate_code_name__Standard_rate__JFK__Newark__Nassau_or_Westchester__Negotiated_fare__Group_ride__Unknown.57ee02019f
[0m20:32:18.021114 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.accepted_values_dim_ratecode_rate_code_name__Standard_rate__JFK__Newark__Nassau_or_Westchester__Negotiated_fare__Group_ride__Unknown.57ee02019f"
[0m20:32:18.045870 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:32:18.055944 [debug] [Thread-1  ]: On test.nyc_taxi.accepted_values_dim_ratecode_rate_code_name__Standard_rate__JFK__Newark__Nassau_or_Westchester__Negotiated_fare__Group_ride__Unknown.57ee02019f: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.accepted_values_dim_ratecode_rate_code_name__Standard_rate__JFK__Newark__Nassau_or_Westchester__Negotiated_fare__Group_ride__Unknown.57ee02019f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        rate_code_name as value_field,
        count(*) as n_records

    from `northern-shield-437204-m0`.`nyc_taxi`.`dim_ratecode`
    group by rate_code_name

)

select *
from all_values
where value_field not in (
    'Standard rate','JFK','Newark','Nassau or Westchester','Negotiated fare','Group ride','Unknown'
)



      
    ) dbt_internal_test
[0m20:32:19.787648 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:946b62ba-a550-4e66-a0c6-d73aafad5d94&page=queryresults
[0m20:32:21.394371 [info ] [Thread-1  ]: 2 of 32 PASS accepted_values_dim_ratecode_rate_code_name__Standard_rate__JFK__Newark__Nassau_or_Westchester__Negotiated_fare__Group_ride__Unknown  [[32mPASS[0m in 3.44s]
[0m20:32:21.399741 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.accepted_values_dim_ratecode_rate_code_name__Standard_rate__JFK__Newark__Nassau_or_Westchester__Negotiated_fare__Group_ride__Unknown.57ee02019f
[0m20:32:21.403274 [debug] [Thread-1  ]: Began running node test.nyc_taxi.accepted_values_dim_time_weekday__Sunday__Monday__Tuesday__Wednesday__Thursday__Friday__Saturday.87b4c2a366
[0m20:32:21.406708 [info ] [Thread-1  ]: 3 of 32 START test accepted_values_dim_time_weekday__Sunday__Monday__Tuesday__Wednesday__Thursday__Friday__Saturday  [RUN]
[0m20:32:21.410745 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.accepted_values_dim_ratecode_rate_code_name__Standard_rate__JFK__Newark__Nassau_or_Westchester__Negotiated_fare__Group_ride__Unknown.57ee02019f, now test.nyc_taxi.accepted_values_dim_time_weekday__Sunday__Monday__Tuesday__Wednesday__Thursday__Friday__Saturday.87b4c2a366)
[0m20:32:21.419334 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.accepted_values_dim_time_weekday__Sunday__Monday__Tuesday__Wednesday__Thursday__Friday__Saturday.87b4c2a366
[0m20:32:21.477247 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.accepted_values_dim_time_weekday__Sunday__Monday__Tuesday__Wednesday__Thursday__Friday__Saturday.87b4c2a366"
[0m20:32:21.502564 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.accepted_values_dim_time_weekday__Sunday__Monday__Tuesday__Wednesday__Thursday__Friday__Saturday.87b4c2a366
[0m20:32:21.515903 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.accepted_values_dim_time_weekday__Sunday__Monday__Tuesday__Wednesday__Thursday__Friday__Saturday.87b4c2a366"
[0m20:32:21.539985 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:32:21.550808 [debug] [Thread-1  ]: On test.nyc_taxi.accepted_values_dim_time_weekday__Sunday__Monday__Tuesday__Wednesday__Thursday__Friday__Saturday.87b4c2a366: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.accepted_values_dim_time_weekday__Sunday__Monday__Tuesday__Wednesday__Thursday__Friday__Saturday.87b4c2a366"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        weekday as value_field,
        count(*) as n_records

    from `northern-shield-437204-m0`.`nyc_taxi`.`dim_time`
    group by weekday

)

select *
from all_values
where value_field not in (
    'Sunday','Monday','Tuesday','Wednesday','Thursday','Friday','Saturday'
)



      
    ) dbt_internal_test
[0m20:32:22.999515 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:bff716ae-2256-43a2-805e-9e2016ce7b7e&page=queryresults
[0m20:32:24.705552 [info ] [Thread-1  ]: 3 of 32 PASS accepted_values_dim_time_weekday__Sunday__Monday__Tuesday__Wednesday__Thursday__Friday__Saturday  [[32mPASS[0m in 3.29s]
[0m20:32:24.711055 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.accepted_values_dim_time_weekday__Sunday__Monday__Tuesday__Wednesday__Thursday__Friday__Saturday.87b4c2a366
[0m20:32:24.714509 [debug] [Thread-1  ]: Began running node test.nyc_taxi.accepted_values_dim_vendor_vendor_name__Creative_Mobile_Technologies__VeriFone_Inc_.7481cecf07
[0m20:32:24.717907 [info ] [Thread-1  ]: 4 of 32 START test accepted_values_dim_vendor_vendor_name__Creative_Mobile_Technologies__VeriFone_Inc_  [RUN]
[0m20:32:24.721447 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.accepted_values_dim_time_weekday__Sunday__Monday__Tuesday__Wednesday__Thursday__Friday__Saturday.87b4c2a366, now test.nyc_taxi.accepted_values_dim_vendor_vendor_name__Creative_Mobile_Technologies__VeriFone_Inc_.7481cecf07)
[0m20:32:24.725545 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.accepted_values_dim_vendor_vendor_name__Creative_Mobile_Technologies__VeriFone_Inc_.7481cecf07
[0m20:32:24.748094 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.accepted_values_dim_vendor_vendor_name__Creative_Mobile_Technologies__VeriFone_Inc_.7481cecf07"
[0m20:32:24.774731 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.accepted_values_dim_vendor_vendor_name__Creative_Mobile_Technologies__VeriFone_Inc_.7481cecf07
[0m20:32:24.787921 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.accepted_values_dim_vendor_vendor_name__Creative_Mobile_Technologies__VeriFone_Inc_.7481cecf07"
[0m20:32:24.811923 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:32:24.822031 [debug] [Thread-1  ]: On test.nyc_taxi.accepted_values_dim_vendor_vendor_name__Creative_Mobile_Technologies__VeriFone_Inc_.7481cecf07: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.accepted_values_dim_vendor_vendor_name__Creative_Mobile_Technologies__VeriFone_Inc_.7481cecf07"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        vendor_name as value_field,
        count(*) as n_records

    from `northern-shield-437204-m0`.`nyc_taxi`.`dim_vendor`
    group by vendor_name

)

select *
from all_values
where value_field not in (
    'Creative Mobile Technologies','VeriFone Inc.'
)



      
    ) dbt_internal_test
[0m20:32:26.611917 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:e86a505c-4801-4434-880c-99f274969b0e&page=queryresults
[0m20:32:28.213658 [info ] [Thread-1  ]: 4 of 32 PASS accepted_values_dim_vendor_vendor_name__Creative_Mobile_Technologies__VeriFone_Inc_  [[32mPASS[0m in 3.49s]
[0m20:32:28.220073 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.accepted_values_dim_vendor_vendor_name__Creative_Mobile_Technologies__VeriFone_Inc_.7481cecf07
[0m20:32:28.224832 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_dim_payment_type_id.96dfa722aa
[0m20:32:28.228169 [info ] [Thread-1  ]: 5 of 32 START test not_null_dim_payment_type_id ................................ [RUN]
[0m20:32:28.231919 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.accepted_values_dim_vendor_vendor_name__Creative_Mobile_Technologies__VeriFone_Inc_.7481cecf07, now test.nyc_taxi.not_null_dim_payment_type_id.96dfa722aa)
[0m20:32:28.236073 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_dim_payment_type_id.96dfa722aa
[0m20:32:28.282983 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_dim_payment_type_id.96dfa722aa"
[0m20:32:28.306209 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_dim_payment_type_id.96dfa722aa
[0m20:32:28.318300 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_dim_payment_type_id.96dfa722aa"
[0m20:32:28.339492 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:32:28.349115 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_dim_payment_type_id.96dfa722aa: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_dim_payment_type_id.96dfa722aa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select type_id
from `northern-shield-437204-m0`.`nyc_taxi`.`dim_payment`
where type_id is null



      
    ) dbt_internal_test
[0m20:32:30.022750 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:03a914ea-db15-4757-930f-04b73f649fdf&page=queryresults
[0m20:32:31.676342 [info ] [Thread-1  ]: 5 of 32 PASS not_null_dim_payment_type_id ...................................... [[32mPASS[0m in 3.44s]
[0m20:32:31.681350 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_dim_payment_type_id.96dfa722aa
[0m20:32:31.685146 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_dim_time_date.2080f42875
[0m20:32:31.688087 [info ] [Thread-1  ]: 6 of 32 START test not_null_dim_time_date ...................................... [RUN]
[0m20:32:31.691503 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_dim_payment_type_id.96dfa722aa, now test.nyc_taxi.not_null_dim_time_date.2080f42875)
[0m20:32:31.694256 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_dim_time_date.2080f42875
[0m20:32:31.708936 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_dim_time_date.2080f42875"
[0m20:32:31.727893 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_dim_time_date.2080f42875
[0m20:32:31.738419 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_dim_time_date.2080f42875"
[0m20:32:31.756970 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:32:31.765867 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_dim_time_date.2080f42875: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_dim_time_date.2080f42875"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from `northern-shield-437204-m0`.`nyc_taxi`.`dim_time`
where date is null



      
    ) dbt_internal_test
[0m20:32:33.574947 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:57db95c5-dd7c-47d3-af7e-8c52a396c2a5&page=queryresults
[0m20:32:35.244430 [info ] [Thread-1  ]: 6 of 32 PASS not_null_dim_time_date ............................................ [[32mPASS[0m in 3.55s]
[0m20:32:35.250172 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_dim_time_date.2080f42875
[0m20:32:35.255159 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_dim_time_date_part.59e6206332
[0m20:32:35.259839 [info ] [Thread-1  ]: 7 of 32 START test not_null_dim_time_date_part ................................. [RUN]
[0m20:32:35.264935 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_dim_time_date.2080f42875, now test.nyc_taxi.not_null_dim_time_date_part.59e6206332)
[0m20:32:35.268993 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_dim_time_date_part.59e6206332
[0m20:32:35.292576 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_dim_time_date_part.59e6206332"
[0m20:32:35.310941 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_dim_time_date_part.59e6206332
[0m20:32:35.335336 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_dim_time_date_part.59e6206332"
[0m20:32:35.352877 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:32:35.362451 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_dim_time_date_part.59e6206332: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_dim_time_date_part.59e6206332"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date_part
from `northern-shield-437204-m0`.`nyc_taxi`.`dim_time`
where date_part is null



      
    ) dbt_internal_test
[0m20:32:36.946038 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:552f72b1-dd53-4d36-8676-afa8d69d3372&page=queryresults
[0m20:32:38.535203 [info ] [Thread-1  ]: 7 of 32 PASS not_null_dim_time_date_part ....................................... [[32mPASS[0m in 3.27s]
[0m20:32:38.567948 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_dim_time_date_part.59e6206332
[0m20:32:38.579395 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_dim_time_day.dc0e917166
[0m20:32:38.591651 [info ] [Thread-1  ]: 8 of 32 START test not_null_dim_time_day ....................................... [RUN]
[0m20:32:38.600550 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_dim_time_date_part.59e6206332, now test.nyc_taxi.not_null_dim_time_day.dc0e917166)
[0m20:32:38.605029 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_dim_time_day.dc0e917166
[0m20:32:38.624711 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_dim_time_day.dc0e917166"
[0m20:32:38.640190 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_dim_time_day.dc0e917166
[0m20:32:38.650743 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_dim_time_day.dc0e917166"
[0m20:32:38.669833 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:32:38.677851 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_dim_time_day.dc0e917166: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_dim_time_day.dc0e917166"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select day
from `northern-shield-437204-m0`.`nyc_taxi`.`dim_time`
where day is null



      
    ) dbt_internal_test
[0m20:32:40.358280 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:518ccfae-9992-4df9-8025-a6dcca77c32a&page=queryresults
[0m20:32:42.042944 [info ] [Thread-1  ]: 8 of 32 PASS not_null_dim_time_day ............................................. [[32mPASS[0m in 3.44s]
[0m20:32:42.048949 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_dim_time_day.dc0e917166
[0m20:32:42.053790 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_dim_time_hour.5b8ccd8f25
[0m20:32:42.059747 [info ] [Thread-1  ]: 9 of 32 START test not_null_dim_time_hour ...................................... [RUN]
[0m20:32:42.071477 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_dim_time_day.dc0e917166, now test.nyc_taxi.not_null_dim_time_hour.5b8ccd8f25)
[0m20:32:42.074790 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_dim_time_hour.5b8ccd8f25
[0m20:32:42.093530 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_dim_time_hour.5b8ccd8f25"
[0m20:32:42.111698 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_dim_time_hour.5b8ccd8f25
[0m20:32:42.122911 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_dim_time_hour.5b8ccd8f25"
[0m20:32:42.140241 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:32:42.147965 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_dim_time_hour.5b8ccd8f25: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_dim_time_hour.5b8ccd8f25"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select hour
from `northern-shield-437204-m0`.`nyc_taxi`.`dim_time`
where hour is null



      
    ) dbt_internal_test
[0m20:32:44.613422 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:32c97add-08f5-4347-a8c9-4b1f755dd0c9&page=queryresults
[0m20:32:47.101236 [info ] [Thread-1  ]: 9 of 32 PASS not_null_dim_time_hour ............................................ [[32mPASS[0m in 5.03s]
[0m20:32:47.106136 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_dim_time_hour.5b8ccd8f25
[0m20:32:47.110454 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_dim_time_minute.23e906ca61
[0m20:32:47.113455 [info ] [Thread-1  ]: 10 of 32 START test not_null_dim_time_minute ................................... [RUN]
[0m20:32:47.116641 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_dim_time_hour.5b8ccd8f25, now test.nyc_taxi.not_null_dim_time_minute.23e906ca61)
[0m20:32:47.119867 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_dim_time_minute.23e906ca61
[0m20:32:47.145297 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_dim_time_minute.23e906ca61"
[0m20:32:47.166647 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_dim_time_minute.23e906ca61
[0m20:32:47.179323 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_dim_time_minute.23e906ca61"
[0m20:32:47.202880 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:32:47.213237 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_dim_time_minute.23e906ca61: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_dim_time_minute.23e906ca61"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select minute
from `northern-shield-437204-m0`.`nyc_taxi`.`dim_time`
where minute is null



      
    ) dbt_internal_test
[0m20:32:49.399224 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:e4f557bb-c584-4a4f-8937-42db001a42f2&page=queryresults
[0m20:32:51.104437 [info ] [Thread-1  ]: 10 of 32 PASS not_null_dim_time_minute ......................................... [[32mPASS[0m in 3.99s]
[0m20:32:51.109307 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_dim_time_minute.23e906ca61
[0m20:32:51.113487 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_dim_time_month.9f6ecf2eb5
[0m20:32:51.117484 [info ] [Thread-1  ]: 11 of 32 START test not_null_dim_time_month .................................... [RUN]
[0m20:32:51.122689 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_dim_time_minute.23e906ca61, now test.nyc_taxi.not_null_dim_time_month.9f6ecf2eb5)
[0m20:32:51.126401 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_dim_time_month.9f6ecf2eb5
[0m20:32:51.147852 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_dim_time_month.9f6ecf2eb5"
[0m20:32:51.172351 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_dim_time_month.9f6ecf2eb5
[0m20:32:51.183253 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_dim_time_month.9f6ecf2eb5"
[0m20:32:51.206783 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:32:51.216694 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_dim_time_month.9f6ecf2eb5: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_dim_time_month.9f6ecf2eb5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select month
from `northern-shield-437204-m0`.`nyc_taxi`.`dim_time`
where month is null



      
    ) dbt_internal_test
[0m20:32:52.702740 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:793011d4-3561-4cab-a6df-b880ce58b7b9&page=queryresults
[0m20:32:54.409330 [info ] [Thread-1  ]: 11 of 32 PASS not_null_dim_time_month .......................................... [[32mPASS[0m in 3.29s]
[0m20:32:54.414948 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_dim_time_month.9f6ecf2eb5
[0m20:32:54.419483 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_dim_time_year.6fb9595d53
[0m20:32:54.428024 [info ] [Thread-1  ]: 12 of 32 START test not_null_dim_time_year ..................................... [RUN]
[0m20:32:54.431738 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_dim_time_month.9f6ecf2eb5, now test.nyc_taxi.not_null_dim_time_year.6fb9595d53)
[0m20:32:54.435316 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_dim_time_year.6fb9595d53
[0m20:32:54.461804 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_dim_time_year.6fb9595d53"
[0m20:32:54.484786 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_dim_time_year.6fb9595d53
[0m20:32:54.496361 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_dim_time_year.6fb9595d53"
[0m20:32:54.520268 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:32:54.530405 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_dim_time_year.6fb9595d53: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_dim_time_year.6fb9595d53"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select year
from `northern-shield-437204-m0`.`nyc_taxi`.`dim_time`
where year is null



      
    ) dbt_internal_test
[0m20:32:56.416948 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:140e480b-fd18-4ede-a6ae-d903c05e4bb3&page=queryresults
[0m20:32:58.093214 [info ] [Thread-1  ]: 12 of 32 PASS not_null_dim_time_year ........................................... [[32mPASS[0m in 3.66s]
[0m20:32:58.097735 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_dim_time_year.6fb9595d53
[0m20:32:58.106359 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_dim_zone_borough.1ed2272c52
[0m20:32:58.109571 [info ] [Thread-1  ]: 13 of 32 START test not_null_dim_zone_borough .................................. [RUN]
[0m20:32:58.113146 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_dim_time_year.6fb9595d53, now test.nyc_taxi.not_null_dim_zone_borough.1ed2272c52)
[0m20:32:58.116159 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_dim_zone_borough.1ed2272c52
[0m20:32:58.130969 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_dim_zone_borough.1ed2272c52"
[0m20:32:58.156872 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_dim_zone_borough.1ed2272c52
[0m20:32:58.167641 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_dim_zone_borough.1ed2272c52"
[0m20:32:58.194535 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:32:58.204622 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_dim_zone_borough.1ed2272c52: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_dim_zone_borough.1ed2272c52"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select borough
from `northern-shield-437204-m0`.`nyc_taxi`.`dim_zone`
where borough is null



      
    ) dbt_internal_test
[0m20:32:59.630733 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:e060e334-52d0-4c14-b7b4-265abbc8f87f&page=queryresults
[0m20:33:01.034422 [info ] [Thread-1  ]: 13 of 32 PASS not_null_dim_zone_borough ........................................ [[32mPASS[0m in 2.92s]
[0m20:33:01.040469 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_dim_zone_borough.1ed2272c52
[0m20:33:01.044524 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_dim_zone_service_zone.2007f611c5
[0m20:33:01.048088 [info ] [Thread-1  ]: 14 of 32 START test not_null_dim_zone_service_zone ............................. [RUN]
[0m20:33:01.052143 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_dim_zone_borough.1ed2272c52, now test.nyc_taxi.not_null_dim_zone_service_zone.2007f611c5)
[0m20:33:01.055765 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_dim_zone_service_zone.2007f611c5
[0m20:33:01.074598 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_dim_zone_service_zone.2007f611c5"
[0m20:33:01.099229 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_dim_zone_service_zone.2007f611c5
[0m20:33:01.110396 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_dim_zone_service_zone.2007f611c5"
[0m20:33:01.137039 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:33:01.148115 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_dim_zone_service_zone.2007f611c5: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_dim_zone_service_zone.2007f611c5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select service_zone
from `northern-shield-437204-m0`.`nyc_taxi`.`dim_zone`
where service_zone is null



      
    ) dbt_internal_test
[0m20:33:02.336877 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:b4411db7-a70b-43ec-98a3-cc1bcf8cf720&page=queryresults
[0m20:33:03.449041 [info ] [Thread-1  ]: 14 of 32 PASS not_null_dim_zone_service_zone ................................... [[32mPASS[0m in 2.40s]
[0m20:33:03.453936 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_dim_zone_service_zone.2007f611c5
[0m20:33:03.457705 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_dim_zone_zone.a1c4a4c37a
[0m20:33:03.460914 [info ] [Thread-1  ]: 15 of 32 START test not_null_dim_zone_zone ..................................... [RUN]
[0m20:33:03.464083 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_dim_zone_service_zone.2007f611c5, now test.nyc_taxi.not_null_dim_zone_zone.a1c4a4c37a)
[0m20:33:03.467493 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_dim_zone_zone.a1c4a4c37a
[0m20:33:03.490840 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_dim_zone_zone.a1c4a4c37a"
[0m20:33:03.515738 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_dim_zone_zone.a1c4a4c37a
[0m20:33:03.528329 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_dim_zone_zone.a1c4a4c37a"
[0m20:33:03.555458 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:33:03.565803 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_dim_zone_zone.a1c4a4c37a: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_dim_zone_zone.a1c4a4c37a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select zone
from `northern-shield-437204-m0`.`nyc_taxi`.`dim_zone`
where zone is null



      
    ) dbt_internal_test
[0m20:33:04.750947 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:095376d1-232d-4eae-ae42-750e6a9a246f&page=queryresults
[0m20:33:06.053552 [info ] [Thread-1  ]: 15 of 32 PASS not_null_dim_zone_zone ........................................... [[32mPASS[0m in 2.59s]
[0m20:33:06.060347 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_dim_zone_zone.a1c4a4c37a
[0m20:33:06.064422 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_do_location_id.6acdd302a6
[0m20:33:06.068030 [info ] [Thread-1  ]: 16 of 32 START test not_null_fct_trips_do_location_id .......................... [RUN]
[0m20:33:06.072024 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_dim_zone_zone.a1c4a4c37a, now test.nyc_taxi.not_null_fct_trips_do_location_id.6acdd302a6)
[0m20:33:06.075209 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_do_location_id.6acdd302a6
[0m20:33:06.096220 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_do_location_id.6acdd302a6"
[0m20:33:06.123573 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_do_location_id.6acdd302a6
[0m20:33:06.135284 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_fct_trips_do_location_id.6acdd302a6"
[0m20:33:06.161289 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:33:06.171849 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_fct_trips_do_location_id.6acdd302a6: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_fct_trips_do_location_id.6acdd302a6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select do_location_id
from `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips`
where do_location_id is null



      
    ) dbt_internal_test
[0m20:33:07.556028 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:4823e5bd-0fa3-455c-9203-689c52eee538&page=queryresults
[0m20:33:09.045554 [info ] [Thread-1  ]: 16 of 32 PASS not_null_fct_trips_do_location_id ................................ [[32mPASS[0m in 2.97s]
[0m20:33:09.055331 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_do_location_id.6acdd302a6
[0m20:33:09.058881 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_dropoff_time_id.781496e98f
[0m20:33:09.062075 [info ] [Thread-1  ]: 17 of 32 START test not_null_fct_trips_dropoff_time_id ......................... [RUN]
[0m20:33:09.067075 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_do_location_id.6acdd302a6, now test.nyc_taxi.not_null_fct_trips_dropoff_time_id.781496e98f)
[0m20:33:09.071041 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_dropoff_time_id.781496e98f
[0m20:33:09.095283 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_dropoff_time_id.781496e98f"
[0m20:33:09.121255 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_dropoff_time_id.781496e98f
[0m20:33:09.133208 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_fct_trips_dropoff_time_id.781496e98f"
[0m20:33:09.158989 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:33:09.168014 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_fct_trips_dropoff_time_id.781496e98f: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_fct_trips_dropoff_time_id.781496e98f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select dropoff_time_id
from `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips`
where dropoff_time_id is null



      
    ) dbt_internal_test
[0m20:33:10.666934 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:7350f64e-5598-431b-91b9-8bd6df89c100&page=queryresults
[0m20:33:12.173819 [info ] [Thread-1  ]: 17 of 32 PASS not_null_fct_trips_dropoff_time_id ............................... [[32mPASS[0m in 3.11s]
[0m20:33:12.179090 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_dropoff_time_id.781496e98f
[0m20:33:12.191055 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_extra.1801055bb3
[0m20:33:12.194291 [info ] [Thread-1  ]: 18 of 32 START test not_null_fct_trips_extra ................................... [RUN]
[0m20:33:12.198406 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_dropoff_time_id.781496e98f, now test.nyc_taxi.not_null_fct_trips_extra.1801055bb3)
[0m20:33:12.202393 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_extra.1801055bb3
[0m20:33:12.222925 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_extra.1801055bb3"
[0m20:33:12.245422 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_extra.1801055bb3
[0m20:33:12.256332 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_fct_trips_extra.1801055bb3"
[0m20:33:12.277400 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:33:12.286097 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_fct_trips_extra.1801055bb3: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_fct_trips_extra.1801055bb3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select extra
from `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips`
where extra is null



      
    ) dbt_internal_test
[0m20:33:13.676914 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:57125db7-754b-4755-b187-cd3649592506&page=queryresults
[0m20:33:15.321554 [info ] [Thread-1  ]: 18 of 32 PASS not_null_fct_trips_extra ......................................... [[32mPASS[0m in 3.12s]
[0m20:33:15.327021 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_extra.1801055bb3
[0m20:33:15.330859 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_improvement_surcharge.4cf28d1443
[0m20:33:15.334462 [info ] [Thread-1  ]: 19 of 32 START test not_null_fct_trips_improvement_surcharge ................... [RUN]
[0m20:33:15.339518 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_extra.1801055bb3, now test.nyc_taxi.not_null_fct_trips_improvement_surcharge.4cf28d1443)
[0m20:33:15.342834 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_improvement_surcharge.4cf28d1443
[0m20:33:15.362304 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_improvement_surcharge.4cf28d1443"
[0m20:33:15.386091 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_improvement_surcharge.4cf28d1443
[0m20:33:15.399065 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_fct_trips_improvement_surcharge.4cf28d1443"
[0m20:33:15.420538 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:33:15.431482 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_fct_trips_improvement_surcharge.4cf28d1443: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_fct_trips_improvement_surcharge.4cf28d1443"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select improvement_surcharge
from `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips`
where improvement_surcharge is null



      
    ) dbt_internal_test
[0m20:33:16.843722 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:951ba6e0-21dd-4be8-b404-4ab73da4da48&page=queryresults
[0m20:33:18.494972 [info ] [Thread-1  ]: 19 of 32 PASS not_null_fct_trips_improvement_surcharge ......................... [[32mPASS[0m in 3.16s]
[0m20:33:18.500073 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_improvement_surcharge.4cf28d1443
[0m20:33:18.504762 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_passenger_count.b1370cab1c
[0m20:33:18.508481 [info ] [Thread-1  ]: 20 of 32 START test not_null_fct_trips_passenger_count ......................... [RUN]
[0m20:33:18.512565 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_improvement_surcharge.4cf28d1443, now test.nyc_taxi.not_null_fct_trips_passenger_count.b1370cab1c)
[0m20:33:18.517181 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_passenger_count.b1370cab1c
[0m20:33:18.540165 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_passenger_count.b1370cab1c"
[0m20:33:18.563890 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_passenger_count.b1370cab1c
[0m20:33:18.575230 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_fct_trips_passenger_count.b1370cab1c"
[0m20:33:18.599751 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:33:18.609980 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_fct_trips_passenger_count.b1370cab1c: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_fct_trips_passenger_count.b1370cab1c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select passenger_count
from `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips`
where passenger_count is null



      
    ) dbt_internal_test
[0m20:33:20.154805 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:eabb4553-4431-487a-9977-28f1887c0741&page=queryresults
[0m20:33:21.855868 [info ] [Thread-1  ]: 20 of 32 PASS not_null_fct_trips_passenger_count ............................... [[32mPASS[0m in 3.34s]
[0m20:33:21.860683 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_passenger_count.b1370cab1c
[0m20:33:21.864552 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_payment_type.93889b679a
[0m20:33:21.868167 [info ] [Thread-1  ]: 21 of 32 START test not_null_fct_trips_payment_type ............................ [RUN]
[0m20:33:21.871379 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_passenger_count.b1370cab1c, now test.nyc_taxi.not_null_fct_trips_payment_type.93889b679a)
[0m20:33:21.874538 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_payment_type.93889b679a
[0m20:33:21.893023 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_payment_type.93889b679a"
[0m20:33:21.918272 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_payment_type.93889b679a
[0m20:33:21.929198 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_fct_trips_payment_type.93889b679a"
[0m20:33:21.954513 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:33:21.964688 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_fct_trips_payment_type.93889b679a: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_fct_trips_payment_type.93889b679a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select payment_type
from `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips`
where payment_type is null



      
    ) dbt_internal_test
[0m20:33:23.814065 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:1fd12a7e-61a0-4ed5-8fc9-315749201ed9&page=queryresults
[0m20:33:26.224268 [info ] [Thread-1  ]: 21 of 32 PASS not_null_fct_trips_payment_type .................................. [[32mPASS[0m in 4.35s]
[0m20:33:26.228750 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_payment_type.93889b679a
[0m20:33:26.232844 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_pickup_time_id.f31fbe0eeb
[0m20:33:26.236113 [info ] [Thread-1  ]: 22 of 32 START test not_null_fct_trips_pickup_time_id .......................... [RUN]
[0m20:33:26.239498 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_payment_type.93889b679a, now test.nyc_taxi.not_null_fct_trips_pickup_time_id.f31fbe0eeb)
[0m20:33:26.242991 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_pickup_time_id.f31fbe0eeb
[0m20:33:26.260969 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_pickup_time_id.f31fbe0eeb"
[0m20:33:26.287979 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_pickup_time_id.f31fbe0eeb
[0m20:33:26.300389 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_fct_trips_pickup_time_id.f31fbe0eeb"
[0m20:33:26.327305 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:33:26.337941 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_fct_trips_pickup_time_id.f31fbe0eeb: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_fct_trips_pickup_time_id.f31fbe0eeb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select pickup_time_id
from `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips`
where pickup_time_id is null



      
    ) dbt_internal_test
[0m20:33:28.276185 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:5f6316cc-2db5-4143-8d86-7aaf583745c1&page=queryresults
[0m20:33:29.937526 [info ] [Thread-1  ]: 22 of 32 PASS not_null_fct_trips_pickup_time_id ................................ [[32mPASS[0m in 3.70s]
[0m20:33:29.942287 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_pickup_time_id.f31fbe0eeb
[0m20:33:29.946047 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_pu_location_id.b0dc8dd185
[0m20:33:29.950259 [info ] [Thread-1  ]: 23 of 32 START test not_null_fct_trips_pu_location_id .......................... [RUN]
[0m20:33:29.954640 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_pickup_time_id.f31fbe0eeb, now test.nyc_taxi.not_null_fct_trips_pu_location_id.b0dc8dd185)
[0m20:33:29.957861 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_pu_location_id.b0dc8dd185
[0m20:33:29.976027 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_pu_location_id.b0dc8dd185"
[0m20:33:29.996805 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_pu_location_id.b0dc8dd185
[0m20:33:30.008640 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_fct_trips_pu_location_id.b0dc8dd185"
[0m20:33:30.032505 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:33:30.042652 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_fct_trips_pu_location_id.b0dc8dd185: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_fct_trips_pu_location_id.b0dc8dd185"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select pu_location_id
from `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips`
where pu_location_id is null



      
    ) dbt_internal_test
[0m20:33:31.942532 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:faa5491a-4bb5-4c8c-b8af-ed68cc1e059f&page=queryresults
[0m20:33:33.563972 [info ] [Thread-1  ]: 23 of 32 PASS not_null_fct_trips_pu_location_id ................................ [[32mPASS[0m in 3.61s]
[0m20:33:33.570439 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_pu_location_id.b0dc8dd185
[0m20:33:33.575690 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_rate_code_id.ba0047eaae
[0m20:33:33.579108 [info ] [Thread-1  ]: 24 of 32 START test not_null_fct_trips_rate_code_id ............................ [RUN]
[0m20:33:33.583354 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_pu_location_id.b0dc8dd185, now test.nyc_taxi.not_null_fct_trips_rate_code_id.ba0047eaae)
[0m20:33:33.587239 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_rate_code_id.ba0047eaae
[0m20:33:33.611529 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_rate_code_id.ba0047eaae"
[0m20:33:33.656427 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_rate_code_id.ba0047eaae
[0m20:33:33.669596 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_fct_trips_rate_code_id.ba0047eaae"
[0m20:33:33.687673 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:33:33.695976 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_fct_trips_rate_code_id.ba0047eaae: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_fct_trips_rate_code_id.ba0047eaae"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select rate_code_id
from `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips`
where rate_code_id is null



      
    ) dbt_internal_test
[0m20:33:35.155805 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:e0ff999b-d513-4365-abbb-e832fed1fe65&page=queryresults
[0m20:33:36.658348 [info ] [Thread-1  ]: 24 of 32 PASS not_null_fct_trips_rate_code_id .................................. [[32mPASS[0m in 3.07s]
[0m20:33:36.663205 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_rate_code_id.ba0047eaae
[0m20:33:36.667017 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_trip_distance.19cd17f1df
[0m20:33:36.670618 [info ] [Thread-1  ]: 25 of 32 START test not_null_fct_trips_trip_distance ........................... [RUN]
[0m20:33:36.674261 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_rate_code_id.ba0047eaae, now test.nyc_taxi.not_null_fct_trips_trip_distance.19cd17f1df)
[0m20:33:36.677749 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_trip_distance.19cd17f1df
[0m20:33:36.703787 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_trip_distance.19cd17f1df"
[0m20:33:36.717164 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_trip_distance.19cd17f1df
[0m20:33:36.728880 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_fct_trips_trip_distance.19cd17f1df"
[0m20:33:36.753009 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:33:36.764853 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_fct_trips_trip_distance.19cd17f1df: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_fct_trips_trip_distance.19cd17f1df"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select trip_distance
from `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips`
where trip_distance is null



      
    ) dbt_internal_test
[0m20:33:38.163677 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:c0d93736-95c6-4629-a674-f132fc7914c3&page=queryresults
[0m20:33:39.898275 [info ] [Thread-1  ]: 25 of 32 PASS not_null_fct_trips_trip_distance ................................. [[32mPASS[0m in 3.22s]
[0m20:33:39.905079 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_trip_distance.19cd17f1df
[0m20:33:39.908666 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_vendor_id.b9b2f380bb
[0m20:33:39.911946 [info ] [Thread-1  ]: 26 of 32 START test not_null_fct_trips_vendor_id ............................... [RUN]
[0m20:33:39.916078 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_trip_distance.19cd17f1df, now test.nyc_taxi.not_null_fct_trips_vendor_id.b9b2f380bb)
[0m20:33:39.919000 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_vendor_id.b9b2f380bb
[0m20:33:39.938042 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_vendor_id.b9b2f380bb"
[0m20:33:39.961835 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_vendor_id.b9b2f380bb
[0m20:33:39.974294 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_fct_trips_vendor_id.b9b2f380bb"
[0m20:33:39.996237 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:33:40.005809 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_fct_trips_vendor_id.b9b2f380bb: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_fct_trips_vendor_id.b9b2f380bb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select vendor_id
from `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips`
where vendor_id is null



      
    ) dbt_internal_test
[0m20:33:41.776680 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:8060854c-3ab0-4b82-8636-260de80c58d1&page=queryresults
[0m20:33:43.583912 [info ] [Thread-1  ]: 26 of 32 PASS not_null_fct_trips_vendor_id ..................................... [[32mPASS[0m in 3.67s]
[0m20:33:43.588531 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_vendor_id.b9b2f380bb
[0m20:33:43.591793 [debug] [Thread-1  ]: Began running node test.nyc_taxi.unique_dim_payment_type_id.dea55de04e
[0m20:33:43.595599 [info ] [Thread-1  ]: 27 of 32 START test unique_dim_payment_type_id ................................. [RUN]
[0m20:33:43.601110 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_vendor_id.b9b2f380bb, now test.nyc_taxi.unique_dim_payment_type_id.dea55de04e)
[0m20:33:43.604272 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.unique_dim_payment_type_id.dea55de04e
[0m20:33:43.628968 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.unique_dim_payment_type_id.dea55de04e"
[0m20:33:43.673318 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.unique_dim_payment_type_id.dea55de04e
[0m20:33:43.685591 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.unique_dim_payment_type_id.dea55de04e"
[0m20:33:43.707057 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:33:43.718990 [debug] [Thread-1  ]: On test.nyc_taxi.unique_dim_payment_type_id.dea55de04e: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.unique_dim_payment_type_id.dea55de04e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select type_id as unique_field
  from `northern-shield-437204-m0`.`nyc_taxi`.`dim_payment`
  where type_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m20:33:45.938433 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:82bdd0ca-900c-4c39-a30c-80ed8eff9c2a&page=queryresults
[0m20:33:48.110470 [info ] [Thread-1  ]: 27 of 32 PASS unique_dim_payment_type_id ....................................... [[32mPASS[0m in 4.51s]
[0m20:33:48.115607 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.unique_dim_payment_type_id.dea55de04e
[0m20:33:48.119572 [debug] [Thread-1  ]: Began running node test.nyc_taxi.unique_dim_ratecode_rate_id.75ae8e4885
[0m20:33:48.122363 [info ] [Thread-1  ]: 28 of 32 START test unique_dim_ratecode_rate_id ................................ [RUN]
[0m20:33:48.126709 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.unique_dim_payment_type_id.dea55de04e, now test.nyc_taxi.unique_dim_ratecode_rate_id.75ae8e4885)
[0m20:33:48.130803 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.unique_dim_ratecode_rate_id.75ae8e4885
[0m20:33:48.146349 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.unique_dim_ratecode_rate_id.75ae8e4885"
[0m20:33:48.171060 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.unique_dim_ratecode_rate_id.75ae8e4885
[0m20:33:48.182831 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.unique_dim_ratecode_rate_id.75ae8e4885"
[0m20:33:48.206154 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:33:48.215793 [debug] [Thread-1  ]: On test.nyc_taxi.unique_dim_ratecode_rate_id.75ae8e4885: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.unique_dim_ratecode_rate_id.75ae8e4885"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select rate_id as unique_field
  from `northern-shield-437204-m0`.`nyc_taxi`.`dim_ratecode`
  where rate_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m20:33:50.410424 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:6b0adc77-8212-48ec-a850-a7b756f9b70f&page=queryresults
[0m20:33:52.297539 [info ] [Thread-1  ]: 28 of 32 PASS unique_dim_ratecode_rate_id ...................................... [[32mPASS[0m in 4.17s]
[0m20:33:52.302264 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.unique_dim_ratecode_rate_id.75ae8e4885
[0m20:33:52.305495 [debug] [Thread-1  ]: Began running node test.nyc_taxi.unique_dim_time_time_id.0752c025e8
[0m20:33:52.308538 [info ] [Thread-1  ]: 29 of 32 START test unique_dim_time_time_id .................................... [RUN]
[0m20:33:52.312674 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.unique_dim_ratecode_rate_id.75ae8e4885, now test.nyc_taxi.unique_dim_time_time_id.0752c025e8)
[0m20:33:52.316344 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.unique_dim_time_time_id.0752c025e8
[0m20:33:52.334555 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.unique_dim_time_time_id.0752c025e8"
[0m20:33:52.373357 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.unique_dim_time_time_id.0752c025e8
[0m20:33:52.393436 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.unique_dim_time_time_id.0752c025e8"
[0m20:33:52.436200 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:33:52.449273 [debug] [Thread-1  ]: On test.nyc_taxi.unique_dim_time_time_id.0752c025e8: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.unique_dim_time_time_id.0752c025e8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select time_id as unique_field
  from `northern-shield-437204-m0`.`nyc_taxi`.`dim_time`
  where time_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m20:33:54.530299 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:4c45f2d9-6250-4426-92c5-0652002f2b61&page=queryresults
[0m20:33:56.279264 [info ] [Thread-1  ]: 29 of 32 PASS unique_dim_time_time_id .......................................... [[32mPASS[0m in 3.97s]
[0m20:33:56.285656 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.unique_dim_time_time_id.0752c025e8
[0m20:33:56.290453 [debug] [Thread-1  ]: Began running node test.nyc_taxi.unique_dim_vendor_id.03fad38d04
[0m20:33:56.295011 [info ] [Thread-1  ]: 30 of 32 START test unique_dim_vendor_id ....................................... [RUN]
[0m20:33:56.300394 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.unique_dim_time_time_id.0752c025e8, now test.nyc_taxi.unique_dim_vendor_id.03fad38d04)
[0m20:33:56.304323 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.unique_dim_vendor_id.03fad38d04
[0m20:33:56.329221 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.unique_dim_vendor_id.03fad38d04"
[0m20:33:56.349711 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.unique_dim_vendor_id.03fad38d04
[0m20:33:56.372268 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.unique_dim_vendor_id.03fad38d04"
[0m20:33:56.391698 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:33:56.403551 [debug] [Thread-1  ]: On test.nyc_taxi.unique_dim_vendor_id.03fad38d04: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.unique_dim_vendor_id.03fad38d04"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select id as unique_field
  from `northern-shield-437204-m0`.`nyc_taxi`.`dim_vendor`
  where id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m20:33:58.072125 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:ef3f9095-5612-40c9-9f24-efc90e716564&page=queryresults
[0m20:33:59.744145 [info ] [Thread-1  ]: 30 of 32 PASS unique_dim_vendor_id ............................................. [[32mPASS[0m in 3.44s]
[0m20:33:59.749464 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.unique_dim_vendor_id.03fad38d04
[0m20:33:59.753583 [debug] [Thread-1  ]: Began running node test.nyc_taxi.unique_dim_zone_location_id.7702f92424
[0m20:33:59.756523 [info ] [Thread-1  ]: 31 of 32 START test unique_dim_zone_location_id ................................ [RUN]
[0m20:33:59.759887 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.unique_dim_vendor_id.03fad38d04, now test.nyc_taxi.unique_dim_zone_location_id.7702f92424)
[0m20:33:59.762821 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.unique_dim_zone_location_id.7702f92424
[0m20:33:59.779053 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.unique_dim_zone_location_id.7702f92424"
[0m20:33:59.804040 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.unique_dim_zone_location_id.7702f92424
[0m20:33:59.818544 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.unique_dim_zone_location_id.7702f92424"
[0m20:33:59.840412 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:33:59.849732 [debug] [Thread-1  ]: On test.nyc_taxi.unique_dim_zone_location_id.7702f92424: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.unique_dim_zone_location_id.7702f92424"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select location_id as unique_field
  from `northern-shield-437204-m0`.`nyc_taxi`.`dim_zone`
  where location_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m20:34:01.248950 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:145c7fd7-4915-47a0-88ed-3c88676c974a&page=queryresults
[0m20:34:02.752863 [info ] [Thread-1  ]: 31 of 32 PASS unique_dim_zone_location_id ...................................... [[32mPASS[0m in 2.99s]
[0m20:34:02.757962 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.unique_dim_zone_location_id.7702f92424
[0m20:34:02.762024 [debug] [Thread-1  ]: Began running node test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab
[0m20:34:02.765197 [info ] [Thread-1  ]: 32 of 32 START test unique_fct_trips_trip_id ................................... [RUN]
[0m20:34:02.769018 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.unique_dim_zone_location_id.7702f92424, now test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab)
[0m20:34:02.771885 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab
[0m20:34:02.789875 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab"
[0m20:34:02.813480 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab
[0m20:34:02.824193 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab"
[0m20:34:02.849712 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:34:02.859703 [debug] [Thread-1  ]: On test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select trip_id as unique_field
  from `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips`
  where trip_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m20:34:04.312506 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:fbe5d6e2-3b5a-4c37-be18-130c6a3a31df&page=queryresults
[0m20:34:05.763907 [error] [Thread-1  ]: 32 of 32 FAIL 3555 unique_fct_trips_trip_id .................................... [[31mFAIL 3555[0m in 2.99s]
[0m20:34:05.770649 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab
[0m20:34:05.797198 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:34:05.802065 [debug] [MainThread]: Connection 'test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab' was properly closed.
[0m20:34:05.805474 [info ] [MainThread]: 
[0m20:34:05.809561 [info ] [MainThread]: Finished running 32 data tests in 0 hours 1 minutes and 52.63 seconds (112.63s).
[0m20:34:05.846491 [debug] [MainThread]: Command end result
[0m20:34:06.076357 [info ] [MainThread]: 
[0m20:34:06.079733 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m20:34:06.082344 [info ] [MainThread]: 
[0m20:34:06.086244 [error] [MainThread]: [31mFailure in test unique_fct_trips_trip_id (models/tests/schema.yml)[0m
[0m20:34:06.091119 [error] [MainThread]:   Got 3555 results, configured to fail if != 0
[0m20:34:06.094504 [info ] [MainThread]: 
[0m20:34:06.098135 [info ] [MainThread]:   compiled code at target/compiled/nyc_taxi/models/tests/schema.yml/unique_fct_trips_trip_id.sql
[0m20:34:06.102048 [info ] [MainThread]: 
[0m20:34:06.105435 [info ] [MainThread]: Done. PASS=31 WARN=0 ERROR=1 SKIP=0 TOTAL=32
[0m20:34:06.109824 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 120.440704, "process_in_blocks": "0", "process_kernel_time": 0.964862, "process_mem_max_rss": "231780", "process_out_blocks": "0", "process_user_time": 16.272009}
[0m20:34:06.113824 [debug] [MainThread]: Command `dbt test` failed at 20:34:06.113350 after 120.44 seconds
[0m20:34:06.116917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9b26d0f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9b0c07bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9b11c7730>]}
[0m20:34:06.120124 [debug] [MainThread]: Flushing usage events
[0m20:46:11.349664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03a7865430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03a569da60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03a569da00>]}


============================== 20:46:11.366157 | 5d8a9623-ae62-49a0-a205-d633f077794b ==============================
[0m20:46:11.366157 [info ] [MainThread]: Running with dbt=1.8.9
[0m20:46:11.370308 [debug] [MainThread]: running dbt with arguments {'warn_error': 'None', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/include/dbt/', 'empty': 'False', 'use_colors': 'True', 'log_path': '/opt/airflow/include/dbt/logs', 'version_check': 'True', 'quiet': 'False', 'target_path': 'None', 'partial_parse': 'True', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'indirect_selection': 'eager', 'cache_selected_only': 'False', 'log_cache_events': 'False', 'profiles_dir': '/opt/airflow/include/dbt/', 'log_format': 'default', 'write_json': 'True', 'use_experimental_parser': 'False', 'introspect': 'True', 'send_anonymous_usage_stats': 'True', 'printer_width': '80', 'debug': 'False', 'static_parser': 'True', 'fail_fast': 'False'}
[0m20:46:14.078978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5d8a9623-ae62-49a0-a205-d633f077794b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f036e2bd760>]}
[0m20:46:14.251570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5d8a9623-ae62-49a0-a205-d633f077794b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f036e2efc70>]}
[0m20:46:14.255968 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m20:46:14.732296 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m20:46:17.776156 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:46:17.780174 [debug] [MainThread]: Partial parsing: updated file: nyc_taxi://models/transform/fct_trips.sql
[0m20:46:18.637954 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m20:46:18.641549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '5d8a9623-ae62-49a0-a205-d633f077794b', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f036e197b20>]}
[0m20:46:19.232234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5d8a9623-ae62-49a0-a205-d633f077794b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03a0761fd0>]}
[0m20:46:19.725734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5d8a9623-ae62-49a0-a205-d633f077794b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03a0b62760>]}
[0m20:46:19.729086 [info ] [MainThread]: Found 6 models, 32 data tests, 2 sources, 600 macros
[0m20:46:19.732874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5d8a9623-ae62-49a0-a205-d633f077794b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03a0752070>]}
[0m20:46:19.742290 [info ] [MainThread]: 
[0m20:46:19.748008 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m20:46:19.766434 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_northern-shield-437204-m0'
[0m20:46:19.769403 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:46:20.568647 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_northern-shield-437204-m0, now list_northern-shield-437204-m0_nyc_taxi)
[0m20:46:20.572117 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:46:21.276452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5d8a9623-ae62-49a0-a205-d633f077794b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f036e1bffd0>]}
[0m20:46:21.280612 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:46:21.284002 [info ] [MainThread]: 
[0m20:46:21.314944 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_payment
[0m20:46:21.320212 [info ] [Thread-1  ]: 1 of 6 START sql table model nyc_taxi.dim_payment .............................. [RUN]
[0m20:46:21.325245 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_northern-shield-437204-m0_nyc_taxi, now model.nyc_taxi.dim_payment)
[0m20:46:21.329192 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_payment
[0m20:46:21.365463 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_payment"
[0m20:46:21.389217 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_payment
[0m20:46:21.439090 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:46:22.187221 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.dim_payment"
[0m20:46:22.210986 [debug] [Thread-1  ]: On model.nyc_taxi.dim_payment: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.dim_payment"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`dim_payment`
      
    
    

    OPTIONS()
    as (
      WITH payment_cte AS(
    SELECT DISTINCT
        payment_type AS type_id,
        CASE 
            WHEN payment_type = 1 THEN "Credit card"
            WHEN payment_type = 2 THEN "Cash"
            WHEN payment_type = 3 THEN "No charge"
            WHEN payment_type = 4 THEN "Dispute"
            WHEN payment_type = 5 THEN "Unknown"
            WHEN payment_type = 6 THEN "Voided trip"
        END AS payment_name
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata`
)
SELECT
    type_id,
    payment_name
FROM payment_cte
    );
  
[0m20:46:22.871440 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:bf1590c5-280e-4e9c-a8d6-5d52ab0de328&page=queryresults
[0m20:46:25.450079 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5d8a9623-ae62-49a0-a205-d633f077794b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f036e1bffd0>]}
[0m20:46:25.454368 [info ] [Thread-1  ]: 1 of 6 OK created sql table model nyc_taxi.dim_payment ......................... [[32mCREATE TABLE (4.0 rows, 463.5 KiB processed)[0m in 4.12s]
[0m20:46:25.459627 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_payment
[0m20:46:25.463499 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_ratecode
[0m20:46:25.467417 [info ] [Thread-1  ]: 2 of 6 START sql table model nyc_taxi.dim_ratecode ............................. [RUN]
[0m20:46:25.472154 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_payment, now model.nyc_taxi.dim_ratecode)
[0m20:46:25.475832 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_ratecode
[0m20:46:25.490960 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_ratecode"
[0m20:46:25.515543 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_ratecode
[0m20:46:25.527101 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:46:26.285373 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.dim_ratecode"
[0m20:46:26.304610 [debug] [Thread-1  ]: On model.nyc_taxi.dim_ratecode: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.dim_ratecode"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`dim_ratecode`
      
    
    

    OPTIONS()
    as (
      WITH rate_code_cte AS(
    SELECT DISTINCT
        rate_code_id AS rate_id,
        CASE 
            WHEN rate_code_id = 1 THEN "Standard rate"
            WHEN rate_code_id = 2 THEN "JFK"
            WHEN rate_code_id = 3 THEN "Newark"
            WHEN rate_code_id = 4 THEN "Nassau or Westchester"
            WHEN rate_code_id = 5 THEN "Negotiated fare"
            WHEN rate_code_id = 6 THEN "Group ride"
        ELSE "Unknown"
        END AS rate_code_name
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata`
)
SELECT
    rate_id,
    rate_code_name
FROM rate_code_cte
    );
  
[0m20:46:26.885283 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:ca2b566d-a49c-4667-8d3b-fa2b80dd0443&page=queryresults
[0m20:46:29.409228 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5d8a9623-ae62-49a0-a205-d633f077794b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03a06797f0>]}
[0m20:46:29.414185 [info ] [Thread-1  ]: 2 of 6 OK created sql table model nyc_taxi.dim_ratecode ........................ [[32mCREATE TABLE (6.0 rows, 463.5 KiB processed)[0m in 3.93s]
[0m20:46:29.419733 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_ratecode
[0m20:46:29.423898 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_time
[0m20:46:29.427595 [info ] [Thread-1  ]: 3 of 6 START sql table model nyc_taxi.dim_time ................................. [RUN]
[0m20:46:29.438323 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_ratecode, now model.nyc_taxi.dim_time)
[0m20:46:29.442095 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_time
[0m20:46:29.484254 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_time"
[0m20:46:29.501066 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_time
[0m20:46:29.512447 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:46:30.832663 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.dim_time"
[0m20:46:30.852738 [debug] [Thread-1  ]: On model.nyc_taxi.dim_time: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.dim_time"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`dim_time`
      
    
    

    OPTIONS()
    as (
      WITH datetime_cte AS (
    SELECT DISTINCT
        lpep_pickup_datetime AS datetime_value
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata`
    UNION ALL
    SELECT DISTINCT
        lpep_dropoff_datetime AS datetime_value
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata`
)
SELECT DISTINCT
    ROW_NUMBER() OVER (ORDER BY datetime_value) AS time_id,
    DATE(datetime_value) AS date,
    datetime_value AS date_part,
    EXTRACT(YEAR FROM datetime_value) AS year,
    EXTRACT(MONTH FROM datetime_value) AS month,
    EXTRACT(DAY FROM datetime_value) AS day,
    EXTRACT(HOUR FROM datetime_value) AS hour,
    EXTRACT(MINUTE FROM datetime_value) AS minute,
    FORMAT_TIMESTAMP('%A', datetime_value) AS weekday
FROM datetime_cte
ORDER BY time_id
    );
  
[0m20:46:31.485433 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:3bf55a80-62ce-4172-81bc-5040c2aba38d&page=queryresults
[0m20:46:34.950837 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5d8a9623-ae62-49a0-a205-d633f077794b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03a0679970>]}
[0m20:46:34.955777 [info ] [Thread-1  ]: 3 of 6 OK created sql table model nyc_taxi.dim_time ............................ [[32mCREATE TABLE (116.8k rows, 927.0 KiB processed)[0m in 5.52s]
[0m20:46:34.961690 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_time
[0m20:46:34.966281 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_vendor
[0m20:46:34.971174 [info ] [Thread-1  ]: 4 of 6 START sql table model nyc_taxi.dim_vendor ............................... [RUN]
[0m20:46:34.975641 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_time, now model.nyc_taxi.dim_vendor)
[0m20:46:34.978611 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_vendor
[0m20:46:34.989772 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_vendor"
[0m20:46:35.007088 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_vendor
[0m20:46:35.019566 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:46:35.826028 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.dim_vendor"
[0m20:46:35.845075 [debug] [Thread-1  ]: On model.nyc_taxi.dim_vendor: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.dim_vendor"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`dim_vendor`
      
    
    

    OPTIONS()
    as (
      WITH vendor_cte AS(
    SELECT DISTINCT
        vendor_id AS id,
        CASE 
            WHEN vendor_id = 1 THEN "Creative Mobile Technologies"
            WHEN vendor_id = 2 THEN "VeriFone Inc."
        END AS vendor_name
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata`
)
SELECT
    id,
    vendor_name
FROM vendor_cte
    );
  
[0m20:46:36.422978 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:ef0cc585-5641-4380-94b1-fe8ee851d12c&page=queryresults
[0m20:46:39.434106 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5d8a9623-ae62-49a0-a205-d633f077794b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03a0679b50>]}
[0m20:46:39.438422 [info ] [Thread-1  ]: 4 of 6 OK created sql table model nyc_taxi.dim_vendor .......................... [[32mCREATE TABLE (2.0 rows, 463.5 KiB processed)[0m in 4.46s]
[0m20:46:39.444112 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_vendor
[0m20:46:39.447983 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_zone
[0m20:46:39.451695 [info ] [Thread-1  ]: 5 of 6 START sql table model nyc_taxi.dim_zone ................................. [RUN]
[0m20:46:39.455239 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_vendor, now model.nyc_taxi.dim_zone)
[0m20:46:39.458634 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_zone
[0m20:46:39.472660 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_zone"
[0m20:46:39.497107 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_zone
[0m20:46:39.514807 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:46:40.943001 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.dim_zone"
[0m20:46:40.964306 [debug] [Thread-1  ]: On model.nyc_taxi.dim_zone: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.dim_zone"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`dim_zone`
      
    
    

    OPTIONS()
    as (
      SELECT DISTINCT
    location_id,
    borough,
    zone,
    replace(service_zone, 'Boro', 'Green') as service_zone
FROM `northern-shield-437204-m0`.`nyc_taxi`.`zone_map`
WHERE service_zone is not null
    );
  
[0m20:46:41.637639 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:65da0ada-bc5c-42f9-a80b-9d3f08aa2aba&page=queryresults
[0m20:46:44.050181 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5d8a9623-ae62-49a0-a205-d633f077794b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03a055d130>]}
[0m20:46:44.054553 [info ] [Thread-1  ]: 5 of 6 OK created sql table model nyc_taxi.dim_zone ............................ [[32mCREATE TABLE (263.0 rows, 24.2 KiB processed)[0m in 4.60s]
[0m20:46:44.060486 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_zone
[0m20:46:44.064779 [debug] [Thread-1  ]: Began running node model.nyc_taxi.fct_trips
[0m20:46:44.089849 [info ] [Thread-1  ]: 6 of 6 START sql table model nyc_taxi.fct_trips ................................ [RUN]
[0m20:46:44.096163 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_zone, now model.nyc_taxi.fct_trips)
[0m20:46:44.099638 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.fct_trips
[0m20:46:44.129461 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.fct_trips"
[0m20:46:44.148535 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.fct_trips
[0m20:46:44.165851 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.fct_trips"
[0m20:46:44.185140 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:46:44.195533 [debug] [Thread-1  ]: On model.nyc_taxi.fct_trips: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.fct_trips"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips`
      
    
    

    OPTIONS()
    as (
      WITH numbered_tripdata AS (
    SELECT 
        *,
        ROW_NUMBER() OVER (PARTITION BY vendor_id, lpep_pickup_datetime, lpep_dropoff_datetime) AS row_number
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata`
),
tripdata_cte AS (
    SELECT 
        to_hex(md5(cast(coalesce(cast(vendor_id as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(lpep_pickup_datetime as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(lpep_dropoff_datetime as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(row_number as string), '_dbt_utils_surrogate_key_null_') as string))) AS trip_id,
        t.vendor_id,
        pt.time_id AS pickup_time_id,
        dt.time_id AS dropoff_time_id,
        t.rate_code_id,
        t.pu_location_id,
        t.do_location_id,
        t.passenger_count,
        t.trip_distance,
        t.fare_amount,
        t.extra,
        t.mta_tax,
        t.tip_amount,
        t.tolls_amount,
        t.improvement_surcharge,
        t.total_amount,
        t.payment_type,
        t.trip_type,
        t.congestion_surcharge
    FROM numbered_tripdata AS t
    LEFT JOIN (
        SELECT DISTINCT date_part, time_id 
        FROM `northern-shield-437204-m0`.`nyc_taxi`.`dim_time`
    ) pt ON t.lpep_pickup_datetime = pt.date_part
    LEFT JOIN (
        SELECT DISTINCT date_part, time_id 
        FROM `northern-shield-437204-m0`.`nyc_taxi`.`dim_time`
    ) dt ON t.lpep_dropoff_datetime = dt.date_part
    WHERE t.vendor_id IS NOT NULL
        AND t.passenger_count IS NOT NULL
        AND (t.trip_distance IS NOT NULL OR t.trip_distance >= 0)
        AND t.fare_amount >= 0
        AND t.extra >= 0
        AND t.mta_tax >= 0
        AND t.tip_amount >= 0
        AND t.improvement_surcharge >= 0
        AND t.total_amount >= 0
)
SELECT 
    trip_id,
    vendor_id,
    pickup_time_id,
    dropoff_time_id,
    rate_code_id,
    pu_location_id,
    do_location_id,
    passenger_count,
    trip_distance,
    fare_amount,
    extra,
    mta_tax,
    tip_amount,
    tolls_amount,
    improvement_surcharge,
    total_amount,
    payment_type,
    trip_type,
    congestion_surcharge
FROM tripdata_cte
    );
  
[0m20:46:45.386958 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:d2e82fdc-e161-4962-94ff-5c469301a638&page=queryresults
[0m20:46:49.167022 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5d8a9623-ae62-49a0-a205-d633f077794b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03a0549850>]}
[0m20:46:49.171972 [info ] [Thread-1  ]: 6 of 6 OK created sql table model nyc_taxi.fct_trips ........................... [[32mCREATE TABLE (63.0k rows, 9.9 MiB processed)[0m in 5.07s]
[0m20:46:49.178056 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.fct_trips
[0m20:46:49.185583 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:46:49.188581 [debug] [MainThread]: Connection 'model.nyc_taxi.fct_trips' was properly closed.
[0m20:46:49.191698 [info ] [MainThread]: 
[0m20:46:49.195328 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 29.44 seconds (29.44s).
[0m20:46:49.204805 [debug] [MainThread]: Command end result
[0m20:46:49.413506 [info ] [MainThread]: 
[0m20:46:49.417046 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:46:49.420150 [info ] [MainThread]: 
[0m20:46:49.423160 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m20:46:49.427453 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 38.318306, "process_in_blocks": "0", "process_kernel_time": 0.892595, "process_mem_max_rss": "233392", "process_out_blocks": "0", "process_user_time": 13.135347}
[0m20:46:49.431418 [debug] [MainThread]: Command `dbt run` succeeded at 20:46:49.430865 after 38.32 seconds
[0m20:46:49.434809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03a7865430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f036e2efc70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03a8420460>]}
[0m20:46:49.438780 [debug] [MainThread]: Flushing usage events
[0m20:47:29.154268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4e427df40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4e20539a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4e2053940>]}


============================== 20:47:29.170675 | 54e7b4ab-d887-4bc3-9b21-cbe5e2201118 ==============================
[0m20:47:29.170675 [info ] [MainThread]: Running with dbt=1.8.9
[0m20:47:29.174622 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'indirect_selection': 'eager', 'log_format': 'default', 'empty': 'None', 'log_path': '/opt/airflow/include/dbt/logs', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'use_colors': 'True', 'version_check': 'True', 'debug': 'False', 'log_cache_events': 'False', 'quiet': 'False', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'warn_error': 'None', 'invocation_command': 'dbt test --profiles-dir /opt/airflow/include/dbt/', 'fail_fast': 'False', 'no_print': 'None', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/include/dbt/', 'static_parser': 'True', 'printer_width': '80', 'introspect': 'True', 'write_json': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:47:31.950797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '54e7b4ab-d887-4bc3-9b21-cbe5e2201118', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4aac9f490>]}
[0m20:47:32.111531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '54e7b4ab-d887-4bc3-9b21-cbe5e2201118', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4aac51730>]}
[0m20:47:32.115706 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m20:47:32.608597 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m20:47:35.852614 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:47:35.855592 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:47:36.008653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '54e7b4ab-d887-4bc3-9b21-cbe5e2201118', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4dd3d3f40>]}
[0m20:47:36.671677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '54e7b4ab-d887-4bc3-9b21-cbe5e2201118', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4aabb92b0>]}
[0m20:47:36.674975 [info ] [MainThread]: Found 6 models, 32 data tests, 2 sources, 600 macros
[0m20:47:36.678629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '54e7b4ab-d887-4bc3-9b21-cbe5e2201118', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4dd4cb130>]}
[0m20:47:36.688792 [info ] [MainThread]: 
[0m20:47:36.696124 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m20:47:36.717234 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_northern-shield-437204-m0_nyc_taxi'
[0m20:47:36.720020 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:47:37.743021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '54e7b4ab-d887-4bc3-9b21-cbe5e2201118', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4e3924790>]}
[0m20:47:37.747707 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:47:37.750477 [info ] [MainThread]: 
[0m20:47:37.775617 [debug] [Thread-1  ]: Began running node test.nyc_taxi.accepted_values_dim_payment_payment_name__Credit_card__Cash__No_charge__Dispute__Unknown__Voided_trip.58d00ef9f4
[0m20:47:37.780040 [info ] [Thread-1  ]: 1 of 32 START test accepted_values_dim_payment_payment_name__Credit_card__Cash__No_charge__Dispute__Unknown__Voided_trip  [RUN]
[0m20:47:37.784908 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_northern-shield-437204-m0_nyc_taxi, now test.nyc_taxi.accepted_values_dim_payment_payment_name__Credit_card__Cash__No_charge__Dispute__Unknown__Voided_trip.58d00ef9f4)
[0m20:47:37.788711 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.accepted_values_dim_payment_payment_name__Credit_card__Cash__No_charge__Dispute__Unknown__Voided_trip.58d00ef9f4
[0m20:47:37.858493 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.accepted_values_dim_payment_payment_name__Credit_card__Cash__No_charge__Dispute__Unknown__Voided_trip.58d00ef9f4"
[0m20:47:37.886878 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.accepted_values_dim_payment_payment_name__Credit_card__Cash__No_charge__Dispute__Unknown__Voided_trip.58d00ef9f4
[0m20:47:37.951703 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.accepted_values_dim_payment_payment_name__Credit_card__Cash__No_charge__Dispute__Unknown__Voided_trip.58d00ef9f4"
[0m20:47:37.978009 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:47:37.988658 [debug] [Thread-1  ]: On test.nyc_taxi.accepted_values_dim_payment_payment_name__Credit_card__Cash__No_charge__Dispute__Unknown__Voided_trip.58d00ef9f4: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.accepted_values_dim_payment_payment_name__Credit_card__Cash__No_charge__Dispute__Unknown__Voided_trip.58d00ef9f4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        payment_name as value_field,
        count(*) as n_records

    from `northern-shield-437204-m0`.`nyc_taxi`.`dim_payment`
    group by payment_name

)

select *
from all_values
where value_field not in (
    'Credit card','Cash','No charge','Dispute','Unknown','Voided trip'
)



      
    ) dbt_internal_test
[0m20:47:39.500029 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:9f2affe1-0ef2-4bb7-8dd9-9d2bd3d56a47&page=queryresults
[0m20:47:40.720673 [info ] [Thread-1  ]: 1 of 32 PASS accepted_values_dim_payment_payment_name__Credit_card__Cash__No_charge__Dispute__Unknown__Voided_trip  [[32mPASS[0m in 2.94s]
[0m20:47:40.726748 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.accepted_values_dim_payment_payment_name__Credit_card__Cash__No_charge__Dispute__Unknown__Voided_trip.58d00ef9f4
[0m20:47:40.731413 [debug] [Thread-1  ]: Began running node test.nyc_taxi.accepted_values_dim_ratecode_rate_code_name__Standard_rate__JFK__Newark__Nassau_or_Westchester__Negotiated_fare__Group_ride__Unknown.57ee02019f
[0m20:47:40.736521 [info ] [Thread-1  ]: 2 of 32 START test accepted_values_dim_ratecode_rate_code_name__Standard_rate__JFK__Newark__Nassau_or_Westchester__Negotiated_fare__Group_ride__Unknown  [RUN]
[0m20:47:40.741670 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.accepted_values_dim_payment_payment_name__Credit_card__Cash__No_charge__Dispute__Unknown__Voided_trip.58d00ef9f4, now test.nyc_taxi.accepted_values_dim_ratecode_rate_code_name__Standard_rate__JFK__Newark__Nassau_or_Westchester__Negotiated_fare__Group_ride__Unknown.57ee02019f)
[0m20:47:40.746990 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.accepted_values_dim_ratecode_rate_code_name__Standard_rate__JFK__Newark__Nassau_or_Westchester__Negotiated_fare__Group_ride__Unknown.57ee02019f
[0m20:47:40.780592 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.accepted_values_dim_ratecode_rate_code_name__Standard_rate__JFK__Newark__Nassau_or_Westchester__Negotiated_fare__Group_ride__Unknown.57ee02019f"
[0m20:47:40.808382 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.accepted_values_dim_ratecode_rate_code_name__Standard_rate__JFK__Newark__Nassau_or_Westchester__Negotiated_fare__Group_ride__Unknown.57ee02019f
[0m20:47:40.827933 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.accepted_values_dim_ratecode_rate_code_name__Standard_rate__JFK__Newark__Nassau_or_Westchester__Negotiated_fare__Group_ride__Unknown.57ee02019f"
[0m20:47:40.853169 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:47:40.865363 [debug] [Thread-1  ]: On test.nyc_taxi.accepted_values_dim_ratecode_rate_code_name__Standard_rate__JFK__Newark__Nassau_or_Westchester__Negotiated_fare__Group_ride__Unknown.57ee02019f: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.accepted_values_dim_ratecode_rate_code_name__Standard_rate__JFK__Newark__Nassau_or_Westchester__Negotiated_fare__Group_ride__Unknown.57ee02019f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        rate_code_name as value_field,
        count(*) as n_records

    from `northern-shield-437204-m0`.`nyc_taxi`.`dim_ratecode`
    group by rate_code_name

)

select *
from all_values
where value_field not in (
    'Standard rate','JFK','Newark','Nassau or Westchester','Negotiated fare','Group ride','Unknown'
)



      
    ) dbt_internal_test
[0m20:47:41.951649 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:8113cd99-06e3-4cab-8053-ccd1a13b52ae&page=queryresults
[0m20:47:43.054914 [info ] [Thread-1  ]: 2 of 32 PASS accepted_values_dim_ratecode_rate_code_name__Standard_rate__JFK__Newark__Nassau_or_Westchester__Negotiated_fare__Group_ride__Unknown  [[32mPASS[0m in 2.31s]
[0m20:47:43.060928 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.accepted_values_dim_ratecode_rate_code_name__Standard_rate__JFK__Newark__Nassau_or_Westchester__Negotiated_fare__Group_ride__Unknown.57ee02019f
[0m20:47:43.064731 [debug] [Thread-1  ]: Began running node test.nyc_taxi.accepted_values_dim_time_weekday__Sunday__Monday__Tuesday__Wednesday__Thursday__Friday__Saturday.87b4c2a366
[0m20:47:43.068382 [info ] [Thread-1  ]: 3 of 32 START test accepted_values_dim_time_weekday__Sunday__Monday__Tuesday__Wednesday__Thursday__Friday__Saturday  [RUN]
[0m20:47:43.075952 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.accepted_values_dim_ratecode_rate_code_name__Standard_rate__JFK__Newark__Nassau_or_Westchester__Negotiated_fare__Group_ride__Unknown.57ee02019f, now test.nyc_taxi.accepted_values_dim_time_weekday__Sunday__Monday__Tuesday__Wednesday__Thursday__Friday__Saturday.87b4c2a366)
[0m20:47:43.080194 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.accepted_values_dim_time_weekday__Sunday__Monday__Tuesday__Wednesday__Thursday__Friday__Saturday.87b4c2a366
[0m20:47:43.124078 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.accepted_values_dim_time_weekday__Sunday__Monday__Tuesday__Wednesday__Thursday__Friday__Saturday.87b4c2a366"
[0m20:47:43.147293 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.accepted_values_dim_time_weekday__Sunday__Monday__Tuesday__Wednesday__Thursday__Friday__Saturday.87b4c2a366
[0m20:47:43.159106 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.accepted_values_dim_time_weekday__Sunday__Monday__Tuesday__Wednesday__Thursday__Friday__Saturday.87b4c2a366"
[0m20:47:43.180652 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:47:43.191425 [debug] [Thread-1  ]: On test.nyc_taxi.accepted_values_dim_time_weekday__Sunday__Monday__Tuesday__Wednesday__Thursday__Friday__Saturday.87b4c2a366: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.accepted_values_dim_time_weekday__Sunday__Monday__Tuesday__Wednesday__Thursday__Friday__Saturday.87b4c2a366"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        weekday as value_field,
        count(*) as n_records

    from `northern-shield-437204-m0`.`nyc_taxi`.`dim_time`
    group by weekday

)

select *
from all_values
where value_field not in (
    'Sunday','Monday','Tuesday','Wednesday','Thursday','Friday','Saturday'
)



      
    ) dbt_internal_test
[0m20:47:44.258157 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:03f3f145-5f07-44e5-abb2-42386b990f7b&page=queryresults
[0m20:47:45.465111 [info ] [Thread-1  ]: 3 of 32 PASS accepted_values_dim_time_weekday__Sunday__Monday__Tuesday__Wednesday__Thursday__Friday__Saturday  [[32mPASS[0m in 2.39s]
[0m20:47:45.473324 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.accepted_values_dim_time_weekday__Sunday__Monday__Tuesday__Wednesday__Thursday__Friday__Saturday.87b4c2a366
[0m20:47:45.477402 [debug] [Thread-1  ]: Began running node test.nyc_taxi.accepted_values_dim_vendor_vendor_name__Creative_Mobile_Technologies__VeriFone_Inc_.7481cecf07
[0m20:47:45.481354 [info ] [Thread-1  ]: 4 of 32 START test accepted_values_dim_vendor_vendor_name__Creative_Mobile_Technologies__VeriFone_Inc_  [RUN]
[0m20:47:45.485921 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.accepted_values_dim_time_weekday__Sunday__Monday__Tuesday__Wednesday__Thursday__Friday__Saturday.87b4c2a366, now test.nyc_taxi.accepted_values_dim_vendor_vendor_name__Creative_Mobile_Technologies__VeriFone_Inc_.7481cecf07)
[0m20:47:45.489677 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.accepted_values_dim_vendor_vendor_name__Creative_Mobile_Technologies__VeriFone_Inc_.7481cecf07
[0m20:47:45.517681 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.accepted_values_dim_vendor_vendor_name__Creative_Mobile_Technologies__VeriFone_Inc_.7481cecf07"
[0m20:47:45.537686 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.accepted_values_dim_vendor_vendor_name__Creative_Mobile_Technologies__VeriFone_Inc_.7481cecf07
[0m20:47:45.549795 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.accepted_values_dim_vendor_vendor_name__Creative_Mobile_Technologies__VeriFone_Inc_.7481cecf07"
[0m20:47:45.569876 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:47:45.580137 [debug] [Thread-1  ]: On test.nyc_taxi.accepted_values_dim_vendor_vendor_name__Creative_Mobile_Technologies__VeriFone_Inc_.7481cecf07: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.accepted_values_dim_vendor_vendor_name__Creative_Mobile_Technologies__VeriFone_Inc_.7481cecf07"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        vendor_name as value_field,
        count(*) as n_records

    from `northern-shield-437204-m0`.`nyc_taxi`.`dim_vendor`
    group by vendor_name

)

select *
from all_values
where value_field not in (
    'Creative Mobile Technologies','VeriFone Inc.'
)



      
    ) dbt_internal_test
[0m20:47:46.570311 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:eb93894f-8c45-4407-af7f-8bb604fa0842&page=queryresults
[0m20:47:47.631352 [info ] [Thread-1  ]: 4 of 32 PASS accepted_values_dim_vendor_vendor_name__Creative_Mobile_Technologies__VeriFone_Inc_  [[32mPASS[0m in 2.14s]
[0m20:47:47.637021 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.accepted_values_dim_vendor_vendor_name__Creative_Mobile_Technologies__VeriFone_Inc_.7481cecf07
[0m20:47:47.642983 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_dim_payment_type_id.96dfa722aa
[0m20:47:47.647261 [info ] [Thread-1  ]: 5 of 32 START test not_null_dim_payment_type_id ................................ [RUN]
[0m20:47:47.651465 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.accepted_values_dim_vendor_vendor_name__Creative_Mobile_Technologies__VeriFone_Inc_.7481cecf07, now test.nyc_taxi.not_null_dim_payment_type_id.96dfa722aa)
[0m20:47:47.655567 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_dim_payment_type_id.96dfa722aa
[0m20:47:47.707409 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_dim_payment_type_id.96dfa722aa"
[0m20:47:47.751856 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_dim_payment_type_id.96dfa722aa
[0m20:47:47.762590 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_dim_payment_type_id.96dfa722aa"
[0m20:47:47.780290 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:47:47.788274 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_dim_payment_type_id.96dfa722aa: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_dim_payment_type_id.96dfa722aa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select type_id
from `northern-shield-437204-m0`.`nyc_taxi`.`dim_payment`
where type_id is null



      
    ) dbt_internal_test
[0m20:47:48.680328 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:adea42de-95da-4922-8957-7b7fb0ab6a6f&page=queryresults
[0m20:47:49.726488 [info ] [Thread-1  ]: 5 of 32 PASS not_null_dim_payment_type_id ...................................... [[32mPASS[0m in 2.07s]
[0m20:47:49.732047 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_dim_payment_type_id.96dfa722aa
[0m20:47:49.736179 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_dim_time_date.2080f42875
[0m20:47:49.739622 [info ] [Thread-1  ]: 6 of 32 START test not_null_dim_time_date ...................................... [RUN]
[0m20:47:49.746078 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_dim_payment_type_id.96dfa722aa, now test.nyc_taxi.not_null_dim_time_date.2080f42875)
[0m20:47:49.751371 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_dim_time_date.2080f42875
[0m20:47:49.805715 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_dim_time_date.2080f42875"
[0m20:47:49.823928 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_dim_time_date.2080f42875
[0m20:47:49.837597 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_dim_time_date.2080f42875"
[0m20:47:49.866431 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:47:49.875915 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_dim_time_date.2080f42875: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_dim_time_date.2080f42875"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from `northern-shield-437204-m0`.`nyc_taxi`.`dim_time`
where date is null



      
    ) dbt_internal_test
[0m20:47:50.821791 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:ebfb331f-b75f-4ebc-84f4-db353f45aa55&page=queryresults
[0m20:47:51.942483 [info ] [Thread-1  ]: 6 of 32 PASS not_null_dim_time_date ............................................ [[32mPASS[0m in 2.20s]
[0m20:47:51.946648 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_dim_time_date.2080f42875
[0m20:47:51.950546 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_dim_time_date_part.59e6206332
[0m20:47:51.953662 [info ] [Thread-1  ]: 7 of 32 START test not_null_dim_time_date_part ................................. [RUN]
[0m20:47:51.956978 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_dim_time_date.2080f42875, now test.nyc_taxi.not_null_dim_time_date_part.59e6206332)
[0m20:47:51.960203 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_dim_time_date_part.59e6206332
[0m20:47:51.982426 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_dim_time_date_part.59e6206332"
[0m20:47:52.007070 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_dim_time_date_part.59e6206332
[0m20:47:52.018864 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_dim_time_date_part.59e6206332"
[0m20:47:52.038098 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:47:52.046246 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_dim_time_date_part.59e6206332: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_dim_time_date_part.59e6206332"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date_part
from `northern-shield-437204-m0`.`nyc_taxi`.`dim_time`
where date_part is null



      
    ) dbt_internal_test
[0m20:47:52.979945 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:3e22cd40-d401-4095-a7d6-841a0916e370&page=queryresults
[0m20:47:54.058318 [info ] [Thread-1  ]: 7 of 32 PASS not_null_dim_time_date_part ....................................... [[32mPASS[0m in 2.10s]
[0m20:47:54.064504 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_dim_time_date_part.59e6206332
[0m20:47:54.069054 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_dim_time_day.dc0e917166
[0m20:47:54.072259 [info ] [Thread-1  ]: 8 of 32 START test not_null_dim_time_day ....................................... [RUN]
[0m20:47:54.075771 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_dim_time_date_part.59e6206332, now test.nyc_taxi.not_null_dim_time_day.dc0e917166)
[0m20:47:54.078903 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_dim_time_day.dc0e917166
[0m20:47:54.101948 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_dim_time_day.dc0e917166"
[0m20:47:54.120997 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_dim_time_day.dc0e917166
[0m20:47:54.135361 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_dim_time_day.dc0e917166"
[0m20:47:54.154810 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:47:54.167604 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_dim_time_day.dc0e917166: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_dim_time_day.dc0e917166"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select day
from `northern-shield-437204-m0`.`nyc_taxi`.`dim_time`
where day is null



      
    ) dbt_internal_test
[0m20:47:55.069310 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:dc9b4248-34e3-42c0-814d-5bc8a3606118&page=queryresults
[0m20:47:56.153640 [info ] [Thread-1  ]: 8 of 32 PASS not_null_dim_time_day ............................................. [[32mPASS[0m in 2.08s]
[0m20:47:56.169107 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_dim_time_day.dc0e917166
[0m20:47:56.176121 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_dim_time_hour.5b8ccd8f25
[0m20:47:56.184623 [info ] [Thread-1  ]: 9 of 32 START test not_null_dim_time_hour ...................................... [RUN]
[0m20:47:56.201341 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_dim_time_day.dc0e917166, now test.nyc_taxi.not_null_dim_time_hour.5b8ccd8f25)
[0m20:47:56.209186 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_dim_time_hour.5b8ccd8f25
[0m20:47:56.239831 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_dim_time_hour.5b8ccd8f25"
[0m20:47:56.259073 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_dim_time_hour.5b8ccd8f25
[0m20:47:56.270386 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_dim_time_hour.5b8ccd8f25"
[0m20:47:56.295226 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:47:56.304628 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_dim_time_hour.5b8ccd8f25: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_dim_time_hour.5b8ccd8f25"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select hour
from `northern-shield-437204-m0`.`nyc_taxi`.`dim_time`
where hour is null



      
    ) dbt_internal_test
[0m20:47:57.365595 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:1734be29-6b2f-4a55-9413-49f45993558d&page=queryresults
[0m20:47:58.409632 [info ] [Thread-1  ]: 9 of 32 PASS not_null_dim_time_hour ............................................ [[32mPASS[0m in 2.21s]
[0m20:47:58.414549 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_dim_time_hour.5b8ccd8f25
[0m20:47:58.423379 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_dim_time_minute.23e906ca61
[0m20:47:58.426225 [info ] [Thread-1  ]: 10 of 32 START test not_null_dim_time_minute ................................... [RUN]
[0m20:47:58.429539 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_dim_time_hour.5b8ccd8f25, now test.nyc_taxi.not_null_dim_time_minute.23e906ca61)
[0m20:47:58.433355 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_dim_time_minute.23e906ca61
[0m20:47:58.453199 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_dim_time_minute.23e906ca61"
[0m20:47:58.476232 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_dim_time_minute.23e906ca61
[0m20:47:58.487171 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_dim_time_minute.23e906ca61"
[0m20:47:58.512502 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:47:58.522966 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_dim_time_minute.23e906ca61: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_dim_time_minute.23e906ca61"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select minute
from `northern-shield-437204-m0`.`nyc_taxi`.`dim_time`
where minute is null



      
    ) dbt_internal_test
[0m20:47:59.512988 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:2b09b2e2-3a52-43a1-9190-715a9232559a&page=queryresults
[0m20:48:00.645830 [info ] [Thread-1  ]: 10 of 32 PASS not_null_dim_time_minute ......................................... [[32mPASS[0m in 2.22s]
[0m20:48:00.651517 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_dim_time_minute.23e906ca61
[0m20:48:00.657966 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_dim_time_month.9f6ecf2eb5
[0m20:48:00.662917 [info ] [Thread-1  ]: 11 of 32 START test not_null_dim_time_month .................................... [RUN]
[0m20:48:00.667033 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_dim_time_minute.23e906ca61, now test.nyc_taxi.not_null_dim_time_month.9f6ecf2eb5)
[0m20:48:00.669875 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_dim_time_month.9f6ecf2eb5
[0m20:48:00.686665 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_dim_time_month.9f6ecf2eb5"
[0m20:48:00.711791 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_dim_time_month.9f6ecf2eb5
[0m20:48:00.722175 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_dim_time_month.9f6ecf2eb5"
[0m20:48:00.741902 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:48:00.751578 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_dim_time_month.9f6ecf2eb5: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_dim_time_month.9f6ecf2eb5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select month
from `northern-shield-437204-m0`.`nyc_taxi`.`dim_time`
where month is null



      
    ) dbt_internal_test
[0m20:48:01.722205 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:0949f49b-8d26-4a36-8eff-6289ba4e96b3&page=queryresults
[0m20:48:02.826505 [info ] [Thread-1  ]: 11 of 32 PASS not_null_dim_time_month .......................................... [[32mPASS[0m in 2.16s]
[0m20:48:02.832367 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_dim_time_month.9f6ecf2eb5
[0m20:48:02.837210 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_dim_time_year.6fb9595d53
[0m20:48:02.841040 [info ] [Thread-1  ]: 12 of 32 START test not_null_dim_time_year ..................................... [RUN]
[0m20:48:02.845874 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_dim_time_month.9f6ecf2eb5, now test.nyc_taxi.not_null_dim_time_year.6fb9595d53)
[0m20:48:02.849778 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_dim_time_year.6fb9595d53
[0m20:48:02.872904 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_dim_time_year.6fb9595d53"
[0m20:48:02.897043 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_dim_time_year.6fb9595d53
[0m20:48:02.907711 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_dim_time_year.6fb9595d53"
[0m20:48:02.932336 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:48:02.942384 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_dim_time_year.6fb9595d53: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_dim_time_year.6fb9595d53"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select year
from `northern-shield-437204-m0`.`nyc_taxi`.`dim_time`
where year is null



      
    ) dbt_internal_test
[0m20:48:04.030489 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:832d6062-1879-44da-8e5e-1df4319d8ef4&page=queryresults
[0m20:48:05.187019 [info ] [Thread-1  ]: 12 of 32 PASS not_null_dim_time_year ........................................... [[32mPASS[0m in 2.34s]
[0m20:48:05.192460 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_dim_time_year.6fb9595d53
[0m20:48:05.196182 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_dim_zone_borough.1ed2272c52
[0m20:48:05.199301 [info ] [Thread-1  ]: 13 of 32 START test not_null_dim_zone_borough .................................. [RUN]
[0m20:48:05.202480 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_dim_time_year.6fb9595d53, now test.nyc_taxi.not_null_dim_zone_borough.1ed2272c52)
[0m20:48:05.205431 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_dim_zone_borough.1ed2272c52
[0m20:48:05.222873 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_dim_zone_borough.1ed2272c52"
[0m20:48:05.240806 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_dim_zone_borough.1ed2272c52
[0m20:48:05.252133 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_dim_zone_borough.1ed2272c52"
[0m20:48:05.270094 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:48:05.280104 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_dim_zone_borough.1ed2272c52: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_dim_zone_borough.1ed2272c52"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select borough
from `northern-shield-437204-m0`.`nyc_taxi`.`dim_zone`
where borough is null



      
    ) dbt_internal_test
[0m20:48:06.236385 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:78b25c44-86fd-44af-b333-e2da1afeeea8&page=queryresults
[0m20:48:07.389162 [info ] [Thread-1  ]: 13 of 32 PASS not_null_dim_zone_borough ........................................ [[32mPASS[0m in 2.19s]
[0m20:48:07.393983 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_dim_zone_borough.1ed2272c52
[0m20:48:07.397322 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_dim_zone_service_zone.2007f611c5
[0m20:48:07.401232 [info ] [Thread-1  ]: 14 of 32 START test not_null_dim_zone_service_zone ............................. [RUN]
[0m20:48:07.405064 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_dim_zone_borough.1ed2272c52, now test.nyc_taxi.not_null_dim_zone_service_zone.2007f611c5)
[0m20:48:07.408261 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_dim_zone_service_zone.2007f611c5
[0m20:48:07.423180 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_dim_zone_service_zone.2007f611c5"
[0m20:48:07.451109 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_dim_zone_service_zone.2007f611c5
[0m20:48:07.461753 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_dim_zone_service_zone.2007f611c5"
[0m20:48:07.482462 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:48:07.492723 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_dim_zone_service_zone.2007f611c5: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_dim_zone_service_zone.2007f611c5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select service_zone
from `northern-shield-437204-m0`.`nyc_taxi`.`dim_zone`
where service_zone is null



      
    ) dbt_internal_test
[0m20:48:08.444289 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:6a0a4e85-8fe2-4d29-a941-ebaa48d7cb13&page=queryresults
[0m20:48:09.649660 [info ] [Thread-1  ]: 14 of 32 PASS not_null_dim_zone_service_zone ................................... [[32mPASS[0m in 2.24s]
[0m20:48:09.655206 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_dim_zone_service_zone.2007f611c5
[0m20:48:09.658685 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_dim_zone_zone.a1c4a4c37a
[0m20:48:09.661988 [info ] [Thread-1  ]: 15 of 32 START test not_null_dim_zone_zone ..................................... [RUN]
[0m20:48:09.665154 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_dim_zone_service_zone.2007f611c5, now test.nyc_taxi.not_null_dim_zone_zone.a1c4a4c37a)
[0m20:48:09.668707 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_dim_zone_zone.a1c4a4c37a
[0m20:48:09.686475 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_dim_zone_zone.a1c4a4c37a"
[0m20:48:09.712730 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_dim_zone_zone.a1c4a4c37a
[0m20:48:09.723027 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_dim_zone_zone.a1c4a4c37a"
[0m20:48:09.748497 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:48:09.758773 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_dim_zone_zone.a1c4a4c37a: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_dim_zone_zone.a1c4a4c37a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select zone
from `northern-shield-437204-m0`.`nyc_taxi`.`dim_zone`
where zone is null



      
    ) dbt_internal_test
[0m20:48:10.755481 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:a9ad802d-891b-4649-bf46-8d9055a8864d&page=queryresults
[0m20:48:11.827356 [info ] [Thread-1  ]: 15 of 32 PASS not_null_dim_zone_zone ........................................... [[32mPASS[0m in 2.16s]
[0m20:48:11.833645 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_dim_zone_zone.a1c4a4c37a
[0m20:48:11.837604 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_do_location_id.6acdd302a6
[0m20:48:11.840831 [info ] [Thread-1  ]: 16 of 32 START test not_null_fct_trips_do_location_id .......................... [RUN]
[0m20:48:11.845443 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_dim_zone_zone.a1c4a4c37a, now test.nyc_taxi.not_null_fct_trips_do_location_id.6acdd302a6)
[0m20:48:11.849613 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_do_location_id.6acdd302a6
[0m20:48:11.867250 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_do_location_id.6acdd302a6"
[0m20:48:11.895034 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_do_location_id.6acdd302a6
[0m20:48:11.909159 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_fct_trips_do_location_id.6acdd302a6"
[0m20:48:11.929571 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:48:11.940375 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_fct_trips_do_location_id.6acdd302a6: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_fct_trips_do_location_id.6acdd302a6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select do_location_id
from `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips`
where do_location_id is null



      
    ) dbt_internal_test
[0m20:48:12.910191 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:91f98e61-597e-4bbc-adbe-11fa2788ef00&page=queryresults
[0m20:48:14.108774 [info ] [Thread-1  ]: 16 of 32 PASS not_null_fct_trips_do_location_id ................................ [[32mPASS[0m in 2.26s]
[0m20:48:14.115384 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_do_location_id.6acdd302a6
[0m20:48:14.119656 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_dropoff_time_id.781496e98f
[0m20:48:14.123107 [info ] [Thread-1  ]: 17 of 32 START test not_null_fct_trips_dropoff_time_id ......................... [RUN]
[0m20:48:14.126720 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_do_location_id.6acdd302a6, now test.nyc_taxi.not_null_fct_trips_dropoff_time_id.781496e98f)
[0m20:48:14.130561 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_dropoff_time_id.781496e98f
[0m20:48:14.157867 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_dropoff_time_id.781496e98f"
[0m20:48:14.184965 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_dropoff_time_id.781496e98f
[0m20:48:14.195991 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_fct_trips_dropoff_time_id.781496e98f"
[0m20:48:14.216911 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:48:14.225523 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_fct_trips_dropoff_time_id.781496e98f: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_fct_trips_dropoff_time_id.781496e98f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select dropoff_time_id
from `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips`
where dropoff_time_id is null



      
    ) dbt_internal_test
[0m20:48:15.171099 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:4d6be3c6-ba91-4281-8486-9bbb28c77c3b&page=queryresults
[0m20:48:16.274183 [info ] [Thread-1  ]: 17 of 32 PASS not_null_fct_trips_dropoff_time_id ............................... [[32mPASS[0m in 2.15s]
[0m20:48:16.279071 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_dropoff_time_id.781496e98f
[0m20:48:16.283290 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_extra.1801055bb3
[0m20:48:16.286705 [info ] [Thread-1  ]: 18 of 32 START test not_null_fct_trips_extra ................................... [RUN]
[0m20:48:16.291879 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_dropoff_time_id.781496e98f, now test.nyc_taxi.not_null_fct_trips_extra.1801055bb3)
[0m20:48:16.295758 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_extra.1801055bb3
[0m20:48:16.316980 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_extra.1801055bb3"
[0m20:48:16.347929 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_extra.1801055bb3
[0m20:48:16.362078 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_fct_trips_extra.1801055bb3"
[0m20:48:16.387239 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:48:16.398080 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_fct_trips_extra.1801055bb3: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_fct_trips_extra.1801055bb3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select extra
from `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips`
where extra is null



      
    ) dbt_internal_test
[0m20:48:17.351093 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:d22d47be-3d18-4b14-a71e-1c27bfd4924e&page=queryresults
[0m20:48:18.478298 [info ] [Thread-1  ]: 18 of 32 PASS not_null_fct_trips_extra ......................................... [[32mPASS[0m in 2.19s]
[0m20:48:18.483492 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_extra.1801055bb3
[0m20:48:18.487335 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_improvement_surcharge.4cf28d1443
[0m20:48:18.490784 [info ] [Thread-1  ]: 19 of 32 START test not_null_fct_trips_improvement_surcharge ................... [RUN]
[0m20:48:18.498289 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_extra.1801055bb3, now test.nyc_taxi.not_null_fct_trips_improvement_surcharge.4cf28d1443)
[0m20:48:18.502170 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_improvement_surcharge.4cf28d1443
[0m20:48:18.519417 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_improvement_surcharge.4cf28d1443"
[0m20:48:18.545624 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_improvement_surcharge.4cf28d1443
[0m20:48:18.556937 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_fct_trips_improvement_surcharge.4cf28d1443"
[0m20:48:18.584135 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:48:18.595014 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_fct_trips_improvement_surcharge.4cf28d1443: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_fct_trips_improvement_surcharge.4cf28d1443"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select improvement_surcharge
from `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips`
where improvement_surcharge is null



      
    ) dbt_internal_test
[0m20:48:19.453887 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:37402116-230e-4691-9989-acd52159c558&page=queryresults
[0m20:48:20.591135 [info ] [Thread-1  ]: 19 of 32 PASS not_null_fct_trips_improvement_surcharge ......................... [[32mPASS[0m in 2.09s]
[0m20:48:20.595956 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_improvement_surcharge.4cf28d1443
[0m20:48:20.600158 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_passenger_count.b1370cab1c
[0m20:48:20.603498 [info ] [Thread-1  ]: 20 of 32 START test not_null_fct_trips_passenger_count ......................... [RUN]
[0m20:48:20.606830 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_improvement_surcharge.4cf28d1443, now test.nyc_taxi.not_null_fct_trips_passenger_count.b1370cab1c)
[0m20:48:20.609650 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_passenger_count.b1370cab1c
[0m20:48:20.626955 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_passenger_count.b1370cab1c"
[0m20:48:20.654311 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_passenger_count.b1370cab1c
[0m20:48:20.666636 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_fct_trips_passenger_count.b1370cab1c"
[0m20:48:20.693156 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:48:20.704114 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_fct_trips_passenger_count.b1370cab1c: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_fct_trips_passenger_count.b1370cab1c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select passenger_count
from `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips`
where passenger_count is null



      
    ) dbt_internal_test
[0m20:48:21.692818 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:28209e6a-9f88-4837-b1ee-39b667165b98&page=queryresults
[0m20:48:22.752963 [info ] [Thread-1  ]: 20 of 32 PASS not_null_fct_trips_passenger_count ............................... [[32mPASS[0m in 2.15s]
[0m20:48:22.757730 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_passenger_count.b1370cab1c
[0m20:48:22.762368 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_payment_type.93889b679a
[0m20:48:22.765802 [info ] [Thread-1  ]: 21 of 32 START test not_null_fct_trips_payment_type ............................ [RUN]
[0m20:48:22.769791 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_passenger_count.b1370cab1c, now test.nyc_taxi.not_null_fct_trips_payment_type.93889b679a)
[0m20:48:22.772676 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_payment_type.93889b679a
[0m20:48:22.790127 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_payment_type.93889b679a"
[0m20:48:22.815984 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_payment_type.93889b679a
[0m20:48:22.829225 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_fct_trips_payment_type.93889b679a"
[0m20:48:22.854728 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:48:22.864569 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_fct_trips_payment_type.93889b679a: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_fct_trips_payment_type.93889b679a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select payment_type
from `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips`
where payment_type is null



      
    ) dbt_internal_test
[0m20:48:23.802225 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:1d87c050-55cd-4504-bc8f-9fdf021eb575&page=queryresults
[0m20:48:24.846060 [info ] [Thread-1  ]: 21 of 32 PASS not_null_fct_trips_payment_type .................................. [[32mPASS[0m in 2.08s]
[0m20:48:24.853501 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_payment_type.93889b679a
[0m20:48:24.864529 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_pickup_time_id.f31fbe0eeb
[0m20:48:24.868942 [info ] [Thread-1  ]: 22 of 32 START test not_null_fct_trips_pickup_time_id .......................... [RUN]
[0m20:48:24.873504 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_payment_type.93889b679a, now test.nyc_taxi.not_null_fct_trips_pickup_time_id.f31fbe0eeb)
[0m20:48:24.877144 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_pickup_time_id.f31fbe0eeb
[0m20:48:24.908248 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_pickup_time_id.f31fbe0eeb"
[0m20:48:24.932695 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_pickup_time_id.f31fbe0eeb
[0m20:48:24.947051 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_fct_trips_pickup_time_id.f31fbe0eeb"
[0m20:48:24.969193 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:48:24.979096 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_fct_trips_pickup_time_id.f31fbe0eeb: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_fct_trips_pickup_time_id.f31fbe0eeb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select pickup_time_id
from `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips`
where pickup_time_id is null



      
    ) dbt_internal_test
[0m20:48:25.909164 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:b3c5601e-8aec-439f-8d9f-55468c7bad46&page=queryresults
[0m20:48:26.937520 [info ] [Thread-1  ]: 22 of 32 PASS not_null_fct_trips_pickup_time_id ................................ [[32mPASS[0m in 2.06s]
[0m20:48:26.943458 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_pickup_time_id.f31fbe0eeb
[0m20:48:26.947409 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_pu_location_id.b0dc8dd185
[0m20:48:26.950768 [info ] [Thread-1  ]: 23 of 32 START test not_null_fct_trips_pu_location_id .......................... [RUN]
[0m20:48:26.954612 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_pickup_time_id.f31fbe0eeb, now test.nyc_taxi.not_null_fct_trips_pu_location_id.b0dc8dd185)
[0m20:48:26.957915 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_pu_location_id.b0dc8dd185
[0m20:48:26.979830 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_pu_location_id.b0dc8dd185"
[0m20:48:27.007609 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_pu_location_id.b0dc8dd185
[0m20:48:27.020225 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_fct_trips_pu_location_id.b0dc8dd185"
[0m20:48:27.044941 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:48:27.055324 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_fct_trips_pu_location_id.b0dc8dd185: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_fct_trips_pu_location_id.b0dc8dd185"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select pu_location_id
from `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips`
where pu_location_id is null



      
    ) dbt_internal_test
[0m20:48:28.031895 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:1ebf4f6b-bf95-46d6-b244-08c0e0b4e74f&page=queryresults
[0m20:48:29.125722 [info ] [Thread-1  ]: 23 of 32 PASS not_null_fct_trips_pu_location_id ................................ [[32mPASS[0m in 2.17s]
[0m20:48:29.131238 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_pu_location_id.b0dc8dd185
[0m20:48:29.135237 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_rate_code_id.ba0047eaae
[0m20:48:29.138662 [info ] [Thread-1  ]: 24 of 32 START test not_null_fct_trips_rate_code_id ............................ [RUN]
[0m20:48:29.142966 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_pu_location_id.b0dc8dd185, now test.nyc_taxi.not_null_fct_trips_rate_code_id.ba0047eaae)
[0m20:48:29.146207 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_rate_code_id.ba0047eaae
[0m20:48:29.164218 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_rate_code_id.ba0047eaae"
[0m20:48:29.188620 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_rate_code_id.ba0047eaae
[0m20:48:29.203587 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_fct_trips_rate_code_id.ba0047eaae"
[0m20:48:29.227581 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:48:29.241870 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_fct_trips_rate_code_id.ba0047eaae: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_fct_trips_rate_code_id.ba0047eaae"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select rate_code_id
from `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips`
where rate_code_id is null



      
    ) dbt_internal_test
[0m20:48:30.222341 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:a7529467-bed8-4091-b4fb-c58536e36c52&page=queryresults
[0m20:48:31.326393 [info ] [Thread-1  ]: 24 of 32 PASS not_null_fct_trips_rate_code_id .................................. [[32mPASS[0m in 2.18s]
[0m20:48:31.333866 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_rate_code_id.ba0047eaae
[0m20:48:31.345644 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_trip_distance.19cd17f1df
[0m20:48:31.348690 [info ] [Thread-1  ]: 25 of 32 START test not_null_fct_trips_trip_distance ........................... [RUN]
[0m20:48:31.353173 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_rate_code_id.ba0047eaae, now test.nyc_taxi.not_null_fct_trips_trip_distance.19cd17f1df)
[0m20:48:31.356861 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_trip_distance.19cd17f1df
[0m20:48:31.386900 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_trip_distance.19cd17f1df"
[0m20:48:31.419147 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_trip_distance.19cd17f1df
[0m20:48:31.436077 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_fct_trips_trip_distance.19cd17f1df"
[0m20:48:31.457405 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:48:31.466498 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_fct_trips_trip_distance.19cd17f1df: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_fct_trips_trip_distance.19cd17f1df"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select trip_distance
from `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips`
where trip_distance is null



      
    ) dbt_internal_test
[0m20:48:32.433523 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:5bf11b40-0bc5-4a12-bf34-32d1954b8a33&page=queryresults
[0m20:48:33.571093 [info ] [Thread-1  ]: 25 of 32 PASS not_null_fct_trips_trip_distance ................................. [[32mPASS[0m in 2.22s]
[0m20:48:33.575439 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_trip_distance.19cd17f1df
[0m20:48:33.579045 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_vendor_id.b9b2f380bb
[0m20:48:33.582092 [info ] [Thread-1  ]: 26 of 32 START test not_null_fct_trips_vendor_id ............................... [RUN]
[0m20:48:33.585135 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_trip_distance.19cd17f1df, now test.nyc_taxi.not_null_fct_trips_vendor_id.b9b2f380bb)
[0m20:48:33.587978 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_vendor_id.b9b2f380bb
[0m20:48:33.603391 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_vendor_id.b9b2f380bb"
[0m20:48:33.620274 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_vendor_id.b9b2f380bb
[0m20:48:33.631184 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_fct_trips_vendor_id.b9b2f380bb"
[0m20:48:33.650955 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:48:33.660980 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_fct_trips_vendor_id.b9b2f380bb: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_fct_trips_vendor_id.b9b2f380bb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select vendor_id
from `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips`
where vendor_id is null



      
    ) dbt_internal_test
[0m20:48:34.540254 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:3a4e6b20-9331-40cc-ad6e-760384cf51e1&page=queryresults
[0m20:48:35.593195 [info ] [Thread-1  ]: 26 of 32 PASS not_null_fct_trips_vendor_id ..................................... [[32mPASS[0m in 2.01s]
[0m20:48:35.597620 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_vendor_id.b9b2f380bb
[0m20:48:35.601356 [debug] [Thread-1  ]: Began running node test.nyc_taxi.unique_dim_payment_type_id.dea55de04e
[0m20:48:35.604171 [info ] [Thread-1  ]: 27 of 32 START test unique_dim_payment_type_id ................................. [RUN]
[0m20:48:35.607623 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_vendor_id.b9b2f380bb, now test.nyc_taxi.unique_dim_payment_type_id.dea55de04e)
[0m20:48:35.610499 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.unique_dim_payment_type_id.dea55de04e
[0m20:48:35.640212 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.unique_dim_payment_type_id.dea55de04e"
[0m20:48:35.659204 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.unique_dim_payment_type_id.dea55de04e
[0m20:48:35.669861 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.unique_dim_payment_type_id.dea55de04e"
[0m20:48:35.692274 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:48:35.701611 [debug] [Thread-1  ]: On test.nyc_taxi.unique_dim_payment_type_id.dea55de04e: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.unique_dim_payment_type_id.dea55de04e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select type_id as unique_field
  from `northern-shield-437204-m0`.`nyc_taxi`.`dim_payment`
  where type_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m20:48:36.644783 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:5187e7b6-b01f-414c-b14b-65985b30a023&page=queryresults
[0m20:48:37.748664 [info ] [Thread-1  ]: 27 of 32 PASS unique_dim_payment_type_id ....................................... [[32mPASS[0m in 2.14s]
[0m20:48:37.754041 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.unique_dim_payment_type_id.dea55de04e
[0m20:48:37.758424 [debug] [Thread-1  ]: Began running node test.nyc_taxi.unique_dim_ratecode_rate_id.75ae8e4885
[0m20:48:37.761357 [info ] [Thread-1  ]: 28 of 32 START test unique_dim_ratecode_rate_id ................................ [RUN]
[0m20:48:37.765592 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.unique_dim_payment_type_id.dea55de04e, now test.nyc_taxi.unique_dim_ratecode_rate_id.75ae8e4885)
[0m20:48:37.769809 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.unique_dim_ratecode_rate_id.75ae8e4885
[0m20:48:37.789757 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.unique_dim_ratecode_rate_id.75ae8e4885"
[0m20:48:37.815601 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.unique_dim_ratecode_rate_id.75ae8e4885
[0m20:48:37.827629 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.unique_dim_ratecode_rate_id.75ae8e4885"
[0m20:48:37.853113 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:48:37.863283 [debug] [Thread-1  ]: On test.nyc_taxi.unique_dim_ratecode_rate_id.75ae8e4885: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.unique_dim_ratecode_rate_id.75ae8e4885"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select rate_id as unique_field
  from `northern-shield-437204-m0`.`nyc_taxi`.`dim_ratecode`
  where rate_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m20:48:38.953129 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:f1c32d5c-ba75-403a-a13c-f1a4b818da10&page=queryresults
[0m20:48:39.998844 [info ] [Thread-1  ]: 28 of 32 PASS unique_dim_ratecode_rate_id ...................................... [[32mPASS[0m in 2.23s]
[0m20:48:40.004022 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.unique_dim_ratecode_rate_id.75ae8e4885
[0m20:48:40.008325 [debug] [Thread-1  ]: Began running node test.nyc_taxi.unique_dim_time_time_id.0752c025e8
[0m20:48:40.011765 [info ] [Thread-1  ]: 29 of 32 START test unique_dim_time_time_id .................................... [RUN]
[0m20:48:40.015776 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.unique_dim_ratecode_rate_id.75ae8e4885, now test.nyc_taxi.unique_dim_time_time_id.0752c025e8)
[0m20:48:40.019840 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.unique_dim_time_time_id.0752c025e8
[0m20:48:40.037766 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.unique_dim_time_time_id.0752c025e8"
[0m20:48:40.063827 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.unique_dim_time_time_id.0752c025e8
[0m20:48:40.081318 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.unique_dim_time_time_id.0752c025e8"
[0m20:48:40.107006 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:48:40.117748 [debug] [Thread-1  ]: On test.nyc_taxi.unique_dim_time_time_id.0752c025e8: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.unique_dim_time_time_id.0752c025e8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select time_id as unique_field
  from `northern-shield-437204-m0`.`nyc_taxi`.`dim_time`
  where time_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m20:48:41.161092 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:b138a806-7b79-4cb9-af5e-370da7dddf6d&page=queryresults
[0m20:48:42.306640 [info ] [Thread-1  ]: 29 of 32 PASS unique_dim_time_time_id .......................................... [[32mPASS[0m in 2.29s]
[0m20:48:42.312029 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.unique_dim_time_time_id.0752c025e8
[0m20:48:42.316166 [debug] [Thread-1  ]: Began running node test.nyc_taxi.unique_dim_vendor_id.03fad38d04
[0m20:48:42.319353 [info ] [Thread-1  ]: 30 of 32 START test unique_dim_vendor_id ....................................... [RUN]
[0m20:48:42.322761 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.unique_dim_time_time_id.0752c025e8, now test.nyc_taxi.unique_dim_vendor_id.03fad38d04)
[0m20:48:42.326205 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.unique_dim_vendor_id.03fad38d04
[0m20:48:42.348763 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.unique_dim_vendor_id.03fad38d04"
[0m20:48:42.370755 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.unique_dim_vendor_id.03fad38d04
[0m20:48:42.384701 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.unique_dim_vendor_id.03fad38d04"
[0m20:48:42.406296 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:48:42.417699 [debug] [Thread-1  ]: On test.nyc_taxi.unique_dim_vendor_id.03fad38d04: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.unique_dim_vendor_id.03fad38d04"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select id as unique_field
  from `northern-shield-437204-m0`.`nyc_taxi`.`dim_vendor`
  where id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m20:48:43.524123 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:16390b7e-8b0b-4ef3-87b4-8bbf3dc78067&page=queryresults
[0m20:48:44.807586 [info ] [Thread-1  ]: 30 of 32 PASS unique_dim_vendor_id ............................................. [[32mPASS[0m in 2.48s]
[0m20:48:44.813518 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.unique_dim_vendor_id.03fad38d04
[0m20:48:44.817366 [debug] [Thread-1  ]: Began running node test.nyc_taxi.unique_dim_zone_location_id.7702f92424
[0m20:48:44.820534 [info ] [Thread-1  ]: 31 of 32 START test unique_dim_zone_location_id ................................ [RUN]
[0m20:48:44.826293 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.unique_dim_vendor_id.03fad38d04, now test.nyc_taxi.unique_dim_zone_location_id.7702f92424)
[0m20:48:44.830176 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.unique_dim_zone_location_id.7702f92424
[0m20:48:44.852543 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.unique_dim_zone_location_id.7702f92424"
[0m20:48:44.866170 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.unique_dim_zone_location_id.7702f92424
[0m20:48:44.884614 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.unique_dim_zone_location_id.7702f92424"
[0m20:48:44.905053 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:48:44.914840 [debug] [Thread-1  ]: On test.nyc_taxi.unique_dim_zone_location_id.7702f92424: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.unique_dim_zone_location_id.7702f92424"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select location_id as unique_field
  from `northern-shield-437204-m0`.`nyc_taxi`.`dim_zone`
  where location_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m20:48:45.877448 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:59bd5a9c-93d5-4881-8eab-159451a1d60f&page=queryresults
[0m20:48:46.980893 [info ] [Thread-1  ]: 31 of 32 PASS unique_dim_zone_location_id ...................................... [[32mPASS[0m in 2.15s]
[0m20:48:46.986233 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.unique_dim_zone_location_id.7702f92424
[0m20:48:46.991200 [debug] [Thread-1  ]: Began running node test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab
[0m20:48:46.994047 [info ] [Thread-1  ]: 32 of 32 START test unique_fct_trips_trip_id ................................... [RUN]
[0m20:48:46.997408 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.unique_dim_zone_location_id.7702f92424, now test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab)
[0m20:48:47.000586 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab
[0m20:48:47.022961 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab"
[0m20:48:47.047313 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab
[0m20:48:47.058882 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab"
[0m20:48:47.085747 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:48:47.096006 [debug] [Thread-1  ]: On test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select trip_id as unique_field
  from `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips`
  where trip_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m20:48:48.387322 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:c437efb5-1772-4654-8d58-abc51785f2cd&page=queryresults
[0m20:48:49.438891 [error] [Thread-1  ]: 32 of 32 FAIL 3555 unique_fct_trips_trip_id .................................... [[31mFAIL 3555[0m in 2.44s]
[0m20:48:49.444623 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab
[0m20:48:49.452367 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:48:49.455656 [debug] [MainThread]: Connection 'test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab' was properly closed.
[0m20:48:49.460031 [info ] [MainThread]: 
[0m20:48:49.466386 [info ] [MainThread]: Finished running 32 data tests in 0 hours 1 minutes and 12.76 seconds (72.76s).
[0m20:48:49.508624 [debug] [MainThread]: Command end result
[0m20:48:49.763909 [info ] [MainThread]: 
[0m20:48:49.766665 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m20:48:49.769651 [info ] [MainThread]: 
[0m20:48:49.772782 [error] [MainThread]: [31mFailure in test unique_fct_trips_trip_id (models/tests/schema.yml)[0m
[0m20:48:49.776010 [error] [MainThread]:   Got 3555 results, configured to fail if != 0
[0m20:48:49.778806 [info ] [MainThread]: 
[0m20:48:49.782335 [info ] [MainThread]:   compiled code at target/compiled/nyc_taxi/models/tests/schema.yml/unique_fct_trips_trip_id.sql
[0m20:48:49.785356 [info ] [MainThread]: 
[0m20:48:49.788104 [info ] [MainThread]: Done. PASS=31 WARN=0 ERROR=1 SKIP=0 TOTAL=32
[0m20:48:49.793425 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 80.82981, "process_in_blocks": "0", "process_kernel_time": 0.974633, "process_mem_max_rss": "232148", "process_out_blocks": "0", "process_user_time": 15.996046}
[0m20:48:49.796780 [debug] [MainThread]: Command `dbt test` failed at 20:48:49.796136 after 80.83 seconds
[0m20:48:49.799869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4e427df40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4dd4cb0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4e2d75190>]}
[0m20:48:49.802408 [debug] [MainThread]: Flushing usage events
[0m20:52:14.612730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8af9672490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8af74aaac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8af74aaa60>]}


============================== 20:52:14.629067 | e44c8cfe-fb49-456c-b95a-0ef50854f296 ==============================
[0m20:52:14.629067 [info ] [MainThread]: Running with dbt=1.8.9
[0m20:52:14.632351 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'target_path': 'None', 'version_check': 'True', 'profiles_dir': '/opt/airflow/include/dbt', 'log_format': 'default', 'quiet': 'False', 'log_cache_events': 'False', 'use_experimental_parser': 'False', 'write_json': 'True', 'introspect': 'True', 'log_path': '/opt/airflow/include/dbt/logs', 'no_print': 'None', 'use_colors': 'True', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'printer_width': '80', 'static_parser': 'True', 'debug': 'False', 'invocation_command': 'dbt test --select fct_trips', 'fail_fast': 'False', 'indirect_selection': 'eager', 'partial_parse': 'True', 'warn_error': 'None', 'send_anonymous_usage_stats': 'True'}
[0m20:52:17.265145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e44c8cfe-fb49-456c-b95a-0ef50854f296', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ac4dfb3a0>]}
[0m20:52:17.436740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e44c8cfe-fb49-456c-b95a-0ef50854f296', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8af99da280>]}
[0m20:52:17.440851 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m20:52:17.860047 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m20:52:21.102195 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:52:21.105528 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:52:21.258619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e44c8cfe-fb49-456c-b95a-0ef50854f296', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8af27d0130>]}
[0m20:52:21.893166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e44c8cfe-fb49-456c-b95a-0ef50854f296', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8af27f5190>]}
[0m20:52:21.896481 [info ] [MainThread]: Found 6 models, 32 data tests, 2 sources, 600 macros
[0m20:52:21.900198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e44c8cfe-fb49-456c-b95a-0ef50854f296', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ac415e8e0>]}
[0m20:52:21.908418 [info ] [MainThread]: 
[0m20:52:21.912880 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m20:52:21.929649 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_northern-shield-437204-m0_nyc_taxi'
[0m20:52:21.933488 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:52:22.629649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e44c8cfe-fb49-456c-b95a-0ef50854f296', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8af27f5a30>]}
[0m20:52:22.634028 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:52:22.638144 [info ] [MainThread]: 
[0m20:52:22.661414 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_do_location_id.6acdd302a6
[0m20:52:22.665213 [info ] [Thread-1  ]: 1 of 12 START test not_null_fct_trips_do_location_id ........................... [RUN]
[0m20:52:22.669213 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_northern-shield-437204-m0_nyc_taxi, now test.nyc_taxi.not_null_fct_trips_do_location_id.6acdd302a6)
[0m20:52:22.672650 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_do_location_id.6acdd302a6
[0m20:52:22.730416 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_do_location_id.6acdd302a6"
[0m20:52:22.757226 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_do_location_id.6acdd302a6
[0m20:52:22.818810 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_fct_trips_do_location_id.6acdd302a6"
[0m20:52:22.845760 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:52:22.856147 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_fct_trips_do_location_id.6acdd302a6: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_fct_trips_do_location_id.6acdd302a6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select do_location_id
from `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips`
where do_location_id is null



      
    ) dbt_internal_test
[0m20:52:23.739430 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:4529de3f-48b6-4eb0-b317-af64534850f2&page=queryresults
[0m20:52:24.954800 [info ] [Thread-1  ]: 1 of 12 PASS not_null_fct_trips_do_location_id ................................. [[32mPASS[0m in 2.29s]
[0m20:52:24.960234 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_do_location_id.6acdd302a6
[0m20:52:24.963921 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_dropoff_time_id.781496e98f
[0m20:52:24.967405 [info ] [Thread-1  ]: 2 of 12 START test not_null_fct_trips_dropoff_time_id .......................... [RUN]
[0m20:52:24.971066 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_do_location_id.6acdd302a6, now test.nyc_taxi.not_null_fct_trips_dropoff_time_id.781496e98f)
[0m20:52:24.978233 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_dropoff_time_id.781496e98f
[0m20:52:25.003882 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_dropoff_time_id.781496e98f"
[0m20:52:25.028320 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_dropoff_time_id.781496e98f
[0m20:52:25.045330 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_fct_trips_dropoff_time_id.781496e98f"
[0m20:52:25.068746 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:52:25.078331 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_fct_trips_dropoff_time_id.781496e98f: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_fct_trips_dropoff_time_id.781496e98f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select dropoff_time_id
from `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips`
where dropoff_time_id is null



      
    ) dbt_internal_test
[0m20:52:25.946895 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:3618ca5a-16f7-4b18-ab46-c300e528f455&page=queryresults
[0m20:52:27.100833 [info ] [Thread-1  ]: 2 of 12 PASS not_null_fct_trips_dropoff_time_id ................................ [[32mPASS[0m in 2.13s]
[0m20:52:27.111692 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_dropoff_time_id.781496e98f
[0m20:52:27.118917 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_extra.1801055bb3
[0m20:52:27.124485 [info ] [Thread-1  ]: 3 of 12 START test not_null_fct_trips_extra .................................... [RUN]
[0m20:52:27.129467 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_dropoff_time_id.781496e98f, now test.nyc_taxi.not_null_fct_trips_extra.1801055bb3)
[0m20:52:27.133931 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_extra.1801055bb3
[0m20:52:27.169037 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_extra.1801055bb3"
[0m20:52:27.194077 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_extra.1801055bb3
[0m20:52:27.209175 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_fct_trips_extra.1801055bb3"
[0m20:52:27.229979 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:52:27.239484 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_fct_trips_extra.1801055bb3: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_fct_trips_extra.1801055bb3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select extra
from `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips`
where extra is null



      
    ) dbt_internal_test
[0m20:52:28.055168 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:d205bc57-beeb-4d70-a884-c2ff0ccde89f&page=queryresults
[0m20:52:29.558738 [info ] [Thread-1  ]: 3 of 12 PASS not_null_fct_trips_extra .......................................... [[32mPASS[0m in 2.43s]
[0m20:52:29.565268 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_extra.1801055bb3
[0m20:52:29.570187 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_improvement_surcharge.4cf28d1443
[0m20:52:29.573695 [info ] [Thread-1  ]: 4 of 12 START test not_null_fct_trips_improvement_surcharge .................... [RUN]
[0m20:52:29.577276 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_extra.1801055bb3, now test.nyc_taxi.not_null_fct_trips_improvement_surcharge.4cf28d1443)
[0m20:52:29.581115 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_improvement_surcharge.4cf28d1443
[0m20:52:29.596593 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_improvement_surcharge.4cf28d1443"
[0m20:52:29.618263 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_improvement_surcharge.4cf28d1443
[0m20:52:29.631989 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_fct_trips_improvement_surcharge.4cf28d1443"
[0m20:52:29.652874 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:52:29.661856 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_fct_trips_improvement_surcharge.4cf28d1443: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_fct_trips_improvement_surcharge.4cf28d1443"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select improvement_surcharge
from `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips`
where improvement_surcharge is null



      
    ) dbt_internal_test
[0m20:52:30.462531 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:1cd0c8d7-27eb-436f-beca-b398ed24295c&page=queryresults
[0m20:52:31.613517 [info ] [Thread-1  ]: 4 of 12 PASS not_null_fct_trips_improvement_surcharge .......................... [[32mPASS[0m in 2.04s]
[0m20:52:31.618975 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_improvement_surcharge.4cf28d1443
[0m20:52:31.623423 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_passenger_count.b1370cab1c
[0m20:52:31.626705 [info ] [Thread-1  ]: 5 of 12 START test not_null_fct_trips_passenger_count .......................... [RUN]
[0m20:52:31.631554 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_improvement_surcharge.4cf28d1443, now test.nyc_taxi.not_null_fct_trips_passenger_count.b1370cab1c)
[0m20:52:31.635039 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_passenger_count.b1370cab1c
[0m20:52:31.657564 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_passenger_count.b1370cab1c"
[0m20:52:31.679252 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_passenger_count.b1370cab1c
[0m20:52:31.689860 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_fct_trips_passenger_count.b1370cab1c"
[0m20:52:31.715951 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:52:31.724749 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_fct_trips_passenger_count.b1370cab1c: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_fct_trips_passenger_count.b1370cab1c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select passenger_count
from `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips`
where passenger_count is null



      
    ) dbt_internal_test
[0m20:52:32.569630 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:e568b20c-9d8d-47e5-8e2d-e86daa543d43&page=queryresults
[0m20:52:33.707564 [info ] [Thread-1  ]: 5 of 12 PASS not_null_fct_trips_passenger_count ................................ [[32mPASS[0m in 2.08s]
[0m20:52:33.713125 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_passenger_count.b1370cab1c
[0m20:52:33.717362 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_payment_type.93889b679a
[0m20:52:33.721583 [info ] [Thread-1  ]: 6 of 12 START test not_null_fct_trips_payment_type ............................. [RUN]
[0m20:52:33.725350 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_passenger_count.b1370cab1c, now test.nyc_taxi.not_null_fct_trips_payment_type.93889b679a)
[0m20:52:33.728900 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_payment_type.93889b679a
[0m20:52:33.747571 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_payment_type.93889b679a"
[0m20:52:33.859482 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_payment_type.93889b679a
[0m20:52:33.869940 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_fct_trips_payment_type.93889b679a"
[0m20:52:33.886066 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:52:33.895355 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_fct_trips_payment_type.93889b679a: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_fct_trips_payment_type.93889b679a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select payment_type
from `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips`
where payment_type is null



      
    ) dbt_internal_test
[0m20:52:34.775731 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:b05413ac-ecdf-4b7b-88c2-0f3731a570df&page=queryresults
[0m20:52:35.827729 [info ] [Thread-1  ]: 6 of 12 PASS not_null_fct_trips_payment_type ................................... [[32mPASS[0m in 2.10s]
[0m20:52:35.834393 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_payment_type.93889b679a
[0m20:52:35.838890 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_pickup_time_id.f31fbe0eeb
[0m20:52:35.842468 [info ] [Thread-1  ]: 7 of 12 START test not_null_fct_trips_pickup_time_id ........................... [RUN]
[0m20:52:35.846753 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_payment_type.93889b679a, now test.nyc_taxi.not_null_fct_trips_pickup_time_id.f31fbe0eeb)
[0m20:52:35.850714 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_pickup_time_id.f31fbe0eeb
[0m20:52:35.867207 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_pickup_time_id.f31fbe0eeb"
[0m20:52:35.889248 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_pickup_time_id.f31fbe0eeb
[0m20:52:35.905059 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_fct_trips_pickup_time_id.f31fbe0eeb"
[0m20:52:35.925174 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:52:35.935721 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_fct_trips_pickup_time_id.f31fbe0eeb: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_fct_trips_pickup_time_id.f31fbe0eeb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select pickup_time_id
from `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips`
where pickup_time_id is null



      
    ) dbt_internal_test
[0m20:52:36.692480 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:c5886db5-7ccf-49a0-819d-79f253d2d956&page=queryresults
[0m20:52:37.734155 [info ] [Thread-1  ]: 7 of 12 PASS not_null_fct_trips_pickup_time_id ................................. [[32mPASS[0m in 1.89s]
[0m20:52:37.740256 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_pickup_time_id.f31fbe0eeb
[0m20:52:37.744123 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_pu_location_id.b0dc8dd185
[0m20:52:37.747080 [info ] [Thread-1  ]: 8 of 12 START test not_null_fct_trips_pu_location_id ........................... [RUN]
[0m20:52:37.750499 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_pickup_time_id.f31fbe0eeb, now test.nyc_taxi.not_null_fct_trips_pu_location_id.b0dc8dd185)
[0m20:52:37.757353 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_pu_location_id.b0dc8dd185
[0m20:52:37.778824 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_pu_location_id.b0dc8dd185"
[0m20:52:37.799500 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_pu_location_id.b0dc8dd185
[0m20:52:37.812662 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_fct_trips_pu_location_id.b0dc8dd185"
[0m20:52:37.831592 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:52:37.841113 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_fct_trips_pu_location_id.b0dc8dd185: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_fct_trips_pu_location_id.b0dc8dd185"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select pu_location_id
from `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips`
where pu_location_id is null



      
    ) dbt_internal_test
[0m20:52:38.701785 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:0daaa6a0-6e4d-4c2d-9cbd-36d0986edb67&page=queryresults
[0m20:52:39.808017 [info ] [Thread-1  ]: 8 of 12 PASS not_null_fct_trips_pu_location_id ................................. [[32mPASS[0m in 2.06s]
[0m20:52:39.813375 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_pu_location_id.b0dc8dd185
[0m20:52:39.817391 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_rate_code_id.ba0047eaae
[0m20:52:39.821224 [info ] [Thread-1  ]: 9 of 12 START test not_null_fct_trips_rate_code_id ............................. [RUN]
[0m20:52:39.825969 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_pu_location_id.b0dc8dd185, now test.nyc_taxi.not_null_fct_trips_rate_code_id.ba0047eaae)
[0m20:52:39.829922 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_rate_code_id.ba0047eaae
[0m20:52:39.852431 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_rate_code_id.ba0047eaae"
[0m20:52:39.880982 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_rate_code_id.ba0047eaae
[0m20:52:39.893800 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_fct_trips_rate_code_id.ba0047eaae"
[0m20:52:39.921930 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:52:39.932715 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_fct_trips_rate_code_id.ba0047eaae: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_fct_trips_rate_code_id.ba0047eaae"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select rate_code_id
from `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips`
where rate_code_id is null



      
    ) dbt_internal_test
[0m20:52:40.709629 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:624b03b3-e099-48bf-9651-09c90da99aa8&page=queryresults
[0m20:52:41.791772 [info ] [Thread-1  ]: 9 of 12 PASS not_null_fct_trips_rate_code_id ................................... [[32mPASS[0m in 1.97s]
[0m20:52:41.796701 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_rate_code_id.ba0047eaae
[0m20:52:41.800841 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_trip_distance.19cd17f1df
[0m20:52:41.804015 [info ] [Thread-1  ]: 10 of 12 START test not_null_fct_trips_trip_distance ........................... [RUN]
[0m20:52:41.807772 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_rate_code_id.ba0047eaae, now test.nyc_taxi.not_null_fct_trips_trip_distance.19cd17f1df)
[0m20:52:41.810983 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_trip_distance.19cd17f1df
[0m20:52:41.835483 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_trip_distance.19cd17f1df"
[0m20:52:41.856979 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_trip_distance.19cd17f1df
[0m20:52:41.868635 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_fct_trips_trip_distance.19cd17f1df"
[0m20:52:41.890463 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:52:41.901787 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_fct_trips_trip_distance.19cd17f1df: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_fct_trips_trip_distance.19cd17f1df"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select trip_distance
from `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips`
where trip_distance is null



      
    ) dbt_internal_test
[0m20:52:42.717720 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:914d59f1-6e60-455f-82d5-ee38c47d486a&page=queryresults
[0m20:52:43.882937 [info ] [Thread-1  ]: 10 of 12 PASS not_null_fct_trips_trip_distance ................................. [[32mPASS[0m in 2.07s]
[0m20:52:43.889571 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_trip_distance.19cd17f1df
[0m20:52:43.893678 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_vendor_id.b9b2f380bb
[0m20:52:43.897416 [info ] [Thread-1  ]: 11 of 12 START test not_null_fct_trips_vendor_id ............................... [RUN]
[0m20:52:43.902467 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_trip_distance.19cd17f1df, now test.nyc_taxi.not_null_fct_trips_vendor_id.b9b2f380bb)
[0m20:52:43.908769 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_vendor_id.b9b2f380bb
[0m20:52:43.931918 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_vendor_id.b9b2f380bb"
[0m20:52:43.945053 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_vendor_id.b9b2f380bb
[0m20:52:43.959853 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_fct_trips_vendor_id.b9b2f380bb"
[0m20:52:43.976329 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:52:43.987104 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_fct_trips_vendor_id.b9b2f380bb: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_fct_trips_vendor_id.b9b2f380bb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select vendor_id
from `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips`
where vendor_id is null



      
    ) dbt_internal_test
[0m20:52:44.822959 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:9d1829a5-c98d-4b70-8c59-e3b290b9688f&page=queryresults
[0m20:52:45.929646 [info ] [Thread-1  ]: 11 of 12 PASS not_null_fct_trips_vendor_id ..................................... [[32mPASS[0m in 2.03s]
[0m20:52:45.939492 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_vendor_id.b9b2f380bb
[0m20:52:45.943878 [debug] [Thread-1  ]: Began running node test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab
[0m20:52:45.948144 [info ] [Thread-1  ]: 12 of 12 START test unique_fct_trips_trip_id ................................... [RUN]
[0m20:52:45.953797 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_vendor_id.b9b2f380bb, now test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab)
[0m20:52:45.958656 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab
[0m20:52:45.986968 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab"
[0m20:52:46.008524 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab
[0m20:52:46.019453 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab"
[0m20:52:46.042284 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:52:46.053600 [debug] [Thread-1  ]: On test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select trip_id as unique_field
  from `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips`
  where trip_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m20:52:46.832729 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:0501f4bc-b2aa-4f3b-a442-e8bc0c73ce6b&page=queryresults
[0m20:52:47.937557 [error] [Thread-1  ]: 12 of 12 FAIL 3555 unique_fct_trips_trip_id .................................... [[31mFAIL 3555[0m in 1.98s]
[0m20:52:47.944297 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab
[0m20:52:47.957489 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:52:47.960739 [debug] [MainThread]: Connection 'test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab' was properly closed.
[0m20:52:47.963897 [info ] [MainThread]: 
[0m20:52:47.967779 [info ] [MainThread]: Finished running 12 data tests in 0 hours 0 minutes and 26.05 seconds (26.05s).
[0m20:52:47.984509 [debug] [MainThread]: Command end result
[0m20:52:48.202312 [info ] [MainThread]: 
[0m20:52:48.205782 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m20:52:48.209292 [info ] [MainThread]: 
[0m20:52:48.212544 [error] [MainThread]: [31mFailure in test unique_fct_trips_trip_id (models/tests/schema.yml)[0m
[0m20:52:48.215493 [error] [MainThread]:   Got 3555 results, configured to fail if != 0
[0m20:52:48.217933 [info ] [MainThread]: 
[0m20:52:48.220627 [info ] [MainThread]:   compiled code at target/compiled/nyc_taxi/models/tests/schema.yml/unique_fct_trips_trip_id.sql
[0m20:52:48.223404 [info ] [MainThread]: 
[0m20:52:48.226831 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=1 SKIP=0 TOTAL=12
[0m20:52:48.231229 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 33.881184, "process_in_blocks": "0", "process_kernel_time": 0.730167, "process_mem_max_rss": "237156", "process_out_blocks": "0", "process_user_time": 12.972975}
[0m20:52:48.234260 [debug] [MainThread]: Command `dbt test` failed at 20:52:48.233802 after 33.88 seconds
[0m20:52:48.237270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8af9672490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8af99da280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8af81ca7f0>]}
[0m20:52:48.240247 [debug] [MainThread]: Flushing usage events
[0m06:21:28.047916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a15d2d400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a13b65a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a13b659d0>]}


============================== 06:21:28.054862 | 9c2780ef-3d5d-4b5f-bd0c-dae57a7285c3 ==============================
[0m06:21:28.054862 [info ] [MainThread]: Running with dbt=1.8.9
[0m06:21:28.056921 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'warn_error': 'None', 'static_parser': 'True', 'target_path': 'None', 'log_cache_events': 'False', 'introspect': 'True', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'debug': 'False', 'quiet': 'False', 'log_format': 'default', 'indirect_selection': 'eager', 'no_print': 'None', 'use_colors': 'True', 'cache_selected_only': 'False', 'empty': 'False', 'printer_width': '80', 'use_experimental_parser': 'False', 'profiles_dir': '/opt/airflow/include/dbt/', 'fail_fast': 'False', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/include/dbt/', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'partial_parse': 'True', 'log_path': '/opt/airflow/include/dbt/logs'}
[0m06:21:29.668641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9c2780ef-3d5d-4b5f-bd0c-dae57a7285c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f49e0758d60>]}
[0m06:21:29.743043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9c2780ef-3d5d-4b5f-bd0c-dae57a7285c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a13bfa1c0>]}
[0m06:21:29.744738 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m06:21:29.939324 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m06:21:30.764164 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m06:21:30.765954 [debug] [MainThread]: Partial parsing: updated file: nyc_taxi://models/transform/fct_trips.sql
[0m06:21:31.214448 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:21:31.215957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '9c2780ef-3d5d-4b5f-bd0c-dae57a7285c3', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a0ece4df0>]}
[0m06:21:31.470113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9c2780ef-3d5d-4b5f-bd0c-dae57a7285c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a0eb5eee0>]}
[0m06:21:31.656780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9c2780ef-3d5d-4b5f-bd0c-dae57a7285c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a0ef62910>]}
[0m06:21:31.658350 [info ] [MainThread]: Found 6 models, 32 data tests, 2 sources, 600 macros
[0m06:21:31.659744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9c2780ef-3d5d-4b5f-bd0c-dae57a7285c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a0eb53ee0>]}
[0m06:21:31.663164 [info ] [MainThread]: 
[0m06:21:31.664650 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m06:21:31.671958 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_northern-shield-437204-m0'
[0m06:21:31.673204 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:21:32.363648 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_northern-shield-437204-m0, now list_northern-shield-437204-m0_nyc_taxi)
[0m06:21:32.364875 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:21:32.876498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9c2780ef-3d5d-4b5f-bd0c-dae57a7285c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a15437490>]}
[0m06:21:32.878401 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m06:21:32.879873 [info ] [MainThread]: 
[0m06:21:32.890154 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_payment
[0m06:21:32.892091 [info ] [Thread-1  ]: 1 of 6 START sql table model nyc_taxi.dim_payment .............................. [RUN]
[0m06:21:32.893708 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_northern-shield-437204-m0_nyc_taxi, now model.nyc_taxi.dim_payment)
[0m06:21:32.895209 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_payment
[0m06:21:32.909863 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_payment"
[0m06:21:32.916753 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_payment
[0m06:21:32.946721 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:21:33.501192 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.dim_payment"
[0m06:21:33.506278 [debug] [Thread-1  ]: On model.nyc_taxi.dim_payment: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.dim_payment"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`dim_payment`
      
    
    

    OPTIONS()
    as (
      WITH payment_cte AS(
    SELECT DISTINCT
        payment_type AS type_id,
        CASE 
            WHEN payment_type = 1 THEN "Credit card"
            WHEN payment_type = 2 THEN "Cash"
            WHEN payment_type = 3 THEN "No charge"
            WHEN payment_type = 4 THEN "Dispute"
            WHEN payment_type = 5 THEN "Unknown"
            WHEN payment_type = 6 THEN "Voided trip"
        END AS payment_name
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata`
)
SELECT
    type_id,
    payment_name
FROM payment_cte
    );
  
[0m06:21:34.048288 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:ffe9cbe8-27c2-4582-bce7-1fbf787a4cf7&page=queryresults
[0m06:21:36.727905 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c2780ef-3d5d-4b5f-bd0c-dae57a7285c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a15437490>]}
[0m06:21:36.729658 [info ] [Thread-1  ]: 1 of 6 OK created sql table model nyc_taxi.dim_payment ......................... [[32mCREATE TABLE (4.0 rows, 463.5 KiB processed)[0m in 3.83s]
[0m06:21:36.731460 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_payment
[0m06:21:36.732652 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_ratecode
[0m06:21:36.733740 [info ] [Thread-1  ]: 2 of 6 START sql table model nyc_taxi.dim_ratecode ............................. [RUN]
[0m06:21:36.734822 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_payment, now model.nyc_taxi.dim_ratecode)
[0m06:21:36.735706 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_ratecode
[0m06:21:36.740166 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_ratecode"
[0m06:21:36.744803 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_ratecode
[0m06:21:36.748971 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:21:37.290287 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.dim_ratecode"
[0m06:21:37.296550 [debug] [Thread-1  ]: On model.nyc_taxi.dim_ratecode: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.dim_ratecode"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`dim_ratecode`
      
    
    

    OPTIONS()
    as (
      WITH rate_code_cte AS(
    SELECT DISTINCT
        rate_code_id AS rate_id,
        CASE 
            WHEN rate_code_id = 1 THEN "Standard rate"
            WHEN rate_code_id = 2 THEN "JFK"
            WHEN rate_code_id = 3 THEN "Newark"
            WHEN rate_code_id = 4 THEN "Nassau or Westchester"
            WHEN rate_code_id = 5 THEN "Negotiated fare"
            WHEN rate_code_id = 6 THEN "Group ride"
        ELSE "Unknown"
        END AS rate_code_name
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata`
)
SELECT
    rate_id,
    rate_code_name
FROM rate_code_cte
    );
  
[0m06:21:37.810180 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:8028e394-964d-4a10-9a7d-98c76bf69fcc&page=queryresults
[0m06:21:40.387676 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c2780ef-3d5d-4b5f-bd0c-dae57a7285c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a0ea786a0>]}
[0m06:21:40.389354 [info ] [Thread-1  ]: 2 of 6 OK created sql table model nyc_taxi.dim_ratecode ........................ [[32mCREATE TABLE (6.0 rows, 463.5 KiB processed)[0m in 3.65s]
[0m06:21:40.391223 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_ratecode
[0m06:21:40.392517 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_time
[0m06:21:40.393903 [info ] [Thread-1  ]: 3 of 6 START sql table model nyc_taxi.dim_time ................................. [RUN]
[0m06:21:40.395177 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_ratecode, now model.nyc_taxi.dim_time)
[0m06:21:40.396205 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_time
[0m06:21:40.403097 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_time"
[0m06:21:40.408578 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_time
[0m06:21:40.414025 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.dim_time"
[0m06:21:40.419370 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:21:40.423525 [debug] [Thread-1  ]: On model.nyc_taxi.dim_time: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.dim_time"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`dim_time`
      
    
    

    OPTIONS()
    as (
      WITH datetime_cte AS (
    SELECT DISTINCT
        lpep_pickup_datetime AS datetime_value
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata`
    UNION ALL
    SELECT DISTINCT
        lpep_dropoff_datetime AS datetime_value
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata`
)
SELECT DISTINCT
    ROW_NUMBER() OVER (ORDER BY datetime_value) AS time_id,
    DATE(datetime_value) AS date,
    datetime_value AS date_part,
    EXTRACT(YEAR FROM datetime_value) AS year,
    EXTRACT(MONTH FROM datetime_value) AS month,
    EXTRACT(DAY FROM datetime_value) AS day,
    EXTRACT(HOUR FROM datetime_value) AS hour,
    EXTRACT(MINUTE FROM datetime_value) AS minute,
    FORMAT_TIMESTAMP('%A', datetime_value) AS weekday
FROM datetime_cte
ORDER BY time_id
    );
  
[0m06:21:41.146007 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:b8841664-639c-4b4f-aae9-56e49772a799&page=queryresults
[0m06:21:44.632632 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c2780ef-3d5d-4b5f-bd0c-dae57a7285c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a0ea78850>]}
[0m06:21:44.634182 [info ] [Thread-1  ]: 3 of 6 OK created sql table model nyc_taxi.dim_time ............................ [[32mCREATE TABLE (116.8k rows, 927.0 KiB processed)[0m in 4.24s]
[0m06:21:44.635799 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_time
[0m06:21:44.637014 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_vendor
[0m06:21:44.638339 [info ] [Thread-1  ]: 4 of 6 START sql table model nyc_taxi.dim_vendor ............................... [RUN]
[0m06:21:44.639462 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_time, now model.nyc_taxi.dim_vendor)
[0m06:21:44.640531 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_vendor
[0m06:21:44.645585 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_vendor"
[0m06:21:44.651230 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_vendor
[0m06:21:44.655412 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:21:45.175461 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.dim_vendor"
[0m06:21:45.180601 [debug] [Thread-1  ]: On model.nyc_taxi.dim_vendor: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.dim_vendor"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`dim_vendor`
      
    
    

    OPTIONS()
    as (
      WITH vendor_cte AS(
    SELECT DISTINCT
        vendor_id AS id,
        CASE 
            WHEN vendor_id = 1 THEN "Creative Mobile Technologies"
            WHEN vendor_id = 2 THEN "VeriFone Inc."
        END AS vendor_name
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata`
)
SELECT
    id,
    vendor_name
FROM vendor_cte
    );
  
[0m06:21:45.695713 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:08520c1c-a06f-4856-8a09-9fdcb7dcf078&page=queryresults
[0m06:21:48.014262 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c2780ef-3d5d-4b5f-bd0c-dae57a7285c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a0ea6dc70>]}
[0m06:21:48.016278 [info ] [Thread-1  ]: 4 of 6 OK created sql table model nyc_taxi.dim_vendor .......................... [[32mCREATE TABLE (2.0 rows, 463.5 KiB processed)[0m in 3.37s]
[0m06:21:48.018302 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_vendor
[0m06:21:48.019778 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_zone
[0m06:21:48.021116 [info ] [Thread-1  ]: 5 of 6 START sql table model nyc_taxi.dim_zone ................................. [RUN]
[0m06:21:48.022565 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_vendor, now model.nyc_taxi.dim_zone)
[0m06:21:48.023731 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_zone
[0m06:21:48.029502 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_zone"
[0m06:21:48.034239 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_zone
[0m06:21:48.041337 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:21:48.552777 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.dim_zone"
[0m06:21:48.559202 [debug] [Thread-1  ]: On model.nyc_taxi.dim_zone: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.dim_zone"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`dim_zone`
      
    
    

    OPTIONS()
    as (
      SELECT DISTINCT
    location_id,
    borough,
    zone,
    replace(service_zone, 'Boro', 'Green') as service_zone
FROM `northern-shield-437204-m0`.`nyc_taxi`.`zone_map`
WHERE service_zone is not null
    );
  
[0m06:21:49.091160 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:cd237863-8900-482b-8bad-45efffa14c75&page=queryresults
[0m06:21:51.717809 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c2780ef-3d5d-4b5f-bd0c-dae57a7285c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a0e900d60>]}
[0m06:21:51.719273 [info ] [Thread-1  ]: 5 of 6 OK created sql table model nyc_taxi.dim_zone ............................ [[32mCREATE TABLE (263.0 rows, 24.2 KiB processed)[0m in 3.70s]
[0m06:21:51.720969 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_zone
[0m06:21:51.722260 [debug] [Thread-1  ]: Began running node model.nyc_taxi.fct_trips
[0m06:21:51.723382 [info ] [Thread-1  ]: 6 of 6 START sql table model nyc_taxi.fct_trips ................................ [RUN]
[0m06:21:51.724601 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_zone, now model.nyc_taxi.fct_trips)
[0m06:21:51.725644 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.fct_trips
[0m06:21:51.733410 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.fct_trips"
[0m06:21:51.738314 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.fct_trips
[0m06:21:51.743497 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.fct_trips"
[0m06:21:51.748910 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:21:51.753044 [debug] [Thread-1  ]: On model.nyc_taxi.fct_trips: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.fct_trips"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips`
      
    
    

    OPTIONS()
    as (
      WITH tripdata_cte AS (
    SELECT 
        to_hex(md5(cast(coalesce(cast(__index_level_0__ as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(vendor_id as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(lpep_pickup_datetime as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(lpep_dropoff_datetime as string), '_dbt_utils_surrogate_key_null_') as string))) AS trip_id,
        t.vendor_id,
        pt.time_id AS pickup_time_id,
        dt.time_id AS dropoff_time_id,
        t.rate_code_id,
        t.pu_location_id,
        t.do_location_id,
        t.passenger_count,
        t.trip_distance,
        t.fare_amount,
        t.extra,
        t.mta_tax,
        t.tip_amount,
        t.tolls_amount,
        t.improvement_surcharge,
        t.total_amount,
        t.payment_type,
        t.trip_type,
        t.congestion_surcharge
    FROM numbered_tripdata AS t
    LEFT JOIN (
        SELECT DISTINCT date_part, time_id 
        FROM `northern-shield-437204-m0`.`nyc_taxi`.`dim_time`
    ) pt ON t.lpep_pickup_datetime = pt.date_part
    LEFT JOIN (
        SELECT DISTINCT date_part, time_id 
        FROM `northern-shield-437204-m0`.`nyc_taxi`.`dim_time`
    ) dt ON t.lpep_dropoff_datetime = dt.date_part
    WHERE t.vendor_id IS NOT NULL
        AND t.passenger_count IS NOT NULL
        AND (t.trip_distance IS NOT NULL OR t.trip_distance >= 0)
        AND t.fare_amount >= 0
        AND t.extra >= 0
        AND t.mta_tax >= 0
        AND t.tip_amount >= 0
        AND t.improvement_surcharge >= 0
        AND t.total_amount >= 0
)
SELECT 
    trip_id,
    vendor_id,
    pickup_time_id,
    dropoff_time_id,
    rate_code_id,
    pu_location_id,
    do_location_id,
    passenger_count,
    trip_distance,
    fare_amount,
    extra,
    mta_tax,
    tip_amount,
    tolls_amount,
    improvement_surcharge,
    total_amount,
    payment_type,
    trip_type,
    congestion_surcharge
FROM tripdata_cte
    );
  
[0m06:21:52.241462 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:83204698-b99f-40d6-8576-a225bb33fd71&page=queryresults
[0m06:21:52.243019 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Table "numbered_tripdata" must be qualified with a dataset (e.g. dataset.table).; reason: invalid, location: numbered_tripdata, message: Table "numbered_tripdata" must be qualified with a dataset (e.g. dataset.table).')
[0m06:21:53.316444 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:71e30989-6257-4ae8-b8c3-f230004cb66e&page=queryresults
[0m06:21:53.318194 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:71e30989-6257-4ae8-b8c3-f230004cb66e&page=queryresults
[0m06:21:53.325650 [debug] [Thread-1  ]: Database Error in model fct_trips (models/transform/fct_trips.sql)
  Table "numbered_tripdata" must be qualified with a dataset (e.g. dataset.table).
  compiled code at target/run/nyc_taxi/models/transform/fct_trips.sql
[0m06:21:53.327538 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c2780ef-3d5d-4b5f-bd0c-dae57a7285c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a0e9f5760>]}
[0m06:21:53.329104 [error] [Thread-1  ]: 6 of 6 ERROR creating sql table model nyc_taxi.fct_trips ....................... [[31mERROR[0m in 1.60s]
[0m06:21:53.330703 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.fct_trips
[0m06:21:53.333193 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:21:53.334119 [debug] [MainThread]: Connection 'model.nyc_taxi.fct_trips' was properly closed.
[0m06:21:53.335005 [info ] [MainThread]: 
[0m06:21:53.335994 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 21.67 seconds (21.67s).
[0m06:21:53.339495 [debug] [MainThread]: Command end result
[0m06:21:53.419760 [info ] [MainThread]: 
[0m06:21:53.422000 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m06:21:53.424010 [info ] [MainThread]: 
[0m06:21:53.425745 [error] [MainThread]:   Database Error in model fct_trips (models/transform/fct_trips.sql)
  Table "numbered_tripdata" must be qualified with a dataset (e.g. dataset.table).
  compiled code at target/run/nyc_taxi/models/transform/fct_trips.sql
[0m06:21:53.427455 [info ] [MainThread]: 
[0m06:21:53.429372 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m06:21:53.432120 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 25.451002, "process_in_blocks": "212392", "process_kernel_time": 0.436378, "process_mem_max_rss": "244704", "process_out_blocks": "0", "process_user_time": 6.238229}
[0m06:21:53.434298 [debug] [MainThread]: Command `dbt run` failed at 06:21:53.433927 after 25.45 seconds
[0m06:21:53.435904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a15d2d400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a15437490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f49e0631ca0>]}
[0m06:21:53.437134 [debug] [MainThread]: Flushing usage events
[0m06:24:47.217278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb47bd41f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb479b169d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb479b16970>]}


============================== 06:24:47.224800 | 8e918bfa-ce40-4142-9d7b-ea84d89f0443 ==============================
[0m06:24:47.224800 [info ] [MainThread]: Running with dbt=1.8.9
[0m06:24:47.226390 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'use_experimental_parser': 'False', 'quiet': 'False', 'version_check': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/include/dbt/', 'fail_fast': 'False', 'no_print': 'None', 'empty': 'False', 'target_path': 'None', 'static_parser': 'True', 'warn_error': 'None', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'partial_parse': 'True', 'profiles_dir': '/opt/airflow/include/dbt/', 'debug': 'False', 'log_format': 'default', 'printer_width': '80', 'use_colors': 'True', 'log_cache_events': 'False', 'cache_selected_only': 'False', 'log_path': '/opt/airflow/include/dbt/logs'}
[0m06:24:48.382420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8e918bfa-ce40-4142-9d7b-ea84d89f0443', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb47b528fd0>]}
[0m06:24:48.444761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8e918bfa-ce40-4142-9d7b-ea84d89f0443', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4426af280>]}
[0m06:24:48.446685 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m06:24:48.605192 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m06:24:49.288291 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m06:24:49.290078 [debug] [MainThread]: Partial parsing: updated file: nyc_taxi://models/transform/fct_trips.sql
[0m06:24:49.697118 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:24:49.698807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '8e918bfa-ce40-4142-9d7b-ea84d89f0443', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb44272c5b0>]}
[0m06:24:49.932421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8e918bfa-ce40-4142-9d7b-ea84d89f0443', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb474b5feb0>]}
[0m06:24:50.098182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8e918bfa-ce40-4142-9d7b-ea84d89f0443', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb47b3540d0>]}
[0m06:24:50.099525 [info ] [MainThread]: Found 6 models, 32 data tests, 2 sources, 600 macros
[0m06:24:50.100805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8e918bfa-ce40-4142-9d7b-ea84d89f0443', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb474b53e80>]}
[0m06:24:50.104139 [info ] [MainThread]: 
[0m06:24:50.105579 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m06:24:50.112179 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_northern-shield-437204-m0'
[0m06:24:50.113329 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:24:50.771049 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_northern-shield-437204-m0, now list_northern-shield-437204-m0_nyc_taxi)
[0m06:24:50.772650 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:24:51.280324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8e918bfa-ce40-4142-9d7b-ea84d89f0443', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4433fd070>]}
[0m06:24:51.281957 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m06:24:51.283320 [info ] [MainThread]: 
[0m06:24:51.292581 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_payment
[0m06:24:51.294015 [info ] [Thread-1  ]: 1 of 6 START sql table model nyc_taxi.dim_payment .............................. [RUN]
[0m06:24:51.295169 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_northern-shield-437204-m0_nyc_taxi, now model.nyc_taxi.dim_payment)
[0m06:24:51.296167 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_payment
[0m06:24:51.308336 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_payment"
[0m06:24:51.313725 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_payment
[0m06:24:51.333320 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:24:51.851317 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.dim_payment"
[0m06:24:51.857757 [debug] [Thread-1  ]: On model.nyc_taxi.dim_payment: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.dim_payment"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`dim_payment`
      
    
    

    OPTIONS()
    as (
      WITH payment_cte AS(
    SELECT DISTINCT
        payment_type AS type_id,
        CASE 
            WHEN payment_type = 1 THEN "Credit card"
            WHEN payment_type = 2 THEN "Cash"
            WHEN payment_type = 3 THEN "No charge"
            WHEN payment_type = 4 THEN "Dispute"
            WHEN payment_type = 5 THEN "Unknown"
            WHEN payment_type = 6 THEN "Voided trip"
        END AS payment_name
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata`
)
SELECT
    type_id,
    payment_name
FROM payment_cte
    );
  
[0m06:24:52.452211 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:65c97cee-4b3a-48c8-9bfc-377f7d708305&page=queryresults
[0m06:24:55.001571 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8e918bfa-ce40-4142-9d7b-ea84d89f0443', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4433fd070>]}
[0m06:24:55.003455 [info ] [Thread-1  ]: 1 of 6 OK created sql table model nyc_taxi.dim_payment ......................... [[32mCREATE TABLE (4.0 rows, 463.5 KiB processed)[0m in 3.71s]
[0m06:24:55.005276 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_payment
[0m06:24:55.006660 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_ratecode
[0m06:24:55.007898 [info ] [Thread-1  ]: 2 of 6 START sql table model nyc_taxi.dim_ratecode ............................. [RUN]
[0m06:24:55.009116 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_payment, now model.nyc_taxi.dim_ratecode)
[0m06:24:55.010286 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_ratecode
[0m06:24:55.015669 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_ratecode"
[0m06:24:55.020954 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_ratecode
[0m06:24:55.025523 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:24:55.563631 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.dim_ratecode"
[0m06:24:55.569037 [debug] [Thread-1  ]: On model.nyc_taxi.dim_ratecode: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.dim_ratecode"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`dim_ratecode`
      
    
    

    OPTIONS()
    as (
      WITH rate_code_cte AS(
    SELECT DISTINCT
        rate_code_id AS rate_id,
        CASE 
            WHEN rate_code_id = 1 THEN "Standard rate"
            WHEN rate_code_id = 2 THEN "JFK"
            WHEN rate_code_id = 3 THEN "Newark"
            WHEN rate_code_id = 4 THEN "Nassau or Westchester"
            WHEN rate_code_id = 5 THEN "Negotiated fare"
            WHEN rate_code_id = 6 THEN "Group ride"
        ELSE "Unknown"
        END AS rate_code_name
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata`
)
SELECT
    rate_id,
    rate_code_name
FROM rate_code_cte
    );
  
[0m06:24:56.144522 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:f12bd670-f8fa-470f-8c33-443bd77389c7&page=queryresults
[0m06:24:58.710145 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8e918bfa-ce40-4142-9d7b-ea84d89f0443', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb474a78760>]}
[0m06:24:58.711878 [info ] [Thread-1  ]: 2 of 6 OK created sql table model nyc_taxi.dim_ratecode ........................ [[32mCREATE TABLE (6.0 rows, 463.5 KiB processed)[0m in 3.70s]
[0m06:24:58.714046 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_ratecode
[0m06:24:58.715640 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_time
[0m06:24:58.717043 [info ] [Thread-1  ]: 3 of 6 START sql table model nyc_taxi.dim_time ................................. [RUN]
[0m06:24:58.718416 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_ratecode, now model.nyc_taxi.dim_time)
[0m06:24:58.719589 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_time
[0m06:24:58.727176 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_time"
[0m06:24:58.732238 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_time
[0m06:24:58.736600 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:24:59.265002 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.dim_time"
[0m06:24:59.270913 [debug] [Thread-1  ]: On model.nyc_taxi.dim_time: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.dim_time"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`dim_time`
      
    
    

    OPTIONS()
    as (
      WITH datetime_cte AS (
    SELECT DISTINCT
        lpep_pickup_datetime AS datetime_value
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata`
    UNION ALL
    SELECT DISTINCT
        lpep_dropoff_datetime AS datetime_value
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata`
)
SELECT DISTINCT
    ROW_NUMBER() OVER (ORDER BY datetime_value) AS time_id,
    DATE(datetime_value) AS date,
    datetime_value AS date_part,
    EXTRACT(YEAR FROM datetime_value) AS year,
    EXTRACT(MONTH FROM datetime_value) AS month,
    EXTRACT(DAY FROM datetime_value) AS day,
    EXTRACT(HOUR FROM datetime_value) AS hour,
    EXTRACT(MINUTE FROM datetime_value) AS minute,
    FORMAT_TIMESTAMP('%A', datetime_value) AS weekday
FROM datetime_cte
ORDER BY time_id
    );
  
[0m06:24:59.794054 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:8f3543e3-179d-4fc5-a79d-a7d1ec2a20c1&page=queryresults
[0m06:25:03.221066 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8e918bfa-ce40-4142-9d7b-ea84d89f0443', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb474a788e0>]}
[0m06:25:03.222524 [info ] [Thread-1  ]: 3 of 6 OK created sql table model nyc_taxi.dim_time ............................ [[32mCREATE TABLE (116.8k rows, 927.0 KiB processed)[0m in 4.50s]
[0m06:25:03.224272 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_time
[0m06:25:03.225881 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_vendor
[0m06:25:03.227368 [info ] [Thread-1  ]: 4 of 6 START sql table model nyc_taxi.dim_vendor ............................... [RUN]
[0m06:25:03.228639 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_time, now model.nyc_taxi.dim_vendor)
[0m06:25:03.229830 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_vendor
[0m06:25:03.234940 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_vendor"
[0m06:25:03.239928 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_vendor
[0m06:25:03.244504 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:25:03.766899 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.dim_vendor"
[0m06:25:03.773140 [debug] [Thread-1  ]: On model.nyc_taxi.dim_vendor: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.dim_vendor"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`dim_vendor`
      
    
    

    OPTIONS()
    as (
      WITH vendor_cte AS(
    SELECT DISTINCT
        vendor_id AS id,
        CASE 
            WHEN vendor_id = 1 THEN "Creative Mobile Technologies"
            WHEN vendor_id = 2 THEN "VeriFone Inc."
        END AS vendor_name
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata`
)
SELECT
    id,
    vendor_name
FROM vendor_cte
    );
  
[0m06:25:04.290261 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:ec733113-f20a-4b4c-94fb-d400674835e4&page=queryresults
[0m06:25:06.885869 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8e918bfa-ce40-4142-9d7b-ea84d89f0443', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb474a78910>]}
[0m06:25:06.887792 [info ] [Thread-1  ]: 4 of 6 OK created sql table model nyc_taxi.dim_vendor .......................... [[32mCREATE TABLE (2.0 rows, 463.5 KiB processed)[0m in 3.66s]
[0m06:25:06.889956 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_vendor
[0m06:25:06.891432 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_zone
[0m06:25:06.892840 [info ] [Thread-1  ]: 5 of 6 START sql table model nyc_taxi.dim_zone ................................. [RUN]
[0m06:25:06.894283 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_vendor, now model.nyc_taxi.dim_zone)
[0m06:25:06.895701 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_zone
[0m06:25:06.901463 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_zone"
[0m06:25:06.906523 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_zone
[0m06:25:06.912851 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:25:07.433111 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.dim_zone"
[0m06:25:07.439122 [debug] [Thread-1  ]: On model.nyc_taxi.dim_zone: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.dim_zone"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`dim_zone`
      
    
    

    OPTIONS()
    as (
      SELECT DISTINCT
    location_id,
    borough,
    zone,
    replace(service_zone, 'Boro', 'Green') as service_zone
FROM `northern-shield-437204-m0`.`nyc_taxi`.`zone_map`
WHERE service_zone is not null
    );
  
[0m06:25:07.973460 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:a01f74a1-15bb-46bb-9537-dce501661ee1&page=queryresults
[0m06:25:10.231461 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8e918bfa-ce40-4142-9d7b-ea84d89f0443', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb474974e20>]}
[0m06:25:10.233357 [info ] [Thread-1  ]: 5 of 6 OK created sql table model nyc_taxi.dim_zone ............................ [[32mCREATE TABLE (263.0 rows, 24.2 KiB processed)[0m in 3.34s]
[0m06:25:10.235718 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_zone
[0m06:25:10.237183 [debug] [Thread-1  ]: Began running node model.nyc_taxi.fct_trips
[0m06:25:10.238509 [info ] [Thread-1  ]: 6 of 6 START sql table model nyc_taxi.fct_trips ................................ [RUN]
[0m06:25:10.239776 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_zone, now model.nyc_taxi.fct_trips)
[0m06:25:10.241137 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.fct_trips
[0m06:25:10.249293 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.fct_trips"
[0m06:25:10.253882 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.fct_trips
[0m06:25:10.258732 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.fct_trips"
[0m06:25:10.264385 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:25:10.268148 [debug] [Thread-1  ]: On model.nyc_taxi.fct_trips: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.fct_trips"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips`
      
    
    

    OPTIONS()
    as (
      WITH tripdata_cte AS (
    SELECT 
        to_hex(md5(cast(coalesce(cast(vendor_id as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(lpep_pickup_datetime as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(lpep_dropoff_datetime as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(__index_level_0__ as string), '_dbt_utils_surrogate_key_null_') as string))) AS trip_id,
        t.vendor_id,
        pt.time_id AS pickup_time_id,
        dt.time_id AS dropoff_time_id,
        t.rate_code_id,
        t.pu_location_id,
        t.do_location_id,
        t.passenger_count,
        t.trip_distance,
        t.fare_amount,
        t.extra,
        t.mta_tax,
        t.tip_amount,
        t.tolls_amount,
        t.improvement_surcharge,
        t.total_amount,
        t.payment_type,
        t.trip_type,
        t.congestion_surcharge
    FROM numbered_tripdata AS t
    LEFT JOIN (
        SELECT DISTINCT date_part, time_id 
        FROM `northern-shield-437204-m0`.`nyc_taxi`.`dim_time`
    ) pt ON t.lpep_pickup_datetime = pt.date_part
    LEFT JOIN (
        SELECT DISTINCT date_part, time_id 
        FROM `northern-shield-437204-m0`.`nyc_taxi`.`dim_time`
    ) dt ON t.lpep_dropoff_datetime = dt.date_part
    WHERE t.vendor_id IS NOT NULL
        AND t.passenger_count IS NOT NULL
        AND (t.trip_distance IS NOT NULL OR t.trip_distance >= 0)
        AND t.fare_amount >= 0
        AND t.extra >= 0
        AND t.mta_tax >= 0
        AND t.tip_amount >= 0
        AND t.improvement_surcharge >= 0
        AND t.total_amount >= 0
)
SELECT 
    trip_id,
    vendor_id,
    pickup_time_id,
    dropoff_time_id,
    rate_code_id,
    pu_location_id,
    do_location_id,
    passenger_count,
    trip_distance,
    fare_amount,
    extra,
    mta_tax,
    tip_amount,
    tolls_amount,
    improvement_surcharge,
    total_amount,
    payment_type,
    trip_type,
    congestion_surcharge
FROM tripdata_cte
    );
  
[0m06:25:10.788232 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:5ac7dc7e-466b-4138-8801-ee1c27151acc&page=queryresults
[0m06:25:10.789941 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Table "numbered_tripdata" must be qualified with a dataset (e.g. dataset.table).; reason: invalid, location: numbered_tripdata, message: Table "numbered_tripdata" must be qualified with a dataset (e.g. dataset.table).')
[0m06:25:11.802110 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:863052a9-533c-4bb8-9b9f-fa9d391bb1a3&page=queryresults
[0m06:25:11.803906 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:863052a9-533c-4bb8-9b9f-fa9d391bb1a3&page=queryresults
[0m06:25:11.808250 [debug] [Thread-1  ]: Database Error in model fct_trips (models/transform/fct_trips.sql)
  Table "numbered_tripdata" must be qualified with a dataset (e.g. dataset.table).
  compiled code at target/run/nyc_taxi/models/transform/fct_trips.sql
[0m06:25:11.809695 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8e918bfa-ce40-4142-9d7b-ea84d89f0443', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb474944130>]}
[0m06:25:11.811476 [error] [Thread-1  ]: 6 of 6 ERROR creating sql table model nyc_taxi.fct_trips ....................... [[31mERROR[0m in 1.57s]
[0m06:25:11.813362 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.fct_trips
[0m06:25:11.816104 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:25:11.817505 [debug] [MainThread]: Connection 'model.nyc_taxi.fct_trips' was properly closed.
[0m06:25:11.818835 [info ] [MainThread]: 
[0m06:25:11.819926 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 21.71 seconds (21.71s).
[0m06:25:11.823606 [debug] [MainThread]: Command end result
[0m06:25:11.894829 [info ] [MainThread]: 
[0m06:25:11.896124 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m06:25:11.897125 [info ] [MainThread]: 
[0m06:25:11.898293 [error] [MainThread]:   Database Error in model fct_trips (models/transform/fct_trips.sql)
  Table "numbered_tripdata" must be qualified with a dataset (e.g. dataset.table).
  compiled code at target/run/nyc_taxi/models/transform/fct_trips.sql
[0m06:25:11.899292 [info ] [MainThread]: 
[0m06:25:11.900395 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m06:25:11.902249 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 24.794659, "process_in_blocks": "0", "process_kernel_time": 0.325406, "process_mem_max_rss": "243284", "process_out_blocks": "0", "process_user_time": 5.906625}
[0m06:25:11.903876 [debug] [MainThread]: Command `dbt run` failed at 06:25:11.903674 after 24.80 seconds
[0m06:25:11.904951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb47bd41f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4426af280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb47a86c580>]}
[0m06:25:11.905915 [debug] [MainThread]: Flushing usage events
[0m06:26:28.806266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c9bcda460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c99b129a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c99b12940>]}


============================== 06:26:28.813616 | 26f52fb7-0de7-4e66-8c58-b67163657219 ==============================
[0m06:26:28.813616 [info ] [MainThread]: Running with dbt=1.8.9
[0m06:26:28.814984 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'profiles_dir': '/opt/airflow/include/dbt/', 'target_path': 'None', 'introspect': 'True', 'empty': 'False', 'partial_parse': 'True', 'printer_width': '80', 'version_check': 'True', 'static_parser': 'True', 'warn_error': 'None', 'indirect_selection': 'eager', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/include/dbt/', 'write_json': 'True', 'no_print': 'None', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'quiet': 'False', 'log_format': 'default', 'debug': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'log_path': '/opt/airflow/include/dbt/logs', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True', 'log_cache_events': 'False'}
[0m06:26:29.935714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '26f52fb7-0de7-4e66-8c58-b67163657219', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c9c027a60>]}
[0m06:26:29.997299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '26f52fb7-0de7-4e66-8c58-b67163657219', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c6269ea00>]}
[0m06:26:29.998855 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m06:26:30.160580 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m06:26:30.838021 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m06:26:30.839511 [debug] [MainThread]: Partial parsing: updated file: nyc_taxi://models/transform/fct_trips.sql
[0m06:26:31.241821 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:26:31.243462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '26f52fb7-0de7-4e66-8c58-b67163657219', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c94d86a90>]}
[0m06:26:31.474110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '26f52fb7-0de7-4e66-8c58-b67163657219', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c94b65a00>]}
[0m06:26:31.641112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '26f52fb7-0de7-4e66-8c58-b67163657219', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c94e23af0>]}
[0m06:26:31.642363 [info ] [MainThread]: Found 6 models, 32 data tests, 2 sources, 600 macros
[0m06:26:31.644015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '26f52fb7-0de7-4e66-8c58-b67163657219', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c94b559a0>]}
[0m06:26:31.648340 [info ] [MainThread]: 
[0m06:26:31.650148 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m06:26:31.657123 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_northern-shield-437204-m0'
[0m06:26:31.658391 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:26:32.226162 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_northern-shield-437204-m0, now list_northern-shield-437204-m0_nyc_taxi)
[0m06:26:32.227629 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:26:32.721796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '26f52fb7-0de7-4e66-8c58-b67163657219', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c94cdda00>]}
[0m06:26:32.723306 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m06:26:32.724708 [info ] [MainThread]: 
[0m06:26:32.733261 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_payment
[0m06:26:32.734723 [info ] [Thread-1  ]: 1 of 6 START sql table model nyc_taxi.dim_payment .............................. [RUN]
[0m06:26:32.735976 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_northern-shield-437204-m0_nyc_taxi, now model.nyc_taxi.dim_payment)
[0m06:26:32.737033 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_payment
[0m06:26:32.749566 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_payment"
[0m06:26:32.754810 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_payment
[0m06:26:32.773852 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:26:33.300880 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.dim_payment"
[0m06:26:33.306406 [debug] [Thread-1  ]: On model.nyc_taxi.dim_payment: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.dim_payment"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`dim_payment`
      
    
    

    OPTIONS()
    as (
      WITH payment_cte AS(
    SELECT DISTINCT
        payment_type AS type_id,
        CASE 
            WHEN payment_type = 1 THEN "Credit card"
            WHEN payment_type = 2 THEN "Cash"
            WHEN payment_type = 3 THEN "No charge"
            WHEN payment_type = 4 THEN "Dispute"
            WHEN payment_type = 5 THEN "Unknown"
            WHEN payment_type = 6 THEN "Voided trip"
        END AS payment_name
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata`
)
SELECT
    type_id,
    payment_name
FROM payment_cte
    );
  
[0m06:26:33.831024 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:10551065-8a97-4e7f-b9a2-ebf04c13b92a&page=queryresults
[0m06:26:36.761048 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '26f52fb7-0de7-4e66-8c58-b67163657219', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c9c027520>]}
[0m06:26:36.762913 [info ] [Thread-1  ]: 1 of 6 OK created sql table model nyc_taxi.dim_payment ......................... [[32mCREATE TABLE (4.0 rows, 463.5 KiB processed)[0m in 4.02s]
[0m06:26:36.764803 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_payment
[0m06:26:36.766334 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_ratecode
[0m06:26:36.767640 [info ] [Thread-1  ]: 2 of 6 START sql table model nyc_taxi.dim_ratecode ............................. [RUN]
[0m06:26:36.769039 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_payment, now model.nyc_taxi.dim_ratecode)
[0m06:26:36.770307 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_ratecode
[0m06:26:36.775875 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_ratecode"
[0m06:26:36.781432 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_ratecode
[0m06:26:36.786761 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:26:37.438007 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.dim_ratecode"
[0m06:26:37.443168 [debug] [Thread-1  ]: On model.nyc_taxi.dim_ratecode: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.dim_ratecode"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`dim_ratecode`
      
    
    

    OPTIONS()
    as (
      WITH rate_code_cte AS(
    SELECT DISTINCT
        rate_code_id AS rate_id,
        CASE 
            WHEN rate_code_id = 1 THEN "Standard rate"
            WHEN rate_code_id = 2 THEN "JFK"
            WHEN rate_code_id = 3 THEN "Newark"
            WHEN rate_code_id = 4 THEN "Nassau or Westchester"
            WHEN rate_code_id = 5 THEN "Negotiated fare"
            WHEN rate_code_id = 6 THEN "Group ride"
        ELSE "Unknown"
        END AS rate_code_name
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata`
)
SELECT
    rate_id,
    rate_code_name
FROM rate_code_cte
    );
  
[0m06:26:37.983187 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:f4c44d08-d756-4df4-a113-91d8b6c6ce5a&page=queryresults
[0m06:26:40.593891 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '26f52fb7-0de7-4e66-8c58-b67163657219', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c94a79520>]}
[0m06:26:40.595542 [info ] [Thread-1  ]: 2 of 6 OK created sql table model nyc_taxi.dim_ratecode ........................ [[32mCREATE TABLE (6.0 rows, 463.5 KiB processed)[0m in 3.83s]
[0m06:26:40.597335 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_ratecode
[0m06:26:40.598579 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_time
[0m06:26:40.599749 [info ] [Thread-1  ]: 3 of 6 START sql table model nyc_taxi.dim_time ................................. [RUN]
[0m06:26:40.600971 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_ratecode, now model.nyc_taxi.dim_time)
[0m06:26:40.601975 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_time
[0m06:26:40.608805 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_time"
[0m06:26:40.615162 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_time
[0m06:26:40.620031 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:26:41.120259 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.dim_time"
[0m06:26:41.126361 [debug] [Thread-1  ]: On model.nyc_taxi.dim_time: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.dim_time"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`dim_time`
      
    
    

    OPTIONS()
    as (
      WITH datetime_cte AS (
    SELECT DISTINCT
        lpep_pickup_datetime AS datetime_value
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata`
    UNION ALL
    SELECT DISTINCT
        lpep_dropoff_datetime AS datetime_value
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata`
)
SELECT DISTINCT
    ROW_NUMBER() OVER (ORDER BY datetime_value) AS time_id,
    DATE(datetime_value) AS date,
    datetime_value AS date_part,
    EXTRACT(YEAR FROM datetime_value) AS year,
    EXTRACT(MONTH FROM datetime_value) AS month,
    EXTRACT(DAY FROM datetime_value) AS day,
    EXTRACT(HOUR FROM datetime_value) AS hour,
    EXTRACT(MINUTE FROM datetime_value) AS minute,
    FORMAT_TIMESTAMP('%A', datetime_value) AS weekday
FROM datetime_cte
ORDER BY time_id
    );
  
[0m06:26:41.624869 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:f0ff7136-fa26-4349-a1cc-16308afa9075&page=queryresults
[0m06:26:45.014917 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '26f52fb7-0de7-4e66-8c58-b67163657219', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c94a793a0>]}
[0m06:26:45.016845 [info ] [Thread-1  ]: 3 of 6 OK created sql table model nyc_taxi.dim_time ............................ [[32mCREATE TABLE (116.8k rows, 927.0 KiB processed)[0m in 4.41s]
[0m06:26:45.018949 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_time
[0m06:26:45.020581 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_vendor
[0m06:26:45.022076 [info ] [Thread-1  ]: 4 of 6 START sql table model nyc_taxi.dim_vendor ............................... [RUN]
[0m06:26:45.023589 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_time, now model.nyc_taxi.dim_vendor)
[0m06:26:45.024955 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_vendor
[0m06:26:45.031888 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_vendor"
[0m06:26:45.039780 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_vendor
[0m06:26:45.046056 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:26:45.578322 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.dim_vendor"
[0m06:26:45.585504 [debug] [Thread-1  ]: On model.nyc_taxi.dim_vendor: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.dim_vendor"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`dim_vendor`
      
    
    

    OPTIONS()
    as (
      WITH vendor_cte AS(
    SELECT DISTINCT
        vendor_id AS id,
        CASE 
            WHEN vendor_id = 1 THEN "Creative Mobile Technologies"
            WHEN vendor_id = 2 THEN "VeriFone Inc."
        END AS vendor_name
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata`
)
SELECT
    id,
    vendor_name
FROM vendor_cte
    );
  
[0m06:26:46.068549 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:67a36ef4-3c27-4537-b940-08ff6274ccc9&page=queryresults
[0m06:26:48.657750 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '26f52fb7-0de7-4e66-8c58-b67163657219', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c94a2cfd0>]}
[0m06:26:48.659192 [info ] [Thread-1  ]: 4 of 6 OK created sql table model nyc_taxi.dim_vendor .......................... [[32mCREATE TABLE (2.0 rows, 463.5 KiB processed)[0m in 3.63s]
[0m06:26:48.660835 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_vendor
[0m06:26:48.662269 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_zone
[0m06:26:48.664137 [info ] [Thread-1  ]: 5 of 6 START sql table model nyc_taxi.dim_zone ................................. [RUN]
[0m06:26:48.665832 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_vendor, now model.nyc_taxi.dim_zone)
[0m06:26:48.667046 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_zone
[0m06:26:48.672792 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_zone"
[0m06:26:48.678822 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_zone
[0m06:26:48.688248 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:26:49.223189 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.dim_zone"
[0m06:26:49.230064 [debug] [Thread-1  ]: On model.nyc_taxi.dim_zone: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.dim_zone"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`dim_zone`
      
    
    

    OPTIONS()
    as (
      SELECT DISTINCT
    location_id,
    borough,
    zone,
    replace(service_zone, 'Boro', 'Green') as service_zone
FROM `northern-shield-437204-m0`.`nyc_taxi`.`zone_map`
WHERE service_zone is not null
    );
  
[0m06:26:49.728550 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:19904f22-0d45-40ce-9854-398f3cb18618&page=queryresults
[0m06:26:52.403986 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '26f52fb7-0de7-4e66-8c58-b67163657219', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c9a835370>]}
[0m06:26:52.406081 [info ] [Thread-1  ]: 5 of 6 OK created sql table model nyc_taxi.dim_zone ............................ [[32mCREATE TABLE (263.0 rows, 24.2 KiB processed)[0m in 3.74s]
[0m06:26:52.408249 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_zone
[0m06:26:52.409733 [debug] [Thread-1  ]: Began running node model.nyc_taxi.fct_trips
[0m06:26:52.411055 [info ] [Thread-1  ]: 6 of 6 START sql table model nyc_taxi.fct_trips ................................ [RUN]
[0m06:26:52.412526 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_zone, now model.nyc_taxi.fct_trips)
[0m06:26:52.413861 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.fct_trips
[0m06:26:52.423269 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.fct_trips"
[0m06:26:52.428410 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.fct_trips
[0m06:26:52.434016 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.fct_trips"
[0m06:26:52.439854 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:26:52.443358 [debug] [Thread-1  ]: On model.nyc_taxi.fct_trips: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.fct_trips"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips`
      
    
    

    OPTIONS()
    as (
      WITH tripdata_cte AS (
    SELECT 
        to_hex(md5(cast(coalesce(cast(t.vendor_id as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(t.lpep_pickup_datetime as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(t.lpep_dropoff_datetime as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(t.__index_level_0__ as string), '_dbt_utils_surrogate_key_null_') as string))) AS trip_id,
        t.vendor_id,
        pt.time_id AS pickup_time_id,
        dt.time_id AS dropoff_time_id,
        t.rate_code_id,
        t.pu_location_id,
        t.do_location_id,
        t.passenger_count,
        t.trip_distance,
        t.fare_amount,
        t.extra,
        t.mta_tax,
        t.tip_amount,
        t.tolls_amount,
        t.improvement_surcharge,
        t.total_amount,
        t.payment_type,
        t.trip_type,
        t.congestion_surcharge
    FROM numbered_tripdata AS t
    LEFT JOIN (
        SELECT DISTINCT date_part, time_id 
        FROM `northern-shield-437204-m0`.`nyc_taxi`.`dim_time`
    ) pt ON t.lpep_pickup_datetime = pt.date_part
    LEFT JOIN (
        SELECT DISTINCT date_part, time_id 
        FROM `northern-shield-437204-m0`.`nyc_taxi`.`dim_time`
    ) dt ON t.lpep_dropoff_datetime = dt.date_part
    WHERE t.vendor_id IS NOT NULL
        AND t.passenger_count IS NOT NULL
        AND (t.trip_distance IS NOT NULL OR t.trip_distance >= 0)
        AND t.fare_amount >= 0
        AND t.extra >= 0
        AND t.mta_tax >= 0
        AND t.tip_amount >= 0
        AND t.improvement_surcharge >= 0
        AND t.total_amount >= 0
)
SELECT 
    trip_id,
    vendor_id,
    pickup_time_id,
    dropoff_time_id,
    rate_code_id,
    pu_location_id,
    do_location_id,
    passenger_count,
    trip_distance,
    fare_amount,
    extra,
    mta_tax,
    tip_amount,
    tolls_amount,
    improvement_surcharge,
    total_amount,
    payment_type,
    trip_type,
    congestion_surcharge
FROM tripdata_cte
    );
  
[0m06:26:53.059708 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:5bebeae8-4d1c-4794-abc8-25c69d307a81&page=queryresults
[0m06:26:53.061319 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Table "numbered_tripdata" must be qualified with a dataset (e.g. dataset.table).; reason: invalid, location: numbered_tripdata, message: Table "numbered_tripdata" must be qualified with a dataset (e.g. dataset.table).')
[0m06:26:54.197460 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:d50bb0eb-f1ae-43e9-ac5f-5458f99c3605&page=queryresults
[0m06:26:54.199216 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:d50bb0eb-f1ae-43e9-ac5f-5458f99c3605&page=queryresults
[0m06:26:54.203423 [debug] [Thread-1  ]: Database Error in model fct_trips (models/transform/fct_trips.sql)
  Table "numbered_tripdata" must be qualified with a dataset (e.g. dataset.table).
  compiled code at target/run/nyc_taxi/models/transform/fct_trips.sql
[0m06:26:54.204669 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '26f52fb7-0de7-4e66-8c58-b67163657219', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c94c08190>]}
[0m06:26:54.206194 [error] [Thread-1  ]: 6 of 6 ERROR creating sql table model nyc_taxi.fct_trips ....................... [[31mERROR[0m in 1.79s]
[0m06:26:54.208296 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.fct_trips
[0m06:26:54.211407 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:26:54.212663 [debug] [MainThread]: Connection 'model.nyc_taxi.fct_trips' was properly closed.
[0m06:26:54.213916 [info ] [MainThread]: 
[0m06:26:54.214931 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 22.56 seconds (22.56s).
[0m06:26:54.218265 [debug] [MainThread]: Command end result
[0m06:26:54.295494 [info ] [MainThread]: 
[0m06:26:54.297159 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m06:26:54.298288 [info ] [MainThread]: 
[0m06:26:54.299609 [error] [MainThread]:   Database Error in model fct_trips (models/transform/fct_trips.sql)
  Table "numbered_tripdata" must be qualified with a dataset (e.g. dataset.table).
  compiled code at target/run/nyc_taxi/models/transform/fct_trips.sql
[0m06:26:54.300688 [info ] [MainThread]: 
[0m06:26:54.301721 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m06:26:54.303614 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 25.563782, "process_in_blocks": "0", "process_kernel_time": 0.351254, "process_mem_max_rss": "239812", "process_out_blocks": "0", "process_user_time": 5.870965}
[0m06:26:54.305084 [debug] [MainThread]: Command `dbt run` failed at 06:26:54.304879 after 25.57 seconds
[0m06:26:54.306186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c9bcda460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c94e23af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c9499a400>]}
[0m06:26:54.307216 [debug] [MainThread]: Flushing usage events
[0m06:30:04.859103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71663fe460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7164235ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7164235a60>]}


============================== 06:30:04.867313 | f5a04ac7-ba53-4182-8fee-b09f8e69f4f4 ==============================
[0m06:30:04.867313 [info ] [MainThread]: Running with dbt=1.8.9
[0m06:30:04.868834 [debug] [MainThread]: running dbt with arguments {'debug': 'False', 'no_print': 'None', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'printer_width': '80', 'empty': 'False', 'use_colors': 'True', 'introspect': 'True', 'quiet': 'False', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/include/dbt/', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'write_json': 'True', 'static_parser': 'True', 'warn_error': 'None', 'cache_selected_only': 'False', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'profiles_dir': '/opt/airflow/include/dbt/', 'target_path': 'None', 'log_format': 'default', 'log_path': '/opt/airflow/include/dbt/logs', 'fail_fast': 'False', 'version_check': 'True'}
[0m06:30:06.039923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f5a04ac7-ba53-4182-8fee-b09f8e69f4f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f712db7f280>]}
[0m06:30:06.121959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f5a04ac7-ba53-4182-8fee-b09f8e69f4f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f712ce056a0>]}
[0m06:30:06.124073 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m06:30:06.303618 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m06:30:06.982162 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m06:30:06.983695 [debug] [MainThread]: Partial parsing: updated file: nyc_taxi://models/transform/fct_trips.sql
[0m06:30:07.395755 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:30:07.397359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'f5a04ac7-ba53-4182-8fee-b09f8e69f4f4', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f715f5c7310>]}
[0m06:30:07.630587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f5a04ac7-ba53-4182-8fee-b09f8e69f4f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f715f366130>]}
[0m06:30:07.807720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f5a04ac7-ba53-4182-8fee-b09f8e69f4f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f715f4e0730>]}
[0m06:30:07.809272 [info ] [MainThread]: Found 6 models, 32 data tests, 2 sources, 600 macros
[0m06:30:07.810488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f5a04ac7-ba53-4182-8fee-b09f8e69f4f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f715f3cf490>]}
[0m06:30:07.814097 [info ] [MainThread]: 
[0m06:30:07.815573 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m06:30:07.822571 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_northern-shield-437204-m0'
[0m06:30:07.823809 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:30:08.568452 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_northern-shield-437204-m0, now list_northern-shield-437204-m0_nyc_taxi)
[0m06:30:08.569950 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:30:09.068674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f5a04ac7-ba53-4182-8fee-b09f8e69f4f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f712dafea60>]}
[0m06:30:09.070227 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m06:30:09.071532 [info ] [MainThread]: 
[0m06:30:09.081075 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_payment
[0m06:30:09.082841 [info ] [Thread-1  ]: 1 of 6 START sql table model nyc_taxi.dim_payment .............................. [RUN]
[0m06:30:09.084257 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_northern-shield-437204-m0_nyc_taxi, now model.nyc_taxi.dim_payment)
[0m06:30:09.085183 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_payment
[0m06:30:09.096948 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_payment"
[0m06:30:09.102489 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_payment
[0m06:30:09.121504 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:30:09.664227 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.dim_payment"
[0m06:30:09.670119 [debug] [Thread-1  ]: On model.nyc_taxi.dim_payment: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.dim_payment"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`dim_payment`
      
    
    

    OPTIONS()
    as (
      WITH payment_cte AS(
    SELECT DISTINCT
        payment_type AS type_id,
        CASE 
            WHEN payment_type = 1 THEN "Credit card"
            WHEN payment_type = 2 THEN "Cash"
            WHEN payment_type = 3 THEN "No charge"
            WHEN payment_type = 4 THEN "Dispute"
            WHEN payment_type = 5 THEN "Unknown"
            WHEN payment_type = 6 THEN "Voided trip"
        END AS payment_name
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata`
)
SELECT
    type_id,
    payment_name
FROM payment_cte
    );
  
[0m06:30:10.197632 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:acc5ade4-4f25-41c4-95f4-0f7a824ded78&page=queryresults
[0m06:30:12.920339 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f5a04ac7-ba53-4182-8fee-b09f8e69f4f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f712dafea60>]}
[0m06:30:12.922028 [info ] [Thread-1  ]: 1 of 6 OK created sql table model nyc_taxi.dim_payment ......................... [[32mCREATE TABLE (4.0 rows, 463.5 KiB processed)[0m in 3.84s]
[0m06:30:12.923643 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_payment
[0m06:30:12.924919 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_ratecode
[0m06:30:12.926198 [info ] [Thread-1  ]: 2 of 6 START sql table model nyc_taxi.dim_ratecode ............................. [RUN]
[0m06:30:12.927382 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_payment, now model.nyc_taxi.dim_ratecode)
[0m06:30:12.928486 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_ratecode
[0m06:30:12.933243 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_ratecode"
[0m06:30:12.939254 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_ratecode
[0m06:30:12.943845 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:30:13.512459 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.dim_ratecode"
[0m06:30:13.517733 [debug] [Thread-1  ]: On model.nyc_taxi.dim_ratecode: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.dim_ratecode"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`dim_ratecode`
      
    
    

    OPTIONS()
    as (
      WITH rate_code_cte AS(
    SELECT DISTINCT
        rate_code_id AS rate_id,
        CASE 
            WHEN rate_code_id = 1 THEN "Standard rate"
            WHEN rate_code_id = 2 THEN "JFK"
            WHEN rate_code_id = 3 THEN "Newark"
            WHEN rate_code_id = 4 THEN "Nassau or Westchester"
            WHEN rate_code_id = 5 THEN "Negotiated fare"
            WHEN rate_code_id = 6 THEN "Group ride"
        ELSE "Unknown"
        END AS rate_code_name
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata`
)
SELECT
    rate_id,
    rate_code_name
FROM rate_code_cte
    );
  
[0m06:30:14.062444 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:34bab276-0068-4230-bb4b-f1fe780c7fbd&page=queryresults
[0m06:30:16.666124 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f5a04ac7-ba53-4182-8fee-b09f8e69f4f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f715f2796a0>]}
[0m06:30:16.667784 [info ] [Thread-1  ]: 2 of 6 OK created sql table model nyc_taxi.dim_ratecode ........................ [[32mCREATE TABLE (6.0 rows, 463.5 KiB processed)[0m in 3.74s]
[0m06:30:16.669794 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_ratecode
[0m06:30:16.671314 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_time
[0m06:30:16.672808 [info ] [Thread-1  ]: 3 of 6 START sql table model nyc_taxi.dim_time ................................. [RUN]
[0m06:30:16.674286 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_ratecode, now model.nyc_taxi.dim_time)
[0m06:30:16.675484 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_time
[0m06:30:16.683128 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_time"
[0m06:30:16.688167 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_time
[0m06:30:16.692320 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:30:17.229942 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.dim_time"
[0m06:30:17.235984 [debug] [Thread-1  ]: On model.nyc_taxi.dim_time: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.dim_time"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`dim_time`
      
    
    

    OPTIONS()
    as (
      WITH datetime_cte AS (
    SELECT DISTINCT
        lpep_pickup_datetime AS datetime_value
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata`
    UNION ALL
    SELECT DISTINCT
        lpep_dropoff_datetime AS datetime_value
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata`
)
SELECT DISTINCT
    ROW_NUMBER() OVER (ORDER BY datetime_value) AS time_id,
    DATE(datetime_value) AS date,
    datetime_value AS date_part,
    EXTRACT(YEAR FROM datetime_value) AS year,
    EXTRACT(MONTH FROM datetime_value) AS month,
    EXTRACT(DAY FROM datetime_value) AS day,
    EXTRACT(HOUR FROM datetime_value) AS hour,
    EXTRACT(MINUTE FROM datetime_value) AS minute,
    FORMAT_TIMESTAMP('%A', datetime_value) AS weekday
FROM datetime_cte
ORDER BY time_id
    );
  
[0m06:30:17.742055 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:81450f03-1d1d-481f-8fa8-acb0286af643&page=queryresults
[0m06:30:21.265734 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f5a04ac7-ba53-4182-8fee-b09f8e69f4f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f715f279520>]}
[0m06:30:21.267196 [info ] [Thread-1  ]: 3 of 6 OK created sql table model nyc_taxi.dim_time ............................ [[32mCREATE TABLE (116.8k rows, 927.0 KiB processed)[0m in 4.59s]
[0m06:30:21.268862 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_time
[0m06:30:21.270343 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_vendor
[0m06:30:21.271690 [info ] [Thread-1  ]: 4 of 6 START sql table model nyc_taxi.dim_vendor ............................... [RUN]
[0m06:30:21.272894 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_time, now model.nyc_taxi.dim_vendor)
[0m06:30:21.274016 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_vendor
[0m06:30:21.278747 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_vendor"
[0m06:30:21.284545 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_vendor
[0m06:30:21.289041 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:30:21.886204 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.dim_vendor"
[0m06:30:21.892445 [debug] [Thread-1  ]: On model.nyc_taxi.dim_vendor: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.dim_vendor"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`dim_vendor`
      
    
    

    OPTIONS()
    as (
      WITH vendor_cte AS(
    SELECT DISTINCT
        vendor_id AS id,
        CASE 
            WHEN vendor_id = 1 THEN "Creative Mobile Technologies"
            WHEN vendor_id = 2 THEN "VeriFone Inc."
        END AS vendor_name
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata`
)
SELECT
    id,
    vendor_name
FROM vendor_cte
    );
  
[0m06:30:22.430279 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:92ea010e-94b2-42f1-a0f5-cdad07416742&page=queryresults
[0m06:30:24.985741 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f5a04ac7-ba53-4182-8fee-b09f8e69f4f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f715f3baa00>]}
[0m06:30:24.987247 [info ] [Thread-1  ]: 4 of 6 OK created sql table model nyc_taxi.dim_vendor .......................... [[32mCREATE TABLE (2.0 rows, 463.5 KiB processed)[0m in 3.71s]
[0m06:30:24.988984 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_vendor
[0m06:30:24.990231 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_zone
[0m06:30:24.991527 [info ] [Thread-1  ]: 5 of 6 START sql table model nyc_taxi.dim_zone ................................. [RUN]
[0m06:30:24.992809 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_vendor, now model.nyc_taxi.dim_zone)
[0m06:30:24.994075 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_zone
[0m06:30:24.999389 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_zone"
[0m06:30:25.004665 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_zone
[0m06:30:25.011637 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:30:25.617837 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.dim_zone"
[0m06:30:25.623223 [debug] [Thread-1  ]: On model.nyc_taxi.dim_zone: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.dim_zone"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`dim_zone`
      
    
    

    OPTIONS()
    as (
      SELECT DISTINCT
    location_id,
    borough,
    zone,
    replace(service_zone, 'Boro', 'Green') as service_zone
FROM `northern-shield-437204-m0`.`nyc_taxi`.`zone_map`
WHERE service_zone is not null
    );
  
[0m06:30:26.109972 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:4390becd-7ed1-416b-b383-d017245aa786&page=queryresults
[0m06:30:28.632408 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f5a04ac7-ba53-4182-8fee-b09f8e69f4f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f715f2791c0>]}
[0m06:30:28.634110 [info ] [Thread-1  ]: 5 of 6 OK created sql table model nyc_taxi.dim_zone ............................ [[32mCREATE TABLE (263.0 rows, 24.2 KiB processed)[0m in 3.64s]
[0m06:30:28.635968 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_zone
[0m06:30:28.637319 [debug] [Thread-1  ]: Began running node model.nyc_taxi.fct_trips
[0m06:30:28.638446 [info ] [Thread-1  ]: 6 of 6 START sql table model nyc_taxi.fct_trips ................................ [RUN]
[0m06:30:28.639552 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_zone, now model.nyc_taxi.fct_trips)
[0m06:30:28.640556 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.fct_trips
[0m06:30:28.647857 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.fct_trips"
[0m06:30:28.652440 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.fct_trips
[0m06:30:28.657641 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.fct_trips"
[0m06:30:28.662978 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:30:28.666497 [debug] [Thread-1  ]: On model.nyc_taxi.fct_trips: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.fct_trips"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips`
      
    
    

    OPTIONS()
    as (
      WITH tripdata_cte AS (
    SELECT 
        to_hex(md5(cast(coalesce(cast(t.vendor_id as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(t.lpep_pickup_datetime as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(t.lpep_dropoff_datetime as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(t.__index_level_0__ as string), '_dbt_utils_surrogate_key_null_') as string))) AS trip_id,
        t.vendor_id,
        pt.time_id AS pickup_time_id,
        dt.time_id AS dropoff_time_id,
        t.rate_code_id,
        t.pu_location_id,
        t.do_location_id,
        t.passenger_count,
        t.trip_distance,
        t.fare_amount,
        t.extra,
        t.mta_tax,
        t.tip_amount,
        t.tolls_amount,
        t.improvement_surcharge,
        t.total_amount,
        t.payment_type,
        t.trip_type,
        t.congestion_surcharge
    FROM green_tripdata AS t
    LEFT JOIN (
        SELECT DISTINCT date_part, time_id 
        FROM `northern-shield-437204-m0`.`nyc_taxi`.`dim_time`
    ) pt ON t.lpep_pickup_datetime = pt.date_part
    LEFT JOIN (
        SELECT DISTINCT date_part, time_id 
        FROM `northern-shield-437204-m0`.`nyc_taxi`.`dim_time`
    ) dt ON t.lpep_dropoff_datetime = dt.date_part
    WHERE t.vendor_id IS NOT NULL
        AND t.passenger_count IS NOT NULL
        AND (t.trip_distance IS NOT NULL OR t.trip_distance >= 0)
        AND t.fare_amount >= 0
        AND t.extra >= 0
        AND t.mta_tax >= 0
        AND t.tip_amount >= 0
        AND t.improvement_surcharge >= 0
        AND t.total_amount >= 0
)
SELECT 
    trip_id,
    vendor_id,
    pickup_time_id,
    dropoff_time_id,
    rate_code_id,
    pu_location_id,
    do_location_id,
    passenger_count,
    trip_distance,
    fare_amount,
    extra,
    mta_tax,
    tip_amount,
    tolls_amount,
    improvement_surcharge,
    total_amount,
    payment_type,
    trip_type,
    congestion_surcharge
FROM tripdata_cte
    );
  
[0m06:30:29.168083 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:efad2600-7992-43cb-9c29-1a782bf80943&page=queryresults
[0m06:30:29.169743 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Table "green_tripdata" must be qualified with a dataset (e.g. dataset.table).; reason: invalid, location: green_tripdata, message: Table "green_tripdata" must be qualified with a dataset (e.g. dataset.table).')
[0m06:30:30.415244 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:8a560c31-cc90-483b-a553-4fa96bd88b0d&page=queryresults
[0m06:30:30.416737 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:8a560c31-cc90-483b-a553-4fa96bd88b0d&page=queryresults
[0m06:30:30.420263 [debug] [Thread-1  ]: Database Error in model fct_trips (models/transform/fct_trips.sql)
  Table "green_tripdata" must be qualified with a dataset (e.g. dataset.table).
  compiled code at target/run/nyc_taxi/models/transform/fct_trips.sql
[0m06:30:30.421301 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f5a04ac7-ba53-4182-8fee-b09f8e69f4f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f715f1f78e0>]}
[0m06:30:30.422673 [error] [Thread-1  ]: 6 of 6 ERROR creating sql table model nyc_taxi.fct_trips ....................... [[31mERROR[0m in 1.78s]
[0m06:30:30.424132 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.fct_trips
[0m06:30:30.426484 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:30:30.427531 [debug] [MainThread]: Connection 'model.nyc_taxi.fct_trips' was properly closed.
[0m06:30:30.428544 [info ] [MainThread]: 
[0m06:30:30.429585 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 22.61 seconds (22.61s).
[0m06:30:30.433072 [debug] [MainThread]: Command end result
[0m06:30:30.504348 [info ] [MainThread]: 
[0m06:30:30.505707 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m06:30:30.506851 [info ] [MainThread]: 
[0m06:30:30.508089 [error] [MainThread]:   Database Error in model fct_trips (models/transform/fct_trips.sql)
  Table "green_tripdata" must be qualified with a dataset (e.g. dataset.table).
  compiled code at target/run/nyc_taxi/models/transform/fct_trips.sql
[0m06:30:30.509167 [info ] [MainThread]: 
[0m06:30:30.510199 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m06:30:30.512051 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 25.762882, "process_in_blocks": "624", "process_kernel_time": 0.245609, "process_mem_max_rss": "233760", "process_out_blocks": "0", "process_user_time": 6.032164}
[0m06:30:30.513409 [debug] [MainThread]: Command `dbt run` failed at 06:30:30.513221 after 25.76 seconds
[0m06:30:30.514430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71663fe460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71649cf310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f712db7f280>]}
[0m06:30:30.515382 [debug] [MainThread]: Flushing usage events
[0m06:31:58.093296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9945e6b400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9943ca3a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9943ca39d0>]}


============================== 06:31:58.100320 | 2e7f0295-db47-4f6f-83da-6ea6da3d936b ==============================
[0m06:31:58.100320 [info ] [MainThread]: Running with dbt=1.8.9
[0m06:31:58.101747 [debug] [MainThread]: running dbt with arguments {'log_path': '/opt/airflow/include/dbt/logs', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'profiles_dir': '/opt/airflow/include/dbt/', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'cache_selected_only': 'False', 'fail_fast': 'False', 'log_format': 'default', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/include/dbt/', 'static_parser': 'True', 'use_experimental_parser': 'False', 'write_json': 'True', 'debug': 'False', 'log_cache_events': 'False', 'version_check': 'True'}
[0m06:31:59.199399 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2e7f0295-db47-4f6f-83da-6ea6da3d936b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9943d44730>]}
[0m06:31:59.261153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2e7f0295-db47-4f6f-83da-6ea6da3d936b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f990c81e430>]}
[0m06:31:59.262751 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m06:31:59.419902 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m06:32:00.091368 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m06:32:00.092934 [debug] [MainThread]: Partial parsing: updated file: nyc_taxi://models/transform/fct_trips.sql
[0m06:32:00.485019 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:32:00.486703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '2e7f0295-db47-4f6f-83da-6ea6da3d936b', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f993ef8c280>]}
[0m06:32:00.714844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2e7f0295-db47-4f6f-83da-6ea6da3d936b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f993ed5edc0>]}
[0m06:32:00.880092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2e7f0295-db47-4f6f-83da-6ea6da3d936b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f993f01d6d0>]}
[0m06:32:00.881286 [info ] [MainThread]: Found 6 models, 32 data tests, 2 sources, 600 macros
[0m06:32:00.882351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2e7f0295-db47-4f6f-83da-6ea6da3d936b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f993ed52e20>]}
[0m06:32:00.885691 [info ] [MainThread]: 
[0m06:32:00.887040 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m06:32:00.893610 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_northern-shield-437204-m0'
[0m06:32:00.894738 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:32:01.493295 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_northern-shield-437204-m0, now list_northern-shield-437204-m0_nyc_taxi)
[0m06:32:01.494907 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:32:01.995531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2e7f0295-db47-4f6f-83da-6ea6da3d936b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f993efc2910>]}
[0m06:32:01.997077 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m06:32:01.998405 [info ] [MainThread]: 
[0m06:32:02.007161 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_payment
[0m06:32:02.008648 [info ] [Thread-1  ]: 1 of 6 START sql table model nyc_taxi.dim_payment .............................. [RUN]
[0m06:32:02.009950 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_northern-shield-437204-m0_nyc_taxi, now model.nyc_taxi.dim_payment)
[0m06:32:02.011341 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_payment
[0m06:32:02.023127 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_payment"
[0m06:32:02.028040 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_payment
[0m06:32:02.047135 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:32:02.676892 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.dim_payment"
[0m06:32:02.681656 [debug] [Thread-1  ]: On model.nyc_taxi.dim_payment: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.dim_payment"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`dim_payment`
      
    
    

    OPTIONS()
    as (
      WITH payment_cte AS(
    SELECT DISTINCT
        payment_type AS type_id,
        CASE 
            WHEN payment_type = 1 THEN "Credit card"
            WHEN payment_type = 2 THEN "Cash"
            WHEN payment_type = 3 THEN "No charge"
            WHEN payment_type = 4 THEN "Dispute"
            WHEN payment_type = 5 THEN "Unknown"
            WHEN payment_type = 6 THEN "Voided trip"
        END AS payment_name
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata`
)
SELECT
    type_id,
    payment_name
FROM payment_cte
    );
  
[0m06:32:03.271581 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:ac233467-f13a-4cfc-a0be-27970bb5077f&page=queryresults
[0m06:32:05.872727 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2e7f0295-db47-4f6f-83da-6ea6da3d936b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f993efc2910>]}
[0m06:32:05.874444 [info ] [Thread-1  ]: 1 of 6 OK created sql table model nyc_taxi.dim_payment ......................... [[32mCREATE TABLE (4.0 rows, 463.5 KiB processed)[0m in 3.86s]
[0m06:32:05.876206 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_payment
[0m06:32:05.877537 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_ratecode
[0m06:32:05.878706 [info ] [Thread-1  ]: 2 of 6 START sql table model nyc_taxi.dim_ratecode ............................. [RUN]
[0m06:32:05.879849 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_payment, now model.nyc_taxi.dim_ratecode)
[0m06:32:05.880856 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_ratecode
[0m06:32:05.885303 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_ratecode"
[0m06:32:05.891022 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_ratecode
[0m06:32:05.895578 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:32:06.415803 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.dim_ratecode"
[0m06:32:06.422253 [debug] [Thread-1  ]: On model.nyc_taxi.dim_ratecode: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.dim_ratecode"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`dim_ratecode`
      
    
    

    OPTIONS()
    as (
      WITH rate_code_cte AS(
    SELECT DISTINCT
        rate_code_id AS rate_id,
        CASE 
            WHEN rate_code_id = 1 THEN "Standard rate"
            WHEN rate_code_id = 2 THEN "JFK"
            WHEN rate_code_id = 3 THEN "Newark"
            WHEN rate_code_id = 4 THEN "Nassau or Westchester"
            WHEN rate_code_id = 5 THEN "Negotiated fare"
            WHEN rate_code_id = 6 THEN "Group ride"
        ELSE "Unknown"
        END AS rate_code_name
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata`
)
SELECT
    rate_id,
    rate_code_name
FROM rate_code_cte
    );
  
[0m06:32:06.938137 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:7abbd3f0-ec0f-4cea-9379-a84e0fb3fb1f&page=queryresults
[0m06:32:09.755995 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2e7f0295-db47-4f6f-83da-6ea6da3d936b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f993ec6eca0>]}
[0m06:32:09.757548 [info ] [Thread-1  ]: 2 of 6 OK created sql table model nyc_taxi.dim_ratecode ........................ [[32mCREATE TABLE (6.0 rows, 463.5 KiB processed)[0m in 3.88s]
[0m06:32:09.759256 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_ratecode
[0m06:32:09.760585 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_time
[0m06:32:09.761775 [info ] [Thread-1  ]: 3 of 6 START sql table model nyc_taxi.dim_time ................................. [RUN]
[0m06:32:09.762959 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_ratecode, now model.nyc_taxi.dim_time)
[0m06:32:09.763946 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_time
[0m06:32:09.770469 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_time"
[0m06:32:09.776152 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_time
[0m06:32:09.780677 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:32:10.331361 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.dim_time"
[0m06:32:10.337437 [debug] [Thread-1  ]: On model.nyc_taxi.dim_time: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.dim_time"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`dim_time`
      
    
    

    OPTIONS()
    as (
      WITH datetime_cte AS (
    SELECT DISTINCT
        lpep_pickup_datetime AS datetime_value
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata`
    UNION ALL
    SELECT DISTINCT
        lpep_dropoff_datetime AS datetime_value
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata`
)
SELECT DISTINCT
    ROW_NUMBER() OVER (ORDER BY datetime_value) AS time_id,
    DATE(datetime_value) AS date,
    datetime_value AS date_part,
    EXTRACT(YEAR FROM datetime_value) AS year,
    EXTRACT(MONTH FROM datetime_value) AS month,
    EXTRACT(DAY FROM datetime_value) AS day,
    EXTRACT(HOUR FROM datetime_value) AS hour,
    EXTRACT(MINUTE FROM datetime_value) AS minute,
    FORMAT_TIMESTAMP('%A', datetime_value) AS weekday
FROM datetime_cte
ORDER BY time_id
    );
  
[0m06:32:10.801145 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:64a5c242-3160-4931-9da9-985451fd4732&page=queryresults
[0m06:32:14.258366 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2e7f0295-db47-4f6f-83da-6ea6da3d936b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f993efc2910>]}
[0m06:32:14.260049 [info ] [Thread-1  ]: 3 of 6 OK created sql table model nyc_taxi.dim_time ............................ [[32mCREATE TABLE (116.8k rows, 927.0 KiB processed)[0m in 4.50s]
[0m06:32:14.261859 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_time
[0m06:32:14.263232 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_vendor
[0m06:32:14.264821 [info ] [Thread-1  ]: 4 of 6 START sql table model nyc_taxi.dim_vendor ............................... [RUN]
[0m06:32:14.265991 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_time, now model.nyc_taxi.dim_vendor)
[0m06:32:14.267035 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_vendor
[0m06:32:14.271800 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_vendor"
[0m06:32:14.277092 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_vendor
[0m06:32:14.281524 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:32:14.814197 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.dim_vendor"
[0m06:32:14.819432 [debug] [Thread-1  ]: On model.nyc_taxi.dim_vendor: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.dim_vendor"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`dim_vendor`
      
    
    

    OPTIONS()
    as (
      WITH vendor_cte AS(
    SELECT DISTINCT
        vendor_id AS id,
        CASE 
            WHEN vendor_id = 1 THEN "Creative Mobile Technologies"
            WHEN vendor_id = 2 THEN "VeriFone Inc."
        END AS vendor_name
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata`
)
SELECT
    id,
    vendor_name
FROM vendor_cte
    );
  
[0m06:32:15.271164 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:a9cc438b-81d8-4ac7-a134-2a0c879a4da8&page=queryresults
[0m06:32:17.819730 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2e7f0295-db47-4f6f-83da-6ea6da3d936b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f993efc2910>]}
[0m06:32:17.821980 [info ] [Thread-1  ]: 4 of 6 OK created sql table model nyc_taxi.dim_vendor .......................... [[32mCREATE TABLE (2.0 rows, 463.5 KiB processed)[0m in 3.55s]
[0m06:32:17.823959 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_vendor
[0m06:32:17.825809 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_zone
[0m06:32:17.827435 [info ] [Thread-1  ]: 5 of 6 START sql table model nyc_taxi.dim_zone ................................. [RUN]
[0m06:32:17.828969 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_vendor, now model.nyc_taxi.dim_zone)
[0m06:32:17.830390 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_zone
[0m06:32:17.836403 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_zone"
[0m06:32:17.842200 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_zone
[0m06:32:17.850507 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:32:18.361781 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.dim_zone"
[0m06:32:18.366896 [debug] [Thread-1  ]: On model.nyc_taxi.dim_zone: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.dim_zone"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`dim_zone`
      
    
    

    OPTIONS()
    as (
      SELECT DISTINCT
    location_id,
    borough,
    zone,
    replace(service_zone, 'Boro', 'Green') as service_zone
FROM `northern-shield-437204-m0`.`nyc_taxi`.`zone_map`
WHERE service_zone is not null
    );
  
[0m06:32:18.888873 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:e43d83c9-2e39-431e-ad9d-aac1fd8fa28f&page=queryresults
[0m06:32:21.996966 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2e7f0295-db47-4f6f-83da-6ea6da3d936b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f993ec6ea30>]}
[0m06:32:21.998644 [info ] [Thread-1  ]: 5 of 6 OK created sql table model nyc_taxi.dim_zone ............................ [[32mCREATE TABLE (263.0 rows, 24.2 KiB processed)[0m in 4.17s]
[0m06:32:22.000556 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_zone
[0m06:32:22.002155 [debug] [Thread-1  ]: Began running node model.nyc_taxi.fct_trips
[0m06:32:22.003811 [info ] [Thread-1  ]: 6 of 6 START sql table model nyc_taxi.fct_trips ................................ [RUN]
[0m06:32:22.005245 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_zone, now model.nyc_taxi.fct_trips)
[0m06:32:22.006458 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.fct_trips
[0m06:32:22.014719 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.fct_trips"
[0m06:32:22.019641 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.fct_trips
[0m06:32:22.025461 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.fct_trips"
[0m06:32:22.030419 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:32:22.033822 [debug] [Thread-1  ]: On model.nyc_taxi.fct_trips: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.fct_trips"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips`
      
    
    

    OPTIONS()
    as (
      WITH tripdata_cte AS (
    SELECT 
        to_hex(md5(cast(coalesce(cast(t.vendor_id as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(t.lpep_pickup_datetime as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(t.lpep_dropoff_datetime as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(t.__index_level_0__ as string), '_dbt_utils_surrogate_key_null_') as string))) AS trip_id,
        t.vendor_id,
        pt.time_id AS pickup_time_id,
        dt.time_id AS dropoff_time_id,
        t.rate_code_id,
        t.pu_location_id,
        t.do_location_id,
        t.passenger_count,
        t.trip_distance,
        t.fare_amount,
        t.extra,
        t.mta_tax,
        t.tip_amount,
        t.tolls_amount,
        t.improvement_surcharge,
        t.total_amount,
        t.payment_type,
        t.trip_type,
        t.congestion_surcharge
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata` AS t
    LEFT JOIN (
        SELECT DISTINCT date_part, time_id 
        FROM `northern-shield-437204-m0`.`nyc_taxi`.`dim_time`
    ) pt ON t.lpep_pickup_datetime = pt.date_part
    LEFT JOIN (
        SELECT DISTINCT date_part, time_id 
        FROM `northern-shield-437204-m0`.`nyc_taxi`.`dim_time`
    ) dt ON t.lpep_dropoff_datetime = dt.date_part
    WHERE t.vendor_id IS NOT NULL
        AND t.passenger_count IS NOT NULL
        AND (t.trip_distance IS NOT NULL OR t.trip_distance >= 0)
        AND t.fare_amount >= 0
        AND t.extra >= 0
        AND t.mta_tax >= 0
        AND t.tip_amount >= 0
        AND t.improvement_surcharge >= 0
        AND t.total_amount >= 0
)
SELECT 
    trip_id,
    vendor_id,
    pickup_time_id,
    dropoff_time_id,
    rate_code_id,
    pu_location_id,
    do_location_id,
    passenger_count,
    trip_distance,
    fare_amount,
    extra,
    mta_tax,
    tip_amount,
    tolls_amount,
    improvement_surcharge,
    total_amount,
    payment_type,
    trip_type,
    congestion_surcharge
FROM tripdata_cte
    );
  
[0m06:32:22.736665 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:c4cef8a4-118f-42f4-9d59-fc46f34747eb&page=queryresults
[0m06:32:26.343966 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2e7f0295-db47-4f6f-83da-6ea6da3d936b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f993ec6ea90>]}
[0m06:32:26.345822 [info ] [Thread-1  ]: 6 of 6 OK created sql table model nyc_taxi.fct_trips ........................... [[32mCREATE TABLE (63.0k rows, 10.4 MiB processed)[0m in 4.34s]
[0m06:32:26.348064 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.fct_trips
[0m06:32:26.350963 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:32:26.351945 [debug] [MainThread]: Connection 'model.nyc_taxi.fct_trips' was properly closed.
[0m06:32:26.353192 [info ] [MainThread]: 
[0m06:32:26.354542 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 25.47 seconds (25.47s).
[0m06:32:26.358975 [debug] [MainThread]: Command end result
[0m06:32:26.432585 [info ] [MainThread]: 
[0m06:32:26.434087 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:32:26.435338 [info ] [MainThread]: 
[0m06:32:26.436501 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m06:32:26.438496 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 28.460241, "process_in_blocks": "0", "process_kernel_time": 0.283859, "process_mem_max_rss": "245820", "process_out_blocks": "0", "process_user_time": 5.890078}
[0m06:32:26.439929 [debug] [MainThread]: Command `dbt run` succeeded at 06:32:26.439716 after 28.46 seconds
[0m06:32:26.441001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9945e6b400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f993ed46af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f993ed46790>]}
[0m06:32:26.441954 [debug] [MainThread]: Flushing usage events
[0m08:40:18.966598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7effe1a8bf70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7effdf8619d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7effdf861970>]}


============================== 08:40:18.986028 | 22158063-89d4-488a-b2e1-976202fd03e8 ==============================
[0m08:40:18.986028 [info ] [MainThread]: Running with dbt=1.8.9
[0m08:40:18.989840 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'debug': 'False', 'static_parser': 'True', 'target_path': 'None', 'indirect_selection': 'eager', 'printer_width': '80', 'fail_fast': 'False', 'warn_error': 'None', 'empty': 'False', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/include/dbt/', 'use_colors': 'True', 'partial_parse': 'True', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'quiet': 'False', 'write_json': 'True', 'introspect': 'True', 'profiles_dir': '/opt/airflow/include/dbt/', 'log_path': '/opt/airflow/include/dbt/logs', 'no_print': 'None', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'version_check': 'True', 'log_cache_events': 'False'}
[0m08:40:22.473701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '22158063-89d4-488a-b2e1-976202fd03e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7effe31341f0>]}
[0m08:40:22.636668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '22158063-89d4-488a-b2e1-976202fd03e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7effdf900160>]}
[0m08:40:22.640732 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m08:40:23.111411 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m08:40:25.606640 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m08:40:25.611555 [debug] [MainThread]: Partial parsing: updated file: nyc_taxi://models/transform/fct_trips.sql
[0m08:40:25.615467 [debug] [MainThread]: Partial parsing: updated file: nyc_taxi://models/transform/dim_time.sql
[0m08:40:26.215621 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m08:40:26.219275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '22158063-89d4-488a-b2e1-976202fd03e8', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7effdabcf4c0>]}
[0m08:40:27.120182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '22158063-89d4-488a-b2e1-976202fd03e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7effd7122130>]}
[0m08:40:27.680031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '22158063-89d4-488a-b2e1-976202fd03e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7effdac24880>]}
[0m08:40:27.683906 [info ] [MainThread]: Found 6 models, 32 data tests, 2 sources, 600 macros
[0m08:40:27.687132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '22158063-89d4-488a-b2e1-976202fd03e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7effd71041c0>]}
[0m08:40:27.695849 [info ] [MainThread]: 
[0m08:40:27.701299 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m08:40:27.719423 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_northern-shield-437204-m0'
[0m08:40:27.722571 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:40:28.463876 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_northern-shield-437204-m0, now list_northern-shield-437204-m0_nyc_taxi)
[0m08:40:28.467363 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:40:29.083651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '22158063-89d4-488a-b2e1-976202fd03e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7effd71e02e0>]}
[0m08:40:29.087734 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:40:29.091306 [info ] [MainThread]: 
[0m08:40:29.118509 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_payment
[0m08:40:29.123028 [info ] [Thread-1  ]: 1 of 6 START sql table model nyc_taxi.dim_payment .............................. [RUN]
[0m08:40:29.127144 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_northern-shield-437204-m0_nyc_taxi, now model.nyc_taxi.dim_payment)
[0m08:40:29.130799 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_payment
[0m08:40:29.162236 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_payment"
[0m08:40:29.181133 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_payment
[0m08:40:29.227678 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m08:40:30.002323 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.dim_payment"
[0m08:40:30.025053 [debug] [Thread-1  ]: On model.nyc_taxi.dim_payment: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.dim_payment"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`dim_payment`
      
    
    

    OPTIONS()
    as (
      WITH payment_cte AS(
    SELECT DISTINCT
        payment_type AS type_id,
        CASE 
            WHEN payment_type = 1 THEN "Credit card"
            WHEN payment_type = 2 THEN "Cash"
            WHEN payment_type = 3 THEN "No charge"
            WHEN payment_type = 4 THEN "Dispute"
            WHEN payment_type = 5 THEN "Unknown"
            WHEN payment_type = 6 THEN "Voided trip"
        END AS payment_name
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata`
)
SELECT
    type_id,
    payment_name
FROM payment_cte
    );
  
[0m08:40:30.861676 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:ee5ccfe5-71cb-4db3-ab9e-b6cc9b8f58eb&page=queryresults
[0m08:40:33.205273 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '22158063-89d4-488a-b2e1-976202fd03e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7effe109f3d0>]}
[0m08:40:33.209512 [info ] [Thread-1  ]: 1 of 6 OK created sql table model nyc_taxi.dim_payment ......................... [[32mCREATE TABLE (4.0 rows, 463.5 KiB processed)[0m in 4.08s]
[0m08:40:33.214999 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_payment
[0m08:40:33.219768 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_ratecode
[0m08:40:33.223269 [info ] [Thread-1  ]: 2 of 6 START sql table model nyc_taxi.dim_ratecode ............................. [RUN]
[0m08:40:33.227028 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_payment, now model.nyc_taxi.dim_ratecode)
[0m08:40:33.231444 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_ratecode
[0m08:40:33.251015 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_ratecode"
[0m08:40:33.273478 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_ratecode
[0m08:40:33.285309 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m08:40:33.895733 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.dim_ratecode"
[0m08:40:33.918368 [debug] [Thread-1  ]: On model.nyc_taxi.dim_ratecode: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.dim_ratecode"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`dim_ratecode`
      
    
    

    OPTIONS()
    as (
      WITH rate_code_cte AS(
    SELECT DISTINCT
        rate_code_id AS rate_id,
        CASE 
            WHEN rate_code_id = 1 THEN "Standard rate"
            WHEN rate_code_id = 2 THEN "JFK"
            WHEN rate_code_id = 3 THEN "Newark"
            WHEN rate_code_id = 4 THEN "Nassau or Westchester"
            WHEN rate_code_id = 5 THEN "Negotiated fare"
            WHEN rate_code_id = 6 THEN "Group ride"
        ELSE "Unknown"
        END AS rate_code_name
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata`
)
SELECT
    rate_id,
    rate_code_name
FROM rate_code_cte
    );
  
[0m08:40:34.525206 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:2da097ee-1003-4986-b4d0-9a40737d2580&page=queryresults
[0m08:40:37.031598 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '22158063-89d4-488a-b2e1-976202fd03e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7effd7151340>]}
[0m08:40:37.036168 [info ] [Thread-1  ]: 2 of 6 OK created sql table model nyc_taxi.dim_ratecode ........................ [[32mCREATE TABLE (6.0 rows, 463.5 KiB processed)[0m in 3.80s]
[0m08:40:37.043999 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_ratecode
[0m08:40:37.048375 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_time
[0m08:40:37.052304 [info ] [Thread-1  ]: 3 of 6 START sql table model nyc_taxi.dim_time ................................. [RUN]
[0m08:40:37.056539 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_ratecode, now model.nyc_taxi.dim_time)
[0m08:40:37.060087 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_time
[0m08:40:37.077337 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_time"
[0m08:40:37.099360 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_time
[0m08:40:37.117761 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.dim_time"
[0m08:40:37.138347 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m08:40:37.149258 [debug] [Thread-1  ]: On model.nyc_taxi.dim_time: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.dim_time"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`dim_time`
      
    
    

    OPTIONS()
    as (
      WITH datetime_cte AS (
    SELECT DISTINCT
        lpep_pickup_datetime AS datetime_value
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata`
    UNION
    SELECT DISTINCT
        lpep_dropoff_datetime AS datetime_value
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata`
)
SELECT DISTINCT
    ROW_NUMBER() OVER (ORDER BY datetime_value) AS time_id,
    DATE(datetime_value) AS date,
    datetime_value AS date_part,
    EXTRACT(YEAR FROM datetime_value) AS year,
    EXTRACT(MONTH FROM datetime_value) AS month,
    EXTRACT(DAY FROM datetime_value) AS day,
    EXTRACT(HOUR FROM datetime_value) AS hour,
    EXTRACT(MINUTE FROM datetime_value) AS minute,
    FORMAT_TIMESTAMP('%A', datetime_value) AS weekday
FROM datetime_cte
ORDER BY time_id
    );
  
[0m08:40:37.744347 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:ff461f32-c2f8-488b-8976-2c5c0c86d3bf&page=queryresults
[0m08:40:37.748307 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected keyword ALL or keyword DISTINCT but got keyword SELECT at [18:5]; reason: invalidQuery, location: query, message: Syntax error: Expected keyword ALL or keyword DISTINCT but got keyword SELECT at [18:5]')
[0m08:40:38.805820 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:b7e7a2d2-833f-479b-8a79-0cb31fd3b0d9&page=queryresults
[0m08:40:38.811275 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:b7e7a2d2-833f-479b-8a79-0cb31fd3b0d9&page=queryresults
[0m08:40:38.841109 [debug] [Thread-1  ]: Database Error in model dim_time (models/transform/dim_time.sql)
  Syntax error: Expected keyword ALL or keyword DISTINCT but got keyword SELECT at [18:5]
  compiled code at target/run/nyc_taxi/models/transform/dim_time.sql
[0m08:40:38.844456 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '22158063-89d4-488a-b2e1-976202fd03e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7effd2f2cdc0>]}
[0m08:40:38.848539 [error] [Thread-1  ]: 3 of 6 ERROR creating sql table model nyc_taxi.dim_time ........................ [[31mERROR[0m in 1.79s]
[0m08:40:38.853336 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_time
[0m08:40:38.856846 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_vendor
[0m08:40:38.861936 [info ] [Thread-1  ]: 4 of 6 START sql table model nyc_taxi.dim_vendor ............................... [RUN]
[0m08:40:38.866250 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_time, now model.nyc_taxi.dim_vendor)
[0m08:40:38.869172 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_vendor
[0m08:40:38.883343 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_vendor"
[0m08:40:38.904034 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_vendor
[0m08:40:38.920983 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m08:40:39.542112 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.dim_vendor"
[0m08:40:39.561701 [debug] [Thread-1  ]: On model.nyc_taxi.dim_vendor: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.dim_vendor"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`dim_vendor`
      
    
    

    OPTIONS()
    as (
      WITH vendor_cte AS(
    SELECT DISTINCT
        vendor_id AS id,
        CASE 
            WHEN vendor_id = 1 THEN "Creative Mobile Technologies"
            WHEN vendor_id = 2 THEN "VeriFone Inc."
        END AS vendor_name
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata`
)
SELECT
    id,
    vendor_name
FROM vendor_cte
    );
  
[0m08:40:40.134320 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:f78ab4b3-e22d-4bce-8f37-f1bb32097c5a&page=queryresults
[0m08:40:42.685410 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '22158063-89d4-488a-b2e1-976202fd03e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7effd2f29040>]}
[0m08:40:42.690119 [info ] [Thread-1  ]: 4 of 6 OK created sql table model nyc_taxi.dim_vendor .......................... [[32mCREATE TABLE (2.0 rows, 463.5 KiB processed)[0m in 3.82s]
[0m08:40:42.696748 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_vendor
[0m08:40:42.701511 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_zone
[0m08:40:42.705448 [info ] [Thread-1  ]: 5 of 6 START sql table model nyc_taxi.dim_zone ................................. [RUN]
[0m08:40:42.710004 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_vendor, now model.nyc_taxi.dim_zone)
[0m08:40:42.717496 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_zone
[0m08:40:42.735212 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_zone"
[0m08:40:42.756564 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_zone
[0m08:40:42.768843 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m08:40:43.408482 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.dim_zone"
[0m08:40:43.430064 [debug] [Thread-1  ]: On model.nyc_taxi.dim_zone: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.dim_zone"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`dim_zone`
      
    
    

    OPTIONS()
    as (
      SELECT DISTINCT
    location_id,
    borough,
    zone,
    replace(service_zone, 'Boro', 'Green') as service_zone
FROM `northern-shield-437204-m0`.`nyc_taxi`.`zone_map`
WHERE service_zone is not null
    );
  
[0m08:40:44.033451 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:98fa17c3-a884-4912-9715-9f80cedab8b5&page=queryresults
[0m08:40:46.442192 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '22158063-89d4-488a-b2e1-976202fd03e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7effac47a100>]}
[0m08:40:46.446513 [info ] [Thread-1  ]: 5 of 6 OK created sql table model nyc_taxi.dim_zone ............................ [[32mCREATE TABLE (263.0 rows, 24.2 KiB processed)[0m in 3.73s]
[0m08:40:46.453423 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_zone
[0m08:40:46.458104 [debug] [Thread-1  ]: Began running node model.nyc_taxi.fct_trips
[0m08:40:46.461783 [info ] [Thread-1  ]: 6 of 6 SKIP relation nyc_taxi.fct_trips ........................................ [[33mSKIP[0m]
[0m08:40:46.465749 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.fct_trips
[0m08:40:46.473542 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:40:46.476799 [debug] [MainThread]: Connection 'model.nyc_taxi.dim_zone' was properly closed.
[0m08:40:46.480173 [info ] [MainThread]: 
[0m08:40:46.488603 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 18.78 seconds (18.78s).
[0m08:40:46.498221 [debug] [MainThread]: Command end result
[0m08:40:46.716422 [info ] [MainThread]: 
[0m08:40:46.719710 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m08:40:46.722890 [info ] [MainThread]: 
[0m08:40:46.726582 [error] [MainThread]:   Database Error in model dim_time (models/transform/dim_time.sql)
  Syntax error: Expected keyword ALL or keyword DISTINCT but got keyword SELECT at [18:5]
  compiled code at target/run/nyc_taxi/models/transform/dim_time.sql
[0m08:40:46.730507 [info ] [MainThread]: 
[0m08:40:46.733691 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=1 TOTAL=6
[0m08:40:46.738215 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 28.542603, "process_in_blocks": "968", "process_kernel_time": 1.579416, "process_mem_max_rss": "234740", "process_out_blocks": "0", "process_user_time": 13.797542}
[0m08:40:46.742043 [debug] [MainThread]: Command `dbt run` failed at 08:40:46.741542 after 28.55 seconds
[0m08:40:46.745457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7effe1a8bf70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7effe31341f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7effd71e53a0>]}
[0m08:40:46.748637 [debug] [MainThread]: Flushing usage events
[0m09:01:50.139080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff47a2e5430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff47811da60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff47811da00>]}


============================== 09:01:50.161456 | 31b6420f-b94a-429c-80f1-6bda5245ee7e ==============================
[0m09:01:50.161456 [info ] [MainThread]: Running with dbt=1.8.9
[0m09:01:50.165279 [debug] [MainThread]: running dbt with arguments {'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'printer_width': '80', 'introspect': 'True', 'log_format': 'default', 'log_cache_events': 'False', 'debug': 'False', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'warn_error': 'None', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/include/dbt/', 'profiles_dir': '/opt/airflow/include/dbt/', 'version_check': 'True', 'empty': 'False', 'target_path': 'None', 'log_path': '/opt/airflow/include/dbt/logs', 'no_print': 'None', 'quiet': 'False', 'write_json': 'True', 'partial_parse': 'True', 'fail_fast': 'False'}
[0m09:01:53.495253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '31b6420f-b94a-429c-80f1-6bda5245ee7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff479b2f100>]}
[0m09:01:53.654396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '31b6420f-b94a-429c-80f1-6bda5245ee7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff440c9fa00>]}
[0m09:01:53.658338 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m09:01:54.135779 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m09:01:57.346456 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:01:57.352114 [debug] [MainThread]: Partial parsing: updated file: nyc_taxi://models/transform/dim_time.sql
[0m09:01:58.192332 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m09:01:58.197768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '31b6420f-b94a-429c-80f1-6bda5245ee7e', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4733c9a90>]}
[0m09:01:58.889435 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '31b6420f-b94a-429c-80f1-6bda5245ee7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff47011d130>]}
[0m09:01:59.385587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '31b6420f-b94a-429c-80f1-6bda5245ee7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff473424a00>]}
[0m09:01:59.389530 [info ] [MainThread]: Found 6 models, 32 data tests, 2 sources, 600 macros
[0m09:01:59.392479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '31b6420f-b94a-429c-80f1-6bda5245ee7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4700bc160>]}
[0m09:01:59.401144 [info ] [MainThread]: 
[0m09:01:59.404860 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m09:01:59.422170 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_northern-shield-437204-m0'
[0m09:01:59.425741 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:02:00.250052 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_northern-shield-437204-m0, now list_northern-shield-437204-m0_nyc_taxi)
[0m09:02:00.253714 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:02:01.193773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '31b6420f-b94a-429c-80f1-6bda5245ee7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4799ef4c0>]}
[0m09:02:01.197929 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:02:01.201856 [info ] [MainThread]: 
[0m09:02:01.227486 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_payment
[0m09:02:01.232585 [info ] [Thread-1  ]: 1 of 6 START sql table model nyc_taxi.dim_payment .............................. [RUN]
[0m09:02:01.237781 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_northern-shield-437204-m0_nyc_taxi, now model.nyc_taxi.dim_payment)
[0m09:02:01.241369 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_payment
[0m09:02:01.274616 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_payment"
[0m09:02:01.298515 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_payment
[0m09:02:01.352498 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m09:02:01.385645 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.dim_payment"
[0m09:02:01.416654 [debug] [Thread-1  ]: On model.nyc_taxi.dim_payment: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.dim_payment"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`dim_payment`
      
    
    

    OPTIONS()
    as (
      WITH payment_cte AS(
    SELECT DISTINCT
        payment_type AS type_id,
        CASE 
            WHEN payment_type = 1 THEN "Credit card"
            WHEN payment_type = 2 THEN "Cash"
            WHEN payment_type = 3 THEN "No charge"
            WHEN payment_type = 4 THEN "Dispute"
            WHEN payment_type = 5 THEN "Unknown"
            WHEN payment_type = 6 THEN "Voided trip"
        END AS payment_name
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata`
)
SELECT
    type_id,
    payment_name
FROM payment_cte
    );
  
[0m09:02:02.081286 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:31bcb7d0-07b1-41c0-885e-3fc9fb8f7727&page=queryresults
[0m09:02:05.252153 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '31b6420f-b94a-429c-80f1-6bda5245ee7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff479956a30>]}
[0m09:02:05.257133 [info ] [Thread-1  ]: 1 of 6 OK created sql table model nyc_taxi.dim_payment ......................... [[32mCREATE TABLE (4.0 rows, 463.5 KiB processed)[0m in 4.01s]
[0m09:02:05.261667 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_payment
[0m09:02:05.266218 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_ratecode
[0m09:02:05.269637 [info ] [Thread-1  ]: 2 of 6 START sql table model nyc_taxi.dim_ratecode ............................. [RUN]
[0m09:02:05.273489 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_payment, now model.nyc_taxi.dim_ratecode)
[0m09:02:05.277129 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_ratecode
[0m09:02:05.290559 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_ratecode"
[0m09:02:05.319206 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_ratecode
[0m09:02:05.330538 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m09:02:06.072447 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.dim_ratecode"
[0m09:02:06.102604 [debug] [Thread-1  ]: On model.nyc_taxi.dim_ratecode: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.dim_ratecode"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`dim_ratecode`
      
    
    

    OPTIONS()
    as (
      WITH rate_code_cte AS(
    SELECT DISTINCT
        rate_code_id AS rate_id,
        CASE 
            WHEN rate_code_id = 1 THEN "Standard rate"
            WHEN rate_code_id = 2 THEN "JFK"
            WHEN rate_code_id = 3 THEN "Newark"
            WHEN rate_code_id = 4 THEN "Nassau or Westchester"
            WHEN rate_code_id = 5 THEN "Negotiated fare"
            WHEN rate_code_id = 6 THEN "Group ride"
        ELSE "Unknown"
        END AS rate_code_name
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata`
)
SELECT
    rate_id,
    rate_code_name
FROM rate_code_cte
    );
  
[0m09:02:06.690482 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:09b1ac1a-90b6-4607-b0e8-435bd41ebfa0&page=queryresults
[0m09:02:09.207039 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '31b6420f-b94a-429c-80f1-6bda5245ee7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff47355d310>]}
[0m09:02:09.211324 [info ] [Thread-1  ]: 2 of 6 OK created sql table model nyc_taxi.dim_ratecode ........................ [[32mCREATE TABLE (6.0 rows, 463.5 KiB processed)[0m in 3.93s]
[0m09:02:09.216276 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_ratecode
[0m09:02:09.220178 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_time
[0m09:02:09.223795 [info ] [Thread-1  ]: 3 of 6 START sql table model nyc_taxi.dim_time ................................. [RUN]
[0m09:02:09.230130 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_ratecode, now model.nyc_taxi.dim_time)
[0m09:02:09.233868 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_time
[0m09:02:09.248997 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_time"
[0m09:02:09.271103 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_time
[0m09:02:09.293623 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.dim_time"
[0m09:02:09.315774 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m09:02:09.326691 [debug] [Thread-1  ]: On model.nyc_taxi.dim_time: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.dim_time"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`dim_time`
      
    
    

    OPTIONS()
    as (
      WITH datetime_cte AS (
    SELECT DISTINCT
        lpep_pickup_datetime AS datetime_value
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata`
    UNION
    SELECT DISTINCT
        lpep_dropoff_datetime AS datetime_value
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata`
),
datetime_cte_distinct AS(
    SELECT DISTINCT
        datetime_value
    FROM datetime_cte
)
SELECT
    ROW_NUMBER() OVER (ORDER BY datetime_value) AS time_id,
    DATE(datetime_value) AS date,
    datetime_value AS date_part,
    EXTRACT(YEAR FROM datetime_value) AS year,
    EXTRACT(MONTH FROM datetime_value) AS month,
    EXTRACT(DAY FROM datetime_value) AS day,
    EXTRACT(HOUR FROM datetime_value) AS hour,
    EXTRACT(MINUTE FROM datetime_value) AS minute,
    FORMAT_TIMESTAMP('%A', datetime_value) AS weekday
FROM datetime_cte_distinct
ORDER BY time_id
    );
  
[0m09:02:09.937822 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:0defb486-3c4e-456f-9b4b-42d30e02e58c&page=queryresults
[0m09:02:09.942726 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected keyword ALL or keyword DISTINCT but got keyword SELECT at [18:5]; reason: invalidQuery, location: query, message: Syntax error: Expected keyword ALL or keyword DISTINCT but got keyword SELECT at [18:5]')
[0m09:02:10.531752 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:b1ad76fe-f49d-451c-95fe-e00bf3fb625f&page=queryresults
[0m09:02:10.535816 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:b1ad76fe-f49d-451c-95fe-e00bf3fb625f&page=queryresults
[0m09:02:10.546029 [debug] [Thread-1  ]: Database Error in model dim_time (models/transform/dim_time.sql)
  Syntax error: Expected keyword ALL or keyword DISTINCT but got keyword SELECT at [18:5]
  compiled code at target/run/nyc_taxi/models/transform/dim_time.sql
[0m09:02:10.549251 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '31b6420f-b94a-429c-80f1-6bda5245ee7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff46d952580>]}
[0m09:02:10.553480 [error] [Thread-1  ]: 3 of 6 ERROR creating sql table model nyc_taxi.dim_time ........................ [[31mERROR[0m in 1.32s]
[0m09:02:10.557841 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_time
[0m09:02:10.562602 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_vendor
[0m09:02:10.566977 [info ] [Thread-1  ]: 4 of 6 START sql table model nyc_taxi.dim_vendor ............................... [RUN]
[0m09:02:10.570516 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_time, now model.nyc_taxi.dim_vendor)
[0m09:02:10.574206 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_vendor
[0m09:02:10.588660 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_vendor"
[0m09:02:10.610850 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_vendor
[0m09:02:10.624212 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m09:02:11.255475 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.dim_vendor"
[0m09:02:11.281534 [debug] [Thread-1  ]: On model.nyc_taxi.dim_vendor: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.dim_vendor"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`dim_vendor`
      
    
    

    OPTIONS()
    as (
      WITH vendor_cte AS(
    SELECT DISTINCT
        vendor_id AS id,
        CASE 
            WHEN vendor_id = 1 THEN "Creative Mobile Technologies"
            WHEN vendor_id = 2 THEN "VeriFone Inc."
        END AS vendor_name
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata`
)
SELECT
    id,
    vendor_name
FROM vendor_cte
    );
  
[0m09:02:11.942815 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:fb6b58af-b083-4cc5-8a51-42d6cda57d4c&page=queryresults
[0m09:02:15.075404 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '31b6420f-b94a-429c-80f1-6bda5245ee7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff46d966af0>]}
[0m09:02:15.080100 [info ] [Thread-1  ]: 4 of 6 OK created sql table model nyc_taxi.dim_vendor .......................... [[32mCREATE TABLE (2.0 rows, 463.5 KiB processed)[0m in 4.51s]
[0m09:02:15.086268 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_vendor
[0m09:02:15.090031 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_zone
[0m09:02:15.094040 [info ] [Thread-1  ]: 5 of 6 START sql table model nyc_taxi.dim_zone ................................. [RUN]
[0m09:02:15.098011 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_vendor, now model.nyc_taxi.dim_zone)
[0m09:02:15.101337 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_zone
[0m09:02:15.115781 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_zone"
[0m09:02:15.134087 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_zone
[0m09:02:15.145013 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m09:02:15.912480 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.dim_zone"
[0m09:02:15.935850 [debug] [Thread-1  ]: On model.nyc_taxi.dim_zone: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.dim_zone"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`dim_zone`
      
    
    

    OPTIONS()
    as (
      SELECT DISTINCT
    location_id,
    borough,
    zone,
    replace(service_zone, 'Boro', 'Green') as service_zone
FROM `northern-shield-437204-m0`.`nyc_taxi`.`zone_map`
WHERE service_zone is not null
    );
  
[0m09:02:16.537258 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:b01cad38-59fd-4876-ad6b-d49cefd2e03d&page=queryresults
[0m09:02:18.986883 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '31b6420f-b94a-429c-80f1-6bda5245ee7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff470175f10>]}
[0m09:02:18.991684 [info ] [Thread-1  ]: 5 of 6 OK created sql table model nyc_taxi.dim_zone ............................ [[32mCREATE TABLE (263.0 rows, 24.2 KiB processed)[0m in 3.89s]
[0m09:02:18.997050 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_zone
[0m09:02:19.000904 [debug] [Thread-1  ]: Began running node model.nyc_taxi.fct_trips
[0m09:02:19.004096 [info ] [Thread-1  ]: 6 of 6 SKIP relation nyc_taxi.fct_trips ........................................ [[33mSKIP[0m]
[0m09:02:19.008628 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.fct_trips
[0m09:02:19.015360 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:02:19.018581 [debug] [MainThread]: Connection 'model.nyc_taxi.dim_zone' was properly closed.
[0m09:02:19.022685 [info ] [MainThread]: 
[0m09:02:19.027657 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 19.62 seconds (19.62s).
[0m09:02:19.037232 [debug] [MainThread]: Command end result
[0m09:02:19.272887 [info ] [MainThread]: 
[0m09:02:19.276052 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m09:02:19.279416 [info ] [MainThread]: 
[0m09:02:19.283050 [error] [MainThread]:   Database Error in model dim_time (models/transform/dim_time.sql)
  Syntax error: Expected keyword ALL or keyword DISTINCT but got keyword SELECT at [18:5]
  compiled code at target/run/nyc_taxi/models/transform/dim_time.sql
[0m09:02:19.287173 [info ] [MainThread]: 
[0m09:02:19.290758 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=1 TOTAL=6
[0m09:02:19.297005 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 30.052061, "process_in_blocks": "4552", "process_kernel_time": 1.010174, "process_mem_max_rss": "234104", "process_out_blocks": "0", "process_user_time": 13.894855}
[0m09:02:19.301516 [debug] [MainThread]: Command `dbt run` failed at 09:02:19.300828 after 30.06 seconds
[0m09:02:19.305029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff47a2e5430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4799a2e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff47889a970>]}
[0m09:02:19.308481 [debug] [MainThread]: Flushing usage events
[0m09:03:58.448613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd98b5d7460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd98940ea90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd98940ea30>]}


============================== 09:03:58.467574 | 8a85530a-a425-42d7-ad2b-424fef9f1c32 ==============================
[0m09:03:58.467574 [info ] [MainThread]: Running with dbt=1.8.9
[0m09:03:58.471909 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'version_check': 'True', 'use_experimental_parser': 'False', 'profiles_dir': '/opt/airflow/include/dbt/', 'partial_parse': 'True', 'indirect_selection': 'eager', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/include/dbt/', 'printer_width': '80', 'target_path': 'None', 'fail_fast': 'False', 'empty': 'False', 'debug': 'False', 'write_json': 'True', 'log_format': 'default', 'log_cache_events': 'False', 'quiet': 'False', 'introspect': 'True', 'use_colors': 'True', 'warn_error': 'None', 'log_path': '/opt/airflow/include/dbt/logs', 'no_print': 'None', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False'}
[0m09:04:00.849430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8a85530a-a425-42d7-ad2b-424fef9f1c32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd952004790>]}
[0m09:04:01.029161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8a85530a-a425-42d7-ad2b-424fef9f1c32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd952004b80>]}
[0m09:04:01.032495 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m09:04:01.573075 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m09:04:04.765143 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:04:04.770022 [debug] [MainThread]: Partial parsing: updated file: nyc_taxi://models/transform/dim_time.sql
[0m09:04:05.708769 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m09:04:05.712734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '8a85530a-a425-42d7-ad2b-424fef9f1c32', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd989c886d0>]}
[0m09:04:06.494964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8a85530a-a425-42d7-ad2b-424fef9f1c32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd982d56a00>]}
[0m09:04:07.052368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8a85530a-a425-42d7-ad2b-424fef9f1c32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd98a9fedc0>]}
[0m09:04:07.056408 [info ] [MainThread]: Found 6 models, 32 data tests, 2 sources, 600 macros
[0m09:04:07.059526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8a85530a-a425-42d7-ad2b-424fef9f1c32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd98a9fe190>]}
[0m09:04:07.067835 [info ] [MainThread]: 
[0m09:04:07.071568 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m09:04:07.094718 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_northern-shield-437204-m0'
[0m09:04:07.098155 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:04:07.742563 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_northern-shield-437204-m0, now list_northern-shield-437204-m0_nyc_taxi)
[0m09:04:07.745872 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:04:08.458833 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8a85530a-a425-42d7-ad2b-424fef9f1c32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd951ede730>]}
[0m09:04:08.462864 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:04:08.466761 [info ] [MainThread]: 
[0m09:04:08.503768 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_payment
[0m09:04:08.593531 [info ] [Thread-1  ]: 1 of 6 START sql table model nyc_taxi.dim_payment .............................. [RUN]
[0m09:04:08.597291 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_northern-shield-437204-m0_nyc_taxi, now model.nyc_taxi.dim_payment)
[0m09:04:08.600135 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_payment
[0m09:04:08.629614 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_payment"
[0m09:04:08.648637 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_payment
[0m09:04:08.701686 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m09:04:09.399714 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.dim_payment"
[0m09:04:09.424727 [debug] [Thread-1  ]: On model.nyc_taxi.dim_payment: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.dim_payment"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`dim_payment`
      
    
    

    OPTIONS()
    as (
      WITH payment_cte AS(
    SELECT DISTINCT
        payment_type AS type_id,
        CASE 
            WHEN payment_type = 1 THEN "Credit card"
            WHEN payment_type = 2 THEN "Cash"
            WHEN payment_type = 3 THEN "No charge"
            WHEN payment_type = 4 THEN "Dispute"
            WHEN payment_type = 5 THEN "Unknown"
            WHEN payment_type = 6 THEN "Voided trip"
        END AS payment_name
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata`
)
SELECT
    type_id,
    payment_name
FROM payment_cte
    );
  
[0m09:04:09.920846 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:e9a30018-ebd5-40bf-a165-d9aa9acb5c5b&page=queryresults
[0m09:04:12.822619 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8a85530a-a425-42d7-ad2b-424fef9f1c32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd982f28c70>]}
[0m09:04:12.827161 [info ] [Thread-1  ]: 1 of 6 OK created sql table model nyc_taxi.dim_payment ......................... [[32mCREATE TABLE (4.0 rows, 463.5 KiB processed)[0m in 4.22s]
[0m09:04:12.833171 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_payment
[0m09:04:12.836578 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_ratecode
[0m09:04:12.841894 [info ] [Thread-1  ]: 2 of 6 START sql table model nyc_taxi.dim_ratecode ............................. [RUN]
[0m09:04:12.846579 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_payment, now model.nyc_taxi.dim_ratecode)
[0m09:04:12.850496 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_ratecode
[0m09:04:12.863714 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_ratecode"
[0m09:04:12.888328 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_ratecode
[0m09:04:12.899800 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m09:04:13.478914 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.dim_ratecode"
[0m09:04:13.504898 [debug] [Thread-1  ]: On model.nyc_taxi.dim_ratecode: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.dim_ratecode"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`dim_ratecode`
      
    
    

    OPTIONS()
    as (
      WITH rate_code_cte AS(
    SELECT DISTINCT
        rate_code_id AS rate_id,
        CASE 
            WHEN rate_code_id = 1 THEN "Standard rate"
            WHEN rate_code_id = 2 THEN "JFK"
            WHEN rate_code_id = 3 THEN "Newark"
            WHEN rate_code_id = 4 THEN "Nassau or Westchester"
            WHEN rate_code_id = 5 THEN "Negotiated fare"
            WHEN rate_code_id = 6 THEN "Group ride"
        ELSE "Unknown"
        END AS rate_code_name
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata`
)
SELECT
    rate_id,
    rate_code_name
FROM rate_code_cte
    );
  
[0m09:04:14.047151 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:7fd022c5-35a8-4ca7-9421-065ccf52f5c7&page=queryresults
[0m09:04:16.433430 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8a85530a-a425-42d7-ad2b-424fef9f1c32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd982c66ac0>]}
[0m09:04:16.438406 [info ] [Thread-1  ]: 2 of 6 OK created sql table model nyc_taxi.dim_ratecode ........................ [[32mCREATE TABLE (6.0 rows, 463.5 KiB processed)[0m in 3.59s]
[0m09:04:16.445304 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_ratecode
[0m09:04:16.449422 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_time
[0m09:04:16.453637 [info ] [Thread-1  ]: 3 of 6 START sql table model nyc_taxi.dim_time ................................. [RUN]
[0m09:04:16.458568 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_ratecode, now model.nyc_taxi.dim_time)
[0m09:04:16.462301 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_time
[0m09:04:16.476461 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_time"
[0m09:04:16.501275 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_time
[0m09:04:16.523842 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.dim_time"
[0m09:04:16.547950 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m09:04:16.558969 [debug] [Thread-1  ]: On model.nyc_taxi.dim_time: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.dim_time"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`dim_time`
      
    
    

    OPTIONS()
    as (
      WITH datetime_cte AS (
    SELECT DISTINCT
        lpep_pickup_datetime AS datetime_value
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata`
    UNION ALL
    SELECT DISTINCT
        lpep_dropoff_datetime AS datetime_value
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata`
),
datetime_cte_distinct AS(
    SELECT DISTINCT
        datetime_value
    FROM datetime_cte
)
SELECT
    ROW_NUMBER() OVER (ORDER BY datetime_value) AS time_id,
    DATE(datetime_value) AS date,
    datetime_value AS date_part,
    EXTRACT(YEAR FROM datetime_value) AS year,
    EXTRACT(MONTH FROM datetime_value) AS month,
    EXTRACT(DAY FROM datetime_value) AS day,
    EXTRACT(HOUR FROM datetime_value) AS hour,
    EXTRACT(MINUTE FROM datetime_value) AS minute,
    FORMAT_TIMESTAMP('%A', datetime_value) AS weekday
FROM datetime_cte_distinct
ORDER BY time_id
    );
  
[0m09:04:17.391732 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:591c8012-45cf-46dd-88ae-b20919dc1c40&page=queryresults
[0m09:04:20.656035 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8a85530a-a425-42d7-ad2b-424fef9f1c32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd97c372f40>]}
[0m09:04:20.660992 [info ] [Thread-1  ]: 3 of 6 OK created sql table model nyc_taxi.dim_time ............................ [[32mCREATE TABLE (115.0k rows, 927.0 KiB processed)[0m in 4.20s]
[0m09:04:20.665297 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_time
[0m09:04:20.669409 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_vendor
[0m09:04:20.673907 [info ] [Thread-1  ]: 4 of 6 START sql table model nyc_taxi.dim_vendor ............................... [RUN]
[0m09:04:20.677629 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_time, now model.nyc_taxi.dim_vendor)
[0m09:04:20.681326 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_vendor
[0m09:04:20.697743 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_vendor"
[0m09:04:20.722236 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_vendor
[0m09:04:20.733980 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m09:04:21.389521 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.dim_vendor"
[0m09:04:21.415326 [debug] [Thread-1  ]: On model.nyc_taxi.dim_vendor: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.dim_vendor"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`dim_vendor`
      
    
    

    OPTIONS()
    as (
      WITH vendor_cte AS(
    SELECT DISTINCT
        vendor_id AS id,
        CASE 
            WHEN vendor_id = 1 THEN "Creative Mobile Technologies"
            WHEN vendor_id = 2 THEN "VeriFone Inc."
        END AS vendor_name
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata`
)
SELECT
    id,
    vendor_name
FROM vendor_cte
    );
  
[0m09:04:22.121167 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:4ec27d24-9990-4b26-adbb-00aea5f43fd9&page=queryresults
[0m09:04:24.639861 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8a85530a-a425-42d7-ad2b-424fef9f1c32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd98a132370>]}
[0m09:04:24.644278 [info ] [Thread-1  ]: 4 of 6 OK created sql table model nyc_taxi.dim_vendor .......................... [[32mCREATE TABLE (2.0 rows, 463.5 KiB processed)[0m in 3.96s]
[0m09:04:24.649138 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_vendor
[0m09:04:24.652986 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_zone
[0m09:04:24.657126 [info ] [Thread-1  ]: 5 of 6 START sql table model nyc_taxi.dim_zone ................................. [RUN]
[0m09:04:24.661083 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_vendor, now model.nyc_taxi.dim_zone)
[0m09:04:24.665609 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_zone
[0m09:04:24.678765 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_zone"
[0m09:04:24.714171 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_zone
[0m09:04:24.728808 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m09:04:25.387658 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.dim_zone"
[0m09:04:25.403898 [debug] [Thread-1  ]: On model.nyc_taxi.dim_zone: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.dim_zone"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`dim_zone`
      
    
    

    OPTIONS()
    as (
      SELECT DISTINCT
    location_id,
    borough,
    zone,
    replace(service_zone, 'Boro', 'Green') as service_zone
FROM `northern-shield-437204-m0`.`nyc_taxi`.`zone_map`
WHERE service_zone is not null
    );
  
[0m09:04:26.066244 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:340501e1-21c3-4687-8fad-673dc4ec7464&page=queryresults
[0m09:04:27.968036 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8a85530a-a425-42d7-ad2b-424fef9f1c32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd982d56ee0>]}
[0m09:04:27.972856 [info ] [Thread-1  ]: 5 of 6 OK created sql table model nyc_taxi.dim_zone ............................ [[32mCREATE TABLE (263.0 rows, 24.2 KiB processed)[0m in 3.31s]
[0m09:04:27.978131 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_zone
[0m09:04:27.981847 [debug] [Thread-1  ]: Began running node model.nyc_taxi.fct_trips
[0m09:04:27.985089 [info ] [Thread-1  ]: 6 of 6 START sql table model nyc_taxi.fct_trips ................................ [RUN]
[0m09:04:27.989326 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_zone, now model.nyc_taxi.fct_trips)
[0m09:04:27.994927 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.fct_trips
[0m09:04:28.062780 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.fct_trips"
[0m09:04:28.084249 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.fct_trips
[0m09:04:28.098422 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.fct_trips"
[0m09:04:28.122077 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m09:04:28.133439 [debug] [Thread-1  ]: On model.nyc_taxi.fct_trips: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.fct_trips"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips`
      
    
    

    OPTIONS()
    as (
      WITH tripdata_cte AS (
    SELECT 
        to_hex(md5(cast(coalesce(cast(t.vendor_id as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(t.lpep_pickup_datetime as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(t.lpep_dropoff_datetime as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(t.__index_level_0__ as string), '_dbt_utils_surrogate_key_null_') as string))) AS trip_id,
        t.vendor_id,
        pt.time_id AS pickup_time_id,
        dt.time_id AS dropoff_time_id,
        t.rate_code_id,
        t.pu_location_id,
        t.do_location_id,
        t.passenger_count,
        t.trip_distance,
        t.fare_amount,
        t.extra,
        t.mta_tax,
        t.tip_amount,
        t.tolls_amount,
        t.improvement_surcharge,
        t.total_amount,
        t.payment_type,
        t.trip_type,
        t.congestion_surcharge
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata` AS t
    INNER JOIN (
        SELECT DISTINCT date_part, time_id 
        FROM `northern-shield-437204-m0`.`nyc_taxi`.`dim_time`
    ) pt ON t.lpep_pickup_datetime = pt.date_part
    INNER JOIN (
        SELECT DISTINCT date_part, time_id 
        FROM `northern-shield-437204-m0`.`nyc_taxi`.`dim_time`
    ) dt ON t.lpep_dropoff_datetime = dt.date_part
)
SELECT 
    trip_id,
    vendor_id,
    pickup_time_id,
    dropoff_time_id,
    rate_code_id,
    pu_location_id,
    do_location_id,
    passenger_count,
    trip_distance,
    fare_amount,
    extra,
    mta_tax,
    tip_amount,
    tolls_amount,
    improvement_surcharge,
    total_amount,
    payment_type,
    trip_type,
    congestion_surcharge
FROM tripdata_cte
    );
  
[0m09:04:29.039244 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:4f0a6503-6baf-493f-a4ca-520070fc156f&page=queryresults
[0m09:04:33.013796 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8a85530a-a425-42d7-ad2b-424fef9f1c32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd97c372f40>]}
[0m09:04:33.017811 [info ] [Thread-1  ]: 6 of 6 OK created sql table model nyc_taxi.fct_trips ........................... [[32mCREATE TABLE (59.3k rows, 10.4 MiB processed)[0m in 5.02s]
[0m09:04:33.022344 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.fct_trips
[0m09:04:33.028351 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:04:33.031646 [debug] [MainThread]: Connection 'model.nyc_taxi.fct_trips' was properly closed.
[0m09:04:33.035666 [info ] [MainThread]: 
[0m09:04:33.040777 [info ] [MainThread]: Finished running 6 table models in 0 hours 0 minutes and 25.96 seconds (25.96s).
[0m09:04:33.050260 [debug] [MainThread]: Command end result
[0m09:04:33.279080 [info ] [MainThread]: 
[0m09:04:33.282337 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:04:33.285608 [info ] [MainThread]: 
[0m09:04:33.288583 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m09:04:33.293334 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 36.457123, "process_in_blocks": "944", "process_kernel_time": 0.856533, "process_mem_max_rss": "233020", "process_out_blocks": "0", "process_user_time": 13.753754}
[0m09:04:33.297665 [debug] [MainThread]: Command `dbt run` succeeded at 09:04:33.297175 after 36.46 seconds
[0m09:04:33.300908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd98b5d7460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd98a9fedc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd989c1dd90>]}
[0m09:04:33.304069 [debug] [MainThread]: Flushing usage events
[0m09:06:23.729429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6fe362b490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6fe1463a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6fe1463a30>]}


============================== 09:06:23.749129 | 180eb19d-03b4-4f48-b879-4d4e29c289c0 ==============================
[0m09:06:23.749129 [info ] [MainThread]: Running with dbt=1.8.9
[0m09:06:23.753225 [debug] [MainThread]: running dbt with arguments {'debug': 'False', 'target_path': 'None', 'log_cache_events': 'False', 'version_check': 'True', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'partial_parse': 'True', 'printer_width': '80', 'use_experimental_parser': 'False', 'fail_fast': 'False', 'invocation_command': 'dbt test --profiles-dir /opt/airflow/include/dbt/', 'static_parser': 'True', 'write_json': 'True', 'cache_selected_only': 'False', 'no_print': 'None', 'profiles_dir': '/opt/airflow/include/dbt/', 'empty': 'None', 'use_colors': 'True', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'introspect': 'True', 'warn_error': 'None', 'log_format': 'default', 'log_path': '/opt/airflow/include/dbt/logs'}
[0m09:06:26.354481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '180eb19d-03b4-4f48-b879-4d4e29c289c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6fe2e3ad00>]}
[0m09:06:26.576878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '180eb19d-03b4-4f48-b879-4d4e29c289c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6fe28ec520>]}
[0m09:06:26.580891 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m09:06:27.078175 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m09:06:30.354028 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:06:30.357237 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:06:30.539442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '180eb19d-03b4-4f48-b879-4d4e29c289c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6fdc7d4fa0>]}
[0m09:06:31.305883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '180eb19d-03b4-4f48-b879-4d4e29c289c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6fab14c730>]}
[0m09:06:31.309707 [info ] [MainThread]: Found 6 models, 32 data tests, 2 sources, 600 macros
[0m09:06:31.312812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '180eb19d-03b4-4f48-b879-4d4e29c289c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6fdc853eb0>]}
[0m09:06:31.324055 [info ] [MainThread]: 
[0m09:06:31.328522 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m09:06:31.345945 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_northern-shield-437204-m0_nyc_taxi'
[0m09:06:31.349000 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:06:31.960292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '180eb19d-03b4-4f48-b879-4d4e29c289c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6faa001550>]}
[0m09:06:31.964479 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:06:31.968874 [info ] [MainThread]: 
[0m09:06:32.015626 [debug] [Thread-1  ]: Began running node test.nyc_taxi.accepted_values_dim_payment_payment_name__Credit_card__Cash__No_charge__Dispute__Unknown__Voided_trip.58d00ef9f4
[0m09:06:32.020991 [info ] [Thread-1  ]: 1 of 32 START test accepted_values_dim_payment_payment_name__Credit_card__Cash__No_charge__Dispute__Unknown__Voided_trip  [RUN]
[0m09:06:32.026365 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_northern-shield-437204-m0_nyc_taxi, now test.nyc_taxi.accepted_values_dim_payment_payment_name__Credit_card__Cash__No_charge__Dispute__Unknown__Voided_trip.58d00ef9f4)
[0m09:06:32.030039 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.accepted_values_dim_payment_payment_name__Credit_card__Cash__No_charge__Dispute__Unknown__Voided_trip.58d00ef9f4
[0m09:06:32.110291 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.accepted_values_dim_payment_payment_name__Credit_card__Cash__No_charge__Dispute__Unknown__Voided_trip.58d00ef9f4"
[0m09:06:32.130461 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.accepted_values_dim_payment_payment_name__Credit_card__Cash__No_charge__Dispute__Unknown__Voided_trip.58d00ef9f4
[0m09:06:32.201716 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.accepted_values_dim_payment_payment_name__Credit_card__Cash__No_charge__Dispute__Unknown__Voided_trip.58d00ef9f4"
[0m09:06:32.225843 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m09:06:32.237216 [debug] [Thread-1  ]: On test.nyc_taxi.accepted_values_dim_payment_payment_name__Credit_card__Cash__No_charge__Dispute__Unknown__Voided_trip.58d00ef9f4: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.accepted_values_dim_payment_payment_name__Credit_card__Cash__No_charge__Dispute__Unknown__Voided_trip.58d00ef9f4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        payment_name as value_field,
        count(*) as n_records

    from `northern-shield-437204-m0`.`nyc_taxi`.`dim_payment`
    group by payment_name

)

select *
from all_values
where value_field not in (
    'Credit card','Cash','No charge','Dispute','Unknown','Voided trip'
)



      
    ) dbt_internal_test
[0m09:06:33.289619 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:80ed9167-13ee-4c04-864b-cab1b641b50d&page=queryresults
[0m09:06:34.415728 [info ] [Thread-1  ]: 1 of 32 PASS accepted_values_dim_payment_payment_name__Credit_card__Cash__No_charge__Dispute__Unknown__Voided_trip  [[32mPASS[0m in 2.39s]
[0m09:06:34.421119 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.accepted_values_dim_payment_payment_name__Credit_card__Cash__No_charge__Dispute__Unknown__Voided_trip.58d00ef9f4
[0m09:06:34.425046 [debug] [Thread-1  ]: Began running node test.nyc_taxi.accepted_values_dim_ratecode_rate_code_name__Standard_rate__JFK__Newark__Nassau_or_Westchester__Negotiated_fare__Group_ride__Unknown.57ee02019f
[0m09:06:34.428523 [info ] [Thread-1  ]: 2 of 32 START test accepted_values_dim_ratecode_rate_code_name__Standard_rate__JFK__Newark__Nassau_or_Westchester__Negotiated_fare__Group_ride__Unknown  [RUN]
[0m09:06:34.431913 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.accepted_values_dim_payment_payment_name__Credit_card__Cash__No_charge__Dispute__Unknown__Voided_trip.58d00ef9f4, now test.nyc_taxi.accepted_values_dim_ratecode_rate_code_name__Standard_rate__JFK__Newark__Nassau_or_Westchester__Negotiated_fare__Group_ride__Unknown.57ee02019f)
[0m09:06:34.435927 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.accepted_values_dim_ratecode_rate_code_name__Standard_rate__JFK__Newark__Nassau_or_Westchester__Negotiated_fare__Group_ride__Unknown.57ee02019f
[0m09:06:34.468847 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.accepted_values_dim_ratecode_rate_code_name__Standard_rate__JFK__Newark__Nassau_or_Westchester__Negotiated_fare__Group_ride__Unknown.57ee02019f"
[0m09:06:34.492874 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.accepted_values_dim_ratecode_rate_code_name__Standard_rate__JFK__Newark__Nassau_or_Westchester__Negotiated_fare__Group_ride__Unknown.57ee02019f
[0m09:06:34.512184 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.accepted_values_dim_ratecode_rate_code_name__Standard_rate__JFK__Newark__Nassau_or_Westchester__Negotiated_fare__Group_ride__Unknown.57ee02019f"
[0m09:06:34.535018 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m09:06:34.545421 [debug] [Thread-1  ]: On test.nyc_taxi.accepted_values_dim_ratecode_rate_code_name__Standard_rate__JFK__Newark__Nassau_or_Westchester__Negotiated_fare__Group_ride__Unknown.57ee02019f: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.accepted_values_dim_ratecode_rate_code_name__Standard_rate__JFK__Newark__Nassau_or_Westchester__Negotiated_fare__Group_ride__Unknown.57ee02019f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        rate_code_name as value_field,
        count(*) as n_records

    from `northern-shield-437204-m0`.`nyc_taxi`.`dim_ratecode`
    group by rate_code_name

)

select *
from all_values
where value_field not in (
    'Standard rate','JFK','Newark','Nassau or Westchester','Negotiated fare','Group ride','Unknown'
)



      
    ) dbt_internal_test
[0m09:06:35.553262 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:6243911e-fc8f-42d4-8dc7-84147ecea881&page=queryresults
[0m09:06:36.580441 [info ] [Thread-1  ]: 2 of 32 PASS accepted_values_dim_ratecode_rate_code_name__Standard_rate__JFK__Newark__Nassau_or_Westchester__Negotiated_fare__Group_ride__Unknown  [[32mPASS[0m in 2.15s]
[0m09:06:36.586497 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.accepted_values_dim_ratecode_rate_code_name__Standard_rate__JFK__Newark__Nassau_or_Westchester__Negotiated_fare__Group_ride__Unknown.57ee02019f
[0m09:06:36.592377 [debug] [Thread-1  ]: Began running node test.nyc_taxi.accepted_values_dim_time_weekday__Sunday__Monday__Tuesday__Wednesday__Thursday__Friday__Saturday.87b4c2a366
[0m09:06:36.596229 [info ] [Thread-1  ]: 3 of 32 START test accepted_values_dim_time_weekday__Sunday__Monday__Tuesday__Wednesday__Thursday__Friday__Saturday  [RUN]
[0m09:06:36.601856 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.accepted_values_dim_ratecode_rate_code_name__Standard_rate__JFK__Newark__Nassau_or_Westchester__Negotiated_fare__Group_ride__Unknown.57ee02019f, now test.nyc_taxi.accepted_values_dim_time_weekday__Sunday__Monday__Tuesday__Wednesday__Thursday__Friday__Saturday.87b4c2a366)
[0m09:06:36.606452 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.accepted_values_dim_time_weekday__Sunday__Monday__Tuesday__Wednesday__Thursday__Friday__Saturday.87b4c2a366
[0m09:06:36.645316 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.accepted_values_dim_time_weekday__Sunday__Monday__Tuesday__Wednesday__Thursday__Friday__Saturday.87b4c2a366"
[0m09:06:36.668802 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.accepted_values_dim_time_weekday__Sunday__Monday__Tuesday__Wednesday__Thursday__Friday__Saturday.87b4c2a366
[0m09:06:36.684793 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.accepted_values_dim_time_weekday__Sunday__Monday__Tuesday__Wednesday__Thursday__Friday__Saturday.87b4c2a366"
[0m09:06:36.709473 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m09:06:36.720467 [debug] [Thread-1  ]: On test.nyc_taxi.accepted_values_dim_time_weekday__Sunday__Monday__Tuesday__Wednesday__Thursday__Friday__Saturday.87b4c2a366: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.accepted_values_dim_time_weekday__Sunday__Monday__Tuesday__Wednesday__Thursday__Friday__Saturday.87b4c2a366"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        weekday as value_field,
        count(*) as n_records

    from `northern-shield-437204-m0`.`nyc_taxi`.`dim_time`
    group by weekday

)

select *
from all_values
where value_field not in (
    'Sunday','Monday','Tuesday','Wednesday','Thursday','Friday','Saturday'
)



      
    ) dbt_internal_test
[0m09:06:37.788562 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:9cac77b0-a110-4cdd-a816-2f22c424d747&page=queryresults
[0m09:06:38.791998 [info ] [Thread-1  ]: 3 of 32 PASS accepted_values_dim_time_weekday__Sunday__Monday__Tuesday__Wednesday__Thursday__Friday__Saturday  [[32mPASS[0m in 2.19s]
[0m09:06:38.796920 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.accepted_values_dim_time_weekday__Sunday__Monday__Tuesday__Wednesday__Thursday__Friday__Saturday.87b4c2a366
[0m09:06:38.800303 [debug] [Thread-1  ]: Began running node test.nyc_taxi.accepted_values_dim_vendor_vendor_name__Creative_Mobile_Technologies__VeriFone_Inc_.7481cecf07
[0m09:06:38.804886 [info ] [Thread-1  ]: 4 of 32 START test accepted_values_dim_vendor_vendor_name__Creative_Mobile_Technologies__VeriFone_Inc_  [RUN]
[0m09:06:38.809253 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.accepted_values_dim_time_weekday__Sunday__Monday__Tuesday__Wednesday__Thursday__Friday__Saturday.87b4c2a366, now test.nyc_taxi.accepted_values_dim_vendor_vendor_name__Creative_Mobile_Technologies__VeriFone_Inc_.7481cecf07)
[0m09:06:38.813372 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.accepted_values_dim_vendor_vendor_name__Creative_Mobile_Technologies__VeriFone_Inc_.7481cecf07
[0m09:06:38.844481 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.accepted_values_dim_vendor_vendor_name__Creative_Mobile_Technologies__VeriFone_Inc_.7481cecf07"
[0m09:06:38.876534 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.accepted_values_dim_vendor_vendor_name__Creative_Mobile_Technologies__VeriFone_Inc_.7481cecf07
[0m09:06:38.892304 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.accepted_values_dim_vendor_vendor_name__Creative_Mobile_Technologies__VeriFone_Inc_.7481cecf07"
[0m09:06:38.920030 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m09:06:38.929704 [debug] [Thread-1  ]: On test.nyc_taxi.accepted_values_dim_vendor_vendor_name__Creative_Mobile_Technologies__VeriFone_Inc_.7481cecf07: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.accepted_values_dim_vendor_vendor_name__Creative_Mobile_Technologies__VeriFone_Inc_.7481cecf07"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        vendor_name as value_field,
        count(*) as n_records

    from `northern-shield-437204-m0`.`nyc_taxi`.`dim_vendor`
    group by vendor_name

)

select *
from all_values
where value_field not in (
    'Creative Mobile Technologies','VeriFone Inc.'
)



      
    ) dbt_internal_test
[0m09:06:39.962429 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:ff08553a-db92-4c67-93f4-0a6c678fae44&page=queryresults
[0m09:06:41.103231 [info ] [Thread-1  ]: 4 of 32 PASS accepted_values_dim_vendor_vendor_name__Creative_Mobile_Technologies__VeriFone_Inc_  [[32mPASS[0m in 2.29s]
[0m09:06:41.109318 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.accepted_values_dim_vendor_vendor_name__Creative_Mobile_Technologies__VeriFone_Inc_.7481cecf07
[0m09:06:41.113798 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_dim_payment_type_id.96dfa722aa
[0m09:06:41.117304 [info ] [Thread-1  ]: 5 of 32 START test not_null_dim_payment_type_id ................................ [RUN]
[0m09:06:41.122747 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.accepted_values_dim_vendor_vendor_name__Creative_Mobile_Technologies__VeriFone_Inc_.7481cecf07, now test.nyc_taxi.not_null_dim_payment_type_id.96dfa722aa)
[0m09:06:41.127098 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_dim_payment_type_id.96dfa722aa
[0m09:06:41.154819 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_dim_payment_type_id.96dfa722aa"
[0m09:06:41.173993 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_dim_payment_type_id.96dfa722aa
[0m09:06:41.185768 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_dim_payment_type_id.96dfa722aa"
[0m09:06:41.206492 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m09:06:41.216559 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_dim_payment_type_id.96dfa722aa: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_dim_payment_type_id.96dfa722aa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select type_id
from `northern-shield-437204-m0`.`nyc_taxi`.`dim_payment`
where type_id is null



      
    ) dbt_internal_test
[0m09:06:42.411906 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:d6796979-850c-4c3c-8acb-7b915822df03&page=queryresults
[0m09:06:43.563245 [info ] [Thread-1  ]: 5 of 32 PASS not_null_dim_payment_type_id ...................................... [[32mPASS[0m in 2.44s]
[0m09:06:43.573474 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_dim_payment_type_id.96dfa722aa
[0m09:06:43.578703 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_dim_time_date.2080f42875
[0m09:06:43.582039 [info ] [Thread-1  ]: 6 of 32 START test not_null_dim_time_date ...................................... [RUN]
[0m09:06:43.585830 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_dim_payment_type_id.96dfa722aa, now test.nyc_taxi.not_null_dim_time_date.2080f42875)
[0m09:06:43.588914 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_dim_time_date.2080f42875
[0m09:06:43.607056 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_dim_time_date.2080f42875"
[0m09:06:43.625857 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_dim_time_date.2080f42875
[0m09:06:43.637681 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_dim_time_date.2080f42875"
[0m09:06:43.656906 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m09:06:43.665683 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_dim_time_date.2080f42875: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_dim_time_date.2080f42875"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from `northern-shield-437204-m0`.`nyc_taxi`.`dim_time`
where date is null



      
    ) dbt_internal_test
[0m09:06:44.603449 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:a077947b-e44c-4db8-89fe-3f76892e2caf&page=queryresults
[0m09:06:45.616299 [info ] [Thread-1  ]: 6 of 32 PASS not_null_dim_time_date ............................................ [[32mPASS[0m in 2.03s]
[0m09:06:45.621665 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_dim_time_date.2080f42875
[0m09:06:45.626056 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_dim_time_date_part.59e6206332
[0m09:06:45.629211 [info ] [Thread-1  ]: 7 of 32 START test not_null_dim_time_date_part ................................. [RUN]
[0m09:06:45.632433 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_dim_time_date.2080f42875, now test.nyc_taxi.not_null_dim_time_date_part.59e6206332)
[0m09:06:45.635546 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_dim_time_date_part.59e6206332
[0m09:06:45.656696 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_dim_time_date_part.59e6206332"
[0m09:06:45.678115 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_dim_time_date_part.59e6206332
[0m09:06:45.692129 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_dim_time_date_part.59e6206332"
[0m09:06:45.714069 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m09:06:45.723012 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_dim_time_date_part.59e6206332: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_dim_time_date_part.59e6206332"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date_part
from `northern-shield-437204-m0`.`nyc_taxi`.`dim_time`
where date_part is null



      
    ) dbt_internal_test
[0m09:06:46.698216 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:873e32b4-1d05-4439-89d5-d7ba4244d503&page=queryresults
[0m09:06:47.766797 [info ] [Thread-1  ]: 7 of 32 PASS not_null_dim_time_date_part ....................................... [[32mPASS[0m in 2.13s]
[0m09:06:47.771399 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_dim_time_date_part.59e6206332
[0m09:06:47.774760 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_dim_time_day.dc0e917166
[0m09:06:47.777785 [info ] [Thread-1  ]: 8 of 32 START test not_null_dim_time_day ....................................... [RUN]
[0m09:06:47.780845 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_dim_time_date_part.59e6206332, now test.nyc_taxi.not_null_dim_time_day.dc0e917166)
[0m09:06:47.784028 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_dim_time_day.dc0e917166
[0m09:06:47.804128 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_dim_time_day.dc0e917166"
[0m09:06:47.823492 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_dim_time_day.dc0e917166
[0m09:06:47.835827 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_dim_time_day.dc0e917166"
[0m09:06:47.856441 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m09:06:47.865763 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_dim_time_day.dc0e917166: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_dim_time_day.dc0e917166"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select day
from `northern-shield-437204-m0`.`nyc_taxi`.`dim_time`
where day is null



      
    ) dbt_internal_test
[0m09:06:48.840986 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:8624a50b-2b5d-4cb6-a86e-89d5996c55e2&page=queryresults
[0m09:06:49.874250 [info ] [Thread-1  ]: 8 of 32 PASS not_null_dim_time_day ............................................. [[32mPASS[0m in 2.09s]
[0m09:06:49.880599 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_dim_time_day.dc0e917166
[0m09:06:49.884949 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_dim_time_hour.5b8ccd8f25
[0m09:06:49.890583 [info ] [Thread-1  ]: 9 of 32 START test not_null_dim_time_hour ...................................... [RUN]
[0m09:06:49.898377 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_dim_time_day.dc0e917166, now test.nyc_taxi.not_null_dim_time_hour.5b8ccd8f25)
[0m09:06:49.902649 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_dim_time_hour.5b8ccd8f25
[0m09:06:49.926515 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_dim_time_hour.5b8ccd8f25"
[0m09:06:49.955089 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_dim_time_hour.5b8ccd8f25
[0m09:06:49.968365 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_dim_time_hour.5b8ccd8f25"
[0m09:06:49.990293 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m09:06:50.002204 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_dim_time_hour.5b8ccd8f25: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_dim_time_hour.5b8ccd8f25"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select hour
from `northern-shield-437204-m0`.`nyc_taxi`.`dim_time`
where hour is null



      
    ) dbt_internal_test
[0m09:06:50.898095 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:c5e09825-073d-4fd5-b9b3-2157e751f01c&page=queryresults
[0m09:06:52.055888 [info ] [Thread-1  ]: 9 of 32 PASS not_null_dim_time_hour ............................................ [[32mPASS[0m in 2.16s]
[0m09:06:52.063292 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_dim_time_hour.5b8ccd8f25
[0m09:06:52.076856 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_dim_time_minute.23e906ca61
[0m09:06:52.082535 [info ] [Thread-1  ]: 10 of 32 START test not_null_dim_time_minute ................................... [RUN]
[0m09:06:52.087417 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_dim_time_hour.5b8ccd8f25, now test.nyc_taxi.not_null_dim_time_minute.23e906ca61)
[0m09:06:52.092307 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_dim_time_minute.23e906ca61
[0m09:06:52.119915 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_dim_time_minute.23e906ca61"
[0m09:06:52.141395 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_dim_time_minute.23e906ca61
[0m09:06:52.156358 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_dim_time_minute.23e906ca61"
[0m09:06:52.178321 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m09:06:52.190023 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_dim_time_minute.23e906ca61: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_dim_time_minute.23e906ca61"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select minute
from `northern-shield-437204-m0`.`nyc_taxi`.`dim_time`
where minute is null



      
    ) dbt_internal_test
[0m09:06:53.064474 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:1f38c46e-92d1-459a-b3e7-6e6cb472e5ab&page=queryresults
[0m09:06:54.109662 [info ] [Thread-1  ]: 10 of 32 PASS not_null_dim_time_minute ......................................... [[32mPASS[0m in 2.02s]
[0m09:06:54.115386 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_dim_time_minute.23e906ca61
[0m09:06:54.120468 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_dim_time_month.9f6ecf2eb5
[0m09:06:54.124537 [info ] [Thread-1  ]: 11 of 32 START test not_null_dim_time_month .................................... [RUN]
[0m09:06:54.128410 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_dim_time_minute.23e906ca61, now test.nyc_taxi.not_null_dim_time_month.9f6ecf2eb5)
[0m09:06:54.131878 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_dim_time_month.9f6ecf2eb5
[0m09:06:54.150327 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_dim_time_month.9f6ecf2eb5"
[0m09:06:54.176953 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_dim_time_month.9f6ecf2eb5
[0m09:06:54.188542 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_dim_time_month.9f6ecf2eb5"
[0m09:06:54.216285 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m09:06:54.229252 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_dim_time_month.9f6ecf2eb5: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_dim_time_month.9f6ecf2eb5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select month
from `northern-shield-437204-m0`.`nyc_taxi`.`dim_time`
where month is null



      
    ) dbt_internal_test
[0m09:06:54.420360 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:fbd80e9a-7524-471d-a46a-ed3d4c8a1a3c&page=queryresults
[0m09:06:55.445385 [info ] [Thread-1  ]: 11 of 32 PASS not_null_dim_time_month .......................................... [[32mPASS[0m in 1.32s]
[0m09:06:55.451863 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_dim_time_month.9f6ecf2eb5
[0m09:06:55.457298 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_dim_time_year.6fb9595d53
[0m09:06:55.462043 [info ] [Thread-1  ]: 12 of 32 START test not_null_dim_time_year ..................................... [RUN]
[0m09:06:55.466023 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_dim_time_month.9f6ecf2eb5, now test.nyc_taxi.not_null_dim_time_year.6fb9595d53)
[0m09:06:55.469009 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_dim_time_year.6fb9595d53
[0m09:06:55.491008 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_dim_time_year.6fb9595d53"
[0m09:06:55.516811 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_dim_time_year.6fb9595d53
[0m09:06:55.531897 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_dim_time_year.6fb9595d53"
[0m09:06:55.558811 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m09:06:55.569598 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_dim_time_year.6fb9595d53: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_dim_time_year.6fb9595d53"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select year
from `northern-shield-437204-m0`.`nyc_taxi`.`dim_time`
where year is null



      
    ) dbt_internal_test
[0m09:06:56.517741 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:4b275878-c7e7-4a9e-9510-eaa1e99379d9&page=queryresults
[0m09:06:57.516316 [info ] [Thread-1  ]: 12 of 32 PASS not_null_dim_time_year ........................................... [[32mPASS[0m in 2.05s]
[0m09:06:57.520925 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_dim_time_year.6fb9595d53
[0m09:06:57.524777 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_dim_zone_borough.1ed2272c52
[0m09:06:57.528798 [info ] [Thread-1  ]: 13 of 32 START test not_null_dim_zone_borough .................................. [RUN]
[0m09:06:57.532441 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_dim_time_year.6fb9595d53, now test.nyc_taxi.not_null_dim_zone_borough.1ed2272c52)
[0m09:06:57.535540 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_dim_zone_borough.1ed2272c52
[0m09:06:57.555062 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_dim_zone_borough.1ed2272c52"
[0m09:06:57.577603 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_dim_zone_borough.1ed2272c52
[0m09:06:57.590595 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_dim_zone_borough.1ed2272c52"
[0m09:06:57.614086 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m09:06:57.624236 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_dim_zone_borough.1ed2272c52: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_dim_zone_borough.1ed2272c52"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select borough
from `northern-shield-437204-m0`.`nyc_taxi`.`dim_zone`
where borough is null



      
    ) dbt_internal_test
[0m09:06:58.645882 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:cf8374d0-45e1-4635-9f09-cff1064a080e&page=queryresults
[0m09:06:59.673477 [info ] [Thread-1  ]: 13 of 32 PASS not_null_dim_zone_borough ........................................ [[32mPASS[0m in 2.14s]
[0m09:06:59.678652 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_dim_zone_borough.1ed2272c52
[0m09:06:59.682420 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_dim_zone_service_zone.2007f611c5
[0m09:06:59.685549 [info ] [Thread-1  ]: 14 of 32 START test not_null_dim_zone_service_zone ............................. [RUN]
[0m09:06:59.688915 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_dim_zone_borough.1ed2272c52, now test.nyc_taxi.not_null_dim_zone_service_zone.2007f611c5)
[0m09:06:59.692262 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_dim_zone_service_zone.2007f611c5
[0m09:06:59.710865 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_dim_zone_service_zone.2007f611c5"
[0m09:06:59.733279 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_dim_zone_service_zone.2007f611c5
[0m09:06:59.745673 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_dim_zone_service_zone.2007f611c5"
[0m09:06:59.770917 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m09:06:59.781254 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_dim_zone_service_zone.2007f611c5: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_dim_zone_service_zone.2007f611c5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select service_zone
from `northern-shield-437204-m0`.`nyc_taxi`.`dim_zone`
where service_zone is null



      
    ) dbt_internal_test
[0m09:07:01.026099 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:a870e3ab-50af-4838-82f5-88a1d7b693cf&page=queryresults
[0m09:07:02.084005 [info ] [Thread-1  ]: 14 of 32 PASS not_null_dim_zone_service_zone ................................... [[32mPASS[0m in 2.39s]
[0m09:07:02.089204 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_dim_zone_service_zone.2007f611c5
[0m09:07:02.093812 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_dim_zone_zone.a1c4a4c37a
[0m09:07:02.097147 [info ] [Thread-1  ]: 15 of 32 START test not_null_dim_zone_zone ..................................... [RUN]
[0m09:07:02.101909 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_dim_zone_service_zone.2007f611c5, now test.nyc_taxi.not_null_dim_zone_zone.a1c4a4c37a)
[0m09:07:02.106324 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_dim_zone_zone.a1c4a4c37a
[0m09:07:02.125499 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_dim_zone_zone.a1c4a4c37a"
[0m09:07:02.147400 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_dim_zone_zone.a1c4a4c37a
[0m09:07:02.159675 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_dim_zone_zone.a1c4a4c37a"
[0m09:07:02.186207 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m09:07:02.198248 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_dim_zone_zone.a1c4a4c37a: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_dim_zone_zone.a1c4a4c37a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select zone
from `northern-shield-437204-m0`.`nyc_taxi`.`dim_zone`
where zone is null



      
    ) dbt_internal_test
[0m09:07:03.141008 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:0f3a4ff1-3656-4ffd-a034-1189e525abb7&page=queryresults
[0m09:07:04.183685 [info ] [Thread-1  ]: 15 of 32 PASS not_null_dim_zone_zone ........................................... [[32mPASS[0m in 2.08s]
[0m09:07:04.188766 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_dim_zone_zone.a1c4a4c37a
[0m09:07:04.193500 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_do_location_id.6acdd302a6
[0m09:07:04.197051 [info ] [Thread-1  ]: 16 of 32 START test not_null_fct_trips_do_location_id .......................... [RUN]
[0m09:07:04.200271 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_dim_zone_zone.a1c4a4c37a, now test.nyc_taxi.not_null_fct_trips_do_location_id.6acdd302a6)
[0m09:07:04.204778 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_do_location_id.6acdd302a6
[0m09:07:04.222516 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_do_location_id.6acdd302a6"
[0m09:07:04.249484 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_do_location_id.6acdd302a6
[0m09:07:04.263171 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_fct_trips_do_location_id.6acdd302a6"
[0m09:07:04.288092 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m09:07:04.301398 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_fct_trips_do_location_id.6acdd302a6: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_fct_trips_do_location_id.6acdd302a6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select do_location_id
from `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips`
where do_location_id is null



      
    ) dbt_internal_test
[0m09:07:05.204937 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:7ceca427-d9bc-4a88-b7c8-d402147355f8&page=queryresults
[0m09:07:06.233416 [info ] [Thread-1  ]: 16 of 32 PASS not_null_fct_trips_do_location_id ................................ [[32mPASS[0m in 2.03s]
[0m09:07:06.239627 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_do_location_id.6acdd302a6
[0m09:07:06.244009 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_dropoff_time_id.781496e98f
[0m09:07:06.248717 [info ] [Thread-1  ]: 17 of 32 START test not_null_fct_trips_dropoff_time_id ......................... [RUN]
[0m09:07:06.254882 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_do_location_id.6acdd302a6, now test.nyc_taxi.not_null_fct_trips_dropoff_time_id.781496e98f)
[0m09:07:06.258742 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_dropoff_time_id.781496e98f
[0m09:07:06.284652 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_dropoff_time_id.781496e98f"
[0m09:07:06.309013 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_dropoff_time_id.781496e98f
[0m09:07:06.321690 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_fct_trips_dropoff_time_id.781496e98f"
[0m09:07:06.349273 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m09:07:06.361351 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_fct_trips_dropoff_time_id.781496e98f: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_fct_trips_dropoff_time_id.781496e98f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select dropoff_time_id
from `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips`
where dropoff_time_id is null



      
    ) dbt_internal_test
[0m09:07:07.315037 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:dfda8314-12bf-41bd-97d2-8e1d8ffad229&page=queryresults
[0m09:07:08.373956 [info ] [Thread-1  ]: 17 of 32 PASS not_null_fct_trips_dropoff_time_id ............................... [[32mPASS[0m in 2.12s]
[0m09:07:08.385288 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_dropoff_time_id.781496e98f
[0m09:07:08.390307 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_extra.1801055bb3
[0m09:07:08.393875 [info ] [Thread-1  ]: 18 of 32 START test not_null_fct_trips_extra ................................... [RUN]
[0m09:07:08.398390 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_dropoff_time_id.781496e98f, now test.nyc_taxi.not_null_fct_trips_extra.1801055bb3)
[0m09:07:08.401929 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_extra.1801055bb3
[0m09:07:08.426105 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_extra.1801055bb3"
[0m09:07:08.449081 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_extra.1801055bb3
[0m09:07:08.463025 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_fct_trips_extra.1801055bb3"
[0m09:07:08.486648 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m09:07:08.497671 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_fct_trips_extra.1801055bb3: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_fct_trips_extra.1801055bb3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select extra
from `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips`
where extra is null



      
    ) dbt_internal_test
[0m09:07:09.377532 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:919cff70-91dd-4742-b356-773700d92cb1&page=queryresults
[0m09:07:10.470999 [info ] [Thread-1  ]: 18 of 32 PASS not_null_fct_trips_extra ......................................... [[32mPASS[0m in 2.07s]
[0m09:07:10.476221 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_extra.1801055bb3
[0m09:07:10.480249 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_improvement_surcharge.4cf28d1443
[0m09:07:10.483692 [info ] [Thread-1  ]: 19 of 32 START test not_null_fct_trips_improvement_surcharge ................... [RUN]
[0m09:07:10.487145 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_extra.1801055bb3, now test.nyc_taxi.not_null_fct_trips_improvement_surcharge.4cf28d1443)
[0m09:07:10.491023 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_improvement_surcharge.4cf28d1443
[0m09:07:10.510549 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_improvement_surcharge.4cf28d1443"
[0m09:07:10.535218 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_improvement_surcharge.4cf28d1443
[0m09:07:10.550264 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_fct_trips_improvement_surcharge.4cf28d1443"
[0m09:07:10.579784 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m09:07:10.592666 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_fct_trips_improvement_surcharge.4cf28d1443: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_fct_trips_improvement_surcharge.4cf28d1443"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select improvement_surcharge
from `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips`
where improvement_surcharge is null



      
    ) dbt_internal_test
[0m09:07:11.614163 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:dff79414-4ee1-40cf-adeb-9d361c127359&page=queryresults
[0m09:07:12.663081 [info ] [Thread-1  ]: 19 of 32 PASS not_null_fct_trips_improvement_surcharge ......................... [[32mPASS[0m in 2.18s]
[0m09:07:12.670011 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_improvement_surcharge.4cf28d1443
[0m09:07:12.677166 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_passenger_count.b1370cab1c
[0m09:07:12.681817 [info ] [Thread-1  ]: 20 of 32 START test not_null_fct_trips_passenger_count ......................... [RUN]
[0m09:07:12.686817 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_improvement_surcharge.4cf28d1443, now test.nyc_taxi.not_null_fct_trips_passenger_count.b1370cab1c)
[0m09:07:12.691076 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_passenger_count.b1370cab1c
[0m09:07:12.712068 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_passenger_count.b1370cab1c"
[0m09:07:12.735053 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_passenger_count.b1370cab1c
[0m09:07:12.754432 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_fct_trips_passenger_count.b1370cab1c"
[0m09:07:12.778701 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m09:07:12.791955 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_fct_trips_passenger_count.b1370cab1c: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_fct_trips_passenger_count.b1370cab1c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select passenger_count
from `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips`
where passenger_count is null



      
    ) dbt_internal_test
[0m09:07:13.710678 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:bc2e0017-c6e3-4516-9ac9-5ed68a97c55e&page=queryresults
[0m09:07:14.734081 [info ] [Thread-1  ]: 20 of 32 PASS not_null_fct_trips_passenger_count ............................... [[32mPASS[0m in 2.05s]
[0m09:07:14.739129 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_passenger_count.b1370cab1c
[0m09:07:14.744368 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_payment_type.93889b679a
[0m09:07:14.747909 [info ] [Thread-1  ]: 21 of 32 START test not_null_fct_trips_payment_type ............................ [RUN]
[0m09:07:14.751186 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_passenger_count.b1370cab1c, now test.nyc_taxi.not_null_fct_trips_payment_type.93889b679a)
[0m09:07:14.755082 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_payment_type.93889b679a
[0m09:07:14.774237 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_payment_type.93889b679a"
[0m09:07:14.795754 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_payment_type.93889b679a
[0m09:07:14.806881 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_fct_trips_payment_type.93889b679a"
[0m09:07:14.828967 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m09:07:14.838944 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_fct_trips_payment_type.93889b679a: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_fct_trips_payment_type.93889b679a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select payment_type
from `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips`
where payment_type is null



      
    ) dbt_internal_test
[0m09:07:15.763658 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:3c24201a-0247-4eff-a63d-4ac470c9afa9&page=queryresults
[0m09:07:16.857363 [info ] [Thread-1  ]: 21 of 32 PASS not_null_fct_trips_payment_type .................................. [[32mPASS[0m in 2.11s]
[0m09:07:16.861960 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_payment_type.93889b679a
[0m09:07:16.866552 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_pickup_time_id.f31fbe0eeb
[0m09:07:16.870198 [info ] [Thread-1  ]: 22 of 32 START test not_null_fct_trips_pickup_time_id .......................... [RUN]
[0m09:07:16.874163 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_payment_type.93889b679a, now test.nyc_taxi.not_null_fct_trips_pickup_time_id.f31fbe0eeb)
[0m09:07:16.877582 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_pickup_time_id.f31fbe0eeb
[0m09:07:16.902356 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_pickup_time_id.f31fbe0eeb"
[0m09:07:16.928294 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_pickup_time_id.f31fbe0eeb
[0m09:07:16.942504 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_fct_trips_pickup_time_id.f31fbe0eeb"
[0m09:07:16.962610 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m09:07:16.972333 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_fct_trips_pickup_time_id.f31fbe0eeb: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_fct_trips_pickup_time_id.f31fbe0eeb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select pickup_time_id
from `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips`
where pickup_time_id is null



      
    ) dbt_internal_test
[0m09:07:17.907116 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:475d353f-65dc-41da-bfa3-0837fe7926dd&page=queryresults
[0m09:07:18.962464 [info ] [Thread-1  ]: 22 of 32 PASS not_null_fct_trips_pickup_time_id ................................ [[32mPASS[0m in 2.09s]
[0m09:07:18.967912 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_pickup_time_id.f31fbe0eeb
[0m09:07:18.972741 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_pu_location_id.b0dc8dd185
[0m09:07:18.976649 [info ] [Thread-1  ]: 23 of 32 START test not_null_fct_trips_pu_location_id .......................... [RUN]
[0m09:07:18.980480 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_pickup_time_id.f31fbe0eeb, now test.nyc_taxi.not_null_fct_trips_pu_location_id.b0dc8dd185)
[0m09:07:18.983430 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_pu_location_id.b0dc8dd185
[0m09:07:19.009396 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_pu_location_id.b0dc8dd185"
[0m09:07:19.031969 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_pu_location_id.b0dc8dd185
[0m09:07:19.044167 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_fct_trips_pu_location_id.b0dc8dd185"
[0m09:07:19.070194 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m09:07:19.081136 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_fct_trips_pu_location_id.b0dc8dd185: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_fct_trips_pu_location_id.b0dc8dd185"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select pu_location_id
from `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips`
where pu_location_id is null



      
    ) dbt_internal_test
[0m09:07:20.225590 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:01f3d96d-b232-4d4e-adf8-bb7eed7b8375&page=queryresults
[0m09:07:21.291837 [info ] [Thread-1  ]: 23 of 32 PASS not_null_fct_trips_pu_location_id ................................ [[32mPASS[0m in 2.31s]
[0m09:07:21.296955 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_pu_location_id.b0dc8dd185
[0m09:07:21.300384 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_rate_code_id.ba0047eaae
[0m09:07:21.303049 [info ] [Thread-1  ]: 24 of 32 START test not_null_fct_trips_rate_code_id ............................ [RUN]
[0m09:07:21.307384 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_pu_location_id.b0dc8dd185, now test.nyc_taxi.not_null_fct_trips_rate_code_id.ba0047eaae)
[0m09:07:21.311450 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_rate_code_id.ba0047eaae
[0m09:07:21.333894 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_rate_code_id.ba0047eaae"
[0m09:07:21.353289 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_rate_code_id.ba0047eaae
[0m09:07:21.364669 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_fct_trips_rate_code_id.ba0047eaae"
[0m09:07:21.385622 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m09:07:21.395357 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_fct_trips_rate_code_id.ba0047eaae: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_fct_trips_rate_code_id.ba0047eaae"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select rate_code_id
from `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips`
where rate_code_id is null



      
    ) dbt_internal_test
[0m09:07:22.276722 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:5b09011a-f869-4d52-8cb7-621c7e9ad516&page=queryresults
[0m09:07:23.289274 [info ] [Thread-1  ]: 24 of 32 PASS not_null_fct_trips_rate_code_id .................................. [[32mPASS[0m in 1.98s]
[0m09:07:23.293929 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_rate_code_id.ba0047eaae
[0m09:07:23.303402 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_trip_distance.19cd17f1df
[0m09:07:23.307605 [info ] [Thread-1  ]: 25 of 32 START test not_null_fct_trips_trip_distance ........................... [RUN]
[0m09:07:23.311242 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_rate_code_id.ba0047eaae, now test.nyc_taxi.not_null_fct_trips_trip_distance.19cd17f1df)
[0m09:07:23.314836 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_trip_distance.19cd17f1df
[0m09:07:23.331982 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_trip_distance.19cd17f1df"
[0m09:07:23.356659 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_trip_distance.19cd17f1df
[0m09:07:23.368445 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_fct_trips_trip_distance.19cd17f1df"
[0m09:07:23.390785 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m09:07:23.401477 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_fct_trips_trip_distance.19cd17f1df: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_fct_trips_trip_distance.19cd17f1df"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select trip_distance
from `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips`
where trip_distance is null



      
    ) dbt_internal_test
[0m09:07:23.510487 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:d73d7836-8213-4b7e-888b-d9e7c1f63238&page=queryresults
[0m09:07:24.653989 [info ] [Thread-1  ]: 25 of 32 PASS not_null_fct_trips_trip_distance ................................. [[32mPASS[0m in 1.34s]
[0m09:07:24.659207 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_trip_distance.19cd17f1df
[0m09:07:24.663767 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_vendor_id.b9b2f380bb
[0m09:07:24.668121 [info ] [Thread-1  ]: 26 of 32 START test not_null_fct_trips_vendor_id ............................... [RUN]
[0m09:07:24.673633 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_trip_distance.19cd17f1df, now test.nyc_taxi.not_null_fct_trips_vendor_id.b9b2f380bb)
[0m09:07:24.678604 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_vendor_id.b9b2f380bb
[0m09:07:24.699279 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_vendor_id.b9b2f380bb"
[0m09:07:24.723671 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_vendor_id.b9b2f380bb
[0m09:07:24.736294 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_fct_trips_vendor_id.b9b2f380bb"
[0m09:07:24.764829 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m09:07:24.777625 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_fct_trips_vendor_id.b9b2f380bb: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_fct_trips_vendor_id.b9b2f380bb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select vendor_id
from `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips`
where vendor_id is null



      
    ) dbt_internal_test
[0m09:07:25.701572 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:7ec0e4fa-d83a-4348-9d40-4df12256bb8b&page=queryresults
[0m09:07:26.748852 [info ] [Thread-1  ]: 26 of 32 PASS not_null_fct_trips_vendor_id ..................................... [[32mPASS[0m in 2.08s]
[0m09:07:26.753615 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_vendor_id.b9b2f380bb
[0m09:07:26.757908 [debug] [Thread-1  ]: Began running node test.nyc_taxi.unique_dim_payment_type_id.dea55de04e
[0m09:07:26.762029 [info ] [Thread-1  ]: 27 of 32 START test unique_dim_payment_type_id ................................. [RUN]
[0m09:07:26.767268 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_vendor_id.b9b2f380bb, now test.nyc_taxi.unique_dim_payment_type_id.dea55de04e)
[0m09:07:26.771013 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.unique_dim_payment_type_id.dea55de04e
[0m09:07:26.805907 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.unique_dim_payment_type_id.dea55de04e"
[0m09:07:26.828859 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.unique_dim_payment_type_id.dea55de04e
[0m09:07:26.840356 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.unique_dim_payment_type_id.dea55de04e"
[0m09:07:26.861155 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m09:07:26.870717 [debug] [Thread-1  ]: On test.nyc_taxi.unique_dim_payment_type_id.dea55de04e: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.unique_dim_payment_type_id.dea55de04e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select type_id as unique_field
  from `northern-shield-437204-m0`.`nyc_taxi`.`dim_payment`
  where type_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m09:07:27.797058 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:0f72ef9e-fe97-4623-b6fc-668e46ac2af5&page=queryresults
[0m09:07:28.858215 [info ] [Thread-1  ]: 27 of 32 PASS unique_dim_payment_type_id ....................................... [[32mPASS[0m in 2.09s]
[0m09:07:28.863455 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.unique_dim_payment_type_id.dea55de04e
[0m09:07:28.868745 [debug] [Thread-1  ]: Began running node test.nyc_taxi.unique_dim_ratecode_rate_id.75ae8e4885
[0m09:07:28.872918 [info ] [Thread-1  ]: 28 of 32 START test unique_dim_ratecode_rate_id ................................ [RUN]
[0m09:07:28.876702 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.unique_dim_payment_type_id.dea55de04e, now test.nyc_taxi.unique_dim_ratecode_rate_id.75ae8e4885)
[0m09:07:28.880044 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.unique_dim_ratecode_rate_id.75ae8e4885
[0m09:07:28.897693 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.unique_dim_ratecode_rate_id.75ae8e4885"
[0m09:07:28.921554 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.unique_dim_ratecode_rate_id.75ae8e4885
[0m09:07:28.934950 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.unique_dim_ratecode_rate_id.75ae8e4885"
[0m09:07:28.956850 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m09:07:28.966312 [debug] [Thread-1  ]: On test.nyc_taxi.unique_dim_ratecode_rate_id.75ae8e4885: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.unique_dim_ratecode_rate_id.75ae8e4885"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select rate_id as unique_field
  from `northern-shield-437204-m0`.`nyc_taxi`.`dim_ratecode`
  where rate_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m09:07:30.015741 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:c92a9f43-d12e-44fc-b4d2-f27485918a35&page=queryresults
[0m09:07:31.101475 [info ] [Thread-1  ]: 28 of 32 PASS unique_dim_ratecode_rate_id ...................................... [[32mPASS[0m in 2.22s]
[0m09:07:31.106450 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.unique_dim_ratecode_rate_id.75ae8e4885
[0m09:07:31.110989 [debug] [Thread-1  ]: Began running node test.nyc_taxi.unique_dim_time_time_id.0752c025e8
[0m09:07:31.114176 [info ] [Thread-1  ]: 29 of 32 START test unique_dim_time_time_id .................................... [RUN]
[0m09:07:31.118361 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.unique_dim_ratecode_rate_id.75ae8e4885, now test.nyc_taxi.unique_dim_time_time_id.0752c025e8)
[0m09:07:31.121631 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.unique_dim_time_time_id.0752c025e8
[0m09:07:31.143266 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.unique_dim_time_time_id.0752c025e8"
[0m09:07:31.168460 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.unique_dim_time_time_id.0752c025e8
[0m09:07:31.187391 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.unique_dim_time_time_id.0752c025e8"
[0m09:07:31.206131 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m09:07:31.217203 [debug] [Thread-1  ]: On test.nyc_taxi.unique_dim_time_time_id.0752c025e8: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.unique_dim_time_time_id.0752c025e8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select time_id as unique_field
  from `northern-shield-437204-m0`.`nyc_taxi`.`dim_time`
  where time_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m09:07:32.196073 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:88ceb842-ec15-442f-a27a-bb2267f1bd99&page=queryresults
[0m09:07:33.233403 [info ] [Thread-1  ]: 29 of 32 PASS unique_dim_time_time_id .......................................... [[32mPASS[0m in 2.11s]
[0m09:07:33.239368 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.unique_dim_time_time_id.0752c025e8
[0m09:07:33.243370 [debug] [Thread-1  ]: Began running node test.nyc_taxi.unique_dim_vendor_id.03fad38d04
[0m09:07:33.246625 [info ] [Thread-1  ]: 30 of 32 START test unique_dim_vendor_id ....................................... [RUN]
[0m09:07:33.250300 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.unique_dim_time_time_id.0752c025e8, now test.nyc_taxi.unique_dim_vendor_id.03fad38d04)
[0m09:07:33.253826 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.unique_dim_vendor_id.03fad38d04
[0m09:07:33.271709 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.unique_dim_vendor_id.03fad38d04"
[0m09:07:33.306071 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.unique_dim_vendor_id.03fad38d04
[0m09:07:33.318918 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.unique_dim_vendor_id.03fad38d04"
[0m09:07:33.344518 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m09:07:33.354830 [debug] [Thread-1  ]: On test.nyc_taxi.unique_dim_vendor_id.03fad38d04: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.unique_dim_vendor_id.03fad38d04"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select id as unique_field
  from `northern-shield-437204-m0`.`nyc_taxi`.`dim_vendor`
  where id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m09:07:34.299613 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:862b5306-1b78-4357-873f-68274ca9c3ee&page=queryresults
[0m09:07:35.297121 [info ] [Thread-1  ]: 30 of 32 PASS unique_dim_vendor_id ............................................. [[32mPASS[0m in 2.05s]
[0m09:07:35.303626 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.unique_dim_vendor_id.03fad38d04
[0m09:07:35.309004 [debug] [Thread-1  ]: Began running node test.nyc_taxi.unique_dim_zone_location_id.7702f92424
[0m09:07:35.312773 [info ] [Thread-1  ]: 31 of 32 START test unique_dim_zone_location_id ................................ [RUN]
[0m09:07:35.316787 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.unique_dim_vendor_id.03fad38d04, now test.nyc_taxi.unique_dim_zone_location_id.7702f92424)
[0m09:07:35.321066 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.unique_dim_zone_location_id.7702f92424
[0m09:07:35.344649 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.unique_dim_zone_location_id.7702f92424"
[0m09:07:35.368037 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.unique_dim_zone_location_id.7702f92424
[0m09:07:35.382472 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.unique_dim_zone_location_id.7702f92424"
[0m09:07:35.404755 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m09:07:35.414842 [debug] [Thread-1  ]: On test.nyc_taxi.unique_dim_zone_location_id.7702f92424: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.unique_dim_zone_location_id.7702f92424"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select location_id as unique_field
  from `northern-shield-437204-m0`.`nyc_taxi`.`dim_zone`
  where location_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m09:07:36.279788 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:0607b023-9482-4563-9029-f8a27c996f92&page=queryresults
[0m09:07:37.357359 [info ] [Thread-1  ]: 31 of 32 PASS unique_dim_zone_location_id ...................................... [[32mPASS[0m in 2.04s]
[0m09:07:37.363760 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.unique_dim_zone_location_id.7702f92424
[0m09:07:37.369185 [debug] [Thread-1  ]: Began running node test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab
[0m09:07:37.374182 [info ] [Thread-1  ]: 32 of 32 START test unique_fct_trips_trip_id ................................... [RUN]
[0m09:07:37.378809 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.unique_dim_zone_location_id.7702f92424, now test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab)
[0m09:07:37.382428 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab
[0m09:07:37.411332 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab"
[0m09:07:37.435190 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab
[0m09:07:37.446912 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab"
[0m09:07:37.473351 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m09:07:37.483551 [debug] [Thread-1  ]: On test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select trip_id as unique_field
  from `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips`
  where trip_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m09:07:38.707684 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:e4d8b87b-ff18-441d-864d-40eba9bfb5e4&page=queryresults
[0m09:07:39.693711 [info ] [Thread-1  ]: 32 of 32 PASS unique_fct_trips_trip_id ......................................... [[32mPASS[0m in 2.31s]
[0m09:07:39.699117 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab
[0m09:07:39.708379 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:07:39.711589 [debug] [MainThread]: Connection 'test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab' was properly closed.
[0m09:07:39.715234 [info ] [MainThread]: 
[0m09:07:39.719114 [info ] [MainThread]: Finished running 32 data tests in 0 hours 1 minutes and 8.39 seconds (68.39s).
[0m09:07:39.764280 [debug] [MainThread]: Command end result
[0m09:07:39.999735 [info ] [MainThread]: 
[0m09:07:40.002913 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:07:40.006008 [info ] [MainThread]: 
[0m09:07:40.009223 [info ] [MainThread]: Done. PASS=32 WARN=0 ERROR=0 SKIP=0 TOTAL=32
[0m09:07:40.014335 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 78.604256, "process_in_blocks": "1440", "process_kernel_time": 1.137592, "process_mem_max_rss": "231908", "process_out_blocks": "0", "process_user_time": 16.786905}
[0m09:07:40.018243 [debug] [MainThread]: Command `dbt test` succeeded at 09:07:40.017858 after 78.61 seconds
[0m09:07:40.021975 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6fe362b490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6faadab100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6fdc853d60>]}
[0m09:07:40.025351 [debug] [MainThread]: Flushing usage events
[0m09:21:18.562696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f7770e430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f75544b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f75544af0>]}


============================== 09:21:18.579827 | c6c65a08-4359-4a6f-b2d2-32f9359b1c7a ==============================
[0m09:21:18.579827 [info ] [MainThread]: Running with dbt=1.8.9
[0m09:21:18.583549 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'target_path': 'None', 'use_experimental_parser': 'False', 'use_colors': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': '/opt/airflow/include/dbt', 'version_check': 'True', 'warn_error': 'None', 'cache_selected_only': 'False', 'partial_parse': 'True', 'log_path': '/opt/airflow/include/dbt/logs', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'invocation_command': 'dbt docs generate', 'no_print': 'None', 'quiet': 'False', 'printer_width': '80', 'fail_fast': 'False', 'empty': 'None', 'introspect': 'True', 'write_json': 'True', 'log_format': 'default'}
[0m09:21:21.584435 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c6c65a08-4359-4a6f-b2d2-32f9359b1c7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f76f58100>]}
[0m09:21:21.789285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c6c65a08-4359-4a6f-b2d2-32f9359b1c7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f3e0de700>]}
[0m09:21:21.792928 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m09:21:22.355860 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m09:21:25.206860 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:21:25.210546 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:21:25.394642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c6c65a08-4359-4a6f-b2d2-32f9359b1c7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f707d3df0>]}
[0m09:21:25.459861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c6c65a08-4359-4a6f-b2d2-32f9359b1c7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f707f4a00>]}
[0m09:21:25.463919 [info ] [MainThread]: Found 6 models, 32 data tests, 2 sources, 600 macros
[0m09:21:25.470796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c6c65a08-4359-4a6f-b2d2-32f9359b1c7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f707f4a60>]}
[0m09:21:25.484780 [info ] [MainThread]: 
[0m09:21:25.496323 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m09:21:25.541151 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_northern-shield-437204-m0_nyc_taxi'
[0m09:21:25.544902 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:21:26.245237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c6c65a08-4359-4a6f-b2d2-32f9359b1c7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f77a5bac0>]}
[0m09:21:26.249186 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:21:26.252060 [info ] [MainThread]: 
[0m09:21:26.273803 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_payment
[0m09:21:26.277409 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_northern-shield-437204-m0_nyc_taxi, now model.nyc_taxi.dim_payment)
[0m09:21:26.280452 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_payment
[0m09:21:26.493610 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_payment"
[0m09:21:26.512198 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_payment
[0m09:21:26.516368 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_payment
[0m09:21:26.519607 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_ratecode
[0m09:21:26.523086 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_payment, now model.nyc_taxi.dim_ratecode)
[0m09:21:26.526040 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_ratecode
[0m09:21:26.537395 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_ratecode"
[0m09:21:26.557651 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_ratecode
[0m09:21:26.562424 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_ratecode
[0m09:21:26.566001 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_time
[0m09:21:26.569862 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_ratecode, now model.nyc_taxi.dim_time)
[0m09:21:26.573718 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_time
[0m09:21:26.587976 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_time"
[0m09:21:26.611544 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_time
[0m09:21:26.615720 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_time
[0m09:21:26.619129 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_vendor
[0m09:21:26.623383 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_time, now model.nyc_taxi.dim_vendor)
[0m09:21:26.626486 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_vendor
[0m09:21:26.637344 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_vendor"
[0m09:21:26.660725 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_vendor
[0m09:21:26.665444 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_vendor
[0m09:21:26.669149 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_zone
[0m09:21:26.672747 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_vendor, now model.nyc_taxi.dim_zone)
[0m09:21:26.676224 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_zone
[0m09:21:26.689347 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_zone"
[0m09:21:26.709978 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_zone
[0m09:21:26.714187 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_zone
[0m09:21:26.718005 [debug] [Thread-1  ]: Began running node test.nyc_taxi.accepted_values_dim_payment_payment_name__Credit_card__Cash__No_charge__Dispute__Unknown__Voided_trip.58d00ef9f4
[0m09:21:26.721487 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_zone, now test.nyc_taxi.accepted_values_dim_payment_payment_name__Credit_card__Cash__No_charge__Dispute__Unknown__Voided_trip.58d00ef9f4)
[0m09:21:26.724397 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.accepted_values_dim_payment_payment_name__Credit_card__Cash__No_charge__Dispute__Unknown__Voided_trip.58d00ef9f4
[0m09:21:26.776027 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.accepted_values_dim_payment_payment_name__Credit_card__Cash__No_charge__Dispute__Unknown__Voided_trip.58d00ef9f4"
[0m09:21:26.798089 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.accepted_values_dim_payment_payment_name__Credit_card__Cash__No_charge__Dispute__Unknown__Voided_trip.58d00ef9f4
[0m09:21:26.803354 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.accepted_values_dim_payment_payment_name__Credit_card__Cash__No_charge__Dispute__Unknown__Voided_trip.58d00ef9f4
[0m09:21:26.806886 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_dim_payment_type_id.96dfa722aa
[0m09:21:26.810042 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.accepted_values_dim_payment_payment_name__Credit_card__Cash__No_charge__Dispute__Unknown__Voided_trip.58d00ef9f4, now test.nyc_taxi.not_null_dim_payment_type_id.96dfa722aa)
[0m09:21:26.813770 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_dim_payment_type_id.96dfa722aa
[0m09:21:26.852774 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_dim_payment_type_id.96dfa722aa"
[0m09:21:26.878800 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_dim_payment_type_id.96dfa722aa
[0m09:21:26.883907 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_dim_payment_type_id.96dfa722aa
[0m09:21:26.887532 [debug] [Thread-1  ]: Began running node test.nyc_taxi.unique_dim_payment_type_id.dea55de04e
[0m09:21:26.890763 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_dim_payment_type_id.96dfa722aa, now test.nyc_taxi.unique_dim_payment_type_id.dea55de04e)
[0m09:21:26.893954 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.unique_dim_payment_type_id.dea55de04e
[0m09:21:26.915558 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.unique_dim_payment_type_id.dea55de04e"
[0m09:21:26.937753 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.unique_dim_payment_type_id.dea55de04e
[0m09:21:26.942274 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.unique_dim_payment_type_id.dea55de04e
[0m09:21:26.945583 [debug] [Thread-1  ]: Began running node test.nyc_taxi.accepted_values_dim_ratecode_rate_code_name__Standard_rate__JFK__Newark__Nassau_or_Westchester__Negotiated_fare__Group_ride__Unknown.57ee02019f
[0m09:21:26.949117 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.unique_dim_payment_type_id.dea55de04e, now test.nyc_taxi.accepted_values_dim_ratecode_rate_code_name__Standard_rate__JFK__Newark__Nassau_or_Westchester__Negotiated_fare__Group_ride__Unknown.57ee02019f)
[0m09:21:26.952252 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.accepted_values_dim_ratecode_rate_code_name__Standard_rate__JFK__Newark__Nassau_or_Westchester__Negotiated_fare__Group_ride__Unknown.57ee02019f
[0m09:21:26.977321 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.accepted_values_dim_ratecode_rate_code_name__Standard_rate__JFK__Newark__Nassau_or_Westchester__Negotiated_fare__Group_ride__Unknown.57ee02019f"
[0m09:21:27.004289 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.accepted_values_dim_ratecode_rate_code_name__Standard_rate__JFK__Newark__Nassau_or_Westchester__Negotiated_fare__Group_ride__Unknown.57ee02019f
[0m09:21:27.009142 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.accepted_values_dim_ratecode_rate_code_name__Standard_rate__JFK__Newark__Nassau_or_Westchester__Negotiated_fare__Group_ride__Unknown.57ee02019f
[0m09:21:27.013042 [debug] [Thread-1  ]: Began running node test.nyc_taxi.unique_dim_ratecode_rate_id.75ae8e4885
[0m09:21:27.016267 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.accepted_values_dim_ratecode_rate_code_name__Standard_rate__JFK__Newark__Nassau_or_Westchester__Negotiated_fare__Group_ride__Unknown.57ee02019f, now test.nyc_taxi.unique_dim_ratecode_rate_id.75ae8e4885)
[0m09:21:27.019319 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.unique_dim_ratecode_rate_id.75ae8e4885
[0m09:21:27.046415 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.unique_dim_ratecode_rate_id.75ae8e4885"
[0m09:21:27.070107 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.unique_dim_ratecode_rate_id.75ae8e4885
[0m09:21:27.075792 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.unique_dim_ratecode_rate_id.75ae8e4885
[0m09:21:27.080034 [debug] [Thread-1  ]: Began running node model.nyc_taxi.fct_trips
[0m09:21:27.083592 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.unique_dim_ratecode_rate_id.75ae8e4885, now model.nyc_taxi.fct_trips)
[0m09:21:27.086908 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.fct_trips
[0m09:21:27.148648 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.fct_trips"
[0m09:21:27.174208 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.fct_trips
[0m09:21:27.179090 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.fct_trips
[0m09:21:27.183314 [debug] [Thread-1  ]: Began running node test.nyc_taxi.accepted_values_dim_time_weekday__Sunday__Monday__Tuesday__Wednesday__Thursday__Friday__Saturday.87b4c2a366
[0m09:21:27.187763 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.fct_trips, now test.nyc_taxi.accepted_values_dim_time_weekday__Sunday__Monday__Tuesday__Wednesday__Thursday__Friday__Saturday.87b4c2a366)
[0m09:21:27.190861 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.accepted_values_dim_time_weekday__Sunday__Monday__Tuesday__Wednesday__Thursday__Friday__Saturday.87b4c2a366
[0m09:21:27.217919 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.accepted_values_dim_time_weekday__Sunday__Monday__Tuesday__Wednesday__Thursday__Friday__Saturday.87b4c2a366"
[0m09:21:27.244480 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.accepted_values_dim_time_weekday__Sunday__Monday__Tuesday__Wednesday__Thursday__Friday__Saturday.87b4c2a366
[0m09:21:27.249280 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.accepted_values_dim_time_weekday__Sunday__Monday__Tuesday__Wednesday__Thursday__Friday__Saturday.87b4c2a366
[0m09:21:27.252978 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_dim_time_date.2080f42875
[0m09:21:27.257588 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.accepted_values_dim_time_weekday__Sunday__Monday__Tuesday__Wednesday__Thursday__Friday__Saturday.87b4c2a366, now test.nyc_taxi.not_null_dim_time_date.2080f42875)
[0m09:21:27.261036 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_dim_time_date.2080f42875
[0m09:21:27.278948 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_dim_time_date.2080f42875"
[0m09:21:27.307184 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_dim_time_date.2080f42875
[0m09:21:27.311818 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_dim_time_date.2080f42875
[0m09:21:27.315778 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_dim_time_date_part.59e6206332
[0m09:21:27.319199 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_dim_time_date.2080f42875, now test.nyc_taxi.not_null_dim_time_date_part.59e6206332)
[0m09:21:27.322367 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_dim_time_date_part.59e6206332
[0m09:21:27.338098 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_dim_time_date_part.59e6206332"
[0m09:21:27.364771 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_dim_time_date_part.59e6206332
[0m09:21:27.370317 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_dim_time_date_part.59e6206332
[0m09:21:27.374319 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_dim_time_day.dc0e917166
[0m09:21:27.377945 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_dim_time_date_part.59e6206332, now test.nyc_taxi.not_null_dim_time_day.dc0e917166)
[0m09:21:27.381060 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_dim_time_day.dc0e917166
[0m09:21:27.403328 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_dim_time_day.dc0e917166"
[0m09:21:27.521732 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_dim_time_day.dc0e917166
[0m09:21:27.526683 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_dim_time_day.dc0e917166
[0m09:21:27.530509 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_dim_time_hour.5b8ccd8f25
[0m09:21:27.533437 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_dim_time_day.dc0e917166, now test.nyc_taxi.not_null_dim_time_hour.5b8ccd8f25)
[0m09:21:27.535975 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_dim_time_hour.5b8ccd8f25
[0m09:21:27.554257 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_dim_time_hour.5b8ccd8f25"
[0m09:21:27.580392 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_dim_time_hour.5b8ccd8f25
[0m09:21:27.585007 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_dim_time_hour.5b8ccd8f25
[0m09:21:27.589303 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_dim_time_minute.23e906ca61
[0m09:21:27.592532 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_dim_time_hour.5b8ccd8f25, now test.nyc_taxi.not_null_dim_time_minute.23e906ca61)
[0m09:21:27.596185 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_dim_time_minute.23e906ca61
[0m09:21:27.611985 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_dim_time_minute.23e906ca61"
[0m09:21:27.635803 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_dim_time_minute.23e906ca61
[0m09:21:27.640258 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_dim_time_minute.23e906ca61
[0m09:21:27.643830 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_dim_time_month.9f6ecf2eb5
[0m09:21:27.647171 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_dim_time_minute.23e906ca61, now test.nyc_taxi.not_null_dim_time_month.9f6ecf2eb5)
[0m09:21:27.651113 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_dim_time_month.9f6ecf2eb5
[0m09:21:27.668688 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_dim_time_month.9f6ecf2eb5"
[0m09:21:27.694823 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_dim_time_month.9f6ecf2eb5
[0m09:21:27.699984 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_dim_time_month.9f6ecf2eb5
[0m09:21:27.703678 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_dim_time_year.6fb9595d53
[0m09:21:27.706742 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_dim_time_month.9f6ecf2eb5, now test.nyc_taxi.not_null_dim_time_year.6fb9595d53)
[0m09:21:27.709914 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_dim_time_year.6fb9595d53
[0m09:21:27.725149 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_dim_time_year.6fb9595d53"
[0m09:21:27.749361 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_dim_time_year.6fb9595d53
[0m09:21:27.755069 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_dim_time_year.6fb9595d53
[0m09:21:27.759313 [debug] [Thread-1  ]: Began running node test.nyc_taxi.unique_dim_time_time_id.0752c025e8
[0m09:21:27.763127 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_dim_time_year.6fb9595d53, now test.nyc_taxi.unique_dim_time_time_id.0752c025e8)
[0m09:21:27.766280 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.unique_dim_time_time_id.0752c025e8
[0m09:21:27.785228 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.unique_dim_time_time_id.0752c025e8"
[0m09:21:27.808895 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.unique_dim_time_time_id.0752c025e8
[0m09:21:27.813736 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.unique_dim_time_time_id.0752c025e8
[0m09:21:27.822591 [debug] [Thread-1  ]: Began running node test.nyc_taxi.accepted_values_dim_vendor_vendor_name__Creative_Mobile_Technologies__VeriFone_Inc_.7481cecf07
[0m09:21:27.826623 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.unique_dim_time_time_id.0752c025e8, now test.nyc_taxi.accepted_values_dim_vendor_vendor_name__Creative_Mobile_Technologies__VeriFone_Inc_.7481cecf07)
[0m09:21:27.837198 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.accepted_values_dim_vendor_vendor_name__Creative_Mobile_Technologies__VeriFone_Inc_.7481cecf07
[0m09:21:27.860706 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.accepted_values_dim_vendor_vendor_name__Creative_Mobile_Technologies__VeriFone_Inc_.7481cecf07"
[0m09:21:27.883373 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.accepted_values_dim_vendor_vendor_name__Creative_Mobile_Technologies__VeriFone_Inc_.7481cecf07
[0m09:21:27.887963 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.accepted_values_dim_vendor_vendor_name__Creative_Mobile_Technologies__VeriFone_Inc_.7481cecf07
[0m09:21:27.891437 [debug] [Thread-1  ]: Began running node test.nyc_taxi.unique_dim_vendor_id.03fad38d04
[0m09:21:27.894157 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.accepted_values_dim_vendor_vendor_name__Creative_Mobile_Technologies__VeriFone_Inc_.7481cecf07, now test.nyc_taxi.unique_dim_vendor_id.03fad38d04)
[0m09:21:27.896869 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.unique_dim_vendor_id.03fad38d04
[0m09:21:27.911709 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.unique_dim_vendor_id.03fad38d04"
[0m09:21:27.937928 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.unique_dim_vendor_id.03fad38d04
[0m09:21:27.942670 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.unique_dim_vendor_id.03fad38d04
[0m09:21:27.946179 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_dim_zone_borough.1ed2272c52
[0m09:21:27.949756 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.unique_dim_vendor_id.03fad38d04, now test.nyc_taxi.not_null_dim_zone_borough.1ed2272c52)
[0m09:21:27.953169 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_dim_zone_borough.1ed2272c52
[0m09:21:27.968163 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_dim_zone_borough.1ed2272c52"
[0m09:21:27.996754 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_dim_zone_borough.1ed2272c52
[0m09:21:28.001393 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_dim_zone_borough.1ed2272c52
[0m09:21:28.005602 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_dim_zone_service_zone.2007f611c5
[0m09:21:28.009331 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_dim_zone_borough.1ed2272c52, now test.nyc_taxi.not_null_dim_zone_service_zone.2007f611c5)
[0m09:21:28.012667 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_dim_zone_service_zone.2007f611c5
[0m09:21:28.028133 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_dim_zone_service_zone.2007f611c5"
[0m09:21:28.054756 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_dim_zone_service_zone.2007f611c5
[0m09:21:28.059639 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_dim_zone_service_zone.2007f611c5
[0m09:21:28.063037 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_dim_zone_zone.a1c4a4c37a
[0m09:21:28.066298 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_dim_zone_service_zone.2007f611c5, now test.nyc_taxi.not_null_dim_zone_zone.a1c4a4c37a)
[0m09:21:28.069445 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_dim_zone_zone.a1c4a4c37a
[0m09:21:28.084942 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_dim_zone_zone.a1c4a4c37a"
[0m09:21:28.113038 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_dim_zone_zone.a1c4a4c37a
[0m09:21:28.117575 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_dim_zone_zone.a1c4a4c37a
[0m09:21:28.121058 [debug] [Thread-1  ]: Began running node test.nyc_taxi.unique_dim_zone_location_id.7702f92424
[0m09:21:28.124755 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_dim_zone_zone.a1c4a4c37a, now test.nyc_taxi.unique_dim_zone_location_id.7702f92424)
[0m09:21:28.128146 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.unique_dim_zone_location_id.7702f92424
[0m09:21:28.143612 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.unique_dim_zone_location_id.7702f92424"
[0m09:21:28.168817 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.unique_dim_zone_location_id.7702f92424
[0m09:21:28.173743 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.unique_dim_zone_location_id.7702f92424
[0m09:21:28.180952 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_do_location_id.6acdd302a6
[0m09:21:28.184274 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.unique_dim_zone_location_id.7702f92424, now test.nyc_taxi.not_null_fct_trips_do_location_id.6acdd302a6)
[0m09:21:28.187419 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_do_location_id.6acdd302a6
[0m09:21:28.202894 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_do_location_id.6acdd302a6"
[0m09:21:28.224328 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_do_location_id.6acdd302a6
[0m09:21:28.228988 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_do_location_id.6acdd302a6
[0m09:21:28.232408 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_dropoff_time_id.781496e98f
[0m09:21:28.235573 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_do_location_id.6acdd302a6, now test.nyc_taxi.not_null_fct_trips_dropoff_time_id.781496e98f)
[0m09:21:28.238899 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_dropoff_time_id.781496e98f
[0m09:21:28.254352 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_dropoff_time_id.781496e98f"
[0m09:21:28.279881 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_dropoff_time_id.781496e98f
[0m09:21:28.285235 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_dropoff_time_id.781496e98f
[0m09:21:28.288577 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_extra.1801055bb3
[0m09:21:28.291561 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_dropoff_time_id.781496e98f, now test.nyc_taxi.not_null_fct_trips_extra.1801055bb3)
[0m09:21:28.294792 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_extra.1801055bb3
[0m09:21:28.311696 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_extra.1801055bb3"
[0m09:21:28.336505 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_extra.1801055bb3
[0m09:21:28.341239 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_extra.1801055bb3
[0m09:21:28.344742 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_improvement_surcharge.4cf28d1443
[0m09:21:28.348146 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_extra.1801055bb3, now test.nyc_taxi.not_null_fct_trips_improvement_surcharge.4cf28d1443)
[0m09:21:28.352869 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_improvement_surcharge.4cf28d1443
[0m09:21:28.372045 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_improvement_surcharge.4cf28d1443"
[0m09:21:28.393110 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_improvement_surcharge.4cf28d1443
[0m09:21:28.397810 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_improvement_surcharge.4cf28d1443
[0m09:21:28.401272 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_passenger_count.b1370cab1c
[0m09:21:28.404193 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_improvement_surcharge.4cf28d1443, now test.nyc_taxi.not_null_fct_trips_passenger_count.b1370cab1c)
[0m09:21:28.406670 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_passenger_count.b1370cab1c
[0m09:21:28.421118 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_passenger_count.b1370cab1c"
[0m09:21:28.445236 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_passenger_count.b1370cab1c
[0m09:21:28.450364 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_passenger_count.b1370cab1c
[0m09:21:28.453995 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_payment_type.93889b679a
[0m09:21:28.457239 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_passenger_count.b1370cab1c, now test.nyc_taxi.not_null_fct_trips_payment_type.93889b679a)
[0m09:21:28.460486 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_payment_type.93889b679a
[0m09:21:28.479036 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_payment_type.93889b679a"
[0m09:21:28.505247 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_payment_type.93889b679a
[0m09:21:28.510132 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_payment_type.93889b679a
[0m09:21:28.513772 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_pickup_time_id.f31fbe0eeb
[0m09:21:28.516914 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_payment_type.93889b679a, now test.nyc_taxi.not_null_fct_trips_pickup_time_id.f31fbe0eeb)
[0m09:21:28.519714 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_pickup_time_id.f31fbe0eeb
[0m09:21:28.538255 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_pickup_time_id.f31fbe0eeb"
[0m09:21:28.565405 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_pickup_time_id.f31fbe0eeb
[0m09:21:28.570835 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_pickup_time_id.f31fbe0eeb
[0m09:21:28.574757 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_pu_location_id.b0dc8dd185
[0m09:21:28.578387 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_pickup_time_id.f31fbe0eeb, now test.nyc_taxi.not_null_fct_trips_pu_location_id.b0dc8dd185)
[0m09:21:28.583024 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_pu_location_id.b0dc8dd185
[0m09:21:28.598896 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_pu_location_id.b0dc8dd185"
[0m09:21:28.621834 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_pu_location_id.b0dc8dd185
[0m09:21:28.626911 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_pu_location_id.b0dc8dd185
[0m09:21:28.630844 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_rate_code_id.ba0047eaae
[0m09:21:28.633638 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_pu_location_id.b0dc8dd185, now test.nyc_taxi.not_null_fct_trips_rate_code_id.ba0047eaae)
[0m09:21:28.636285 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_rate_code_id.ba0047eaae
[0m09:21:28.651557 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_rate_code_id.ba0047eaae"
[0m09:21:28.674650 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_rate_code_id.ba0047eaae
[0m09:21:28.679308 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_rate_code_id.ba0047eaae
[0m09:21:28.682992 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_trip_distance.19cd17f1df
[0m09:21:28.686098 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_rate_code_id.ba0047eaae, now test.nyc_taxi.not_null_fct_trips_trip_distance.19cd17f1df)
[0m09:21:28.688987 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_trip_distance.19cd17f1df
[0m09:21:28.704289 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_trip_distance.19cd17f1df"
[0m09:21:28.724880 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_trip_distance.19cd17f1df
[0m09:21:28.729207 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_trip_distance.19cd17f1df
[0m09:21:28.733064 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_vendor_id.b9b2f380bb
[0m09:21:28.736110 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_trip_distance.19cd17f1df, now test.nyc_taxi.not_null_fct_trips_vendor_id.b9b2f380bb)
[0m09:21:28.739147 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_vendor_id.b9b2f380bb
[0m09:21:28.757298 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_vendor_id.b9b2f380bb"
[0m09:21:28.783225 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_vendor_id.b9b2f380bb
[0m09:21:28.787877 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_vendor_id.b9b2f380bb
[0m09:21:28.791143 [debug] [Thread-1  ]: Began running node test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab
[0m09:21:28.795077 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_vendor_id.b9b2f380bb, now test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab)
[0m09:21:28.798342 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab
[0m09:21:28.817523 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab"
[0m09:21:28.839619 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab
[0m09:21:28.844572 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab
[0m09:21:28.850437 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:21:28.853497 [debug] [MainThread]: Connection 'test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab' was properly closed.
[0m09:21:28.882931 [debug] [MainThread]: Command end result
[0m09:21:29.443892 [debug] [MainThread]: Acquiring new bigquery connection 'generate_catalog'
[0m09:21:29.447009 [info ] [MainThread]: Building catalog
[0m09:21:29.471417 [debug] [ThreadPool]: Acquiring new bigquery connection 'northern-shield-437204-m0.information_schema'
[0m09:21:29.549848 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:21:29.561441 [debug] [ThreadPool]: On northern-shield-437204-m0.information_schema: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "connection_name": "northern-shield-437204-m0.information_schema"} */

    with
                table_shards_stage as (
    select
        tables.project_id as table_catalog,
        tables.dataset_id as table_schema,
        coalesce(REGEXP_EXTRACT(tables.table_id, '^(.+)[0-9]{8}$'), tables.table_id) as table_name,
        tables.table_id as shard_name,
        REGEXP_EXTRACT(tables.table_id, '^.+([0-9]{8})$') as shard_index,
        REGEXP_CONTAINS(tables.table_id, '^.+[0-9]{8}$') and tables.type = 1 as is_date_shard,
        case
            when materialized_views.table_name is not null then 'materialized view'
            when tables.type = 1 then 'table'
            when tables.type = 2 then 'view'
            else 'external'
        end as table_type,
        tables.type = 1 as is_table,
        JSON_VALUE(table_description.option_value) as table_comment,
        tables.size_bytes,
        tables.row_count
    from `northern-shield-437204-m0`.`nyc_taxi`.__TABLES__ tables
    left join `northern-shield-437204-m0`.`nyc_taxi`.INFORMATION_SCHEMA.MATERIALIZED_VIEWS materialized_views
        on materialized_views.table_catalog = tables.project_id
        and materialized_views.table_schema = tables.dataset_id
        and materialized_views.table_name = tables.table_id
    left join `northern-shield-437204-m0`.`nyc_taxi`.INFORMATION_SCHEMA.TABLE_OPTIONS table_description
        on table_description.table_catalog = tables.project_id
        and table_description.table_schema = tables.dataset_id
        and table_description.table_name = tables.table_id
        and table_description.option_name = 'description'
),
                table_shards as (
                    select * from table_shards_stage
                    where ((
                                upper(table_schema) = upper('nyc_taxi')
                            and upper(table_name) = upper('dim_time')
                            ) or (
                                upper(table_schema) = upper('nyc_taxi')
                            and upper(table_name) = upper('dim_vendor')
                            ) or (
                                upper(table_schema) = upper('nyc_taxi')
                            and upper(table_name) = upper('fct_trips')
                            ) or (
                                upper(table_schema) = upper('nyc_taxi')
                            and upper(table_name) = upper('dim_zone')
                            ) or (
                                upper(table_schema) = upper('nyc_taxi')
                            and upper(table_name) = upper('dim_payment')
                            ) or (
                                upper(table_schema) = upper('nyc_taxi')
                            and upper(table_name) = upper('zone_map')
                            ) or (
                                upper(table_schema) = upper('nyc_taxi')
                            and upper(table_name) = upper('green_tripdata')
                            ) or (
                                upper(table_schema) = upper('nyc_taxi')
                            and upper(table_name) = upper('dim_ratecode')
                            ))
                ),
                tables as (
    select distinct
        table_catalog,
        table_schema,
        table_name,
        is_date_shard,
        table_type,
        is_table,
        table_comment
    from table_shards
),
                table_stats as (
    select
        table_catalog,
        table_schema,
        table_name,
        max(shard_name) as latest_shard_name,
        min(shard_index) as shard_min,
        max(shard_index) as shard_max,
        count(shard_index) as shard_count,
        sum(size_bytes) as size_bytes,
        sum(row_count) as row_count
    from table_shards
    group by 1, 2, 3
),

                columns as (
    select
        columns.table_catalog,
        columns.table_schema,
        columns.table_name as shard_name,
        coalesce(paths.field_path, '<unknown>') as column_name,
        -- invent a row number to account for nested fields
        -- BQ does not treat these nested properties as independent fields
        row_number() over (
            partition by
                columns.table_catalog,
                columns.table_schema,
                columns.table_name
            order by
                columns.ordinal_position,
                paths.field_path
        ) as column_index,
        coalesce(paths.data_type, '<unknown>') as column_type,
        paths.description as column_comment,
        case when columns.is_partitioning_column = 'YES' then 1 else 0 end as is_partitioning_column,
        case when columns.is_partitioning_column = 'YES' then paths.field_path end as partition_column,
        case when columns.clustering_ordinal_position is not null then 1 else 0 end as is_clustering_column,
        case when columns.clustering_ordinal_position is not null then paths.field_path end as cluster_column,
        columns.clustering_ordinal_position
    from `northern-shield-437204-m0`.`nyc_taxi`.INFORMATION_SCHEMA.COLUMNS columns
    join `northern-shield-437204-m0`.`nyc_taxi`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS paths
        on paths.table_catalog = columns.table_catalog
        and paths.table_schema = columns.table_schema
        and paths.table_name = columns.table_name
        and paths.column_name = columns.column_name
    where columns.ordinal_position is not null
),
                column_stats as (
    select
        table_catalog,
        table_schema,
        shard_name,
        max(is_partitioning_column) = 1 as is_partitioned,
        max(partition_column) as partition_column,
        max(is_clustering_column) = 1 as is_clustered,
        array_to_string(
            array_agg(
                cluster_column ignore nulls
                order by clustering_ordinal_position
            ), ', '
        ) as clustering_columns
    from columns
    group by 1, 2, 3
)

            
    select
        tables.table_catalog as table_database,
        tables.table_schema,
        case
            when tables.is_date_shard then concat(tables.table_name, '*')
            else tables.table_name
        end as table_name,
        tables.table_type,
        tables.table_comment,
        -- coalesce column metadata fields to ensure they are non-null for catalog generation
        -- external table columns are not present in COLUMN_FIELD_PATHS
        coalesce(columns.column_name, '<unknown>') as column_name,
        coalesce(columns.column_index, 1) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        coalesce(columns.column_comment, '') as column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_stats.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        tables.is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_stats.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        tables.is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_stats.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        tables.is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        table_stats.row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        tables.is_table as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        table_stats.size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        tables.is_table as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        column_stats.partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        column_stats.is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        column_stats.clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        column_stats.is_clustered as `stats__clustering_fields__include`

    from tables
    join table_stats
        on table_stats.table_catalog = tables.table_catalog
        and table_stats.table_schema = tables.table_schema
        and table_stats.table_name = tables.table_name
    left join column_stats
        on column_stats.table_catalog = tables.table_catalog
        and column_stats.table_schema = tables.table_schema
        and column_stats.shard_name = table_stats.latest_shard_name
    left join columns
        on columns.table_catalog = tables.table_catalog
        and columns.table_schema = tables.table_schema
        and columns.shard_name = table_stats.latest_shard_name

  
[0m09:21:30.338790 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:4f2d96c9-b6a9-41e7-b169-e8de6dc742e5&page=queryresults
[0m09:21:32.257820 [info ] [MainThread]: Catalog written to /opt/airflow/include/dbt/target/catalog.json
[0m09:21:32.263910 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 14.758327, "process_in_blocks": "4968", "process_kernel_time": 1.020984, "process_mem_max_rss": "237168", "process_out_blocks": "0", "process_user_time": 12.459978}
[0m09:21:32.268719 [debug] [MainThread]: Command `dbt docs generate` succeeded at 09:21:32.268167 after 14.76 seconds
[0m09:21:32.272699 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m09:21:32.275997 [debug] [MainThread]: Connection 'northern-shield-437204-m0.information_schema' was properly closed.
[0m09:21:32.278819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f7770e430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f70823310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f708230a0>]}
[0m09:21:32.281665 [debug] [MainThread]: Flushing usage events
[0m09:21:52.178828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc62dd96f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc62bb6aa00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc62bb6a9a0>]}


============================== 09:21:52.198546 | a26551df-3f79-4266-a5a5-9a692956542a ==============================
[0m09:21:52.198546 [info ] [MainThread]: Running with dbt=1.8.9
[0m09:21:52.203320 [debug] [MainThread]: running dbt with arguments {'send_anonymous_usage_stats': 'True', 'debug': 'False', 'partial_parse': 'True', 'fail_fast': 'False', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'version_check': 'True', 'introspect': 'True', 'log_path': '/opt/airflow/include/dbt/logs', 'use_experimental_parser': 'False', 'no_print': 'None', 'static_parser': 'True', 'quiet': 'False', 'printer_width': '80', 'profiles_dir': '/opt/airflow/include/dbt', 'warn_error': 'None', 'use_colors': 'True', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt docs serve', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'cache_selected_only': 'False', 'write_json': 'True'}
[0m09:21:55.265438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a26551df-3f79-4266-a5a5-9a692956542a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc62bc0cc10>]}
[0m09:21:55.437353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a26551df-3f79-4266-a5a5-9a692956542a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc62c360be0>]}
[0m09:23:07.828502 [error] [MainThread]: Encountered an error:

[0m09:23:07.837064 [error] [MainThread]: Traceback (most recent call last):
  File "/opt/airflow/dbt_venv/lib/python3.9/site-packages/dbt/cli/requires.py", line 138, in wrapper
    result, success = func(*args, **kwargs)
  File "/opt/airflow/dbt_venv/lib/python3.9/site-packages/dbt/cli/requires.py", line 101, in wrapper
    return func(*args, **kwargs)
  File "/opt/airflow/dbt_venv/lib/python3.9/site-packages/dbt/cli/requires.py", line 218, in wrapper
    return func(*args, **kwargs)
  File "/opt/airflow/dbt_venv/lib/python3.9/site-packages/dbt/cli/requires.py", line 247, in wrapper
    return func(*args, **kwargs)
  File "/opt/airflow/dbt_venv/lib/python3.9/site-packages/dbt/cli/requires.py", line 294, in wrapper
    return func(*args, **kwargs)
  File "/opt/airflow/dbt_venv/lib/python3.9/site-packages/dbt/cli/main.py", line 303, in docs_serve
    results = task.run()
  File "/opt/airflow/dbt_venv/lib/python3.9/site-packages/dbt/task/docs/serve.py", line 29, in run
    httpd.serve_forever()
  File "/usr/local/lib/python3.9/socketserver.py", line 232, in serve_forever
    ready = selector.select(poll_interval)
  File "/usr/local/lib/python3.9/selectors.py", line 416, in select
    fd_event_list = self._selector.poll(timeout)
KeyboardInterrupt

[0m09:23:07.846405 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_success": false, "command_wall_clock_time": 78.21153, "process_in_blocks": "48", "process_kernel_time": 0.466134, "process_mem_max_rss": "237116", "process_out_blocks": "0", "process_user_time": 9.322685}
[0m09:23:07.851170 [debug] [MainThread]: Command `dbt docs serve` failed at 09:23:07.850591 after 78.22 seconds
[0m09:23:07.854758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc62dd96f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5f86914c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5f8691610>]}
[0m09:23:07.858466 [debug] [MainThread]: Flushing usage events
[0m09:26:51.181499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdde9577400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdde73aea00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdde73ae9a0>]}


============================== 09:26:51.198260 | b0864fd0-37eb-4178-bbe3-365515051dfd ==============================
[0m09:26:51.198260 [info ] [MainThread]: Running with dbt=1.8.9
[0m09:26:51.202038 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'use_experimental_parser': 'False', 'use_colors': 'True', 'no_print': 'None', 'invocation_command': 'dbt docs serve --port 8001', 'version_check': 'True', 'log_path': '/opt/airflow/include/dbt/logs', 'printer_width': '80', 'introspect': 'True', 'write_json': 'True', 'debug': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'quiet': 'False', 'warn_error': 'None', 'log_cache_events': 'False', 'fail_fast': 'False', 'empty': 'None', 'partial_parse': 'True', 'indirect_selection': 'eager', 'profiles_dir': '/opt/airflow/include/dbt', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'cache_selected_only': 'False', 'target_path': 'None'}
[0m09:26:53.634809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b0864fd0-37eb-4178-bbe3-365515051dfd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fddaffff0d0>]}
[0m09:26:53.817176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b0864fd0-37eb-4178-bbe3-365515051dfd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fddb4d4ec40>]}
[0m09:28:16.558072 [error] [MainThread]: Encountered an error:

[0m09:28:16.563728 [error] [MainThread]: Traceback (most recent call last):
  File "/opt/airflow/dbt_venv/lib/python3.9/site-packages/dbt/cli/requires.py", line 138, in wrapper
    result, success = func(*args, **kwargs)
  File "/opt/airflow/dbt_venv/lib/python3.9/site-packages/dbt/cli/requires.py", line 101, in wrapper
    return func(*args, **kwargs)
  File "/opt/airflow/dbt_venv/lib/python3.9/site-packages/dbt/cli/requires.py", line 218, in wrapper
    return func(*args, **kwargs)
  File "/opt/airflow/dbt_venv/lib/python3.9/site-packages/dbt/cli/requires.py", line 247, in wrapper
    return func(*args, **kwargs)
  File "/opt/airflow/dbt_venv/lib/python3.9/site-packages/dbt/cli/requires.py", line 294, in wrapper
    return func(*args, **kwargs)
  File "/opt/airflow/dbt_venv/lib/python3.9/site-packages/dbt/cli/main.py", line 303, in docs_serve
    results = task.run()
  File "/opt/airflow/dbt_venv/lib/python3.9/site-packages/dbt/task/docs/serve.py", line 29, in run
    httpd.serve_forever()
  File "/usr/local/lib/python3.9/socketserver.py", line 232, in serve_forever
    ready = selector.select(poll_interval)
  File "/usr/local/lib/python3.9/selectors.py", line 416, in select
    fd_event_list = self._selector.poll(timeout)
KeyboardInterrupt

[0m09:28:16.570250 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_success": false, "command_wall_clock_time": 88.12455, "process_in_blocks": "0", "process_kernel_time": 0.620965, "process_mem_max_rss": "235384", "process_out_blocks": "0", "process_user_time": 9.566743}
[0m09:28:16.576468 [debug] [MainThread]: Command `dbt docs serve` failed at 09:28:16.575834 after 88.13 seconds
[0m09:28:16.580595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdde9577400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fddafea95b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fddafea9520>]}
[0m09:28:16.584310 [debug] [MainThread]: Flushing usage events
[0m09:33:20.612025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3cd548f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3cb31cb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3cb31caf0>]}


============================== 09:33:20.637596 | 8b75bc10-2612-437c-b0b3-caa8a2a0b346 ==============================
[0m09:33:20.637596 [info ] [MainThread]: Running with dbt=1.8.9
[0m09:33:20.641449 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'profiles_dir': '/opt/airflow/include/dbt', 'printer_width': '80', 'introspect': 'True', 'invocation_command': 'dbt docs generate', 'static_parser': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'log_format': 'default', 'log_path': '/opt/airflow/include/dbt/logs', 'version_check': 'True', 'quiet': 'False', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'cache_selected_only': 'False', 'debug': 'False', 'fail_fast': 'False', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'use_colors': 'True', 'write_json': 'True', 'no_print': 'None'}
[0m09:33:24.254264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8b75bc10-2612-437c-b0b3-caa8a2a0b346', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3cd880d90>]}
[0m09:33:24.437637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8b75bc10-2612-437c-b0b3-caa8a2a0b346', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3cb3a91c0>]}
[0m09:33:24.441126 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m09:33:24.981247 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m09:33:28.262680 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:33:28.265927 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:33:28.452362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8b75bc10-2612-437c-b0b3-caa8a2a0b346', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3c65d3ee0>]}
[0m09:33:28.511319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8b75bc10-2612-437c-b0b3-caa8a2a0b346', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3c65f4a00>]}
[0m09:33:28.514990 [info ] [MainThread]: Found 6 models, 32 data tests, 2 sources, 600 macros
[0m09:33:28.517775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8b75bc10-2612-437c-b0b3-caa8a2a0b346', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3c65f4a60>]}
[0m09:33:28.527042 [info ] [MainThread]: 
[0m09:33:28.530676 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m09:33:28.548599 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_northern-shield-437204-m0_nyc_taxi'
[0m09:33:28.552086 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:33:29.344219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8b75bc10-2612-437c-b0b3-caa8a2a0b346', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3ccbf04c0>]}
[0m09:33:29.348093 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:33:29.350729 [info ] [MainThread]: 
[0m09:33:29.376225 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_payment
[0m09:33:29.379727 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_northern-shield-437204-m0_nyc_taxi, now model.nyc_taxi.dim_payment)
[0m09:33:29.383374 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_payment
[0m09:33:29.612528 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_payment"
[0m09:33:29.636590 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_payment
[0m09:33:29.642958 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_payment
[0m09:33:29.647293 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_ratecode
[0m09:33:29.651229 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_payment, now model.nyc_taxi.dim_ratecode)
[0m09:33:29.654376 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_ratecode
[0m09:33:29.666034 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_ratecode"
[0m09:33:29.685221 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_ratecode
[0m09:33:29.690043 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_ratecode
[0m09:33:29.693822 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_time
[0m09:33:29.697380 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_ratecode, now model.nyc_taxi.dim_time)
[0m09:33:29.700485 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_time
[0m09:33:29.713922 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_time"
[0m09:33:29.736307 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_time
[0m09:33:29.741123 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_time
[0m09:33:29.745161 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_vendor
[0m09:33:29.749375 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_time, now model.nyc_taxi.dim_vendor)
[0m09:33:29.752802 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_vendor
[0m09:33:29.764280 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_vendor"
[0m09:33:29.787781 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_vendor
[0m09:33:29.792804 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_vendor
[0m09:33:29.796121 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_zone
[0m09:33:29.799389 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_vendor, now model.nyc_taxi.dim_zone)
[0m09:33:29.805063 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_zone
[0m09:33:29.817990 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_zone"
[0m09:33:29.843197 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_zone
[0m09:33:29.849980 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_zone
[0m09:33:29.854000 [debug] [Thread-1  ]: Began running node test.nyc_taxi.accepted_values_dim_payment_payment_name__Credit_card__Cash__No_charge__Dispute__Unknown__Voided_trip.58d00ef9f4
[0m09:33:29.857922 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_zone, now test.nyc_taxi.accepted_values_dim_payment_payment_name__Credit_card__Cash__No_charge__Dispute__Unknown__Voided_trip.58d00ef9f4)
[0m09:33:29.861462 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.accepted_values_dim_payment_payment_name__Credit_card__Cash__No_charge__Dispute__Unknown__Voided_trip.58d00ef9f4
[0m09:33:29.911227 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.accepted_values_dim_payment_payment_name__Credit_card__Cash__No_charge__Dispute__Unknown__Voided_trip.58d00ef9f4"
[0m09:33:29.940042 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.accepted_values_dim_payment_payment_name__Credit_card__Cash__No_charge__Dispute__Unknown__Voided_trip.58d00ef9f4
[0m09:33:29.945363 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.accepted_values_dim_payment_payment_name__Credit_card__Cash__No_charge__Dispute__Unknown__Voided_trip.58d00ef9f4
[0m09:33:29.949474 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_dim_payment_type_id.96dfa722aa
[0m09:33:29.953069 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.accepted_values_dim_payment_payment_name__Credit_card__Cash__No_charge__Dispute__Unknown__Voided_trip.58d00ef9f4, now test.nyc_taxi.not_null_dim_payment_type_id.96dfa722aa)
[0m09:33:29.956860 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_dim_payment_type_id.96dfa722aa
[0m09:33:29.987500 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_dim_payment_type_id.96dfa722aa"
[0m09:33:30.017414 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_dim_payment_type_id.96dfa722aa
[0m09:33:30.022531 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_dim_payment_type_id.96dfa722aa
[0m09:33:30.026366 [debug] [Thread-1  ]: Began running node test.nyc_taxi.unique_dim_payment_type_id.dea55de04e
[0m09:33:30.030308 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_dim_payment_type_id.96dfa722aa, now test.nyc_taxi.unique_dim_payment_type_id.dea55de04e)
[0m09:33:30.034183 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.unique_dim_payment_type_id.dea55de04e
[0m09:33:30.057486 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.unique_dim_payment_type_id.dea55de04e"
[0m09:33:30.083684 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.unique_dim_payment_type_id.dea55de04e
[0m09:33:30.088793 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.unique_dim_payment_type_id.dea55de04e
[0m09:33:30.092661 [debug] [Thread-1  ]: Began running node test.nyc_taxi.accepted_values_dim_ratecode_rate_code_name__Standard_rate__JFK__Newark__Nassau_or_Westchester__Negotiated_fare__Group_ride__Unknown.57ee02019f
[0m09:33:30.096589 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.unique_dim_payment_type_id.dea55de04e, now test.nyc_taxi.accepted_values_dim_ratecode_rate_code_name__Standard_rate__JFK__Newark__Nassau_or_Westchester__Negotiated_fare__Group_ride__Unknown.57ee02019f)
[0m09:33:30.100049 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.accepted_values_dim_ratecode_rate_code_name__Standard_rate__JFK__Newark__Nassau_or_Westchester__Negotiated_fare__Group_ride__Unknown.57ee02019f
[0m09:33:30.126289 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.accepted_values_dim_ratecode_rate_code_name__Standard_rate__JFK__Newark__Nassau_or_Westchester__Negotiated_fare__Group_ride__Unknown.57ee02019f"
[0m09:33:30.154332 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.accepted_values_dim_ratecode_rate_code_name__Standard_rate__JFK__Newark__Nassau_or_Westchester__Negotiated_fare__Group_ride__Unknown.57ee02019f
[0m09:33:30.159647 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.accepted_values_dim_ratecode_rate_code_name__Standard_rate__JFK__Newark__Nassau_or_Westchester__Negotiated_fare__Group_ride__Unknown.57ee02019f
[0m09:33:30.163371 [debug] [Thread-1  ]: Began running node test.nyc_taxi.unique_dim_ratecode_rate_id.75ae8e4885
[0m09:33:30.166843 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.accepted_values_dim_ratecode_rate_code_name__Standard_rate__JFK__Newark__Nassau_or_Westchester__Negotiated_fare__Group_ride__Unknown.57ee02019f, now test.nyc_taxi.unique_dim_ratecode_rate_id.75ae8e4885)
[0m09:33:30.170602 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.unique_dim_ratecode_rate_id.75ae8e4885
[0m09:33:30.187763 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.unique_dim_ratecode_rate_id.75ae8e4885"
[0m09:33:30.214900 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.unique_dim_ratecode_rate_id.75ae8e4885
[0m09:33:30.220018 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.unique_dim_ratecode_rate_id.75ae8e4885
[0m09:33:30.224263 [debug] [Thread-1  ]: Began running node model.nyc_taxi.fct_trips
[0m09:33:30.228239 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.unique_dim_ratecode_rate_id.75ae8e4885, now model.nyc_taxi.fct_trips)
[0m09:33:30.235147 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.fct_trips
[0m09:33:30.309094 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.fct_trips"
[0m09:33:30.330734 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.fct_trips
[0m09:33:30.335291 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.fct_trips
[0m09:33:30.339019 [debug] [Thread-1  ]: Began running node test.nyc_taxi.accepted_values_dim_time_weekday__Sunday__Monday__Tuesday__Wednesday__Thursday__Friday__Saturday.87b4c2a366
[0m09:33:30.343832 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.fct_trips, now test.nyc_taxi.accepted_values_dim_time_weekday__Sunday__Monday__Tuesday__Wednesday__Thursday__Friday__Saturday.87b4c2a366)
[0m09:33:30.347487 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.accepted_values_dim_time_weekday__Sunday__Monday__Tuesday__Wednesday__Thursday__Friday__Saturday.87b4c2a366
[0m09:33:30.375789 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.accepted_values_dim_time_weekday__Sunday__Monday__Tuesday__Wednesday__Thursday__Friday__Saturday.87b4c2a366"
[0m09:33:30.402535 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.accepted_values_dim_time_weekday__Sunday__Monday__Tuesday__Wednesday__Thursday__Friday__Saturday.87b4c2a366
[0m09:33:30.407755 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.accepted_values_dim_time_weekday__Sunday__Monday__Tuesday__Wednesday__Thursday__Friday__Saturday.87b4c2a366
[0m09:33:30.412045 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_dim_time_date.2080f42875
[0m09:33:30.415541 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.accepted_values_dim_time_weekday__Sunday__Monday__Tuesday__Wednesday__Thursday__Friday__Saturday.87b4c2a366, now test.nyc_taxi.not_null_dim_time_date.2080f42875)
[0m09:33:30.419185 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_dim_time_date.2080f42875
[0m09:33:30.437186 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_dim_time_date.2080f42875"
[0m09:33:30.464071 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_dim_time_date.2080f42875
[0m09:33:30.469833 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_dim_time_date.2080f42875
[0m09:33:30.474309 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_dim_time_date_part.59e6206332
[0m09:33:30.477995 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_dim_time_date.2080f42875, now test.nyc_taxi.not_null_dim_time_date_part.59e6206332)
[0m09:33:30.481981 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_dim_time_date_part.59e6206332
[0m09:33:30.498244 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_dim_time_date_part.59e6206332"
[0m09:33:30.525353 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_dim_time_date_part.59e6206332
[0m09:33:30.530123 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_dim_time_date_part.59e6206332
[0m09:33:30.534100 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_dim_time_day.dc0e917166
[0m09:33:30.537944 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_dim_time_date_part.59e6206332, now test.nyc_taxi.not_null_dim_time_day.dc0e917166)
[0m09:33:30.541618 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_dim_time_day.dc0e917166
[0m09:33:30.558761 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_dim_time_day.dc0e917166"
[0m09:33:30.585489 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_dim_time_day.dc0e917166
[0m09:33:30.590933 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_dim_time_day.dc0e917166
[0m09:33:30.595087 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_dim_time_hour.5b8ccd8f25
[0m09:33:30.598740 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_dim_time_day.dc0e917166, now test.nyc_taxi.not_null_dim_time_hour.5b8ccd8f25)
[0m09:33:30.602392 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_dim_time_hour.5b8ccd8f25
[0m09:33:30.623296 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_dim_time_hour.5b8ccd8f25"
[0m09:33:30.651358 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_dim_time_hour.5b8ccd8f25
[0m09:33:30.656784 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_dim_time_hour.5b8ccd8f25
[0m09:33:30.661155 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_dim_time_minute.23e906ca61
[0m09:33:30.665146 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_dim_time_hour.5b8ccd8f25, now test.nyc_taxi.not_null_dim_time_minute.23e906ca61)
[0m09:33:30.669084 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_dim_time_minute.23e906ca61
[0m09:33:30.686259 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_dim_time_minute.23e906ca61"
[0m09:33:30.711042 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_dim_time_minute.23e906ca61
[0m09:33:30.717491 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_dim_time_minute.23e906ca61
[0m09:33:30.721786 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_dim_time_month.9f6ecf2eb5
[0m09:33:30.725490 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_dim_time_minute.23e906ca61, now test.nyc_taxi.not_null_dim_time_month.9f6ecf2eb5)
[0m09:33:30.729580 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_dim_time_month.9f6ecf2eb5
[0m09:33:30.748270 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_dim_time_month.9f6ecf2eb5"
[0m09:33:30.771190 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_dim_time_month.9f6ecf2eb5
[0m09:33:30.776521 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_dim_time_month.9f6ecf2eb5
[0m09:33:30.780410 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_dim_time_year.6fb9595d53
[0m09:33:30.783669 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_dim_time_month.9f6ecf2eb5, now test.nyc_taxi.not_null_dim_time_year.6fb9595d53)
[0m09:33:30.787238 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_dim_time_year.6fb9595d53
[0m09:33:30.806875 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_dim_time_year.6fb9595d53"
[0m09:33:30.831405 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_dim_time_year.6fb9595d53
[0m09:33:30.836426 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_dim_time_year.6fb9595d53
[0m09:33:30.840150 [debug] [Thread-1  ]: Began running node test.nyc_taxi.unique_dim_time_time_id.0752c025e8
[0m09:33:30.843824 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_dim_time_year.6fb9595d53, now test.nyc_taxi.unique_dim_time_time_id.0752c025e8)
[0m09:33:30.847417 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.unique_dim_time_time_id.0752c025e8
[0m09:33:30.867837 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.unique_dim_time_time_id.0752c025e8"
[0m09:33:30.892362 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.unique_dim_time_time_id.0752c025e8
[0m09:33:30.897446 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.unique_dim_time_time_id.0752c025e8
[0m09:33:30.902103 [debug] [Thread-1  ]: Began running node test.nyc_taxi.accepted_values_dim_vendor_vendor_name__Creative_Mobile_Technologies__VeriFone_Inc_.7481cecf07
[0m09:33:30.906290 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.unique_dim_time_time_id.0752c025e8, now test.nyc_taxi.accepted_values_dim_vendor_vendor_name__Creative_Mobile_Technologies__VeriFone_Inc_.7481cecf07)
[0m09:33:30.909646 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.accepted_values_dim_vendor_vendor_name__Creative_Mobile_Technologies__VeriFone_Inc_.7481cecf07
[0m09:33:30.937896 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.accepted_values_dim_vendor_vendor_name__Creative_Mobile_Technologies__VeriFone_Inc_.7481cecf07"
[0m09:33:30.962204 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.accepted_values_dim_vendor_vendor_name__Creative_Mobile_Technologies__VeriFone_Inc_.7481cecf07
[0m09:33:30.967750 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.accepted_values_dim_vendor_vendor_name__Creative_Mobile_Technologies__VeriFone_Inc_.7481cecf07
[0m09:33:30.972379 [debug] [Thread-1  ]: Began running node test.nyc_taxi.unique_dim_vendor_id.03fad38d04
[0m09:33:30.979246 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.accepted_values_dim_vendor_vendor_name__Creative_Mobile_Technologies__VeriFone_Inc_.7481cecf07, now test.nyc_taxi.unique_dim_vendor_id.03fad38d04)
[0m09:33:30.983417 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.unique_dim_vendor_id.03fad38d04
[0m09:33:31.006011 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.unique_dim_vendor_id.03fad38d04"
[0m09:33:31.027331 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.unique_dim_vendor_id.03fad38d04
[0m09:33:31.032427 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.unique_dim_vendor_id.03fad38d04
[0m09:33:31.035700 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_dim_zone_borough.1ed2272c52
[0m09:33:31.038754 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.unique_dim_vendor_id.03fad38d04, now test.nyc_taxi.not_null_dim_zone_borough.1ed2272c52)
[0m09:33:31.041537 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_dim_zone_borough.1ed2272c52
[0m09:33:31.060337 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_dim_zone_borough.1ed2272c52"
[0m09:33:31.080116 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_dim_zone_borough.1ed2272c52
[0m09:33:31.085158 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_dim_zone_borough.1ed2272c52
[0m09:33:31.088378 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_dim_zone_service_zone.2007f611c5
[0m09:33:31.091431 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_dim_zone_borough.1ed2272c52, now test.nyc_taxi.not_null_dim_zone_service_zone.2007f611c5)
[0m09:33:31.094726 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_dim_zone_service_zone.2007f611c5
[0m09:33:31.113086 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_dim_zone_service_zone.2007f611c5"
[0m09:33:31.132694 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_dim_zone_service_zone.2007f611c5
[0m09:33:31.137342 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_dim_zone_service_zone.2007f611c5
[0m09:33:31.140915 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_dim_zone_zone.a1c4a4c37a
[0m09:33:31.144593 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_dim_zone_service_zone.2007f611c5, now test.nyc_taxi.not_null_dim_zone_zone.a1c4a4c37a)
[0m09:33:31.147763 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_dim_zone_zone.a1c4a4c37a
[0m09:33:31.163084 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_dim_zone_zone.a1c4a4c37a"
[0m09:33:31.189604 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_dim_zone_zone.a1c4a4c37a
[0m09:33:31.194379 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_dim_zone_zone.a1c4a4c37a
[0m09:33:31.198114 [debug] [Thread-1  ]: Began running node test.nyc_taxi.unique_dim_zone_location_id.7702f92424
[0m09:33:31.201300 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_dim_zone_zone.a1c4a4c37a, now test.nyc_taxi.unique_dim_zone_location_id.7702f92424)
[0m09:33:31.204480 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.unique_dim_zone_location_id.7702f92424
[0m09:33:31.220089 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.unique_dim_zone_location_id.7702f92424"
[0m09:33:31.239813 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.unique_dim_zone_location_id.7702f92424
[0m09:33:31.248869 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.unique_dim_zone_location_id.7702f92424
[0m09:33:31.256601 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_do_location_id.6acdd302a6
[0m09:33:31.260523 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.unique_dim_zone_location_id.7702f92424, now test.nyc_taxi.not_null_fct_trips_do_location_id.6acdd302a6)
[0m09:33:31.263962 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_do_location_id.6acdd302a6
[0m09:33:31.279157 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_do_location_id.6acdd302a6"
[0m09:33:31.304985 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_do_location_id.6acdd302a6
[0m09:33:31.309592 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_do_location_id.6acdd302a6
[0m09:33:31.313066 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_dropoff_time_id.781496e98f
[0m09:33:31.316626 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_do_location_id.6acdd302a6, now test.nyc_taxi.not_null_fct_trips_dropoff_time_id.781496e98f)
[0m09:33:31.320159 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_dropoff_time_id.781496e98f
[0m09:33:31.335876 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_dropoff_time_id.781496e98f"
[0m09:33:31.362951 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_dropoff_time_id.781496e98f
[0m09:33:31.367426 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_dropoff_time_id.781496e98f
[0m09:33:31.371151 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_extra.1801055bb3
[0m09:33:31.374760 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_dropoff_time_id.781496e98f, now test.nyc_taxi.not_null_fct_trips_extra.1801055bb3)
[0m09:33:31.377875 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_extra.1801055bb3
[0m09:33:31.393954 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_extra.1801055bb3"
[0m09:33:31.421372 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_extra.1801055bb3
[0m09:33:31.426414 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_extra.1801055bb3
[0m09:33:31.430454 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_improvement_surcharge.4cf28d1443
[0m09:33:31.434431 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_extra.1801055bb3, now test.nyc_taxi.not_null_fct_trips_improvement_surcharge.4cf28d1443)
[0m09:33:31.438175 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_improvement_surcharge.4cf28d1443
[0m09:33:31.454069 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_improvement_surcharge.4cf28d1443"
[0m09:33:31.481508 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_improvement_surcharge.4cf28d1443
[0m09:33:31.486379 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_improvement_surcharge.4cf28d1443
[0m09:33:31.490103 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_passenger_count.b1370cab1c
[0m09:33:31.493673 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_improvement_surcharge.4cf28d1443, now test.nyc_taxi.not_null_fct_trips_passenger_count.b1370cab1c)
[0m09:33:31.496900 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_passenger_count.b1370cab1c
[0m09:33:31.515582 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_passenger_count.b1370cab1c"
[0m09:33:31.538185 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_passenger_count.b1370cab1c
[0m09:33:31.545771 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_passenger_count.b1370cab1c
[0m09:33:31.550388 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_payment_type.93889b679a
[0m09:33:31.553226 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_passenger_count.b1370cab1c, now test.nyc_taxi.not_null_fct_trips_payment_type.93889b679a)
[0m09:33:31.557594 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_payment_type.93889b679a
[0m09:33:31.583032 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_payment_type.93889b679a"
[0m09:33:31.607078 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_payment_type.93889b679a
[0m09:33:31.612112 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_payment_type.93889b679a
[0m09:33:31.615265 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_pickup_time_id.f31fbe0eeb
[0m09:33:31.618542 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_payment_type.93889b679a, now test.nyc_taxi.not_null_fct_trips_pickup_time_id.f31fbe0eeb)
[0m09:33:31.621474 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_pickup_time_id.f31fbe0eeb
[0m09:33:31.636874 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_pickup_time_id.f31fbe0eeb"
[0m09:33:31.663465 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_pickup_time_id.f31fbe0eeb
[0m09:33:31.668860 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_pickup_time_id.f31fbe0eeb
[0m09:33:31.673010 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_pu_location_id.b0dc8dd185
[0m09:33:31.677243 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_pickup_time_id.f31fbe0eeb, now test.nyc_taxi.not_null_fct_trips_pu_location_id.b0dc8dd185)
[0m09:33:31.680631 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_pu_location_id.b0dc8dd185
[0m09:33:31.697474 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_pu_location_id.b0dc8dd185"
[0m09:33:31.726303 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_pu_location_id.b0dc8dd185
[0m09:33:31.730923 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_pu_location_id.b0dc8dd185
[0m09:33:31.734396 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_rate_code_id.ba0047eaae
[0m09:33:31.737943 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_pu_location_id.b0dc8dd185, now test.nyc_taxi.not_null_fct_trips_rate_code_id.ba0047eaae)
[0m09:33:31.741291 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_rate_code_id.ba0047eaae
[0m09:33:31.760351 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_rate_code_id.ba0047eaae"
[0m09:33:31.788249 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_rate_code_id.ba0047eaae
[0m09:33:31.793045 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_rate_code_id.ba0047eaae
[0m09:33:31.796676 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_trip_distance.19cd17f1df
[0m09:33:31.800128 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_rate_code_id.ba0047eaae, now test.nyc_taxi.not_null_fct_trips_trip_distance.19cd17f1df)
[0m09:33:31.803398 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_trip_distance.19cd17f1df
[0m09:33:31.818911 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_trip_distance.19cd17f1df"
[0m09:33:31.846462 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_trip_distance.19cd17f1df
[0m09:33:31.851155 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_trip_distance.19cd17f1df
[0m09:33:31.855081 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_vendor_id.b9b2f380bb
[0m09:33:31.858572 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_trip_distance.19cd17f1df, now test.nyc_taxi.not_null_fct_trips_vendor_id.b9b2f380bb)
[0m09:33:31.861765 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_vendor_id.b9b2f380bb
[0m09:33:31.881591 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_vendor_id.b9b2f380bb"
[0m09:33:31.910263 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_vendor_id.b9b2f380bb
[0m09:33:31.915225 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_vendor_id.b9b2f380bb
[0m09:33:31.919078 [debug] [Thread-1  ]: Began running node test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab
[0m09:33:31.922766 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_vendor_id.b9b2f380bb, now test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab)
[0m09:33:31.926406 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab
[0m09:33:31.941534 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab"
[0m09:33:31.968727 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab
[0m09:33:31.973503 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab
[0m09:33:31.979066 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:33:31.981483 [debug] [MainThread]: Connection 'test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab' was properly closed.
[0m09:33:32.009056 [debug] [MainThread]: Command end result
[0m09:33:32.594992 [debug] [MainThread]: Acquiring new bigquery connection 'generate_catalog'
[0m09:33:32.598173 [info ] [MainThread]: Building catalog
[0m09:33:32.630330 [debug] [ThreadPool]: Acquiring new bigquery connection 'northern-shield-437204-m0.information_schema'
[0m09:33:32.704815 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:33:32.720111 [debug] [ThreadPool]: On northern-shield-437204-m0.information_schema: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "connection_name": "northern-shield-437204-m0.information_schema"} */

    with
                table_shards_stage as (
    select
        tables.project_id as table_catalog,
        tables.dataset_id as table_schema,
        coalesce(REGEXP_EXTRACT(tables.table_id, '^(.+)[0-9]{8}$'), tables.table_id) as table_name,
        tables.table_id as shard_name,
        REGEXP_EXTRACT(tables.table_id, '^.+([0-9]{8})$') as shard_index,
        REGEXP_CONTAINS(tables.table_id, '^.+[0-9]{8}$') and tables.type = 1 as is_date_shard,
        case
            when materialized_views.table_name is not null then 'materialized view'
            when tables.type = 1 then 'table'
            when tables.type = 2 then 'view'
            else 'external'
        end as table_type,
        tables.type = 1 as is_table,
        JSON_VALUE(table_description.option_value) as table_comment,
        tables.size_bytes,
        tables.row_count
    from `northern-shield-437204-m0`.`nyc_taxi`.__TABLES__ tables
    left join `northern-shield-437204-m0`.`nyc_taxi`.INFORMATION_SCHEMA.MATERIALIZED_VIEWS materialized_views
        on materialized_views.table_catalog = tables.project_id
        and materialized_views.table_schema = tables.dataset_id
        and materialized_views.table_name = tables.table_id
    left join `northern-shield-437204-m0`.`nyc_taxi`.INFORMATION_SCHEMA.TABLE_OPTIONS table_description
        on table_description.table_catalog = tables.project_id
        and table_description.table_schema = tables.dataset_id
        and table_description.table_name = tables.table_id
        and table_description.option_name = 'description'
),
                table_shards as (
                    select * from table_shards_stage
                    where ((
                                upper(table_schema) = upper('nyc_taxi')
                            and upper(table_name) = upper('dim_payment')
                            ) or (
                                upper(table_schema) = upper('nyc_taxi')
                            and upper(table_name) = upper('fct_trips')
                            ) or (
                                upper(table_schema) = upper('nyc_taxi')
                            and upper(table_name) = upper('dim_time')
                            ) or (
                                upper(table_schema) = upper('nyc_taxi')
                            and upper(table_name) = upper('dim_zone')
                            ) or (
                                upper(table_schema) = upper('nyc_taxi')
                            and upper(table_name) = upper('dim_vendor')
                            ) or (
                                upper(table_schema) = upper('nyc_taxi')
                            and upper(table_name) = upper('zone_map')
                            ) or (
                                upper(table_schema) = upper('nyc_taxi')
                            and upper(table_name) = upper('green_tripdata')
                            ) or (
                                upper(table_schema) = upper('nyc_taxi')
                            and upper(table_name) = upper('dim_ratecode')
                            ))
                ),
                tables as (
    select distinct
        table_catalog,
        table_schema,
        table_name,
        is_date_shard,
        table_type,
        is_table,
        table_comment
    from table_shards
),
                table_stats as (
    select
        table_catalog,
        table_schema,
        table_name,
        max(shard_name) as latest_shard_name,
        min(shard_index) as shard_min,
        max(shard_index) as shard_max,
        count(shard_index) as shard_count,
        sum(size_bytes) as size_bytes,
        sum(row_count) as row_count
    from table_shards
    group by 1, 2, 3
),

                columns as (
    select
        columns.table_catalog,
        columns.table_schema,
        columns.table_name as shard_name,
        coalesce(paths.field_path, '<unknown>') as column_name,
        -- invent a row number to account for nested fields
        -- BQ does not treat these nested properties as independent fields
        row_number() over (
            partition by
                columns.table_catalog,
                columns.table_schema,
                columns.table_name
            order by
                columns.ordinal_position,
                paths.field_path
        ) as column_index,
        coalesce(paths.data_type, '<unknown>') as column_type,
        paths.description as column_comment,
        case when columns.is_partitioning_column = 'YES' then 1 else 0 end as is_partitioning_column,
        case when columns.is_partitioning_column = 'YES' then paths.field_path end as partition_column,
        case when columns.clustering_ordinal_position is not null then 1 else 0 end as is_clustering_column,
        case when columns.clustering_ordinal_position is not null then paths.field_path end as cluster_column,
        columns.clustering_ordinal_position
    from `northern-shield-437204-m0`.`nyc_taxi`.INFORMATION_SCHEMA.COLUMNS columns
    join `northern-shield-437204-m0`.`nyc_taxi`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS paths
        on paths.table_catalog = columns.table_catalog
        and paths.table_schema = columns.table_schema
        and paths.table_name = columns.table_name
        and paths.column_name = columns.column_name
    where columns.ordinal_position is not null
),
                column_stats as (
    select
        table_catalog,
        table_schema,
        shard_name,
        max(is_partitioning_column) = 1 as is_partitioned,
        max(partition_column) as partition_column,
        max(is_clustering_column) = 1 as is_clustered,
        array_to_string(
            array_agg(
                cluster_column ignore nulls
                order by clustering_ordinal_position
            ), ', '
        ) as clustering_columns
    from columns
    group by 1, 2, 3
)

            
    select
        tables.table_catalog as table_database,
        tables.table_schema,
        case
            when tables.is_date_shard then concat(tables.table_name, '*')
            else tables.table_name
        end as table_name,
        tables.table_type,
        tables.table_comment,
        -- coalesce column metadata fields to ensure they are non-null for catalog generation
        -- external table columns are not present in COLUMN_FIELD_PATHS
        coalesce(columns.column_name, '<unknown>') as column_name,
        coalesce(columns.column_index, 1) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        coalesce(columns.column_comment, '') as column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_stats.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        tables.is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_stats.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        tables.is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_stats.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        tables.is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        table_stats.row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        tables.is_table as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        table_stats.size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        tables.is_table as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        column_stats.partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        column_stats.is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        column_stats.clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        column_stats.is_clustered as `stats__clustering_fields__include`

    from tables
    join table_stats
        on table_stats.table_catalog = tables.table_catalog
        and table_stats.table_schema = tables.table_schema
        and table_stats.table_name = tables.table_name
    left join column_stats
        on column_stats.table_catalog = tables.table_catalog
        and column_stats.table_schema = tables.table_schema
        and column_stats.shard_name = table_stats.latest_shard_name
    left join columns
        on columns.table_catalog = tables.table_catalog
        and columns.table_schema = tables.table_schema
        and columns.shard_name = table_stats.latest_shard_name

  
[0m09:33:33.511421 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:0491eaf2-b4db-4118-9da1-b681009a317b&page=queryresults
[0m09:33:36.568774 [info ] [MainThread]: Catalog written to /opt/airflow/include/dbt/target/catalog.json
[0m09:33:36.574225 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 16.196077, "process_in_blocks": "2648", "process_kernel_time": 1.526108, "process_mem_max_rss": "229228", "process_out_blocks": "0", "process_user_time": 13.223051}
[0m09:33:36.578078 [debug] [MainThread]: Command `dbt docs generate` succeeded at 09:33:36.577647 after 16.20 seconds
[0m09:33:36.580876 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m09:33:36.583772 [debug] [MainThread]: Connection 'northern-shield-437204-m0.information_schema' was properly closed.
[0m09:33:36.587388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3cd548f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3c64d7280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3c6435730>]}
[0m09:33:36.591473 [debug] [MainThread]: Flushing usage events
[0m09:34:11.996254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0908985490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f09067bca90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f09067bca30>]}


============================== 09:34:12.015077 | a049c62b-45d0-42d4-bfc6-c71047fbb975 ==============================
[0m09:34:12.015077 [info ] [MainThread]: Running with dbt=1.8.9
[0m09:34:12.018844 [debug] [MainThread]: running dbt with arguments {'log_path': '/opt/airflow/include/dbt/logs', 'empty': 'None', 'profiles_dir': '/opt/airflow/include/dbt', 'introspect': 'True', 'use_colors': 'True', 'partial_parse': 'True', 'invocation_command': 'dbt docs serve --port 8001', 'version_check': 'True', 'log_format': 'default', 'no_print': 'None', 'fail_fast': 'False', 'static_parser': 'True', 'debug': 'False', 'quiet': 'False', 'send_anonymous_usage_stats': 'True', 'printer_width': '80', 'target_path': 'None', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'cache_selected_only': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'write_json': 'True', 'log_cache_events': 'False', 'warn_error': 'None'}
[0m09:34:15.076749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a049c62b-45d0-42d4-bfc6-c71047fbb975', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08d412ee20>]}
[0m09:34:15.251761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a049c62b-45d0-42d4-bfc6-c71047fbb975', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0908d195e0>]}
[0m18:31:33.319452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f117e11df10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f117bef2970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f117bef2910>]}


============================== 18:31:33.326302 | 62c14b82-57eb-47dd-aab1-fe6cc5da3237 ==============================
[0m18:31:33.326302 [info ] [MainThread]: Running with dbt=1.8.9
[0m18:31:33.327528 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'introspect': 'True', 'indirect_selection': 'eager', 'no_print': 'None', 'version_check': 'True', 'log_path': '/opt/airflow/include/dbt/logs', 'cache_selected_only': 'False', 'target_path': 'None', 'partial_parse': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/include/dbt/', 'empty': 'False', 'profiles_dir': '/opt/airflow/include/dbt/', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'log_cache_events': 'False', 'log_format': 'default', 'warn_error': 'None', 'quiet': 'False', 'use_experimental_parser': 'False', 'printer_width': '80', 'debug': 'False'}
[0m18:31:34.961565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '62c14b82-57eb-47dd-aab1-fe6cc5da3237', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f117d904fd0>]}
[0m18:31:35.023199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '62c14b82-57eb-47dd-aab1-fe6cc5da3237', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f117d251850>]}
[0m18:31:35.024532 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m18:31:35.187187 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m18:31:35.874276 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 2 files changed.
[0m18:31:35.875516 [debug] [MainThread]: Partial parsing: added file: nyc_taxi://models/transform/dim_triptype.sql
[0m18:31:35.876718 [debug] [MainThread]: Partial parsing: updated file: nyc_taxi://models/tests/schema.yml
[0m18:31:35.877732 [debug] [MainThread]: Partial parsing: updated file: nyc_taxi://models/transform/dim_zone.sql
[0m18:31:36.237722 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m18:31:36.239202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '62c14b82-57eb-47dd-aab1-fe6cc5da3237', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f114585ebb0>]}
[0m18:31:36.485572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '62c14b82-57eb-47dd-aab1-fe6cc5da3237', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1173f22130>]}
[0m18:31:36.680245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '62c14b82-57eb-47dd-aab1-fe6cc5da3237', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f11449bfe20>]}
[0m18:31:36.681604 [info ] [MainThread]: Found 7 models, 34 data tests, 2 sources, 600 macros
[0m18:31:36.682771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '62c14b82-57eb-47dd-aab1-fe6cc5da3237', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1173f4baf0>]}
[0m18:31:36.685925 [info ] [MainThread]: 
[0m18:31:36.687361 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:31:36.694118 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_northern-shield-437204-m0'
[0m18:31:36.695246 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:31:37.334048 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_northern-shield-437204-m0, now list_northern-shield-437204-m0_nyc_taxi)
[0m18:31:37.335396 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:31:37.923069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '62c14b82-57eb-47dd-aab1-fe6cc5da3237', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f117d76c5e0>]}
[0m18:31:37.924505 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:31:37.925713 [info ] [MainThread]: 
[0m18:31:37.934457 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_payment
[0m18:31:37.935614 [info ] [Thread-1  ]: 1 of 7 START sql table model nyc_taxi.dim_payment .............................. [RUN]
[0m18:31:37.936750 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_northern-shield-437204-m0_nyc_taxi, now model.nyc_taxi.dim_payment)
[0m18:31:37.937681 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_payment
[0m18:31:37.947881 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_payment"
[0m18:31:37.953068 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_payment
[0m18:31:37.973166 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:31:38.552140 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.dim_payment"
[0m18:31:38.556928 [debug] [Thread-1  ]: On model.nyc_taxi.dim_payment: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.dim_payment"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`dim_payment`
      
    
    

    OPTIONS()
    as (
      WITH payment_cte AS(
    SELECT DISTINCT
        payment_type AS type_id,
        CASE 
            WHEN payment_type = 1 THEN "Credit card"
            WHEN payment_type = 2 THEN "Cash"
            WHEN payment_type = 3 THEN "No charge"
            WHEN payment_type = 4 THEN "Dispute"
            WHEN payment_type = 5 THEN "Unknown"
            WHEN payment_type = 6 THEN "Voided trip"
        END AS payment_name
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata`
)
SELECT
    type_id,
    payment_name
FROM payment_cte
    );
  
[0m18:31:39.747032 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:621bf0d8-fd4a-4bd9-b4d6-a213b7cee907&page=queryresults
[0m18:31:42.194895 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '62c14b82-57eb-47dd-aab1-fe6cc5da3237', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f11771e65e0>]}
[0m18:31:42.196416 [info ] [Thread-1  ]: 1 of 7 OK created sql table model nyc_taxi.dim_payment ......................... [[32mCREATE TABLE (4.0 rows, 463.5 KiB processed)[0m in 4.26s]
[0m18:31:42.198345 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_payment
[0m18:31:42.199682 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_ratecode
[0m18:31:42.200800 [info ] [Thread-1  ]: 2 of 7 START sql table model nyc_taxi.dim_ratecode ............................. [RUN]
[0m18:31:42.202000 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_payment, now model.nyc_taxi.dim_ratecode)
[0m18:31:42.203001 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_ratecode
[0m18:31:42.207405 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_ratecode"
[0m18:31:42.211988 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_ratecode
[0m18:31:42.216373 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:31:42.788271 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.dim_ratecode"
[0m18:31:42.794124 [debug] [Thread-1  ]: On model.nyc_taxi.dim_ratecode: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.dim_ratecode"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`dim_ratecode`
      
    
    

    OPTIONS()
    as (
      WITH rate_code_cte AS(
    SELECT DISTINCT
        rate_code_id AS rate_id,
        CASE 
            WHEN rate_code_id = 1 THEN "Standard rate"
            WHEN rate_code_id = 2 THEN "JFK"
            WHEN rate_code_id = 3 THEN "Newark"
            WHEN rate_code_id = 4 THEN "Nassau or Westchester"
            WHEN rate_code_id = 5 THEN "Negotiated fare"
            WHEN rate_code_id = 6 THEN "Group ride"
        ELSE "Unknown"
        END AS rate_code_name
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata`
)
SELECT
    rate_id,
    rate_code_name
FROM rate_code_cte
    );
  
[0m18:31:43.368764 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:9d0c8094-a9e9-4c14-abd7-f933391e4618&page=queryresults
[0m18:31:46.017834 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '62c14b82-57eb-47dd-aab1-fe6cc5da3237', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f117cc264f0>]}
[0m18:31:46.019504 [info ] [Thread-1  ]: 2 of 7 OK created sql table model nyc_taxi.dim_ratecode ........................ [[32mCREATE TABLE (6.0 rows, 463.5 KiB processed)[0m in 3.82s]
[0m18:31:46.021509 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_ratecode
[0m18:31:46.023174 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_time
[0m18:31:46.024453 [info ] [Thread-1  ]: 3 of 7 START sql table model nyc_taxi.dim_time ................................. [RUN]
[0m18:31:46.025784 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_ratecode, now model.nyc_taxi.dim_time)
[0m18:31:46.026978 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_time
[0m18:31:46.032187 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_time"
[0m18:31:46.036879 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_time
[0m18:31:46.043827 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:31:46.591527 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.dim_time"
[0m18:31:46.597296 [debug] [Thread-1  ]: On model.nyc_taxi.dim_time: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.dim_time"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`dim_time`
      
    
    

    OPTIONS()
    as (
      WITH datetime_cte AS (
    SELECT DISTINCT
        lpep_pickup_datetime AS datetime_value
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata`
    UNION ALL
    SELECT DISTINCT
        lpep_dropoff_datetime AS datetime_value
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata`
),
datetime_cte_distinct AS(
    SELECT DISTINCT
        datetime_value
    FROM datetime_cte
)
SELECT
    ROW_NUMBER() OVER (ORDER BY datetime_value) AS time_id,
    DATE(datetime_value) AS date,
    datetime_value AS date_part,
    EXTRACT(YEAR FROM datetime_value) AS year,
    EXTRACT(MONTH FROM datetime_value) AS month,
    EXTRACT(DAY FROM datetime_value) AS day,
    EXTRACT(HOUR FROM datetime_value) AS hour,
    EXTRACT(MINUTE FROM datetime_value) AS minute,
    FORMAT_TIMESTAMP('%A', datetime_value) AS weekday
FROM datetime_cte_distinct
ORDER BY time_id
    );
  
[0m18:31:47.228380 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:fd2b3a8a-95ae-47e6-863e-8d9598334d3c&page=queryresults
[0m18:31:50.401666 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '62c14b82-57eb-47dd-aab1-fe6cc5da3237', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f11716bfca0>]}
[0m18:31:50.403112 [info ] [Thread-1  ]: 3 of 7 OK created sql table model nyc_taxi.dim_time ............................ [[32mCREATE TABLE (115.0k rows, 927.0 KiB processed)[0m in 4.38s]
[0m18:31:50.404754 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_time
[0m18:31:50.405892 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_triptype
[0m18:31:50.407087 [info ] [Thread-1  ]: 4 of 7 START sql table model nyc_taxi.dim_triptype ............................. [RUN]
[0m18:31:50.408226 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_time, now model.nyc_taxi.dim_triptype)
[0m18:31:50.409230 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_triptype
[0m18:31:50.413739 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_triptype"
[0m18:31:50.424822 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_triptype
[0m18:31:50.429983 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.dim_triptype"
[0m18:31:50.434915 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:31:50.438370 [debug] [Thread-1  ]: On model.nyc_taxi.dim_triptype: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.dim_triptype"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`dim_triptype`
      
    
    

    OPTIONS()
    as (
      WITH triptype_cte AS(
	SELECT DISTINCT 
		t.trip_type AS type_id,
		CASE 
			WHEN trip_type = 1 THEN 'Street-hail'
			WHEN trip_type = 2 THEN 'Dispatch'
		ELSE 'Unknown'
		END AS trip_name
	FROM `northern-shield-437204-m0`.`nyc_taxi`.`zone_map` 
	WHERE trip_type IS NOT NULL
		)
SELECT
	type_id,
	trip_name
FROM triptype_cte;
    );
  
[0m18:31:51.040401 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:87547154-402b-4012-9e20-cb669f2208d8&page=queryresults
[0m18:31:51.041837 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected ")" but got ";" at [27:18]; reason: invalidQuery, location: query, message: Syntax error: Expected ")" but got ";" at [27:18]')
[0m18:31:52.336616 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:acd09506-d1cf-4e94-ab83-d92a30a2147b&page=queryresults
[0m18:31:52.337963 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:acd09506-d1cf-4e94-ab83-d92a30a2147b&page=queryresults
[0m18:31:52.346141 [debug] [Thread-1  ]: Database Error in model dim_triptype (models/transform/dim_triptype.sql)
  Syntax error: Expected ")" but got ";" at [27:18]
  compiled code at target/run/nyc_taxi/models/transform/dim_triptype.sql
[0m18:31:52.347340 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '62c14b82-57eb-47dd-aab1-fe6cc5da3237', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f117171f7c0>]}
[0m18:31:52.348646 [error] [Thread-1  ]: 4 of 7 ERROR creating sql table model nyc_taxi.dim_triptype .................... [[31mERROR[0m in 1.94s]
[0m18:31:52.350162 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_triptype
[0m18:31:52.351343 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_vendor
[0m18:31:52.352607 [info ] [Thread-1  ]: 5 of 7 START sql table model nyc_taxi.dim_vendor ............................... [RUN]
[0m18:31:52.353750 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_triptype, now model.nyc_taxi.dim_vendor)
[0m18:31:52.354667 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_vendor
[0m18:31:52.360211 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_vendor"
[0m18:31:52.365557 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_vendor
[0m18:31:52.370265 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:31:52.943607 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.dim_vendor"
[0m18:31:52.948962 [debug] [Thread-1  ]: On model.nyc_taxi.dim_vendor: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.dim_vendor"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`dim_vendor`
      
    
    

    OPTIONS()
    as (
      WITH vendor_cte AS(
    SELECT DISTINCT
        vendor_id AS id,
        CASE 
            WHEN vendor_id = 1 THEN "Creative Mobile Technologies"
            WHEN vendor_id = 2 THEN "VeriFone Inc."
        END AS vendor_name
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata`
)
SELECT
    id,
    vendor_name
FROM vendor_cte
    );
  
[0m18:31:53.534830 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:2cf5ebaf-7940-4b90-9d49-39f16f832805&page=queryresults
[0m18:31:56.428714 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '62c14b82-57eb-47dd-aab1-fe6cc5da3237', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f11717f65e0>]}
[0m18:31:56.430609 [info ] [Thread-1  ]: 5 of 7 OK created sql table model nyc_taxi.dim_vendor .......................... [[32mCREATE TABLE (2.0 rows, 463.5 KiB processed)[0m in 4.08s]
[0m18:31:56.432681 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_vendor
[0m18:31:56.434003 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_zone
[0m18:31:56.435344 [info ] [Thread-1  ]: 6 of 7 START sql table model nyc_taxi.dim_zone ................................. [RUN]
[0m18:31:56.436782 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_vendor, now model.nyc_taxi.dim_zone)
[0m18:31:56.437985 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_zone
[0m18:31:56.445905 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_zone"
[0m18:31:56.450557 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_zone
[0m18:31:56.454612 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:31:57.010991 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.dim_zone"
[0m18:31:57.017174 [debug] [Thread-1  ]: On model.nyc_taxi.dim_zone: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.dim_zone"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`dim_zone`
      
    
    

    OPTIONS()
    as (
      SELECT DISTINCT
    location_id,
    borough,
    zone,
    replace(service_zone, 'Boro', 'Green') AS service_zone
FROM `northern-shield-437204-m0`.`nyc_taxi`.`zone_map`
WHERE service_zone IS NOT NULL
    );
  
[0m18:31:57.707782 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:1d57915d-e99e-4499-b2c0-2b990b563769&page=queryresults
[0m18:32:01.164328 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '62c14b82-57eb-47dd-aab1-fe6cc5da3237', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f117171fd60>]}
[0m18:32:01.166345 [info ] [Thread-1  ]: 6 of 7 OK created sql table model nyc_taxi.dim_zone ............................ [[32mCREATE TABLE (263.0 rows, 24.2 KiB processed)[0m in 4.73s]
[0m18:32:01.168671 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_zone
[0m18:32:01.170582 [debug] [Thread-1  ]: Began running node model.nyc_taxi.fct_trips
[0m18:32:01.172368 [info ] [Thread-1  ]: 7 of 7 START sql table model nyc_taxi.fct_trips ................................ [RUN]
[0m18:32:01.173725 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_zone, now model.nyc_taxi.fct_trips)
[0m18:32:01.175022 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.fct_trips
[0m18:32:01.197725 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.fct_trips"
[0m18:32:01.204263 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.fct_trips
[0m18:32:01.209747 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:32:01.753088 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.fct_trips"
[0m18:32:01.758518 [debug] [Thread-1  ]: On model.nyc_taxi.fct_trips: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.fct_trips"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips`
      
    
    

    OPTIONS()
    as (
      WITH tripdata_cte AS (
    SELECT 
        to_hex(md5(cast(coalesce(cast(t.vendor_id as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(t.lpep_pickup_datetime as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(t.lpep_dropoff_datetime as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(t.__index_level_0__ as string), '_dbt_utils_surrogate_key_null_') as string))) AS trip_id,
        t.vendor_id,
        pt.time_id AS pickup_time_id,
        dt.time_id AS dropoff_time_id,
        t.rate_code_id,
        t.pu_location_id,
        t.do_location_id,
        t.passenger_count,
        t.trip_distance,
        t.fare_amount,
        t.extra,
        t.mta_tax,
        t.tip_amount,
        t.tolls_amount,
        t.improvement_surcharge,
        t.total_amount,
        t.payment_type,
        t.trip_type,
        t.congestion_surcharge
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata` AS t
    INNER JOIN (
        SELECT DISTINCT date_part, time_id 
        FROM `northern-shield-437204-m0`.`nyc_taxi`.`dim_time`
    ) pt ON t.lpep_pickup_datetime = pt.date_part
    INNER JOIN (
        SELECT DISTINCT date_part, time_id 
        FROM `northern-shield-437204-m0`.`nyc_taxi`.`dim_time`
    ) dt ON t.lpep_dropoff_datetime = dt.date_part
)
SELECT 
    trip_id,
    vendor_id,
    pickup_time_id,
    dropoff_time_id,
    rate_code_id,
    pu_location_id,
    do_location_id,
    passenger_count,
    trip_distance,
    fare_amount,
    extra,
    mta_tax,
    tip_amount,
    tolls_amount,
    improvement_surcharge,
    total_amount,
    payment_type,
    trip_type,
    congestion_surcharge
FROM tripdata_cte
    );
  
[0m18:32:02.312098 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:07c710fe-5370-4bf4-9ce6-bbb9531604c6&page=queryresults
[0m18:32:06.300215 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '62c14b82-57eb-47dd-aab1-fe6cc5da3237', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f117171fd60>]}
[0m18:32:06.301723 [info ] [Thread-1  ]: 7 of 7 OK created sql table model nyc_taxi.fct_trips ........................... [[32mCREATE TABLE (59.3k rows, 10.4 MiB processed)[0m in 5.13s]
[0m18:32:06.303569 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.fct_trips
[0m18:32:06.305713 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:32:06.306646 [debug] [MainThread]: Connection 'model.nyc_taxi.fct_trips' was properly closed.
[0m18:32:06.307666 [info ] [MainThread]: 
[0m18:32:06.308664 [info ] [MainThread]: Finished running 7 table models in 0 hours 0 minutes and 29.62 seconds (29.62s).
[0m18:32:06.312136 [debug] [MainThread]: Command end result
[0m18:32:06.397073 [info ] [MainThread]: 
[0m18:32:06.398402 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:32:06.399383 [info ] [MainThread]: 
[0m18:32:06.400550 [error] [MainThread]:   Database Error in model dim_triptype (models/transform/dim_triptype.sql)
  Syntax error: Expected ")" but got ";" at [27:18]
  compiled code at target/run/nyc_taxi/models/transform/dim_triptype.sql
[0m18:32:06.401737 [info ] [MainThread]: 
[0m18:32:06.402790 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 TOTAL=7
[0m18:32:06.404597 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 32.313446, "process_in_blocks": "212592", "process_kernel_time": 0.408491, "process_mem_max_rss": "247124", "process_out_blocks": "0", "process_user_time": 6.188645}
[0m18:32:06.405936 [debug] [MainThread]: Command `dbt run` failed at 18:32:06.405745 after 32.31 seconds
[0m18:32:06.406957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f117e11df10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f117d904fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f11766cee20>]}
[0m18:32:06.407889 [debug] [MainThread]: Flushing usage events
[0m18:32:31.455832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc903cbf40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc8e1a09d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc8e1a0970>]}


============================== 18:32:31.462680 | a58e589b-8089-469a-8560-7fa7e367aeb9 ==============================
[0m18:32:31.462680 [info ] [MainThread]: Running with dbt=1.8.9
[0m18:32:31.463978 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'log_cache_events': 'False', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'write_json': 'True', 'use_experimental_parser': 'False', 'warn_error': 'None', 'send_anonymous_usage_stats': 'True', 'empty': 'False', 'use_colors': 'True', 'debug': 'False', 'partial_parse': 'True', 'static_parser': 'True', 'log_path': '/opt/airflow/include/dbt/logs', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/include/dbt/', 'quiet': 'False', 'printer_width': '80', 'log_format': 'default', 'version_check': 'True', 'cache_selected_only': 'False', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/include/dbt/', 'indirect_selection': 'eager'}
[0m18:32:32.562560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a58e589b-8089-469a-8560-7fa7e367aeb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc8fbb2fd0>]}
[0m18:32:32.623849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a58e589b-8089-469a-8560-7fa7e367aeb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc8e9e4e20>]}
[0m18:32:32.625412 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m18:32:32.788501 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m18:32:33.442034 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:32:33.443924 [debug] [MainThread]: Partial parsing: updated file: nyc_taxi://models/transform/dim_triptype.sql
[0m18:32:33.788150 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m18:32:33.789796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'a58e589b-8089-469a-8560-7fa7e367aeb9', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc56e7bb80>]}
[0m18:32:34.011796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a58e589b-8089-469a-8560-7fa7e367aeb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc83b1e130>]}
[0m18:32:34.173496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a58e589b-8089-469a-8560-7fa7e367aeb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc896295b0>]}
[0m18:32:34.174852 [info ] [MainThread]: Found 7 models, 34 data tests, 2 sources, 600 macros
[0m18:32:34.175964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a58e589b-8089-469a-8560-7fa7e367aeb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc83b1a6d0>]}
[0m18:32:34.179055 [info ] [MainThread]: 
[0m18:32:34.180359 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:32:34.186613 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_northern-shield-437204-m0'
[0m18:32:34.187667 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:32:34.771299 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_northern-shield-437204-m0, now list_northern-shield-437204-m0_nyc_taxi)
[0m18:32:34.773004 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:32:35.345701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a58e589b-8089-469a-8560-7fa7e367aeb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc57a5a9d0>]}
[0m18:32:35.347311 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:32:35.348521 [info ] [MainThread]: 
[0m18:32:35.356709 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_payment
[0m18:32:35.358102 [info ] [Thread-1  ]: 1 of 7 START sql table model nyc_taxi.dim_payment .............................. [RUN]
[0m18:32:35.359336 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_northern-shield-437204-m0_nyc_taxi, now model.nyc_taxi.dim_payment)
[0m18:32:35.360309 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_payment
[0m18:32:35.370658 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_payment"
[0m18:32:35.375190 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_payment
[0m18:32:35.395588 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:32:35.976731 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.dim_payment"
[0m18:32:35.982955 [debug] [Thread-1  ]: On model.nyc_taxi.dim_payment: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.dim_payment"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`dim_payment`
      
    
    

    OPTIONS()
    as (
      WITH payment_cte AS(
    SELECT DISTINCT
        payment_type AS type_id,
        CASE 
            WHEN payment_type = 1 THEN "Credit card"
            WHEN payment_type = 2 THEN "Cash"
            WHEN payment_type = 3 THEN "No charge"
            WHEN payment_type = 4 THEN "Dispute"
            WHEN payment_type = 5 THEN "Unknown"
            WHEN payment_type = 6 THEN "Voided trip"
        END AS payment_name
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata`
)
SELECT
    type_id,
    payment_name
FROM payment_cte
    );
  
[0m18:32:36.530789 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:c98a1c3a-10da-4f83-9088-9088892c28c6&page=queryresults
[0m18:32:39.119309 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a58e589b-8089-469a-8560-7fa7e367aeb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc57a5a9d0>]}
[0m18:32:39.120966 [info ] [Thread-1  ]: 1 of 7 OK created sql table model nyc_taxi.dim_payment ......................... [[32mCREATE TABLE (4.0 rows, 463.5 KiB processed)[0m in 3.76s]
[0m18:32:39.122713 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_payment
[0m18:32:39.123888 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_ratecode
[0m18:32:39.125017 [info ] [Thread-1  ]: 2 of 7 START sql table model nyc_taxi.dim_ratecode ............................. [RUN]
[0m18:32:39.126211 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_payment, now model.nyc_taxi.dim_ratecode)
[0m18:32:39.127158 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_ratecode
[0m18:32:39.131663 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_ratecode"
[0m18:32:39.137018 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_ratecode
[0m18:32:39.141685 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:32:39.743354 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.dim_ratecode"
[0m18:32:39.749092 [debug] [Thread-1  ]: On model.nyc_taxi.dim_ratecode: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.dim_ratecode"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`dim_ratecode`
      
    
    

    OPTIONS()
    as (
      WITH rate_code_cte AS(
    SELECT DISTINCT
        rate_code_id AS rate_id,
        CASE 
            WHEN rate_code_id = 1 THEN "Standard rate"
            WHEN rate_code_id = 2 THEN "JFK"
            WHEN rate_code_id = 3 THEN "Newark"
            WHEN rate_code_id = 4 THEN "Nassau or Westchester"
            WHEN rate_code_id = 5 THEN "Negotiated fare"
            WHEN rate_code_id = 6 THEN "Group ride"
        ELSE "Unknown"
        END AS rate_code_name
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata`
)
SELECT
    rate_id,
    rate_code_name
FROM rate_code_cte
    );
  
[0m18:32:40.322191 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:5297b182-ce3e-44a3-91b3-9a96029f3520&page=queryresults
[0m18:32:42.989442 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a58e589b-8089-469a-8560-7fa7e367aeb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc81987190>]}
[0m18:32:42.991078 [info ] [Thread-1  ]: 2 of 7 OK created sql table model nyc_taxi.dim_ratecode ........................ [[32mCREATE TABLE (6.0 rows, 463.5 KiB processed)[0m in 3.86s]
[0m18:32:42.992719 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_ratecode
[0m18:32:42.994001 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_time
[0m18:32:42.995190 [info ] [Thread-1  ]: 3 of 7 START sql table model nyc_taxi.dim_time ................................. [RUN]
[0m18:32:42.996294 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_ratecode, now model.nyc_taxi.dim_time)
[0m18:32:42.997230 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_time
[0m18:32:43.002573 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_time"
[0m18:32:43.008150 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_time
[0m18:32:43.014413 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:32:43.576052 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.dim_time"
[0m18:32:43.582672 [debug] [Thread-1  ]: On model.nyc_taxi.dim_time: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.dim_time"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`dim_time`
      
    
    

    OPTIONS()
    as (
      WITH datetime_cte AS (
    SELECT DISTINCT
        lpep_pickup_datetime AS datetime_value
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata`
    UNION ALL
    SELECT DISTINCT
        lpep_dropoff_datetime AS datetime_value
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata`
),
datetime_cte_distinct AS(
    SELECT DISTINCT
        datetime_value
    FROM datetime_cte
)
SELECT
    ROW_NUMBER() OVER (ORDER BY datetime_value) AS time_id,
    DATE(datetime_value) AS date,
    datetime_value AS date_part,
    EXTRACT(YEAR FROM datetime_value) AS year,
    EXTRACT(MONTH FROM datetime_value) AS month,
    EXTRACT(DAY FROM datetime_value) AS day,
    EXTRACT(HOUR FROM datetime_value) AS hour,
    EXTRACT(MINUTE FROM datetime_value) AS minute,
    FORMAT_TIMESTAMP('%A', datetime_value) AS weekday
FROM datetime_cte_distinct
ORDER BY time_id
    );
  
[0m18:32:44.040753 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:c1c7a1cd-02fd-4119-980c-e3e0b2208423&page=queryresults
[0m18:32:47.789115 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a58e589b-8089-469a-8560-7fa7e367aeb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc819871c0>]}
[0m18:32:47.790650 [info ] [Thread-1  ]: 3 of 7 OK created sql table model nyc_taxi.dim_time ............................ [[32mCREATE TABLE (115.0k rows, 927.0 KiB processed)[0m in 4.79s]
[0m18:32:47.792550 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_time
[0m18:32:47.794135 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_triptype
[0m18:32:47.795992 [info ] [Thread-1  ]: 4 of 7 START sql table model nyc_taxi.dim_triptype ............................. [RUN]
[0m18:32:47.797485 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_time, now model.nyc_taxi.dim_triptype)
[0m18:32:47.798653 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_triptype
[0m18:32:47.804146 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_triptype"
[0m18:32:47.810509 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_triptype
[0m18:32:47.816030 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.dim_triptype"
[0m18:32:47.820801 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:32:47.825042 [debug] [Thread-1  ]: On model.nyc_taxi.dim_triptype: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.dim_triptype"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`dim_triptype`
      
    
    

    OPTIONS()
    as (
      WITH triptype_cte AS(
	SELECT DISTINCT 
		t.trip_type AS type_id,
		CASE 
			WHEN trip_type = 1 THEN 'Street-hail'
			WHEN trip_type = 2 THEN 'Dispatch'
		ELSE 'Unknown'
		END AS trip_name
	FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata` 
	WHERE trip_type IS NOT NULL
		)
SELECT
	type_id,
	trip_name
FROM triptype_cte;
    );
  
[0m18:32:48.345424 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:3601d95d-26dd-42f6-8e98-09bfa42317d5&page=queryresults
[0m18:32:48.346686 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected ")" but got ";" at [27:18]; reason: invalidQuery, location: query, message: Syntax error: Expected ")" but got ";" at [27:18]')
[0m18:32:49.327192 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:bfe2af54-f4f0-48c7-b07a-6a9cc50d9adc&page=queryresults
[0m18:32:49.329036 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:bfe2af54-f4f0-48c7-b07a-6a9cc50d9adc&page=queryresults
[0m18:32:49.332955 [debug] [Thread-1  ]: Database Error in model dim_triptype (models/transform/dim_triptype.sql)
  Syntax error: Expected ")" but got ";" at [27:18]
  compiled code at target/run/nyc_taxi/models/transform/dim_triptype.sql
[0m18:32:49.334111 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a58e589b-8089-469a-8560-7fa7e367aeb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc819870d0>]}
[0m18:32:49.335522 [error] [Thread-1  ]: 4 of 7 ERROR creating sql table model nyc_taxi.dim_triptype .................... [[31mERROR[0m in 1.54s]
[0m18:32:49.336960 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_triptype
[0m18:32:49.338154 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_vendor
[0m18:32:49.339364 [info ] [Thread-1  ]: 5 of 7 START sql table model nyc_taxi.dim_vendor ............................... [RUN]
[0m18:32:49.340618 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_triptype, now model.nyc_taxi.dim_vendor)
[0m18:32:49.341883 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_vendor
[0m18:32:49.347443 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_vendor"
[0m18:32:49.353618 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_vendor
[0m18:32:49.359047 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:32:49.915077 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.dim_vendor"
[0m18:32:49.921161 [debug] [Thread-1  ]: On model.nyc_taxi.dim_vendor: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.dim_vendor"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`dim_vendor`
      
    
    

    OPTIONS()
    as (
      WITH vendor_cte AS(
    SELECT DISTINCT
        vendor_id AS id,
        CASE 
            WHEN vendor_id = 1 THEN "Creative Mobile Technologies"
            WHEN vendor_id = 2 THEN "VeriFone Inc."
        END AS vendor_name
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata`
)
SELECT
    id,
    vendor_name
FROM vendor_cte
    );
  
[0m18:32:50.485420 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:bdc1ac16-8110-41c1-af89-c834499565df&page=queryresults
[0m18:32:53.123653 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a58e589b-8089-469a-8560-7fa7e367aeb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc819875e0>]}
[0m18:32:53.125274 [info ] [Thread-1  ]: 5 of 7 OK created sql table model nyc_taxi.dim_vendor .......................... [[32mCREATE TABLE (2.0 rows, 463.5 KiB processed)[0m in 3.78s]
[0m18:32:53.127259 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_vendor
[0m18:32:53.129117 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_zone
[0m18:32:53.130578 [info ] [Thread-1  ]: 6 of 7 START sql table model nyc_taxi.dim_zone ................................. [RUN]
[0m18:32:53.131936 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_vendor, now model.nyc_taxi.dim_zone)
[0m18:32:53.133134 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_zone
[0m18:32:53.141430 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_zone"
[0m18:32:53.148495 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_zone
[0m18:32:53.153462 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:32:53.979515 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.dim_zone"
[0m18:32:53.985965 [debug] [Thread-1  ]: On model.nyc_taxi.dim_zone: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.dim_zone"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`dim_zone`
      
    
    

    OPTIONS()
    as (
      SELECT DISTINCT
    location_id,
    borough,
    zone,
    replace(service_zone, 'Boro', 'Green') AS service_zone
FROM `northern-shield-437204-m0`.`nyc_taxi`.`zone_map`
WHERE service_zone IS NOT NULL
    );
  
[0m18:32:54.610645 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:8fe83065-15cf-4e71-89f3-87843326100d&page=queryresults
[0m18:32:57.205256 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a58e589b-8089-469a-8560-7fa7e367aeb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc81970e50>]}
[0m18:32:57.206954 [info ] [Thread-1  ]: 6 of 7 OK created sql table model nyc_taxi.dim_zone ............................ [[32mCREATE TABLE (263.0 rows, 24.2 KiB processed)[0m in 4.07s]
[0m18:32:57.209671 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_zone
[0m18:32:57.211374 [debug] [Thread-1  ]: Began running node model.nyc_taxi.fct_trips
[0m18:32:57.212653 [info ] [Thread-1  ]: 7 of 7 START sql table model nyc_taxi.fct_trips ................................ [RUN]
[0m18:32:57.213898 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_zone, now model.nyc_taxi.fct_trips)
[0m18:32:57.214996 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.fct_trips
[0m18:32:57.239356 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.fct_trips"
[0m18:32:57.245957 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.fct_trips
[0m18:32:57.250674 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:32:57.844102 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.fct_trips"
[0m18:32:57.849654 [debug] [Thread-1  ]: On model.nyc_taxi.fct_trips: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.fct_trips"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips`
      
    
    

    OPTIONS()
    as (
      WITH tripdata_cte AS (
    SELECT 
        to_hex(md5(cast(coalesce(cast(t.vendor_id as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(t.lpep_pickup_datetime as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(t.lpep_dropoff_datetime as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(t.__index_level_0__ as string), '_dbt_utils_surrogate_key_null_') as string))) AS trip_id,
        t.vendor_id,
        pt.time_id AS pickup_time_id,
        dt.time_id AS dropoff_time_id,
        t.rate_code_id,
        t.pu_location_id,
        t.do_location_id,
        t.passenger_count,
        t.trip_distance,
        t.fare_amount,
        t.extra,
        t.mta_tax,
        t.tip_amount,
        t.tolls_amount,
        t.improvement_surcharge,
        t.total_amount,
        t.payment_type,
        t.trip_type,
        t.congestion_surcharge
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata` AS t
    INNER JOIN (
        SELECT DISTINCT date_part, time_id 
        FROM `northern-shield-437204-m0`.`nyc_taxi`.`dim_time`
    ) pt ON t.lpep_pickup_datetime = pt.date_part
    INNER JOIN (
        SELECT DISTINCT date_part, time_id 
        FROM `northern-shield-437204-m0`.`nyc_taxi`.`dim_time`
    ) dt ON t.lpep_dropoff_datetime = dt.date_part
)
SELECT 
    trip_id,
    vendor_id,
    pickup_time_id,
    dropoff_time_id,
    rate_code_id,
    pu_location_id,
    do_location_id,
    passenger_count,
    trip_distance,
    fare_amount,
    extra,
    mta_tax,
    tip_amount,
    tolls_amount,
    improvement_surcharge,
    total_amount,
    payment_type,
    trip_type,
    congestion_surcharge
FROM tripdata_cte
    );
  
[0m18:32:58.365385 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:54d789d8-69bd-47f9-b898-8e6e0107669d&page=queryresults
[0m18:33:03.019174 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a58e589b-8089-469a-8560-7fa7e367aeb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc8181f550>]}
[0m18:33:03.021146 [info ] [Thread-1  ]: 7 of 7 OK created sql table model nyc_taxi.fct_trips ........................... [[32mCREATE TABLE (59.3k rows, 10.4 MiB processed)[0m in 5.81s]
[0m18:33:03.023126 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.fct_trips
[0m18:33:03.025611 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:33:03.026541 [debug] [MainThread]: Connection 'model.nyc_taxi.fct_trips' was properly closed.
[0m18:33:03.027524 [info ] [MainThread]: 
[0m18:33:03.028566 [info ] [MainThread]: Finished running 7 table models in 0 hours 0 minutes and 28.85 seconds (28.85s).
[0m18:33:03.032996 [debug] [MainThread]: Command end result
[0m18:33:03.115977 [info ] [MainThread]: 
[0m18:33:03.117846 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:33:03.119151 [info ] [MainThread]: 
[0m18:33:03.120306 [error] [MainThread]:   Database Error in model dim_triptype (models/transform/dim_triptype.sql)
  Syntax error: Expected ")" but got ";" at [27:18]
  compiled code at target/run/nyc_taxi/models/transform/dim_triptype.sql
[0m18:33:03.121396 [info ] [MainThread]: 
[0m18:33:03.122403 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 TOTAL=7
[0m18:33:03.124283 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 30.85182, "process_in_blocks": "19248", "process_kernel_time": 0.357328, "process_mem_max_rss": "241492", "process_out_blocks": "0", "process_user_time": 6.013326}
[0m18:33:03.125674 [debug] [MainThread]: Command `dbt run` failed at 18:33:03.125467 after 30.85 seconds
[0m18:33:03.126846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc903cbf40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc8e9e4e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc895e4af0>]}
[0m18:33:03.127886 [debug] [MainThread]: Flushing usage events
[0m18:34:59.334167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1039696430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f10374cea60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f10374cea00>]}


============================== 18:34:59.356491 | 9131958c-2229-41b3-8b79-da7793645c14 ==============================
[0m18:34:59.356491 [info ] [MainThread]: Running with dbt=1.8.9
[0m18:34:59.360295 [debug] [MainThread]: running dbt with arguments {'log_path': '/opt/airflow/include/dbt/logs', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/include/dbt/', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'printer_width': '80', 'fail_fast': 'False', 'write_json': 'True', 'target_path': 'None', 'partial_parse': 'True', 'profiles_dir': '/opt/airflow/include/dbt/', 'debug': 'False', 'quiet': 'False', 'log_cache_events': 'False', 'use_experimental_parser': 'False', 'cache_selected_only': 'False', 'introspect': 'True', 'version_check': 'True', 'warn_error': 'None', 'static_parser': 'True', 'no_print': 'None', 'empty': 'False', 'use_colors': 'True', 'log_format': 'default'}
[0m18:35:02.345502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9131958c-2229-41b3-8b79-da7793645c14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1037546730>]}
[0m18:35:02.567187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9131958c-2229-41b3-8b79-da7793645c14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1004e32be0>]}
[0m18:35:02.570391 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m18:35:02.961356 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m18:35:06.827671 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:35:06.835472 [debug] [MainThread]: Partial parsing: updated file: nyc_taxi://models/transform/dim_triptype.sql
[0m18:35:07.746895 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m18:35:07.752406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '9131958c-2229-41b3-8b79-da7793645c14', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f10327d5490>]}
[0m18:35:08.378968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9131958c-2229-41b3-8b79-da7793645c14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f102f51f130>]}
[0m18:35:08.880084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9131958c-2229-41b3-8b79-da7793645c14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ffffab040>]}
[0m18:35:08.883390 [info ] [MainThread]: Found 7 models, 34 data tests, 2 sources, 600 macros
[0m18:35:08.886386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9131958c-2229-41b3-8b79-da7793645c14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f100405ec70>]}
[0m18:35:08.894159 [info ] [MainThread]: 
[0m18:35:08.898103 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:35:08.916090 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_northern-shield-437204-m0'
[0m18:35:08.919594 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:35:09.664853 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_northern-shield-437204-m0, now list_northern-shield-437204-m0_nyc_taxi)
[0m18:35:09.668215 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:35:10.299790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9131958c-2229-41b3-8b79-da7793645c14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f10399d9fa0>]}
[0m18:35:10.303627 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:35:10.306582 [info ] [MainThread]: 
[0m18:35:10.330864 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_payment
[0m18:35:10.335056 [info ] [Thread-1  ]: 1 of 7 START sql table model nyc_taxi.dim_payment .............................. [RUN]
[0m18:35:10.339489 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_northern-shield-437204-m0_nyc_taxi, now model.nyc_taxi.dim_payment)
[0m18:35:10.343162 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_payment
[0m18:35:10.370418 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_payment"
[0m18:35:10.394357 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_payment
[0m18:35:10.445232 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:35:11.199720 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.dim_payment"
[0m18:35:11.220023 [debug] [Thread-1  ]: On model.nyc_taxi.dim_payment: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.dim_payment"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`dim_payment`
      
    
    

    OPTIONS()
    as (
      WITH payment_cte AS(
    SELECT DISTINCT
        payment_type AS type_id,
        CASE 
            WHEN payment_type = 1 THEN "Credit card"
            WHEN payment_type = 2 THEN "Cash"
            WHEN payment_type = 3 THEN "No charge"
            WHEN payment_type = 4 THEN "Dispute"
            WHEN payment_type = 5 THEN "Unknown"
            WHEN payment_type = 6 THEN "Voided trip"
        END AS payment_name
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata`
)
SELECT
    type_id,
    payment_name
FROM payment_cte
    );
  
[0m18:35:11.902941 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:9795d791-b19f-431b-bdc8-405a7be21994&page=queryresults
[0m18:35:14.509988 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9131958c-2229-41b3-8b79-da7793645c14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f10399d9fa0>]}
[0m18:35:14.514842 [info ] [Thread-1  ]: 1 of 7 OK created sql table model nyc_taxi.dim_payment ......................... [[32mCREATE TABLE (4.0 rows, 463.5 KiB processed)[0m in 4.17s]
[0m18:35:14.519231 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_payment
[0m18:35:14.523352 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_ratecode
[0m18:35:14.526970 [info ] [Thread-1  ]: 2 of 7 START sql table model nyc_taxi.dim_ratecode ............................. [RUN]
[0m18:35:14.530401 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_payment, now model.nyc_taxi.dim_ratecode)
[0m18:35:14.533765 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_ratecode
[0m18:35:14.546134 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_ratecode"
[0m18:35:14.569500 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_ratecode
[0m18:35:14.580766 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:35:15.187755 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.dim_ratecode"
[0m18:35:15.209683 [debug] [Thread-1  ]: On model.nyc_taxi.dim_ratecode: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.dim_ratecode"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`dim_ratecode`
      
    
    

    OPTIONS()
    as (
      WITH rate_code_cte AS(
    SELECT DISTINCT
        rate_code_id AS rate_id,
        CASE 
            WHEN rate_code_id = 1 THEN "Standard rate"
            WHEN rate_code_id = 2 THEN "JFK"
            WHEN rate_code_id = 3 THEN "Newark"
            WHEN rate_code_id = 4 THEN "Nassau or Westchester"
            WHEN rate_code_id = 5 THEN "Negotiated fare"
            WHEN rate_code_id = 6 THEN "Group ride"
        ELSE "Unknown"
        END AS rate_code_name
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata`
)
SELECT
    rate_id,
    rate_code_name
FROM rate_code_cte
    );
  
[0m18:35:15.808457 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:aa628ff9-f719-41d5-8555-e41d60990dc3&page=queryresults
[0m18:35:18.591849 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9131958c-2229-41b3-8b79-da7793645c14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f102cd7a910>]}
[0m18:35:18.609483 [info ] [Thread-1  ]: 2 of 7 OK created sql table model nyc_taxi.dim_ratecode ........................ [[32mCREATE TABLE (6.0 rows, 463.5 KiB processed)[0m in 4.06s]
[0m18:35:18.614535 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_ratecode
[0m18:35:18.620178 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_time
[0m18:35:18.624183 [info ] [Thread-1  ]: 3 of 7 START sql table model nyc_taxi.dim_time ................................. [RUN]
[0m18:35:18.627665 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_ratecode, now model.nyc_taxi.dim_time)
[0m18:35:18.630472 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_time
[0m18:35:18.644691 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_time"
[0m18:35:18.674591 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_time
[0m18:35:18.690162 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:35:19.305720 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.dim_time"
[0m18:35:19.329730 [debug] [Thread-1  ]: On model.nyc_taxi.dim_time: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.dim_time"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`dim_time`
      
    
    

    OPTIONS()
    as (
      WITH datetime_cte AS (
    SELECT DISTINCT
        lpep_pickup_datetime AS datetime_value
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata`
    UNION ALL
    SELECT DISTINCT
        lpep_dropoff_datetime AS datetime_value
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata`
),
datetime_cte_distinct AS(
    SELECT DISTINCT
        datetime_value
    FROM datetime_cte
)
SELECT
    ROW_NUMBER() OVER (ORDER BY datetime_value) AS time_id,
    DATE(datetime_value) AS date,
    datetime_value AS date_part,
    EXTRACT(YEAR FROM datetime_value) AS year,
    EXTRACT(MONTH FROM datetime_value) AS month,
    EXTRACT(DAY FROM datetime_value) AS day,
    EXTRACT(HOUR FROM datetime_value) AS hour,
    EXTRACT(MINUTE FROM datetime_value) AS minute,
    FORMAT_TIMESTAMP('%A', datetime_value) AS weekday
FROM datetime_cte_distinct
ORDER BY time_id
    );
  
[0m18:35:19.998312 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:c1a1d7d3-49bc-40cd-8c30-b5c75f27ffce&page=queryresults
[0m18:35:23.470770 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9131958c-2229-41b3-8b79-da7793645c14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f102cd041c0>]}
[0m18:35:23.474665 [info ] [Thread-1  ]: 3 of 7 OK created sql table model nyc_taxi.dim_time ............................ [[32mCREATE TABLE (115.0k rows, 927.0 KiB processed)[0m in 4.84s]
[0m18:35:23.480462 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_time
[0m18:35:23.484192 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_triptype
[0m18:35:23.488165 [info ] [Thread-1  ]: 4 of 7 START sql table model nyc_taxi.dim_triptype ............................. [RUN]
[0m18:35:23.492552 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_time, now model.nyc_taxi.dim_triptype)
[0m18:35:23.497107 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_triptype
[0m18:35:23.515476 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_triptype"
[0m18:35:23.535562 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_triptype
[0m18:35:23.547528 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.dim_triptype"
[0m18:35:23.568095 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:35:23.577790 [debug] [Thread-1  ]: On model.nyc_taxi.dim_triptype: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.dim_triptype"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`dim_triptype`
      
    
    

    OPTIONS()
    as (
      WITH triptype_cte AS(
	SELECT DISTINCT 
		t.trip_type AS type_id,
		CASE 
			WHEN trip_type = 1 THEN 'Street-hail'
			WHEN trip_type = 2 THEN 'Dispatch'
		ELSE 'Unknown'
		END AS trip_name
	FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata` 
	WHERE trip_type IS NOT NULL
)
SELECT
	type_id,
	trip_name
FROM triptype_cte
    );
  
[0m18:35:24.680091 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:9f1920a2-e4b8-448d-a258-e5094882cf62&page=queryresults
[0m18:35:24.985600 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: t at [15:17]; reason: invalidQuery, location: query, message: Unrecognized name: t at [15:17]')
[0m18:35:26.532818 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:3b283daa-8263-4bd1-be3a-c76389ec2f05&page=queryresults
[0m18:35:26.831339 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:3b283daa-8263-4bd1-be3a-c76389ec2f05&page=queryresults
[0m18:35:26.841978 [debug] [Thread-1  ]: Database Error in model dim_triptype (models/transform/dim_triptype.sql)
  Unrecognized name: t at [15:17]
  compiled code at target/run/nyc_taxi/models/transform/dim_triptype.sql
[0m18:35:26.845864 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9131958c-2229-41b3-8b79-da7793645c14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f102ccceee0>]}
[0m18:35:26.849694 [error] [Thread-1  ]: 4 of 7 ERROR creating sql table model nyc_taxi.dim_triptype .................... [[31mERROR[0m in 3.35s]
[0m18:35:26.853819 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_triptype
[0m18:35:26.857146 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_vendor
[0m18:35:26.860719 [info ] [Thread-1  ]: 5 of 7 START sql table model nyc_taxi.dim_vendor ............................... [RUN]
[0m18:35:26.864460 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_triptype, now model.nyc_taxi.dim_vendor)
[0m18:35:26.868039 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_vendor
[0m18:35:26.882946 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_vendor"
[0m18:35:26.906646 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_vendor
[0m18:35:26.917386 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:35:27.609849 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.dim_vendor"
[0m18:35:27.630124 [debug] [Thread-1  ]: On model.nyc_taxi.dim_vendor: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.dim_vendor"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`dim_vendor`
      
    
    

    OPTIONS()
    as (
      WITH vendor_cte AS(
    SELECT DISTINCT
        vendor_id AS id,
        CASE 
            WHEN vendor_id = 1 THEN "Creative Mobile Technologies"
            WHEN vendor_id = 2 THEN "VeriFone Inc."
        END AS vendor_name
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata`
)
SELECT
    id,
    vendor_name
FROM vendor_cte
    );
  
[0m18:35:28.191294 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:e93e1c9d-0c2f-41ba-b65a-c143a9ffb94a&page=queryresults
[0m18:35:30.735957 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9131958c-2229-41b3-8b79-da7793645c14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f102cd7ad60>]}
[0m18:35:30.740177 [info ] [Thread-1  ]: 5 of 7 OK created sql table model nyc_taxi.dim_vendor .......................... [[32mCREATE TABLE (2.0 rows, 463.5 KiB processed)[0m in 3.87s]
[0m18:35:30.744938 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_vendor
[0m18:35:30.749200 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_zone
[0m18:35:30.753268 [info ] [Thread-1  ]: 6 of 7 START sql table model nyc_taxi.dim_zone ................................. [RUN]
[0m18:35:30.757542 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_vendor, now model.nyc_taxi.dim_zone)
[0m18:35:30.760851 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_zone
[0m18:35:30.783302 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_zone"
[0m18:35:30.808087 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_zone
[0m18:35:30.819741 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:35:31.808593 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.dim_zone"
[0m18:35:31.829575 [debug] [Thread-1  ]: On model.nyc_taxi.dim_zone: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.dim_zone"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`dim_zone`
      
    
    

    OPTIONS()
    as (
      SELECT DISTINCT
    location_id,
    borough,
    zone,
    replace(service_zone, 'Boro', 'Green') AS service_zone
FROM `northern-shield-437204-m0`.`nyc_taxi`.`zone_map`
WHERE service_zone IS NOT NULL
    );
  
[0m18:35:32.485133 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:0a20c848-e727-46ee-98bb-7de6aadbf327&page=queryresults
[0m18:35:35.772016 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9131958c-2229-41b3-8b79-da7793645c14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1031cbc730>]}
[0m18:35:35.776753 [info ] [Thread-1  ]: 6 of 7 OK created sql table model nyc_taxi.dim_zone ............................ [[32mCREATE TABLE (263.0 rows, 24.2 KiB processed)[0m in 5.01s]
[0m18:35:35.782152 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_zone
[0m18:35:35.786198 [debug] [Thread-1  ]: Began running node model.nyc_taxi.fct_trips
[0m18:35:35.790154 [info ] [Thread-1  ]: 7 of 7 START sql table model nyc_taxi.fct_trips ................................ [RUN]
[0m18:35:35.796030 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_zone, now model.nyc_taxi.fct_trips)
[0m18:35:35.800885 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.fct_trips
[0m18:35:35.879558 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.fct_trips"
[0m18:35:35.901897 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.fct_trips
[0m18:35:35.920249 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:35:36.537224 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.fct_trips"
[0m18:35:36.554671 [debug] [Thread-1  ]: On model.nyc_taxi.fct_trips: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.fct_trips"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips`
      
    
    

    OPTIONS()
    as (
      WITH tripdata_cte AS (
    SELECT 
        to_hex(md5(cast(coalesce(cast(t.vendor_id as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(t.lpep_pickup_datetime as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(t.lpep_dropoff_datetime as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(t.__index_level_0__ as string), '_dbt_utils_surrogate_key_null_') as string))) AS trip_id,
        t.vendor_id,
        pt.time_id AS pickup_time_id,
        dt.time_id AS dropoff_time_id,
        t.rate_code_id,
        t.pu_location_id,
        t.do_location_id,
        t.passenger_count,
        t.trip_distance,
        t.fare_amount,
        t.extra,
        t.mta_tax,
        t.tip_amount,
        t.tolls_amount,
        t.improvement_surcharge,
        t.total_amount,
        t.payment_type,
        t.trip_type,
        t.congestion_surcharge
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata` AS t
    INNER JOIN (
        SELECT DISTINCT date_part, time_id 
        FROM `northern-shield-437204-m0`.`nyc_taxi`.`dim_time`
    ) pt ON t.lpep_pickup_datetime = pt.date_part
    INNER JOIN (
        SELECT DISTINCT date_part, time_id 
        FROM `northern-shield-437204-m0`.`nyc_taxi`.`dim_time`
    ) dt ON t.lpep_dropoff_datetime = dt.date_part
)
SELECT 
    trip_id,
    vendor_id,
    pickup_time_id,
    dropoff_time_id,
    rate_code_id,
    pu_location_id,
    do_location_id,
    passenger_count,
    trip_distance,
    fare_amount,
    extra,
    mta_tax,
    tip_amount,
    tolls_amount,
    improvement_surcharge,
    total_amount,
    payment_type,
    trip_type,
    congestion_surcharge
FROM tripdata_cte
    );
  
[0m18:35:37.229183 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:da9695c5-5f53-4420-93e2-1f6729e5054e&page=queryresults
[0m18:35:40.949259 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9131958c-2229-41b3-8b79-da7793645c14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1031cbc730>]}
[0m18:35:40.953049 [info ] [Thread-1  ]: 7 of 7 OK created sql table model nyc_taxi.fct_trips ........................... [[32mCREATE TABLE (59.3k rows, 10.4 MiB processed)[0m in 5.15s]
[0m18:35:40.957168 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.fct_trips
[0m18:35:40.962614 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:35:40.965429 [debug] [MainThread]: Connection 'model.nyc_taxi.fct_trips' was properly closed.
[0m18:35:40.969015 [info ] [MainThread]: 
[0m18:35:40.972105 [info ] [MainThread]: Finished running 7 table models in 0 hours 0 minutes and 32.07 seconds (32.07s).
[0m18:35:40.982278 [debug] [MainThread]: Command end result
[0m18:35:41.204226 [info ] [MainThread]: 
[0m18:35:41.207466 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:35:41.210665 [info ] [MainThread]: 
[0m18:35:41.214366 [error] [MainThread]:   Database Error in model dim_triptype (models/transform/dim_triptype.sql)
  Unrecognized name: t at [15:17]
  compiled code at target/run/nyc_taxi/models/transform/dim_triptype.sql
[0m18:35:41.218602 [info ] [MainThread]: 
[0m18:35:41.221366 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 TOTAL=7
[0m18:35:41.226205 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 40.367725, "process_in_blocks": "0", "process_kernel_time": 0.786223, "process_mem_max_rss": "237540", "process_out_blocks": "0", "process_user_time": 14.319751}
[0m18:35:41.229412 [debug] [MainThread]: Command `dbt run` failed at 18:35:41.229035 after 40.37 seconds
[0m18:35:41.236818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1039696430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1004e32be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f10381d7310>]}
[0m18:35:41.239577 [debug] [MainThread]: Flushing usage events
[0m18:35:53.156458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb594b45430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb59297da00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb59297d9a0>]}


============================== 18:35:53.173534 | 240600f6-a449-4e06-bae2-a249928ab21f ==============================
[0m18:35:53.173534 [info ] [MainThread]: Running with dbt=1.8.9
[0m18:35:53.177660 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'write_json': 'True', 'debug': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'profiles_dir': '/opt/airflow/include/dbt/', 'log_path': '/opt/airflow/include/dbt/logs', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'no_print': 'None', 'log_format': 'default', 'indirect_selection': 'eager', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'log_cache_events': 'False', 'version_check': 'True', 'fail_fast': 'False', 'introspect': 'True', 'target_path': 'None', 'printer_width': '80', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/include/dbt/', 'quiet': 'False', 'empty': 'False'}
[0m18:35:56.100940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '240600f6-a449-4e06-bae2-a249928ab21f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb560317eb0>]}
[0m18:35:56.258399 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '240600f6-a449-4e06-bae2-a249928ab21f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5602ec6d0>]}
[0m18:35:56.261222 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m18:35:56.709980 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m18:35:59.600578 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:35:59.605469 [debug] [MainThread]: Partial parsing: updated file: nyc_taxi://models/transform/dim_triptype.sql
[0m18:36:00.434225 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m18:36:00.437953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '240600f6-a449-4e06-bae2-a249928ab21f', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb58dbf65e0>]}
[0m18:36:01.159533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '240600f6-a449-4e06-bae2-a249928ab21f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb58a920130>]}
[0m18:36:01.631893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '240600f6-a449-4e06-bae2-a249928ab21f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb58dc29550>]}
[0m18:36:01.635489 [info ] [MainThread]: Found 7 models, 34 data tests, 2 sources, 600 macros
[0m18:36:01.638567 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '240600f6-a449-4e06-bae2-a249928ab21f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb58dea41c0>]}
[0m18:36:01.648935 [info ] [MainThread]: 
[0m18:36:01.652620 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:36:01.673231 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_northern-shield-437204-m0'
[0m18:36:01.676529 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:36:02.502642 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_northern-shield-437204-m0, now list_northern-shield-437204-m0_nyc_taxi)
[0m18:36:02.505836 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:36:03.336090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '240600f6-a449-4e06-bae2-a249928ab21f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb59424f4c0>]}
[0m18:36:03.339534 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:36:03.341968 [info ] [MainThread]: 
[0m18:36:03.360821 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_payment
[0m18:36:03.364894 [info ] [Thread-1  ]: 1 of 7 START sql table model nyc_taxi.dim_payment .............................. [RUN]
[0m18:36:03.367839 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_northern-shield-437204-m0_nyc_taxi, now model.nyc_taxi.dim_payment)
[0m18:36:03.370822 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_payment
[0m18:36:03.402202 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_payment"
[0m18:36:03.418134 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_payment
[0m18:36:03.478057 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:36:04.181517 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.dim_payment"
[0m18:36:04.200362 [debug] [Thread-1  ]: On model.nyc_taxi.dim_payment: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.dim_payment"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`dim_payment`
      
    
    

    OPTIONS()
    as (
      WITH payment_cte AS(
    SELECT DISTINCT
        payment_type AS type_id,
        CASE 
            WHEN payment_type = 1 THEN "Credit card"
            WHEN payment_type = 2 THEN "Cash"
            WHEN payment_type = 3 THEN "No charge"
            WHEN payment_type = 4 THEN "Dispute"
            WHEN payment_type = 5 THEN "Unknown"
            WHEN payment_type = 6 THEN "Voided trip"
        END AS payment_name
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata`
)
SELECT
    type_id,
    payment_name
FROM payment_cte
    );
  
[0m18:36:05.180676 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:0a4a8ea9-a6c6-46b2-adb6-d160c4ebb535&page=queryresults
[0m18:36:08.220967 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '240600f6-a449-4e06-bae2-a249928ab21f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb58dbe3250>]}
[0m18:36:08.225364 [info ] [Thread-1  ]: 1 of 7 OK created sql table model nyc_taxi.dim_payment ......................... [[32mCREATE TABLE (4.0 rows, 463.5 KiB processed)[0m in 4.85s]
[0m18:36:08.229544 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_payment
[0m18:36:08.232874 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_ratecode
[0m18:36:08.236625 [info ] [Thread-1  ]: 2 of 7 START sql table model nyc_taxi.dim_ratecode ............................. [RUN]
[0m18:36:08.239857 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_payment, now model.nyc_taxi.dim_ratecode)
[0m18:36:08.243046 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_ratecode
[0m18:36:08.254073 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_ratecode"
[0m18:36:08.277404 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_ratecode
[0m18:36:08.287425 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:36:08.892655 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.dim_ratecode"
[0m18:36:08.917707 [debug] [Thread-1  ]: On model.nyc_taxi.dim_ratecode: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.dim_ratecode"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`dim_ratecode`
      
    
    

    OPTIONS()
    as (
      WITH rate_code_cte AS(
    SELECT DISTINCT
        rate_code_id AS rate_id,
        CASE 
            WHEN rate_code_id = 1 THEN "Standard rate"
            WHEN rate_code_id = 2 THEN "JFK"
            WHEN rate_code_id = 3 THEN "Newark"
            WHEN rate_code_id = 4 THEN "Nassau or Westchester"
            WHEN rate_code_id = 5 THEN "Negotiated fare"
            WHEN rate_code_id = 6 THEN "Group ride"
        ELSE "Unknown"
        END AS rate_code_name
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata`
)
SELECT
    rate_id,
    rate_code_name
FROM rate_code_cte
    );
  
[0m18:36:09.437700 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:6d593a9c-adb2-44d1-9c60-3cafc4b59e86&page=queryresults
[0m18:36:12.272358 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '240600f6-a449-4e06-bae2-a249928ab21f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb588185f10>]}
[0m18:36:12.276378 [info ] [Thread-1  ]: 2 of 7 OK created sql table model nyc_taxi.dim_ratecode ........................ [[32mCREATE TABLE (6.0 rows, 463.5 KiB processed)[0m in 4.03s]
[0m18:36:12.280896 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_ratecode
[0m18:36:12.284799 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_time
[0m18:36:12.288539 [info ] [Thread-1  ]: 3 of 7 START sql table model nyc_taxi.dim_time ................................. [RUN]
[0m18:36:12.291992 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_ratecode, now model.nyc_taxi.dim_time)
[0m18:36:12.295944 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_time
[0m18:36:12.311925 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_time"
[0m18:36:12.335804 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_time
[0m18:36:12.351973 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:36:13.002305 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.dim_time"
[0m18:36:13.025133 [debug] [Thread-1  ]: On model.nyc_taxi.dim_time: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.dim_time"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`dim_time`
      
    
    

    OPTIONS()
    as (
      WITH datetime_cte AS (
    SELECT DISTINCT
        lpep_pickup_datetime AS datetime_value
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata`
    UNION ALL
    SELECT DISTINCT
        lpep_dropoff_datetime AS datetime_value
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata`
),
datetime_cte_distinct AS(
    SELECT DISTINCT
        datetime_value
    FROM datetime_cte
)
SELECT
    ROW_NUMBER() OVER (ORDER BY datetime_value) AS time_id,
    DATE(datetime_value) AS date,
    datetime_value AS date_part,
    EXTRACT(YEAR FROM datetime_value) AS year,
    EXTRACT(MONTH FROM datetime_value) AS month,
    EXTRACT(DAY FROM datetime_value) AS day,
    EXTRACT(HOUR FROM datetime_value) AS hour,
    EXTRACT(MINUTE FROM datetime_value) AS minute,
    FORMAT_TIMESTAMP('%A', datetime_value) AS weekday
FROM datetime_cte_distinct
ORDER BY time_id
    );
  
[0m18:36:13.536352 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:27fb03eb-d4b1-45d8-acfd-6dbd7f5d9f18&page=queryresults
[0m18:36:17.000061 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '240600f6-a449-4e06-bae2-a249928ab21f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb588185eb0>]}
[0m18:36:17.003682 [info ] [Thread-1  ]: 3 of 7 OK created sql table model nyc_taxi.dim_time ............................ [[32mCREATE TABLE (115.0k rows, 927.0 KiB processed)[0m in 4.71s]
[0m18:36:17.008556 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_time
[0m18:36:17.012950 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_triptype
[0m18:36:17.016807 [info ] [Thread-1  ]: 4 of 7 START sql table model nyc_taxi.dim_triptype ............................. [RUN]
[0m18:36:17.020947 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_time, now model.nyc_taxi.dim_triptype)
[0m18:36:17.024302 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_triptype
[0m18:36:17.036582 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_triptype"
[0m18:36:17.059387 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_triptype
[0m18:36:17.074442 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.dim_triptype"
[0m18:36:17.094675 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:36:17.104341 [debug] [Thread-1  ]: On model.nyc_taxi.dim_triptype: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.dim_triptype"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`dim_triptype`
      
    
    

    OPTIONS()
    as (
      WITH triptype_cte AS(
	SELECT DISTINCT 
		trip_type AS type_id,
		CASE 
			WHEN trip_type = 1 THEN 'Street-hail'
			WHEN trip_type = 2 THEN 'Dispatch'
		ELSE 'Unknown'
		END AS trip_name
	FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata` 
	WHERE trip_type IS NOT NULL
)
SELECT
	type_id,
	trip_name
FROM triptype_cte
    );
  
[0m18:36:17.926261 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:fcd7b196-2dd7-4528-90bd-b648f9ce5f8c&page=queryresults
[0m18:36:20.366743 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '240600f6-a449-4e06-bae2-a249928ab21f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5936a03a0>]}
[0m18:36:20.370619 [info ] [Thread-1  ]: 4 of 7 OK created sql table model nyc_taxi.dim_triptype ........................ [[32mCREATE TABLE (3.0 rows, 463.5 KiB processed)[0m in 3.35s]
[0m18:36:20.376106 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_triptype
[0m18:36:20.380878 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_vendor
[0m18:36:20.384630 [info ] [Thread-1  ]: 5 of 7 START sql table model nyc_taxi.dim_vendor ............................... [RUN]
[0m18:36:20.387663 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_triptype, now model.nyc_taxi.dim_vendor)
[0m18:36:20.390268 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_vendor
[0m18:36:20.402879 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_vendor"
[0m18:36:20.422781 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_vendor
[0m18:36:20.432936 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:36:21.048593 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.dim_vendor"
[0m18:36:21.069550 [debug] [Thread-1  ]: On model.nyc_taxi.dim_vendor: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.dim_vendor"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`dim_vendor`
      
    
    

    OPTIONS()
    as (
      WITH vendor_cte AS(
    SELECT DISTINCT
        vendor_id AS id,
        CASE 
            WHEN vendor_id = 1 THEN "Creative Mobile Technologies"
            WHEN vendor_id = 2 THEN "VeriFone Inc."
        END AS vendor_name
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata`
)
SELECT
    id,
    vendor_name
FROM vendor_cte
    );
  
[0m18:36:21.630970 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:f430bc9c-6f26-4214-ba75-30f5973b2b68&page=queryresults
[0m18:36:23.786782 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '240600f6-a449-4e06-bae2-a249928ab21f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb58dd61640>]}
[0m18:36:23.791102 [info ] [Thread-1  ]: 5 of 7 OK created sql table model nyc_taxi.dim_vendor .......................... [[32mCREATE TABLE (2.0 rows, 463.5 KiB processed)[0m in 3.40s]
[0m18:36:23.796596 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_vendor
[0m18:36:23.801072 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_zone
[0m18:36:23.804742 [info ] [Thread-1  ]: 6 of 7 START sql table model nyc_taxi.dim_zone ................................. [RUN]
[0m18:36:23.809998 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_vendor, now model.nyc_taxi.dim_zone)
[0m18:36:23.813473 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_zone
[0m18:36:23.832100 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_zone"
[0m18:36:23.853961 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_zone
[0m18:36:23.865024 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:36:24.654721 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.dim_zone"
[0m18:36:24.678228 [debug] [Thread-1  ]: On model.nyc_taxi.dim_zone: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.dim_zone"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`dim_zone`
      
    
    

    OPTIONS()
    as (
      SELECT DISTINCT
    location_id,
    borough,
    zone,
    replace(service_zone, 'Boro', 'Green') AS service_zone
FROM `northern-shield-437204-m0`.`nyc_taxi`.`zone_map`
WHERE service_zone IS NOT NULL
    );
  
[0m18:36:25.236842 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:cbc2a7d9-c8be-4768-8f77-9f4d190d086f&page=queryresults
[0m18:36:27.679215 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '240600f6-a449-4e06-bae2-a249928ab21f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5881852b0>]}
[0m18:36:27.683231 [info ] [Thread-1  ]: 6 of 7 OK created sql table model nyc_taxi.dim_zone ............................ [[32mCREATE TABLE (263.0 rows, 24.2 KiB processed)[0m in 3.87s]
[0m18:36:27.688749 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_zone
[0m18:36:27.692494 [debug] [Thread-1  ]: Began running node model.nyc_taxi.fct_trips
[0m18:36:27.695943 [info ] [Thread-1  ]: 7 of 7 START sql table model nyc_taxi.fct_trips ................................ [RUN]
[0m18:36:27.700038 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_zone, now model.nyc_taxi.fct_trips)
[0m18:36:27.704245 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.fct_trips
[0m18:36:27.769430 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.fct_trips"
[0m18:36:27.789510 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.fct_trips
[0m18:36:27.800497 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:36:28.413348 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.fct_trips"
[0m18:36:28.437553 [debug] [Thread-1  ]: On model.nyc_taxi.fct_trips: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.fct_trips"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips`
      
    
    

    OPTIONS()
    as (
      WITH tripdata_cte AS (
    SELECT 
        to_hex(md5(cast(coalesce(cast(t.vendor_id as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(t.lpep_pickup_datetime as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(t.lpep_dropoff_datetime as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(t.__index_level_0__ as string), '_dbt_utils_surrogate_key_null_') as string))) AS trip_id,
        t.vendor_id,
        pt.time_id AS pickup_time_id,
        dt.time_id AS dropoff_time_id,
        t.rate_code_id,
        t.pu_location_id,
        t.do_location_id,
        t.passenger_count,
        t.trip_distance,
        t.fare_amount,
        t.extra,
        t.mta_tax,
        t.tip_amount,
        t.tolls_amount,
        t.improvement_surcharge,
        t.total_amount,
        t.payment_type,
        t.trip_type,
        t.congestion_surcharge
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata` AS t
    INNER JOIN (
        SELECT DISTINCT date_part, time_id 
        FROM `northern-shield-437204-m0`.`nyc_taxi`.`dim_time`
    ) pt ON t.lpep_pickup_datetime = pt.date_part
    INNER JOIN (
        SELECT DISTINCT date_part, time_id 
        FROM `northern-shield-437204-m0`.`nyc_taxi`.`dim_time`
    ) dt ON t.lpep_dropoff_datetime = dt.date_part
)
SELECT 
    trip_id,
    vendor_id,
    pickup_time_id,
    dropoff_time_id,
    rate_code_id,
    pu_location_id,
    do_location_id,
    passenger_count,
    trip_distance,
    fare_amount,
    extra,
    mta_tax,
    tip_amount,
    tolls_amount,
    improvement_surcharge,
    total_amount,
    payment_type,
    trip_type,
    congestion_surcharge
FROM tripdata_cte
    );
  
[0m18:36:28.902738 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:0d4b7cd8-7ac3-441e-af18-bb3689e95a8a&page=queryresults
[0m18:36:32.846476 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '240600f6-a449-4e06-bae2-a249928ab21f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5880f5fd0>]}
[0m18:36:32.851167 [info ] [Thread-1  ]: 7 of 7 OK created sql table model nyc_taxi.fct_trips ........................... [[32mCREATE TABLE (59.3k rows, 10.4 MiB processed)[0m in 5.15s]
[0m18:36:32.857633 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.fct_trips
[0m18:36:32.863847 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:36:32.866583 [debug] [MainThread]: Connection 'model.nyc_taxi.fct_trips' was properly closed.
[0m18:36:32.869755 [info ] [MainThread]: 
[0m18:36:32.873493 [info ] [MainThread]: Finished running 7 table models in 0 hours 0 minutes and 31.22 seconds (31.22s).
[0m18:36:32.884679 [debug] [MainThread]: Command end result
[0m18:36:33.104332 [info ] [MainThread]: 
[0m18:36:33.107573 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:36:33.110396 [info ] [MainThread]: 
[0m18:36:33.113334 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m18:36:33.118439 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 39.268368, "process_in_blocks": "3232", "process_kernel_time": 0.754339, "process_mem_max_rss": "233608", "process_out_blocks": "0", "process_user_time": 13.846773}
[0m18:36:33.122824 [debug] [MainThread]: Command `dbt run` succeeded at 18:36:33.122340 after 39.27 seconds
[0m18:36:33.125840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb594b45430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb560317eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5941ae670>]}
[0m18:36:33.129290 [debug] [MainThread]: Flushing usage events
[0m18:37:03.869190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4f6c75f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4f4a4b9a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4f4a4b940>]}


============================== 18:37:03.885325 | a1059f39-b8a3-4647-9012-59c0362d8784 ==============================
[0m18:37:03.885325 [info ] [MainThread]: Running with dbt=1.8.9
[0m18:37:03.888969 [debug] [MainThread]: running dbt with arguments {'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'invocation_command': 'dbt test --profiles-dir /opt/airflow/include/dbt/', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'indirect_selection': 'eager', 'static_parser': 'True', 'use_colors': 'True', 'version_check': 'True', 'debug': 'False', 'use_experimental_parser': 'False', 'log_path': '/opt/airflow/include/dbt/logs', 'empty': 'None', 'no_print': 'None', 'printer_width': '80', 'target_path': 'None', 'fail_fast': 'False', 'log_cache_events': 'False', 'introspect': 'True', 'warn_error': 'None', 'write_json': 'True', 'cache_selected_only': 'False', 'log_format': 'default', 'profiles_dir': '/opt/airflow/include/dbt/'}
[0m18:37:08.045754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a1059f39-b8a3-4647-9012-59c0362d8784', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4f51e2c40>]}
[0m18:37:08.223719 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a1059f39-b8a3-4647-9012-59c0362d8784', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4bd658130>]}
[0m18:37:08.226670 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m18:37:08.691719 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m18:37:11.360298 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:37:11.363318 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:37:11.546754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a1059f39-b8a3-4647-9012-59c0362d8784', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4efdd6130>]}
[0m18:37:12.554250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a1059f39-b8a3-4647-9012-59c0362d8784', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4efdd65b0>]}
[0m18:37:12.557623 [info ] [MainThread]: Found 7 models, 34 data tests, 2 sources, 600 macros
[0m18:37:12.561787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a1059f39-b8a3-4647-9012-59c0362d8784', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4bd7074f0>]}
[0m18:37:12.580370 [info ] [MainThread]: 
[0m18:37:12.584031 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:37:12.602634 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_northern-shield-437204-m0_nyc_taxi'
[0m18:37:12.606084 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:37:13.543625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a1059f39-b8a3-4647-9012-59c0362d8784', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4f6fa7c70>]}
[0m18:37:13.547387 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:37:13.550526 [info ] [MainThread]: 
[0m18:37:13.569522 [debug] [Thread-1  ]: Began running node test.nyc_taxi.accepted_values_dim_payment_payment_name__Credit_card__Cash__No_charge__Dispute__Unknown__Voided_trip.58d00ef9f4
[0m18:37:13.573707 [info ] [Thread-1  ]: 1 of 34 START test accepted_values_dim_payment_payment_name__Credit_card__Cash__No_charge__Dispute__Unknown__Voided_trip  [RUN]
[0m18:37:13.576927 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_northern-shield-437204-m0_nyc_taxi, now test.nyc_taxi.accepted_values_dim_payment_payment_name__Credit_card__Cash__No_charge__Dispute__Unknown__Voided_trip.58d00ef9f4)
[0m18:37:13.580618 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.accepted_values_dim_payment_payment_name__Credit_card__Cash__No_charge__Dispute__Unknown__Voided_trip.58d00ef9f4
[0m18:37:13.651515 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.accepted_values_dim_payment_payment_name__Credit_card__Cash__No_charge__Dispute__Unknown__Voided_trip.58d00ef9f4"
[0m18:37:13.675706 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.accepted_values_dim_payment_payment_name__Credit_card__Cash__No_charge__Dispute__Unknown__Voided_trip.58d00ef9f4
[0m18:37:13.754313 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.accepted_values_dim_payment_payment_name__Credit_card__Cash__No_charge__Dispute__Unknown__Voided_trip.58d00ef9f4"
[0m18:37:13.778036 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:37:13.788165 [debug] [Thread-1  ]: On test.nyc_taxi.accepted_values_dim_payment_payment_name__Credit_card__Cash__No_charge__Dispute__Unknown__Voided_trip.58d00ef9f4: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.accepted_values_dim_payment_payment_name__Credit_card__Cash__No_charge__Dispute__Unknown__Voided_trip.58d00ef9f4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        payment_name as value_field,
        count(*) as n_records

    from `northern-shield-437204-m0`.`nyc_taxi`.`dim_payment`
    group by payment_name

)

select *
from all_values
where value_field not in (
    'Credit card','Cash','No charge','Dispute','Unknown','Voided trip'
)



      
    ) dbt_internal_test
[0m18:37:15.097845 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:c4959022-544b-48a3-9c55-d920f359184a&page=queryresults
[0m18:37:16.262569 [info ] [Thread-1  ]: 1 of 34 PASS accepted_values_dim_payment_payment_name__Credit_card__Cash__No_charge__Dispute__Unknown__Voided_trip  [[32mPASS[0m in 2.69s]
[0m18:37:16.267323 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.accepted_values_dim_payment_payment_name__Credit_card__Cash__No_charge__Dispute__Unknown__Voided_trip.58d00ef9f4
[0m18:37:16.271386 [debug] [Thread-1  ]: Began running node test.nyc_taxi.accepted_values_dim_ratecode_rate_code_name__Standard_rate__JFK__Newark__Nassau_or_Westchester__Negotiated_fare__Group_ride__Unknown.57ee02019f
[0m18:37:16.274753 [info ] [Thread-1  ]: 2 of 34 START test accepted_values_dim_ratecode_rate_code_name__Standard_rate__JFK__Newark__Nassau_or_Westchester__Negotiated_fare__Group_ride__Unknown  [RUN]
[0m18:37:16.277925 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.accepted_values_dim_payment_payment_name__Credit_card__Cash__No_charge__Dispute__Unknown__Voided_trip.58d00ef9f4, now test.nyc_taxi.accepted_values_dim_ratecode_rate_code_name__Standard_rate__JFK__Newark__Nassau_or_Westchester__Negotiated_fare__Group_ride__Unknown.57ee02019f)
[0m18:37:16.281172 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.accepted_values_dim_ratecode_rate_code_name__Standard_rate__JFK__Newark__Nassau_or_Westchester__Negotiated_fare__Group_ride__Unknown.57ee02019f
[0m18:37:16.311561 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.accepted_values_dim_ratecode_rate_code_name__Standard_rate__JFK__Newark__Nassau_or_Westchester__Negotiated_fare__Group_ride__Unknown.57ee02019f"
[0m18:37:16.337475 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.accepted_values_dim_ratecode_rate_code_name__Standard_rate__JFK__Newark__Nassau_or_Westchester__Negotiated_fare__Group_ride__Unknown.57ee02019f
[0m18:37:16.351114 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.accepted_values_dim_ratecode_rate_code_name__Standard_rate__JFK__Newark__Nassau_or_Westchester__Negotiated_fare__Group_ride__Unknown.57ee02019f"
[0m18:37:16.377254 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:37:16.387889 [debug] [Thread-1  ]: On test.nyc_taxi.accepted_values_dim_ratecode_rate_code_name__Standard_rate__JFK__Newark__Nassau_or_Westchester__Negotiated_fare__Group_ride__Unknown.57ee02019f: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.accepted_values_dim_ratecode_rate_code_name__Standard_rate__JFK__Newark__Nassau_or_Westchester__Negotiated_fare__Group_ride__Unknown.57ee02019f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        rate_code_name as value_field,
        count(*) as n_records

    from `northern-shield-437204-m0`.`nyc_taxi`.`dim_ratecode`
    group by rate_code_name

)

select *
from all_values
where value_field not in (
    'Standard rate','JFK','Newark','Nassau or Westchester','Negotiated fare','Group ride','Unknown'
)



      
    ) dbt_internal_test
[0m18:37:18.085008 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:69a5fdee-eaee-4927-a842-c1ade2f3add2&page=queryresults
[0m18:37:19.135124 [info ] [Thread-1  ]: 2 of 34 PASS accepted_values_dim_ratecode_rate_code_name__Standard_rate__JFK__Newark__Nassau_or_Westchester__Negotiated_fare__Group_ride__Unknown  [[32mPASS[0m in 2.86s]
[0m18:37:19.142175 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.accepted_values_dim_ratecode_rate_code_name__Standard_rate__JFK__Newark__Nassau_or_Westchester__Negotiated_fare__Group_ride__Unknown.57ee02019f
[0m18:37:19.146806 [debug] [Thread-1  ]: Began running node test.nyc_taxi.accepted_values_dim_time_weekday__Sunday__Monday__Tuesday__Wednesday__Thursday__Friday__Saturday.87b4c2a366
[0m18:37:19.150448 [info ] [Thread-1  ]: 3 of 34 START test accepted_values_dim_time_weekday__Sunday__Monday__Tuesday__Wednesday__Thursday__Friday__Saturday  [RUN]
[0m18:37:19.154885 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.accepted_values_dim_ratecode_rate_code_name__Standard_rate__JFK__Newark__Nassau_or_Westchester__Negotiated_fare__Group_ride__Unknown.57ee02019f, now test.nyc_taxi.accepted_values_dim_time_weekday__Sunday__Monday__Tuesday__Wednesday__Thursday__Friday__Saturday.87b4c2a366)
[0m18:37:19.160257 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.accepted_values_dim_time_weekday__Sunday__Monday__Tuesday__Wednesday__Thursday__Friday__Saturday.87b4c2a366
[0m18:37:19.206243 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.accepted_values_dim_time_weekday__Sunday__Monday__Tuesday__Wednesday__Thursday__Friday__Saturday.87b4c2a366"
[0m18:37:19.230389 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.accepted_values_dim_time_weekday__Sunday__Monday__Tuesday__Wednesday__Thursday__Friday__Saturday.87b4c2a366
[0m18:37:19.244117 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.accepted_values_dim_time_weekday__Sunday__Monday__Tuesday__Wednesday__Thursday__Friday__Saturday.87b4c2a366"
[0m18:37:19.265455 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:37:19.276585 [debug] [Thread-1  ]: On test.nyc_taxi.accepted_values_dim_time_weekday__Sunday__Monday__Tuesday__Wednesday__Thursday__Friday__Saturday.87b4c2a366: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.accepted_values_dim_time_weekday__Sunday__Monday__Tuesday__Wednesday__Thursday__Friday__Saturday.87b4c2a366"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        weekday as value_field,
        count(*) as n_records

    from `northern-shield-437204-m0`.`nyc_taxi`.`dim_time`
    group by weekday

)

select *
from all_values
where value_field not in (
    'Sunday','Monday','Tuesday','Wednesday','Thursday','Friday','Saturday'
)



      
    ) dbt_internal_test
[0m18:37:20.574133 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:0281ca26-3e57-403c-b1ff-dd3bb2cb2bd6&page=queryresults
[0m18:37:21.629777 [info ] [Thread-1  ]: 3 of 34 PASS accepted_values_dim_time_weekday__Sunday__Monday__Tuesday__Wednesday__Thursday__Friday__Saturday  [[32mPASS[0m in 2.47s]
[0m18:37:21.634986 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.accepted_values_dim_time_weekday__Sunday__Monday__Tuesday__Wednesday__Thursday__Friday__Saturday.87b4c2a366
[0m18:37:21.639209 [debug] [Thread-1  ]: Began running node test.nyc_taxi.accepted_values_dim_triptype_trip_name__Street_hail__Dispatch__Unknown.f5add8f4c9
[0m18:37:21.642408 [info ] [Thread-1  ]: 4 of 34 START test accepted_values_dim_triptype_trip_name__Street_hail__Dispatch__Unknown  [RUN]
[0m18:37:21.645713 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.accepted_values_dim_time_weekday__Sunday__Monday__Tuesday__Wednesday__Thursday__Friday__Saturday.87b4c2a366, now test.nyc_taxi.accepted_values_dim_triptype_trip_name__Street_hail__Dispatch__Unknown.f5add8f4c9)
[0m18:37:21.648941 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.accepted_values_dim_triptype_trip_name__Street_hail__Dispatch__Unknown.f5add8f4c9
[0m18:37:21.674467 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.accepted_values_dim_triptype_trip_name__Street_hail__Dispatch__Unknown.f5add8f4c9"
[0m18:37:21.697090 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.accepted_values_dim_triptype_trip_name__Street_hail__Dispatch__Unknown.f5add8f4c9
[0m18:37:21.710421 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.accepted_values_dim_triptype_trip_name__Street_hail__Dispatch__Unknown.f5add8f4c9"
[0m18:37:21.743981 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:37:21.773515 [debug] [Thread-1  ]: On test.nyc_taxi.accepted_values_dim_triptype_trip_name__Street_hail__Dispatch__Unknown.f5add8f4c9: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.accepted_values_dim_triptype_trip_name__Street_hail__Dispatch__Unknown.f5add8f4c9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        trip_name as value_field,
        count(*) as n_records

    from `northern-shield-437204-m0`.`nyc_taxi`.`dim_triptype`
    group by trip_name

)

select *
from all_values
where value_field not in (
    'Street-hail','Dispatch','Unknown'
)



      
    ) dbt_internal_test
[0m18:37:22.732321 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:e31e352c-9dc6-4dc0-9200-bb349f5dc752&page=queryresults
[0m18:37:23.764593 [info ] [Thread-1  ]: 4 of 34 PASS accepted_values_dim_triptype_trip_name__Street_hail__Dispatch__Unknown  [[32mPASS[0m in 2.12s]
[0m18:37:23.769574 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.accepted_values_dim_triptype_trip_name__Street_hail__Dispatch__Unknown.f5add8f4c9
[0m18:37:23.776416 [debug] [Thread-1  ]: Began running node test.nyc_taxi.accepted_values_dim_vendor_vendor_name__Creative_Mobile_Technologies__VeriFone_Inc_.7481cecf07
[0m18:37:23.780018 [info ] [Thread-1  ]: 5 of 34 START test accepted_values_dim_vendor_vendor_name__Creative_Mobile_Technologies__VeriFone_Inc_  [RUN]
[0m18:37:23.784080 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.accepted_values_dim_triptype_trip_name__Street_hail__Dispatch__Unknown.f5add8f4c9, now test.nyc_taxi.accepted_values_dim_vendor_vendor_name__Creative_Mobile_Technologies__VeriFone_Inc_.7481cecf07)
[0m18:37:23.788963 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.accepted_values_dim_vendor_vendor_name__Creative_Mobile_Technologies__VeriFone_Inc_.7481cecf07
[0m18:37:23.813592 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.accepted_values_dim_vendor_vendor_name__Creative_Mobile_Technologies__VeriFone_Inc_.7481cecf07"
[0m18:37:23.831767 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.accepted_values_dim_vendor_vendor_name__Creative_Mobile_Technologies__VeriFone_Inc_.7481cecf07
[0m18:37:23.844891 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.accepted_values_dim_vendor_vendor_name__Creative_Mobile_Technologies__VeriFone_Inc_.7481cecf07"
[0m18:37:23.863312 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:37:23.873891 [debug] [Thread-1  ]: On test.nyc_taxi.accepted_values_dim_vendor_vendor_name__Creative_Mobile_Technologies__VeriFone_Inc_.7481cecf07: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.accepted_values_dim_vendor_vendor_name__Creative_Mobile_Technologies__VeriFone_Inc_.7481cecf07"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        vendor_name as value_field,
        count(*) as n_records

    from `northern-shield-437204-m0`.`nyc_taxi`.`dim_vendor`
    group by vendor_name

)

select *
from all_values
where value_field not in (
    'Creative Mobile Technologies','VeriFone Inc.'
)



      
    ) dbt_internal_test
[0m18:37:24.881925 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:731dffe9-213a-4a8e-8e31-efcfb7f494c1&page=queryresults
[0m18:37:25.902464 [info ] [Thread-1  ]: 5 of 34 PASS accepted_values_dim_vendor_vendor_name__Creative_Mobile_Technologies__VeriFone_Inc_  [[32mPASS[0m in 2.12s]
[0m18:37:25.907492 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.accepted_values_dim_vendor_vendor_name__Creative_Mobile_Technologies__VeriFone_Inc_.7481cecf07
[0m18:37:25.917365 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_dim_payment_type_id.96dfa722aa
[0m18:37:25.920290 [info ] [Thread-1  ]: 6 of 34 START test not_null_dim_payment_type_id ................................ [RUN]
[0m18:37:25.925110 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.accepted_values_dim_vendor_vendor_name__Creative_Mobile_Technologies__VeriFone_Inc_.7481cecf07, now test.nyc_taxi.not_null_dim_payment_type_id.96dfa722aa)
[0m18:37:25.928428 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_dim_payment_type_id.96dfa722aa
[0m18:37:25.955628 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_dim_payment_type_id.96dfa722aa"
[0m18:37:25.977740 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_dim_payment_type_id.96dfa722aa
[0m18:37:25.992340 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_dim_payment_type_id.96dfa722aa"
[0m18:37:26.013318 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:37:26.026995 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_dim_payment_type_id.96dfa722aa: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_dim_payment_type_id.96dfa722aa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select type_id
from `northern-shield-437204-m0`.`nyc_taxi`.`dim_payment`
where type_id is null



      
    ) dbt_internal_test
[0m18:37:26.911496 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:e0c032f6-1ade-40d7-b01a-2b56d99909b3&page=queryresults
[0m18:37:27.999796 [info ] [Thread-1  ]: 6 of 34 PASS not_null_dim_payment_type_id ...................................... [[32mPASS[0m in 2.07s]
[0m18:37:28.005686 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_dim_payment_type_id.96dfa722aa
[0m18:37:28.009562 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_dim_time_date.2080f42875
[0m18:37:28.013315 [info ] [Thread-1  ]: 7 of 34 START test not_null_dim_time_date ...................................... [RUN]
[0m18:37:28.035299 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_dim_payment_type_id.96dfa722aa, now test.nyc_taxi.not_null_dim_time_date.2080f42875)
[0m18:37:28.045438 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_dim_time_date.2080f42875
[0m18:37:28.069471 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_dim_time_date.2080f42875"
[0m18:37:28.095241 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_dim_time_date.2080f42875
[0m18:37:28.109432 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_dim_time_date.2080f42875"
[0m18:37:28.132178 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:37:28.140795 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_dim_time_date.2080f42875: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_dim_time_date.2080f42875"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from `northern-shield-437204-m0`.`nyc_taxi`.`dim_time`
where date is null



      
    ) dbt_internal_test
[0m18:37:29.193462 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:bd3098eb-f48d-4c7f-bcea-62a51f70a2e3&page=queryresults
[0m18:37:30.232537 [info ] [Thread-1  ]: 7 of 34 PASS not_null_dim_time_date ............................................ [[32mPASS[0m in 2.20s]
[0m18:37:30.237624 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_dim_time_date.2080f42875
[0m18:37:30.242039 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_dim_time_date_part.59e6206332
[0m18:37:30.245576 [info ] [Thread-1  ]: 8 of 34 START test not_null_dim_time_date_part ................................. [RUN]
[0m18:37:30.249625 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_dim_time_date.2080f42875, now test.nyc_taxi.not_null_dim_time_date_part.59e6206332)
[0m18:37:30.253150 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_dim_time_date_part.59e6206332
[0m18:37:30.279993 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_dim_time_date_part.59e6206332"
[0m18:37:30.303082 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_dim_time_date_part.59e6206332
[0m18:37:30.316728 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_dim_time_date_part.59e6206332"
[0m18:37:30.342332 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:37:30.352980 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_dim_time_date_part.59e6206332: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_dim_time_date_part.59e6206332"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date_part
from `northern-shield-437204-m0`.`nyc_taxi`.`dim_time`
where date_part is null



      
    ) dbt_internal_test
[0m18:37:31.339938 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:b3598d7e-1733-4233-9d21-d0a56c21bc95&page=queryresults
[0m18:37:32.401357 [info ] [Thread-1  ]: 8 of 34 PASS not_null_dim_time_date_part ....................................... [[32mPASS[0m in 2.15s]
[0m18:37:32.405883 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_dim_time_date_part.59e6206332
[0m18:37:32.409862 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_dim_time_day.dc0e917166
[0m18:37:32.413458 [info ] [Thread-1  ]: 9 of 34 START test not_null_dim_time_day ....................................... [RUN]
[0m18:37:32.417594 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_dim_time_date_part.59e6206332, now test.nyc_taxi.not_null_dim_time_day.dc0e917166)
[0m18:37:32.420834 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_dim_time_day.dc0e917166
[0m18:37:32.440825 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_dim_time_day.dc0e917166"
[0m18:37:32.463918 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_dim_time_day.dc0e917166
[0m18:37:32.475260 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_dim_time_day.dc0e917166"
[0m18:37:32.500214 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:37:32.510548 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_dim_time_day.dc0e917166: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_dim_time_day.dc0e917166"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select day
from `northern-shield-437204-m0`.`nyc_taxi`.`dim_time`
where day is null



      
    ) dbt_internal_test
[0m18:37:33.354512 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:8929bfb8-ffde-4c6d-8ebf-38df47c1ca76&page=queryresults
[0m18:37:34.400080 [info ] [Thread-1  ]: 9 of 34 PASS not_null_dim_time_day ............................................. [[32mPASS[0m in 1.98s]
[0m18:37:34.406913 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_dim_time_day.dc0e917166
[0m18:37:34.411509 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_dim_time_hour.5b8ccd8f25
[0m18:37:34.414787 [info ] [Thread-1  ]: 10 of 34 START test not_null_dim_time_hour ..................................... [RUN]
[0m18:37:34.418457 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_dim_time_day.dc0e917166, now test.nyc_taxi.not_null_dim_time_hour.5b8ccd8f25)
[0m18:37:34.421164 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_dim_time_hour.5b8ccd8f25
[0m18:37:34.437352 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_dim_time_hour.5b8ccd8f25"
[0m18:37:34.473917 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_dim_time_hour.5b8ccd8f25
[0m18:37:34.486270 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_dim_time_hour.5b8ccd8f25"
[0m18:37:34.513860 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:37:34.525418 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_dim_time_hour.5b8ccd8f25: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_dim_time_hour.5b8ccd8f25"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select hour
from `northern-shield-437204-m0`.`nyc_taxi`.`dim_time`
where hour is null



      
    ) dbt_internal_test
[0m18:37:35.549047 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:54955d32-fce9-4735-81ad-eb38c9c530a4&page=queryresults
[0m18:37:36.783255 [info ] [Thread-1  ]: 10 of 34 PASS not_null_dim_time_hour ........................................... [[32mPASS[0m in 2.36s]
[0m18:37:36.788001 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_dim_time_hour.5b8ccd8f25
[0m18:37:36.796566 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_dim_time_minute.23e906ca61
[0m18:37:36.800276 [info ] [Thread-1  ]: 11 of 34 START test not_null_dim_time_minute ................................... [RUN]
[0m18:37:36.805825 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_dim_time_hour.5b8ccd8f25, now test.nyc_taxi.not_null_dim_time_minute.23e906ca61)
[0m18:37:36.809319 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_dim_time_minute.23e906ca61
[0m18:37:36.832628 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_dim_time_minute.23e906ca61"
[0m18:37:36.958946 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_dim_time_minute.23e906ca61
[0m18:37:36.985074 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_dim_time_minute.23e906ca61"
[0m18:37:37.024394 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:37:37.035689 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_dim_time_minute.23e906ca61: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_dim_time_minute.23e906ca61"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select minute
from `northern-shield-437204-m0`.`nyc_taxi`.`dim_time`
where minute is null



      
    ) dbt_internal_test
[0m18:37:38.908563 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:bca73050-2f1d-474e-8a3f-b40818c4c2e5&page=queryresults
[0m18:37:40.015406 [info ] [Thread-1  ]: 11 of 34 PASS not_null_dim_time_minute ......................................... [[32mPASS[0m in 3.21s]
[0m18:37:40.021365 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_dim_time_minute.23e906ca61
[0m18:37:40.027334 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_dim_time_month.9f6ecf2eb5
[0m18:37:40.031292 [info ] [Thread-1  ]: 12 of 34 START test not_null_dim_time_month .................................... [RUN]
[0m18:37:40.034605 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_dim_time_minute.23e906ca61, now test.nyc_taxi.not_null_dim_time_month.9f6ecf2eb5)
[0m18:37:40.037801 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_dim_time_month.9f6ecf2eb5
[0m18:37:40.061444 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_dim_time_month.9f6ecf2eb5"
[0m18:37:40.079622 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_dim_time_month.9f6ecf2eb5
[0m18:37:40.094487 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_dim_time_month.9f6ecf2eb5"
[0m18:37:40.118746 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:37:40.128641 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_dim_time_month.9f6ecf2eb5: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_dim_time_month.9f6ecf2eb5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select month
from `northern-shield-437204-m0`.`nyc_taxi`.`dim_time`
where month is null



      
    ) dbt_internal_test
[0m18:37:40.984904 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:60842b0e-5742-4faf-b39d-eac6e8d4e123&page=queryresults
[0m18:37:42.018268 [info ] [Thread-1  ]: 12 of 34 PASS not_null_dim_time_month .......................................... [[32mPASS[0m in 1.98s]
[0m18:37:42.023796 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_dim_time_month.9f6ecf2eb5
[0m18:37:42.028496 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_dim_time_year.6fb9595d53
[0m18:37:42.032689 [info ] [Thread-1  ]: 13 of 34 START test not_null_dim_time_year ..................................... [RUN]
[0m18:37:42.036806 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_dim_time_month.9f6ecf2eb5, now test.nyc_taxi.not_null_dim_time_year.6fb9595d53)
[0m18:37:42.039984 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_dim_time_year.6fb9595d53
[0m18:37:42.066655 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_dim_time_year.6fb9595d53"
[0m18:37:42.090074 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_dim_time_year.6fb9595d53
[0m18:37:42.103102 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_dim_time_year.6fb9595d53"
[0m18:37:42.128892 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:37:42.143595 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_dim_time_year.6fb9595d53: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_dim_time_year.6fb9595d53"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select year
from `northern-shield-437204-m0`.`nyc_taxi`.`dim_time`
where year is null



      
    ) dbt_internal_test
[0m18:37:43.129790 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:cb25b0b3-fd23-4aed-a105-695dcdc52c09&page=queryresults
[0m18:37:44.178698 [info ] [Thread-1  ]: 13 of 34 PASS not_null_dim_time_year ........................................... [[32mPASS[0m in 2.14s]
[0m18:37:44.182913 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_dim_time_year.6fb9595d53
[0m18:37:44.186896 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_dim_zone_borough.1ed2272c52
[0m18:37:44.189801 [info ] [Thread-1  ]: 14 of 34 START test not_null_dim_zone_borough .................................. [RUN]
[0m18:37:44.193054 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_dim_time_year.6fb9595d53, now test.nyc_taxi.not_null_dim_zone_borough.1ed2272c52)
[0m18:37:44.196102 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_dim_zone_borough.1ed2272c52
[0m18:37:44.220767 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_dim_zone_borough.1ed2272c52"
[0m18:37:44.245380 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_dim_zone_borough.1ed2272c52
[0m18:37:44.258221 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_dim_zone_borough.1ed2272c52"
[0m18:37:44.282893 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:37:44.292717 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_dim_zone_borough.1ed2272c52: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_dim_zone_borough.1ed2272c52"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select borough
from `northern-shield-437204-m0`.`nyc_taxi`.`dim_zone`
where borough is null



      
    ) dbt_internal_test
[0m18:37:45.439638 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:dceb7a0f-f44f-487e-be81-b70a53559133&page=queryresults
[0m18:37:46.448136 [info ] [Thread-1  ]: 14 of 34 PASS not_null_dim_zone_borough ........................................ [[32mPASS[0m in 2.25s]
[0m18:37:46.452337 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_dim_zone_borough.1ed2272c52
[0m18:37:46.456770 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_dim_zone_service_zone.2007f611c5
[0m18:37:46.462954 [info ] [Thread-1  ]: 15 of 34 START test not_null_dim_zone_service_zone ............................. [RUN]
[0m18:37:46.466133 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_dim_zone_borough.1ed2272c52, now test.nyc_taxi.not_null_dim_zone_service_zone.2007f611c5)
[0m18:37:46.469303 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_dim_zone_service_zone.2007f611c5
[0m18:37:46.485517 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_dim_zone_service_zone.2007f611c5"
[0m18:37:46.508237 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_dim_zone_service_zone.2007f611c5
[0m18:37:46.519272 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_dim_zone_service_zone.2007f611c5"
[0m18:37:46.545244 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:37:46.556047 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_dim_zone_service_zone.2007f611c5: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_dim_zone_service_zone.2007f611c5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select service_zone
from `northern-shield-437204-m0`.`nyc_taxi`.`dim_zone`
where service_zone is null



      
    ) dbt_internal_test
[0m18:37:47.418893 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:e8e08c84-e98c-4ad0-b636-3a54c7bc35bf&page=queryresults
[0m18:37:48.494836 [info ] [Thread-1  ]: 15 of 34 PASS not_null_dim_zone_service_zone ................................... [[32mPASS[0m in 2.03s]
[0m18:37:48.499107 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_dim_zone_service_zone.2007f611c5
[0m18:37:48.508404 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_dim_zone_zone.a1c4a4c37a
[0m18:37:48.511641 [info ] [Thread-1  ]: 16 of 34 START test not_null_dim_zone_zone ..................................... [RUN]
[0m18:37:48.515359 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_dim_zone_service_zone.2007f611c5, now test.nyc_taxi.not_null_dim_zone_zone.a1c4a4c37a)
[0m18:37:48.519925 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_dim_zone_zone.a1c4a4c37a
[0m18:37:48.538822 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_dim_zone_zone.a1c4a4c37a"
[0m18:37:48.561381 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_dim_zone_zone.a1c4a4c37a
[0m18:37:48.572030 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_dim_zone_zone.a1c4a4c37a"
[0m18:37:48.595700 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:37:48.605766 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_dim_zone_zone.a1c4a4c37a: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_dim_zone_zone.a1c4a4c37a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select zone
from `northern-shield-437204-m0`.`nyc_taxi`.`dim_zone`
where zone is null



      
    ) dbt_internal_test
[0m18:37:49.475458 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:d33b0b1a-20d9-4078-b8b0-c51f88ab2506&page=queryresults
[0m18:37:50.530592 [info ] [Thread-1  ]: 16 of 34 PASS not_null_dim_zone_zone ........................................... [[32mPASS[0m in 2.02s]
[0m18:37:50.534982 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_dim_zone_zone.a1c4a4c37a
[0m18:37:50.538883 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_do_location_id.6acdd302a6
[0m18:37:50.542181 [info ] [Thread-1  ]: 17 of 34 START test not_null_fct_trips_do_location_id .......................... [RUN]
[0m18:37:50.545670 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_dim_zone_zone.a1c4a4c37a, now test.nyc_taxi.not_null_fct_trips_do_location_id.6acdd302a6)
[0m18:37:50.548674 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_do_location_id.6acdd302a6
[0m18:37:50.566643 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_do_location_id.6acdd302a6"
[0m18:37:50.586362 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_do_location_id.6acdd302a6
[0m18:37:50.597659 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_fct_trips_do_location_id.6acdd302a6"
[0m18:37:50.621422 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:37:50.630733 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_fct_trips_do_location_id.6acdd302a6: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_fct_trips_do_location_id.6acdd302a6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select do_location_id
from `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips`
where do_location_id is null



      
    ) dbt_internal_test
[0m18:37:51.722944 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:719bba3e-279a-4d3d-9a63-aba258082c45&page=queryresults
[0m18:37:52.787180 [info ] [Thread-1  ]: 17 of 34 PASS not_null_fct_trips_do_location_id ................................ [[32mPASS[0m in 2.24s]
[0m18:37:52.791952 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_do_location_id.6acdd302a6
[0m18:37:52.796299 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_dropoff_time_id.781496e98f
[0m18:37:52.799466 [info ] [Thread-1  ]: 18 of 34 START test not_null_fct_trips_dropoff_time_id ......................... [RUN]
[0m18:37:52.802996 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_do_location_id.6acdd302a6, now test.nyc_taxi.not_null_fct_trips_dropoff_time_id.781496e98f)
[0m18:37:52.806495 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_dropoff_time_id.781496e98f
[0m18:37:52.827976 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_dropoff_time_id.781496e98f"
[0m18:37:52.852787 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_dropoff_time_id.781496e98f
[0m18:37:52.863481 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_fct_trips_dropoff_time_id.781496e98f"
[0m18:37:52.890082 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:37:52.900189 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_fct_trips_dropoff_time_id.781496e98f: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_fct_trips_dropoff_time_id.781496e98f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select dropoff_time_id
from `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips`
where dropoff_time_id is null



      
    ) dbt_internal_test
[0m18:37:53.834037 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:a824338e-ddc0-40a1-aa0f-602c3421414d&page=queryresults
[0m18:37:54.862573 [info ] [Thread-1  ]: 18 of 34 PASS not_null_fct_trips_dropoff_time_id ............................... [[32mPASS[0m in 2.06s]
[0m18:37:54.872115 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_dropoff_time_id.781496e98f
[0m18:37:54.880972 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_extra.1801055bb3
[0m18:37:54.889041 [info ] [Thread-1  ]: 19 of 34 START test not_null_fct_trips_extra ................................... [RUN]
[0m18:37:54.894653 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_dropoff_time_id.781496e98f, now test.nyc_taxi.not_null_fct_trips_extra.1801055bb3)
[0m18:37:54.898915 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_extra.1801055bb3
[0m18:37:54.919209 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_extra.1801055bb3"
[0m18:37:54.945543 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_extra.1801055bb3
[0m18:37:54.974999 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_fct_trips_extra.1801055bb3"
[0m18:37:55.001337 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:37:55.021091 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_fct_trips_extra.1801055bb3: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_fct_trips_extra.1801055bb3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select extra
from `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips`
where extra is null



      
    ) dbt_internal_test
[0m18:37:55.926170 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:0e17e0a7-6393-409d-85d7-844dfe39a360&page=queryresults
[0m18:37:56.963744 [info ] [Thread-1  ]: 19 of 34 PASS not_null_fct_trips_extra ......................................... [[32mPASS[0m in 2.07s]
[0m18:37:56.968690 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_extra.1801055bb3
[0m18:37:56.972774 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_improvement_surcharge.4cf28d1443
[0m18:37:56.976484 [info ] [Thread-1  ]: 20 of 34 START test not_null_fct_trips_improvement_surcharge ................... [RUN]
[0m18:37:56.979806 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_extra.1801055bb3, now test.nyc_taxi.not_null_fct_trips_improvement_surcharge.4cf28d1443)
[0m18:37:56.983012 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_improvement_surcharge.4cf28d1443
[0m18:37:57.010230 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_improvement_surcharge.4cf28d1443"
[0m18:37:57.031530 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_improvement_surcharge.4cf28d1443
[0m18:37:57.042300 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_fct_trips_improvement_surcharge.4cf28d1443"
[0m18:37:57.059167 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:37:57.068693 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_fct_trips_improvement_surcharge.4cf28d1443: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_fct_trips_improvement_surcharge.4cf28d1443"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select improvement_surcharge
from `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips`
where improvement_surcharge is null



      
    ) dbt_internal_test
[0m18:37:57.970156 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:bbdc061b-dafb-4160-a495-68b186ea6a79&page=queryresults
[0m18:37:59.066163 [info ] [Thread-1  ]: 20 of 34 PASS not_null_fct_trips_improvement_surcharge ......................... [[32mPASS[0m in 2.09s]
[0m18:37:59.070470 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_improvement_surcharge.4cf28d1443
[0m18:37:59.082054 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_passenger_count.b1370cab1c
[0m18:37:59.085677 [info ] [Thread-1  ]: 21 of 34 START test not_null_fct_trips_passenger_count ......................... [RUN]
[0m18:37:59.089413 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_improvement_surcharge.4cf28d1443, now test.nyc_taxi.not_null_fct_trips_passenger_count.b1370cab1c)
[0m18:37:59.095694 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_passenger_count.b1370cab1c
[0m18:37:59.116852 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_passenger_count.b1370cab1c"
[0m18:37:59.139176 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_passenger_count.b1370cab1c
[0m18:37:59.152369 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_fct_trips_passenger_count.b1370cab1c"
[0m18:37:59.170082 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:37:59.180524 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_fct_trips_passenger_count.b1370cab1c: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_fct_trips_passenger_count.b1370cab1c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select passenger_count
from `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips`
where passenger_count is null



      
    ) dbt_internal_test
[0m18:38:00.101603 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:f5042ce3-afce-47b6-a00c-5f50493861d2&page=queryresults
[0m18:38:01.177286 [info ] [Thread-1  ]: 21 of 34 PASS not_null_fct_trips_passenger_count ............................... [[32mPASS[0m in 2.09s]
[0m18:38:01.182912 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_passenger_count.b1370cab1c
[0m18:38:01.187404 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_payment_type.93889b679a
[0m18:38:01.190815 [info ] [Thread-1  ]: 22 of 34 START test not_null_fct_trips_payment_type ............................ [RUN]
[0m18:38:01.195077 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_passenger_count.b1370cab1c, now test.nyc_taxi.not_null_fct_trips_payment_type.93889b679a)
[0m18:38:01.199664 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_payment_type.93889b679a
[0m18:38:01.219722 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_payment_type.93889b679a"
[0m18:38:01.238255 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_payment_type.93889b679a
[0m18:38:01.250806 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_fct_trips_payment_type.93889b679a"
[0m18:38:01.270872 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:38:01.281106 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_fct_trips_payment_type.93889b679a: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_fct_trips_payment_type.93889b679a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select payment_type
from `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips`
where payment_type is null



      
    ) dbt_internal_test
[0m18:38:02.250046 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:9d0fce7f-bdf1-4473-b557-225cfb263b8a&page=queryresults
[0m18:38:03.284323 [info ] [Thread-1  ]: 22 of 34 PASS not_null_fct_trips_payment_type .................................. [[32mPASS[0m in 2.09s]
[0m18:38:03.289084 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_payment_type.93889b679a
[0m18:38:03.292786 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_pickup_time_id.f31fbe0eeb
[0m18:38:03.296249 [info ] [Thread-1  ]: 23 of 34 START test not_null_fct_trips_pickup_time_id .......................... [RUN]
[0m18:38:03.299864 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_payment_type.93889b679a, now test.nyc_taxi.not_null_fct_trips_pickup_time_id.f31fbe0eeb)
[0m18:38:03.303283 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_pickup_time_id.f31fbe0eeb
[0m18:38:03.326661 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_pickup_time_id.f31fbe0eeb"
[0m18:38:03.351326 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_pickup_time_id.f31fbe0eeb
[0m18:38:03.362509 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_fct_trips_pickup_time_id.f31fbe0eeb"
[0m18:38:03.385785 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:38:03.394904 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_fct_trips_pickup_time_id.f31fbe0eeb: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_fct_trips_pickup_time_id.f31fbe0eeb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select pickup_time_id
from `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips`
where pickup_time_id is null



      
    ) dbt_internal_test
[0m18:38:04.363637 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:34766241-b1b0-4c02-8bc1-efde0c3e991b&page=queryresults
[0m18:38:05.390009 [info ] [Thread-1  ]: 23 of 34 PASS not_null_fct_trips_pickup_time_id ................................ [[32mPASS[0m in 2.09s]
[0m18:38:05.395682 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_pickup_time_id.f31fbe0eeb
[0m18:38:05.399091 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_pu_location_id.b0dc8dd185
[0m18:38:05.402080 [info ] [Thread-1  ]: 24 of 34 START test not_null_fct_trips_pu_location_id .......................... [RUN]
[0m18:38:05.404955 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_pickup_time_id.f31fbe0eeb, now test.nyc_taxi.not_null_fct_trips_pu_location_id.b0dc8dd185)
[0m18:38:05.408120 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_pu_location_id.b0dc8dd185
[0m18:38:05.431043 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_pu_location_id.b0dc8dd185"
[0m18:38:05.451517 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_pu_location_id.b0dc8dd185
[0m18:38:05.464364 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_fct_trips_pu_location_id.b0dc8dd185"
[0m18:38:05.485547 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:38:05.495210 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_fct_trips_pu_location_id.b0dc8dd185: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_fct_trips_pu_location_id.b0dc8dd185"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select pu_location_id
from `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips`
where pu_location_id is null



      
    ) dbt_internal_test
[0m18:38:06.460128 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:846012f9-5111-4a6b-89a9-45153b37e1c3&page=queryresults
[0m18:38:07.514693 [info ] [Thread-1  ]: 24 of 34 PASS not_null_fct_trips_pu_location_id ................................ [[32mPASS[0m in 2.11s]
[0m18:38:07.519626 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_pu_location_id.b0dc8dd185
[0m18:38:07.523308 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_rate_code_id.ba0047eaae
[0m18:38:07.526524 [info ] [Thread-1  ]: 25 of 34 START test not_null_fct_trips_rate_code_id ............................ [RUN]
[0m18:38:07.529696 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_pu_location_id.b0dc8dd185, now test.nyc_taxi.not_null_fct_trips_rate_code_id.ba0047eaae)
[0m18:38:07.533231 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_rate_code_id.ba0047eaae
[0m18:38:07.550802 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_rate_code_id.ba0047eaae"
[0m18:38:07.572295 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_rate_code_id.ba0047eaae
[0m18:38:07.585155 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_fct_trips_rate_code_id.ba0047eaae"
[0m18:38:07.603953 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:38:07.613196 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_fct_trips_rate_code_id.ba0047eaae: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_fct_trips_rate_code_id.ba0047eaae"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select rate_code_id
from `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips`
where rate_code_id is null



      
    ) dbt_internal_test
[0m18:38:09.426208 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:25493a5b-1ea7-4f7c-ac32-6c6c5f1a0bb3&page=queryresults
[0m18:38:10.440437 [info ] [Thread-1  ]: 25 of 34 PASS not_null_fct_trips_rate_code_id .................................. [[32mPASS[0m in 2.91s]
[0m18:38:10.446590 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_rate_code_id.ba0047eaae
[0m18:38:10.456751 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_trip_distance.19cd17f1df
[0m18:38:10.461004 [info ] [Thread-1  ]: 26 of 34 START test not_null_fct_trips_trip_distance ........................... [RUN]
[0m18:38:10.475448 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_rate_code_id.ba0047eaae, now test.nyc_taxi.not_null_fct_trips_trip_distance.19cd17f1df)
[0m18:38:10.485365 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_trip_distance.19cd17f1df
[0m18:38:10.508864 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_trip_distance.19cd17f1df"
[0m18:38:10.524852 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_trip_distance.19cd17f1df
[0m18:38:10.535821 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_fct_trips_trip_distance.19cd17f1df"
[0m18:38:10.552776 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:38:10.561957 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_fct_trips_trip_distance.19cd17f1df: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_fct_trips_trip_distance.19cd17f1df"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select trip_distance
from `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips`
where trip_distance is null



      
    ) dbt_internal_test
[0m18:38:11.417901 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:aad09b48-11de-4f55-ab6f-542cc40883ff&page=queryresults
[0m18:38:12.511574 [info ] [Thread-1  ]: 26 of 34 PASS not_null_fct_trips_trip_distance ................................. [[32mPASS[0m in 2.04s]
[0m18:38:12.517045 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_trip_distance.19cd17f1df
[0m18:38:12.521062 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_vendor_id.b9b2f380bb
[0m18:38:12.524542 [info ] [Thread-1  ]: 27 of 34 START test not_null_fct_trips_vendor_id ............................... [RUN]
[0m18:38:12.532120 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_trip_distance.19cd17f1df, now test.nyc_taxi.not_null_fct_trips_vendor_id.b9b2f380bb)
[0m18:38:12.535867 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_vendor_id.b9b2f380bb
[0m18:38:12.562829 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_vendor_id.b9b2f380bb"
[0m18:38:12.588158 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_vendor_id.b9b2f380bb
[0m18:38:12.601110 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_fct_trips_vendor_id.b9b2f380bb"
[0m18:38:12.622701 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:38:12.644460 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_fct_trips_vendor_id.b9b2f380bb: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_fct_trips_vendor_id.b9b2f380bb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select vendor_id
from `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips`
where vendor_id is null



      
    ) dbt_internal_test
[0m18:38:13.484006 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:3f65d553-eb84-409b-80ba-b7a0c68742d2&page=queryresults
[0m18:38:14.534003 [info ] [Thread-1  ]: 27 of 34 PASS not_null_fct_trips_vendor_id ..................................... [[32mPASS[0m in 2.00s]
[0m18:38:14.539119 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_vendor_id.b9b2f380bb
[0m18:38:14.543219 [debug] [Thread-1  ]: Began running node test.nyc_taxi.unique_dim_payment_type_id.dea55de04e
[0m18:38:14.546710 [info ] [Thread-1  ]: 28 of 34 START test unique_dim_payment_type_id ................................. [RUN]
[0m18:38:14.550029 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_vendor_id.b9b2f380bb, now test.nyc_taxi.unique_dim_payment_type_id.dea55de04e)
[0m18:38:14.553380 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.unique_dim_payment_type_id.dea55de04e
[0m18:38:14.582222 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.unique_dim_payment_type_id.dea55de04e"
[0m18:38:14.606203 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.unique_dim_payment_type_id.dea55de04e
[0m18:38:14.617398 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.unique_dim_payment_type_id.dea55de04e"
[0m18:38:14.644913 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:38:14.655182 [debug] [Thread-1  ]: On test.nyc_taxi.unique_dim_payment_type_id.dea55de04e: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.unique_dim_payment_type_id.dea55de04e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select type_id as unique_field
  from `northern-shield-437204-m0`.`nyc_taxi`.`dim_payment`
  where type_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m18:38:15.616483 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:ca91cb60-0c86-410e-bcb1-ab0d0d0669d9&page=queryresults
[0m18:38:16.654655 [info ] [Thread-1  ]: 28 of 34 PASS unique_dim_payment_type_id ....................................... [[32mPASS[0m in 2.10s]
[0m18:38:16.659394 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.unique_dim_payment_type_id.dea55de04e
[0m18:38:16.664954 [debug] [Thread-1  ]: Began running node test.nyc_taxi.unique_dim_ratecode_rate_id.75ae8e4885
[0m18:38:16.668868 [info ] [Thread-1  ]: 29 of 34 START test unique_dim_ratecode_rate_id ................................ [RUN]
[0m18:38:16.672245 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.unique_dim_payment_type_id.dea55de04e, now test.nyc_taxi.unique_dim_ratecode_rate_id.75ae8e4885)
[0m18:38:16.675733 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.unique_dim_ratecode_rate_id.75ae8e4885
[0m18:38:16.696072 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.unique_dim_ratecode_rate_id.75ae8e4885"
[0m18:38:16.722293 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.unique_dim_ratecode_rate_id.75ae8e4885
[0m18:38:16.733704 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.unique_dim_ratecode_rate_id.75ae8e4885"
[0m18:38:16.760487 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:38:16.770489 [debug] [Thread-1  ]: On test.nyc_taxi.unique_dim_ratecode_rate_id.75ae8e4885: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.unique_dim_ratecode_rate_id.75ae8e4885"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select rate_id as unique_field
  from `northern-shield-437204-m0`.`nyc_taxi`.`dim_ratecode`
  where rate_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m18:38:17.778275 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:6270e347-3ca6-46a0-929b-78858aa7c24d&page=queryresults
[0m18:38:18.789627 [info ] [Thread-1  ]: 29 of 34 PASS unique_dim_ratecode_rate_id ...................................... [[32mPASS[0m in 2.12s]
[0m18:38:18.797153 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.unique_dim_ratecode_rate_id.75ae8e4885
[0m18:38:18.804189 [debug] [Thread-1  ]: Began running node test.nyc_taxi.unique_dim_time_time_id.0752c025e8
[0m18:38:18.809291 [info ] [Thread-1  ]: 30 of 34 START test unique_dim_time_time_id .................................... [RUN]
[0m18:38:18.822181 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.unique_dim_ratecode_rate_id.75ae8e4885, now test.nyc_taxi.unique_dim_time_time_id.0752c025e8)
[0m18:38:18.826278 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.unique_dim_time_time_id.0752c025e8
[0m18:38:18.852621 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.unique_dim_time_time_id.0752c025e8"
[0m18:38:18.874293 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.unique_dim_time_time_id.0752c025e8
[0m18:38:18.894435 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.unique_dim_time_time_id.0752c025e8"
[0m18:38:18.916528 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:38:18.925320 [debug] [Thread-1  ]: On test.nyc_taxi.unique_dim_time_time_id.0752c025e8: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.unique_dim_time_time_id.0752c025e8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select time_id as unique_field
  from `northern-shield-437204-m0`.`nyc_taxi`.`dim_time`
  where time_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m18:38:20.232340 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:668b5e1d-8ce6-4ca4-b74d-acd78bb33aae&page=queryresults
[0m18:38:21.246604 [info ] [Thread-1  ]: 30 of 34 PASS unique_dim_time_time_id .......................................... [[32mPASS[0m in 2.42s]
[0m18:38:21.252007 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.unique_dim_time_time_id.0752c025e8
[0m18:38:21.256295 [debug] [Thread-1  ]: Began running node test.nyc_taxi.unique_dim_triptype_type_id.fbaf29d341
[0m18:38:21.262399 [info ] [Thread-1  ]: 31 of 34 START test unique_dim_triptype_type_id ................................ [RUN]
[0m18:38:21.267707 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.unique_dim_time_time_id.0752c025e8, now test.nyc_taxi.unique_dim_triptype_type_id.fbaf29d341)
[0m18:38:21.271014 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.unique_dim_triptype_type_id.fbaf29d341
[0m18:38:21.294946 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.unique_dim_triptype_type_id.fbaf29d341"
[0m18:38:21.325484 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.unique_dim_triptype_type_id.fbaf29d341
[0m18:38:21.337784 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.unique_dim_triptype_type_id.fbaf29d341"
[0m18:38:21.360577 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:38:21.370631 [debug] [Thread-1  ]: On test.nyc_taxi.unique_dim_triptype_type_id.fbaf29d341: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.unique_dim_triptype_type_id.fbaf29d341"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select type_id as unique_field
  from `northern-shield-437204-m0`.`nyc_taxi`.`dim_triptype`
  where type_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m18:38:22.365491 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:b77b9cbf-e655-4499-989d-46d692e6d011&page=queryresults
[0m18:38:23.525681 [info ] [Thread-1  ]: 31 of 34 PASS unique_dim_triptype_type_id ...................................... [[32mPASS[0m in 2.26s]
[0m18:38:23.532702 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.unique_dim_triptype_type_id.fbaf29d341
[0m18:38:23.536302 [debug] [Thread-1  ]: Began running node test.nyc_taxi.unique_dim_vendor_id.03fad38d04
[0m18:38:23.539931 [info ] [Thread-1  ]: 32 of 34 START test unique_dim_vendor_id ....................................... [RUN]
[0m18:38:23.543316 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.unique_dim_triptype_type_id.fbaf29d341, now test.nyc_taxi.unique_dim_vendor_id.03fad38d04)
[0m18:38:23.547239 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.unique_dim_vendor_id.03fad38d04
[0m18:38:23.564334 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.unique_dim_vendor_id.03fad38d04"
[0m18:38:23.588792 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.unique_dim_vendor_id.03fad38d04
[0m18:38:23.599324 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.unique_dim_vendor_id.03fad38d04"
[0m18:38:23.623332 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:38:23.633006 [debug] [Thread-1  ]: On test.nyc_taxi.unique_dim_vendor_id.03fad38d04: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.unique_dim_vendor_id.03fad38d04"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select id as unique_field
  from `northern-shield-437204-m0`.`nyc_taxi`.`dim_vendor`
  where id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m18:38:25.452660 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:088935bf-b8d6-4983-a1a7-7f8eecdb18a3&page=queryresults
[0m18:38:26.510109 [info ] [Thread-1  ]: 32 of 34 PASS unique_dim_vendor_id ............................................. [[32mPASS[0m in 2.97s]
[0m18:38:26.515544 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.unique_dim_vendor_id.03fad38d04
[0m18:38:26.520261 [debug] [Thread-1  ]: Began running node test.nyc_taxi.unique_dim_zone_location_id.7702f92424
[0m18:38:26.523532 [info ] [Thread-1  ]: 33 of 34 START test unique_dim_zone_location_id ................................ [RUN]
[0m18:38:26.526523 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.unique_dim_vendor_id.03fad38d04, now test.nyc_taxi.unique_dim_zone_location_id.7702f92424)
[0m18:38:26.529518 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.unique_dim_zone_location_id.7702f92424
[0m18:38:26.553551 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.unique_dim_zone_location_id.7702f92424"
[0m18:38:26.578521 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.unique_dim_zone_location_id.7702f92424
[0m18:38:26.592292 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.unique_dim_zone_location_id.7702f92424"
[0m18:38:26.618600 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:38:26.628359 [debug] [Thread-1  ]: On test.nyc_taxi.unique_dim_zone_location_id.7702f92424: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.unique_dim_zone_location_id.7702f92424"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select location_id as unique_field
  from `northern-shield-437204-m0`.`nyc_taxi`.`dim_zone`
  where location_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m18:38:27.550145 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:fb3479fc-c382-409d-bad2-1308a5a05aae&page=queryresults
[0m18:38:28.605003 [info ] [Thread-1  ]: 33 of 34 PASS unique_dim_zone_location_id ...................................... [[32mPASS[0m in 2.08s]
[0m18:38:28.610330 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.unique_dim_zone_location_id.7702f92424
[0m18:38:28.613693 [debug] [Thread-1  ]: Began running node test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab
[0m18:38:28.616791 [info ] [Thread-1  ]: 34 of 34 START test unique_fct_trips_trip_id ................................... [RUN]
[0m18:38:28.619895 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.unique_dim_zone_location_id.7702f92424, now test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab)
[0m18:38:28.624740 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab
[0m18:38:28.645088 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab"
[0m18:38:28.667867 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab
[0m18:38:28.680022 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab"
[0m18:38:28.704393 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:38:28.715595 [debug] [Thread-1  ]: On test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select trip_id as unique_field
  from `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips`
  where trip_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m18:38:30.917900 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:0a7f58a3-a565-4ac0-99c6-7cec1927b4ab&page=queryresults
[0m18:38:31.938630 [info ] [Thread-1  ]: 34 of 34 PASS unique_fct_trips_trip_id ......................................... [[32mPASS[0m in 3.32s]
[0m18:38:31.943321 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab
[0m18:38:31.950253 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:38:31.952997 [debug] [MainThread]: Connection 'test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab' was properly closed.
[0m18:38:31.956258 [info ] [MainThread]: 
[0m18:38:31.959358 [info ] [MainThread]: Finished running 34 data tests in 0 hours 1 minutes and 19.37 seconds (79.37s).
[0m18:38:31.996946 [debug] [MainThread]: Command end result
[0m18:38:32.241355 [info ] [MainThread]: 
[0m18:38:32.244381 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:38:32.249692 [info ] [MainThread]: 
[0m18:38:32.253884 [info ] [MainThread]: Done. PASS=34 WARN=0 ERROR=0 SKIP=0 TOTAL=34
[0m18:38:32.259553 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 85.96313, "process_in_blocks": "1440", "process_kernel_time": 1.00066, "process_mem_max_rss": "257548", "process_out_blocks": "568", "process_user_time": 18.084106}
[0m18:38:32.265494 [debug] [MainThread]: Command `dbt test` succeeded at 18:38:32.264296 after 85.97 seconds
[0m18:38:32.269557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4f6c75f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4bd658130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4f576c670>]}
[0m18:38:32.272968 [debug] [MainThread]: Flushing usage events
[0m07:51:45.634901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc343847f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc34161d8e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc34161d880>]}


============================== 07:51:45.652516 | 75498389-2882-45ab-8c07-bce3931e9cf4 ==============================
[0m07:51:45.652516 [info ] [MainThread]: Running with dbt=1.8.9
[0m07:51:45.656255 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'profiles_dir': '/opt/airflow/include/dbt/', 'use_colors': 'True', 'log_format': 'default', 'printer_width': '80', 'target_path': 'None', 'fail_fast': 'False', 'version_check': 'True', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True', 'invocation_command': 'dbt test --profiles-dir /opt/airflow/include/dbt/', 'debug': 'False', 'indirect_selection': 'eager', 'quiet': 'False', 'log_cache_events': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'empty': 'None', 'use_experimental_parser': 'False', 'static_parser': 'True', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'log_path': '/opt/airflow/include/dbt/logs', 'no_print': 'None'}
[0m07:51:49.915966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '75498389-2882-45ab-8c07-bce3931e9cf4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc30a19d130>]}
[0m07:51:50.073353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '75498389-2882-45ab-8c07-bce3931e9cf4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3416a8c10>]}
[0m07:51:50.081361 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m07:51:50.529881 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m07:51:53.407347 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:51:53.410465 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:51:53.568824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '75498389-2882-45ab-8c07-bce3931e9cf4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc33c9dbe20>]}
[0m07:51:54.604186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '75498389-2882-45ab-8c07-bce3931e9cf4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc33c9db6d0>]}
[0m07:51:54.607416 [info ] [MainThread]: Found 7 models, 34 data tests, 2 sources, 600 macros
[0m07:51:54.610420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '75498389-2882-45ab-8c07-bce3931e9cf4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc30a26edf0>]}
[0m07:51:54.621975 [info ] [MainThread]: 
[0m07:51:54.625788 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m07:51:54.643772 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_northern-shield-437204-m0_nyc_taxi'
[0m07:51:54.647126 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:51:55.327879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '75498389-2882-45ab-8c07-bce3931e9cf4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc342eed8b0>]}
[0m07:51:55.332961 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:51:55.336714 [info ] [MainThread]: 
[0m07:51:55.359145 [debug] [Thread-1  ]: Began running node test.nyc_taxi.accepted_values_dim_payment_payment_name__Credit_card__Cash__No_charge__Dispute__Unknown__Voided_trip.58d00ef9f4
[0m07:51:55.363704 [info ] [Thread-1  ]: 1 of 34 START test accepted_values_dim_payment_payment_name__Credit_card__Cash__No_charge__Dispute__Unknown__Voided_trip  [RUN]
[0m07:51:55.367426 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_northern-shield-437204-m0_nyc_taxi, now test.nyc_taxi.accepted_values_dim_payment_payment_name__Credit_card__Cash__No_charge__Dispute__Unknown__Voided_trip.58d00ef9f4)
[0m07:51:55.371415 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.accepted_values_dim_payment_payment_name__Credit_card__Cash__No_charge__Dispute__Unknown__Voided_trip.58d00ef9f4
[0m07:51:55.450849 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.accepted_values_dim_payment_payment_name__Credit_card__Cash__No_charge__Dispute__Unknown__Voided_trip.58d00ef9f4"
[0m07:51:55.468618 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.accepted_values_dim_payment_payment_name__Credit_card__Cash__No_charge__Dispute__Unknown__Voided_trip.58d00ef9f4
[0m07:51:55.533174 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.accepted_values_dim_payment_payment_name__Credit_card__Cash__No_charge__Dispute__Unknown__Voided_trip.58d00ef9f4"
[0m07:51:55.551556 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:51:55.559466 [debug] [Thread-1  ]: On test.nyc_taxi.accepted_values_dim_payment_payment_name__Credit_card__Cash__No_charge__Dispute__Unknown__Voided_trip.58d00ef9f4: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.accepted_values_dim_payment_payment_name__Credit_card__Cash__No_charge__Dispute__Unknown__Voided_trip.58d00ef9f4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        payment_name as value_field,
        count(*) as n_records

    from `northern-shield-437204-m0`.`nyc_taxi`.`dim_payment`
    group by payment_name

)

select *
from all_values
where value_field not in (
    'Credit card','Cash','No charge','Dispute','Unknown','Voided trip'
)



      
    ) dbt_internal_test
[0m07:51:56.576113 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:ced1de4f-543f-4be6-b523-ee6ea8c80780&page=queryresults
[0m07:51:57.770323 [info ] [Thread-1  ]: 1 of 34 PASS accepted_values_dim_payment_payment_name__Credit_card__Cash__No_charge__Dispute__Unknown__Voided_trip  [[32mPASS[0m in 2.40s]
[0m07:51:57.775105 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.accepted_values_dim_payment_payment_name__Credit_card__Cash__No_charge__Dispute__Unknown__Voided_trip.58d00ef9f4
[0m07:51:57.778785 [debug] [Thread-1  ]: Began running node test.nyc_taxi.accepted_values_dim_ratecode_rate_code_name__Standard_rate__JFK__Newark__Nassau_or_Westchester__Negotiated_fare__Group_ride__Unknown.57ee02019f
[0m07:51:57.782043 [info ] [Thread-1  ]: 2 of 34 START test accepted_values_dim_ratecode_rate_code_name__Standard_rate__JFK__Newark__Nassau_or_Westchester__Negotiated_fare__Group_ride__Unknown  [RUN]
[0m07:51:57.785133 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.accepted_values_dim_payment_payment_name__Credit_card__Cash__No_charge__Dispute__Unknown__Voided_trip.58d00ef9f4, now test.nyc_taxi.accepted_values_dim_ratecode_rate_code_name__Standard_rate__JFK__Newark__Nassau_or_Westchester__Negotiated_fare__Group_ride__Unknown.57ee02019f)
[0m07:51:57.788340 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.accepted_values_dim_ratecode_rate_code_name__Standard_rate__JFK__Newark__Nassau_or_Westchester__Negotiated_fare__Group_ride__Unknown.57ee02019f
[0m07:51:57.813358 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.accepted_values_dim_ratecode_rate_code_name__Standard_rate__JFK__Newark__Nassau_or_Westchester__Negotiated_fare__Group_ride__Unknown.57ee02019f"
[0m07:51:57.830962 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.accepted_values_dim_ratecode_rate_code_name__Standard_rate__JFK__Newark__Nassau_or_Westchester__Negotiated_fare__Group_ride__Unknown.57ee02019f
[0m07:51:57.841559 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.accepted_values_dim_ratecode_rate_code_name__Standard_rate__JFK__Newark__Nassau_or_Westchester__Negotiated_fare__Group_ride__Unknown.57ee02019f"
[0m07:51:57.862777 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:51:57.873043 [debug] [Thread-1  ]: On test.nyc_taxi.accepted_values_dim_ratecode_rate_code_name__Standard_rate__JFK__Newark__Nassau_or_Westchester__Negotiated_fare__Group_ride__Unknown.57ee02019f: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.accepted_values_dim_ratecode_rate_code_name__Standard_rate__JFK__Newark__Nassau_or_Westchester__Negotiated_fare__Group_ride__Unknown.57ee02019f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        rate_code_name as value_field,
        count(*) as n_records

    from `northern-shield-437204-m0`.`nyc_taxi`.`dim_ratecode`
    group by rate_code_name

)

select *
from all_values
where value_field not in (
    'Standard rate','JFK','Newark','Nassau or Westchester','Negotiated fare','Group ride','Unknown'
)



      
    ) dbt_internal_test
[0m07:51:58.921062 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:c710f085-f851-45ed-b298-a74e01476bff&page=queryresults
[0m07:52:00.043172 [info ] [Thread-1  ]: 2 of 34 PASS accepted_values_dim_ratecode_rate_code_name__Standard_rate__JFK__Newark__Nassau_or_Westchester__Negotiated_fare__Group_ride__Unknown  [[32mPASS[0m in 2.26s]
[0m07:52:00.047685 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.accepted_values_dim_ratecode_rate_code_name__Standard_rate__JFK__Newark__Nassau_or_Westchester__Negotiated_fare__Group_ride__Unknown.57ee02019f
[0m07:52:00.051131 [debug] [Thread-1  ]: Began running node test.nyc_taxi.accepted_values_dim_time_weekday__Sunday__Monday__Tuesday__Wednesday__Thursday__Friday__Saturday.87b4c2a366
[0m07:52:00.054669 [info ] [Thread-1  ]: 3 of 34 START test accepted_values_dim_time_weekday__Sunday__Monday__Tuesday__Wednesday__Thursday__Friday__Saturday  [RUN]
[0m07:52:00.057981 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.accepted_values_dim_ratecode_rate_code_name__Standard_rate__JFK__Newark__Nassau_or_Westchester__Negotiated_fare__Group_ride__Unknown.57ee02019f, now test.nyc_taxi.accepted_values_dim_time_weekday__Sunday__Monday__Tuesday__Wednesday__Thursday__Friday__Saturday.87b4c2a366)
[0m07:52:00.061363 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.accepted_values_dim_time_weekday__Sunday__Monday__Tuesday__Wednesday__Thursday__Friday__Saturday.87b4c2a366
[0m07:52:00.099322 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.accepted_values_dim_time_weekday__Sunday__Monday__Tuesday__Wednesday__Thursday__Friday__Saturday.87b4c2a366"
[0m07:52:00.117033 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.accepted_values_dim_time_weekday__Sunday__Monday__Tuesday__Wednesday__Thursday__Friday__Saturday.87b4c2a366
[0m07:52:00.130478 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.accepted_values_dim_time_weekday__Sunday__Monday__Tuesday__Wednesday__Thursday__Friday__Saturday.87b4c2a366"
[0m07:52:00.147803 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:52:00.155745 [debug] [Thread-1  ]: On test.nyc_taxi.accepted_values_dim_time_weekday__Sunday__Monday__Tuesday__Wednesday__Thursday__Friday__Saturday.87b4c2a366: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.accepted_values_dim_time_weekday__Sunday__Monday__Tuesday__Wednesday__Thursday__Friday__Saturday.87b4c2a366"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        weekday as value_field,
        count(*) as n_records

    from `northern-shield-437204-m0`.`nyc_taxi`.`dim_time`
    group by weekday

)

select *
from all_values
where value_field not in (
    'Sunday','Monday','Tuesday','Wednesday','Thursday','Friday','Saturday'
)



      
    ) dbt_internal_test
[0m07:52:01.367007 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:ae278736-6d97-49c3-a6c0-a7b4dc63c88a&page=queryresults
[0m07:52:02.492354 [info ] [Thread-1  ]: 3 of 34 PASS accepted_values_dim_time_weekday__Sunday__Monday__Tuesday__Wednesday__Thursday__Friday__Saturday  [[32mPASS[0m in 2.43s]
[0m07:52:02.497175 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.accepted_values_dim_time_weekday__Sunday__Monday__Tuesday__Wednesday__Thursday__Friday__Saturday.87b4c2a366
[0m07:52:02.500926 [debug] [Thread-1  ]: Began running node test.nyc_taxi.accepted_values_dim_triptype_trip_name__Street_hail__Dispatch__Unknown.f5add8f4c9
[0m07:52:02.503980 [info ] [Thread-1  ]: 4 of 34 START test accepted_values_dim_triptype_trip_name__Street_hail__Dispatch__Unknown  [RUN]
[0m07:52:02.507524 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.accepted_values_dim_time_weekday__Sunday__Monday__Tuesday__Wednesday__Thursday__Friday__Saturday.87b4c2a366, now test.nyc_taxi.accepted_values_dim_triptype_trip_name__Street_hail__Dispatch__Unknown.f5add8f4c9)
[0m07:52:02.510970 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.accepted_values_dim_triptype_trip_name__Street_hail__Dispatch__Unknown.f5add8f4c9
[0m07:52:02.537204 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.accepted_values_dim_triptype_trip_name__Street_hail__Dispatch__Unknown.f5add8f4c9"
[0m07:52:02.562574 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.accepted_values_dim_triptype_trip_name__Street_hail__Dispatch__Unknown.f5add8f4c9
[0m07:52:02.575623 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.accepted_values_dim_triptype_trip_name__Street_hail__Dispatch__Unknown.f5add8f4c9"
[0m07:52:02.594702 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:52:02.605163 [debug] [Thread-1  ]: On test.nyc_taxi.accepted_values_dim_triptype_trip_name__Street_hail__Dispatch__Unknown.f5add8f4c9: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.accepted_values_dim_triptype_trip_name__Street_hail__Dispatch__Unknown.f5add8f4c9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        trip_name as value_field,
        count(*) as n_records

    from `northern-shield-437204-m0`.`nyc_taxi`.`dim_triptype`
    group by trip_name

)

select *
from all_values
where value_field not in (
    'Street-hail','Dispatch','Unknown'
)



      
    ) dbt_internal_test
[0m07:52:03.619262 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:bd8160e9-65af-45bd-8326-e63b399a69ac&page=queryresults
[0m07:52:04.646290 [info ] [Thread-1  ]: 4 of 34 PASS accepted_values_dim_triptype_trip_name__Street_hail__Dispatch__Unknown  [[32mPASS[0m in 2.14s]
[0m07:52:04.649119 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.accepted_values_dim_triptype_trip_name__Street_hail__Dispatch__Unknown.f5add8f4c9
[0m07:52:04.651143 [debug] [Thread-1  ]: Began running node test.nyc_taxi.accepted_values_dim_vendor_vendor_name__Creative_Mobile_Technologies__VeriFone_Inc_.7481cecf07
[0m07:52:04.652829 [info ] [Thread-1  ]: 5 of 34 START test accepted_values_dim_vendor_vendor_name__Creative_Mobile_Technologies__VeriFone_Inc_  [RUN]
[0m07:52:04.654883 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.accepted_values_dim_triptype_trip_name__Street_hail__Dispatch__Unknown.f5add8f4c9, now test.nyc_taxi.accepted_values_dim_vendor_vendor_name__Creative_Mobile_Technologies__VeriFone_Inc_.7481cecf07)
[0m07:52:04.656774 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.accepted_values_dim_vendor_vendor_name__Creative_Mobile_Technologies__VeriFone_Inc_.7481cecf07
[0m07:52:04.670236 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.accepted_values_dim_vendor_vendor_name__Creative_Mobile_Technologies__VeriFone_Inc_.7481cecf07"
[0m07:52:04.680039 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.accepted_values_dim_vendor_vendor_name__Creative_Mobile_Technologies__VeriFone_Inc_.7481cecf07
[0m07:52:04.688234 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.accepted_values_dim_vendor_vendor_name__Creative_Mobile_Technologies__VeriFone_Inc_.7481cecf07"
[0m07:52:04.696769 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:52:04.702225 [debug] [Thread-1  ]: On test.nyc_taxi.accepted_values_dim_vendor_vendor_name__Creative_Mobile_Technologies__VeriFone_Inc_.7481cecf07: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.accepted_values_dim_vendor_vendor_name__Creative_Mobile_Technologies__VeriFone_Inc_.7481cecf07"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        vendor_name as value_field,
        count(*) as n_records

    from `northern-shield-437204-m0`.`nyc_taxi`.`dim_vendor`
    group by vendor_name

)

select *
from all_values
where value_field not in (
    'Creative Mobile Technologies','VeriFone Inc.'
)



      
    ) dbt_internal_test
[0m07:52:05.771761 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:d1839229-e28f-4626-9a91-d2f222f77a44&page=queryresults
[0m07:52:06.816723 [info ] [Thread-1  ]: 5 of 34 PASS accepted_values_dim_vendor_vendor_name__Creative_Mobile_Technologies__VeriFone_Inc_  [[32mPASS[0m in 2.16s]
[0m07:52:06.821861 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.accepted_values_dim_vendor_vendor_name__Creative_Mobile_Technologies__VeriFone_Inc_.7481cecf07
[0m07:52:06.830847 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_dim_payment_type_id.96dfa722aa
[0m07:52:06.834376 [info ] [Thread-1  ]: 6 of 34 START test not_null_dim_payment_type_id ................................ [RUN]
[0m07:52:06.838189 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.accepted_values_dim_vendor_vendor_name__Creative_Mobile_Technologies__VeriFone_Inc_.7481cecf07, now test.nyc_taxi.not_null_dim_payment_type_id.96dfa722aa)
[0m07:52:06.841662 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_dim_payment_type_id.96dfa722aa
[0m07:52:06.871829 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_dim_payment_type_id.96dfa722aa"
[0m07:52:06.892909 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_dim_payment_type_id.96dfa722aa
[0m07:52:06.903465 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_dim_payment_type_id.96dfa722aa"
[0m07:52:06.927202 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:52:06.936859 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_dim_payment_type_id.96dfa722aa: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_dim_payment_type_id.96dfa722aa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select type_id
from `northern-shield-437204-m0`.`nyc_taxi`.`dim_payment`
where type_id is null



      
    ) dbt_internal_test
[0m07:52:07.758727 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:5991c7a6-c77c-4354-bea7-0b5583d06f5b&page=queryresults
[0m07:52:08.819138 [info ] [Thread-1  ]: 6 of 34 PASS not_null_dim_payment_type_id ...................................... [[32mPASS[0m in 1.98s]
[0m07:52:08.825657 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_dim_payment_type_id.96dfa722aa
[0m07:52:08.830604 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_dim_time_date.2080f42875
[0m07:52:08.833883 [info ] [Thread-1  ]: 7 of 34 START test not_null_dim_time_date ...................................... [RUN]
[0m07:52:08.837468 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_dim_payment_type_id.96dfa722aa, now test.nyc_taxi.not_null_dim_time_date.2080f42875)
[0m07:52:08.840282 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_dim_time_date.2080f42875
[0m07:52:08.866089 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_dim_time_date.2080f42875"
[0m07:52:08.891125 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_dim_time_date.2080f42875
[0m07:52:08.908719 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_dim_time_date.2080f42875"
[0m07:52:08.930094 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:52:08.941871 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_dim_time_date.2080f42875: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_dim_time_date.2080f42875"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from `northern-shield-437204-m0`.`nyc_taxi`.`dim_time`
where date is null



      
    ) dbt_internal_test
[0m07:52:09.747159 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:31b06b4b-1e63-4f64-9dea-44b6239d1bb3&page=queryresults
[0m07:52:11.303050 [info ] [Thread-1  ]: 7 of 34 PASS not_null_dim_time_date ............................................ [[32mPASS[0m in 2.47s]
[0m07:52:11.310597 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_dim_time_date.2080f42875
[0m07:52:11.315339 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_dim_time_date_part.59e6206332
[0m07:52:11.319464 [info ] [Thread-1  ]: 8 of 34 START test not_null_dim_time_date_part ................................. [RUN]
[0m07:52:11.325619 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_dim_time_date.2080f42875, now test.nyc_taxi.not_null_dim_time_date_part.59e6206332)
[0m07:52:11.333947 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_dim_time_date_part.59e6206332
[0m07:52:11.362031 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_dim_time_date_part.59e6206332"
[0m07:52:11.382494 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_dim_time_date_part.59e6206332
[0m07:52:11.397592 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_dim_time_date_part.59e6206332"
[0m07:52:11.419100 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:52:11.429057 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_dim_time_date_part.59e6206332: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_dim_time_date_part.59e6206332"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date_part
from `northern-shield-437204-m0`.`nyc_taxi`.`dim_time`
where date_part is null



      
    ) dbt_internal_test
[0m07:52:13.147302 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:2db09499-02ac-4267-b572-628922017dd8&page=queryresults
[0m07:52:14.238801 [info ] [Thread-1  ]: 8 of 34 PASS not_null_dim_time_date_part ....................................... [[32mPASS[0m in 2.91s]
[0m07:52:14.244045 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_dim_time_date_part.59e6206332
[0m07:52:14.247851 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_dim_time_day.dc0e917166
[0m07:52:14.250647 [info ] [Thread-1  ]: 9 of 34 START test not_null_dim_time_day ....................................... [RUN]
[0m07:52:14.254861 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_dim_time_date_part.59e6206332, now test.nyc_taxi.not_null_dim_time_day.dc0e917166)
[0m07:52:14.257799 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_dim_time_day.dc0e917166
[0m07:52:14.276252 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_dim_time_day.dc0e917166"
[0m07:52:14.298000 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_dim_time_day.dc0e917166
[0m07:52:14.309348 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_dim_time_day.dc0e917166"
[0m07:52:14.334692 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:52:14.344259 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_dim_time_day.dc0e917166: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_dim_time_day.dc0e917166"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select day
from `northern-shield-437204-m0`.`nyc_taxi`.`dim_time`
where day is null



      
    ) dbt_internal_test
[0m07:52:15.205814 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:32376257-48b6-45d7-bd48-874d2be59937&page=queryresults
[0m07:52:16.200969 [info ] [Thread-1  ]: 9 of 34 PASS not_null_dim_time_day ............................................. [[32mPASS[0m in 1.95s]
[0m07:52:16.205395 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_dim_time_day.dc0e917166
[0m07:52:16.208888 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_dim_time_hour.5b8ccd8f25
[0m07:52:16.212137 [info ] [Thread-1  ]: 10 of 34 START test not_null_dim_time_hour ..................................... [RUN]
[0m07:52:16.216420 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_dim_time_day.dc0e917166, now test.nyc_taxi.not_null_dim_time_hour.5b8ccd8f25)
[0m07:52:16.219394 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_dim_time_hour.5b8ccd8f25
[0m07:52:16.236903 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_dim_time_hour.5b8ccd8f25"
[0m07:52:16.258089 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_dim_time_hour.5b8ccd8f25
[0m07:52:16.268821 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_dim_time_hour.5b8ccd8f25"
[0m07:52:16.290219 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:52:16.299515 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_dim_time_hour.5b8ccd8f25: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_dim_time_hour.5b8ccd8f25"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select hour
from `northern-shield-437204-m0`.`nyc_taxi`.`dim_time`
where hour is null



      
    ) dbt_internal_test
[0m07:52:17.198413 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:fa124b6a-5d9e-4187-9107-e736595540c3&page=queryresults
[0m07:52:18.257776 [info ] [Thread-1  ]: 10 of 34 PASS not_null_dim_time_hour ........................................... [[32mPASS[0m in 2.04s]
[0m07:52:18.269882 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_dim_time_hour.5b8ccd8f25
[0m07:52:18.281181 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_dim_time_minute.23e906ca61
[0m07:52:18.285756 [info ] [Thread-1  ]: 11 of 34 START test not_null_dim_time_minute ................................... [RUN]
[0m07:52:18.291766 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_dim_time_hour.5b8ccd8f25, now test.nyc_taxi.not_null_dim_time_minute.23e906ca61)
[0m07:52:18.296028 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_dim_time_minute.23e906ca61
[0m07:52:18.319253 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_dim_time_minute.23e906ca61"
[0m07:52:18.336483 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_dim_time_minute.23e906ca61
[0m07:52:18.347397 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_dim_time_minute.23e906ca61"
[0m07:52:18.366433 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:52:18.375014 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_dim_time_minute.23e906ca61: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_dim_time_minute.23e906ca61"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select minute
from `northern-shield-437204-m0`.`nyc_taxi`.`dim_time`
where minute is null



      
    ) dbt_internal_test
[0m07:52:19.260081 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:decc1871-7420-40ae-b4ee-b6317bb362fd&page=queryresults
[0m07:52:20.341978 [info ] [Thread-1  ]: 11 of 34 PASS not_null_dim_time_minute ......................................... [[32mPASS[0m in 2.05s]
[0m07:52:20.347603 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_dim_time_minute.23e906ca61
[0m07:52:20.351146 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_dim_time_month.9f6ecf2eb5
[0m07:52:20.354166 [info ] [Thread-1  ]: 12 of 34 START test not_null_dim_time_month .................................... [RUN]
[0m07:52:20.357217 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_dim_time_minute.23e906ca61, now test.nyc_taxi.not_null_dim_time_month.9f6ecf2eb5)
[0m07:52:20.360128 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_dim_time_month.9f6ecf2eb5
[0m07:52:20.375299 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_dim_time_month.9f6ecf2eb5"
[0m07:52:20.394177 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_dim_time_month.9f6ecf2eb5
[0m07:52:20.405943 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_dim_time_month.9f6ecf2eb5"
[0m07:52:20.426116 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:52:20.434863 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_dim_time_month.9f6ecf2eb5: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_dim_time_month.9f6ecf2eb5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select month
from `northern-shield-437204-m0`.`nyc_taxi`.`dim_time`
where month is null



      
    ) dbt_internal_test
[0m07:52:21.323302 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:bbf0d2e4-5600-4e1f-8295-939aaf149ecf&page=queryresults
[0m07:52:22.308162 [info ] [Thread-1  ]: 12 of 34 PASS not_null_dim_time_month .......................................... [[32mPASS[0m in 1.95s]
[0m07:52:22.312703 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_dim_time_month.9f6ecf2eb5
[0m07:52:22.316306 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_dim_time_year.6fb9595d53
[0m07:52:22.319287 [info ] [Thread-1  ]: 13 of 34 START test not_null_dim_time_year ..................................... [RUN]
[0m07:52:22.323296 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_dim_time_month.9f6ecf2eb5, now test.nyc_taxi.not_null_dim_time_year.6fb9595d53)
[0m07:52:22.326589 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_dim_time_year.6fb9595d53
[0m07:52:22.350048 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_dim_time_year.6fb9595d53"
[0m07:52:22.368987 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_dim_time_year.6fb9595d53
[0m07:52:22.380626 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_dim_time_year.6fb9595d53"
[0m07:52:22.400343 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:52:22.410140 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_dim_time_year.6fb9595d53: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_dim_time_year.6fb9595d53"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select year
from `northern-shield-437204-m0`.`nyc_taxi`.`dim_time`
where year is null



      
    ) dbt_internal_test
[0m07:52:23.290638 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:06159f23-d326-4862-adc6-d74066d7be0f&page=queryresults
[0m07:52:24.228617 [info ] [Thread-1  ]: 13 of 34 PASS not_null_dim_time_year ........................................... [[32mPASS[0m in 1.91s]
[0m07:52:24.233197 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_dim_time_year.6fb9595d53
[0m07:52:24.236884 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_dim_zone_borough.1ed2272c52
[0m07:52:24.239984 [info ] [Thread-1  ]: 14 of 34 START test not_null_dim_zone_borough .................................. [RUN]
[0m07:52:24.244209 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_dim_time_year.6fb9595d53, now test.nyc_taxi.not_null_dim_zone_borough.1ed2272c52)
[0m07:52:24.246724 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_dim_zone_borough.1ed2272c52
[0m07:52:24.264512 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_dim_zone_borough.1ed2272c52"
[0m07:52:24.283637 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_dim_zone_borough.1ed2272c52
[0m07:52:24.294347 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_dim_zone_borough.1ed2272c52"
[0m07:52:24.310452 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:52:24.319194 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_dim_zone_borough.1ed2272c52: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_dim_zone_borough.1ed2272c52"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select borough
from `northern-shield-437204-m0`.`nyc_taxi`.`dim_zone`
where borough is null



      
    ) dbt_internal_test
[0m07:52:25.333400 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:37eb5504-e533-427a-a77a-7eeef62914c3&page=queryresults
[0m07:52:26.390525 [info ] [Thread-1  ]: 14 of 34 PASS not_null_dim_zone_borough ........................................ [[32mPASS[0m in 2.15s]
[0m07:52:26.394826 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_dim_zone_borough.1ed2272c52
[0m07:52:26.398245 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_dim_zone_service_zone.2007f611c5
[0m07:52:26.401339 [info ] [Thread-1  ]: 15 of 34 START test not_null_dim_zone_service_zone ............................. [RUN]
[0m07:52:26.404700 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_dim_zone_borough.1ed2272c52, now test.nyc_taxi.not_null_dim_zone_service_zone.2007f611c5)
[0m07:52:26.407672 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_dim_zone_service_zone.2007f611c5
[0m07:52:26.423774 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_dim_zone_service_zone.2007f611c5"
[0m07:52:26.446748 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_dim_zone_service_zone.2007f611c5
[0m07:52:26.456674 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_dim_zone_service_zone.2007f611c5"
[0m07:52:26.480805 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:52:26.490095 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_dim_zone_service_zone.2007f611c5: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_dim_zone_service_zone.2007f611c5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select service_zone
from `northern-shield-437204-m0`.`nyc_taxi`.`dim_zone`
where service_zone is null



      
    ) dbt_internal_test
[0m07:52:27.337037 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:9005d3ab-6b6f-4253-b9fc-e20fa1bfb85b&page=queryresults
[0m07:52:28.343801 [info ] [Thread-1  ]: 15 of 34 PASS not_null_dim_zone_service_zone ................................... [[32mPASS[0m in 1.94s]
[0m07:52:28.348205 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_dim_zone_service_zone.2007f611c5
[0m07:52:28.358132 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_dim_zone_zone.a1c4a4c37a
[0m07:52:28.361181 [info ] [Thread-1  ]: 16 of 34 START test not_null_dim_zone_zone ..................................... [RUN]
[0m07:52:28.364603 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_dim_zone_service_zone.2007f611c5, now test.nyc_taxi.not_null_dim_zone_zone.a1c4a4c37a)
[0m07:52:28.367403 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_dim_zone_zone.a1c4a4c37a
[0m07:52:28.392132 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_dim_zone_zone.a1c4a4c37a"
[0m07:52:28.409309 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_dim_zone_zone.a1c4a4c37a
[0m07:52:28.421565 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_dim_zone_zone.a1c4a4c37a"
[0m07:52:28.439028 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:52:28.449966 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_dim_zone_zone.a1c4a4c37a: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_dim_zone_zone.a1c4a4c37a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select zone
from `northern-shield-437204-m0`.`nyc_taxi`.`dim_zone`
where zone is null



      
    ) dbt_internal_test
[0m07:52:29.257626 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:e409d3d3-08e9-450e-820e-fce41d6710c9&page=queryresults
[0m07:52:30.194893 [info ] [Thread-1  ]: 16 of 34 PASS not_null_dim_zone_zone ........................................... [[32mPASS[0m in 1.83s]
[0m07:52:30.199390 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_dim_zone_zone.a1c4a4c37a
[0m07:52:30.203746 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_do_location_id.6acdd302a6
[0m07:52:30.206906 [info ] [Thread-1  ]: 17 of 34 START test not_null_fct_trips_do_location_id .......................... [RUN]
[0m07:52:30.210355 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_dim_zone_zone.a1c4a4c37a, now test.nyc_taxi.not_null_fct_trips_do_location_id.6acdd302a6)
[0m07:52:30.213328 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_do_location_id.6acdd302a6
[0m07:52:30.234238 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_do_location_id.6acdd302a6"
[0m07:52:30.254882 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_do_location_id.6acdd302a6
[0m07:52:30.267927 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_fct_trips_do_location_id.6acdd302a6"
[0m07:52:30.283813 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:52:30.292453 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_fct_trips_do_location_id.6acdd302a6: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_fct_trips_do_location_id.6acdd302a6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select do_location_id
from `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips`
where do_location_id is null



      
    ) dbt_internal_test
[0m07:52:31.274150 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:831c7610-aa28-4476-8c96-6398e9149776&page=queryresults
[0m07:52:32.292342 [info ] [Thread-1  ]: 17 of 34 PASS not_null_fct_trips_do_location_id ................................ [[32mPASS[0m in 2.08s]
[0m07:52:32.297796 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_do_location_id.6acdd302a6
[0m07:52:32.303692 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_dropoff_time_id.781496e98f
[0m07:52:32.308730 [info ] [Thread-1  ]: 18 of 34 START test not_null_fct_trips_dropoff_time_id ......................... [RUN]
[0m07:52:32.313193 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_do_location_id.6acdd302a6, now test.nyc_taxi.not_null_fct_trips_dropoff_time_id.781496e98f)
[0m07:52:32.320591 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_dropoff_time_id.781496e98f
[0m07:52:32.354976 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_dropoff_time_id.781496e98f"
[0m07:52:32.385676 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_dropoff_time_id.781496e98f
[0m07:52:32.403930 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_fct_trips_dropoff_time_id.781496e98f"
[0m07:52:32.424381 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:52:32.434464 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_fct_trips_dropoff_time_id.781496e98f: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_fct_trips_dropoff_time_id.781496e98f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select dropoff_time_id
from `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips`
where dropoff_time_id is null



      
    ) dbt_internal_test
[0m07:52:33.323359 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:5b8b1220-6ac9-4500-8e2c-b46e8d0f2ca4&page=queryresults
[0m07:52:34.329105 [info ] [Thread-1  ]: 18 of 34 PASS not_null_fct_trips_dropoff_time_id ............................... [[32mPASS[0m in 2.02s]
[0m07:52:34.334474 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_dropoff_time_id.781496e98f
[0m07:52:34.338238 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_extra.1801055bb3
[0m07:52:34.342283 [info ] [Thread-1  ]: 19 of 34 START test not_null_fct_trips_extra ................................... [RUN]
[0m07:52:34.347590 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_dropoff_time_id.781496e98f, now test.nyc_taxi.not_null_fct_trips_extra.1801055bb3)
[0m07:52:34.350979 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_extra.1801055bb3
[0m07:52:34.371725 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_extra.1801055bb3"
[0m07:52:34.383196 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_extra.1801055bb3
[0m07:52:34.396586 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_fct_trips_extra.1801055bb3"
[0m07:52:34.415949 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:52:34.425581 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_fct_trips_extra.1801055bb3: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_fct_trips_extra.1801055bb3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select extra
from `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips`
where extra is null



      
    ) dbt_internal_test
[0m07:52:35.287259 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:38cf8515-d661-465d-b6d9-3fc33ff38e6e&page=queryresults
[0m07:52:36.335015 [info ] [Thread-1  ]: 19 of 34 PASS not_null_fct_trips_extra ......................................... [[32mPASS[0m in 1.99s]
[0m07:52:36.340276 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_extra.1801055bb3
[0m07:52:36.344614 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_improvement_surcharge.4cf28d1443
[0m07:52:36.348266 [info ] [Thread-1  ]: 20 of 34 START test not_null_fct_trips_improvement_surcharge ................... [RUN]
[0m07:52:36.351544 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_extra.1801055bb3, now test.nyc_taxi.not_null_fct_trips_improvement_surcharge.4cf28d1443)
[0m07:52:36.354789 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_improvement_surcharge.4cf28d1443
[0m07:52:36.372707 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_improvement_surcharge.4cf28d1443"
[0m07:52:36.393737 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_improvement_surcharge.4cf28d1443
[0m07:52:36.406629 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_fct_trips_improvement_surcharge.4cf28d1443"
[0m07:52:36.429270 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:52:36.439288 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_fct_trips_improvement_surcharge.4cf28d1443: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_fct_trips_improvement_surcharge.4cf28d1443"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select improvement_surcharge
from `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips`
where improvement_surcharge is null



      
    ) dbt_internal_test
[0m07:52:37.349272 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:e632cf6f-576c-4e4c-962b-f072a593df1a&page=queryresults
[0m07:52:38.528434 [info ] [Thread-1  ]: 20 of 34 PASS not_null_fct_trips_improvement_surcharge ......................... [[32mPASS[0m in 2.18s]
[0m07:52:38.533589 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_improvement_surcharge.4cf28d1443
[0m07:52:38.543304 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_passenger_count.b1370cab1c
[0m07:52:38.546495 [info ] [Thread-1  ]: 21 of 34 START test not_null_fct_trips_passenger_count ......................... [RUN]
[0m07:52:38.549859 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_improvement_surcharge.4cf28d1443, now test.nyc_taxi.not_null_fct_trips_passenger_count.b1370cab1c)
[0m07:52:38.553348 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_passenger_count.b1370cab1c
[0m07:52:38.572242 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_passenger_count.b1370cab1c"
[0m07:52:38.590655 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_passenger_count.b1370cab1c
[0m07:52:38.605138 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_fct_trips_passenger_count.b1370cab1c"
[0m07:52:38.625273 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:52:38.634257 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_fct_trips_passenger_count.b1370cab1c: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_fct_trips_passenger_count.b1370cab1c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select passenger_count
from `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips`
where passenger_count is null



      
    ) dbt_internal_test
[0m07:52:39.410795 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:188f3cd0-7a81-4fd2-a1c5-f6cd9d802b86&page=queryresults
[0m07:52:40.472732 [info ] [Thread-1  ]: 21 of 34 PASS not_null_fct_trips_passenger_count ............................... [[32mPASS[0m in 1.92s]
[0m07:52:40.478401 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_passenger_count.b1370cab1c
[0m07:52:40.482733 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_payment_type.93889b679a
[0m07:52:40.486256 [info ] [Thread-1  ]: 22 of 34 START test not_null_fct_trips_payment_type ............................ [RUN]
[0m07:52:40.490499 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_passenger_count.b1370cab1c, now test.nyc_taxi.not_null_fct_trips_payment_type.93889b679a)
[0m07:52:40.494562 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_payment_type.93889b679a
[0m07:52:40.516527 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_payment_type.93889b679a"
[0m07:52:40.539936 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_payment_type.93889b679a
[0m07:52:40.553772 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_fct_trips_payment_type.93889b679a"
[0m07:52:40.572686 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:52:40.583139 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_fct_trips_payment_type.93889b679a: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_fct_trips_payment_type.93889b679a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select payment_type
from `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips`
where payment_type is null



      
    ) dbt_internal_test
[0m07:52:41.460937 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:54482485-5924-494e-8451-36e5fac67f78&page=queryresults
[0m07:52:43.827153 [info ] [Thread-1  ]: 22 of 34 PASS not_null_fct_trips_payment_type .................................. [[32mPASS[0m in 3.34s]
[0m07:52:43.833457 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_payment_type.93889b679a
[0m07:52:43.838100 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_pickup_time_id.f31fbe0eeb
[0m07:52:43.841701 [info ] [Thread-1  ]: 23 of 34 START test not_null_fct_trips_pickup_time_id .......................... [RUN]
[0m07:52:43.845304 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_payment_type.93889b679a, now test.nyc_taxi.not_null_fct_trips_pickup_time_id.f31fbe0eeb)
[0m07:52:43.848542 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_pickup_time_id.f31fbe0eeb
[0m07:52:43.875849 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_pickup_time_id.f31fbe0eeb"
[0m07:52:43.894807 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_pickup_time_id.f31fbe0eeb
[0m07:52:43.909830 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_fct_trips_pickup_time_id.f31fbe0eeb"
[0m07:52:43.929144 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:52:43.938485 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_fct_trips_pickup_time_id.f31fbe0eeb: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_fct_trips_pickup_time_id.f31fbe0eeb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select pickup_time_id
from `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips`
where pickup_time_id is null



      
    ) dbt_internal_test
[0m07:52:44.904690 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:ba48009d-5b40-4200-ae23-4e2c2ca6384b&page=queryresults
[0m07:52:46.137150 [info ] [Thread-1  ]: 23 of 34 PASS not_null_fct_trips_pickup_time_id ................................ [[32mPASS[0m in 2.29s]
[0m07:52:46.141740 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_pickup_time_id.f31fbe0eeb
[0m07:52:46.145540 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_pu_location_id.b0dc8dd185
[0m07:52:46.148466 [info ] [Thread-1  ]: 24 of 34 START test not_null_fct_trips_pu_location_id .......................... [RUN]
[0m07:52:46.151639 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_pickup_time_id.f31fbe0eeb, now test.nyc_taxi.not_null_fct_trips_pu_location_id.b0dc8dd185)
[0m07:52:46.154670 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_pu_location_id.b0dc8dd185
[0m07:52:46.173858 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_pu_location_id.b0dc8dd185"
[0m07:52:46.194662 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_pu_location_id.b0dc8dd185
[0m07:52:46.209142 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_fct_trips_pu_location_id.b0dc8dd185"
[0m07:52:46.225364 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:52:46.236361 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_fct_trips_pu_location_id.b0dc8dd185: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_fct_trips_pu_location_id.b0dc8dd185"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select pu_location_id
from `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips`
where pu_location_id is null



      
    ) dbt_internal_test
[0m07:52:47.157655 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:e88516f6-ac80-44a3-a5bb-f4a0b5f5cf34&page=queryresults
[0m07:52:48.277857 [info ] [Thread-1  ]: 24 of 34 PASS not_null_fct_trips_pu_location_id ................................ [[32mPASS[0m in 2.13s]
[0m07:52:48.282656 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_pu_location_id.b0dc8dd185
[0m07:52:48.286674 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_rate_code_id.ba0047eaae
[0m07:52:48.289454 [info ] [Thread-1  ]: 25 of 34 START test not_null_fct_trips_rate_code_id ............................ [RUN]
[0m07:52:48.293203 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_pu_location_id.b0dc8dd185, now test.nyc_taxi.not_null_fct_trips_rate_code_id.ba0047eaae)
[0m07:52:48.296866 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_rate_code_id.ba0047eaae
[0m07:52:48.319678 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_rate_code_id.ba0047eaae"
[0m07:52:48.343781 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_rate_code_id.ba0047eaae
[0m07:52:48.354974 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_fct_trips_rate_code_id.ba0047eaae"
[0m07:52:48.379354 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:52:48.389320 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_fct_trips_rate_code_id.ba0047eaae: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_fct_trips_rate_code_id.ba0047eaae"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select rate_code_id
from `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips`
where rate_code_id is null



      
    ) dbt_internal_test
[0m07:52:49.211775 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:b5e8c11d-25f8-4794-8fce-9ec5865df96d&page=queryresults
[0m07:52:50.215860 [info ] [Thread-1  ]: 25 of 34 PASS not_null_fct_trips_rate_code_id .................................. [[32mPASS[0m in 1.92s]
[0m07:52:50.220122 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_rate_code_id.ba0047eaae
[0m07:52:50.228541 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_trip_distance.19cd17f1df
[0m07:52:50.231730 [info ] [Thread-1  ]: 26 of 34 START test not_null_fct_trips_trip_distance ........................... [RUN]
[0m07:52:50.234952 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_rate_code_id.ba0047eaae, now test.nyc_taxi.not_null_fct_trips_trip_distance.19cd17f1df)
[0m07:52:50.238020 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_trip_distance.19cd17f1df
[0m07:52:50.253976 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_trip_distance.19cd17f1df"
[0m07:52:50.277887 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_trip_distance.19cd17f1df
[0m07:52:50.288418 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_fct_trips_trip_distance.19cd17f1df"
[0m07:52:50.314206 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:52:50.325091 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_fct_trips_trip_distance.19cd17f1df: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_fct_trips_trip_distance.19cd17f1df"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select trip_distance
from `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips`
where trip_distance is null



      
    ) dbt_internal_test
[0m07:52:51.239414 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:303335c8-fcf8-4eec-a1f0-39d2737bb92d&page=queryresults
[0m07:52:52.234329 [info ] [Thread-1  ]: 26 of 34 PASS not_null_fct_trips_trip_distance ................................. [[32mPASS[0m in 2.00s]
[0m07:52:52.240702 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_trip_distance.19cd17f1df
[0m07:52:52.245458 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_vendor_id.b9b2f380bb
[0m07:52:52.248961 [info ] [Thread-1  ]: 27 of 34 START test not_null_fct_trips_vendor_id ............................... [RUN]
[0m07:52:52.259702 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_trip_distance.19cd17f1df, now test.nyc_taxi.not_null_fct_trips_vendor_id.b9b2f380bb)
[0m07:52:52.264536 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_vendor_id.b9b2f380bb
[0m07:52:52.284488 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_vendor_id.b9b2f380bb"
[0m07:52:52.307150 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_vendor_id.b9b2f380bb
[0m07:52:52.320345 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_fct_trips_vendor_id.b9b2f380bb"
[0m07:52:52.340024 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:52:52.349752 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_fct_trips_vendor_id.b9b2f380bb: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_fct_trips_vendor_id.b9b2f380bb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select vendor_id
from `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips`
where vendor_id is null



      
    ) dbt_internal_test
[0m07:52:53.170698 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:4738b497-0fc1-45a3-9073-37bb671443f3&page=queryresults
[0m07:52:54.157765 [info ] [Thread-1  ]: 27 of 34 PASS not_null_fct_trips_vendor_id ..................................... [[32mPASS[0m in 1.90s]
[0m07:52:54.163419 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_vendor_id.b9b2f380bb
[0m07:52:54.166989 [debug] [Thread-1  ]: Began running node test.nyc_taxi.unique_dim_payment_type_id.dea55de04e
[0m07:52:54.170322 [info ] [Thread-1  ]: 28 of 34 START test unique_dim_payment_type_id ................................. [RUN]
[0m07:52:54.174236 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_vendor_id.b9b2f380bb, now test.nyc_taxi.unique_dim_payment_type_id.dea55de04e)
[0m07:52:54.177705 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.unique_dim_payment_type_id.dea55de04e
[0m07:52:54.204440 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.unique_dim_payment_type_id.dea55de04e"
[0m07:52:54.226261 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.unique_dim_payment_type_id.dea55de04e
[0m07:52:54.236856 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.unique_dim_payment_type_id.dea55de04e"
[0m07:52:54.260318 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:52:54.269960 [debug] [Thread-1  ]: On test.nyc_taxi.unique_dim_payment_type_id.dea55de04e: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.unique_dim_payment_type_id.dea55de04e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select type_id as unique_field
  from `northern-shield-437204-m0`.`nyc_taxi`.`dim_payment`
  where type_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m07:52:55.101332 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:1b4688a5-f2dd-43c5-8b02-137c79a41b23&page=queryresults
[0m07:52:56.065906 [info ] [Thread-1  ]: 28 of 34 PASS unique_dim_payment_type_id ....................................... [[32mPASS[0m in 1.89s]
[0m07:52:56.072347 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.unique_dim_payment_type_id.dea55de04e
[0m07:52:56.077954 [debug] [Thread-1  ]: Began running node test.nyc_taxi.unique_dim_ratecode_rate_id.75ae8e4885
[0m07:52:56.081088 [info ] [Thread-1  ]: 29 of 34 START test unique_dim_ratecode_rate_id ................................ [RUN]
[0m07:52:56.084671 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.unique_dim_payment_type_id.dea55de04e, now test.nyc_taxi.unique_dim_ratecode_rate_id.75ae8e4885)
[0m07:52:56.089962 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.unique_dim_ratecode_rate_id.75ae8e4885
[0m07:52:56.116051 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.unique_dim_ratecode_rate_id.75ae8e4885"
[0m07:52:56.133795 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.unique_dim_ratecode_rate_id.75ae8e4885
[0m07:52:56.146753 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.unique_dim_ratecode_rate_id.75ae8e4885"
[0m07:52:56.162528 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:52:56.172825 [debug] [Thread-1  ]: On test.nyc_taxi.unique_dim_ratecode_rate_id.75ae8e4885: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.unique_dim_ratecode_rate_id.75ae8e4885"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select rate_id as unique_field
  from `northern-shield-437204-m0`.`nyc_taxi`.`dim_ratecode`
  where rate_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m07:52:57.052413 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:51c4b22c-3363-47e0-99fb-93ad80114d55&page=queryresults
[0m07:52:58.050587 [info ] [Thread-1  ]: 29 of 34 PASS unique_dim_ratecode_rate_id ...................................... [[32mPASS[0m in 1.97s]
[0m07:52:58.055370 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.unique_dim_ratecode_rate_id.75ae8e4885
[0m07:52:58.059170 [debug] [Thread-1  ]: Began running node test.nyc_taxi.unique_dim_time_time_id.0752c025e8
[0m07:52:58.061918 [info ] [Thread-1  ]: 30 of 34 START test unique_dim_time_time_id .................................... [RUN]
[0m07:52:58.065532 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.unique_dim_ratecode_rate_id.75ae8e4885, now test.nyc_taxi.unique_dim_time_time_id.0752c025e8)
[0m07:52:58.068569 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.unique_dim_time_time_id.0752c025e8
[0m07:52:58.085703 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.unique_dim_time_time_id.0752c025e8"
[0m07:52:58.111184 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.unique_dim_time_time_id.0752c025e8
[0m07:52:58.132322 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.unique_dim_time_time_id.0752c025e8"
[0m07:52:58.157349 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:52:58.187293 [debug] [Thread-1  ]: On test.nyc_taxi.unique_dim_time_time_id.0752c025e8: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.unique_dim_time_time_id.0752c025e8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select time_id as unique_field
  from `northern-shield-437204-m0`.`nyc_taxi`.`dim_time`
  where time_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m07:52:59.076220 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:ebe4f742-eb49-4d66-8c0b-0e55fa3b91c0&page=queryresults
[0m07:53:00.191299 [info ] [Thread-1  ]: 30 of 34 PASS unique_dim_time_time_id .......................................... [[32mPASS[0m in 2.13s]
[0m07:53:00.195696 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.unique_dim_time_time_id.0752c025e8
[0m07:53:00.199465 [debug] [Thread-1  ]: Began running node test.nyc_taxi.unique_dim_triptype_type_id.fbaf29d341
[0m07:53:00.202680 [info ] [Thread-1  ]: 31 of 34 START test unique_dim_triptype_type_id ................................ [RUN]
[0m07:53:00.205742 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.unique_dim_time_time_id.0752c025e8, now test.nyc_taxi.unique_dim_triptype_type_id.fbaf29d341)
[0m07:53:00.208959 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.unique_dim_triptype_type_id.fbaf29d341
[0m07:53:00.225489 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.unique_dim_triptype_type_id.fbaf29d341"
[0m07:53:00.249285 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.unique_dim_triptype_type_id.fbaf29d341
[0m07:53:00.261567 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.unique_dim_triptype_type_id.fbaf29d341"
[0m07:53:00.285634 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:53:00.296365 [debug] [Thread-1  ]: On test.nyc_taxi.unique_dim_triptype_type_id.fbaf29d341: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.unique_dim_triptype_type_id.fbaf29d341"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select type_id as unique_field
  from `northern-shield-437204-m0`.`nyc_taxi`.`dim_triptype`
  where type_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m07:53:01.407021 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:1ebe1e6e-56b0-423b-b622-0c095f44e817&page=queryresults
[0m07:53:02.383637 [info ] [Thread-1  ]: 31 of 34 PASS unique_dim_triptype_type_id ...................................... [[32mPASS[0m in 2.18s]
[0m07:53:02.389313 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.unique_dim_triptype_type_id.fbaf29d341
[0m07:53:02.393044 [debug] [Thread-1  ]: Began running node test.nyc_taxi.unique_dim_vendor_id.03fad38d04
[0m07:53:02.396201 [info ] [Thread-1  ]: 32 of 34 START test unique_dim_vendor_id ....................................... [RUN]
[0m07:53:02.401881 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.unique_dim_triptype_type_id.fbaf29d341, now test.nyc_taxi.unique_dim_vendor_id.03fad38d04)
[0m07:53:02.405773 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.unique_dim_vendor_id.03fad38d04
[0m07:53:02.422435 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.unique_dim_vendor_id.03fad38d04"
[0m07:53:02.445213 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.unique_dim_vendor_id.03fad38d04
[0m07:53:02.458444 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.unique_dim_vendor_id.03fad38d04"
[0m07:53:02.477730 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:53:02.487548 [debug] [Thread-1  ]: On test.nyc_taxi.unique_dim_vendor_id.03fad38d04: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.unique_dim_vendor_id.03fad38d04"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select id as unique_field
  from `northern-shield-437204-m0`.`nyc_taxi`.`dim_vendor`
  where id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m07:53:03.351215 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:81b00738-a0a8-4e91-bb24-4912f37b562f&page=queryresults
[0m07:53:04.361803 [info ] [Thread-1  ]: 32 of 34 PASS unique_dim_vendor_id ............................................. [[32mPASS[0m in 1.96s]
[0m07:53:04.370042 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.unique_dim_vendor_id.03fad38d04
[0m07:53:04.374118 [debug] [Thread-1  ]: Began running node test.nyc_taxi.unique_dim_zone_location_id.7702f92424
[0m07:53:04.377340 [info ] [Thread-1  ]: 33 of 34 START test unique_dim_zone_location_id ................................ [RUN]
[0m07:53:04.380512 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.unique_dim_vendor_id.03fad38d04, now test.nyc_taxi.unique_dim_zone_location_id.7702f92424)
[0m07:53:04.383622 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.unique_dim_zone_location_id.7702f92424
[0m07:53:04.406542 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.unique_dim_zone_location_id.7702f92424"
[0m07:53:04.432733 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.unique_dim_zone_location_id.7702f92424
[0m07:53:04.444965 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.unique_dim_zone_location_id.7702f92424"
[0m07:53:04.472125 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:53:04.482399 [debug] [Thread-1  ]: On test.nyc_taxi.unique_dim_zone_location_id.7702f92424: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.unique_dim_zone_location_id.7702f92424"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select location_id as unique_field
  from `northern-shield-437204-m0`.`nyc_taxi`.`dim_zone`
  where location_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m07:53:05.355563 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:e541141d-8d39-43ce-b7ec-7d04172b5acc&page=queryresults
[0m07:53:06.386757 [info ] [Thread-1  ]: 33 of 34 PASS unique_dim_zone_location_id ...................................... [[32mPASS[0m in 2.01s]
[0m07:53:06.391840 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.unique_dim_zone_location_id.7702f92424
[0m07:53:06.395762 [debug] [Thread-1  ]: Began running node test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab
[0m07:53:06.398547 [info ] [Thread-1  ]: 34 of 34 START test unique_fct_trips_trip_id ................................... [RUN]
[0m07:53:06.402573 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.unique_dim_zone_location_id.7702f92424, now test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab)
[0m07:53:06.406702 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab
[0m07:53:06.427298 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab"
[0m07:53:06.452921 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab
[0m07:53:06.468004 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab"
[0m07:53:06.492190 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:53:06.503117 [debug] [Thread-1  ]: On test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select trip_id as unique_field
  from `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips`
  where trip_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m07:53:07.671085 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:c5918ff7-2ab5-4caf-92f7-d58dec15a733&page=queryresults
[0m07:53:08.690736 [error] [Thread-1  ]: 34 of 34 FAIL 59326 unique_fct_trips_trip_id ................................... [[31mFAIL 59326[0m in 2.29s]
[0m07:53:08.696567 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab
[0m07:53:08.703307 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:53:08.706398 [debug] [MainThread]: Connection 'test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab' was properly closed.
[0m07:53:08.709472 [info ] [MainThread]: 
[0m07:53:08.712291 [info ] [MainThread]: Finished running 34 data tests in 0 hours 1 minutes and 14.08 seconds (74.08s).
[0m07:53:08.753041 [debug] [MainThread]: Command end result
[0m07:53:09.017344 [info ] [MainThread]: 
[0m07:53:09.028278 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m07:53:09.032244 [info ] [MainThread]: 
[0m07:53:09.036113 [error] [MainThread]: [31mFailure in test unique_fct_trips_trip_id (models/tests/schema.yml)[0m
[0m07:53:09.040070 [error] [MainThread]:   Got 59326 results, configured to fail if != 0
[0m07:53:09.043642 [info ] [MainThread]: 
[0m07:53:09.047473 [info ] [MainThread]:   compiled code at target/compiled/nyc_taxi/models/tests/schema.yml/unique_fct_trips_trip_id.sql
[0m07:53:09.050716 [info ] [MainThread]: 
[0m07:53:09.053963 [info ] [MainThread]: Done. PASS=33 WARN=0 ERROR=1 SKIP=0 TOTAL=34
[0m07:53:09.059477 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 81.06937, "process_in_blocks": "212432", "process_kernel_time": 1.301954, "process_mem_max_rss": "257296", "process_out_blocks": "568", "process_user_time": 17.946142}
[0m07:53:09.063808 [debug] [MainThread]: Command `dbt test` failed at 07:53:09.063220 after 81.07 seconds
[0m07:53:09.066813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc343847f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc33c888070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc33c888160>]}
[0m07:53:09.068983 [debug] [MainThread]: Flushing usage events
[0m08:10:01.978468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5660445f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f565e21ba00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f565e21b9a0>]}


============================== 08:10:02.000232 | 64e06d9a-671a-4c27-a573-eada10e53676 ==============================
[0m08:10:02.000232 [info ] [MainThread]: Running with dbt=1.8.9
[0m08:10:02.004454 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'quiet': 'False', 'profiles_dir': '/opt/airflow/include/dbt/', 'no_print': 'None', 'introspect': 'True', 'partial_parse': 'True', 'write_json': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'log_path': '/opt/airflow/include/dbt/logs', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/include/dbt/', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'printer_width': '80', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'warn_error': 'None', 'debug': 'False', 'empty': 'False', 'version_check': 'True', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'fail_fast': 'False'}
[0m08:10:04.922809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '64e06d9a-671a-4c27-a573-eada10e53676', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5626e7db20>]}
[0m08:10:05.085918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '64e06d9a-671a-4c27-a573-eada10e53676', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5626d8d3d0>]}
[0m08:10:05.089772 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m08:10:05.535087 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m08:10:07.894063 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:10:07.897157 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:10:08.127195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '64e06d9a-671a-4c27-a573-eada10e53676', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56595dce20>]}
[0m08:10:08.917796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '64e06d9a-671a-4c27-a573-eada10e53676', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5659629a60>]}
[0m08:10:08.921792 [info ] [MainThread]: Found 7 models, 34 data tests, 2 sources, 600 macros
[0m08:10:08.925213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '64e06d9a-671a-4c27-a573-eada10e53676', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5627ac38e0>]}
[0m08:10:08.934306 [info ] [MainThread]: 
[0m08:10:08.938728 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m08:10:08.955918 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_northern-shield-437204-m0'
[0m08:10:08.958778 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:10:09.671713 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_northern-shield-437204-m0, now list_northern-shield-437204-m0_nyc_taxi)
[0m08:10:09.675066 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:10:10.288218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '64e06d9a-671a-4c27-a573-eada10e53676', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5627ada9d0>]}
[0m08:10:10.291739 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:10:10.294223 [info ] [MainThread]: 
[0m08:10:10.312284 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_payment
[0m08:10:10.315934 [info ] [Thread-1  ]: 1 of 7 START sql table model nyc_taxi.dim_payment .............................. [RUN]
[0m08:10:10.319289 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_northern-shield-437204-m0_nyc_taxi, now model.nyc_taxi.dim_payment)
[0m08:10:10.322509 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_payment
[0m08:10:10.353507 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_payment"
[0m08:10:10.375822 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_payment
[0m08:10:10.429847 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m08:10:11.114126 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.dim_payment"
[0m08:10:11.133657 [debug] [Thread-1  ]: On model.nyc_taxi.dim_payment: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.dim_payment"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`dim_payment`
      
    
    

    OPTIONS()
    as (
      WITH payment_cte AS(
    SELECT DISTINCT
        payment_type AS type_id,
        CASE 
            WHEN payment_type = 1 THEN "Credit card"
            WHEN payment_type = 2 THEN "Cash"
            WHEN payment_type = 3 THEN "No charge"
            WHEN payment_type = 4 THEN "Dispute"
            WHEN payment_type = 5 THEN "Unknown"
            WHEN payment_type = 6 THEN "Voided trip"
        END AS payment_name
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata`
)
SELECT
    type_id,
    payment_name
FROM payment_cte
    );
  
[0m08:10:11.728415 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:f9c6666b-799a-4b01-b014-07005c8e1e4d&page=queryresults
[0m08:10:14.720246 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '64e06d9a-671a-4c27-a573-eada10e53676', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5627bb3d60>]}
[0m08:10:14.724475 [info ] [Thread-1  ]: 1 of 7 OK created sql table model nyc_taxi.dim_payment ......................... [[32mCREATE TABLE (4.0 rows, 927.0 KiB processed)[0m in 4.40s]
[0m08:10:14.729121 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_payment
[0m08:10:14.732496 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_ratecode
[0m08:10:14.735932 [info ] [Thread-1  ]: 2 of 7 START sql table model nyc_taxi.dim_ratecode ............................. [RUN]
[0m08:10:14.739767 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_payment, now model.nyc_taxi.dim_ratecode)
[0m08:10:14.743873 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_ratecode
[0m08:10:14.757911 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_ratecode"
[0m08:10:14.780603 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_ratecode
[0m08:10:14.793067 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m08:10:15.454325 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.dim_ratecode"
[0m08:10:15.473216 [debug] [Thread-1  ]: On model.nyc_taxi.dim_ratecode: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.dim_ratecode"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`dim_ratecode`
      
    
    

    OPTIONS()
    as (
      WITH rate_code_cte AS(
    SELECT DISTINCT
        rate_code_id AS rate_id,
        CASE 
            WHEN rate_code_id = 1 THEN "Standard rate"
            WHEN rate_code_id = 2 THEN "JFK"
            WHEN rate_code_id = 3 THEN "Newark"
            WHEN rate_code_id = 4 THEN "Nassau or Westchester"
            WHEN rate_code_id = 5 THEN "Negotiated fare"
            WHEN rate_code_id = 6 THEN "Group ride"
        ELSE "Unknown"
        END AS rate_code_name
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata`
)
SELECT
    rate_id,
    rate_code_name
FROM rate_code_cte
    );
  
[0m08:10:16.040134 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:770ae19a-96c9-453b-81f1-7068ad2b3649&page=queryresults
[0m08:10:18.689323 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '64e06d9a-671a-4c27-a573-eada10e53676', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56595de160>]}
[0m08:10:18.693157 [info ] [Thread-1  ]: 2 of 7 OK created sql table model nyc_taxi.dim_ratecode ........................ [[32mCREATE TABLE (6.0 rows, 927.0 KiB processed)[0m in 3.95s]
[0m08:10:18.697701 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_ratecode
[0m08:10:18.701697 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_time
[0m08:10:18.705449 [info ] [Thread-1  ]: 3 of 7 START sql table model nyc_taxi.dim_time ................................. [RUN]
[0m08:10:18.709693 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_ratecode, now model.nyc_taxi.dim_time)
[0m08:10:18.713303 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_time
[0m08:10:18.737043 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_time"
[0m08:10:18.759407 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_time
[0m08:10:18.771750 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m08:10:19.370911 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.dim_time"
[0m08:10:19.392056 [debug] [Thread-1  ]: On model.nyc_taxi.dim_time: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.dim_time"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`dim_time`
      
    
    

    OPTIONS()
    as (
      WITH datetime_cte AS (
    SELECT DISTINCT
        lpep_pickup_datetime AS datetime_value
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata`
    UNION ALL
    SELECT DISTINCT
        lpep_dropoff_datetime AS datetime_value
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata`
),
datetime_cte_distinct AS(
    SELECT DISTINCT
        datetime_value
    FROM datetime_cte
)
SELECT
    ROW_NUMBER() OVER (ORDER BY datetime_value) AS time_id,
    DATE(datetime_value) AS date,
    datetime_value AS date_part,
    EXTRACT(YEAR FROM datetime_value) AS year,
    EXTRACT(MONTH FROM datetime_value) AS month,
    EXTRACT(DAY FROM datetime_value) AS day,
    EXTRACT(HOUR FROM datetime_value) AS hour,
    EXTRACT(MINUTE FROM datetime_value) AS minute,
    FORMAT_TIMESTAMP('%A', datetime_value) AS weekday
FROM datetime_cte_distinct
ORDER BY time_id
    );
  
[0m08:10:19.956972 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:a297a3d6-97fb-4227-96c9-cbecd9aa925c&page=queryresults
[0m08:10:23.038409 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '64e06d9a-671a-4c27-a573-eada10e53676', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56595de190>]}
[0m08:10:23.043144 [info ] [Thread-1  ]: 3 of 7 OK created sql table model nyc_taxi.dim_time ............................ [[32mCREATE TABLE (115.0k rows, 1.8 MiB processed)[0m in 4.33s]
[0m08:10:23.048570 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_time
[0m08:10:23.052628 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_triptype
[0m08:10:23.056536 [info ] [Thread-1  ]: 4 of 7 START sql table model nyc_taxi.dim_triptype ............................. [RUN]
[0m08:10:23.061413 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_time, now model.nyc_taxi.dim_triptype)
[0m08:10:23.064964 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_triptype
[0m08:10:23.078538 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_triptype"
[0m08:10:23.100445 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_triptype
[0m08:10:23.110711 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m08:10:23.890444 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.dim_triptype"
[0m08:10:23.909054 [debug] [Thread-1  ]: On model.nyc_taxi.dim_triptype: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.dim_triptype"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`dim_triptype`
      
    
    

    OPTIONS()
    as (
      WITH triptype_cte AS(
	SELECT DISTINCT 
		trip_type AS type_id,
		CASE 
			WHEN trip_type = 1 THEN 'Street-hail'
			WHEN trip_type = 2 THEN 'Dispatch'
		ELSE 'Unknown'
		END AS trip_name
	FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata` 
	WHERE trip_type IS NOT NULL
)
SELECT
	type_id,
	trip_name
FROM triptype_cte
    );
  
[0m08:10:24.476940 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:1923316c-4a23-4768-9b8f-e701c1f4abe6&page=queryresults
[0m08:10:28.093298 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '64e06d9a-671a-4c27-a573-eada10e53676', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5626da1f70>]}
[0m08:10:28.097355 [info ] [Thread-1  ]: 4 of 7 OK created sql table model nyc_taxi.dim_triptype ........................ [[32mCREATE TABLE (3.0 rows, 927.0 KiB processed)[0m in 5.03s]
[0m08:10:28.102842 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_triptype
[0m08:10:28.106952 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_vendor
[0m08:10:28.110961 [info ] [Thread-1  ]: 5 of 7 START sql table model nyc_taxi.dim_vendor ............................... [RUN]
[0m08:10:28.114975 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_triptype, now model.nyc_taxi.dim_vendor)
[0m08:10:28.118098 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_vendor
[0m08:10:28.132418 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_vendor"
[0m08:10:28.154315 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_vendor
[0m08:10:28.170818 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m08:10:28.738502 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.dim_vendor"
[0m08:10:28.762995 [debug] [Thread-1  ]: On model.nyc_taxi.dim_vendor: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.dim_vendor"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`dim_vendor`
      
    
    

    OPTIONS()
    as (
      WITH vendor_cte AS(
    SELECT DISTINCT
        vendor_id AS id,
        CASE 
            WHEN vendor_id = 1 THEN "Creative Mobile Technologies"
            WHEN vendor_id = 2 THEN "VeriFone Inc."
        END AS vendor_name
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata`
)
SELECT
    id,
    vendor_name
FROM vendor_cte
    );
  
[0m08:10:29.245708 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:6d1d9caa-8f17-49ff-aa84-709f49610835&page=queryresults
[0m08:10:31.476890 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '64e06d9a-671a-4c27-a573-eada10e53676', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5627bb3d60>]}
[0m08:10:31.481074 [info ] [Thread-1  ]: 5 of 7 OK created sql table model nyc_taxi.dim_vendor .......................... [[32mCREATE TABLE (2.0 rows, 927.0 KiB processed)[0m in 3.36s]
[0m08:10:31.487289 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_vendor
[0m08:10:31.491430 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_zone
[0m08:10:31.495681 [info ] [Thread-1  ]: 6 of 7 START sql table model nyc_taxi.dim_zone ................................. [RUN]
[0m08:10:31.499762 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_vendor, now model.nyc_taxi.dim_zone)
[0m08:10:31.503751 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_zone
[0m08:10:31.519694 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_zone"
[0m08:10:31.542708 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_zone
[0m08:10:31.556307 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m08:10:32.132605 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.dim_zone"
[0m08:10:32.154818 [debug] [Thread-1  ]: On model.nyc_taxi.dim_zone: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.dim_zone"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`dim_zone`
      
    
    

    OPTIONS()
    as (
      SELECT DISTINCT
    location_id,
    borough,
    zone,
    replace(service_zone, 'Boro', 'Green') AS service_zone
FROM `northern-shield-437204-m0`.`nyc_taxi`.`zone_map`
WHERE service_zone IS NOT NULL
    );
  
[0m08:10:32.695870 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:2e978298-7773-44ab-a8db-41f75319d248&page=queryresults
[0m08:10:35.578039 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '64e06d9a-671a-4c27-a573-eada10e53676', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5659417100>]}
[0m08:10:35.581961 [info ] [Thread-1  ]: 6 of 7 OK created sql table model nyc_taxi.dim_zone ............................ [[32mCREATE TABLE (263.0 rows, 36.2 KiB processed)[0m in 4.08s]
[0m08:10:35.586872 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_zone
[0m08:10:35.589955 [debug] [Thread-1  ]: Began running node model.nyc_taxi.fct_trips
[0m08:10:35.595059 [info ] [Thread-1  ]: 7 of 7 START sql table model nyc_taxi.fct_trips ................................ [RUN]
[0m08:10:35.601137 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_zone, now model.nyc_taxi.fct_trips)
[0m08:10:35.605017 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.fct_trips
[0m08:10:35.664153 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.fct_trips"
[0m08:10:35.683767 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.fct_trips
[0m08:10:35.697811 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.fct_trips"
[0m08:10:35.717055 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m08:10:35.725842 [debug] [Thread-1  ]: On model.nyc_taxi.fct_trips: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.fct_trips"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips`
      
    
    

    OPTIONS()
    as (
      WITH tripdata_cte AS (
    SELECT 
        to_hex(md5(cast(coalesce(cast(t.vendor_id as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(t.lpep_pickup_datetime as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(t.lpep_dropoff_datetime as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(t.__index_level_0__ as string), '_dbt_utils_surrogate_key_null_') as string))) AS trip_id,
        t.vendor_id,
        pt.time_id AS pickup_time_id,
        dt.time_id AS dropoff_time_id,
        t.rate_code_id,
        t.pu_location_id,
        t.do_location_id,
        t.passenger_count,
        t.trip_distance,
        t.fare_amount,
        t.extra,
        t.mta_tax,
        t.tip_amount,
        t.tolls_amount,
        t.improvement_surcharge,
        t.total_amount,
        t.payment_type,
        t.trip_type,
        t.congestion_surcharge
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata` AS t
    INNER JOIN (
        SELECT DISTINCT date_part, time_id 
        FROM `northern-shield-437204-m0`.`nyc_taxi`.`dim_time`
    ) pt ON t.lpep_pickup_datetime = pt.date_part
    INNER JOIN (
        SELECT DISTINCT date_part, time_id 
        FROM `northern-shield-437204-m0`.`nyc_taxi`.`dim_time`
    ) dt ON t.lpep_dropoff_datetime = dt.date_part
)
SELECT 
    trip_id,
    vendor_id,
    pickup_time_id,
    dropoff_time_id,
    rate_code_id,
    pu_location_id,
    do_location_id,
    passenger_count,
    trip_distance,
    fare_amount,
    extra,
    mta_tax,
    tip_amount,
    tolls_amount,
    improvement_surcharge,
    total_amount,
    payment_type,
    trip_type,
    congestion_surcharge
FROM tripdata_cte
    );
  
[0m08:10:36.512347 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:c7bb5055-64c8-4975-9792-194db977e363&page=queryresults
[0m08:10:40.839030 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '64e06d9a-671a-4c27-a573-eada10e53676', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5627bb3d60>]}
[0m08:10:40.842467 [info ] [Thread-1  ]: 7 of 7 OK created sql table model nyc_taxi.fct_trips ........................... [[32mCREATE TABLE (118.7k rows, 19.0 MiB processed)[0m in 5.24s]
[0m08:10:40.847336 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.fct_trips
[0m08:10:40.853005 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:10:40.855482 [debug] [MainThread]: Connection 'model.nyc_taxi.fct_trips' was properly closed.
[0m08:10:40.858527 [info ] [MainThread]: 
[0m08:10:40.863327 [info ] [MainThread]: Finished running 7 table models in 0 hours 0 minutes and 31.92 seconds (31.92s).
[0m08:10:40.878243 [debug] [MainThread]: Command end result
[0m08:10:41.083534 [info ] [MainThread]: 
[0m08:10:41.086780 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:10:41.089539 [info ] [MainThread]: 
[0m08:10:41.092597 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m08:10:41.098193 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 37.9951, "process_in_blocks": "0", "process_kernel_time": 0.922253, "process_mem_max_rss": "232984", "process_out_blocks": "0", "process_user_time": 13.163075}
[0m08:10:41.103097 [debug] [MainThread]: Command `dbt run` succeeded at 08:10:41.101514 after 38.00 seconds
[0m08:10:41.106566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5660445f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5627235f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56594a75b0>]}
[0m08:10:41.110061 [debug] [MainThread]: Flushing usage events
[0m04:48:27.544660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c0c907430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c0a73f9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c0a73f970>]}


============================== 04:48:27.551789 | cc6f157a-82f2-450a-a863-2ad9afff43c1 ==============================
[0m04:48:27.551789 [info ] [MainThread]: Running with dbt=1.8.9
[0m04:48:27.553095 [debug] [MainThread]: running dbt with arguments {'profiles_dir': '/opt/airflow/include/dbt/', 'version_check': 'True', 'printer_width': '80', 'log_format': 'default', 'send_anonymous_usage_stats': 'True', 'log_cache_events': 'False', 'write_json': 'True', 'quiet': 'False', 'fail_fast': 'False', 'introspect': 'True', 'debug': 'False', 'log_path': '/opt/airflow/include/dbt/logs', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'indirect_selection': 'eager', 'empty': 'False', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'warn_error': 'None', 'use_colors': 'True', 'invocation_command': 'dbt run --profiles-dir /opt/airflow/include/dbt/', 'static_parser': 'True', 'cache_selected_only': 'False', 'no_print': 'None', 'target_path': 'None'}
[0m04:48:29.323234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cc6f157a-82f2-450a-a863-2ad9afff43c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1bd80a9880>]}
[0m04:48:29.385031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cc6f157a-82f2-450a-a863-2ad9afff43c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1bd812fca0>]}
[0m04:48:29.386713 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m04:48:29.547696 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m04:48:30.256381 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m04:48:30.258380 [debug] [MainThread]: Partial parsing: updated file: nyc_taxi://models/transform/fct_trips.sql
[0m04:48:30.649241 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m04:48:30.651059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'cc6f157a-82f2-450a-a863-2ad9afff43c1', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c059b8e20>]}
[0m04:48:30.878506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cc6f157a-82f2-450a-a863-2ad9afff43c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c05733e20>]}
[0m04:48:31.059705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cc6f157a-82f2-450a-a863-2ad9afff43c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1bd31e30a0>]}
[0m04:48:31.060957 [info ] [MainThread]: Found 7 models, 34 data tests, 2 sources, 600 macros
[0m04:48:31.062052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cc6f157a-82f2-450a-a863-2ad9afff43c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c0576a070>]}
[0m04:48:31.065548 [info ] [MainThread]: 
[0m04:48:31.067143 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m04:48:31.073498 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_northern-shield-437204-m0'
[0m04:48:31.074538 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:48:31.673421 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_northern-shield-437204-m0, now list_northern-shield-437204-m0_nyc_taxi)
[0m04:48:31.674702 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:48:32.237194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cc6f157a-82f2-450a-a863-2ad9afff43c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c0cc52a00>]}
[0m04:48:32.238871 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m04:48:32.240262 [info ] [MainThread]: 
[0m04:48:32.249865 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_payment
[0m04:48:32.251408 [info ] [Thread-1  ]: 1 of 7 START sql table model nyc_taxi.dim_payment .............................. [RUN]
[0m04:48:32.252712 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_northern-shield-437204-m0_nyc_taxi, now model.nyc_taxi.dim_payment)
[0m04:48:32.253993 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_payment
[0m04:48:32.264815 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_payment"
[0m04:48:32.270533 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_payment
[0m04:48:32.289587 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m04:48:32.857449 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.dim_payment"
[0m04:48:32.862963 [debug] [Thread-1  ]: On model.nyc_taxi.dim_payment: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.dim_payment"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`dim_payment`
      
    
    

    OPTIONS()
    as (
      WITH payment_cte AS(
    SELECT DISTINCT
        payment_type AS type_id,
        CASE 
            WHEN payment_type = 1 THEN "Credit card"
            WHEN payment_type = 2 THEN "Cash"
            WHEN payment_type = 3 THEN "No charge"
            WHEN payment_type = 4 THEN "Dispute"
            WHEN payment_type = 5 THEN "Unknown"
            WHEN payment_type = 6 THEN "Voided trip"
        END AS payment_name
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata`
)
SELECT
    type_id,
    payment_name
FROM payment_cte
    );
  
[0m04:48:33.360242 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:c28a3bd3-2ae4-47af-b3e3-137ef931bf67&page=queryresults
[0m04:48:35.961839 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc6f157a-82f2-450a-a863-2ad9afff43c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c0bf7d490>]}
[0m04:48:35.964143 [info ] [Thread-1  ]: 1 of 7 OK created sql table model nyc_taxi.dim_payment ......................... [[32mCREATE TABLE (4.0 rows, 463.5 KiB processed)[0m in 3.71s]
[0m04:48:35.965978 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_payment
[0m04:48:35.967373 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_ratecode
[0m04:48:35.968465 [info ] [Thread-1  ]: 2 of 7 START sql table model nyc_taxi.dim_ratecode ............................. [RUN]
[0m04:48:35.969655 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_payment, now model.nyc_taxi.dim_ratecode)
[0m04:48:35.970793 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_ratecode
[0m04:48:35.975233 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_ratecode"
[0m04:48:35.979828 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_ratecode
[0m04:48:35.984837 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m04:48:36.537216 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.dim_ratecode"
[0m04:48:36.544363 [debug] [Thread-1  ]: On model.nyc_taxi.dim_ratecode: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.dim_ratecode"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`dim_ratecode`
      
    
    

    OPTIONS()
    as (
      WITH rate_code_cte AS(
    SELECT DISTINCT
        rate_code_id AS rate_id,
        CASE 
            WHEN rate_code_id = 1 THEN "Standard rate"
            WHEN rate_code_id = 2 THEN "JFK"
            WHEN rate_code_id = 3 THEN "Newark"
            WHEN rate_code_id = 4 THEN "Nassau or Westchester"
            WHEN rate_code_id = 5 THEN "Negotiated fare"
            WHEN rate_code_id = 6 THEN "Group ride"
        ELSE "Unknown"
        END AS rate_code_name
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata`
)
SELECT
    rate_id,
    rate_code_name
FROM rate_code_cte
    );
  
[0m04:48:37.060977 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:c78d564f-5bcb-4fb7-8a31-3bd80cd5ce8a&page=queryresults
[0m04:48:39.107087 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc6f157a-82f2-450a-a863-2ad9afff43c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c05610940>]}
[0m04:48:39.108668 [info ] [Thread-1  ]: 2 of 7 OK created sql table model nyc_taxi.dim_ratecode ........................ [[32mCREATE TABLE (6.0 rows, 463.5 KiB processed)[0m in 3.14s]
[0m04:48:39.110646 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_ratecode
[0m04:48:39.111909 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_time
[0m04:48:39.113069 [info ] [Thread-1  ]: 3 of 7 START sql table model nyc_taxi.dim_time ................................. [RUN]
[0m04:48:39.114267 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_ratecode, now model.nyc_taxi.dim_time)
[0m04:48:39.115281 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_time
[0m04:48:39.120624 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_time"
[0m04:48:39.125239 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_time
[0m04:48:39.129756 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m04:48:39.686015 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.dim_time"
[0m04:48:39.691297 [debug] [Thread-1  ]: On model.nyc_taxi.dim_time: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.dim_time"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`dim_time`
      
    
    

    OPTIONS()
    as (
      WITH datetime_cte AS (
    SELECT DISTINCT
        lpep_pickup_datetime AS datetime_value
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata`
    UNION ALL
    SELECT DISTINCT
        lpep_dropoff_datetime AS datetime_value
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata`
),
datetime_cte_distinct AS(
    SELECT DISTINCT
        datetime_value
    FROM datetime_cte
)
SELECT
    ROW_NUMBER() OVER (ORDER BY datetime_value) AS time_id,
    DATE(datetime_value) AS date,
    datetime_value AS date_part,
    EXTRACT(YEAR FROM datetime_value) AS year,
    EXTRACT(MONTH FROM datetime_value) AS month,
    EXTRACT(DAY FROM datetime_value) AS day,
    EXTRACT(HOUR FROM datetime_value) AS hour,
    EXTRACT(MINUTE FROM datetime_value) AS minute,
    FORMAT_TIMESTAMP('%A', datetime_value) AS weekday
FROM datetime_cte_distinct
ORDER BY time_id
    );
  
[0m04:48:40.224661 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:7f32fa91-35c6-4fe2-bd29-3cbf1ec7b8f3&page=queryresults
[0m04:48:43.367945 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc6f157a-82f2-450a-a863-2ad9afff43c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c05610be0>]}
[0m04:48:43.370079 [info ] [Thread-1  ]: 3 of 7 OK created sql table model nyc_taxi.dim_time ............................ [[32mCREATE TABLE (115.0k rows, 927.0 KiB processed)[0m in 4.25s]
[0m04:48:43.372049 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_time
[0m04:48:43.373561 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_triptype
[0m04:48:43.375115 [info ] [Thread-1  ]: 4 of 7 START sql table model nyc_taxi.dim_triptype ............................. [RUN]
[0m04:48:43.376433 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_time, now model.nyc_taxi.dim_triptype)
[0m04:48:43.377726 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_triptype
[0m04:48:43.385057 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_triptype"
[0m04:48:43.392173 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_triptype
[0m04:48:43.398020 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m04:48:43.909064 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.dim_triptype"
[0m04:48:43.915783 [debug] [Thread-1  ]: On model.nyc_taxi.dim_triptype: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.dim_triptype"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`dim_triptype`
      
    
    

    OPTIONS()
    as (
      WITH triptype_cte AS(
	SELECT DISTINCT 
		trip_type AS type_id,
		CASE 
			WHEN trip_type = 1 THEN 'Street-hail'
			WHEN trip_type = 2 THEN 'Dispatch'
		ELSE 'Unknown'
		END AS trip_name
	FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata` 
	WHERE trip_type IS NOT NULL
)
SELECT
	type_id,
	trip_name
FROM triptype_cte
    );
  
[0m04:48:44.384570 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:6bed0f7a-d1ca-4ec7-bf8d-35ac0de9bba1&page=queryresults
[0m04:48:46.900387 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc6f157a-82f2-450a-a863-2ad9afff43c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c056a3f10>]}
[0m04:48:46.902105 [info ] [Thread-1  ]: 4 of 7 OK created sql table model nyc_taxi.dim_triptype ........................ [[32mCREATE TABLE (3.0 rows, 463.5 KiB processed)[0m in 3.52s]
[0m04:48:46.904012 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_triptype
[0m04:48:46.905380 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_vendor
[0m04:48:46.906748 [info ] [Thread-1  ]: 5 of 7 START sql table model nyc_taxi.dim_vendor ............................... [RUN]
[0m04:48:46.908210 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_triptype, now model.nyc_taxi.dim_vendor)
[0m04:48:46.909445 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_vendor
[0m04:48:46.916852 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_vendor"
[0m04:48:46.922336 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_vendor
[0m04:48:46.926664 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m04:48:47.454646 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.dim_vendor"
[0m04:48:47.461097 [debug] [Thread-1  ]: On model.nyc_taxi.dim_vendor: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.dim_vendor"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`dim_vendor`
      
    
    

    OPTIONS()
    as (
      WITH vendor_cte AS(
    SELECT DISTINCT
        vendor_id AS id,
        CASE 
            WHEN vendor_id = 1 THEN "Creative Mobile Technologies"
            WHEN vendor_id = 2 THEN "VeriFone Inc."
        END AS vendor_name
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata`
)
SELECT
    id,
    vendor_name
FROM vendor_cte
    );
  
[0m04:48:47.981204 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:e8978d73-9039-4d39-aeb2-d74ed6259985&page=queryresults
[0m04:48:50.807390 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc6f157a-82f2-450a-a863-2ad9afff43c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c055ff7c0>]}
[0m04:48:50.809071 [info ] [Thread-1  ]: 5 of 7 OK created sql table model nyc_taxi.dim_vendor .......................... [[32mCREATE TABLE (2.0 rows, 463.5 KiB processed)[0m in 3.90s]
[0m04:48:50.810991 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_vendor
[0m04:48:50.812227 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_zone
[0m04:48:50.813441 [info ] [Thread-1  ]: 6 of 7 START sql table model nyc_taxi.dim_zone ................................. [RUN]
[0m04:48:50.814632 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_vendor, now model.nyc_taxi.dim_zone)
[0m04:48:50.815565 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_zone
[0m04:48:50.820306 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_zone"
[0m04:48:50.824696 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_zone
[0m04:48:50.829012 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m04:48:51.332344 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.dim_zone"
[0m04:48:51.337517 [debug] [Thread-1  ]: On model.nyc_taxi.dim_zone: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.dim_zone"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`dim_zone`
      
    
    

    OPTIONS()
    as (
      SELECT DISTINCT
    location_id,
    borough,
    zone,
    replace(service_zone, 'Boro', 'Green') AS service_zone
FROM `northern-shield-437204-m0`.`nyc_taxi`.`zone_map`
WHERE service_zone IS NOT NULL
    );
  
[0m04:48:51.821433 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:590a5479-7403-44e7-a86f-045ff7cbcc5e&page=queryresults
[0m04:48:54.355165 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc6f157a-82f2-450a-a863-2ad9afff43c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c05605d90>]}
[0m04:48:54.356689 [info ] [Thread-1  ]: 6 of 7 OK created sql table model nyc_taxi.dim_zone ............................ [[32mCREATE TABLE (263.0 rows, 72.5 KiB processed)[0m in 3.54s]
[0m04:48:54.358491 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_zone
[0m04:48:54.359935 [debug] [Thread-1  ]: Began running node model.nyc_taxi.fct_trips
[0m04:48:54.361049 [info ] [Thread-1  ]: 7 of 7 START sql table model nyc_taxi.fct_trips ................................ [RUN]
[0m04:48:54.362160 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_zone, now model.nyc_taxi.fct_trips)
[0m04:48:54.363111 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.fct_trips
[0m04:48:54.370954 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.fct_trips"
[0m04:48:54.375809 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.fct_trips
[0m04:48:54.382529 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m04:48:54.893775 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.fct_trips"
[0m04:48:54.900461 [debug] [Thread-1  ]: On model.nyc_taxi.fct_trips: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.fct_trips"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips`
      
    
    

    OPTIONS()
    as (
      WITH tripdata_cte AS (
    SELECT DISTINCT
        to_hex(md5(cast(coalesce(cast(t.vendor_id as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(t.lpep_pickup_datetime as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(t.lpep_dropoff_datetime as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(t.__index_level_0__ as string), '_dbt_utils_surrogate_key_null_') as string))) AS trip_id,
        t.vendor_id,
        pt.time_id AS pickup_time_id,
        dt.time_id AS dropoff_time_id,
        t.rate_code_id,
        t.pu_location_id,
        t.do_location_id,
        t.passenger_count,
        t.trip_distance,
        t.fare_amount,
        t.extra,
        t.mta_tax,
        t.tip_amount,
        t.tolls_amount,
        t.improvement_surcharge,
        t.total_amount,
        t.payment_type,
        t.trip_type,
        t.congestion_surcharge
    FROM `northern-shield-437204-m0`.`nyc_taxi`.`green_tripdata` AS t
    INNER JOIN (
        SELECT DISTINCT date_part, time_id 
        FROM `northern-shield-437204-m0`.`nyc_taxi`.`dim_time`
    ) pt ON t.lpep_pickup_datetime = pt.date_part
    INNER JOIN (
        SELECT DISTINCT date_part, time_id 
        FROM `northern-shield-437204-m0`.`nyc_taxi`.`dim_time`
    ) dt ON t.lpep_dropoff_datetime = dt.date_part
)
SELECT 
    trip_id,
    vendor_id,
    pickup_time_id,
    dropoff_time_id,
    rate_code_id,
    pu_location_id,
    do_location_id,
    passenger_count,
    trip_distance,
    fare_amount,
    extra,
    mta_tax,
    tip_amount,
    tolls_amount,
    improvement_surcharge,
    total_amount,
    payment_type,
    trip_type,
    congestion_surcharge
FROM tripdata_cte
    );
  
[0m04:48:55.387408 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:d93e1c3b-5cc3-48a3-8254-05c482ae4e82&page=queryresults
[0m04:48:59.441647 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc6f157a-82f2-450a-a863-2ad9afff43c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c05632250>]}
[0m04:48:59.443246 [info ] [Thread-1  ]: 7 of 7 OK created sql table model nyc_taxi.fct_trips ........................... [[32mCREATE TABLE (59.3k rows, 10.4 MiB processed)[0m in 5.08s]
[0m04:48:59.445064 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.fct_trips
[0m04:48:59.447610 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:48:59.448479 [debug] [MainThread]: Connection 'model.nyc_taxi.fct_trips' was properly closed.
[0m04:48:59.449360 [info ] [MainThread]: 
[0m04:48:59.450361 [info ] [MainThread]: Finished running 7 table models in 0 hours 0 minutes and 28.38 seconds (28.38s).
[0m04:48:59.454550 [debug] [MainThread]: Command end result
[0m04:48:59.530971 [info ] [MainThread]: 
[0m04:48:59.532404 [info ] [MainThread]: [32mCompleted successfully[0m
[0m04:48:59.533534 [info ] [MainThread]: 
[0m04:48:59.534553 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m04:48:59.536265 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 31.857244, "process_in_blocks": "212112", "process_kernel_time": 0.405439, "process_mem_max_rss": "245204", "process_out_blocks": "0", "process_user_time": 6.05119}
[0m04:48:59.537527 [debug] [MainThread]: Command `dbt run` succeeded at 04:48:59.537358 after 31.86 seconds
[0m04:48:59.538540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c0c907430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c0b448310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1bd31e3790>]}
[0m04:48:59.539672 [debug] [MainThread]: Flushing usage events
[0m04:49:51.272894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa424373430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4221aba30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4221ab9d0>]}


============================== 04:49:51.279949 | d32a5666-9ddb-4949-a038-28fdb7ee0f16 ==============================
[0m04:49:51.279949 [info ] [MainThread]: Running with dbt=1.8.9
[0m04:49:51.281473 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'static_parser': 'True', 'target_path': 'None', 'cache_selected_only': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'log_format': 'default', 'introspect': 'True', 'version_check': 'True', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True', 'profiles_dir': '/opt/airflow/include/dbt/', 'log_path': '/opt/airflow/include/dbt/logs', 'printer_width': '80', 'invocation_command': 'dbt test --profiles-dir /opt/airflow/include/dbt/', 'debug': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'write_json': 'True', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'empty': 'None'}
[0m04:49:52.351515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd32a5666-9ddb-4949-a038-28fdb7ee0f16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa422efb2b0>]}
[0m04:49:52.412303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd32a5666-9ddb-4949-a038-28fdb7ee0f16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3ead8a4f0>]}
[0m04:49:52.414422 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m04:49:52.566729 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m04:49:53.212946 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m04:49:53.213883 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m04:49:53.276099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd32a5666-9ddb-4949-a038-28fdb7ee0f16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa41d3d6130>]}
[0m04:49:53.575964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd32a5666-9ddb-4949-a038-28fdb7ee0f16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3ead22220>]}
[0m04:49:53.577160 [info ] [MainThread]: Found 7 models, 34 data tests, 2 sources, 600 macros
[0m04:49:53.578288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd32a5666-9ddb-4949-a038-28fdb7ee0f16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3eae45730>]}
[0m04:49:53.582651 [info ] [MainThread]: 
[0m04:49:53.584006 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m04:49:53.590555 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_northern-shield-437204-m0_nyc_taxi'
[0m04:49:53.591588 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:49:54.096734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd32a5666-9ddb-4949-a038-28fdb7ee0f16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa423a7cc70>]}
[0m04:49:54.098240 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m04:49:54.099513 [info ] [MainThread]: 
[0m04:49:54.107175 [debug] [Thread-1  ]: Began running node test.nyc_taxi.accepted_values_dim_payment_payment_name__Credit_card__Cash__No_charge__Dispute__Unknown__Voided_trip.58d00ef9f4
[0m04:49:54.108214 [info ] [Thread-1  ]: 1 of 34 START test accepted_values_dim_payment_payment_name__Credit_card__Cash__No_charge__Dispute__Unknown__Voided_trip  [RUN]
[0m04:49:54.109311 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_northern-shield-437204-m0_nyc_taxi, now test.nyc_taxi.accepted_values_dim_payment_payment_name__Credit_card__Cash__No_charge__Dispute__Unknown__Voided_trip.58d00ef9f4)
[0m04:49:54.110261 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.accepted_values_dim_payment_payment_name__Credit_card__Cash__No_charge__Dispute__Unknown__Voided_trip.58d00ef9f4
[0m04:49:54.134641 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.accepted_values_dim_payment_payment_name__Credit_card__Cash__No_charge__Dispute__Unknown__Voided_trip.58d00ef9f4"
[0m04:49:54.140633 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.accepted_values_dim_payment_payment_name__Credit_card__Cash__No_charge__Dispute__Unknown__Voided_trip.58d00ef9f4
[0m04:49:54.166116 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.accepted_values_dim_payment_payment_name__Credit_card__Cash__No_charge__Dispute__Unknown__Voided_trip.58d00ef9f4"
[0m04:49:54.171704 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m04:49:54.174779 [debug] [Thread-1  ]: On test.nyc_taxi.accepted_values_dim_payment_payment_name__Credit_card__Cash__No_charge__Dispute__Unknown__Voided_trip.58d00ef9f4: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.accepted_values_dim_payment_payment_name__Credit_card__Cash__No_charge__Dispute__Unknown__Voided_trip.58d00ef9f4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        payment_name as value_field,
        count(*) as n_records

    from `northern-shield-437204-m0`.`nyc_taxi`.`dim_payment`
    group by payment_name

)

select *
from all_values
where value_field not in (
    'Credit card','Cash','No charge','Dispute','Unknown','Voided trip'
)



      
    ) dbt_internal_test
[0m04:49:54.966318 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:fcea25f3-b1fa-4696-a162-af32123b9e2e&page=queryresults
[0m04:49:55.950508 [info ] [Thread-1  ]: 1 of 34 PASS accepted_values_dim_payment_payment_name__Credit_card__Cash__No_charge__Dispute__Unknown__Voided_trip  [[32mPASS[0m in 1.84s]
[0m04:49:55.952347 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.accepted_values_dim_payment_payment_name__Credit_card__Cash__No_charge__Dispute__Unknown__Voided_trip.58d00ef9f4
[0m04:49:55.953653 [debug] [Thread-1  ]: Began running node test.nyc_taxi.accepted_values_dim_ratecode_rate_code_name__Standard_rate__JFK__Newark__Nassau_or_Westchester__Negotiated_fare__Group_ride__Unknown.57ee02019f
[0m04:49:55.954697 [info ] [Thread-1  ]: 2 of 34 START test accepted_values_dim_ratecode_rate_code_name__Standard_rate__JFK__Newark__Nassau_or_Westchester__Negotiated_fare__Group_ride__Unknown  [RUN]
[0m04:49:55.955911 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.accepted_values_dim_payment_payment_name__Credit_card__Cash__No_charge__Dispute__Unknown__Voided_trip.58d00ef9f4, now test.nyc_taxi.accepted_values_dim_ratecode_rate_code_name__Standard_rate__JFK__Newark__Nassau_or_Westchester__Negotiated_fare__Group_ride__Unknown.57ee02019f)
[0m04:49:55.957158 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.accepted_values_dim_ratecode_rate_code_name__Standard_rate__JFK__Newark__Nassau_or_Westchester__Negotiated_fare__Group_ride__Unknown.57ee02019f
[0m04:49:55.970476 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.accepted_values_dim_ratecode_rate_code_name__Standard_rate__JFK__Newark__Nassau_or_Westchester__Negotiated_fare__Group_ride__Unknown.57ee02019f"
[0m04:49:55.976446 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.accepted_values_dim_ratecode_rate_code_name__Standard_rate__JFK__Newark__Nassau_or_Westchester__Negotiated_fare__Group_ride__Unknown.57ee02019f
[0m04:49:55.981607 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.accepted_values_dim_ratecode_rate_code_name__Standard_rate__JFK__Newark__Nassau_or_Westchester__Negotiated_fare__Group_ride__Unknown.57ee02019f"
[0m04:49:55.987523 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m04:49:55.991368 [debug] [Thread-1  ]: On test.nyc_taxi.accepted_values_dim_ratecode_rate_code_name__Standard_rate__JFK__Newark__Nassau_or_Westchester__Negotiated_fare__Group_ride__Unknown.57ee02019f: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.accepted_values_dim_ratecode_rate_code_name__Standard_rate__JFK__Newark__Nassau_or_Westchester__Negotiated_fare__Group_ride__Unknown.57ee02019f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        rate_code_name as value_field,
        count(*) as n_records

    from `northern-shield-437204-m0`.`nyc_taxi`.`dim_ratecode`
    group by rate_code_name

)

select *
from all_values
where value_field not in (
    'Standard rate','JFK','Newark','Nassau or Westchester','Negotiated fare','Group ride','Unknown'
)



      
    ) dbt_internal_test
[0m04:49:56.783917 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:acef86d4-b928-46d4-9778-a7aa94e92d4c&page=queryresults
[0m04:49:57.772033 [info ] [Thread-1  ]: 2 of 34 PASS accepted_values_dim_ratecode_rate_code_name__Standard_rate__JFK__Newark__Nassau_or_Westchester__Negotiated_fare__Group_ride__Unknown  [[32mPASS[0m in 1.82s]
[0m04:49:57.774508 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.accepted_values_dim_ratecode_rate_code_name__Standard_rate__JFK__Newark__Nassau_or_Westchester__Negotiated_fare__Group_ride__Unknown.57ee02019f
[0m04:49:57.776254 [debug] [Thread-1  ]: Began running node test.nyc_taxi.accepted_values_dim_time_weekday__Sunday__Monday__Tuesday__Wednesday__Thursday__Friday__Saturday.87b4c2a366
[0m04:49:57.777548 [info ] [Thread-1  ]: 3 of 34 START test accepted_values_dim_time_weekday__Sunday__Monday__Tuesday__Wednesday__Thursday__Friday__Saturday  [RUN]
[0m04:49:57.779043 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.accepted_values_dim_ratecode_rate_code_name__Standard_rate__JFK__Newark__Nassau_or_Westchester__Negotiated_fare__Group_ride__Unknown.57ee02019f, now test.nyc_taxi.accepted_values_dim_time_weekday__Sunday__Monday__Tuesday__Wednesday__Thursday__Friday__Saturday.87b4c2a366)
[0m04:49:57.780256 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.accepted_values_dim_time_weekday__Sunday__Monday__Tuesday__Wednesday__Thursday__Friday__Saturday.87b4c2a366
[0m04:49:57.792508 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.accepted_values_dim_time_weekday__Sunday__Monday__Tuesday__Wednesday__Thursday__Friday__Saturday.87b4c2a366"
[0m04:49:57.798705 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.accepted_values_dim_time_weekday__Sunday__Monday__Tuesday__Wednesday__Thursday__Friday__Saturday.87b4c2a366
[0m04:49:57.803157 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.accepted_values_dim_time_weekday__Sunday__Monday__Tuesday__Wednesday__Thursday__Friday__Saturday.87b4c2a366"
[0m04:49:57.808788 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m04:49:57.812399 [debug] [Thread-1  ]: On test.nyc_taxi.accepted_values_dim_time_weekday__Sunday__Monday__Tuesday__Wednesday__Thursday__Friday__Saturday.87b4c2a366: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.accepted_values_dim_time_weekday__Sunday__Monday__Tuesday__Wednesday__Thursday__Friday__Saturday.87b4c2a366"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        weekday as value_field,
        count(*) as n_records

    from `northern-shield-437204-m0`.`nyc_taxi`.`dim_time`
    group by weekday

)

select *
from all_values
where value_field not in (
    'Sunday','Monday','Tuesday','Wednesday','Thursday','Friday','Saturday'
)



      
    ) dbt_internal_test
[0m04:49:58.733802 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:1a0ac4c8-73b8-49c6-820a-bb527a79cb30&page=queryresults
[0m04:49:59.701354 [info ] [Thread-1  ]: 3 of 34 PASS accepted_values_dim_time_weekday__Sunday__Monday__Tuesday__Wednesday__Thursday__Friday__Saturday  [[32mPASS[0m in 1.92s]
[0m04:49:59.703234 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.accepted_values_dim_time_weekday__Sunday__Monday__Tuesday__Wednesday__Thursday__Friday__Saturday.87b4c2a366
[0m04:49:59.704560 [debug] [Thread-1  ]: Began running node test.nyc_taxi.accepted_values_dim_triptype_trip_name__Street_hail__Dispatch__Unknown.f5add8f4c9
[0m04:49:59.705744 [info ] [Thread-1  ]: 4 of 34 START test accepted_values_dim_triptype_trip_name__Street_hail__Dispatch__Unknown  [RUN]
[0m04:49:59.706884 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.accepted_values_dim_time_weekday__Sunday__Monday__Tuesday__Wednesday__Thursday__Friday__Saturday.87b4c2a366, now test.nyc_taxi.accepted_values_dim_triptype_trip_name__Street_hail__Dispatch__Unknown.f5add8f4c9)
[0m04:49:59.707899 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.accepted_values_dim_triptype_trip_name__Street_hail__Dispatch__Unknown.f5add8f4c9
[0m04:49:59.715859 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.accepted_values_dim_triptype_trip_name__Street_hail__Dispatch__Unknown.f5add8f4c9"
[0m04:49:59.722224 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.accepted_values_dim_triptype_trip_name__Street_hail__Dispatch__Unknown.f5add8f4c9
[0m04:49:59.728770 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.accepted_values_dim_triptype_trip_name__Street_hail__Dispatch__Unknown.f5add8f4c9"
[0m04:49:59.735522 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m04:49:59.739290 [debug] [Thread-1  ]: On test.nyc_taxi.accepted_values_dim_triptype_trip_name__Street_hail__Dispatch__Unknown.f5add8f4c9: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.accepted_values_dim_triptype_trip_name__Street_hail__Dispatch__Unknown.f5add8f4c9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        trip_name as value_field,
        count(*) as n_records

    from `northern-shield-437204-m0`.`nyc_taxi`.`dim_triptype`
    group by trip_name

)

select *
from all_values
where value_field not in (
    'Street-hail','Dispatch','Unknown'
)



      
    ) dbt_internal_test
[0m04:50:00.564196 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:fcd1923e-43b6-4729-b403-664acba7f908&page=queryresults
[0m04:50:01.535771 [info ] [Thread-1  ]: 4 of 34 PASS accepted_values_dim_triptype_trip_name__Street_hail__Dispatch__Unknown  [[32mPASS[0m in 1.83s]
[0m04:50:01.537781 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.accepted_values_dim_triptype_trip_name__Street_hail__Dispatch__Unknown.f5add8f4c9
[0m04:50:01.539682 [debug] [Thread-1  ]: Began running node test.nyc_taxi.accepted_values_dim_vendor_vendor_name__Creative_Mobile_Technologies__VeriFone_Inc_.7481cecf07
[0m04:50:01.540956 [info ] [Thread-1  ]: 5 of 34 START test accepted_values_dim_vendor_vendor_name__Creative_Mobile_Technologies__VeriFone_Inc_  [RUN]
[0m04:50:01.542139 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.accepted_values_dim_triptype_trip_name__Street_hail__Dispatch__Unknown.f5add8f4c9, now test.nyc_taxi.accepted_values_dim_vendor_vendor_name__Creative_Mobile_Technologies__VeriFone_Inc_.7481cecf07)
[0m04:50:01.543196 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.accepted_values_dim_vendor_vendor_name__Creative_Mobile_Technologies__VeriFone_Inc_.7481cecf07
[0m04:50:01.551832 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.accepted_values_dim_vendor_vendor_name__Creative_Mobile_Technologies__VeriFone_Inc_.7481cecf07"
[0m04:50:01.557335 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.accepted_values_dim_vendor_vendor_name__Creative_Mobile_Technologies__VeriFone_Inc_.7481cecf07
[0m04:50:01.562681 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.accepted_values_dim_vendor_vendor_name__Creative_Mobile_Technologies__VeriFone_Inc_.7481cecf07"
[0m04:50:01.569094 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m04:50:01.572704 [debug] [Thread-1  ]: On test.nyc_taxi.accepted_values_dim_vendor_vendor_name__Creative_Mobile_Technologies__VeriFone_Inc_.7481cecf07: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.accepted_values_dim_vendor_vendor_name__Creative_Mobile_Technologies__VeriFone_Inc_.7481cecf07"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        vendor_name as value_field,
        count(*) as n_records

    from `northern-shield-437204-m0`.`nyc_taxi`.`dim_vendor`
    group by vendor_name

)

select *
from all_values
where value_field not in (
    'Creative Mobile Technologies','VeriFone Inc.'
)



      
    ) dbt_internal_test
[0m04:50:02.370839 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:349e4ea7-4875-4b7e-9301-12d68391b5d4&page=queryresults
[0m04:50:03.354140 [info ] [Thread-1  ]: 5 of 34 PASS accepted_values_dim_vendor_vendor_name__Creative_Mobile_Technologies__VeriFone_Inc_  [[32mPASS[0m in 1.81s]
[0m04:50:03.356478 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.accepted_values_dim_vendor_vendor_name__Creative_Mobile_Technologies__VeriFone_Inc_.7481cecf07
[0m04:50:03.358070 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_dim_payment_type_id.96dfa722aa
[0m04:50:03.359314 [info ] [Thread-1  ]: 6 of 34 START test not_null_dim_payment_type_id ................................ [RUN]
[0m04:50:03.360734 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.accepted_values_dim_vendor_vendor_name__Creative_Mobile_Technologies__VeriFone_Inc_.7481cecf07, now test.nyc_taxi.not_null_dim_payment_type_id.96dfa722aa)
[0m04:50:03.362138 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_dim_payment_type_id.96dfa722aa
[0m04:50:03.376322 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_dim_payment_type_id.96dfa722aa"
[0m04:50:03.383581 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_dim_payment_type_id.96dfa722aa
[0m04:50:03.389273 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_dim_payment_type_id.96dfa722aa"
[0m04:50:03.395767 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m04:50:03.399643 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_dim_payment_type_id.96dfa722aa: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_dim_payment_type_id.96dfa722aa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select type_id
from `northern-shield-437204-m0`.`nyc_taxi`.`dim_payment`
where type_id is null



      
    ) dbt_internal_test
[0m04:50:04.108970 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:37ec7046-eda6-45d8-a79e-8dd81a02b841&page=queryresults
[0m04:50:05.063920 [info ] [Thread-1  ]: 6 of 34 PASS not_null_dim_payment_type_id ...................................... [[32mPASS[0m in 1.70s]
[0m04:50:05.066917 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_dim_payment_type_id.96dfa722aa
[0m04:50:05.068732 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_dim_time_date.2080f42875
[0m04:50:05.070237 [info ] [Thread-1  ]: 7 of 34 START test not_null_dim_time_date ...................................... [RUN]
[0m04:50:05.071857 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_dim_payment_type_id.96dfa722aa, now test.nyc_taxi.not_null_dim_time_date.2080f42875)
[0m04:50:05.073870 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_dim_time_date.2080f42875
[0m04:50:05.087714 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_dim_time_date.2080f42875"
[0m04:50:05.095959 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_dim_time_date.2080f42875
[0m04:50:05.102887 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_dim_time_date.2080f42875"
[0m04:50:05.110840 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m04:50:05.114597 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_dim_time_date.2080f42875: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_dim_time_date.2080f42875"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from `northern-shield-437204-m0`.`nyc_taxi`.`dim_time`
where date is null



      
    ) dbt_internal_test
[0m04:50:05.830895 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:24edbfe9-8c72-43c5-848b-954a0f9479f9&page=queryresults
[0m04:50:06.801172 [info ] [Thread-1  ]: 7 of 34 PASS not_null_dim_time_date ............................................ [[32mPASS[0m in 1.73s]
[0m04:50:06.803309 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_dim_time_date.2080f42875
[0m04:50:06.805082 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_dim_time_date_part.59e6206332
[0m04:50:06.806375 [info ] [Thread-1  ]: 8 of 34 START test not_null_dim_time_date_part ................................. [RUN]
[0m04:50:06.807755 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_dim_time_date.2080f42875, now test.nyc_taxi.not_null_dim_time_date_part.59e6206332)
[0m04:50:06.808997 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_dim_time_date_part.59e6206332
[0m04:50:06.816160 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_dim_time_date_part.59e6206332"
[0m04:50:06.822620 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_dim_time_date_part.59e6206332
[0m04:50:06.827264 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_dim_time_date_part.59e6206332"
[0m04:50:06.832743 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m04:50:06.836131 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_dim_time_date_part.59e6206332: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_dim_time_date_part.59e6206332"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date_part
from `northern-shield-437204-m0`.`nyc_taxi`.`dim_time`
where date_part is null



      
    ) dbt_internal_test
[0m04:50:07.562318 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:43702656-54d0-45f7-8c5b-c65059a4d89a&page=queryresults
[0m04:50:08.497807 [info ] [Thread-1  ]: 8 of 34 PASS not_null_dim_time_date_part ....................................... [[32mPASS[0m in 1.69s]
[0m04:50:08.499948 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_dim_time_date_part.59e6206332
[0m04:50:08.501658 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_dim_time_day.dc0e917166
[0m04:50:08.503104 [info ] [Thread-1  ]: 9 of 34 START test not_null_dim_time_day ....................................... [RUN]
[0m04:50:08.504915 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_dim_time_date_part.59e6206332, now test.nyc_taxi.not_null_dim_time_day.dc0e917166)
[0m04:50:08.506259 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_dim_time_day.dc0e917166
[0m04:50:08.513541 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_dim_time_day.dc0e917166"
[0m04:50:08.519359 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_dim_time_day.dc0e917166
[0m04:50:08.526557 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_dim_time_day.dc0e917166"
[0m04:50:08.532487 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m04:50:08.536645 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_dim_time_day.dc0e917166: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_dim_time_day.dc0e917166"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select day
from `northern-shield-437204-m0`.`nyc_taxi`.`dim_time`
where day is null



      
    ) dbt_internal_test
[0m04:50:09.281402 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:6916064c-5cb7-4539-9686-e3cc301d6d02&page=queryresults
[0m04:50:10.280351 [info ] [Thread-1  ]: 9 of 34 PASS not_null_dim_time_day ............................................. [[32mPASS[0m in 1.78s]
[0m04:50:10.282472 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_dim_time_day.dc0e917166
[0m04:50:10.284114 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_dim_time_hour.5b8ccd8f25
[0m04:50:10.285306 [info ] [Thread-1  ]: 10 of 34 START test not_null_dim_time_hour ..................................... [RUN]
[0m04:50:10.286638 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_dim_time_day.dc0e917166, now test.nyc_taxi.not_null_dim_time_hour.5b8ccd8f25)
[0m04:50:10.287941 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_dim_time_hour.5b8ccd8f25
[0m04:50:10.295372 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_dim_time_hour.5b8ccd8f25"
[0m04:50:10.301272 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_dim_time_hour.5b8ccd8f25
[0m04:50:10.305651 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_dim_time_hour.5b8ccd8f25"
[0m04:50:10.310967 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m04:50:10.314831 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_dim_time_hour.5b8ccd8f25: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_dim_time_hour.5b8ccd8f25"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select hour
from `northern-shield-437204-m0`.`nyc_taxi`.`dim_time`
where hour is null



      
    ) dbt_internal_test
[0m04:50:10.995650 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:f4adc39b-c8e3-41a9-a36f-7dca7c125598&page=queryresults
[0m04:50:11.991724 [info ] [Thread-1  ]: 10 of 34 PASS not_null_dim_time_hour ........................................... [[32mPASS[0m in 1.71s]
[0m04:50:11.993535 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_dim_time_hour.5b8ccd8f25
[0m04:50:11.994947 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_dim_time_minute.23e906ca61
[0m04:50:11.995958 [info ] [Thread-1  ]: 11 of 34 START test not_null_dim_time_minute ................................... [RUN]
[0m04:50:11.997102 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_dim_time_hour.5b8ccd8f25, now test.nyc_taxi.not_null_dim_time_minute.23e906ca61)
[0m04:50:11.997977 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_dim_time_minute.23e906ca61
[0m04:50:12.004357 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_dim_time_minute.23e906ca61"
[0m04:50:12.010871 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_dim_time_minute.23e906ca61
[0m04:50:12.015503 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_dim_time_minute.23e906ca61"
[0m04:50:12.021719 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m04:50:12.026431 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_dim_time_minute.23e906ca61: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_dim_time_minute.23e906ca61"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select minute
from `northern-shield-437204-m0`.`nyc_taxi`.`dim_time`
where minute is null



      
    ) dbt_internal_test
[0m04:50:12.719448 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:933132fd-782a-46a4-a1ba-bd9b08556743&page=queryresults
[0m04:50:13.658773 [info ] [Thread-1  ]: 11 of 34 PASS not_null_dim_time_minute ......................................... [[32mPASS[0m in 1.66s]
[0m04:50:13.660669 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_dim_time_minute.23e906ca61
[0m04:50:13.664090 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_dim_time_month.9f6ecf2eb5
[0m04:50:13.665150 [info ] [Thread-1  ]: 12 of 34 START test not_null_dim_time_month .................................... [RUN]
[0m04:50:13.666324 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_dim_time_minute.23e906ca61, now test.nyc_taxi.not_null_dim_time_month.9f6ecf2eb5)
[0m04:50:13.667440 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_dim_time_month.9f6ecf2eb5
[0m04:50:13.673872 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_dim_time_month.9f6ecf2eb5"
[0m04:50:13.679820 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_dim_time_month.9f6ecf2eb5
[0m04:50:13.684781 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_dim_time_month.9f6ecf2eb5"
[0m04:50:13.688668 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m04:50:13.692183 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_dim_time_month.9f6ecf2eb5: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_dim_time_month.9f6ecf2eb5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select month
from `northern-shield-437204-m0`.`nyc_taxi`.`dim_time`
where month is null



      
    ) dbt_internal_test
[0m04:50:14.350445 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:5767569c-e83b-489b-bfbb-8420c476740d&page=queryresults
[0m04:50:15.295757 [info ] [Thread-1  ]: 12 of 34 PASS not_null_dim_time_month .......................................... [[32mPASS[0m in 1.63s]
[0m04:50:15.297653 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_dim_time_month.9f6ecf2eb5
[0m04:50:15.299361 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_dim_time_year.6fb9595d53
[0m04:50:15.300497 [info ] [Thread-1  ]: 13 of 34 START test not_null_dim_time_year ..................................... [RUN]
[0m04:50:15.301683 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_dim_time_month.9f6ecf2eb5, now test.nyc_taxi.not_null_dim_time_year.6fb9595d53)
[0m04:50:15.302823 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_dim_time_year.6fb9595d53
[0m04:50:15.309676 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_dim_time_year.6fb9595d53"
[0m04:50:15.315170 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_dim_time_year.6fb9595d53
[0m04:50:15.320294 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_dim_time_year.6fb9595d53"
[0m04:50:15.326541 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m04:50:15.330395 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_dim_time_year.6fb9595d53: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_dim_time_year.6fb9595d53"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select year
from `northern-shield-437204-m0`.`nyc_taxi`.`dim_time`
where year is null



      
    ) dbt_internal_test
[0m04:50:16.009169 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:d89b535e-d710-4813-a80f-5ed373fe628a&page=queryresults
[0m04:50:16.937225 [info ] [Thread-1  ]: 13 of 34 PASS not_null_dim_time_year ........................................... [[32mPASS[0m in 1.64s]
[0m04:50:16.939570 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_dim_time_year.6fb9595d53
[0m04:50:16.941440 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_dim_zone_borough.1ed2272c52
[0m04:50:16.942849 [info ] [Thread-1  ]: 14 of 34 START test not_null_dim_zone_borough .................................. [RUN]
[0m04:50:16.944286 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_dim_time_year.6fb9595d53, now test.nyc_taxi.not_null_dim_zone_borough.1ed2272c52)
[0m04:50:16.945476 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_dim_zone_borough.1ed2272c52
[0m04:50:16.955367 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_dim_zone_borough.1ed2272c52"
[0m04:50:16.960908 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_dim_zone_borough.1ed2272c52
[0m04:50:16.965396 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_dim_zone_borough.1ed2272c52"
[0m04:50:16.972382 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m04:50:16.976118 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_dim_zone_borough.1ed2272c52: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_dim_zone_borough.1ed2272c52"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select borough
from `northern-shield-437204-m0`.`nyc_taxi`.`dim_zone`
where borough is null



      
    ) dbt_internal_test
[0m04:50:17.778683 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:c4ddf5f3-70bb-4e2e-ae6b-a02ad3624eb1&page=queryresults
[0m04:50:18.717921 [info ] [Thread-1  ]: 14 of 34 PASS not_null_dim_zone_borough ........................................ [[32mPASS[0m in 1.77s]
[0m04:50:18.720195 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_dim_zone_borough.1ed2272c52
[0m04:50:18.721786 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_dim_zone_service_zone.2007f611c5
[0m04:50:18.722956 [info ] [Thread-1  ]: 15 of 34 START test not_null_dim_zone_service_zone ............................. [RUN]
[0m04:50:18.724282 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_dim_zone_borough.1ed2272c52, now test.nyc_taxi.not_null_dim_zone_service_zone.2007f611c5)
[0m04:50:18.725465 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_dim_zone_service_zone.2007f611c5
[0m04:50:18.733237 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_dim_zone_service_zone.2007f611c5"
[0m04:50:18.739900 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_dim_zone_service_zone.2007f611c5
[0m04:50:18.744541 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_dim_zone_service_zone.2007f611c5"
[0m04:50:18.751594 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m04:50:18.755147 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_dim_zone_service_zone.2007f611c5: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_dim_zone_service_zone.2007f611c5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select service_zone
from `northern-shield-437204-m0`.`nyc_taxi`.`dim_zone`
where service_zone is null



      
    ) dbt_internal_test
[0m04:50:19.463099 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:0c5b222f-4a78-4f6e-abb4-b3c1f9a68e97&page=queryresults
[0m04:50:20.438243 [info ] [Thread-1  ]: 15 of 34 PASS not_null_dim_zone_service_zone ................................... [[32mPASS[0m in 1.71s]
[0m04:50:20.440513 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_dim_zone_service_zone.2007f611c5
[0m04:50:20.441840 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_dim_zone_zone.a1c4a4c37a
[0m04:50:20.443051 [info ] [Thread-1  ]: 16 of 34 START test not_null_dim_zone_zone ..................................... [RUN]
[0m04:50:20.444406 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_dim_zone_service_zone.2007f611c5, now test.nyc_taxi.not_null_dim_zone_zone.a1c4a4c37a)
[0m04:50:20.445457 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_dim_zone_zone.a1c4a4c37a
[0m04:50:20.452197 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_dim_zone_zone.a1c4a4c37a"
[0m04:50:20.460090 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_dim_zone_zone.a1c4a4c37a
[0m04:50:20.465972 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_dim_zone_zone.a1c4a4c37a"
[0m04:50:20.474554 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m04:50:20.479279 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_dim_zone_zone.a1c4a4c37a: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_dim_zone_zone.a1c4a4c37a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select zone
from `northern-shield-437204-m0`.`nyc_taxi`.`dim_zone`
where zone is null



      
    ) dbt_internal_test
[0m04:50:21.193624 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:fb5b6f8e-0fc2-4c55-aa03-2aa86fa8438d&page=queryresults
[0m04:50:22.130240 [info ] [Thread-1  ]: 16 of 34 PASS not_null_dim_zone_zone ........................................... [[32mPASS[0m in 1.69s]
[0m04:50:22.132338 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_dim_zone_zone.a1c4a4c37a
[0m04:50:22.136667 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_do_location_id.6acdd302a6
[0m04:50:22.138364 [info ] [Thread-1  ]: 17 of 34 START test not_null_fct_trips_do_location_id .......................... [RUN]
[0m04:50:22.140142 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_dim_zone_zone.a1c4a4c37a, now test.nyc_taxi.not_null_fct_trips_do_location_id.6acdd302a6)
[0m04:50:22.141585 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_do_location_id.6acdd302a6
[0m04:50:22.149302 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_do_location_id.6acdd302a6"
[0m04:50:22.157370 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_do_location_id.6acdd302a6
[0m04:50:22.163016 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_fct_trips_do_location_id.6acdd302a6"
[0m04:50:22.170301 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m04:50:22.174775 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_fct_trips_do_location_id.6acdd302a6: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_fct_trips_do_location_id.6acdd302a6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select do_location_id
from `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips`
where do_location_id is null



      
    ) dbt_internal_test
[0m04:50:22.930043 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:2b31653e-8845-4a2c-a88b-272ad9429959&page=queryresults
[0m04:50:23.900814 [info ] [Thread-1  ]: 17 of 34 PASS not_null_fct_trips_do_location_id ................................ [[32mPASS[0m in 1.76s]
[0m04:50:23.902818 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_do_location_id.6acdd302a6
[0m04:50:23.904239 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_dropoff_time_id.781496e98f
[0m04:50:23.905274 [info ] [Thread-1  ]: 18 of 34 START test not_null_fct_trips_dropoff_time_id ......................... [RUN]
[0m04:50:23.906519 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_do_location_id.6acdd302a6, now test.nyc_taxi.not_null_fct_trips_dropoff_time_id.781496e98f)
[0m04:50:23.907524 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_dropoff_time_id.781496e98f
[0m04:50:23.913679 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_dropoff_time_id.781496e98f"
[0m04:50:23.920030 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_dropoff_time_id.781496e98f
[0m04:50:23.924811 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_fct_trips_dropoff_time_id.781496e98f"
[0m04:50:23.931316 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m04:50:23.935770 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_fct_trips_dropoff_time_id.781496e98f: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_fct_trips_dropoff_time_id.781496e98f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select dropoff_time_id
from `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips`
where dropoff_time_id is null



      
    ) dbt_internal_test
[0m04:50:24.745015 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:a3a8e9c7-69b8-4095-b900-f0df1193ce7d&page=queryresults
[0m04:50:25.681381 [info ] [Thread-1  ]: 18 of 34 PASS not_null_fct_trips_dropoff_time_id ............................... [[32mPASS[0m in 1.77s]
[0m04:50:25.683378 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_dropoff_time_id.781496e98f
[0m04:50:25.684893 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_extra.1801055bb3
[0m04:50:25.686080 [info ] [Thread-1  ]: 19 of 34 START test not_null_fct_trips_extra ................................... [RUN]
[0m04:50:25.687304 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_dropoff_time_id.781496e98f, now test.nyc_taxi.not_null_fct_trips_extra.1801055bb3)
[0m04:50:25.688407 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_extra.1801055bb3
[0m04:50:25.696598 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_extra.1801055bb3"
[0m04:50:25.703222 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_extra.1801055bb3
[0m04:50:25.708084 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_fct_trips_extra.1801055bb3"
[0m04:50:25.714353 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m04:50:25.718268 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_fct_trips_extra.1801055bb3: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_fct_trips_extra.1801055bb3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select extra
from `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips`
where extra is null



      
    ) dbt_internal_test
[0m04:50:26.442449 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:be99d65a-3662-4d51-9c35-63d6a526149b&page=queryresults
[0m04:50:27.407498 [info ] [Thread-1  ]: 19 of 34 PASS not_null_fct_trips_extra ......................................... [[32mPASS[0m in 1.72s]
[0m04:50:27.409534 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_extra.1801055bb3
[0m04:50:27.410862 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_improvement_surcharge.4cf28d1443
[0m04:50:27.412034 [info ] [Thread-1  ]: 20 of 34 START test not_null_fct_trips_improvement_surcharge ................... [RUN]
[0m04:50:27.413371 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_extra.1801055bb3, now test.nyc_taxi.not_null_fct_trips_improvement_surcharge.4cf28d1443)
[0m04:50:27.414487 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_improvement_surcharge.4cf28d1443
[0m04:50:27.422469 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_improvement_surcharge.4cf28d1443"
[0m04:50:27.427487 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_improvement_surcharge.4cf28d1443
[0m04:50:27.432832 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_fct_trips_improvement_surcharge.4cf28d1443"
[0m04:50:27.437701 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m04:50:27.440633 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_fct_trips_improvement_surcharge.4cf28d1443: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_fct_trips_improvement_surcharge.4cf28d1443"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select improvement_surcharge
from `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips`
where improvement_surcharge is null



      
    ) dbt_internal_test
[0m04:50:28.352978 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:aa83f464-b5a4-461a-b2db-588025c4487b&page=queryresults
[0m04:50:29.297180 [info ] [Thread-1  ]: 20 of 34 PASS not_null_fct_trips_improvement_surcharge ......................... [[32mPASS[0m in 1.88s]
[0m04:50:29.299458 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_improvement_surcharge.4cf28d1443
[0m04:50:29.300945 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_passenger_count.b1370cab1c
[0m04:50:29.302103 [info ] [Thread-1  ]: 21 of 34 START test not_null_fct_trips_passenger_count ......................... [RUN]
[0m04:50:29.303480 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_improvement_surcharge.4cf28d1443, now test.nyc_taxi.not_null_fct_trips_passenger_count.b1370cab1c)
[0m04:50:29.304996 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_passenger_count.b1370cab1c
[0m04:50:29.312714 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_passenger_count.b1370cab1c"
[0m04:50:29.317382 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_passenger_count.b1370cab1c
[0m04:50:29.322314 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_fct_trips_passenger_count.b1370cab1c"
[0m04:50:29.327468 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m04:50:29.330717 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_fct_trips_passenger_count.b1370cab1c: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_fct_trips_passenger_count.b1370cab1c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select passenger_count
from `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips`
where passenger_count is null



      
    ) dbt_internal_test
[0m04:50:30.264859 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:261c7e59-6440-424d-a32b-e20c8aea0494&page=queryresults
[0m04:50:31.233684 [info ] [Thread-1  ]: 21 of 34 PASS not_null_fct_trips_passenger_count ............................... [[32mPASS[0m in 1.93s]
[0m04:50:31.236056 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_passenger_count.b1370cab1c
[0m04:50:31.237565 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_payment_type.93889b679a
[0m04:50:31.238818 [info ] [Thread-1  ]: 22 of 34 START test not_null_fct_trips_payment_type ............................ [RUN]
[0m04:50:31.240242 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_passenger_count.b1370cab1c, now test.nyc_taxi.not_null_fct_trips_payment_type.93889b679a)
[0m04:50:31.241590 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_payment_type.93889b679a
[0m04:50:31.249874 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_payment_type.93889b679a"
[0m04:50:31.256718 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_payment_type.93889b679a
[0m04:50:31.261697 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_fct_trips_payment_type.93889b679a"
[0m04:50:31.267526 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m04:50:31.272120 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_fct_trips_payment_type.93889b679a: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_fct_trips_payment_type.93889b679a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select payment_type
from `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips`
where payment_type is null



      
    ) dbt_internal_test
[0m04:50:31.961079 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:4b5972d7-0bef-4d18-ab6f-557dfaabac95&page=queryresults
[0m04:50:32.944901 [info ] [Thread-1  ]: 22 of 34 PASS not_null_fct_trips_payment_type .................................. [[32mPASS[0m in 1.70s]
[0m04:50:32.946906 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_payment_type.93889b679a
[0m04:50:32.948515 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_pickup_time_id.f31fbe0eeb
[0m04:50:32.949727 [info ] [Thread-1  ]: 23 of 34 START test not_null_fct_trips_pickup_time_id .......................... [RUN]
[0m04:50:32.951378 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_payment_type.93889b679a, now test.nyc_taxi.not_null_fct_trips_pickup_time_id.f31fbe0eeb)
[0m04:50:32.952957 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_pickup_time_id.f31fbe0eeb
[0m04:50:32.960456 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_pickup_time_id.f31fbe0eeb"
[0m04:50:32.966964 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_pickup_time_id.f31fbe0eeb
[0m04:50:32.972952 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_fct_trips_pickup_time_id.f31fbe0eeb"
[0m04:50:32.986333 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m04:50:32.990295 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_fct_trips_pickup_time_id.f31fbe0eeb: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_fct_trips_pickup_time_id.f31fbe0eeb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select pickup_time_id
from `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips`
where pickup_time_id is null



      
    ) dbt_internal_test
[0m04:50:33.729308 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:38a9fe7c-9f1b-4382-9b3c-22e38d7a5837&page=queryresults
[0m04:50:34.693665 [info ] [Thread-1  ]: 23 of 34 PASS not_null_fct_trips_pickup_time_id ................................ [[32mPASS[0m in 1.74s]
[0m04:50:34.695748 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_pickup_time_id.f31fbe0eeb
[0m04:50:34.697118 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_pu_location_id.b0dc8dd185
[0m04:50:34.698102 [info ] [Thread-1  ]: 24 of 34 START test not_null_fct_trips_pu_location_id .......................... [RUN]
[0m04:50:34.699220 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_pickup_time_id.f31fbe0eeb, now test.nyc_taxi.not_null_fct_trips_pu_location_id.b0dc8dd185)
[0m04:50:34.700112 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_pu_location_id.b0dc8dd185
[0m04:50:34.708864 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_pu_location_id.b0dc8dd185"
[0m04:50:34.715394 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_pu_location_id.b0dc8dd185
[0m04:50:34.720197 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_fct_trips_pu_location_id.b0dc8dd185"
[0m04:50:34.725956 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m04:50:34.734129 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_fct_trips_pu_location_id.b0dc8dd185: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_fct_trips_pu_location_id.b0dc8dd185"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select pu_location_id
from `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips`
where pu_location_id is null



      
    ) dbt_internal_test
[0m04:50:35.541352 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:1e364009-140b-447c-8fac-869d3f341da1&page=queryresults
[0m04:50:36.453689 [info ] [Thread-1  ]: 24 of 34 PASS not_null_fct_trips_pu_location_id ................................ [[32mPASS[0m in 1.75s]
[0m04:50:36.455516 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_pu_location_id.b0dc8dd185
[0m04:50:36.456955 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_rate_code_id.ba0047eaae
[0m04:50:36.458119 [info ] [Thread-1  ]: 25 of 34 START test not_null_fct_trips_rate_code_id ............................ [RUN]
[0m04:50:36.459368 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_pu_location_id.b0dc8dd185, now test.nyc_taxi.not_null_fct_trips_rate_code_id.ba0047eaae)
[0m04:50:36.460444 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_rate_code_id.ba0047eaae
[0m04:50:36.468350 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_rate_code_id.ba0047eaae"
[0m04:50:36.474051 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_rate_code_id.ba0047eaae
[0m04:50:36.478843 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_fct_trips_rate_code_id.ba0047eaae"
[0m04:50:36.485757 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m04:50:36.489427 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_fct_trips_rate_code_id.ba0047eaae: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_fct_trips_rate_code_id.ba0047eaae"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select rate_code_id
from `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips`
where rate_code_id is null



      
    ) dbt_internal_test
[0m04:50:37.218292 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:bdfe0749-c1ed-48e0-8829-70821b56d57c&page=queryresults
[0m04:50:38.195366 [info ] [Thread-1  ]: 25 of 34 PASS not_null_fct_trips_rate_code_id .................................. [[32mPASS[0m in 1.74s]
[0m04:50:38.197854 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_rate_code_id.ba0047eaae
[0m04:50:38.199458 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_trip_distance.19cd17f1df
[0m04:50:38.200755 [info ] [Thread-1  ]: 26 of 34 START test not_null_fct_trips_trip_distance ........................... [RUN]
[0m04:50:38.202124 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_rate_code_id.ba0047eaae, now test.nyc_taxi.not_null_fct_trips_trip_distance.19cd17f1df)
[0m04:50:38.203386 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_trip_distance.19cd17f1df
[0m04:50:38.211011 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_trip_distance.19cd17f1df"
[0m04:50:38.217508 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_trip_distance.19cd17f1df
[0m04:50:38.222388 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_fct_trips_trip_distance.19cd17f1df"
[0m04:50:38.228229 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m04:50:38.232880 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_fct_trips_trip_distance.19cd17f1df: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_fct_trips_trip_distance.19cd17f1df"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select trip_distance
from `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips`
where trip_distance is null



      
    ) dbt_internal_test
[0m04:50:38.967834 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:ced3fbde-aa7c-4bfc-bf3c-fae14c59ccae&page=queryresults
[0m04:50:39.934521 [info ] [Thread-1  ]: 26 of 34 PASS not_null_fct_trips_trip_distance ................................. [[32mPASS[0m in 1.73s]
[0m04:50:39.936730 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_trip_distance.19cd17f1df
[0m04:50:39.938124 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_vendor_id.b9b2f380bb
[0m04:50:39.939342 [info ] [Thread-1  ]: 27 of 34 START test not_null_fct_trips_vendor_id ............................... [RUN]
[0m04:50:39.940966 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_trip_distance.19cd17f1df, now test.nyc_taxi.not_null_fct_trips_vendor_id.b9b2f380bb)
[0m04:50:39.942122 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_vendor_id.b9b2f380bb
[0m04:50:39.949495 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_vendor_id.b9b2f380bb"
[0m04:50:39.954581 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_vendor_id.b9b2f380bb
[0m04:50:39.959615 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.not_null_fct_trips_vendor_id.b9b2f380bb"
[0m04:50:39.965678 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m04:50:39.968910 [debug] [Thread-1  ]: On test.nyc_taxi.not_null_fct_trips_vendor_id.b9b2f380bb: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.not_null_fct_trips_vendor_id.b9b2f380bb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select vendor_id
from `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips`
where vendor_id is null



      
    ) dbt_internal_test
[0m04:50:40.676011 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:0c09c559-0dc4-4c2f-909b-e665329e215d&page=queryresults
[0m04:50:41.643599 [info ] [Thread-1  ]: 27 of 34 PASS not_null_fct_trips_vendor_id ..................................... [[32mPASS[0m in 1.70s]
[0m04:50:41.645736 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_vendor_id.b9b2f380bb
[0m04:50:41.647305 [debug] [Thread-1  ]: Began running node test.nyc_taxi.unique_dim_payment_type_id.dea55de04e
[0m04:50:41.648583 [info ] [Thread-1  ]: 28 of 34 START test unique_dim_payment_type_id ................................. [RUN]
[0m04:50:41.650153 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_vendor_id.b9b2f380bb, now test.nyc_taxi.unique_dim_payment_type_id.dea55de04e)
[0m04:50:41.651500 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.unique_dim_payment_type_id.dea55de04e
[0m04:50:41.661203 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.unique_dim_payment_type_id.dea55de04e"
[0m04:50:41.667987 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.unique_dim_payment_type_id.dea55de04e
[0m04:50:41.672957 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.unique_dim_payment_type_id.dea55de04e"
[0m04:50:41.678491 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m04:50:41.681616 [debug] [Thread-1  ]: On test.nyc_taxi.unique_dim_payment_type_id.dea55de04e: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.unique_dim_payment_type_id.dea55de04e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select type_id as unique_field
  from `northern-shield-437204-m0`.`nyc_taxi`.`dim_payment`
  where type_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m04:50:42.459155 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:5bbb8556-aeee-491c-9a39-132bb1369210&page=queryresults
[0m04:50:43.425687 [info ] [Thread-1  ]: 28 of 34 PASS unique_dim_payment_type_id ....................................... [[32mPASS[0m in 1.78s]
[0m04:50:43.427985 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.unique_dim_payment_type_id.dea55de04e
[0m04:50:43.429486 [debug] [Thread-1  ]: Began running node test.nyc_taxi.unique_dim_ratecode_rate_id.75ae8e4885
[0m04:50:43.430669 [info ] [Thread-1  ]: 29 of 34 START test unique_dim_ratecode_rate_id ................................ [RUN]
[0m04:50:43.432054 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.unique_dim_payment_type_id.dea55de04e, now test.nyc_taxi.unique_dim_ratecode_rate_id.75ae8e4885)
[0m04:50:43.433266 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.unique_dim_ratecode_rate_id.75ae8e4885
[0m04:50:43.444473 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.unique_dim_ratecode_rate_id.75ae8e4885"
[0m04:50:43.450990 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.unique_dim_ratecode_rate_id.75ae8e4885
[0m04:50:43.457745 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.unique_dim_ratecode_rate_id.75ae8e4885"
[0m04:50:43.466107 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m04:50:43.469912 [debug] [Thread-1  ]: On test.nyc_taxi.unique_dim_ratecode_rate_id.75ae8e4885: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.unique_dim_ratecode_rate_id.75ae8e4885"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select rate_id as unique_field
  from `northern-shield-437204-m0`.`nyc_taxi`.`dim_ratecode`
  where rate_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m04:50:44.222455 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:f1e97a62-9611-4c48-9598-dbe4afed1e20&page=queryresults
[0m04:50:45.156930 [info ] [Thread-1  ]: 29 of 34 PASS unique_dim_ratecode_rate_id ...................................... [[32mPASS[0m in 1.72s]
[0m04:50:45.159008 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.unique_dim_ratecode_rate_id.75ae8e4885
[0m04:50:45.160494 [debug] [Thread-1  ]: Began running node test.nyc_taxi.unique_dim_time_time_id.0752c025e8
[0m04:50:45.161793 [info ] [Thread-1  ]: 30 of 34 START test unique_dim_time_time_id .................................... [RUN]
[0m04:50:45.163251 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.unique_dim_ratecode_rate_id.75ae8e4885, now test.nyc_taxi.unique_dim_time_time_id.0752c025e8)
[0m04:50:45.164375 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.unique_dim_time_time_id.0752c025e8
[0m04:50:45.172071 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.unique_dim_time_time_id.0752c025e8"
[0m04:50:45.177999 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.unique_dim_time_time_id.0752c025e8
[0m04:50:45.182708 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.unique_dim_time_time_id.0752c025e8"
[0m04:50:45.188749 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m04:50:45.192696 [debug] [Thread-1  ]: On test.nyc_taxi.unique_dim_time_time_id.0752c025e8: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.unique_dim_time_time_id.0752c025e8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select time_id as unique_field
  from `northern-shield-437204-m0`.`nyc_taxi`.`dim_time`
  where time_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m04:50:45.968706 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:59059144-6d07-42e3-b5f0-33d997da22fa&page=queryresults
[0m04:50:46.919199 [info ] [Thread-1  ]: 30 of 34 PASS unique_dim_time_time_id .......................................... [[32mPASS[0m in 1.76s]
[0m04:50:46.921430 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.unique_dim_time_time_id.0752c025e8
[0m04:50:46.922937 [debug] [Thread-1  ]: Began running node test.nyc_taxi.unique_dim_triptype_type_id.fbaf29d341
[0m04:50:46.924257 [info ] [Thread-1  ]: 31 of 34 START test unique_dim_triptype_type_id ................................ [RUN]
[0m04:50:46.925594 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.unique_dim_time_time_id.0752c025e8, now test.nyc_taxi.unique_dim_triptype_type_id.fbaf29d341)
[0m04:50:46.926858 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.unique_dim_triptype_type_id.fbaf29d341
[0m04:50:46.934360 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.unique_dim_triptype_type_id.fbaf29d341"
[0m04:50:46.940160 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.unique_dim_triptype_type_id.fbaf29d341
[0m04:50:46.944621 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.unique_dim_triptype_type_id.fbaf29d341"
[0m04:50:46.950037 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m04:50:46.953383 [debug] [Thread-1  ]: On test.nyc_taxi.unique_dim_triptype_type_id.fbaf29d341: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.unique_dim_triptype_type_id.fbaf29d341"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select type_id as unique_field
  from `northern-shield-437204-m0`.`nyc_taxi`.`dim_triptype`
  where type_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m04:50:47.700134 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:3dcf4a52-6be8-4629-aed7-80880d4dc5e2&page=queryresults
[0m04:50:48.669080 [info ] [Thread-1  ]: 31 of 34 PASS unique_dim_triptype_type_id ...................................... [[32mPASS[0m in 1.74s]
[0m04:50:48.671752 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.unique_dim_triptype_type_id.fbaf29d341
[0m04:50:48.676247 [debug] [Thread-1  ]: Began running node test.nyc_taxi.unique_dim_vendor_id.03fad38d04
[0m04:50:48.677621 [info ] [Thread-1  ]: 32 of 34 START test unique_dim_vendor_id ....................................... [RUN]
[0m04:50:48.679068 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.unique_dim_triptype_type_id.fbaf29d341, now test.nyc_taxi.unique_dim_vendor_id.03fad38d04)
[0m04:50:48.680318 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.unique_dim_vendor_id.03fad38d04
[0m04:50:48.689010 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.unique_dim_vendor_id.03fad38d04"
[0m04:50:48.696052 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.unique_dim_vendor_id.03fad38d04
[0m04:50:48.702140 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.unique_dim_vendor_id.03fad38d04"
[0m04:50:48.709088 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m04:50:48.714049 [debug] [Thread-1  ]: On test.nyc_taxi.unique_dim_vendor_id.03fad38d04: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.unique_dim_vendor_id.03fad38d04"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select id as unique_field
  from `northern-shield-437204-m0`.`nyc_taxi`.`dim_vendor`
  where id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m04:50:49.520381 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:db3c654d-ca3c-4278-9479-66d298e0dae0&page=queryresults
[0m04:50:50.455033 [info ] [Thread-1  ]: 32 of 34 PASS unique_dim_vendor_id ............................................. [[32mPASS[0m in 1.78s]
[0m04:50:50.457353 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.unique_dim_vendor_id.03fad38d04
[0m04:50:50.459033 [debug] [Thread-1  ]: Began running node test.nyc_taxi.unique_dim_zone_location_id.7702f92424
[0m04:50:50.460341 [info ] [Thread-1  ]: 33 of 34 START test unique_dim_zone_location_id ................................ [RUN]
[0m04:50:50.461714 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.unique_dim_vendor_id.03fad38d04, now test.nyc_taxi.unique_dim_zone_location_id.7702f92424)
[0m04:50:50.462964 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.unique_dim_zone_location_id.7702f92424
[0m04:50:50.470657 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.unique_dim_zone_location_id.7702f92424"
[0m04:50:50.477306 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.unique_dim_zone_location_id.7702f92424
[0m04:50:50.482487 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.unique_dim_zone_location_id.7702f92424"
[0m04:50:50.488274 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m04:50:50.491449 [debug] [Thread-1  ]: On test.nyc_taxi.unique_dim_zone_location_id.7702f92424: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.unique_dim_zone_location_id.7702f92424"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select location_id as unique_field
  from `northern-shield-437204-m0`.`nyc_taxi`.`dim_zone`
  where location_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m04:50:51.256003 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:d0f0ba50-377e-4d2e-b2cb-380633ffe849&page=queryresults
[0m04:50:52.191822 [info ] [Thread-1  ]: 33 of 34 PASS unique_dim_zone_location_id ...................................... [[32mPASS[0m in 1.73s]
[0m04:50:52.194121 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.unique_dim_zone_location_id.7702f92424
[0m04:50:52.195833 [debug] [Thread-1  ]: Began running node test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab
[0m04:50:52.197082 [info ] [Thread-1  ]: 34 of 34 START test unique_fct_trips_trip_id ................................... [RUN]
[0m04:50:52.198404 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.unique_dim_zone_location_id.7702f92424, now test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab)
[0m04:50:52.199639 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab
[0m04:50:52.209582 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab"
[0m04:50:52.215702 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab
[0m04:50:52.220221 [debug] [Thread-1  ]: Writing runtime sql for node "test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab"
[0m04:50:52.228496 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m04:50:52.232400 [debug] [Thread-1  ]: On test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select trip_id as unique_field
  from `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips`
  where trip_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m04:50:53.045915 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:60f31ab4-8ef0-45a7-8218-e2f32f3a6f0e&page=queryresults
[0m04:50:53.993639 [info ] [Thread-1  ]: 34 of 34 PASS unique_fct_trips_trip_id ......................................... [[32mPASS[0m in 1.80s]
[0m04:50:53.995719 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab
[0m04:50:53.998358 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:50:53.999396 [debug] [MainThread]: Connection 'test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab' was properly closed.
[0m04:50:54.000409 [info ] [MainThread]: 
[0m04:50:54.001511 [info ] [MainThread]: Finished running 34 data tests in 0 hours 1 minutes and 0.42 seconds (60.42s).
[0m04:50:54.016748 [debug] [MainThread]: Command end result
[0m04:50:54.098137 [info ] [MainThread]: 
[0m04:50:54.099491 [info ] [MainThread]: [32mCompleted successfully[0m
[0m04:50:54.100486 [info ] [MainThread]: 
[0m04:50:54.101591 [info ] [MainThread]: Done. PASS=34 WARN=0 ERROR=0 SKIP=0 TOTAL=34
[0m04:50:54.103336 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 62.692738, "process_in_blocks": "1440", "process_kernel_time": 0.357481, "process_mem_max_rss": "241476", "process_out_blocks": "0", "process_user_time": 7.190479}
[0m04:50:54.104625 [debug] [MainThread]: Command `dbt test` succeeded at 04:50:54.104415 after 62.69 seconds
[0m04:50:54.105635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa424373430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3eb1b5d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3eae2b700>]}
[0m04:50:54.106728 [debug] [MainThread]: Flushing usage events
[0m04:52:09.961198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b77a2f400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b75865b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b75865af0>]}


============================== 04:52:09.968643 | cc133aea-8981-43f5-af9b-26814e3c66a5 ==============================
[0m04:52:09.968643 [info ] [MainThread]: Running with dbt=1.8.9
[0m04:52:09.970109 [debug] [MainThread]: running dbt with arguments {'profiles_dir': '/opt/airflow/include/dbt', 'printer_width': '80', 'warn_error': 'None', 'fail_fast': 'False', 'cache_selected_only': 'False', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'use_colors': 'True', 'log_cache_events': 'False', 'log_path': '/opt/airflow/include/dbt/logs', 'write_json': 'True', 'introspect': 'True', 'quiet': 'False', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'debug': 'False', 'no_print': 'None', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'log_format': 'default', 'version_check': 'True', 'invocation_command': 'dbt docs generate'}
[0m04:52:11.087836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cc133aea-8981-43f5-af9b-26814e3c66a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b758c0640>]}
[0m04:52:11.149315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cc133aea-8981-43f5-af9b-26814e3c66a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b3e454910>]}
[0m04:52:11.151116 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m04:52:11.307145 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m04:52:11.977756 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m04:52:11.978691 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m04:52:12.043827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cc133aea-8981-43f5-af9b-26814e3c66a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b70bdcf10>]}
[0m04:52:12.070667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cc133aea-8981-43f5-af9b-26814e3c66a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b70bfda30>]}
[0m04:52:12.071904 [info ] [MainThread]: Found 7 models, 34 data tests, 2 sources, 600 macros
[0m04:52:12.072894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cc133aea-8981-43f5-af9b-26814e3c66a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b70bfda60>]}
[0m04:52:12.077027 [info ] [MainThread]: 
[0m04:52:12.078476 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m04:52:12.085518 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_northern-shield-437204-m0_nyc_taxi'
[0m04:52:12.086592 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:52:12.576310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cc133aea-8981-43f5-af9b-26814e3c66a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b77138c70>]}
[0m04:52:12.577535 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m04:52:12.578535 [info ] [MainThread]: 
[0m04:52:12.585892 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_payment
[0m04:52:12.587061 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_northern-shield-437204-m0_nyc_taxi, now model.nyc_taxi.dim_payment)
[0m04:52:12.702175 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_payment
[0m04:52:12.714553 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_payment"
[0m04:52:12.719665 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_payment
[0m04:52:12.721264 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_payment
[0m04:52:12.722383 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_ratecode
[0m04:52:12.723533 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_payment, now model.nyc_taxi.dim_ratecode)
[0m04:52:12.724567 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_ratecode
[0m04:52:12.729677 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_ratecode"
[0m04:52:12.735143 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_ratecode
[0m04:52:12.737038 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_ratecode
[0m04:52:12.738462 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_time
[0m04:52:12.739672 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_ratecode, now model.nyc_taxi.dim_time)
[0m04:52:12.740745 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_time
[0m04:52:12.746093 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_time"
[0m04:52:12.752022 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_time
[0m04:52:12.753692 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_time
[0m04:52:12.754755 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_triptype
[0m04:52:12.756080 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_time, now model.nyc_taxi.dim_triptype)
[0m04:52:12.757177 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_triptype
[0m04:52:12.761898 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_triptype"
[0m04:52:12.767432 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_triptype
[0m04:52:12.769017 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_triptype
[0m04:52:12.770113 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_vendor
[0m04:52:12.771296 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_triptype, now model.nyc_taxi.dim_vendor)
[0m04:52:12.772490 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_vendor
[0m04:52:12.777048 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_vendor"
[0m04:52:12.780513 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_vendor
[0m04:52:12.782324 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_vendor
[0m04:52:12.783459 [debug] [Thread-1  ]: Began running node model.nyc_taxi.dim_zone
[0m04:52:12.784644 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_vendor, now model.nyc_taxi.dim_zone)
[0m04:52:12.785603 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.dim_zone
[0m04:52:12.791911 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.dim_zone"
[0m04:52:12.795655 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.dim_zone
[0m04:52:12.797307 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.dim_zone
[0m04:52:12.798425 [debug] [Thread-1  ]: Began running node test.nyc_taxi.accepted_values_dim_payment_payment_name__Credit_card__Cash__No_charge__Dispute__Unknown__Voided_trip.58d00ef9f4
[0m04:52:12.799548 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.dim_zone, now test.nyc_taxi.accepted_values_dim_payment_payment_name__Credit_card__Cash__No_charge__Dispute__Unknown__Voided_trip.58d00ef9f4)
[0m04:52:12.800530 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.accepted_values_dim_payment_payment_name__Credit_card__Cash__No_charge__Dispute__Unknown__Voided_trip.58d00ef9f4
[0m04:52:12.818527 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.accepted_values_dim_payment_payment_name__Credit_card__Cash__No_charge__Dispute__Unknown__Voided_trip.58d00ef9f4"
[0m04:52:12.821782 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.accepted_values_dim_payment_payment_name__Credit_card__Cash__No_charge__Dispute__Unknown__Voided_trip.58d00ef9f4
[0m04:52:12.823505 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.accepted_values_dim_payment_payment_name__Credit_card__Cash__No_charge__Dispute__Unknown__Voided_trip.58d00ef9f4
[0m04:52:12.824684 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_dim_payment_type_id.96dfa722aa
[0m04:52:12.825809 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.accepted_values_dim_payment_payment_name__Credit_card__Cash__No_charge__Dispute__Unknown__Voided_trip.58d00ef9f4, now test.nyc_taxi.not_null_dim_payment_type_id.96dfa722aa)
[0m04:52:12.826811 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_dim_payment_type_id.96dfa722aa
[0m04:52:12.838136 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_dim_payment_type_id.96dfa722aa"
[0m04:52:12.841487 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_dim_payment_type_id.96dfa722aa
[0m04:52:12.843151 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_dim_payment_type_id.96dfa722aa
[0m04:52:12.844453 [debug] [Thread-1  ]: Began running node test.nyc_taxi.unique_dim_payment_type_id.dea55de04e
[0m04:52:12.845551 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_dim_payment_type_id.96dfa722aa, now test.nyc_taxi.unique_dim_payment_type_id.dea55de04e)
[0m04:52:12.846518 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.unique_dim_payment_type_id.dea55de04e
[0m04:52:12.855355 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.unique_dim_payment_type_id.dea55de04e"
[0m04:52:12.858920 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.unique_dim_payment_type_id.dea55de04e
[0m04:52:12.860572 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.unique_dim_payment_type_id.dea55de04e
[0m04:52:12.861803 [debug] [Thread-1  ]: Began running node test.nyc_taxi.accepted_values_dim_ratecode_rate_code_name__Standard_rate__JFK__Newark__Nassau_or_Westchester__Negotiated_fare__Group_ride__Unknown.57ee02019f
[0m04:52:12.862943 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.unique_dim_payment_type_id.dea55de04e, now test.nyc_taxi.accepted_values_dim_ratecode_rate_code_name__Standard_rate__JFK__Newark__Nassau_or_Westchester__Negotiated_fare__Group_ride__Unknown.57ee02019f)
[0m04:52:12.864020 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.accepted_values_dim_ratecode_rate_code_name__Standard_rate__JFK__Newark__Nassau_or_Westchester__Negotiated_fare__Group_ride__Unknown.57ee02019f
[0m04:52:12.874186 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.accepted_values_dim_ratecode_rate_code_name__Standard_rate__JFK__Newark__Nassau_or_Westchester__Negotiated_fare__Group_ride__Unknown.57ee02019f"
[0m04:52:12.877406 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.accepted_values_dim_ratecode_rate_code_name__Standard_rate__JFK__Newark__Nassau_or_Westchester__Negotiated_fare__Group_ride__Unknown.57ee02019f
[0m04:52:12.878843 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.accepted_values_dim_ratecode_rate_code_name__Standard_rate__JFK__Newark__Nassau_or_Westchester__Negotiated_fare__Group_ride__Unknown.57ee02019f
[0m04:52:12.879908 [debug] [Thread-1  ]: Began running node test.nyc_taxi.unique_dim_ratecode_rate_id.75ae8e4885
[0m04:52:12.881022 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.accepted_values_dim_ratecode_rate_code_name__Standard_rate__JFK__Newark__Nassau_or_Westchester__Negotiated_fare__Group_ride__Unknown.57ee02019f, now test.nyc_taxi.unique_dim_ratecode_rate_id.75ae8e4885)
[0m04:52:12.882087 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.unique_dim_ratecode_rate_id.75ae8e4885
[0m04:52:12.889680 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.unique_dim_ratecode_rate_id.75ae8e4885"
[0m04:52:12.894225 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.unique_dim_ratecode_rate_id.75ae8e4885
[0m04:52:12.895992 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.unique_dim_ratecode_rate_id.75ae8e4885
[0m04:52:12.897122 [debug] [Thread-1  ]: Began running node model.nyc_taxi.fct_trips
[0m04:52:12.898289 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.unique_dim_ratecode_rate_id.75ae8e4885, now model.nyc_taxi.fct_trips)
[0m04:52:12.899316 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.fct_trips
[0m04:52:12.920330 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.fct_trips"
[0m04:52:12.925142 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.fct_trips
[0m04:52:12.926784 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.fct_trips
[0m04:52:12.927926 [debug] [Thread-1  ]: Began running node test.nyc_taxi.accepted_values_dim_time_weekday__Sunday__Monday__Tuesday__Wednesday__Thursday__Friday__Saturday.87b4c2a366
[0m04:52:12.929313 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.nyc_taxi.fct_trips, now test.nyc_taxi.accepted_values_dim_time_weekday__Sunday__Monday__Tuesday__Wednesday__Thursday__Friday__Saturday.87b4c2a366)
[0m04:52:12.930291 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.accepted_values_dim_time_weekday__Sunday__Monday__Tuesday__Wednesday__Thursday__Friday__Saturday.87b4c2a366
[0m04:52:12.941255 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.accepted_values_dim_time_weekday__Sunday__Monday__Tuesday__Wednesday__Thursday__Friday__Saturday.87b4c2a366"
[0m04:52:12.950883 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.accepted_values_dim_time_weekday__Sunday__Monday__Tuesday__Wednesday__Thursday__Friday__Saturday.87b4c2a366
[0m04:52:12.952994 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.accepted_values_dim_time_weekday__Sunday__Monday__Tuesday__Wednesday__Thursday__Friday__Saturday.87b4c2a366
[0m04:52:12.954276 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_dim_time_date.2080f42875
[0m04:52:12.955480 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.accepted_values_dim_time_weekday__Sunday__Monday__Tuesday__Wednesday__Thursday__Friday__Saturday.87b4c2a366, now test.nyc_taxi.not_null_dim_time_date.2080f42875)
[0m04:52:12.956632 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_dim_time_date.2080f42875
[0m04:52:12.963415 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_dim_time_date.2080f42875"
[0m04:52:12.968708 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_dim_time_date.2080f42875
[0m04:52:12.970518 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_dim_time_date.2080f42875
[0m04:52:12.971595 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_dim_time_date_part.59e6206332
[0m04:52:12.972626 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_dim_time_date.2080f42875, now test.nyc_taxi.not_null_dim_time_date_part.59e6206332)
[0m04:52:12.973560 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_dim_time_date_part.59e6206332
[0m04:52:12.981133 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_dim_time_date_part.59e6206332"
[0m04:52:12.987363 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_dim_time_date_part.59e6206332
[0m04:52:12.989155 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_dim_time_date_part.59e6206332
[0m04:52:12.990301 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_dim_time_day.dc0e917166
[0m04:52:12.991374 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_dim_time_date_part.59e6206332, now test.nyc_taxi.not_null_dim_time_day.dc0e917166)
[0m04:52:12.992331 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_dim_time_day.dc0e917166
[0m04:52:12.998706 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_dim_time_day.dc0e917166"
[0m04:52:13.004012 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_dim_time_day.dc0e917166
[0m04:52:13.005954 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_dim_time_day.dc0e917166
[0m04:52:13.007029 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_dim_time_hour.5b8ccd8f25
[0m04:52:13.007993 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_dim_time_day.dc0e917166, now test.nyc_taxi.not_null_dim_time_hour.5b8ccd8f25)
[0m04:52:13.009035 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_dim_time_hour.5b8ccd8f25
[0m04:52:13.015139 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_dim_time_hour.5b8ccd8f25"
[0m04:52:13.020213 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_dim_time_hour.5b8ccd8f25
[0m04:52:13.022114 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_dim_time_hour.5b8ccd8f25
[0m04:52:13.023327 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_dim_time_minute.23e906ca61
[0m04:52:13.024549 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_dim_time_hour.5b8ccd8f25, now test.nyc_taxi.not_null_dim_time_minute.23e906ca61)
[0m04:52:13.025520 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_dim_time_minute.23e906ca61
[0m04:52:13.031585 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_dim_time_minute.23e906ca61"
[0m04:52:13.036704 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_dim_time_minute.23e906ca61
[0m04:52:13.038460 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_dim_time_minute.23e906ca61
[0m04:52:13.039547 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_dim_time_month.9f6ecf2eb5
[0m04:52:13.040659 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_dim_time_minute.23e906ca61, now test.nyc_taxi.not_null_dim_time_month.9f6ecf2eb5)
[0m04:52:13.041533 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_dim_time_month.9f6ecf2eb5
[0m04:52:13.047634 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_dim_time_month.9f6ecf2eb5"
[0m04:52:13.052592 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_dim_time_month.9f6ecf2eb5
[0m04:52:13.054285 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_dim_time_month.9f6ecf2eb5
[0m04:52:13.055716 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_dim_time_year.6fb9595d53
[0m04:52:13.056799 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_dim_time_month.9f6ecf2eb5, now test.nyc_taxi.not_null_dim_time_year.6fb9595d53)
[0m04:52:13.057747 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_dim_time_year.6fb9595d53
[0m04:52:13.063803 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_dim_time_year.6fb9595d53"
[0m04:52:13.068740 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_dim_time_year.6fb9595d53
[0m04:52:13.070449 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_dim_time_year.6fb9595d53
[0m04:52:13.071626 [debug] [Thread-1  ]: Began running node test.nyc_taxi.unique_dim_time_time_id.0752c025e8
[0m04:52:13.072753 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_dim_time_year.6fb9595d53, now test.nyc_taxi.unique_dim_time_time_id.0752c025e8)
[0m04:52:13.073680 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.unique_dim_time_time_id.0752c025e8
[0m04:52:13.081135 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.unique_dim_time_time_id.0752c025e8"
[0m04:52:13.086029 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.unique_dim_time_time_id.0752c025e8
[0m04:52:13.087830 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.unique_dim_time_time_id.0752c025e8
[0m04:52:13.089124 [debug] [Thread-1  ]: Began running node test.nyc_taxi.accepted_values_dim_triptype_trip_name__Street_hail__Dispatch__Unknown.f5add8f4c9
[0m04:52:13.090277 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.unique_dim_time_time_id.0752c025e8, now test.nyc_taxi.accepted_values_dim_triptype_trip_name__Street_hail__Dispatch__Unknown.f5add8f4c9)
[0m04:52:13.091245 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.accepted_values_dim_triptype_trip_name__Street_hail__Dispatch__Unknown.f5add8f4c9
[0m04:52:13.099032 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.accepted_values_dim_triptype_trip_name__Street_hail__Dispatch__Unknown.f5add8f4c9"
[0m04:52:13.104354 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.accepted_values_dim_triptype_trip_name__Street_hail__Dispatch__Unknown.f5add8f4c9
[0m04:52:13.106065 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.accepted_values_dim_triptype_trip_name__Street_hail__Dispatch__Unknown.f5add8f4c9
[0m04:52:13.107233 [debug] [Thread-1  ]: Began running node test.nyc_taxi.unique_dim_triptype_type_id.fbaf29d341
[0m04:52:13.108203 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.accepted_values_dim_triptype_trip_name__Street_hail__Dispatch__Unknown.f5add8f4c9, now test.nyc_taxi.unique_dim_triptype_type_id.fbaf29d341)
[0m04:52:13.109070 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.unique_dim_triptype_type_id.fbaf29d341
[0m04:52:13.115185 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.unique_dim_triptype_type_id.fbaf29d341"
[0m04:52:13.120966 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.unique_dim_triptype_type_id.fbaf29d341
[0m04:52:13.122815 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.unique_dim_triptype_type_id.fbaf29d341
[0m04:52:13.124068 [debug] [Thread-1  ]: Began running node test.nyc_taxi.accepted_values_dim_vendor_vendor_name__Creative_Mobile_Technologies__VeriFone_Inc_.7481cecf07
[0m04:52:13.125145 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.unique_dim_triptype_type_id.fbaf29d341, now test.nyc_taxi.accepted_values_dim_vendor_vendor_name__Creative_Mobile_Technologies__VeriFone_Inc_.7481cecf07)
[0m04:52:13.126063 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.accepted_values_dim_vendor_vendor_name__Creative_Mobile_Technologies__VeriFone_Inc_.7481cecf07
[0m04:52:13.133453 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.accepted_values_dim_vendor_vendor_name__Creative_Mobile_Technologies__VeriFone_Inc_.7481cecf07"
[0m04:52:13.138937 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.accepted_values_dim_vendor_vendor_name__Creative_Mobile_Technologies__VeriFone_Inc_.7481cecf07
[0m04:52:13.140726 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.accepted_values_dim_vendor_vendor_name__Creative_Mobile_Technologies__VeriFone_Inc_.7481cecf07
[0m04:52:13.142121 [debug] [Thread-1  ]: Began running node test.nyc_taxi.unique_dim_vendor_id.03fad38d04
[0m04:52:13.143226 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.accepted_values_dim_vendor_vendor_name__Creative_Mobile_Technologies__VeriFone_Inc_.7481cecf07, now test.nyc_taxi.unique_dim_vendor_id.03fad38d04)
[0m04:52:13.144232 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.unique_dim_vendor_id.03fad38d04
[0m04:52:13.150078 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.unique_dim_vendor_id.03fad38d04"
[0m04:52:13.155063 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.unique_dim_vendor_id.03fad38d04
[0m04:52:13.156725 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.unique_dim_vendor_id.03fad38d04
[0m04:52:13.157854 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_dim_zone_borough.1ed2272c52
[0m04:52:13.158781 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.unique_dim_vendor_id.03fad38d04, now test.nyc_taxi.not_null_dim_zone_borough.1ed2272c52)
[0m04:52:13.159781 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_dim_zone_borough.1ed2272c52
[0m04:52:13.167649 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_dim_zone_borough.1ed2272c52"
[0m04:52:13.171978 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_dim_zone_borough.1ed2272c52
[0m04:52:13.173422 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_dim_zone_borough.1ed2272c52
[0m04:52:13.174421 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_dim_zone_service_zone.2007f611c5
[0m04:52:13.175372 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_dim_zone_borough.1ed2272c52, now test.nyc_taxi.not_null_dim_zone_service_zone.2007f611c5)
[0m04:52:13.176192 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_dim_zone_service_zone.2007f611c5
[0m04:52:13.182324 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_dim_zone_service_zone.2007f611c5"
[0m04:52:13.186975 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_dim_zone_service_zone.2007f611c5
[0m04:52:13.188374 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_dim_zone_service_zone.2007f611c5
[0m04:52:13.189382 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_dim_zone_zone.a1c4a4c37a
[0m04:52:13.190350 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_dim_zone_service_zone.2007f611c5, now test.nyc_taxi.not_null_dim_zone_zone.a1c4a4c37a)
[0m04:52:13.191296 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_dim_zone_zone.a1c4a4c37a
[0m04:52:13.197285 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_dim_zone_zone.a1c4a4c37a"
[0m04:52:13.204653 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_dim_zone_zone.a1c4a4c37a
[0m04:52:13.206372 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_dim_zone_zone.a1c4a4c37a
[0m04:52:13.207434 [debug] [Thread-1  ]: Began running node test.nyc_taxi.unique_dim_zone_location_id.7702f92424
[0m04:52:13.208364 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_dim_zone_zone.a1c4a4c37a, now test.nyc_taxi.unique_dim_zone_location_id.7702f92424)
[0m04:52:13.209275 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.unique_dim_zone_location_id.7702f92424
[0m04:52:13.215468 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.unique_dim_zone_location_id.7702f92424"
[0m04:52:13.220759 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.unique_dim_zone_location_id.7702f92424
[0m04:52:13.222312 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.unique_dim_zone_location_id.7702f92424
[0m04:52:13.223449 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_do_location_id.6acdd302a6
[0m04:52:13.224415 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.unique_dim_zone_location_id.7702f92424, now test.nyc_taxi.not_null_fct_trips_do_location_id.6acdd302a6)
[0m04:52:13.225363 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_do_location_id.6acdd302a6
[0m04:52:13.231465 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_do_location_id.6acdd302a6"
[0m04:52:13.236722 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_do_location_id.6acdd302a6
[0m04:52:13.238187 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_do_location_id.6acdd302a6
[0m04:52:13.239465 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_dropoff_time_id.781496e98f
[0m04:52:13.240425 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_do_location_id.6acdd302a6, now test.nyc_taxi.not_null_fct_trips_dropoff_time_id.781496e98f)
[0m04:52:13.241326 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_dropoff_time_id.781496e98f
[0m04:52:13.247441 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_dropoff_time_id.781496e98f"
[0m04:52:13.252936 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_dropoff_time_id.781496e98f
[0m04:52:13.254479 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_dropoff_time_id.781496e98f
[0m04:52:13.255581 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_extra.1801055bb3
[0m04:52:13.256505 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_dropoff_time_id.781496e98f, now test.nyc_taxi.not_null_fct_trips_extra.1801055bb3)
[0m04:52:13.257370 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_extra.1801055bb3
[0m04:52:13.264699 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_extra.1801055bb3"
[0m04:52:13.270048 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_extra.1801055bb3
[0m04:52:13.271574 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_extra.1801055bb3
[0m04:52:13.272651 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_improvement_surcharge.4cf28d1443
[0m04:52:13.273648 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_extra.1801055bb3, now test.nyc_taxi.not_null_fct_trips_improvement_surcharge.4cf28d1443)
[0m04:52:13.274609 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_improvement_surcharge.4cf28d1443
[0m04:52:13.282185 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_improvement_surcharge.4cf28d1443"
[0m04:52:13.287120 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_improvement_surcharge.4cf28d1443
[0m04:52:13.288577 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_improvement_surcharge.4cf28d1443
[0m04:52:13.289647 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_passenger_count.b1370cab1c
[0m04:52:13.290681 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_improvement_surcharge.4cf28d1443, now test.nyc_taxi.not_null_fct_trips_passenger_count.b1370cab1c)
[0m04:52:13.291517 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_passenger_count.b1370cab1c
[0m04:52:13.297604 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_passenger_count.b1370cab1c"
[0m04:52:13.301966 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_passenger_count.b1370cab1c
[0m04:52:13.303406 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_passenger_count.b1370cab1c
[0m04:52:13.304496 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_payment_type.93889b679a
[0m04:52:13.305591 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_passenger_count.b1370cab1c, now test.nyc_taxi.not_null_fct_trips_payment_type.93889b679a)
[0m04:52:13.306446 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_payment_type.93889b679a
[0m04:52:13.312473 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_payment_type.93889b679a"
[0m04:52:13.317039 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_payment_type.93889b679a
[0m04:52:13.318831 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_payment_type.93889b679a
[0m04:52:13.319887 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_pickup_time_id.f31fbe0eeb
[0m04:52:13.320761 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_payment_type.93889b679a, now test.nyc_taxi.not_null_fct_trips_pickup_time_id.f31fbe0eeb)
[0m04:52:13.321575 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_pickup_time_id.f31fbe0eeb
[0m04:52:13.327685 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_pickup_time_id.f31fbe0eeb"
[0m04:52:13.332679 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_pickup_time_id.f31fbe0eeb
[0m04:52:13.334347 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_pickup_time_id.f31fbe0eeb
[0m04:52:13.335453 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_pu_location_id.b0dc8dd185
[0m04:52:13.336472 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_pickup_time_id.f31fbe0eeb, now test.nyc_taxi.not_null_fct_trips_pu_location_id.b0dc8dd185)
[0m04:52:13.337429 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_pu_location_id.b0dc8dd185
[0m04:52:13.344766 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_pu_location_id.b0dc8dd185"
[0m04:52:13.349685 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_pu_location_id.b0dc8dd185
[0m04:52:13.351176 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_pu_location_id.b0dc8dd185
[0m04:52:13.352257 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_rate_code_id.ba0047eaae
[0m04:52:13.353189 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_pu_location_id.b0dc8dd185, now test.nyc_taxi.not_null_fct_trips_rate_code_id.ba0047eaae)
[0m04:52:13.354065 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_rate_code_id.ba0047eaae
[0m04:52:13.360131 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_rate_code_id.ba0047eaae"
[0m04:52:13.365126 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_rate_code_id.ba0047eaae
[0m04:52:13.366692 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_rate_code_id.ba0047eaae
[0m04:52:13.367874 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_trip_distance.19cd17f1df
[0m04:52:13.368876 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_rate_code_id.ba0047eaae, now test.nyc_taxi.not_null_fct_trips_trip_distance.19cd17f1df)
[0m04:52:13.369854 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_trip_distance.19cd17f1df
[0m04:52:13.376259 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_trip_distance.19cd17f1df"
[0m04:52:13.381105 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_trip_distance.19cd17f1df
[0m04:52:13.382662 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_trip_distance.19cd17f1df
[0m04:52:13.383810 [debug] [Thread-1  ]: Began running node test.nyc_taxi.not_null_fct_trips_vendor_id.b9b2f380bb
[0m04:52:13.385035 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_trip_distance.19cd17f1df, now test.nyc_taxi.not_null_fct_trips_vendor_id.b9b2f380bb)
[0m04:52:13.386020 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.not_null_fct_trips_vendor_id.b9b2f380bb
[0m04:52:13.392636 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.not_null_fct_trips_vendor_id.b9b2f380bb"
[0m04:52:13.398014 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.not_null_fct_trips_vendor_id.b9b2f380bb
[0m04:52:13.399843 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.not_null_fct_trips_vendor_id.b9b2f380bb
[0m04:52:13.401046 [debug] [Thread-1  ]: Began running node test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab
[0m04:52:13.402062 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.nyc_taxi.not_null_fct_trips_vendor_id.b9b2f380bb, now test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab)
[0m04:52:13.403076 [debug] [Thread-1  ]: Began compiling node test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab
[0m04:52:13.409048 [debug] [Thread-1  ]: Writing injected SQL for node "test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab"
[0m04:52:13.414227 [debug] [Thread-1  ]: Began executing node test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab
[0m04:52:13.416067 [debug] [Thread-1  ]: Finished running node test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab
[0m04:52:13.417867 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:52:13.418618 [debug] [MainThread]: Connection 'test.nyc_taxi.unique_fct_trips_trip_id.9b74cb6aab' was properly closed.
[0m04:52:13.429021 [debug] [MainThread]: Command end result
[0m04:52:13.627275 [debug] [MainThread]: Acquiring new bigquery connection 'generate_catalog'
[0m04:52:13.628300 [info ] [MainThread]: Building catalog
[0m04:52:13.637354 [debug] [ThreadPool]: Acquiring new bigquery connection 'northern-shield-437204-m0.information_schema'
[0m04:52:13.663255 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:52:13.667229 [debug] [ThreadPool]: On northern-shield-437204-m0.information_schema: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "connection_name": "northern-shield-437204-m0.information_schema"} */

    with
                table_shards_stage as (
    select
        tables.project_id as table_catalog,
        tables.dataset_id as table_schema,
        coalesce(REGEXP_EXTRACT(tables.table_id, '^(.+)[0-9]{8}$'), tables.table_id) as table_name,
        tables.table_id as shard_name,
        REGEXP_EXTRACT(tables.table_id, '^.+([0-9]{8})$') as shard_index,
        REGEXP_CONTAINS(tables.table_id, '^.+[0-9]{8}$') and tables.type = 1 as is_date_shard,
        case
            when materialized_views.table_name is not null then 'materialized view'
            when tables.type = 1 then 'table'
            when tables.type = 2 then 'view'
            else 'external'
        end as table_type,
        tables.type = 1 as is_table,
        JSON_VALUE(table_description.option_value) as table_comment,
        tables.size_bytes,
        tables.row_count
    from `northern-shield-437204-m0`.`nyc_taxi`.__TABLES__ tables
    left join `northern-shield-437204-m0`.`nyc_taxi`.INFORMATION_SCHEMA.MATERIALIZED_VIEWS materialized_views
        on materialized_views.table_catalog = tables.project_id
        and materialized_views.table_schema = tables.dataset_id
        and materialized_views.table_name = tables.table_id
    left join `northern-shield-437204-m0`.`nyc_taxi`.INFORMATION_SCHEMA.TABLE_OPTIONS table_description
        on table_description.table_catalog = tables.project_id
        and table_description.table_schema = tables.dataset_id
        and table_description.table_name = tables.table_id
        and table_description.option_name = 'description'
),
                table_shards as (
                    select * from table_shards_stage
                    where ((
                                upper(table_schema) = upper('nyc_taxi')
                            and upper(table_name) = upper('dim_vendor')
                            ) or (
                                upper(table_schema) = upper('nyc_taxi')
                            and upper(table_name) = upper('dim_triptype')
                            ) or (
                                upper(table_schema) = upper('nyc_taxi')
                            and upper(table_name) = upper('green_tripdata')
                            ) or (
                                upper(table_schema) = upper('nyc_taxi')
                            and upper(table_name) = upper('fct_trips')
                            ) or (
                                upper(table_schema) = upper('nyc_taxi')
                            and upper(table_name) = upper('dim_payment')
                            ) or (
                                upper(table_schema) = upper('nyc_taxi')
                            and upper(table_name) = upper('dim_time')
                            ) or (
                                upper(table_schema) = upper('nyc_taxi')
                            and upper(table_name) = upper('dim_zone')
                            ) or (
                                upper(table_schema) = upper('nyc_taxi')
                            and upper(table_name) = upper('zone_map')
                            ) or (
                                upper(table_schema) = upper('nyc_taxi')
                            and upper(table_name) = upper('dim_ratecode')
                            ))
                ),
                tables as (
    select distinct
        table_catalog,
        table_schema,
        table_name,
        is_date_shard,
        table_type,
        is_table,
        table_comment
    from table_shards
),
                table_stats as (
    select
        table_catalog,
        table_schema,
        table_name,
        max(shard_name) as latest_shard_name,
        min(shard_index) as shard_min,
        max(shard_index) as shard_max,
        count(shard_index) as shard_count,
        sum(size_bytes) as size_bytes,
        sum(row_count) as row_count
    from table_shards
    group by 1, 2, 3
),

                columns as (
    select
        columns.table_catalog,
        columns.table_schema,
        columns.table_name as shard_name,
        coalesce(paths.field_path, '<unknown>') as column_name,
        -- invent a row number to account for nested fields
        -- BQ does not treat these nested properties as independent fields
        row_number() over (
            partition by
                columns.table_catalog,
                columns.table_schema,
                columns.table_name
            order by
                columns.ordinal_position,
                paths.field_path
        ) as column_index,
        coalesce(paths.data_type, '<unknown>') as column_type,
        paths.description as column_comment,
        case when columns.is_partitioning_column = 'YES' then 1 else 0 end as is_partitioning_column,
        case when columns.is_partitioning_column = 'YES' then paths.field_path end as partition_column,
        case when columns.clustering_ordinal_position is not null then 1 else 0 end as is_clustering_column,
        case when columns.clustering_ordinal_position is not null then paths.field_path end as cluster_column,
        columns.clustering_ordinal_position
    from `northern-shield-437204-m0`.`nyc_taxi`.INFORMATION_SCHEMA.COLUMNS columns
    join `northern-shield-437204-m0`.`nyc_taxi`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS paths
        on paths.table_catalog = columns.table_catalog
        and paths.table_schema = columns.table_schema
        and paths.table_name = columns.table_name
        and paths.column_name = columns.column_name
    where columns.ordinal_position is not null
),
                column_stats as (
    select
        table_catalog,
        table_schema,
        shard_name,
        max(is_partitioning_column) = 1 as is_partitioned,
        max(partition_column) as partition_column,
        max(is_clustering_column) = 1 as is_clustered,
        array_to_string(
            array_agg(
                cluster_column ignore nulls
                order by clustering_ordinal_position
            ), ', '
        ) as clustering_columns
    from columns
    group by 1, 2, 3
)

            
    select
        tables.table_catalog as table_database,
        tables.table_schema,
        case
            when tables.is_date_shard then concat(tables.table_name, '*')
            else tables.table_name
        end as table_name,
        tables.table_type,
        tables.table_comment,
        -- coalesce column metadata fields to ensure they are non-null for catalog generation
        -- external table columns are not present in COLUMN_FIELD_PATHS
        coalesce(columns.column_name, '<unknown>') as column_name,
        coalesce(columns.column_index, 1) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        coalesce(columns.column_comment, '') as column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_stats.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        tables.is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_stats.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        tables.is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_stats.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        tables.is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        table_stats.row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        tables.is_table as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        table_stats.size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        tables.is_table as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        column_stats.partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        column_stats.is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        column_stats.clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        column_stats.is_clustered as `stats__clustering_fields__include`

    from tables
    join table_stats
        on table_stats.table_catalog = tables.table_catalog
        and table_stats.table_schema = tables.table_schema
        and table_stats.table_name = tables.table_name
    left join column_stats
        on column_stats.table_catalog = tables.table_catalog
        and column_stats.table_schema = tables.table_schema
        and column_stats.shard_name = table_stats.latest_shard_name
    left join columns
        on columns.table_catalog = tables.table_catalog
        and columns.table_schema = tables.table_schema
        and columns.shard_name = table_stats.latest_shard_name

  
[0m04:52:14.308151 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:b4d564e6-50f9-4459-8b06-245c797b8fbe&page=queryresults
[0m04:52:16.508958 [info ] [MainThread]: Catalog written to /opt/airflow/include/dbt/target/catalog.json
[0m04:52:16.511188 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 6.620317, "process_in_blocks": "3000", "process_kernel_time": 0.371146, "process_mem_max_rss": "245344", "process_out_blocks": "0", "process_user_time": 5.51704}
[0m04:52:16.512539 [debug] [MainThread]: Command `dbt docs generate` succeeded at 04:52:16.512364 after 6.62 seconds
[0m04:52:16.513486 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m04:52:16.514484 [debug] [MainThread]: Connection 'northern-shield-437204-m0.information_schema' was properly closed.
[0m04:52:16.515653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b77a2f400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b70ce14c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b3e454910>]}
[0m04:52:16.516619 [debug] [MainThread]: Flushing usage events
[0m04:54:36.182839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f775086cf40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f774e640a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f774e6409a0>]}


============================== 04:54:36.190284 | 52739191-7ab4-44a8-9ae0-d2c4039bc0e8 ==============================
[0m04:54:36.190284 [info ] [MainThread]: Running with dbt=1.8.9
[0m04:54:36.191655 [debug] [MainThread]: running dbt with arguments {'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'profiles_dir': '/opt/airflow/include/dbt', 'cache_selected_only': 'False', 'target_path': 'None', 'no_print': 'None', 'version_check': 'True', 'printer_width': '80', 'use_experimental_parser': 'False', 'log_path': '/opt/airflow/include/dbt/logs', 'partial_parse': 'True', 'warn_error': 'None', 'log_cache_events': 'False', 'log_format': 'default', 'invocation_command': 'dbt docs serve --port 8081 --host 0.0.0.0', 'fail_fast': 'False', 'empty': 'None', 'static_parser': 'True', 'debug': 'False', 'introspect': 'True', 'quiet': 'False', 'use_colors': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'write_json': 'True'}
[0m04:54:37.345087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '52739191-7ab4-44a8-9ae0-d2c4039bc0e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7717fbabe0>]}
[0m04:54:37.406259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '52739191-7ab4-44a8-9ae0-d2c4039bc0e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7717fbad30>]}
[0m04:55:03.283634 [error] [MainThread]: Encountered an error:

[0m04:55:03.286576 [error] [MainThread]: Traceback (most recent call last):
  File "/opt/airflow/dbt_venv/lib/python3.9/site-packages/dbt/cli/requires.py", line 138, in wrapper
    result, success = func(*args, **kwargs)
  File "/opt/airflow/dbt_venv/lib/python3.9/site-packages/dbt/cli/requires.py", line 101, in wrapper
    return func(*args, **kwargs)
  File "/opt/airflow/dbt_venv/lib/python3.9/site-packages/dbt/cli/requires.py", line 218, in wrapper
    return func(*args, **kwargs)
  File "/opt/airflow/dbt_venv/lib/python3.9/site-packages/dbt/cli/requires.py", line 247, in wrapper
    return func(*args, **kwargs)
  File "/opt/airflow/dbt_venv/lib/python3.9/site-packages/dbt/cli/requires.py", line 294, in wrapper
    return func(*args, **kwargs)
  File "/opt/airflow/dbt_venv/lib/python3.9/site-packages/dbt/cli/main.py", line 303, in docs_serve
    results = task.run()
  File "/opt/airflow/dbt_venv/lib/python3.9/site-packages/dbt/task/docs/serve.py", line 29, in run
    httpd.serve_forever()
  File "/usr/local/lib/python3.9/socketserver.py", line 232, in serve_forever
    ready = selector.select(poll_interval)
  File "/usr/local/lib/python3.9/selectors.py", line 416, in select
    fd_event_list = self._selector.poll(timeout)
KeyboardInterrupt

[0m04:55:03.288195 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_success": false, "command_wall_clock_time": 27.06376, "process_in_blocks": "16", "process_kernel_time": 0.26829, "process_mem_max_rss": "246044", "process_out_blocks": "0", "process_user_time": 4.153539}
[0m04:55:03.289671 [debug] [MainThread]: Command `dbt docs serve` failed at 04:55:03.289487 after 27.07 seconds
[0m04:55:03.290635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f775086cf40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f771711c4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77170c47c0>]}
[0m04:55:03.291610 [debug] [MainThread]: Flushing usage events
[0m04:55:45.529002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd89cad0400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd89a907a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd89a907a30>]}


============================== 04:55:45.536035 | 54ce1887-4156-45d9-a44d-4ea2c6b97eb7 ==============================
[0m04:55:45.536035 [info ] [MainThread]: Running with dbt=1.8.9
[0m04:55:45.537648 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'static_parser': 'True', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'empty': 'None', 'printer_width': '80', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'introspect': 'True', 'invocation_command': 'dbt docs serve --port 8001 --host 0.0.0.0', 'quiet': 'False', 'log_format': 'default', 'indirect_selection': 'eager', 'write_json': 'True', 'no_print': 'None', 'partial_parse': 'True', 'profiles_dir': '/opt/airflow/include/dbt', 'target_path': 'None', 'log_path': '/opt/airflow/include/dbt/logs'}
[0m04:55:46.631379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '54ce1887-4156-45d9-a44d-4ea2c6b97eb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd89bd5e0a0>]}
[0m04:55:46.693726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '54ce1887-4156-45d9-a44d-4ea2c6b97eb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd89a94beb0>]}
[0m05:03:12.698223 [error] [MainThread]: Encountered an error:

[0m05:03:12.701412 [error] [MainThread]: Traceback (most recent call last):
  File "/opt/airflow/dbt_venv/lib/python3.9/site-packages/dbt/cli/requires.py", line 138, in wrapper
    result, success = func(*args, **kwargs)
  File "/opt/airflow/dbt_venv/lib/python3.9/site-packages/dbt/cli/requires.py", line 101, in wrapper
    return func(*args, **kwargs)
  File "/opt/airflow/dbt_venv/lib/python3.9/site-packages/dbt/cli/requires.py", line 218, in wrapper
    return func(*args, **kwargs)
  File "/opt/airflow/dbt_venv/lib/python3.9/site-packages/dbt/cli/requires.py", line 247, in wrapper
    return func(*args, **kwargs)
  File "/opt/airflow/dbt_venv/lib/python3.9/site-packages/dbt/cli/requires.py", line 294, in wrapper
    return func(*args, **kwargs)
  File "/opt/airflow/dbt_venv/lib/python3.9/site-packages/dbt/cli/main.py", line 303, in docs_serve
    results = task.run()
  File "/opt/airflow/dbt_venv/lib/python3.9/site-packages/dbt/task/docs/serve.py", line 29, in run
    httpd.serve_forever()
  File "/usr/local/lib/python3.9/socketserver.py", line 232, in serve_forever
    ready = selector.select(poll_interval)
  File "/usr/local/lib/python3.9/selectors.py", line 416, in select
    fd_event_list = self._selector.poll(timeout)
KeyboardInterrupt

[0m05:03:12.704054 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_success": false, "command_wall_clock_time": 445.52908, "process_in_blocks": "0", "process_kernel_time": 0.187984, "process_mem_max_rss": "245252", "process_out_blocks": "0", "process_user_time": 4.313757}
[0m05:03:12.706137 [debug] [MainThread]: Command `dbt docs serve` failed at 05:03:12.705854 after 445.53 seconds
[0m05:03:12.707653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd89cad0400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd89a9b51c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8634725b0>]}
[0m05:03:12.709087 [debug] [MainThread]: Flushing usage events
[0m05:03:45.832020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8a009ff40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc89de73a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc89de73a30>]}


============================== 05:03:45.839443 | 73e334bb-5602-4b97-a643-8d0d76721b10 ==============================
[0m05:03:45.839443 [info ] [MainThread]: Running with dbt=1.8.9
[0m05:03:45.840947 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'use_experimental_parser': 'False', 'warn_error': 'None', 'invocation_command': 'dbt docs serve --port 8001 --host 0.0.0.0', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True', 'debug': 'False', 'static_parser': 'True', 'use_colors': 'True', 'target_path': 'None', 'cache_selected_only': 'False', 'write_json': 'True', 'empty': 'None', 'partial_parse': 'True', 'log_path': '/opt/airflow/include/dbt/logs', 'profiles_dir': '/opt/airflow/include/dbt', 'no_print': 'None', 'log_cache_events': 'False', 'fail_fast': 'False', 'printer_width': '80', 'indirect_selection': 'eager', 'quiet': 'False', 'version_check': 'True'}
[0m05:03:46.996272 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '73e334bb-5602-4b97-a643-8d0d76721b10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc867b51730>]}
[0m05:03:47.057699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '73e334bb-5602-4b97-a643-8d0d76721b10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8a040f2b0>]}
[0m05:16:16.732946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff238a57f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff23682ba30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff23682b9d0>]}


============================== 05:16:16.739857 | 283a9b09-0f81-4e2a-b7b7-a73079279e2b ==============================
[0m05:16:16.739857 [info ] [MainThread]: Running with dbt=1.8.9
[0m05:16:16.741351 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'send_anonymous_usage_stats': 'True', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'partial_parse': 'True', 'debug': 'False', 'log_path': '/opt/airflow/include/dbt/logs', 'fail_fast': 'False', 'use_colors': 'True', 'static_parser': 'True', 'warn_error': 'None', 'empty': 'None', 'target_path': 'None', 'log_format': 'default', 'use_experimental_parser': 'False', 'printer_width': '80', 'version_check': 'True', 'write_json': 'True', 'cache_selected_only': 'False', 'invocation_command': 'dbt docs serve --port 8001 --host 0.0.0.0', 'quiet': 'False', 'profiles_dir': '/opt/airflow/include/dbt'}
[0m05:16:17.861394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '283a9b09-0f81-4e2a-b7b7-a73079279e2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff23823efd0>]}
[0m05:16:17.922294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '283a9b09-0f81-4e2a-b7b7-a73079279e2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff20421beb0>]}
[0m05:16:17.954412 [error] [MainThread]: Encountered an error:
[Errno 98] Address already in use
[0m05:16:17.956485 [error] [MainThread]: Traceback (most recent call last):
  File "/opt/airflow/dbt_venv/lib/python3.9/site-packages/dbt/cli/requires.py", line 138, in wrapper
    result, success = func(*args, **kwargs)
  File "/opt/airflow/dbt_venv/lib/python3.9/site-packages/dbt/cli/requires.py", line 101, in wrapper
    return func(*args, **kwargs)
  File "/opt/airflow/dbt_venv/lib/python3.9/site-packages/dbt/cli/requires.py", line 218, in wrapper
    return func(*args, **kwargs)
  File "/opt/airflow/dbt_venv/lib/python3.9/site-packages/dbt/cli/requires.py", line 247, in wrapper
    return func(*args, **kwargs)
  File "/opt/airflow/dbt_venv/lib/python3.9/site-packages/dbt/cli/requires.py", line 294, in wrapper
    return func(*args, **kwargs)
  File "/opt/airflow/dbt_venv/lib/python3.9/site-packages/dbt/cli/main.py", line 303, in docs_serve
    results = task.run()
  File "/opt/airflow/dbt_venv/lib/python3.9/site-packages/dbt/task/docs/serve.py", line 24, in run
    with socketserver.TCPServer((host, port), SimpleHTTPRequestHandler) as httpd:
  File "/usr/local/lib/python3.9/socketserver.py", line 452, in __init__
    self.server_bind()
  File "/usr/local/lib/python3.9/socketserver.py", line 466, in server_bind
    self.socket.bind(self.server_address)
OSError: [Errno 98] Address already in use

[0m05:16:17.958238 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_success": false, "command_wall_clock_time": 1.2929504, "process_in_blocks": "0", "process_kernel_time": 0.169593, "process_mem_max_rss": "245064", "process_out_blocks": "0", "process_user_time": 4.259789}
[0m05:16:17.959624 [debug] [MainThread]: Command `dbt docs serve` failed at 05:16:17.959428 after 1.29 seconds
[0m05:16:17.960640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff238a57f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1ff2949a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1ff2dae80>]}
[0m05:16:17.961619 [debug] [MainThread]: Flushing usage events
[0m06:00:50.453040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0497972f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0495745a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0495745a00>]}


============================== 06:00:50.460648 | 757f3d03-3ca2-476a-8657-f10b82f0a2ba ==============================
[0m06:00:50.460648 [info ] [MainThread]: Running with dbt=1.8.9
[0m06:00:50.462264 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'profiles_dir': '/opt/airflow/include/dbt', 'log_path': '/opt/airflow/include/dbt/logs', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'cache_selected_only': 'False', 'warn_error': 'None', 'no_print': 'None', 'fail_fast': 'False', 'printer_width': '80', 'indirect_selection': 'eager', 'invocation_command': 'dbt docs serve --port 8001 --host 0.0.0.0', 'quiet': 'False', 'log_format': 'default', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'version_check': 'True', 'empty': 'None', 'partial_parse': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'static_parser': 'True', 'debug': 'False', 'target_path': 'None'}
[0m06:00:51.735773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '757f3d03-3ca2-476a-8657-f10b82f0a2ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f045e2e15e0>]}
[0m06:00:51.799004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '757f3d03-3ca2-476a-8657-f10b82f0a2ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f045e313790>]}
[0m06:46:35.216254 [error] [MainThread]: Encountered an error:

[0m06:46:35.271528 [error] [MainThread]: Traceback (most recent call last):
  File "/opt/airflow/dbt_venv/lib/python3.9/site-packages/dbt/cli/requires.py", line 138, in wrapper
    result, success = func(*args, **kwargs)
  File "/opt/airflow/dbt_venv/lib/python3.9/site-packages/dbt/cli/requires.py", line 101, in wrapper
    return func(*args, **kwargs)
  File "/opt/airflow/dbt_venv/lib/python3.9/site-packages/dbt/cli/requires.py", line 218, in wrapper
    return func(*args, **kwargs)
  File "/opt/airflow/dbt_venv/lib/python3.9/site-packages/dbt/cli/requires.py", line 247, in wrapper
    return func(*args, **kwargs)
  File "/opt/airflow/dbt_venv/lib/python3.9/site-packages/dbt/cli/requires.py", line 294, in wrapper
    return func(*args, **kwargs)
  File "/opt/airflow/dbt_venv/lib/python3.9/site-packages/dbt/cli/main.py", line 303, in docs_serve
    results = task.run()
  File "/opt/airflow/dbt_venv/lib/python3.9/site-packages/dbt/task/docs/serve.py", line 29, in run
    httpd.serve_forever()
  File "/usr/local/lib/python3.9/socketserver.py", line 232, in serve_forever
    ready = selector.select(poll_interval)
  File "/usr/local/lib/python3.9/selectors.py", line 416, in select
    fd_event_list = self._selector.poll(timeout)
KeyboardInterrupt

[0m06:46:35.325887 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_success": false, "command_wall_clock_time": 2735.0361, "process_in_blocks": "120", "process_kernel_time": 0.471743, "process_mem_max_rss": "245760", "process_out_blocks": "8040", "process_user_time": 4.717437}
[0m06:46:35.343162 [debug] [MainThread]: Command `dbt docs serve` failed at 06:46:35.341161 after 2735.06 seconds
[0m06:46:35.357486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0497972f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f045e213d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f045e100ee0>]}
[0m06:46:35.366541 [debug] [MainThread]: Flushing usage events
[0m17:54:06.701799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb61e8a3f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb61c679970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb61c679910>]}


============================== 17:54:06.712560 | 43947547-57bd-48d9-9494-936363aba991 ==============================
[0m17:54:06.712560 [info ] [MainThread]: Running with dbt=1.8.9
[0m17:54:06.714603 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'partial_parse': 'True', 'introspect': 'True', 'quiet': 'False', 'invocation_command': 'dbt run --select analytic_greentripdata', 'debug': 'False', 'no_print': 'None', 'profiles_dir': '/opt/airflow/include/dbt', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'printer_width': '80', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'use_colors': 'True', 'warn_error': 'None', 'log_cache_events': 'False', 'log_format': 'default', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'static_parser': 'True', 'target_path': 'None', 'empty': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/include/dbt/logs', 'indirect_selection': 'eager'}
[0m17:54:09.086473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '43947547-57bd-48d9-9494-936363aba991', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb61e08afd0>]}
[0m17:54:09.172170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '43947547-57bd-48d9-9494-936363aba991', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5e601f340>]}
[0m17:54:09.174093 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m17:54:09.431131 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m17:54:10.518705 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m17:54:10.521484 [debug] [MainThread]: Partial parsing: added file: nyc_taxi://models/report/analytic_greentripdata.sql
[0m17:54:11.077360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '43947547-57bd-48d9-9494-936363aba991', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb616ee7130>]}
[0m17:54:11.331098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '43947547-57bd-48d9-9494-936363aba991', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb617b5a3d0>]}
[0m17:54:11.333164 [info ] [MainThread]: Found 8 models, 34 data tests, 2 sources, 600 macros
[0m17:54:11.335111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '43947547-57bd-48d9-9494-936363aba991', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb616ed2c40>]}
[0m17:54:11.338600 [info ] [MainThread]: 
[0m17:54:11.340565 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:54:11.343045 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_northern-shield-437204-m0'
[0m17:54:11.344520 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:54:12.165428 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_northern-shield-437204-m0, now list_northern-shield-437204-m0_nyc_taxi)
[0m17:54:12.167170 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:54:12.842932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '43947547-57bd-48d9-9494-936363aba991', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5e5182190>]}
[0m17:54:12.844439 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:54:12.845875 [info ] [MainThread]: 
[0m17:54:12.855425 [debug] [Thread-1  ]: Began running node model.nyc_taxi.analytic_greentripdata
[0m17:54:12.856916 [info ] [Thread-1  ]: 1 of 1 START sql table model nyc_taxi.analytic_greentripdata ................... [RUN]
[0m17:54:12.858229 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_northern-shield-437204-m0_nyc_taxi, now model.nyc_taxi.analytic_greentripdata)
[0m17:54:12.859328 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.analytic_greentripdata
[0m17:54:12.874659 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.analytic_greentripdata"
[0m17:54:12.885309 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.analytic_greentripdata
[0m17:54:12.938642 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.analytic_greentripdata"
[0m17:54:12.946774 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:54:12.950658 [debug] [Thread-1  ]: On model.nyc_taxi.analytic_greentripdata: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.analytic_greentripdata"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`analytic_greentripdata`
      
    
    

    OPTIONS()
    as (
      WITH 
pickup_times AS (
    SELECT 
        fct.trip_id,
        pu_t.date_part AS pickup_datetime,
        pu_t."date" AS pickup_date,
        pu_t."hour" AS pickup_hour,
        FORMAT_DATE('%b', pu_t."date") AS month_name,
        UPPER(LEFT(pu_t.weekday, 3)) AS day_of_week
    FROM 
        `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips` fct
    JOIN `northern-shield-437204-m0`.`nyc_taxi`.`dim_time` pu_t ON fct.pickup_time_id = pu_t.time_id
),
dropoff_times AS (
    SELECT 
        fct.trip_id,
        do_t.date_part AS dropoff_datetime,
        TIMESTAMP_DIFF(do_t.date_part, pu_t.date_part, 'MINUTE') AS trip_duration_minutes
    FROM 
        `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips` fct
    JOIN `northern-shield-437204-m0`.`nyc_taxi`.`dim_time` pu_t ON fct.pickup_time_id = pu_t.time_id
    JOIN `northern-shield-437204-m0`.`nyc_taxi`.`dim_time` do_t ON fct.dropoff_time_id = do_t.time_id
),
trip_details AS (
    SELECT 
        fct.trip_id,
        v.vendor_name,
        p.payment_name AS payment_type,
        z_pickup.zone AS pu_zone,
        z_dropoff.zone AS do_zone,
        r.rate_code_name,
        tt.trip_name,
        fct.passenger_count,
        CASE 
            WHEN fct.passenger_count > 3 THEN '>3'
            ELSE fct.passenger_count::TEXT
        END AS passenger_count_group,
        fct.fare_amount,
        fct.tip_amount,
        fct.total_amount,
        (fct.total_amount - fct.fare_amount - fct.tip_amount) AS other_amount,
        fct.trip_distance,
        CASE 
            WHEN fct.trip_distance < 5 THEN '<5 miles'
            WHEN fct.trip_distance BETWEEN 5 AND 10 THEN '5-10 miles'
            WHEN fct.trip_distance BETWEEN 11 AND 20 THEN '11-20 miles'
            WHEN fct.trip_distance BETWEEN 21 AND 30 THEN '21-30 miles'
            WHEN fct.trip_distance BETWEEN 31 AND 40 THEN '31-40 miles'
            ELSE '>40 miles'
        END AS trip_distance_group
    FROM 
        `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips` fct
    JOIN `northern-shield-437204-m0`.`nyc_taxi`.`dim_vendor` v ON fct.vendor_id = v.vendor_id
    JOIN `northern-shield-437204-m0`.`nyc_taxi`.`dim_payment` p ON fct.payment_type = p.payment_id
    JOIN `northern-shield-437204-m0`.`nyc_taxi`.`dim_zone` z_pickup ON fct.pu_location_id = z_pickup.locationid
    JOIN `northern-shield-437204-m0`.`nyc_taxi`.`dim_zone` z_dropoff ON fct.do_location_id = z_dropoff.locationid
    JOIN `northern-shield-437204-m0`.`nyc_taxi`.`dim_ratecode` r ON fct.rate_code_id = r.rate_id
    JOIN `northern-shield-437204-m0`.`nyc_taxi`.`dim_triptype` tt ON fct.trip_type = tt.triptype_id
    WHERE 
        fct.trip_type IS NOT NULL
        AND fct.rate_code_id IS NOT NULL
        AND fct.trip_type != 99
        AND fct.rate_code_id != 99
)
SELECT 
	td.trip_id,
    pt.pickup_datetime,
    pt.pickup_date,
    pt.pickup_hour,
    pt.month_name,
    pt.day_of_week,
    dt.trip_duration_minutes,
    td.vendor_name,
    td.payment_type,
    td.pu_zone,
    td.do_zone,
    td.rate_code_name,
    td.trip_name,
    td.passenger_count,
    td.passenger_count_group,
    td.fare_amount,
    td.tip_amount,
    td.total_amount,
    td.other_amount,
    td.trip_distance,
    td.trip_distance_group
FROM 
    pickup_times pt
JOIN dropoff_times dt ON pt.trip_id = dt.trip_id
JOIN trip_details td ON pt.trip_id = td.trip_id
ORDER BY 
    td.trip_id;
    );
  
[0m17:54:14.297860 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:cfe80ce3-5c56-44b8-a9bc-0b17d00fd198&page=queryresults
[0m17:54:14.299543 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Unexpected string literal "date" at [18:14]; reason: invalidQuery, location: query, message: Syntax error: Unexpected string literal "date" at [18:14]')
[0m17:54:16.030042 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:7ddd9e06-23ca-488a-9537-335c9f047280&page=queryresults
[0m17:54:16.032672 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:7ddd9e06-23ca-488a-9537-335c9f047280&page=queryresults
[0m17:54:16.043433 [debug] [Thread-1  ]: Database Error in model analytic_greentripdata (models/report/analytic_greentripdata.sql)
  Syntax error: Unexpected string literal "date" at [18:14]
  compiled code at target/run/nyc_taxi/models/report/analytic_greentripdata.sql
[0m17:54:16.048092 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '43947547-57bd-48d9-9494-936363aba991', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6147a28b0>]}
[0m17:54:16.050892 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model nyc_taxi.analytic_greentripdata .......... [[31mERROR[0m in 3.19s]
[0m17:54:16.052763 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.analytic_greentripdata
[0m17:54:16.055061 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:54:16.055925 [debug] [MainThread]: Connection 'model.nyc_taxi.analytic_greentripdata' was properly closed.
[0m17:54:16.057173 [info ] [MainThread]: 
[0m17:54:16.058194 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.72 seconds (4.72s).
[0m17:54:16.059676 [debug] [MainThread]: Command end result
[0m17:54:16.146208 [info ] [MainThread]: 
[0m17:54:16.147829 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:54:16.149270 [info ] [MainThread]: 
[0m17:54:16.150917 [error] [MainThread]:   Database Error in model analytic_greentripdata (models/report/analytic_greentripdata.sql)
  Syntax error: Unexpected string literal "date" at [18:14]
  compiled code at target/run/nyc_taxi/models/report/analytic_greentripdata.sql
[0m17:54:16.152565 [info ] [MainThread]: 
[0m17:54:16.153867 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:54:16.155951 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 9.54059, "process_in_blocks": "212600", "process_kernel_time": 0.71523, "process_mem_max_rss": "244836", "process_out_blocks": "0", "process_user_time": 6.000502}
[0m17:54:16.157427 [debug] [MainThread]: Command `dbt run` failed at 17:54:16.157241 after 9.54 seconds
[0m17:54:16.158579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb61e8a3f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb617a1cbe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb617b5a0a0>]}
[0m17:54:16.159759 [debug] [MainThread]: Flushing usage events
[0m17:54:58.033444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faaa25c6f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faaa039c9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faaa039c970>]}


============================== 17:54:58.042874 | 41a9333e-823d-4ebb-b2bc-76b5b8079cb6 ==============================
[0m17:54:58.042874 [info ] [MainThread]: Running with dbt=1.8.9
[0m17:54:58.045143 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'printer_width': '80', 'empty': 'False', 'introspect': 'True', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --select analytic_greentripdata', 'static_parser': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'log_path': '/opt/airflow/include/dbt/logs', 'debug': 'False', 'log_cache_events': 'False', 'warn_error': 'None', 'profiles_dir': '/opt/airflow/include/dbt', 'write_json': 'True', 'quiet': 'False', 'version_check': 'True', 'cache_selected_only': 'False', 'no_print': 'None', 'partial_parse': 'True'}
[0m17:54:59.471613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '41a9333e-823d-4ebb-b2bc-76b5b8079cb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faaa04406a0>]}
[0m17:54:59.551449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '41a9333e-823d-4ebb-b2bc-76b5b8079cb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa68fe9be0>]}
[0m17:54:59.553389 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m17:54:59.785921 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m17:55:00.869557 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:55:00.872119 [debug] [MainThread]: Partial parsing: updated file: nyc_taxi://models/report/analytic_greentripdata.sql
[0m17:55:01.379207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '41a9333e-823d-4ebb-b2bc-76b5b8079cb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa9ace7130>]}
[0m17:55:01.594598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '41a9333e-823d-4ebb-b2bc-76b5b8079cb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa9b81fd90>]}
[0m17:55:01.596435 [info ] [MainThread]: Found 8 models, 34 data tests, 2 sources, 600 macros
[0m17:55:01.597982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '41a9333e-823d-4ebb-b2bc-76b5b8079cb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa9acd1be0>]}
[0m17:55:01.601661 [info ] [MainThread]: 
[0m17:55:01.603572 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:55:01.605940 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_northern-shield-437204-m0'
[0m17:55:01.607345 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:55:02.250415 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_northern-shield-437204-m0, now list_northern-shield-437204-m0_nyc_taxi)
[0m17:55:02.252067 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:55:03.135148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '41a9333e-823d-4ebb-b2bc-76b5b8079cb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa9b81fee0>]}
[0m17:55:03.136906 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:55:03.138307 [info ] [MainThread]: 
[0m17:55:03.147819 [debug] [Thread-1  ]: Began running node model.nyc_taxi.analytic_greentripdata
[0m17:55:03.149279 [info ] [Thread-1  ]: 1 of 1 START sql table model nyc_taxi.analytic_greentripdata ................... [RUN]
[0m17:55:03.150647 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_northern-shield-437204-m0_nyc_taxi, now model.nyc_taxi.analytic_greentripdata)
[0m17:55:03.151805 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.analytic_greentripdata
[0m17:55:03.166876 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.analytic_greentripdata"
[0m17:55:03.173957 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.analytic_greentripdata
[0m17:55:03.226238 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.analytic_greentripdata"
[0m17:55:03.232004 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:55:03.235637 [debug] [Thread-1  ]: On model.nyc_taxi.analytic_greentripdata: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.analytic_greentripdata"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`analytic_greentripdata`
      
    
    

    OPTIONS()
    as (
      WITH 
pickup_times AS (
    SELECT 
        fct.trip_id,
        pu_t.date_part AS pickup_datetime,
        pu_t.date AS pickup_date,
        pu_t.hour AS pickup_hour,
        FORMAT_DATE('%b', pu_t.date) AS month_name,
        UPPER(LEFT(pu_t.weekday, 3)) AS day_of_week
    FROM 
        `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips` fct
    JOIN `northern-shield-437204-m0`.`nyc_taxi`.`dim_time` pu_t ON fct.pickup_time_id = pu_t.time_id
),
dropoff_times AS (
    SELECT 
        fct.trip_id,
        do_t.date_part AS dropoff_datetime,
        TIMESTAMP_DIFF(do_t.date_part, pu_t.date_part, 'MINUTE') AS trip_duration_minutes
    FROM 
        `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips` fct
    JOIN `northern-shield-437204-m0`.`nyc_taxi`.`dim_time` pu_t ON fct.pickup_time_id = pu_t.time_id
    JOIN `northern-shield-437204-m0`.`nyc_taxi`.`dim_time` do_t ON fct.dropoff_time_id = do_t.time_id
),
trip_details AS (
    SELECT 
        fct.trip_id,
        v.vendor_name,
        p.payment_name AS payment_type,
        z_pickup.zone AS pu_zone,
        z_dropoff.zone AS do_zone,
        r.rate_code_name,
        tt.trip_name,
        fct.passenger_count,
        CASE 
            WHEN fct.passenger_count > 3 THEN '>3'
            ELSE fct.passenger_count::TEXT
        END AS passenger_count_group,
        fct.fare_amount,
        fct.tip_amount,
        fct.total_amount,
        (fct.total_amount - fct.fare_amount - fct.tip_amount) AS other_amount,
        fct.trip_distance,
        CASE 
            WHEN fct.trip_distance < 5 THEN '<5 miles'
            WHEN fct.trip_distance BETWEEN 5 AND 10 THEN '5-10 miles'
            WHEN fct.trip_distance BETWEEN 11 AND 20 THEN '11-20 miles'
            WHEN fct.trip_distance BETWEEN 21 AND 30 THEN '21-30 miles'
            WHEN fct.trip_distance BETWEEN 31 AND 40 THEN '31-40 miles'
            ELSE '>40 miles'
        END AS trip_distance_group
    FROM 
        `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips` fct
    JOIN `northern-shield-437204-m0`.`nyc_taxi`.`dim_vendor` v ON fct.vendor_id = v.vendor_id
    JOIN `northern-shield-437204-m0`.`nyc_taxi`.`dim_payment` p ON fct.payment_type = p.payment_id
    JOIN `northern-shield-437204-m0`.`nyc_taxi`.`dim_zone` z_pickup ON fct.pu_location_id = z_pickup.locationid
    JOIN `northern-shield-437204-m0`.`nyc_taxi`.`dim_zone` z_dropoff ON fct.do_location_id = z_dropoff.locationid
    JOIN `northern-shield-437204-m0`.`nyc_taxi`.`dim_ratecode` r ON fct.rate_code_id = r.rate_id
    JOIN `northern-shield-437204-m0`.`nyc_taxi`.`dim_triptype` tt ON fct.trip_type = tt.triptype_id
    WHERE 
        fct.trip_type IS NOT NULL
        AND fct.rate_code_id IS NOT NULL
        AND fct.trip_type != 99
        AND fct.rate_code_id != 99
)
SELECT 
	td.trip_id,
    pt.pickup_datetime,
    pt.pickup_date,
    pt.pickup_hour,
    pt.month_name,
    pt.day_of_week,
    dt.trip_duration_minutes,
    td.vendor_name,
    td.payment_type,
    td.pu_zone,
    td.do_zone,
    td.rate_code_name,
    td.trip_name,
    td.passenger_count,
    td.passenger_count_group,
    td.fare_amount,
    td.tip_amount,
    td.total_amount,
    td.other_amount,
    td.trip_distance,
    td.trip_distance_group
FROM 
    pickup_times pt
JOIN dropoff_times dt ON pt.trip_id = dt.trip_id
JOIN trip_details td ON pt.trip_id = td.trip_id
ORDER BY 
    td.trip_id;
    );
  
[0m17:55:04.246830 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:b2b8d1a0-99a7-45c0-aaa4-4441654f31d0&page=queryresults
[0m17:55:04.248933 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected keyword END but got ":" at [48:37]; reason: invalidQuery, location: query, message: Syntax error: Expected keyword END but got ":" at [48:37]')
[0m17:55:05.091196 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:e1563729-1c9c-406d-9f3b-1bcdc2e7e7a5&page=queryresults
[0m17:55:05.093113 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:e1563729-1c9c-406d-9f3b-1bcdc2e7e7a5&page=queryresults
[0m17:55:05.097613 [debug] [Thread-1  ]: Database Error in model analytic_greentripdata (models/report/analytic_greentripdata.sql)
  Syntax error: Expected keyword END but got ":" at [48:37]
  compiled code at target/run/nyc_taxi/models/report/analytic_greentripdata.sql
[0m17:55:05.100535 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '41a9333e-823d-4ebb-b2bc-76b5b8079cb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faaa10cf520>]}
[0m17:55:05.102566 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model nyc_taxi.analytic_greentripdata .......... [[31mERROR[0m in 1.95s]
[0m17:55:05.104480 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.analytic_greentripdata
[0m17:55:05.107309 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:55:05.108310 [debug] [MainThread]: Connection 'model.nyc_taxi.analytic_greentripdata' was properly closed.
[0m17:55:05.109272 [info ] [MainThread]: 
[0m17:55:05.110296 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.51 seconds (3.51s).
[0m17:55:05.111750 [debug] [MainThread]: Command end result
[0m17:55:05.203741 [info ] [MainThread]: 
[0m17:55:05.206013 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:55:05.208156 [info ] [MainThread]: 
[0m17:55:05.212343 [error] [MainThread]:   Database Error in model analytic_greentripdata (models/report/analytic_greentripdata.sql)
  Syntax error: Expected keyword END but got ":" at [48:37]
  compiled code at target/run/nyc_taxi/models/report/analytic_greentripdata.sql
[0m17:55:05.215135 [info ] [MainThread]: 
[0m17:55:05.217738 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:55:05.223263 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 7.27654, "process_in_blocks": "0", "process_kernel_time": 0.43145, "process_mem_max_rss": "245280", "process_out_blocks": "0", "process_user_time": 6.343237}
[0m17:55:05.228825 [debug] [MainThread]: Command `dbt run` failed at 17:55:05.228087 after 7.28 seconds
[0m17:55:05.232299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faaa25c6f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa9b7f6a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faaa04406a0>]}
[0m17:55:05.236448 [debug] [MainThread]: Flushing usage events
[0m17:55:40.075776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6db8e0430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6d9719a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6d9719a30>]}


============================== 17:55:40.086280 | 202351bf-feb8-4733-99e0-35b5ee75e017 ==============================
[0m17:55:40.086280 [info ] [MainThread]: Running with dbt=1.8.9
[0m17:55:40.088648 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'cache_selected_only': 'False', 'log_path': '/opt/airflow/include/dbt/logs', 'printer_width': '80', 'introspect': 'True', 'empty': 'False', 'static_parser': 'True', 'partial_parse': 'True', 'profiles_dir': '/opt/airflow/include/dbt', 'warn_error': 'None', 'target_path': 'None', 'quiet': 'False', 'write_json': 'True', 'version_check': 'True', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'debug': 'False', 'use_experimental_parser': 'False', 'log_format': 'default', 'no_print': 'None', 'invocation_command': 'dbt run --select analytic_greentripdata', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'log_cache_events': 'False', 'indirect_selection': 'eager'}
[0m17:55:41.739487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '202351bf-feb8-4733-99e0-35b5ee75e017', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6dabcef70>]}
[0m17:55:41.833939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '202351bf-feb8-4733-99e0-35b5ee75e017', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6a22aca60>]}
[0m17:55:41.836350 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m17:55:42.110677 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m17:55:43.319098 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:55:43.322795 [debug] [MainThread]: Partial parsing: updated file: nyc_taxi://models/report/analytic_greentripdata.sql
[0m17:55:43.987283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '202351bf-feb8-4733-99e0-35b5ee75e017', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6d36e2130>]}
[0m17:55:44.278244 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '202351bf-feb8-4733-99e0-35b5ee75e017', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6d4a21f10>]}
[0m17:55:44.280393 [info ] [MainThread]: Found 8 models, 34 data tests, 2 sources, 600 macros
[0m17:55:44.282154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '202351bf-feb8-4733-99e0-35b5ee75e017', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6d37282b0>]}
[0m17:55:44.286094 [info ] [MainThread]: 
[0m17:55:44.288219 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:55:44.291108 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_northern-shield-437204-m0'
[0m17:55:44.292839 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:55:44.962168 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_northern-shield-437204-m0, now list_northern-shield-437204-m0_nyc_taxi)
[0m17:55:44.963752 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:55:45.710973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '202351bf-feb8-4733-99e0-35b5ee75e017', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6dafe9c70>]}
[0m17:55:45.712653 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:55:45.714198 [info ] [MainThread]: 
[0m17:55:45.725687 [debug] [Thread-1  ]: Began running node model.nyc_taxi.analytic_greentripdata
[0m17:55:45.727838 [info ] [Thread-1  ]: 1 of 1 START sql table model nyc_taxi.analytic_greentripdata ................... [RUN]
[0m17:55:45.729768 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_northern-shield-437204-m0_nyc_taxi, now model.nyc_taxi.analytic_greentripdata)
[0m17:55:45.731896 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.analytic_greentripdata
[0m17:55:45.753887 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.analytic_greentripdata"
[0m17:55:45.761670 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.analytic_greentripdata
[0m17:55:45.843642 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.analytic_greentripdata"
[0m17:55:45.853570 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:55:45.859727 [debug] [Thread-1  ]: On model.nyc_taxi.analytic_greentripdata: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.analytic_greentripdata"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`analytic_greentripdata`
      
    
    

    OPTIONS()
    as (
      WITH 
pickup_times AS (
    SELECT 
        fct.trip_id,
        pu_t.date_part AS pickup_datetime,
        pu_t.date AS pickup_date,
        pu_t.hour AS pickup_hour,
        FORMAT_DATE('%b', pu_t.date) AS month_name,
        UPPER(LEFT(pu_t.weekday, 3)) AS day_of_week
    FROM 
        `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips` fct
    JOIN `northern-shield-437204-m0`.`nyc_taxi`.`dim_time` pu_t ON fct.pickup_time_id = pu_t.time_id
),
dropoff_times AS (
    SELECT 
        fct.trip_id,
        do_t.date_part AS dropoff_datetime,
        TIMESTAMP_DIFF(do_t.date_part, pu_t.date_part, 'MINUTE') AS trip_duration_minutes
    FROM 
        `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips` fct
    JOIN `northern-shield-437204-m0`.`nyc_taxi`.`dim_time` pu_t ON fct.pickup_time_id = pu_t.time_id
    JOIN `northern-shield-437204-m0`.`nyc_taxi`.`dim_time` do_t ON fct.dropoff_time_id = do_t.time_id
),
trip_details AS (
    SELECT 
        fct.trip_id,
        v.vendor_name,
        p.payment_name AS payment_type,
        z_pickup.zone AS pu_zone,
        z_dropoff.zone AS do_zone,
        r.rate_code_name,
        tt.trip_name,
        fct.passenger_count,
        CASE 
            WHEN fct.passenger_count > 3 THEN '>3'
            ELSE fct.passenger_count::TEXT
        END AS passenger_count_group,
        fct.fare_amount,
        fct.tip_amount,
        fct.total_amount,
        (fct.total_amount - fct.fare_amount - fct.tip_amount) AS other_amount,
        fct.trip_distance,
        CASE 
            WHEN fct.trip_distance < 5 THEN '<5 miles'
            WHEN fct.trip_distance BETWEEN 5 AND 10 THEN '5-10 miles'
            WHEN fct.trip_distance BETWEEN 11 AND 20 THEN '11-20 miles'
            WHEN fct.trip_distance BETWEEN 21 AND 30 THEN '21-30 miles'
            WHEN fct.trip_distance BETWEEN 31 AND 40 THEN '31-40 miles'
            ELSE '>40 miles'
        END AS trip_distance_group
    FROM 
        `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips` fct
    JOIN `northern-shield-437204-m0`.`nyc_taxi`.`dim_vendor` v ON fct.vendor_id = v.vendor_id
    JOIN `northern-shield-437204-m0`.`nyc_taxi`.`dim_payment` p ON fct.payment_type = p.payment_id
    JOIN `northern-shield-437204-m0`.`nyc_taxi`.`dim_zone` z_pickup ON fct.pu_location_id = z_pickup.locationid
    JOIN `northern-shield-437204-m0`.`nyc_taxi`.`dim_zone` z_dropoff ON fct.do_location_id = z_dropoff.locationid
    JOIN `northern-shield-437204-m0`.`nyc_taxi`.`dim_ratecode` r ON fct.rate_code_id = r.rate_id
    JOIN `northern-shield-437204-m0`.`nyc_taxi`.`dim_triptype` tt ON fct.trip_type = tt.triptype_id
    WHERE 
        fct.trip_type IS NOT NULL
        AND fct.rate_code_id IS NOT NULL
        AND fct.trip_type != 99
        AND fct.rate_code_id != 99
)
SELECT 
	td.trip_id,
    pt.pickup_datetime,
    pt.pickup_date,
    pt.pickup_hour,
    pt.month_name,
    pt.day_of_week,
    dt.trip_duration_minutes,
    td.vendor_name,
    td.payment_type,
    td.pu_zone,
    td.do_zone,
    td.rate_code_name,
    td.trip_name,
    td.passenger_count,
    td.passenger_count_group,
    td.fare_amount,
    td.tip_amount,
    td.total_amount,
    td.other_amount,
    td.trip_distance,
    td.trip_distance_group
FROM 
    pickup_times pt
JOIN dropoff_times dt ON pt.trip_id = dt.trip_id
JOIN trip_details td ON pt.trip_id = td.trip_id
ORDER BY 
    td.trip_id
    );
  
[0m17:55:46.672303 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:a1edfb6c-dea8-489f-8b54-69a5e688b8e1&page=queryresults
[0m17:55:46.675777 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected keyword END but got ":" at [48:37]; reason: invalidQuery, location: query, message: Syntax error: Expected keyword END but got ":" at [48:37]')
[0m17:55:47.562950 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:7729439c-0430-440b-b059-d6d4907ff66c&page=queryresults
[0m17:55:47.565017 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:7729439c-0430-440b-b059-d6d4907ff66c&page=queryresults
[0m17:55:47.569844 [debug] [Thread-1  ]: Database Error in model analytic_greentripdata (models/report/analytic_greentripdata.sql)
  Syntax error: Expected keyword END but got ":" at [48:37]
  compiled code at target/run/nyc_taxi/models/report/analytic_greentripdata.sql
[0m17:55:47.573213 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '202351bf-feb8-4733-99e0-35b5ee75e017', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6d3689280>]}
[0m17:55:47.575214 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model nyc_taxi.analytic_greentripdata .......... [[31mERROR[0m in 1.84s]
[0m17:55:47.577413 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.analytic_greentripdata
[0m17:55:47.580500 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:55:47.581871 [debug] [MainThread]: Connection 'model.nyc_taxi.analytic_greentripdata' was properly closed.
[0m17:55:47.583173 [info ] [MainThread]: 
[0m17:55:47.584633 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.30 seconds (3.30s).
[0m17:55:47.586830 [debug] [MainThread]: Command end result
[0m17:55:47.692914 [info ] [MainThread]: 
[0m17:55:47.695419 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:55:47.697100 [info ] [MainThread]: 
[0m17:55:47.699108 [error] [MainThread]:   Database Error in model analytic_greentripdata (models/report/analytic_greentripdata.sql)
  Syntax error: Expected keyword END but got ":" at [48:37]
  compiled code at target/run/nyc_taxi/models/report/analytic_greentripdata.sql
[0m17:55:47.700713 [info ] [MainThread]: 
[0m17:55:47.702486 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:55:47.705436 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 7.728547, "process_in_blocks": "0", "process_kernel_time": 0.407093, "process_mem_max_rss": "243428", "process_out_blocks": "0", "process_user_time": 6.60602}
[0m17:55:47.707687 [debug] [MainThread]: Command `dbt run` failed at 17:55:47.707377 after 7.73 seconds
[0m17:55:47.709175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6db8e0430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6a22aabe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6dabcef70>]}
[0m17:55:47.710829 [debug] [MainThread]: Flushing usage events
[0m17:57:39.554477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f9de7b400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f9bcb4a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f9bcb49a0>]}


============================== 17:57:39.565539 | c39f83fb-8707-453e-a9ea-18f3edab3344 ==============================
[0m17:57:39.565539 [info ] [MainThread]: Running with dbt=1.8.9
[0m17:57:39.567806 [debug] [MainThread]: running dbt with arguments {'empty': 'False', 'profiles_dir': '/opt/airflow/include/dbt', 'debug': 'False', 'invocation_command': 'dbt run --select analytic_greentripdata', 'log_path': '/opt/airflow/include/dbt/logs', 'warn_error': 'None', 'log_format': 'default', 'printer_width': '80', 'log_cache_events': 'False', 'no_print': 'None', 'use_experimental_parser': 'False', 'static_parser': 'True', 'quiet': 'False', 'version_check': 'True', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'write_json': 'True', 'fail_fast': 'False', 'indirect_selection': 'eager', 'use_colors': 'True', 'target_path': 'None', 'introspect': 'True'}
[0m17:57:41.353490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c39f83fb-8707-453e-a9ea-18f3edab3344', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f9d1011f0>]}
[0m17:57:41.441218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c39f83fb-8707-453e-a9ea-18f3edab3344', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f9e1d6670>]}
[0m17:57:41.443360 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m17:57:41.711613 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m17:57:42.800927 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:57:42.803736 [debug] [MainThread]: Partial parsing: updated file: nyc_taxi://models/report/analytic_greentripdata.sql
[0m17:57:43.337275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c39f83fb-8707-453e-a9ea-18f3edab3344', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f964e7130>]}
[0m17:57:43.555972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c39f83fb-8707-453e-a9ea-18f3edab3344', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f9701f880>]}
[0m17:57:43.557560 [info ] [MainThread]: Found 8 models, 34 data tests, 2 sources, 600 macros
[0m17:57:43.558978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c39f83fb-8707-453e-a9ea-18f3edab3344', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f964d1220>]}
[0m17:57:43.562182 [info ] [MainThread]: 
[0m17:57:43.563994 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:57:43.566394 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_northern-shield-437204-m0'
[0m17:57:43.567727 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:57:44.203317 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_northern-shield-437204-m0, now list_northern-shield-437204-m0_nyc_taxi)
[0m17:57:44.204765 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:57:44.792897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c39f83fb-8707-453e-a9ea-18f3edab3344', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f9e1c78b0>]}
[0m17:57:44.794440 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:57:44.795640 [info ] [MainThread]: 
[0m17:57:44.805758 [debug] [Thread-1  ]: Began running node model.nyc_taxi.analytic_greentripdata
[0m17:57:44.807330 [info ] [Thread-1  ]: 1 of 1 START sql table model nyc_taxi.analytic_greentripdata ................... [RUN]
[0m17:57:44.808622 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_northern-shield-437204-m0_nyc_taxi, now model.nyc_taxi.analytic_greentripdata)
[0m17:57:44.809892 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.analytic_greentripdata
[0m17:57:44.826335 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.analytic_greentripdata"
[0m17:57:44.833203 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.analytic_greentripdata
[0m17:57:44.899599 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.analytic_greentripdata"
[0m17:57:44.907752 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:57:44.912348 [debug] [Thread-1  ]: On model.nyc_taxi.analytic_greentripdata: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.analytic_greentripdata"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`analytic_greentripdata`
      
    
    

    OPTIONS()
    as (
      WITH 
pickup_times AS (
    SELECT 
        fct.trip_id,
        pu_t.date_part AS pickup_datetime,
        pu_t.date AS pickup_date,
        pu_t.hour AS pickup_hour,
        FORMAT_DATE('%b', pu_t.date) AS month_name,
        UPPER(LEFT(pu_t.weekday, 3)) AS day_of_week
    FROM 
        `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips` fct
    JOIN `northern-shield-437204-m0`.`nyc_taxi`.`dim_time` pu_t ON fct.pickup_time_id = pu_t.time_id
),
dropoff_times AS (
    SELECT 
        fct.trip_id,
        do_t.date_part AS dropoff_datetime,
        TIMESTAMP_DIFF(do_t.date_part, pu_t.date_part, 'MINUTE') AS trip_duration_minutes
    FROM 
        `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips` fct
    JOIN `northern-shield-437204-m0`.`nyc_taxi`.`dim_time` pu_t ON fct.pickup_time_id = pu_t.time_id
    JOIN `northern-shield-437204-m0`.`nyc_taxi`.`dim_time` do_t ON fct.dropoff_time_id = do_t.time_id
),
trip_details AS (
    SELECT 
        fct.trip_id,
        v.vendor_name,
        p.payment_name AS payment_type,
        z_pickup.zone AS pu_zone,
        z_dropoff.zone AS do_zone,
        r.rate_code_name,
        tt.trip_name,
        fct.passenger_count,
        CASE 
            WHEN fct.passenger_count > 3 THEN '>3'
            ELSE CAST(fct.passenger_count AS STRING)
        END AS passenger_count_group,
        fct.fare_amount,
        fct.tip_amount,
        fct.total_amount,
        (fct.total_amount - fct.fare_amount - fct.tip_amount) AS other_amount,
        fct.trip_distance,
        CASE 
            WHEN fct.trip_distance < 5 THEN '<5 miles'
            WHEN fct.trip_distance BETWEEN 5 AND 10 THEN '5-10 miles'
            WHEN fct.trip_distance BETWEEN 11 AND 20 THEN '11-20 miles'
            WHEN fct.trip_distance BETWEEN 21 AND 30 THEN '21-30 miles'
            WHEN fct.trip_distance BETWEEN 31 AND 40 THEN '31-40 miles'
            ELSE '>40 miles'
        END AS trip_distance_group
    FROM 
        `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips` fct
    JOIN `northern-shield-437204-m0`.`nyc_taxi`.`dim_vendor` v ON fct.vendor_id = v.vendor_id
    JOIN `northern-shield-437204-m0`.`nyc_taxi`.`dim_payment` p ON fct.payment_type = p.payment_id
    JOIN `northern-shield-437204-m0`.`nyc_taxi`.`dim_zone` z_pickup ON fct.pu_location_id = z_pickup.locationid
    JOIN `northern-shield-437204-m0`.`nyc_taxi`.`dim_zone` z_dropoff ON fct.do_location_id = z_dropoff.locationid
    JOIN `northern-shield-437204-m0`.`nyc_taxi`.`dim_ratecode` r ON fct.rate_code_id = r.rate_id
    JOIN `northern-shield-437204-m0`.`nyc_taxi`.`dim_triptype` tt ON fct.trip_type = tt.triptype_id
    WHERE 
        fct.trip_type IS NOT NULL
        AND fct.rate_code_id IS NOT NULL
        AND fct.trip_type != 99
        AND fct.rate_code_id != 99
)
SELECT 
	td.trip_id,
    pt.pickup_datetime,
    pt.pickup_date,
    pt.pickup_hour,
    pt.month_name,
    pt.day_of_week,
    dt.trip_duration_minutes,
    td.vendor_name,
    td.payment_type,
    td.pu_zone,
    td.do_zone,
    td.rate_code_name,
    td.trip_name,
    td.passenger_count,
    td.passenger_count_group,
    td.fare_amount,
    td.tip_amount,
    td.total_amount,
    td.other_amount,
    td.trip_distance,
    td.trip_distance_group
FROM 
    pickup_times pt
JOIN dropoff_times dt ON pt.trip_id = dt.trip_id
JOIN trip_details td ON pt.trip_id = td.trip_id
ORDER BY 
    td.trip_id
    );
  
[0m17:57:45.947930 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:c3f01eb5-f23f-41ab-892d-eacef8b3f7dd&page=queryresults
[0m17:57:46.312195 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('A valid date part name is required at [30:56]; reason: invalidQuery, location: query, message: A valid date part name is required at [30:56]')
[0m17:57:48.035066 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:5382e35a-a357-418e-80f9-4c6b8f4c17b3&page=queryresults
[0m17:57:48.393092 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:5382e35a-a357-418e-80f9-4c6b8f4c17b3&page=queryresults
[0m17:57:48.397710 [debug] [Thread-1  ]: Database Error in model analytic_greentripdata (models/report/analytic_greentripdata.sql)
  A valid date part name is required at [30:56]
  compiled code at target/run/nyc_taxi/models/report/analytic_greentripdata.sql
[0m17:57:48.400526 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c39f83fb-8707-453e-a9ea-18f3edab3344', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f9c9d6160>]}
[0m17:57:48.402077 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model nyc_taxi.analytic_greentripdata .......... [[31mERROR[0m in 3.59s]
[0m17:57:48.404140 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.analytic_greentripdata
[0m17:57:48.407234 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:57:48.408679 [debug] [MainThread]: Connection 'model.nyc_taxi.analytic_greentripdata' was properly closed.
[0m17:57:48.409895 [info ] [MainThread]: 
[0m17:57:48.411061 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.85 seconds (4.85s).
[0m17:57:48.412752 [debug] [MainThread]: Command end result
[0m17:57:48.486584 [info ] [MainThread]: 
[0m17:57:48.488139 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:57:48.489346 [info ] [MainThread]: 
[0m17:57:48.490617 [error] [MainThread]:   Database Error in model analytic_greentripdata (models/report/analytic_greentripdata.sql)
  A valid date part name is required at [30:56]
  compiled code at target/run/nyc_taxi/models/report/analytic_greentripdata.sql
[0m17:57:48.491775 [info ] [MainThread]: 
[0m17:57:48.492876 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:57:48.494612 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 9.052268, "process_in_blocks": "0", "process_kernel_time": 0.489452, "process_mem_max_rss": "245884", "process_out_blocks": "0", "process_user_time": 6.741514}
[0m17:57:48.496222 [debug] [MainThread]: Command `dbt run` failed at 17:57:48.496029 after 9.05 seconds
[0m17:57:48.497380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f9de7b400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f9f8ff910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f9652a760>]}
[0m17:57:48.498521 [debug] [MainThread]: Flushing usage events
[0m18:29:55.862905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f530e79a430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f530c5d3a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f530c5d3a00>]}


============================== 18:29:55.873672 | 2570b6be-a4e7-4b34-a5c9-0a9b86e92a37 ==============================
[0m18:29:55.873672 [info ] [MainThread]: Running with dbt=1.8.9
[0m18:29:55.876055 [debug] [MainThread]: running dbt with arguments {'debug': 'False', 'partial_parse': 'True', 'introspect': 'True', 'warn_error': 'None', 'invocation_command': 'dbt run --select analytic_greentripdata', 'log_format': 'default', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'fail_fast': 'False', 'version_check': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'no_print': 'None', 'profiles_dir': '/opt/airflow/include/dbt', 'use_colors': 'True', 'printer_width': '80', 'empty': 'False', 'cache_selected_only': 'False', 'log_path': '/opt/airflow/include/dbt/logs', 'quiet': 'False', 'use_experimental_parser': 'False', 'write_json': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])'}
[0m18:29:57.864135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2570b6be-a4e7-4b34-a5c9-0a9b86e92a37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52d5f77670>]}
[0m18:29:57.961292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2570b6be-a4e7-4b34-a5c9-0a9b86e92a37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52d51c47f0>]}
[0m18:29:57.963612 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m18:29:58.272213 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m18:29:59.518408 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:29:59.522086 [debug] [MainThread]: Partial parsing: updated file: nyc_taxi://models/report/analytic_greentripdata.sql
[0m18:30:00.167780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2570b6be-a4e7-4b34-a5c9-0a9b86e92a37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53066e3130>]}
[0m18:30:00.437105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2570b6be-a4e7-4b34-a5c9-0a9b86e92a37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5307a2d6a0>]}
[0m18:30:00.439107 [info ] [MainThread]: Found 8 models, 34 data tests, 2 sources, 600 macros
[0m18:30:00.440898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2570b6be-a4e7-4b34-a5c9-0a9b86e92a37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53079dadf0>]}
[0m18:30:00.444382 [info ] [MainThread]: 
[0m18:30:00.446490 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:30:00.449497 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_northern-shield-437204-m0'
[0m18:30:00.451285 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:30:01.194788 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_northern-shield-437204-m0, now list_northern-shield-437204-m0_nyc_taxi)
[0m18:30:01.196542 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:30:01.859582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2570b6be-a4e7-4b34-a5c9-0a9b86e92a37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52d516a3d0>]}
[0m18:30:01.861396 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:30:01.862807 [info ] [MainThread]: 
[0m18:30:01.873307 [debug] [Thread-1  ]: Began running node model.nyc_taxi.analytic_greentripdata
[0m18:30:01.875406 [info ] [Thread-1  ]: 1 of 1 START sql table model nyc_taxi.analytic_greentripdata ................... [RUN]
[0m18:30:01.877589 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_northern-shield-437204-m0_nyc_taxi, now model.nyc_taxi.analytic_greentripdata)
[0m18:30:01.879479 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.analytic_greentripdata
[0m18:30:01.900687 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.analytic_greentripdata"
[0m18:30:01.908251 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.analytic_greentripdata
[0m18:30:01.989087 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.analytic_greentripdata"
[0m18:30:01.997761 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:30:02.003633 [debug] [Thread-1  ]: On model.nyc_taxi.analytic_greentripdata: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.analytic_greentripdata"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`analytic_greentripdata`
      
    
    

    OPTIONS()
    as (
      WITH 
pickup_times AS (
    SELECT 
        fct.trip_id,
        pu_t.date_part AS pickup_datetime,
        pu_t.date AS pickup_date,
        pu_t.hour AS pickup_hour,
        FORMAT_DATE('%b', pu_t.date) AS month_name,
        UPPER(LEFT(pu_t.weekday, 3)) AS day_of_week
    FROM 
        `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips` fct
    JOIN `northern-shield-437204-m0`.`nyc_taxi`.`dim_time` pu_t ON fct.pickup_time_id = pu_t.time_id
),
dropoff_times AS (
    SELECT 
        fct.trip_id,
        do_t.date_part AS dropoff_datetime,
        TIMESTAMP_DIFF(do_t.date_part, pu_t.date_part, MINUTE) AS trip_duration_minutes
    FROM 
        `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips` fct
    JOIN `northern-shield-437204-m0`.`nyc_taxi`.`dim_time` pu_t ON fct.pickup_time_id = pu_t.time_id
    JOIN `northern-shield-437204-m0`.`nyc_taxi`.`dim_time` do_t ON fct.dropoff_time_id = do_t.time_id
),
trip_details AS (
    SELECT 
        fct.trip_id,
        v.vendor_name,
        p.payment_name AS payment_type,
        z_pickup.zone AS pu_zone,
        z_dropoff.zone AS do_zone,
        r.rate_code_name,
        tt.trip_name,
        fct.passenger_count,
        CASE 
            WHEN fct.passenger_count > 3 THEN '>3'
            ELSE CAST(fct.passenger_count AS STRING)
        END AS passenger_count_group,
        fct.fare_amount,
        fct.tip_amount,
        fct.total_amount,
        (fct.total_amount - fct.fare_amount - fct.tip_amount) AS other_amount,
        fct.trip_distance,
        CASE 
            WHEN fct.trip_distance < 5 THEN '<5 miles'
            WHEN fct.trip_distance BETWEEN 5 AND 10 THEN '5-10 miles'
            WHEN fct.trip_distance BETWEEN 11 AND 20 THEN '11-20 miles'
            WHEN fct.trip_distance BETWEEN 21 AND 30 THEN '21-30 miles'
            WHEN fct.trip_distance BETWEEN 31 AND 40 THEN '31-40 miles'
            ELSE '>40 miles'
        END AS trip_distance_group
    FROM 
        `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips` fct
    JOIN `northern-shield-437204-m0`.`nyc_taxi`.`dim_vendor` v ON fct.vendor_id = v.vendor_id
    JOIN `northern-shield-437204-m0`.`nyc_taxi`.`dim_payment` p ON fct.payment_type = p.payment_id
    JOIN `northern-shield-437204-m0`.`nyc_taxi`.`dim_zone` z_pickup ON fct.pu_location_id = z_pickup.locationid
    JOIN `northern-shield-437204-m0`.`nyc_taxi`.`dim_zone` z_dropoff ON fct.do_location_id = z_dropoff.locationid
    JOIN `northern-shield-437204-m0`.`nyc_taxi`.`dim_ratecode` r ON fct.rate_code_id = r.rate_id
    JOIN `northern-shield-437204-m0`.`nyc_taxi`.`dim_triptype` tt ON fct.trip_type = tt.triptype_id
    WHERE 
        fct.trip_type IS NOT NULL
        AND fct.rate_code_id IS NOT NULL
        AND fct.trip_type != 99
        AND fct.rate_code_id != 99
)
SELECT 
	td.trip_id,
    pt.pickup_datetime,
    pt.pickup_date,
    pt.pickup_hour,
    pt.month_name,
    pt.day_of_week,
    dt.trip_duration_minutes,
    td.vendor_name,
    td.payment_type,
    td.pu_zone,
    td.do_zone,
    td.rate_code_name,
    td.trip_name,
    td.passenger_count,
    td.passenger_count_group,
    td.fare_amount,
    td.tip_amount,
    td.total_amount,
    td.other_amount,
    td.trip_distance,
    td.trip_distance_group
FROM 
    pickup_times pt
JOIN dropoff_times dt ON pt.trip_id = dt.trip_id
JOIN trip_details td ON pt.trip_id = td.trip_id
ORDER BY 
    td.trip_id
    );
  
[0m18:30:03.100118 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:0e977800-f09d-47a1-864c-b7072eb7594a&page=queryresults
[0m18:30:03.519631 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Name vendor_id not found inside v at [65:85]; reason: invalidQuery, location: query, message: Name vendor_id not found inside v at [65:85]')
[0m18:30:04.237306 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:1c5e0f17-08fe-4ef3-b5c5-d00620f671d2&page=queryresults
[0m18:30:04.614849 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:1c5e0f17-08fe-4ef3-b5c5-d00620f671d2&page=queryresults
[0m18:30:04.620378 [debug] [Thread-1  ]: Database Error in model analytic_greentripdata (models/report/analytic_greentripdata.sql)
  Name vendor_id not found inside v at [65:85]
  compiled code at target/run/nyc_taxi/models/report/analytic_greentripdata.sql
[0m18:30:04.623821 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2570b6be-a4e7-4b34-a5c9-0a9b86e92a37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5301fa9bb0>]}
[0m18:30:04.625841 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model nyc_taxi.analytic_greentripdata .......... [[31mERROR[0m in 2.74s]
[0m18:30:04.627913 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.analytic_greentripdata
[0m18:30:04.630959 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:30:04.632337 [debug] [MainThread]: Connection 'model.nyc_taxi.analytic_greentripdata' was properly closed.
[0m18:30:04.633619 [info ] [MainThread]: 
[0m18:30:04.635275 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.19 seconds (4.19s).
[0m18:30:04.637353 [debug] [MainThread]: Command end result
[0m18:30:04.748129 [info ] [MainThread]: 
[0m18:30:04.750483 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:30:04.752075 [info ] [MainThread]: 
[0m18:30:04.754036 [error] [MainThread]:   Database Error in model analytic_greentripdata (models/report/analytic_greentripdata.sql)
  Name vendor_id not found inside v at [65:85]
  compiled code at target/run/nyc_taxi/models/report/analytic_greentripdata.sql
[0m18:30:04.755686 [info ] [MainThread]: 
[0m18:30:04.757437 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m18:30:04.760421 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 9.009527, "process_in_blocks": "0", "process_kernel_time": 0.594413, "process_mem_max_rss": "243472", "process_out_blocks": "0", "process_user_time": 7.328}
[0m18:30:04.762482 [debug] [MainThread]: Command `dbt run` failed at 18:30:04.762140 after 9.01 seconds
[0m18:30:04.764180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f530e79a430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52d5147850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52d5f77670>]}
[0m18:30:04.765973 [debug] [MainThread]: Flushing usage events
[0m18:30:51.896876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c34612f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c323e99d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c323e9970>]}


============================== 18:30:51.907962 | 34a24986-0582-497a-9143-cd0223320aca ==============================
[0m18:30:51.907962 [info ] [MainThread]: Running with dbt=1.8.9
[0m18:30:51.910108 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'empty': 'False', 'cache_selected_only': 'False', 'partial_parse': 'True', 'log_path': '/opt/airflow/include/dbt/logs', 'log_cache_events': 'False', 'quiet': 'False', 'printer_width': '80', 'warn_error': 'None', 'target_path': 'None', 'debug': 'False', 'indirect_selection': 'eager', 'profiles_dir': '/opt/airflow/include/dbt', 'log_format': 'default', 'no_print': 'None', 'invocation_command': 'dbt run --select analytic_greentripdata', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'use_colors': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'write_json': 'True'}
[0m18:30:53.473381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '34a24986-0582-497a-9143-cd0223320aca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1bfbcf5a60>]}
[0m18:30:53.561160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '34a24986-0582-497a-9143-cd0223320aca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1bfaf5afd0>]}
[0m18:30:53.563043 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m18:30:53.833952 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m18:30:55.140675 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:30:55.143752 [debug] [MainThread]: Partial parsing: updated file: nyc_taxi://models/report/analytic_greentripdata.sql
[0m18:30:55.801817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '34a24986-0582-497a-9143-cd0223320aca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c2cce7130>]}
[0m18:30:56.121473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '34a24986-0582-497a-9143-cd0223320aca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c2d833400>]}
[0m18:30:56.123565 [info ] [MainThread]: Found 8 models, 34 data tests, 2 sources, 600 macros
[0m18:30:56.125310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '34a24986-0582-497a-9143-cd0223320aca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c2cd2b040>]}
[0m18:30:56.129411 [info ] [MainThread]: 
[0m18:30:56.131424 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:30:56.133975 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_northern-shield-437204-m0'
[0m18:30:56.135460 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:30:56.817717 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_northern-shield-437204-m0, now list_northern-shield-437204-m0_nyc_taxi)
[0m18:30:56.819740 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:30:57.447016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '34a24986-0582-497a-9143-cd0223320aca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1bfaef8b50>]}
[0m18:30:57.448806 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:30:57.450148 [info ] [MainThread]: 
[0m18:30:57.460391 [debug] [Thread-1  ]: Began running node model.nyc_taxi.analytic_greentripdata
[0m18:30:57.462410 [info ] [Thread-1  ]: 1 of 1 START sql table model nyc_taxi.analytic_greentripdata ................... [RUN]
[0m18:30:57.464416 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_northern-shield-437204-m0_nyc_taxi, now model.nyc_taxi.analytic_greentripdata)
[0m18:30:57.466263 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.analytic_greentripdata
[0m18:30:57.487154 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.analytic_greentripdata"
[0m18:30:57.496495 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.analytic_greentripdata
[0m18:30:57.578148 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.analytic_greentripdata"
[0m18:30:57.588311 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:30:57.594121 [debug] [Thread-1  ]: On model.nyc_taxi.analytic_greentripdata: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.analytic_greentripdata"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`analytic_greentripdata`
      
    
    

    OPTIONS()
    as (
      WITH 
pickup_times AS (
    SELECT 
        fct.trip_id,
        pu_t.date_part AS pickup_datetime,
        pu_t.date AS pickup_date,
        pu_t.hour AS pickup_hour,
        FORMAT_DATE('%b', pu_t.date) AS month_name,
        UPPER(LEFT(pu_t.weekday, 3)) AS day_of_week
    FROM 
        `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips` fct
    JOIN `northern-shield-437204-m0`.`nyc_taxi`.`dim_time` pu_t ON fct.pickup_time_id = pu_t.time_id
),
dropoff_times AS (
    SELECT 
        fct.trip_id,
        do_t.date_part AS dropoff_datetime,
        TIMESTAMP_DIFF(do_t.date_part, pu_t.date_part, MINUTE) AS trip_duration_minutes
    FROM 
        `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips` fct
    JOIN `northern-shield-437204-m0`.`nyc_taxi`.`dim_time` pu_t ON fct.pickup_time_id = pu_t.time_id
    JOIN `northern-shield-437204-m0`.`nyc_taxi`.`dim_time` do_t ON fct.dropoff_time_id = do_t.time_id
),
trip_details AS (
    SELECT 
        fct.trip_id,
        v.vendor_name,
        p.payment_name AS payment_type,
        z_pickup.zone AS pu_zone,
        z_dropoff.zone AS do_zone,
        r.rate_code_name,
        tt.trip_name,
        fct.passenger_count,
        CASE 
            WHEN fct.passenger_count > 3 THEN '>3'
            ELSE CAST(fct.passenger_count AS STRING)
        END AS passenger_count_group,
        fct.fare_amount,
        fct.tip_amount,
        fct.total_amount,
        (fct.total_amount - fct.fare_amount - fct.tip_amount) AS other_amount,
        fct.trip_distance,
        CASE 
            WHEN fct.trip_distance < 5 THEN '<5 miles'
            WHEN fct.trip_distance BETWEEN 5 AND 10 THEN '5-10 miles'
            WHEN fct.trip_distance BETWEEN 11 AND 20 THEN '11-20 miles'
            WHEN fct.trip_distance BETWEEN 21 AND 30 THEN '21-30 miles'
            WHEN fct.trip_distance BETWEEN 31 AND 40 THEN '31-40 miles'
            ELSE '>40 miles'
        END AS trip_distance_group
    FROM 
        `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips` fct
    JOIN `northern-shield-437204-m0`.`nyc_taxi`.`dim_vendor` v ON fct.vendor_id = v.id
    JOIN `northern-shield-437204-m0`.`nyc_taxi`.`dim_payment` p ON fct.payment_type = p.payment_id
    JOIN `northern-shield-437204-m0`.`nyc_taxi`.`dim_zone` z_pickup ON fct.pu_location_id = z_pickup.locationid
    JOIN `northern-shield-437204-m0`.`nyc_taxi`.`dim_zone` z_dropoff ON fct.do_location_id = z_dropoff.locationid
    JOIN `northern-shield-437204-m0`.`nyc_taxi`.`dim_ratecode` r ON fct.rate_code_id = r.rate_id
    JOIN `northern-shield-437204-m0`.`nyc_taxi`.`dim_triptype` tt ON fct.trip_type = tt.triptype_id
    WHERE 
        fct.trip_type IS NOT NULL
        AND fct.rate_code_id IS NOT NULL
        AND fct.trip_type != 99
        AND fct.rate_code_id != 99
)
SELECT 
	td.trip_id,
    pt.pickup_datetime,
    pt.pickup_date,
    pt.pickup_hour,
    pt.month_name,
    pt.day_of_week,
    dt.trip_duration_minutes,
    td.vendor_name,
    td.payment_type,
    td.pu_zone,
    td.do_zone,
    td.rate_code_name,
    td.trip_name,
    td.passenger_count,
    td.passenger_count_group,
    td.fare_amount,
    td.tip_amount,
    td.total_amount,
    td.other_amount,
    td.trip_distance,
    td.trip_distance_group
FROM 
    pickup_times pt
JOIN dropoff_times dt ON pt.trip_id = dt.trip_id
JOIN trip_details td ON pt.trip_id = td.trip_id
ORDER BY 
    td.trip_id
    );
  
[0m18:30:58.742804 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:19f2aa59-3d3e-45e2-bbb5-b021d160a56a&page=queryresults
[0m18:30:59.127482 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Name payment_id not found inside p at [66:89]; reason: invalidQuery, location: query, message: Name payment_id not found inside p at [66:89]')
[0m18:30:59.872894 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:896bd642-1fa8-4930-9ca9-8ae98a2c490e&page=queryresults
[0m18:31:00.228317 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:896bd642-1fa8-4930-9ca9-8ae98a2c490e&page=queryresults
[0m18:31:00.232831 [debug] [Thread-1  ]: Database Error in model analytic_greentripdata (models/report/analytic_greentripdata.sql)
  Name payment_id not found inside p at [66:89]
  compiled code at target/run/nyc_taxi/models/report/analytic_greentripdata.sql
[0m18:31:00.235412 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '34a24986-0582-497a-9143-cd0223320aca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c3311c580>]}
[0m18:31:00.236958 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model nyc_taxi.analytic_greentripdata .......... [[31mERROR[0m in 2.77s]
[0m18:31:00.238779 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.analytic_greentripdata
[0m18:31:00.241991 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:31:00.243250 [debug] [MainThread]: Connection 'model.nyc_taxi.analytic_greentripdata' was properly closed.
[0m18:31:00.244472 [info ] [MainThread]: 
[0m18:31:00.245899 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.11 seconds (4.11s).
[0m18:31:00.248124 [debug] [MainThread]: Command end result
[0m18:31:00.351956 [info ] [MainThread]: 
[0m18:31:00.354444 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:31:00.356212 [info ] [MainThread]: 
[0m18:31:00.358137 [error] [MainThread]:   Database Error in model analytic_greentripdata (models/report/analytic_greentripdata.sql)
  Name payment_id not found inside p at [66:89]
  compiled code at target/run/nyc_taxi/models/report/analytic_greentripdata.sql
[0m18:31:00.359840 [info ] [MainThread]: 
[0m18:31:00.361955 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m18:31:00.364941 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 8.574828, "process_in_blocks": "0", "process_kernel_time": 0.465847, "process_mem_max_rss": "245308", "process_out_blocks": "0", "process_user_time": 6.680255}
[0m18:31:00.367577 [debug] [MainThread]: Command `dbt run` failed at 18:31:00.367180 after 8.58 seconds
[0m18:31:00.369400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c34612f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c2d8ffcd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1bfbcf5a60>]}
[0m18:31:00.371170 [debug] [MainThread]: Flushing usage events
[0m18:33:28.109824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9be7a9f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9bc57fa00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9bc57f9a0>]}


============================== 18:33:28.118288 | 17790104-7956-420b-8906-c9e63e6cc8a6 ==============================
[0m18:33:28.118288 [info ] [MainThread]: Running with dbt=1.8.9
[0m18:33:28.119858 [debug] [MainThread]: running dbt with arguments {'log_path': '/opt/airflow/include/dbt/logs', 'send_anonymous_usage_stats': 'True', 'introspect': 'True', 'use_colors': 'True', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'empty': 'None', 'use_experimental_parser': 'False', 'cache_selected_only': 'False', 'static_parser': 'True', 'warn_error': 'None', 'profiles_dir': '/opt/airflow/include/dbt', 'log_cache_events': 'False', 'printer_width': '80', 'target_path': 'None', 'fail_fast': 'False', 'partial_parse': 'True', 'indirect_selection': 'eager', 'log_format': 'default', 'write_json': 'True', 'quiet': 'False', 'debug': 'False', 'version_check': 'True', 'invocation_command': 'dbt test --select analytic_greentripdata'}
[0m18:33:29.421607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '17790104-7956-420b-8906-c9e63e6cc8a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9851d7970>]}
[0m18:33:29.489868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '17790104-7956-420b-8906-c9e63e6cc8a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9851d7f10>]}
[0m18:33:29.491483 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m18:33:29.681267 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m18:33:30.488019 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:33:30.490207 [debug] [MainThread]: Partial parsing: updated file: nyc_taxi://models/report/analytic_greentripdata.sql
[0m18:33:30.940888 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '17790104-7956-420b-8906-c9e63e6cc8a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9b64e1130>]}
[0m18:33:31.140426 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '17790104-7956-420b-8906-c9e63e6cc8a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd985410d60>]}
[0m18:33:31.141945 [info ] [MainThread]: Found 8 models, 34 data tests, 2 sources, 600 macros
[0m18:33:31.143472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '17790104-7956-420b-8906-c9e63e6cc8a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9b6526ac0>]}
[0m18:33:31.146167 [info ] [MainThread]: 
[0m18:33:31.147438 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m18:33:31.148870 [debug] [MainThread]: Command end result
[0m18:33:31.223360 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 3.18917, "process_in_blocks": "1440", "process_kernel_time": 0.323971, "process_mem_max_rss": "243800", "process_out_blocks": "0", "process_user_time": 5.28537}
[0m18:33:31.224852 [debug] [MainThread]: Command `dbt test` succeeded at 18:33:31.224662 after 3.19 seconds
[0m18:33:31.225957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9be7a9f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9b64cb4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9b6526af0>]}
[0m18:33:31.226990 [debug] [MainThread]: Flushing usage events
[0m18:33:53.370131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d7fd2ff70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d7db06a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d7db069d0>]}


============================== 18:33:53.379730 | da700414-89db-400f-a54b-71bc2fbeb9d2 ==============================
[0m18:33:53.379730 [info ] [MainThread]: Running with dbt=1.8.9
[0m18:33:53.381561 [debug] [MainThread]: running dbt with arguments {'profiles_dir': '/opt/airflow/include/dbt', 'invocation_command': 'dbt run --select analytic_greentripdata', 'empty': 'False', 'use_experimental_parser': 'False', 'target_path': 'None', 'static_parser': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'use_colors': 'True', 'log_format': 'default', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'printer_width': '80', 'fail_fast': 'False', 'introspect': 'True', 'write_json': 'True', 'quiet': 'False', 'log_path': '/opt/airflow/include/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'debug': 'False', 'no_print': 'None'}
[0m18:33:54.770189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'da700414-89db-400f-a54b-71bc2fbeb9d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d466e3c70>]}
[0m18:33:54.845056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'da700414-89db-400f-a54b-71bc2fbeb9d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d4668f400>]}
[0m18:33:54.847068 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m18:33:55.054696 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m18:33:56.020388 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:33:56.021697 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:33:56.110844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'da700414-89db-400f-a54b-71bc2fbeb9d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d78ddb130>]}
[0m18:33:56.571930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'da700414-89db-400f-a54b-71bc2fbeb9d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d78e20340>]}
[0m18:33:56.573976 [info ] [MainThread]: Found 8 models, 34 data tests, 2 sources, 600 macros
[0m18:33:56.575784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'da700414-89db-400f-a54b-71bc2fbeb9d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d46790760>]}
[0m18:33:56.579527 [info ] [MainThread]: 
[0m18:33:56.581545 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:33:56.584300 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_northern-shield-437204-m0'
[0m18:33:56.586042 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:33:57.270422 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_northern-shield-437204-m0, now list_northern-shield-437204-m0_nyc_taxi)
[0m18:33:57.273304 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:33:57.914237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'da700414-89db-400f-a54b-71bc2fbeb9d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d7f3d74c0>]}
[0m18:33:57.916157 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:33:57.917811 [info ] [MainThread]: 
[0m18:33:57.928446 [debug] [Thread-1  ]: Began running node model.nyc_taxi.analytic_greentripdata
[0m18:33:57.930316 [info ] [Thread-1  ]: 1 of 1 START sql table model nyc_taxi.analytic_greentripdata ................... [RUN]
[0m18:33:57.932025 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_northern-shield-437204-m0_nyc_taxi, now model.nyc_taxi.analytic_greentripdata)
[0m18:33:57.933785 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.analytic_greentripdata
[0m18:33:57.955723 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.analytic_greentripdata"
[0m18:33:57.964316 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.analytic_greentripdata
[0m18:33:58.037627 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.analytic_greentripdata"
[0m18:33:58.045974 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:33:58.051436 [debug] [Thread-1  ]: On model.nyc_taxi.analytic_greentripdata: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.analytic_greentripdata"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`analytic_greentripdata`
      
    
    

    OPTIONS()
    as (
      WITH 
pickup_times AS (
    SELECT 
        fct.trip_id,
        pu_t.date_part AS pickup_datetime,
        pu_t.date AS pickup_date,
        pu_t.hour AS pickup_hour,
        FORMAT_DATE('%b', pu_t.date) AS month_name,
        UPPER(LEFT(pu_t.weekday, 3)) AS day_of_week
    FROM 
        `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips` fct
    JOIN `northern-shield-437204-m0`.`nyc_taxi`.`dim_time` pu_t ON fct.pickup_time_id = pu_t.time_id
),
dropoff_times AS (
    SELECT 
        fct.trip_id,
        do_t.date_part AS dropoff_datetime,
        TIMESTAMP_DIFF(do_t.date_part, pu_t.date_part, MINUTE) AS trip_duration_minutes
    FROM 
        `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips` fct
    JOIN `northern-shield-437204-m0`.`nyc_taxi`.`dim_time` pu_t ON fct.pickup_time_id = pu_t.time_id
    JOIN `northern-shield-437204-m0`.`nyc_taxi`.`dim_time` do_t ON fct.dropoff_time_id = do_t.time_id
),
trip_details AS (
    SELECT 
        fct.trip_id,
        v.vendor_name,
        p.payment_name AS payment_type,
        z_pickup.zone AS pu_zone,
        z_dropoff.zone AS do_zone,
        r.rate_code_name,
        tt.trip_name,
        fct.passenger_count,
        CASE 
            WHEN fct.passenger_count > 3 THEN '>3'
            ELSE CAST(fct.passenger_count AS STRING)
        END AS passenger_count_group,
        fct.fare_amount,
        fct.tip_amount,
        fct.total_amount,
        (fct.total_amount - fct.fare_amount - fct.tip_amount) AS other_amount,
        fct.trip_distance,
        CASE 
            WHEN fct.trip_distance < 5 THEN '<5 miles'
            WHEN fct.trip_distance BETWEEN 5 AND 10 THEN '5-10 miles'
            WHEN fct.trip_distance BETWEEN 11 AND 20 THEN '11-20 miles'
            WHEN fct.trip_distance BETWEEN 21 AND 30 THEN '21-30 miles'
            WHEN fct.trip_distance BETWEEN 31 AND 40 THEN '31-40 miles'
            ELSE '>40 miles'
        END AS trip_distance_group
    FROM 
        `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips` fct
    JOIN `northern-shield-437204-m0`.`nyc_taxi`.`dim_vendor` v ON fct.vendor_id = v.id
    JOIN `northern-shield-437204-m0`.`nyc_taxi`.`dim_payment` p ON fct.payment_type = p.type_id
    JOIN `northern-shield-437204-m0`.`nyc_taxi`.`dim_zone` z_pickup ON fct.pu_location_id = z_pickup.locationid
    JOIN `northern-shield-437204-m0`.`nyc_taxi`.`dim_zone` z_dropoff ON fct.do_location_id = z_dropoff.locationid
    JOIN `northern-shield-437204-m0`.`nyc_taxi`.`dim_ratecode` r ON fct.rate_code_id = r.rate_id
    JOIN `northern-shield-437204-m0`.`nyc_taxi`.`dim_triptype` tt ON fct.trip_type = tt.triptype_id
    WHERE 
        fct.trip_type IS NOT NULL
        AND fct.rate_code_id IS NOT NULL
        AND fct.trip_type != 99
        AND fct.rate_code_id != 99
)
SELECT 
	td.trip_id,
    pt.pickup_datetime,
    pt.pickup_date,
    pt.pickup_hour,
    pt.month_name,
    pt.day_of_week,
    dt.trip_duration_minutes,
    td.vendor_name,
    td.payment_type,
    td.pu_zone,
    td.do_zone,
    td.rate_code_name,
    td.trip_name,
    td.passenger_count,
    td.passenger_count_group,
    td.fare_amount,
    td.tip_amount,
    td.total_amount,
    td.other_amount,
    td.trip_distance,
    td.trip_distance_group
FROM 
    pickup_times pt
JOIN dropoff_times dt ON pt.trip_id = dt.trip_id
JOIN trip_details td ON pt.trip_id = td.trip_id
ORDER BY 
    td.trip_id
    );
  
[0m18:33:59.537392 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:22ead66f-4971-45a9-bbe6-85b5e5ed918e&page=queryresults
[0m18:33:59.811218 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Name locationid not found inside z_pickup at [67:102]; reason: invalidQuery, location: query, message: Name locationid not found inside z_pickup at [67:102]')
[0m18:33:58.495657 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:02edac39-223a-4f2d-be99-45e88a001dea&page=queryresults
[0m18:33:58.846786 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:02edac39-223a-4f2d-be99-45e88a001dea&page=queryresults
[0m18:33:58.851058 [debug] [Thread-1  ]: Database Error in model analytic_greentripdata (models/report/analytic_greentripdata.sql)
  Name locationid not found inside z_pickup at [67:102]
  compiled code at target/run/nyc_taxi/models/report/analytic_greentripdata.sql
[0m18:33:58.853769 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'da700414-89db-400f-a54b-71bc2fbeb9d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d78cdf940>]}
[0m18:33:58.855301 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model nyc_taxi.analytic_greentripdata .......... [[31mERROR[0m in 0.92s]
[0m18:33:58.857327 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.analytic_greentripdata
[0m18:33:58.860159 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:33:58.861502 [debug] [MainThread]: Connection 'model.nyc_taxi.analytic_greentripdata' was properly closed.
[0m18:33:58.862668 [info ] [MainThread]: 
[0m18:33:58.863876 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.28 seconds (2.28s).
[0m18:33:58.865725 [debug] [MainThread]: Command end result
[0m18:33:58.951534 [info ] [MainThread]: 
[0m18:33:58.953260 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:33:58.954591 [info ] [MainThread]: 
[0m18:33:58.956078 [error] [MainThread]:   Database Error in model analytic_greentripdata (models/report/analytic_greentripdata.sql)
  Name locationid not found inside z_pickup at [67:102]
  compiled code at target/run/nyc_taxi/models/report/analytic_greentripdata.sql
[0m18:33:58.957342 [info ] [MainThread]: 
[0m18:33:58.958740 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m18:33:58.960862 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 7.970491, "process_in_blocks": "0", "process_kernel_time": 0.45008, "process_mem_max_rss": "245284", "process_out_blocks": "0", "process_user_time": 5.740827}
[0m18:33:58.962216 [debug] [MainThread]: Command `dbt run` failed at 18:33:58.962040 after 7.97 seconds
[0m18:33:58.963303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d7fd2ff70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d7e80e160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d7e8854f0>]}
[0m18:33:58.964435 [debug] [MainThread]: Flushing usage events
[0m18:34:59.875621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84d7f74460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84d5dacaf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84d5daca90>]}


============================== 18:34:59.884946 | 208a5d9c-0cc6-4490-b14c-caea10023909 ==============================
[0m18:34:59.884946 [info ] [MainThread]: Running with dbt=1.8.9
[0m18:34:59.886684 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'invocation_command': 'dbt run --select analytic_greentripdata', 'profiles_dir': '/opt/airflow/include/dbt', 'log_cache_events': 'False', 'empty': 'False', 'cache_selected_only': 'False', 'no_print': 'None', 'introspect': 'True', 'quiet': 'False', 'warn_error': 'None', 'write_json': 'True', 'debug': 'False', 'indirect_selection': 'eager', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'log_path': '/opt/airflow/include/dbt/logs', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'fail_fast': 'False', 'printer_width': '80', 'log_format': 'default', 'target_path': 'None', 'version_check': 'True', 'use_experimental_parser': 'False'}
[0m18:35:01.625671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '208a5d9c-0cc6-4490-b14c-caea10023909', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f849f74cd00>]}
[0m18:35:01.709456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '208a5d9c-0cc6-4490-b14c-caea10023909', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f849e99e1f0>]}
[0m18:35:01.711910 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m18:35:01.931877 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m18:35:02.791501 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:35:02.794035 [debug] [MainThread]: Partial parsing: updated file: nyc_taxi://models/report/analytic_greentripdata.sql
[0m18:35:03.270166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '208a5d9c-0cc6-4490-b14c-caea10023909', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84d04e7130>]}
[0m18:35:03.481099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '208a5d9c-0cc6-4490-b14c-caea10023909', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84d75d47c0>]}
[0m18:35:03.482971 [info ] [MainThread]: Found 8 models, 34 data tests, 2 sources, 600 macros
[0m18:35:03.484569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '208a5d9c-0cc6-4490-b14c-caea10023909', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f849e8d7dc0>]}
[0m18:35:03.488021 [info ] [MainThread]: 
[0m18:35:03.489831 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:35:03.493067 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_northern-shield-437204-m0'
[0m18:35:03.494784 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:35:04.306195 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_northern-shield-437204-m0, now list_northern-shield-437204-m0_nyc_taxi)
[0m18:35:04.307706 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:35:05.111658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '208a5d9c-0cc6-4490-b14c-caea10023909', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84d82abb80>]}
[0m18:35:05.113312 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:35:05.114690 [info ] [MainThread]: 
[0m18:35:05.124603 [debug] [Thread-1  ]: Began running node model.nyc_taxi.analytic_greentripdata
[0m18:35:05.126588 [info ] [Thread-1  ]: 1 of 1 START sql table model nyc_taxi.analytic_greentripdata ................... [RUN]
[0m18:35:05.128229 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_northern-shield-437204-m0_nyc_taxi, now model.nyc_taxi.analytic_greentripdata)
[0m18:35:05.129341 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.analytic_greentripdata
[0m18:35:05.145102 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.analytic_greentripdata"
[0m18:35:05.151292 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.analytic_greentripdata
[0m18:35:05.208115 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.analytic_greentripdata"
[0m18:35:05.213949 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:35:05.218272 [debug] [Thread-1  ]: On model.nyc_taxi.analytic_greentripdata: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.analytic_greentripdata"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`analytic_greentripdata`
      
    
    

    OPTIONS()
    as (
      WITH 
pickup_times AS (
    SELECT 
        fct.trip_id,
        pu_t.date_part AS pickup_datetime,
        pu_t.date AS pickup_date,
        pu_t.hour AS pickup_hour,
        FORMAT_DATE('%b', pu_t.date) AS month_name,
        UPPER(LEFT(pu_t.weekday, 3)) AS day_of_week
    FROM 
        `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips` fct
    JOIN `northern-shield-437204-m0`.`nyc_taxi`.`dim_time` pu_t ON fct.pickup_time_id = pu_t.time_id
),
dropoff_times AS (
    SELECT 
        fct.trip_id,
        do_t.date_part AS dropoff_datetime,
        TIMESTAMP_DIFF(do_t.date_part, pu_t.date_part, MINUTE) AS trip_duration_minutes
    FROM 
        `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips` fct
    JOIN `northern-shield-437204-m0`.`nyc_taxi`.`dim_time` pu_t ON fct.pickup_time_id = pu_t.time_id
    JOIN `northern-shield-437204-m0`.`nyc_taxi`.`dim_time` do_t ON fct.dropoff_time_id = do_t.time_id
),
trip_details AS (
    SELECT 
        fct.trip_id,
        v.vendor_name,
        p.payment_name AS payment_type,
        z_pickup.zone AS pu_zone,
        z_dropoff.zone AS do_zone,
        r.rate_code_name,
        tt.trip_name,
        fct.passenger_count,
        CASE 
            WHEN fct.passenger_count > 3 THEN '>3'
            ELSE CAST(fct.passenger_count AS STRING)
        END AS passenger_count_group,
        fct.fare_amount,
        fct.tip_amount,
        fct.total_amount,
        (fct.total_amount - fct.fare_amount - fct.tip_amount) AS other_amount,
        fct.trip_distance,
        CASE 
            WHEN fct.trip_distance < 5 THEN '<5 miles'
            WHEN fct.trip_distance BETWEEN 5 AND 10 THEN '5-10 miles'
            WHEN fct.trip_distance BETWEEN 11 AND 20 THEN '11-20 miles'
            WHEN fct.trip_distance BETWEEN 21 AND 30 THEN '21-30 miles'
            WHEN fct.trip_distance BETWEEN 31 AND 40 THEN '31-40 miles'
            ELSE '>40 miles'
        END AS trip_distance_group
    FROM 
        `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips` fct
    JOIN `northern-shield-437204-m0`.`nyc_taxi`.`dim_vendor` v ON fct.vendor_id = v.id
    JOIN `northern-shield-437204-m0`.`nyc_taxi`.`dim_payment` p ON fct.payment_type = p.type_id
    JOIN `northern-shield-437204-m0`.`nyc_taxi`.`dim_zone` z_pickup ON fct.pu_location_id = z_pickup.location_id
    JOIN `northern-shield-437204-m0`.`nyc_taxi`.`dim_zone` z_dropoff ON fct.do_location_id = z_dropoff.location_id
    JOIN `northern-shield-437204-m0`.`nyc_taxi`.`dim_ratecode` r ON fct.rate_code_id = r.rate_id
    JOIN `northern-shield-437204-m0`.`nyc_taxi`.`dim_triptype` tt ON fct.trip_type = tt.triptype_id
    WHERE 
        fct.trip_type IS NOT NULL
        AND fct.rate_code_id IS NOT NULL
        AND fct.trip_type != 99
        AND fct.rate_code_id != 99
)
SELECT 
	td.trip_id,
    pt.pickup_datetime,
    pt.pickup_date,
    pt.pickup_hour,
    pt.month_name,
    pt.day_of_week,
    dt.trip_duration_minutes,
    td.vendor_name,
    td.payment_type,
    td.pu_zone,
    td.do_zone,
    td.rate_code_name,
    td.trip_name,
    td.passenger_count,
    td.passenger_count_group,
    td.fare_amount,
    td.tip_amount,
    td.total_amount,
    td.other_amount,
    td.trip_distance,
    td.trip_distance_group
FROM 
    pickup_times pt
JOIN dropoff_times dt ON pt.trip_id = dt.trip_id
JOIN trip_details td ON pt.trip_id = td.trip_id
ORDER BY 
    td.trip_id
    );
  
[0m18:35:06.125928 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:c193023e-a1e2-4489-87c3-3ba523549b55&page=queryresults
[0m18:35:06.489045 [debug] [Thread-1  ]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Name triptype_id not found inside tt at [70:89]; reason: invalidQuery, location: query, message: Name triptype_id not found inside tt at [70:89]')
[0m18:35:07.127974 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:dbaa0d2c-ce37-48c6-b413-c942e191b71b&page=queryresults
[0m18:35:07.489698 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:dbaa0d2c-ce37-48c6-b413-c942e191b71b&page=queryresults
[0m18:35:07.494901 [debug] [Thread-1  ]: Database Error in model analytic_greentripdata (models/report/analytic_greentripdata.sql)
  Name triptype_id not found inside tt at [70:89]
  compiled code at target/run/nyc_taxi/models/report/analytic_greentripdata.sql
[0m18:35:07.497925 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '208a5d9c-0cc6-4490-b14c-caea10023909', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84d6ace370>]}
[0m18:35:07.499699 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model nyc_taxi.analytic_greentripdata .......... [[31mERROR[0m in 2.37s]
[0m18:35:07.501681 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.analytic_greentripdata
[0m18:35:07.504641 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:35:07.505792 [debug] [MainThread]: Connection 'model.nyc_taxi.analytic_greentripdata' was properly closed.
[0m18:35:07.507048 [info ] [MainThread]: 
[0m18:35:07.508324 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.02 seconds (4.02s).
[0m18:35:07.509973 [debug] [MainThread]: Command end result
[0m18:35:07.587225 [info ] [MainThread]: 
[0m18:35:07.588670 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:35:07.589701 [info ] [MainThread]: 
[0m18:35:07.590935 [error] [MainThread]:   Database Error in model analytic_greentripdata (models/report/analytic_greentripdata.sql)
  Name triptype_id not found inside tt at [70:89]
  compiled code at target/run/nyc_taxi/models/report/analytic_greentripdata.sql
[0m18:35:07.592020 [info ] [MainThread]: 
[0m18:35:07.593251 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m18:35:07.594947 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 7.811465, "process_in_blocks": "0", "process_kernel_time": 0.632263, "process_mem_max_rss": "245556", "process_out_blocks": "0", "process_user_time": 5.839141}
[0m18:35:07.596298 [debug] [MainThread]: Command `dbt run` failed at 18:35:07.596141 after 7.81 seconds
[0m18:35:07.597334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84d7f74460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84d048ce20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84d6545ee0>]}
[0m18:35:07.598256 [debug] [MainThread]: Flushing usage events
[0m18:35:39.819131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f26f5e3df70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f26f3c14a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f26f3c149a0>]}


============================== 18:35:39.827364 | 781be40f-c153-4a98-b48e-7e6c057c6ada ==============================
[0m18:35:39.827364 [info ] [MainThread]: Running with dbt=1.8.9
[0m18:35:39.829051 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'log_format': 'default', 'warn_error': 'None', 'write_json': 'True', 'log_path': '/opt/airflow/include/dbt/logs', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'no_print': 'None', 'use_experimental_parser': 'False', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'quiet': 'False', 'printer_width': '80', 'profiles_dir': '/opt/airflow/include/dbt', 'debug': 'False', 'empty': 'False', 'version_check': 'True', 'invocation_command': 'dbt run --select analytic_greentripdata', 'use_colors': 'True', 'partial_parse': 'True', 'log_cache_events': 'False', 'fail_fast': 'False', 'target_path': 'None', 'cache_selected_only': 'False'}
[0m18:35:41.131732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '781be40f-c153-4a98-b48e-7e6c057c6ada', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f26f5625fd0>]}
[0m18:35:41.202151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '781be40f-c153-4a98-b48e-7e6c057c6ada', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f26bc7a37c0>]}
[0m18:35:41.203786 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m18:35:41.388102 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m18:35:42.095381 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:35:42.097640 [debug] [MainThread]: Partial parsing: updated file: nyc_taxi://models/report/analytic_greentripdata.sql
[0m18:35:42.546683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '781be40f-c153-4a98-b48e-7e6c057c6ada', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f26edce1130>]}
[0m18:35:42.733645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '781be40f-c153-4a98-b48e-7e6c057c6ada', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f26edd14d30>]}
[0m18:35:42.735047 [info ] [MainThread]: Found 8 models, 34 data tests, 2 sources, 600 macros
[0m18:35:42.736439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '781be40f-c153-4a98-b48e-7e6c057c6ada', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f26f4969a30>]}
[0m18:35:42.739402 [info ] [MainThread]: 
[0m18:35:42.741148 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:35:42.743151 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_northern-shield-437204-m0'
[0m18:35:42.744308 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:35:44.077434 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_northern-shield-437204-m0, now list_northern-shield-437204-m0_nyc_taxi)
[0m18:35:44.078896 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:35:44.676080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '781be40f-c153-4a98-b48e-7e6c057c6ada', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f26bc6d9d90>]}
[0m18:35:44.677521 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:35:44.678745 [info ] [MainThread]: 
[0m18:35:44.687116 [debug] [Thread-1  ]: Began running node model.nyc_taxi.analytic_greentripdata
[0m18:35:44.689192 [info ] [Thread-1  ]: 1 of 1 START sql table model nyc_taxi.analytic_greentripdata ................... [RUN]
[0m18:35:44.690883 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_northern-shield-437204-m0_nyc_taxi, now model.nyc_taxi.analytic_greentripdata)
[0m18:35:44.692183 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.analytic_greentripdata
[0m18:35:44.709241 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.analytic_greentripdata"
[0m18:35:44.716124 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.analytic_greentripdata
[0m18:35:44.787614 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.analytic_greentripdata"
[0m18:35:44.793326 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:35:44.797713 [debug] [Thread-1  ]: On model.nyc_taxi.analytic_greentripdata: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.analytic_greentripdata"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`analytic_greentripdata`
      
    
    

    OPTIONS()
    as (
      WITH 
pickup_times AS (
    SELECT 
        fct.trip_id,
        pu_t.date_part AS pickup_datetime,
        pu_t.date AS pickup_date,
        pu_t.hour AS pickup_hour,
        FORMAT_DATE('%b', pu_t.date) AS month_name,
        UPPER(LEFT(pu_t.weekday, 3)) AS day_of_week
    FROM 
        `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips` fct
    JOIN `northern-shield-437204-m0`.`nyc_taxi`.`dim_time` pu_t ON fct.pickup_time_id = pu_t.time_id
),
dropoff_times AS (
    SELECT 
        fct.trip_id,
        do_t.date_part AS dropoff_datetime,
        TIMESTAMP_DIFF(do_t.date_part, pu_t.date_part, MINUTE) AS trip_duration_minutes
    FROM 
        `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips` fct
    JOIN `northern-shield-437204-m0`.`nyc_taxi`.`dim_time` pu_t ON fct.pickup_time_id = pu_t.time_id
    JOIN `northern-shield-437204-m0`.`nyc_taxi`.`dim_time` do_t ON fct.dropoff_time_id = do_t.time_id
),
trip_details AS (
    SELECT 
        fct.trip_id,
        v.vendor_name,
        p.payment_name AS payment_type,
        z_pickup.zone AS pu_zone,
        z_dropoff.zone AS do_zone,
        r.rate_code_name,
        tt.trip_name,
        fct.passenger_count,
        CASE 
            WHEN fct.passenger_count > 3 THEN '>3'
            ELSE CAST(fct.passenger_count AS STRING)
        END AS passenger_count_group,
        fct.fare_amount,
        fct.tip_amount,
        fct.total_amount,
        (fct.total_amount - fct.fare_amount - fct.tip_amount) AS other_amount,
        fct.trip_distance,
        CASE 
            WHEN fct.trip_distance < 5 THEN '<5 miles'
            WHEN fct.trip_distance BETWEEN 5 AND 10 THEN '5-10 miles'
            WHEN fct.trip_distance BETWEEN 11 AND 20 THEN '11-20 miles'
            WHEN fct.trip_distance BETWEEN 21 AND 30 THEN '21-30 miles'
            WHEN fct.trip_distance BETWEEN 31 AND 40 THEN '31-40 miles'
            ELSE '>40 miles'
        END AS trip_distance_group
    FROM 
        `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips` fct
    JOIN `northern-shield-437204-m0`.`nyc_taxi`.`dim_vendor` v ON fct.vendor_id = v.id
    JOIN `northern-shield-437204-m0`.`nyc_taxi`.`dim_payment` p ON fct.payment_type = p.type_id
    JOIN `northern-shield-437204-m0`.`nyc_taxi`.`dim_zone` z_pickup ON fct.pu_location_id = z_pickup.location_id
    JOIN `northern-shield-437204-m0`.`nyc_taxi`.`dim_zone` z_dropoff ON fct.do_location_id = z_dropoff.location_id
    JOIN `northern-shield-437204-m0`.`nyc_taxi`.`dim_ratecode` r ON fct.rate_code_id = r.rate_id
    JOIN `northern-shield-437204-m0`.`nyc_taxi`.`dim_triptype` tt ON fct.trip_type = tt.type_id
    WHERE 
        fct.trip_type IS NOT NULL
        AND fct.rate_code_id IS NOT NULL
        AND fct.trip_type != 99
        AND fct.rate_code_id != 99
)
SELECT 
	td.trip_id,
    pt.pickup_datetime,
    pt.pickup_date,
    pt.pickup_hour,
    pt.month_name,
    pt.day_of_week,
    dt.trip_duration_minutes,
    td.vendor_name,
    td.payment_type,
    td.pu_zone,
    td.do_zone,
    td.rate_code_name,
    td.trip_name,
    td.passenger_count,
    td.passenger_count_group,
    td.fare_amount,
    td.tip_amount,
    td.total_amount,
    td.other_amount,
    td.trip_distance,
    td.trip_distance_group
FROM 
    pickup_times pt
JOIN dropoff_times dt ON pt.trip_id = dt.trip_id
JOIN trip_details td ON pt.trip_id = td.trip_id
ORDER BY 
    td.trip_id
    );
  
[0m18:35:45.603668 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:8d0d5cf6-04d8-464b-a5fd-e5207dcf597f&page=queryresults
[0m18:36:02.379720 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '781be40f-c153-4a98-b48e-7e6c057c6ada', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f26e95aa2b0>]}
[0m18:36:02.381941 [info ] [Thread-1  ]: 1 of 1 OK created sql table model nyc_taxi.analytic_greentripdata .............. [[32mCREATE TABLE (664.8k rows, 138.8 MiB processed)[0m in 17.69s]
[0m18:36:02.384203 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.analytic_greentripdata
[0m18:36:02.386995 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:36:02.387933 [debug] [MainThread]: Connection 'model.nyc_taxi.analytic_greentripdata' was properly closed.
[0m18:36:02.388910 [info ] [MainThread]: 
[0m18:36:02.390135 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 19.65 seconds (19.65s).
[0m18:36:02.392090 [debug] [MainThread]: Command end result
[0m18:36:02.477653 [info ] [MainThread]: 
[0m18:36:02.479202 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:36:02.480531 [info ] [MainThread]: 
[0m18:36:02.481768 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:36:02.484015 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 25.055727, "process_in_blocks": "0", "process_kernel_time": 0.447029, "process_mem_max_rss": "243324", "process_out_blocks": "0", "process_user_time": 5.466792}
[0m18:36:02.485651 [debug] [MainThread]: Command `dbt run` succeeded at 18:36:02.485454 after 25.06 seconds
[0m18:36:02.486842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f26f5e3df70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f26f5625fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f26edd19490>]}
[0m18:36:02.487999 [debug] [MainThread]: Flushing usage events
[0m22:49:23.892363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1da29aa430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1da07e3ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1da07e3a60>]}


============================== 22:49:23.905142 | 2aa2d857-48e0-4981-8058-fe1102dcbb77 ==============================
[0m22:49:23.905142 [info ] [MainThread]: Running with dbt=1.8.9
[0m22:49:23.908300 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run --select analytic_greentripdata', 'debug': 'False', 'profiles_dir': '/opt/airflow/include/dbt', 'introspect': 'True', 'no_print': 'None', 'write_json': 'True', 'static_parser': 'True', 'use_colors': 'True', 'version_check': 'True', 'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'indirect_selection': 'eager', 'cache_selected_only': 'False', 'warn_error': 'None', 'quiet': 'False', 'partial_parse': 'True', 'printer_width': '80', 'use_experimental_parser': 'False', 'empty': 'False', 'log_format': 'default', 'fail_fast': 'False', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'log_path': '/opt/airflow/include/dbt/logs'}
[0m22:49:26.582185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2aa2d857-48e0-4981-8058-fe1102dcbb77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1da4052790>]}
[0m22:49:26.712875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2aa2d857-48e0-4981-8058-fe1102dcbb77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1da2d05550>]}
[0m22:49:26.715254 [info ] [MainThread]: Registered adapter: bigquery=1.8.3
[0m22:49:27.023519 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m22:49:28.461290 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:49:28.464677 [debug] [MainThread]: Partial parsing: updated file: nyc_taxi://models/report/analytic_greentripdata.sql
[0m22:49:29.135938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2aa2d857-48e0-4981-8058-fe1102dcbb77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d9a8e0ee0>]}
[0m22:49:29.454959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2aa2d857-48e0-4981-8058-fe1102dcbb77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d9bdac790>]}
[0m22:49:29.457261 [info ] [MainThread]: Found 8 models, 34 data tests, 2 sources, 600 macros
[0m22:49:29.459291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2aa2d857-48e0-4981-8058-fe1102dcbb77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d9a8cc2e0>]}
[0m22:49:29.463382 [info ] [MainThread]: 
[0m22:49:29.465781 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m22:49:29.469281 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_northern-shield-437204-m0'
[0m22:49:29.471351 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:49:30.236095 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_northern-shield-437204-m0, now list_northern-shield-437204-m0_nyc_taxi)
[0m22:49:30.237660 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:49:30.825835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2aa2d857-48e0-4981-8058-fe1102dcbb77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1da2d05b20>]}
[0m22:49:30.827624 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:49:30.829038 [info ] [MainThread]: 
[0m22:49:30.838573 [debug] [Thread-1  ]: Began running node model.nyc_taxi.analytic_greentripdata
[0m22:49:30.840444 [info ] [Thread-1  ]: 1 of 1 START sql table model nyc_taxi.analytic_greentripdata ................... [RUN]
[0m22:49:30.842296 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_northern-shield-437204-m0_nyc_taxi, now model.nyc_taxi.analytic_greentripdata)
[0m22:49:30.843686 [debug] [Thread-1  ]: Began compiling node model.nyc_taxi.analytic_greentripdata
[0m22:49:30.859316 [debug] [Thread-1  ]: Writing injected SQL for node "model.nyc_taxi.analytic_greentripdata"
[0m22:49:30.865688 [debug] [Thread-1  ]: Began executing node model.nyc_taxi.analytic_greentripdata
[0m22:49:30.924753 [debug] [Thread-1  ]: Writing runtime sql for node "model.nyc_taxi.analytic_greentripdata"
[0m22:49:30.931177 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:49:30.935630 [debug] [Thread-1  ]: On model.nyc_taxi.analytic_greentripdata: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "nyc_taxi", "target_name": "dev", "node_id": "model.nyc_taxi.analytic_greentripdata"} */

  
    

    create or replace table `northern-shield-437204-m0`.`nyc_taxi`.`analytic_greentripdata`
      
    
    

    OPTIONS()
    as (
      WITH 
pickup_times AS (
    SELECT 
        fct.trip_id,
        pu_t.date_part AS pickup_datetime,
        pu_t.date AS pickup_date,
        pu_t.hour AS pickup_hour,
        FORMAT_DATE('%b', pu_t.date) AS month_name,
        UPPER(LEFT(pu_t.weekday, 3)) AS day_of_week
    FROM 
        `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips` fct
    JOIN `northern-shield-437204-m0`.`nyc_taxi`.`dim_time` pu_t ON fct.pickup_time_id = pu_t.time_id
),
dropoff_times AS (
    SELECT 
        fct.trip_id,
        do_t.date_part AS dropoff_datetime,
        TIMESTAMP_DIFF(do_t.date_part, pu_t.date_part, MINUTE) AS trip_duration_minutes
    FROM 
        `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips` fct
    JOIN `northern-shield-437204-m0`.`nyc_taxi`.`dim_time` pu_t ON fct.pickup_time_id = pu_t.time_id
    JOIN `northern-shield-437204-m0`.`nyc_taxi`.`dim_time` do_t ON fct.dropoff_time_id = do_t.time_id
),
trip_details AS (
    SELECT 
        fct.trip_id,
        v.vendor_name,
        p.payment_name AS payment_type,
        z_pickup.zone AS pu_zone,
        z_dropoff.zone AS do_zone,
        r.rate_code_name,
        tt.trip_name,
        fct.passenger_count,
        CASE 
            WHEN fct.passenger_count > 3 THEN '>3'
            ELSE CAST(fct.passenger_count AS STRING)
        END AS passenger_count_group,
        fct.fare_amount,
        fct.tip_amount,
        fct.total_amount,
        (fct.total_amount - fct.fare_amount - fct.tip_amount) AS other_amount,
        fct.trip_distance,
        CASE 
            WHEN fct.trip_distance < 5 THEN '<5 miles'
            WHEN fct.trip_distance >= 5 AND fct.trip_distance < 10 THEN '5-10 miles'
            WHEN fct.trip_distance >= 10 AND fct.trip_distance < 20 THEN '11-20 miles'
            WHEN fct.trip_distance >= 20 AND fct.trip_distance < 30 THEN '21-30 miles'
            WHEN fct.trip_distance >= 30 AND fct.trip_distance < 40 THEN '31-40 miles'
            ELSE '>40 miles'
        END AS trip_distance_group
    FROM 
        `northern-shield-437204-m0`.`nyc_taxi`.`fct_trips` fct
    JOIN `northern-shield-437204-m0`.`nyc_taxi`.`dim_vendor` v ON fct.vendor_id = v.id
    JOIN `northern-shield-437204-m0`.`nyc_taxi`.`dim_payment` p ON fct.payment_type = p.type_id
    JOIN `northern-shield-437204-m0`.`nyc_taxi`.`dim_zone` z_pickup ON fct.pu_location_id = z_pickup.location_id
    JOIN `northern-shield-437204-m0`.`nyc_taxi`.`dim_zone` z_dropoff ON fct.do_location_id = z_dropoff.location_id
    JOIN `northern-shield-437204-m0`.`nyc_taxi`.`dim_ratecode` r ON fct.rate_code_id = r.rate_id
    JOIN `northern-shield-437204-m0`.`nyc_taxi`.`dim_triptype` tt ON fct.trip_type = tt.type_id
    WHERE 
        fct.trip_type IS NOT NULL
        AND fct.rate_code_id IS NOT NULL
        AND fct.trip_type != 99
        AND fct.rate_code_id != 99
)
SELECT 
	td.trip_id,
    pt.pickup_datetime,
    pt.pickup_date,
    pt.pickup_hour,
    pt.month_name,
    pt.day_of_week,
    dt.trip_duration_minutes,
    td.vendor_name,
    td.payment_type,
    td.pu_zone,
    td.do_zone,
    td.rate_code_name,
    td.trip_name,
    td.passenger_count,
    td.passenger_count_group,
    td.fare_amount,
    td.tip_amount,
    td.total_amount,
    td.other_amount,
    td.trip_distance,
    td.trip_distance_group
FROM 
    pickup_times pt
JOIN dropoff_times dt ON pt.trip_id = dt.trip_id
JOIN trip_details td ON pt.trip_id = td.trip_id
ORDER BY 
    td.trip_id
    );
  
[0m22:49:31.918010 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=northern-shield-437204-m0&j=bq:us-central1:1701604f-19e1-4e15-8c93-70b1bcc6a8aa&page=queryresults
[0m22:49:45.145952 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2aa2d857-48e0-4981-8058-fe1102dcbb77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d6a1cd7f0>]}
[0m22:49:45.148815 [info ] [Thread-1  ]: 1 of 1 OK created sql table model nyc_taxi.analytic_greentripdata .............. [[32mCREATE TABLE (664.8k rows, 138.8 MiB processed)[0m in 14.30s]
[0m22:49:45.152195 [debug] [Thread-1  ]: Finished running node model.nyc_taxi.analytic_greentripdata
[0m22:49:45.156241 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:49:45.157881 [debug] [MainThread]: Connection 'model.nyc_taxi.analytic_greentripdata' was properly closed.
[0m22:49:45.159493 [info ] [MainThread]: 
[0m22:49:45.161363 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 15.69 seconds (15.69s).
[0m22:49:45.164754 [debug] [MainThread]: Command end result
[0m22:49:45.312207 [info ] [MainThread]: 
[0m22:49:45.315164 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:49:45.317822 [info ] [MainThread]: 
[0m22:49:45.320558 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m22:49:45.325098 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 23.87591, "process_in_blocks": "6712", "process_kernel_time": 1.703412, "process_mem_max_rss": "241520", "process_out_blocks": "0", "process_user_time": 8.656686}
[0m22:49:45.328547 [debug] [MainThread]: Command `dbt run` succeeded at 22:49:45.327979 after 23.88 seconds
[0m22:49:45.331080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1da29aa430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1da2d05550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1da0f5f100>]}
[0m22:49:45.333353 [debug] [MainThread]: Flushing usage events
